{"version":3,"sources":["webpack:///./src/js/XML.js","webpack:///./src/js/SOS.js","webpack:///./src/js/widget-common.js","webpack:///./src/js/locale-date.js"],"names":["xml","clean","X","at","cleanName","name","split","elem","o","nodeType","attributes","length","i","value","isNs","lastIndexOf","toString","firstChild","textChild","cdataChild","hasElementChild","n","nextSibling","nodeValue","match","removeWhite","escape","nodeName","Array","toObj","innerXml","documentElement","data","node","str","innerHTML","asXml","s","c","txt","replace","e","normalize","nxt","removeChild","cleanXml","domRoot","DOMParser","parseFromString","domElem","ret","object","toXml","v","ind","hasChild","Object","keys","forEach","m","charAt","substr","isArray","obj","prototype","call","toArray","payload","_url","url","this","callback","errorHandler","_send_xml","response","cleanResponse","Capabilities","contents","Contents","offering","map","ObservationOffering","procedure","procedureDescriptionFormat","observableProperty","relatedFeature","feature","featureOfInterest","FeatureRelationship","target","href","role","undefined","observedArea","lowerLeft","Envelope","lowerCorner","coord","Number","upperRight","upperCorner","crs","type","properties","srsName","phenomenonTime","TimePeriod","beginPosition","endPosition","resultTime","responseFormat","observationType","featureOfInterestType","DescribeSensorResponse","description","SensorDescription","SensorML","member","GetFeatureOfInterestResponse","featureMember","SF_SpatialSamplingFeature","identifier","codespace","codeSpace","sampledFeature","geometry","shape","coordinates","values","pos","console","log","JSON","stringify","features","request","observedProperty","_send_json","dataAvailability","time","operation","filter","ref","temporalFilter","observations","onSuccess","onError","service","version","xhr","XMLHttpRequest","onreadystatechange","readyState","responseText","parse","status","statusText","open","setRequestHeader","send","XML","read","write","inputs","optional_inputs","config","el","custom_css_url","link","document","createElement","setAttribute","getElementsByTagName","appendChild","loadCSS","footnote","querySelector","display_utc_times","utc","date","locale","navigator","language","browserLanguage","display","d","toLocaleString","timeZone","t","l","u"],"mappings":"2HAOe,OACb,KAAKA,EAAKC,GACR,MAAMC,EAAI,CACRC,GAAKF,EAAQ,GAAK,IAElBG,UAAYC,GAAUJ,GAAQI,EAAKC,MAAM,SAAS,IAAaD,EAE/D,MAAME,GACJ,IAAIC,EAAI,GACR,GAAsB,IAAlBD,EAAKE,SAAgB,CACvB,GAAIF,EAAKG,WAAWC,OAClB,IAAK,IAAIC,EAAI,EAAGA,EAAIL,EAAKG,WAAWC,OAAQC,GAAK,EAAG,CAClD,MAAM,KAAEP,GAASE,EAAKG,WAAWE,IAC3B,MAAEC,GAAUN,EAAKG,WAAWE,GAC5BE,EAAyC,IAAlCT,EAAKU,YAAY,SAAU,GAClCd,GAASa,IACbN,EAAEN,EAAEC,GAAKD,EAAEE,UAAUC,KAAUQ,GAAS,IAAIG,YAIlD,GAAIT,EAAKU,WAAY,CACnB,IAAIC,EAAY,EACZC,EAAa,EACbC,GAAkB,EACtB,IAAK,IAAIC,EAAId,EAAKU,WAAYI,EAAGA,EAAIA,EAAEC,YAClB,IAAfD,EAAEZ,SACJW,GAAkB,EACM,IAAfC,EAAEZ,UAAkBY,EAAEE,UAAUC,MAAM,kBAC/CN,GAAa,EAEW,IAAfG,EAAEZ,WACXU,GAAc,GAIlB,GAAIC,EACF,GAAIF,EAAY,GAAKC,EAAa,EAAG,CAGnCjB,EAAEuB,YAAYlB,GACd,IAAK,IAAIc,EAAId,EAAKU,WAAYI,EAAGA,EAAIA,EAAEC,YAClB,IAAfD,EAAEZ,SACJD,EAAE,SAAWN,EAAEwB,OAAOL,EAAEE,WACA,IAAfF,EAAEZ,SACXD,EAAE,UAAYN,EAAEwB,OAAOL,EAAEE,WAChBf,EAAEa,EAAEM,UAETnB,EAAEa,EAAEM,oBAAqBC,MAC3BpB,EAAEa,EAAEM,UAAUnB,EAAEa,EAAEM,UAAUhB,QAAUT,EAAE2B,MAAMR,GAE9Cb,EAAEa,EAAEM,UAAY,CAACnB,EAAEa,EAAEM,UAAWzB,EAAE2B,MAAMR,IAG1Cb,EAAEa,EAAEM,UAAYzB,EAAE2B,MAAMR,QAGlBd,EAAKG,WAAWC,OAG1BH,EAAE,SAAWN,EAAEwB,OAAOxB,EAAE4B,SAASvB,IAFjCC,EAAIN,EAAEwB,OAAOxB,EAAE4B,SAASvB,SAIrB,GAAIW,EACJX,EAAKG,WAAWC,OAGnBH,EAAE,SAAWN,EAAEwB,OAAOxB,EAAE4B,SAASvB,IAFjCC,EAAIN,EAAEwB,OAAOxB,EAAE4B,SAASvB,SAIrB,GAAIY,EACT,GAAIA,EAAa,EACfX,EAAIN,EAAEwB,OAAOxB,EAAE4B,SAASvB,SAExB,IAAK,IAAIc,EAAId,EAAKU,WAAYI,EAAGA,EAAIA,EAAEC,YACrCd,EAAE,UAAYN,EAAEwB,OAAOL,EAAEE,WAK5BhB,EAAKG,WAAWC,QAAWJ,EAAKU,aACnCT,EAAI,WAED,GAAsB,IAAlBD,EAAKE,SACdD,EAAIN,EAAE2B,MAAMtB,EAAKwB,sBACZ,GAAsB,IAAlBxB,EAAKE,SACd,OAAOF,EAAKyB,KAMd,OAAOxB,GAGT,SAASyB,GACP,IAAIC,EAAM,GACV,GAAI,cAAeD,EACjBC,EAAMD,EAAKE,cACN,CACL,MAAMC,EAASf,IACb,IAAIgB,EAAI,GACR,GAAmB,IAAfhB,EAAEZ,SAAgB,CACpB4B,GAAK,IAAIhB,EAAEM,SACX,IAAK,IAAIf,EAAI,EAAGA,EAAIS,EAAEX,WAAWC,OAAQC,GAAK,EAAG,CAC/C,MAAM,KAAEP,GAASgB,EAAEX,WAAWE,GAE9ByB,GAAK,IAAIhC,OADKgB,EAAEX,WAAWE,GAAGC,OAAS,IACfG,cAE1B,GAAIK,EAAEJ,WAAY,CAChBoB,GAAK,IACL,IAAK,IAAIC,EAAIjB,EAAEJ,WAAYqB,EAAGA,EAAIA,EAAEhB,YAClCe,GAAKD,EAAME,GAEbD,GAAK,KAAKhB,EAAEM,iBAEZU,GAAK,UAEiB,IAAfhB,EAAEZ,SACX4B,GAAKhB,EAAEE,UACiB,IAAfF,EAAEZ,WACX4B,GAAK,YAAYhB,EAAEE,gBAErB,OAAOc,GAGT,IAAK,IAAIC,EAAIL,EAAKhB,WAAYqB,EAAGA,EAAIA,EAAEhB,YACrCY,GAAOE,EAAME,GAGjB,OAAOJ,GAGTR,OAAOa,GACEA,EAAIC,QAAQ,QAAS,QAAQA,QAAQ,OAAQ,OAAOA,QAAQ,QAAS,OAAOA,QAAQ,QAAS,OAGtG,YAAYC,GACVA,EAAEC,YACF,IAAK,IAAIrB,EAAIoB,EAAExB,WAAYI,GACzB,GAAmB,IAAfA,EAAEZ,SACJ,GAAKY,EAAEE,UAAUC,MAAM,kBAMrBH,EAAIA,EAAEC,gBANkC,CAExC,MAAMqB,EAAMtB,EAAEC,YACdmB,EAAEG,YAAYvB,GACdA,EAAIsB,OAIkB,IAAftB,EAAEZ,UACXP,EAAEuB,YAAYJ,GACdA,EAAIA,EAAEC,aAEND,EAAIA,EAAEC,YAGV,OAAOmB,IAKLI,EAAW5C,EAAQD,EAAIwC,QAAQ,8BAA+B,UAAYxC,EAG1E8C,GAAU,IAAKC,WAAaC,gBAAgBH,EAAU,YAGtDI,EAAgC,IAArBH,EAAQrC,SAAkBqC,EAAQf,gBAAkBe,EAE/DI,EAAM,GAEZ,OADAA,EAAID,EAAQtB,UAAYzB,EAAE2B,MAAM3B,EAAEuB,YAAYwB,IACvCC,GAGT,MAAMC,GACJ,MAAMC,EAAQ,CAACC,EAAGhD,EAAMiD,KACtB,IAAItD,EAAM,GACV,GAAIqD,aAAazB,MACf,IAAK,IAAIhB,EAAI,EAAGS,EAAIgC,EAAE1C,OAAQC,EAAIS,EAAGT,GAAK,EACxCZ,GAAUsD,EAAMF,EAAMC,EAAEzC,GAAIP,EAAM,GAAGiD,GAA9B,UAEJ,GAAmB,iBAAR,EAAkB,CAClC,IAAIC,GAAW,EACfvD,GAAO,GAAGsD,KAAOjD,IACjBmD,OAAOC,KAAKJ,GAAGK,QAASC,IACF,MAAhBA,EAAEC,OAAO,GACX5D,GAAO,IAAI2D,EAAEE,OAAO,OAAOR,EAAEM,GAAG3C,cAEhCuC,GAAW,IAGfvD,GAAOuD,EAAW,IAAM,KACpBA,IACFC,OAAOC,KAAKJ,GAAGK,QAASC,IACZ,UAANA,EACF3D,GAAOqD,EAAEM,GACM,WAANA,EACT3D,GAAO,YAAYqD,EAAEM,QACI,MAAhBA,EAAEC,OAAO,KAClB5D,GAAOoD,EAAMC,EAAEM,GAAIA,EAAG,GAAGL,MAG7BtD,GAAO,GAAkC,OAA/BA,EAAI4D,OAAO5D,EAAIW,OAAS,GAAc2C,EAAM,OAAOjD,WAG/DL,GAAO,GAAGsD,KAAOjD,KAAQgD,EAAErC,eAAeX,KAE5C,OAAOL,GAGT,IAAIA,EAAM,GAIV,OAHAwD,OAAOC,KAAKN,GAAQO,QAAS9C,IAC3BZ,GAAOoD,EAAMD,EAAOvC,GAAIA,EAAG,MAEtBZ,ICtNJ,MAAM8D,EAAWC,GAAgD,mBAAxCP,OAAOQ,UAAUhD,SAASiD,KAAKF,GAClDG,EAAWC,GAAaL,EAAQK,GAAWA,EAAU,CAACA,GAEpD,KACbC,KAAM,KAEN,OAAOC,GAEL,OADAC,KAAKF,KAAOC,EACLC,MAGT,gBAAgBC,EAAUC,GAsDxB,OAvCAF,KAAKG,UAdW,CACd,sBAAuB,CACrB,aAAc,iCACd,aAAc,iCACd,WAAY,MACZ,qBAAsB,CACpB,cAAe,SAEjB,eAAgB,CACd,cAAe,cAKIC,IACvB,MAAMC,EAAgBD,EAASE,aAAaC,SAASC,SAASC,SAC3DC,IAAKD,GAAaA,EAASE,qBAC3BD,IAAKD,IAAa,IACdA,EACH1E,KAAM0E,EAAS1E,KAAK,SACpB6E,UAAWhB,EAAQa,EAASG,WAC5BC,2BAA4BjB,EAAQa,EAASI,4BAC7CC,mBAAoBlB,EAAQa,EAASK,oBACrCC,eAAgBN,EAASM,eAAiBN,EAASM,eAAeL,IAAKM,IAAY,CACjFC,kBAAmBD,EAAQE,oBAAoBC,OAAOC,KACtDC,KAAM,WACFC,EACNC,aAAc,CACZC,UAAWf,EAASc,aAAaE,SAASC,YAAY1F,MAAM,KAAK0E,IAAKiB,GAAUC,OAAOD,IACvFE,WAAYpB,EAASc,aAAaE,SAASK,YAAY9F,MAAM,KAAK0E,IAAKiB,GAAUC,OAAOD,IACxFI,IAAK,CACHC,KAAM,OACNC,WAAY,CACVb,KAAMX,EAASc,aAAaE,SAASS,WAI3CC,eAAgB,CACd1B,EAAS0B,eAAeC,WAAWC,cACnC5B,EAAS0B,eAAeC,WAAWE,aAErCC,WAAY,CACV9B,EAAS8B,WAAWH,WAAWC,cAC/B5B,EAAS8B,WAAWH,WAAWE,aAEjCE,eAAgB5C,EAAQa,EAAS+B,gBACjCC,gBAAiB7C,EAAQa,EAASgC,iBAClCC,sBAAuB9C,EAAQa,EAASiC,0BAG5CzC,EAASI,IACRH,GAEIF,MAGT,eAAeY,EAAWX,EAAUC,GAkBlC,OAPAF,KAAKG,UAVW,CACd,sBAAuB,CACrB,cAAe,kCACf,WAAY,MACZ,WAAY,QACZ,iBAAkB,2DAClB,kCAAmC,0CAIdC,IAEvB,MAAMC,EAAgBD,EAASuC,uBAAuBC,YACnDC,kBAAkBnF,KAAKoF,SAASC,OACnC9C,EAASI,IACRH,GAEIF,MAGT,qBAAqBY,EAAWX,EAAUC,GAkCxC,OAxBAF,KAAKG,UATW,CACd,2BAA4B,CAC1B,aAAc,iCACd,WAAY,MACZ,WAAY,QACZ,gBAAiB,6DAIIC,IACvB,MAAMC,EAAgBD,EAAS4C,6BAA6BC,cACzDvC,IAAKM,GAAYA,EAAQkC,2BACzBxC,IAAKM,IAAY,CAChBmC,WAAY,CACVC,UAAW,GACX7G,MAAOyE,EAAQmC,WAAW,UAE5BpH,KAAM,CACJqH,UAAWpC,EAAQjF,KAAKsH,UACxB9G,MAAOyE,EAAQjF,KAAK,UAEtBuH,eAAgBtC,EAAQsC,eAAelC,KACvCmC,SAAU,CAERvB,KAAM9C,OAAOC,KAAK6B,EAAQwC,OAAO,GACjCC,YAAavE,OAAOwE,OAAO1C,EAAQwC,OAAO,GAAGG,IAAI,SAAS3H,MAAM,KAAK0E,IAAKiB,GAAUC,OAAOD,QAIjGiC,QAAQC,IAAIC,KAAKC,UAAU1D,EAAe,KAAM,IAChDJ,EAASI,IACRH,GAEIF,MAGT,oBAAoBY,EAAWH,EAAUuD,EAAU/B,EAAYhC,EAAUC,GACvE,MAAM+D,EAAU,CACdA,QAAS,uBAmBX,OAjBIrD,IACFqD,EAAQrD,UAAYA,GAElBH,IACFwD,EAAQxD,SAAWA,GAEjBuD,GAAYA,EAAS3H,SACvB4H,EAAQhD,kBAAoB+C,GAE1B/B,GAAcA,EAAW5F,SAC3B4H,EAAQC,iBAAmBjC,GAG7BjC,KAAKmE,WAAWF,EAAS,EAAGG,uBAC1BnE,EAASmE,IACRlE,GAEIF,MAGT,eAAeS,EAAUuD,EAAU/B,EAAYoC,EAAMpE,EAAUC,GAC7D,MAAM+D,EAAU,CACdA,QAAS,kBAeX,GAZIxD,IACFwD,EAAQxD,SAAWA,GAGjBuD,GAAYA,EAAS3H,SACvB4H,EAAQhD,kBAAoB+C,GAG1B/B,GAAcA,EAAW5F,SAC3B4H,EAAQC,iBAAmBjC,GAGzBoC,EAAM,CACR,IAAIC,EAGFA,EAFED,EAAKhI,QAA0B,IAAhBgI,EAAKhI,OAEV,SAGA,SAEd,MAAMkI,EAAS,GACfA,EAAOD,GAAa,CAClBE,IAAK,gBACLjI,MAAO8H,GAETJ,EAAQQ,eAAiB,CAACF,GAO5B,OAJAvE,KAAKmE,WAAWF,EAAS,EAAGS,mBAC1BzE,EAASyE,IACRxE,GAEIF,MAGT,WAAWiE,EAASU,EAAWC,GAC7BX,EAAQY,QAAU,MAClBZ,EAAQa,QAAU,QAElB,MAAMC,EAAM,IAAIC,eAEhBD,EAAIE,mBAAqB,KACvB,GAAuB,IAAnBF,EAAIG,WAAkB,CACxB,IAAI9E,EAAW2E,EAAII,aACnB,IACE/E,EAAW0D,KAAKsB,MAAMhF,GACtB,MAAOjC,IAGT,GAAmB,MAAf4G,EAAIM,OACNV,EAAUhF,KAAKK,KAAMI,OAChB,CACL,MAAMjC,EAAI,CACRkH,OAAQN,EAAIO,WACZvF,IAAKC,KAAKF,KACVmE,UACA7D,YAEEwE,GACFA,EAAQjF,KAAKK,KAAM7B,EAAEkH,OAAQlH,EAAE4B,IAAK5B,EAAE8F,QAAS9F,EAAEiC,aAMzD2E,EAAIQ,KAAK,OAAQvF,KAAKF,MAAM,GAC5BiF,EAAIS,iBAAiB,eAAgB,oBACrCT,EAAIS,iBAAiB,SAAU,oBAC/BT,EAAIU,KAAK3B,KAAKC,UAAUE,KAG1B,UAAUA,EAASU,EAAWC,GAC5B,MAAMG,EAAM,IAAIC,eAEhBD,EAAIE,mBAAqB,KACvB,GAAuB,IAAnBF,EAAIG,WAAkB,CACxB,IAAI9E,EAAW2E,EAAII,aACnB,IACE/E,EAAWsF,EAAIC,KAAKvF,GAAU,GAC9B,MAAOjC,IAGT,GAAmB,MAAf4G,EAAIM,OACNV,EAAUhF,KAAKK,KAAMI,OAChB,CACL,MAAMjC,EAAI,CACRkH,OAAQN,EAAIO,WACZvF,IAAKC,KAAKF,KACVmE,UACA7D,YAEEwE,GACFA,EAAQjF,KAAKK,KAAM7B,EAAEkH,OAAQlH,EAAE4B,IAAK5B,EAAE8F,QAAS9F,EAAEiC,aAMzD2E,EAAIQ,KAAK,OAAQvF,KAAKF,MAAM,GAC5BiF,EAAIS,iBAAiB,eAAgB,mBACrCT,EAAIS,iBAAiB,SAAU,mBAC/BT,EAAIU,KAAKC,EAAIE,MAAM3B,O,iCCrQvB,YAYe,KACb4B,OAAQ,CAAC,UAAW,YACpBC,gBAAiB,CAAC,WAAY,iBAAkB,qBAEhD,KAAKC,EAAQC,QACmB1E,IAA1ByE,EAAOE,gBAff,SAAiBlG,GACf,MAAMmG,EAAOC,SAASC,cAAc,QACpCF,EAAKG,aAAa,MAAO,cACzBH,EAAKG,aAAa,OAAQ,YAC1BH,EAAKG,aAAa,OAAQtG,QACN,IAATmG,GACTC,SAASG,qBAAqB,QAAQ,GAAGC,YAAYL,GAUnDM,CAAQT,EAAOE,qBAEO3E,IAApByE,EAAOU,UAA0BT,EAAGU,cAAc,eAEpDV,EAAGU,cAAc,aAAa7I,UAAYkI,EAAOU,UAE/CV,EAAOY,mBACT,IAAGC,KAAI,M,gCCzBb,WAEA,MAAMC,EAAO,CACXD,KAAK,EACLE,OAAQC,UAAUC,UAAYD,UAAUE,iBAG3B,KACbC,QAAQC,GACDA,EAGDN,EAAKD,IACGO,EAAEC,eAAeP,EAAKC,OAAQ,CACtCO,SAAU,QADL,OAIFF,EAAEC,eAAeP,EAAKC,QAPpB,IAAKQ,EAAE,aASlBR,OAAOS,IACDA,IACFV,EAAKC,OAASS,GAETV,EAAKC,QAEdF,IAAIY,SACe,IAANA,IACTX,EAAKD,IAAMY,GAENX,EAAKD","file":"widget-compass-js~widget-gauge-js~widget-jqgrid-js~widget-map-js~widget-panel-js~widget-progressbar-~bc566e36.chunk.js","sourcesContent":["/* This work is licensed under Creative Commons GNU LGPL License.\n\n License: http://creativecommons.org/licenses/LGPL/2.1/\n Version: 0.9\n Author:  Stefan Goessner/2006\n See:     http://goessner.net/download/prj/jsonxml/\n */\nexport default {\n  read(xml, clean) {\n    const X = {\n      at: (clean ? '' : '@'),\n\n      cleanName: (name) => (clean ? name.split(/:(.+)/)[1] || name : name),\n\n      toObj(elem) {\n        let o = {};\n        if (elem.nodeType === 1) { // element node\n          if (elem.attributes.length) { // element with attributes\n            for (let i = 0; i < elem.attributes.length; i += 1) {\n              const { name } = elem.attributes[i];\n              const { value } = elem.attributes[i];\n              const isNs = name.lastIndexOf('xmlns:', 0) === 0;\n              if (!(clean && isNs)) { // Hide xmlns attributes\n                o[X.at + X.cleanName(name)] = (value || '').toString();\n              }\n            }\n          }\n          if (elem.firstChild) { // element has child nodes\n            let textChild = 0;\n            let cdataChild = 0;\n            let hasElementChild = false;\n            for (let n = elem.firstChild; n; n = n.nextSibling) {\n              if (n.nodeType === 1) {\n                hasElementChild = true;\n              } else if (n.nodeType === 3 && n.nodeValue.match(/[^ \\f\\n\\r\\t\\v]/)) {\n                textChild += 1;\n                // non-whitespace text\n              } else if (n.nodeType === 4) {\n                cdataChild += 1;\n                // cdata section node\n              }\n            }\n            if (hasElementChild) {\n              if (textChild < 2 && cdataChild < 2) {\n                // structured element with evtl.\n                // a single text or/and cdata node\n                X.removeWhite(elem);\n                for (let n = elem.firstChild; n; n = n.nextSibling) {\n                  if (n.nodeType === 3) { // text node\n                    o['#text'] = X.escape(n.nodeValue);\n                  } else if (n.nodeType === 4) { // cdata node\n                    o['#cdata'] = X.escape(n.nodeValue);\n                  } else if (o[n.nodeName]) {\n                    // multiple occurence of element\n                    if (o[n.nodeName] instanceof Array) {\n                      o[n.nodeName][o[n.nodeName].length] = X.toObj(n);\n                    } else {\n                      o[n.nodeName] = [o[n.nodeName], X.toObj(n)];\n                    }\n                  } else { // first occurence of element\n                    o[n.nodeName] = X.toObj(n);\n                  }\n                }\n              } else if (!elem.attributes.length) {\n                o = X.escape(X.innerXml(elem));\n              } else {\n                o['#text'] = X.escape(X.innerXml(elem));\n              }\n            } else if (textChild) { // pure text\n              if (!elem.attributes.length) {\n                o = X.escape(X.innerXml(elem));\n              } else {\n                o['#text'] = X.escape(X.innerXml(elem));\n              }\n            } else if (cdataChild) { // cdata\n              if (cdataChild > 1) {\n                o = X.escape(X.innerXml(elem));\n              } else {\n                for (let n = elem.firstChild; n; n = n.nextSibling) {\n                  o['#cdata'] = X.escape(n.nodeValue);\n                }\n              }\n            }\n          }\n          if (!elem.attributes.length && !elem.firstChild) {\n            o = null;\n          }\n        } else if (elem.nodeType === 9) { // document.node\n          o = X.toObj(elem.documentElement);\n        } else if (elem.nodeType === 8) {\n          return elem.data;\n          // A comment\n        } else {\n          // console.error(`unhandled node type: ${elem.nodeType}`);\n        }\n\n        return o;\n      },\n\n      innerXml(node) {\n        let str = '';\n        if ('innerHTML' in node) {\n          str = node.innerHTML;\n        } else {\n          const asXml = (n) => {\n            let s = '';\n            if (n.nodeType === 1) {\n              s += `<${n.nodeName}`;\n              for (let i = 0; i < n.attributes.length; i += 1) {\n                const { name } = n.attributes[i];\n                const value = n.attributes[i].value || '';\n                s += ` ${name}=\"${value.toString()}\"`;\n              }\n              if (n.firstChild) {\n                s += '>';\n                for (let c = n.firstChild; c; c = c.nextSibling) {\n                  s += asXml(c);\n                }\n                s += `</${n.nodeName}>`;\n              } else {\n                s += '/>';\n              }\n            } else if (n.nodeType === 3) {\n              s += n.nodeValue;\n            } else if (n.nodeType === 4) {\n              s += `<![CDATA[${n.nodeValue}]]>`;\n            }\n            return s;\n          };\n\n          for (let c = node.firstChild; c; c = c.nextSibling) {\n            str += asXml(c);\n          }\n        }\n        return str;\n      },\n\n      escape(txt) {\n        return txt.replace(/[\\\\]/g, '\\\\\\\\').replace(/[\"]/g, '\\\\\"').replace(/[\\n]/g, '\\\\n').replace(/[\\r]/g, '\\\\r');\n      },\n\n      removeWhite(e) {\n        e.normalize();\n        for (let n = e.firstChild; n;) {\n          if (n.nodeType === 3) { // text node\n            if (!n.nodeValue.match(/[^ \\f\\n\\r\\t\\v]/)) {\n              // pure whitespace text node\n              const nxt = n.nextSibling;\n              e.removeChild(n);\n              n = nxt;\n            } else {\n              n = n.nextSibling;\n            }\n          } else if (n.nodeType === 1) { // element node\n            X.removeWhite(n);\n            n = n.nextSibling;\n          } else { // any other node\n            n = n.nextSibling;\n          }\n        }\n        return e;\n      },\n    };\n\n    // Strip namespaces from XML tags\n    const cleanXml = clean ? xml.replace(/<(\\/?)([^:>\\s]*:)?([^>]+)>/g, '<$1$3>') : xml;\n\n    // Convert to an XML DOM Document\n    const domRoot = (new DOMParser()).parseFromString(cleanXml, 'text/xml');\n\n    // Start from document's root element\n    const domElem = (domRoot.nodeType === 9) ? domRoot.documentElement : domRoot;\n\n    const ret = {};\n    ret[domElem.nodeName] = X.toObj(X.removeWhite(domElem));\n    return ret;\n  },\n\n  write(object) {\n    const toXml = (v, name, ind) => {\n      let xml = '';\n      if (v instanceof Array) {\n        for (let i = 0, n = v.length; i < n; i += 1) {\n          xml += `${ind + toXml(v[i], name, `${ind}`)}\\n`;\n        }\n      } else if (typeof (v) === 'object') {\n        let hasChild = false;\n        xml += `${ind}<${name}`;\n        Object.keys(v).forEach((m) => {\n          if (m.charAt(0) === '@') {\n            xml += ` ${m.substr(1)}=\"${v[m].toString()}\"`;\n          } else {\n            hasChild = true;\n          }\n        });\n        xml += hasChild ? '>' : '/>';\n        if (hasChild) {\n          Object.keys(v).forEach((m) => {\n            if (m === '#text') {\n              xml += v[m];\n            } else if (m === '#cdata') {\n              xml += `<![CDATA[${v[m]}]]>`;\n            } else if (m.charAt(0) !== '@') {\n              xml += toXml(v[m], m, `${ind}`);\n            }\n          });\n          xml += `${xml.charAt(xml.length - 1) === '\\n' ? ind : ''}</${name}>`;\n        }\n      } else {\n        xml += `${ind}<${name}>${v.toString()}</${name}>`;\n      }\n      return xml;\n    };\n\n    let xml = '';\n    Object.keys(object).forEach((i) => {\n      xml += toXml(object[i], i, '');\n    });\n    return xml;\n  },\n};\n","/* eslint no-underscore-dangle: [\"error\", { \"allowAfterThis\": true }] */\n\nimport XML from './XML';\n\nexport const isArray = (obj) => Object.prototype.toString.call(obj) === '[object Array]';\nexport const toArray = (payload) => (isArray(payload) ? payload : [payload]);\n\nexport default {\n  _url: null,\n\n  setUrl(url) {\n    this._url = url;\n    return this;\n  },\n\n  getCapabilities(callback, errorHandler) {\n    const request = {\n      'sos:GetCapabilities': {\n        '@xmlns:sos': 'http://www.opengis.net/sos/2.0',\n        '@xmlns:ows': 'http://www.opengis.net/ows/1.1',\n        '@service': 'SOS',\n        'ows:AcceptVersions': {\n          'ows:Version': '2.0.0',\n        },\n        'ows:Sections': {\n          'ows:Section': 'Contents',\n        },\n      },\n    };\n\n    this._send_xml(request, (response) => {\n      const cleanResponse = response.Capabilities.contents.Contents.offering\n        .map((offering) => offering.ObservationOffering)\n        .map((offering) => ({\n          ...offering,\n          name: offering.name['#text'],\n          procedure: toArray(offering.procedure),\n          procedureDescriptionFormat: toArray(offering.procedureDescriptionFormat),\n          observableProperty: toArray(offering.observableProperty),\n          relatedFeature: offering.relatedFeature ? offering.relatedFeature.map((feature) => ({\n            featureOfInterest: feature.FeatureRelationship.target.href,\n            role: [],\n          })) : undefined,\n          observedArea: {\n            lowerLeft: offering.observedArea.Envelope.lowerCorner.split(' ').map((coord) => Number(coord)),\n            upperRight: offering.observedArea.Envelope.upperCorner.split(' ').map((coord) => Number(coord)),\n            crs: {\n              type: 'link',\n              properties: {\n                href: offering.observedArea.Envelope.srsName,\n              },\n            },\n          },\n          phenomenonTime: [\n            offering.phenomenonTime.TimePeriod.beginPosition,\n            offering.phenomenonTime.TimePeriod.endPosition,\n          ],\n          resultTime: [\n            offering.resultTime.TimePeriod.beginPosition,\n            offering.resultTime.TimePeriod.endPosition,\n          ],\n          responseFormat: toArray(offering.responseFormat),\n          observationType: toArray(offering.observationType),\n          featureOfInterestType: toArray(offering.featureOfInterestType),\n        }));\n\n      callback(cleanResponse);\n    }, errorHandler);\n\n    return this;\n  },\n\n  describeSensor(procedure, callback, errorHandler) {\n    const request = {\n      'swes:DescribeSensor': {\n        '@xmlns:swes': 'http://www.opengis.net/swes/2.0',\n        '@service': 'SOS',\n        '@version': '2.0.0',\n        'swes:procedure': 'http://sensors.portdebarcelona.cat/def/weather/procedure',\n        'swes:procedureDescriptionFormat': 'http://www.opengis.net/sensorML/1.0.1',\n      },\n    };\n\n    this._send_xml(request, (response) => {\n      // Convert the SensorML description to a JSON object\n      const cleanResponse = response.DescribeSensorResponse.description\n        .SensorDescription.data.SensorML.member;\n      callback(cleanResponse);\n    }, errorHandler);\n\n    return this;\n  },\n\n  getFeatureOfInterest(procedure, callback, errorHandler) {\n    const request = {\n      'sos:GetFeatureOfInterest': {\n        '@xmlns:sos': 'http://www.opengis.net/sos/2.0',\n        '@service': 'SOS',\n        '@version': '2.0.0',\n        'sos:procedure': 'http://sensors.portdebarcelona.cat/def/weather/procedure',\n      },\n    };\n\n    this._send_xml(request, (response) => {\n      const cleanResponse = response.GetFeatureOfInterestResponse.featureMember\n        .map((feature) => feature.SF_SpatialSamplingFeature)\n        .map((feature) => ({\n          identifier: {\n            codespace: '',\n            value: feature.identifier['#text'],\n          },\n          name: {\n            codespace: feature.name.codeSpace,\n            value: feature.name['#text'],\n          },\n          sampledFeature: feature.sampledFeature.href,\n          geometry: {\n            // TODO this won't work for geometry types other than Point\n            type: Object.keys(feature.shape)[0],\n            coordinates: Object.values(feature.shape)[0].pos['#text'].split(' ').map((coord) => Number(coord)),\n          },\n        }));\n\n      console.log(JSON.stringify(cleanResponse, null, 2));\n      callback(cleanResponse);\n    }, errorHandler);\n\n    return this;\n  },\n\n  getDataAvailability(procedure, offering, features, properties, callback, errorHandler) {\n    const request = {\n      request: 'GetDataAvailability',\n    };\n    if (procedure) {\n      request.procedure = procedure;\n    }\n    if (offering) {\n      request.offering = offering;\n    }\n    if (features && features.length) {\n      request.featureOfInterest = features;\n    }\n    if (properties && properties.length) {\n      request.observedProperty = properties;\n    }\n\n    this._send_json(request, ({ dataAvailability }) => {\n      callback(dataAvailability);\n    }, errorHandler);\n\n    return this;\n  },\n\n  getObservation(offering, features, properties, time, callback, errorHandler) {\n    const request = {\n      request: 'GetObservation',\n    };\n\n    if (offering) {\n      request.offering = offering;\n    }\n\n    if (features && features.length) {\n      request.featureOfInterest = features;\n    }\n\n    if (properties && properties.length) {\n      request.observedProperty = properties;\n    }\n\n    if (time) {\n      let operation;\n      if (time.length && time.length === 2) {\n        // Time Range\n        operation = 'during';\n      } else {\n        // Time Instant\n        operation = 'equals';\n      }\n      const filter = {};\n      filter[operation] = {\n        ref: 'om:resultTime',\n        value: time,\n      };\n      request.temporalFilter = [filter];\n    }\n\n    this._send_json(request, ({ observations }) => {\n      callback(observations);\n    }, errorHandler);\n\n    return this;\n  },\n\n  _send_json(request, onSuccess, onError) {\n    request.service = 'SOS';\n    request.version = '2.0.0';\n\n    const xhr = new XMLHttpRequest();\n\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState === 4) {\n        let response = xhr.responseText;\n        try {\n          response = JSON.parse(response);\n        } catch (e) {\n          // OK, not JSON\n        }\n        if (xhr.status === 200) {\n          onSuccess.call(this, response);\n        } else {\n          const e = {\n            status: xhr.statusText,\n            url: this._url,\n            request,\n            response,\n          };\n          if (onError) {\n            onError.call(this, e.status, e.url, e.request, e.response);\n          }\n        }\n      }\n    };\n\n    xhr.open('POST', this._url, true);\n    xhr.setRequestHeader('Content-Type', 'application/json');\n    xhr.setRequestHeader('Accept', 'application/json');\n    xhr.send(JSON.stringify(request));\n  },\n\n  _send_xml(request, onSuccess, onError) {\n    const xhr = new XMLHttpRequest();\n\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState === 4) {\n        let response = xhr.responseText;\n        try {\n          response = XML.read(response, true);\n        } catch (e) {\n          // OK, not XML\n        }\n        if (xhr.status === 200) {\n          onSuccess.call(this, response);\n        } else {\n          const e = {\n            status: xhr.statusText,\n            url: this._url,\n            request,\n            response,\n          };\n          if (onError) {\n            onError.call(this, e.status, e.url, e.request, e.response);\n          }\n        }\n      }\n    };\n\n    xhr.open('POST', this._url, true);\n    xhr.setRequestHeader('Content-Type', 'application/xml');\n    xhr.setRequestHeader('Accept', 'application/xml');\n    xhr.send(XML.write(request));\n  },\n};\n","import ld from './locale-date';\n\nfunction loadCSS(url) {\n  const link = document.createElement('link');\n  link.setAttribute('rel', 'stylesheet');\n  link.setAttribute('type', 'text/css');\n  link.setAttribute('href', url);\n  if (typeof link !== 'undefined') {\n    document.getElementsByTagName('head')[0].appendChild(link);\n  }\n}\n\nexport default {\n  inputs: ['service', 'offering'],\n  optional_inputs: ['footnote', 'custom_css_url', 'display_utc_times'],\n\n  init(config, el) {\n    if (config.custom_css_url !== undefined) {\n      loadCSS(config.custom_css_url);\n    }\n    if (config.footnote !== undefined && el.querySelector('.footnote')) {\n      // eslint-disable-next-line no-param-reassign\n      el.querySelector('.footnote').innerHTML = config.footnote;\n    }\n    if (config.display_utc_times) {\n      ld.utc(true);\n    }\n  },\n};\n","import i18n from './i18n';\n\nconst date = {\n  utc: false,\n  locale: navigator.language || navigator.browserLanguage,\n};\n\nexport default {\n  display(d) {\n    if (!d) {\n      return i18n.t('(no date)');\n    }\n    if (date.utc) {\n      return `${d.toLocaleString(date.locale, {\n        timeZone: 'UTC',\n      })} UTC`;\n    }\n    return d.toLocaleString(date.locale);\n  },\n  locale(l) {\n    if (l) {\n      date.locale = l;\n    }\n    return date.locale;\n  },\n  utc(u) {\n    if (typeof u !== 'undefined') {\n      date.utc = u;\n    }\n    return date.utc;\n  },\n};\n"],"sourceRoot":""}