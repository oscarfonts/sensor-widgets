{"version":3,"sources":["webpack:///./src/js/XML.js","webpack:///./src/js/SOS.js","webpack:///./src/js/widget-common.js","webpack:///./src/js/locale-date.js"],"names":["xml","clean","X","at","cleanName","name","split","elem","o","nodeType","attributes","length","i","value","isNs","lastIndexOf","toString","firstChild","textChild","cdataChild","hasElementChild","n","nextSibling","nodeValue","match","removeWhite","escape","nodeName","Array","toObj","innerXml","documentElement","data","node","str","innerHTML","asXml","s","c","txt","replace","e","normalize","nxt","removeChild","cleanXml","domRoot","DOMParser","parseFromString","domElem","ret","object","toXml","v","ind","hasChild","Object","keys","forEach","m","charAt","substr","isArray","obj","prototype","call","toArray","payload","sendXml","url","request","onSuccess","onError","xhr","XMLHttpRequest","onreadystatechange","readyState","response","responseText","XML","read","status","ExceptionReport","errorMessage","Exception","ExceptionText","statusText","document","hrefs","resolve","part","map","item","resolvedObject","entries","key","id","href","startsWith","val","substring","resolveXmlLocalHrefs","open","setRequestHeader","send","write","_url","this","callback","errorHandler","cleanResponse","Capabilities","contents","Contents","offering","ObservationOffering","procedure","procedureDescriptionFormat","observableProperty","relatedFeature","feature","featureOfInterest","FeatureRelationship","target","role","undefined","observedArea","lowerLeft","Envelope","lowerCorner","coord","Number","upperRight","upperCorner","crs","type","properties","srsName","phenomenonTime","TimePeriod","beginPosition","endPosition","resultTime","responseFormat","observationType","featureOfInterestType","DescribeSensorResponse","description","SensorDescription","SensorML","member","GetFeatureOfInterestResponse","featureMember","SF_SpatialSamplingFeature","identifier","codespace","codeSpace","sampledFeature","geometry","shape","coordinates","values","pos","features","GetDataAvailabilityResponse","dataAvailabilityMember","observedProperty","time","temporalFilter","GetObservationResponse","observationData","observation","OM_Observation","title","TimeInstant","timePosition","result","uom","inputs","optional_inputs","config","el","custom_css_url","link","createElement","setAttribute","getElementsByTagName","appendChild","loadCSS","footnote","querySelector","display_utc_times","utc","date","locale","navigator","language","browserLanguage","display","d","toLocaleString","timeZone","t","l","u"],"mappings":"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","file":"widget-compass-js~widget-gauge-js~widget-jqgrid-js~widget-map-js~widget-panel-js~widget-progressbar-~bc566e36.chunk.js","sourcesContent":["/* This work is licensed under Creative Commons GNU LGPL License.\n\n License: http://creativecommons.org/licenses/LGPL/2.1/\n Version: 0.9\n Author:  Stefan Goessner/2006\n See:     http://goessner.net/download/prj/jsonxml/\n */\nexport default {\n  read(xml, clean) {\n    const X = {\n      at: (clean ? '' : '@'),\n\n      cleanName: (name) => (clean ? name.split(/:(.+)/)[1] || name : name),\n\n      toObj(elem) {\n        let o = {};\n        if (elem.nodeType === 1) { // element node\n          if (elem.attributes.length) { // element with attributes\n            for (let i = 0; i < elem.attributes.length; i += 1) {\n              const { name } = elem.attributes[i];\n              const { value } = elem.attributes[i];\n              const isNs = name.lastIndexOf('xmlns:', 0) === 0;\n              if (!(clean && isNs)) { // Hide xmlns attributes\n                o[X.at + X.cleanName(name)] = (value || '').toString();\n              }\n            }\n          }\n          if (elem.firstChild) { // element has child nodes\n            let textChild = 0;\n            let cdataChild = 0;\n            let hasElementChild = false;\n            for (let n = elem.firstChild; n; n = n.nextSibling) {\n              if (n.nodeType === 1) {\n                hasElementChild = true;\n              } else if (n.nodeType === 3 && n.nodeValue.match(/[^ \\f\\n\\r\\t\\v]/)) {\n                textChild += 1;\n                // non-whitespace text\n              } else if (n.nodeType === 4) {\n                cdataChild += 1;\n                // cdata section node\n              }\n            }\n            if (hasElementChild) {\n              if (textChild < 2 && cdataChild < 2) {\n                // structured element with evtl.\n                // a single text or/and cdata node\n                X.removeWhite(elem);\n                for (let n = elem.firstChild; n; n = n.nextSibling) {\n                  if (n.nodeType === 3) { // text node\n                    o['#text'] = X.escape(n.nodeValue);\n                  } else if (n.nodeType === 4) { // cdata node\n                    o['#cdata'] = X.escape(n.nodeValue);\n                  } else if (o[n.nodeName]) {\n                    // multiple occurence of element\n                    if (o[n.nodeName] instanceof Array) {\n                      o[n.nodeName][o[n.nodeName].length] = X.toObj(n);\n                    } else {\n                      o[n.nodeName] = [o[n.nodeName], X.toObj(n)];\n                    }\n                  } else { // first occurence of element\n                    o[n.nodeName] = X.toObj(n);\n                  }\n                }\n              } else if (!elem.attributes.length) {\n                o = X.escape(X.innerXml(elem));\n              } else {\n                o['#text'] = X.escape(X.innerXml(elem));\n              }\n            } else if (textChild) { // pure text\n              if (!elem.attributes.length) {\n                o = X.escape(X.innerXml(elem));\n              } else {\n                o['#text'] = X.escape(X.innerXml(elem));\n              }\n            } else if (cdataChild) { // cdata\n              if (cdataChild > 1) {\n                o = X.escape(X.innerXml(elem));\n              } else {\n                for (let n = elem.firstChild; n; n = n.nextSibling) {\n                  o['#cdata'] = X.escape(n.nodeValue);\n                }\n              }\n            }\n          }\n          if (!elem.attributes.length && !elem.firstChild) {\n            o = null;\n          }\n        } else if (elem.nodeType === 9) { // document.node\n          o = X.toObj(elem.documentElement);\n        } else if (elem.nodeType === 8) {\n          return elem.data;\n          // A comment\n        } else {\n          // console.error(`unhandled node type: ${elem.nodeType}`);\n        }\n\n        return o;\n      },\n\n      innerXml(node) {\n        let str = '';\n        if ('innerHTML' in node) {\n          str = node.innerHTML;\n        } else {\n          const asXml = (n) => {\n            let s = '';\n            if (n.nodeType === 1) {\n              s += `<${n.nodeName}`;\n              for (let i = 0; i < n.attributes.length; i += 1) {\n                const { name } = n.attributes[i];\n                const value = n.attributes[i].value || '';\n                s += ` ${name}=\"${value.toString()}\"`;\n              }\n              if (n.firstChild) {\n                s += '>';\n                for (let c = n.firstChild; c; c = c.nextSibling) {\n                  s += asXml(c);\n                }\n                s += `</${n.nodeName}>`;\n              } else {\n                s += '/>';\n              }\n            } else if (n.nodeType === 3) {\n              s += n.nodeValue;\n            } else if (n.nodeType === 4) {\n              s += `<![CDATA[${n.nodeValue}]]>`;\n            }\n            return s;\n          };\n\n          for (let c = node.firstChild; c; c = c.nextSibling) {\n            str += asXml(c);\n          }\n        }\n        return str;\n      },\n\n      escape(txt) {\n        return txt.replace(/[\\\\]/g, '\\\\\\\\').replace(/[\"]/g, '\\\\\"').replace(/[\\n]/g, '\\\\n').replace(/[\\r]/g, '\\\\r');\n      },\n\n      removeWhite(e) {\n        e.normalize();\n        for (let n = e.firstChild; n;) {\n          if (n.nodeType === 3) { // text node\n            if (!n.nodeValue.match(/[^ \\f\\n\\r\\t\\v]/)) {\n              // pure whitespace text node\n              const nxt = n.nextSibling;\n              e.removeChild(n);\n              n = nxt;\n            } else {\n              n = n.nextSibling;\n            }\n          } else if (n.nodeType === 1) { // element node\n            X.removeWhite(n);\n            n = n.nextSibling;\n          } else { // any other node\n            n = n.nextSibling;\n          }\n        }\n        return e;\n      },\n    };\n\n    // Strip namespaces from XML tags\n    const cleanXml = clean ? xml.replace(/<(\\/?)([^:>\\s]*:)?([^>]+)>/g, '<$1$3>') : xml;\n\n    // Convert to an XML DOM Document\n    const domRoot = (new DOMParser()).parseFromString(cleanXml, 'text/xml');\n\n    // Start from document's root element\n    const domElem = (domRoot.nodeType === 9) ? domRoot.documentElement : domRoot;\n\n    const ret = {};\n    ret[domElem.nodeName] = X.toObj(X.removeWhite(domElem));\n    return ret;\n  },\n\n  write(object) {\n    const toXml = (v, name, ind) => {\n      let xml = '';\n      if (v instanceof Array) {\n        for (let i = 0, n = v.length; i < n; i += 1) {\n          xml += `${ind + toXml(v[i], name, `${ind}`)}\\n`;\n        }\n      } else if (typeof (v) === 'object') {\n        let hasChild = false;\n        xml += `${ind}<${name}`;\n        Object.keys(v).forEach((m) => {\n          if (m.charAt(0) === '@') {\n            xml += ` ${m.substr(1)}=\"${v[m].toString()}\"`;\n          } else {\n            hasChild = true;\n          }\n        });\n        xml += hasChild ? '>' : '/>';\n        if (hasChild) {\n          Object.keys(v).forEach((m) => {\n            if (m === '#text') {\n              xml += v[m];\n            } else if (m === '#cdata') {\n              xml += `<![CDATA[${v[m]}]]>`;\n            } else if (m.charAt(0) !== '@') {\n              xml += toXml(v[m], m, `${ind}`);\n            }\n          });\n          xml += `${xml.charAt(xml.length - 1) === '\\n' ? ind : ''}</${name}>`;\n        }\n      } else {\n        xml += `${ind}<${name}>${v.toString()}</${name}>`;\n      }\n      return xml;\n    };\n\n    let xml = '';\n    Object.keys(object).forEach((i) => {\n      xml += toXml(object[i], i, '');\n    });\n    return xml;\n  },\n};\n","/* eslint no-underscore-dangle: [\"error\", { \"allowAfterThis\": true }] */\n\nimport XML from './XML';\n\nexport const isArray = (obj) => Object.prototype.toString.call(obj) === '[object Array]';\nexport const toArray = (payload) => (isArray(payload) ? payload : [payload]);\nexport const isObject = (val) => (typeof val === 'object');\n\nfunction resolveXmlLocalHrefs(document) {\n  const hrefs = {};\n\n  const resolve = (part) => {\n    if (isArray(part)) {\n      return part.map((item) => resolve(item));\n    }\n\n    if (!isObject(part)) {\n      return part;\n    }\n\n    const resolvedObject = {};\n\n    Object.entries(part).forEach(([key, value]) => {\n      if (value.id) {\n        hrefs[value.id] = { [key]: resolve(value) };\n      }\n      if (value.href && value.href.startsWith('#')) {\n        const { href, ...val } = value;\n        resolvedObject[key] = {\n          ...val,\n          ...hrefs[href.substring(1)],\n        };\n      } else {\n        resolvedObject[key] = resolve(value);\n      }\n    });\n\n    return resolvedObject;\n  };\n\n  return resolve(document);\n}\n\nfunction sendXml(url, request, onSuccess, onError) {\n  const xhr = new XMLHttpRequest();\n\n  xhr.onreadystatechange = () => {\n    if (xhr.readyState === 4) {\n      let response = xhr.responseText;\n      try {\n        response = XML.read(response, true);\n      } catch (e) {\n        // OK, not XML\n      }\n      if (xhr.status === 200 && !response.ExceptionReport) {\n        onSuccess.call(null, resolveXmlLocalHrefs(response));\n      } else if (onError) {\n        const errorMessage = response.ExceptionReport\n          ? response.ExceptionReport.Exception.ExceptionText\n          : xhr.statusText;\n        onError.call(null, errorMessage, url, request, response);\n      }\n    }\n  };\n\n  xhr.open('POST', url, true);\n  xhr.setRequestHeader('Content-Type', 'application/xml');\n  xhr.setRequestHeader('Accept', 'application/xml');\n  xhr.send(XML.write(request));\n}\n\nexport default {\n  _url: null,\n\n  setUrl(url) {\n    this._url = url;\n    return this;\n  },\n\n  getCapabilities(callback, errorHandler) {\n    const request = {\n      'sos:GetCapabilities': {\n        '@xmlns:sos': 'http://www.opengis.net/sos/2.0',\n        '@xmlns:ows': 'http://www.opengis.net/ows/1.1',\n        '@service': 'SOS',\n        'ows:AcceptVersions': {\n          'ows:Version': '2.0.0',\n        },\n        'ows:Sections': {\n          'ows:Section': 'Contents',\n        },\n      },\n    };\n\n    sendXml(this._url, request, (response) => {\n      const cleanResponse = response.Capabilities.contents.Contents.offering\n        .map((offering) => offering.ObservationOffering)\n        .map((offering) => ({\n          ...offering,\n          name: offering.name['#text'],\n          procedure: toArray(offering.procedure),\n          procedureDescriptionFormat: toArray(offering.procedureDescriptionFormat),\n          observableProperty: toArray(offering.observableProperty),\n          relatedFeature: offering.relatedFeature ? offering.relatedFeature.map((feature) => ({\n            featureOfInterest: feature.FeatureRelationship.target.href,\n            role: [],\n          })) : undefined,\n          observedArea: {\n            lowerLeft: offering.observedArea.Envelope.lowerCorner.split(' ').map((coord) => Number(coord)),\n            upperRight: offering.observedArea.Envelope.upperCorner.split(' ').map((coord) => Number(coord)),\n            crs: {\n              type: 'link',\n              properties: {\n                href: offering.observedArea.Envelope.srsName,\n              },\n            },\n          },\n          phenomenonTime: [\n            offering.phenomenonTime.TimePeriod.beginPosition,\n            offering.phenomenonTime.TimePeriod.endPosition,\n          ],\n          resultTime: [\n            offering.resultTime.TimePeriod.beginPosition,\n            offering.resultTime.TimePeriod.endPosition,\n          ],\n          responseFormat: toArray(offering.responseFormat),\n          observationType: toArray(offering.observationType),\n          featureOfInterestType: toArray(offering.featureOfInterestType),\n        }));\n\n      callback(cleanResponse);\n    }, errorHandler);\n\n    return this;\n  },\n\n  describeSensor(procedure, callback, errorHandler) {\n    const request = {\n      'swes:DescribeSensor': {\n        '@xmlns:swes': 'http://www.opengis.net/swes/2.0',\n        '@service': 'SOS',\n        '@version': '2.0.0',\n        'swes:procedure': 'http://sensors.portdebarcelona.cat/def/weather/procedure',\n        'swes:procedureDescriptionFormat': 'http://www.opengis.net/sensorML/1.0.1',\n      },\n    };\n\n    sendXml(this._url, request, (response) => {\n      // Convert the SensorML description to a JSON object\n      const cleanResponse = response.DescribeSensorResponse.description\n        .SensorDescription.data.SensorML.member;\n      callback(cleanResponse);\n    }, errorHandler);\n\n    return this;\n  },\n\n  getFeatureOfInterest(procedure, callback, errorHandler) {\n    const request = {\n      'sos:GetFeatureOfInterest': {\n        '@xmlns:sos': 'http://www.opengis.net/sos/2.0',\n        '@service': 'SOS',\n        '@version': '2.0.0',\n        'sos:procedure': 'http://sensors.portdebarcelona.cat/def/weather/procedure',\n      },\n    };\n\n    sendXml(this._url, request, (response) => {\n      const cleanResponse = toArray(response.GetFeatureOfInterestResponse.featureMember)\n        .map((feature) => feature.SF_SpatialSamplingFeature)\n        .map((feature) => ({\n          identifier: {\n            codespace: '',\n            value: feature.identifier['#text'],\n          },\n          name: {\n            codespace: feature.name.codeSpace,\n            value: feature.name['#text'],\n          },\n          sampledFeature: feature.sampledFeature.href,\n          geometry: {\n            // TODO this won't work for geometry types other than Point\n            type: Object.keys(feature.shape)[0],\n            coordinates: Object.values(feature.shape)[0].pos['#text'].split(' ').map((coord) => Number(coord)),\n          },\n        }));\n\n      callback(cleanResponse);\n    }, errorHandler);\n\n    return this;\n  },\n\n  getDataAvailability(procedure, offering, features, properties, callback, errorHandler) {\n    const request = {\n      'gda:GetDataAvailability': {\n        '@xmlns:gda': 'http://www.opengis.net/sosgda/1.0',\n        '@service': 'SOS',\n        '@version': '2.0.0',\n        'gda:procedure': 'http://sensors.portdebarcelona.cat/def/weather/procedure',\n        ...(procedure && { 'gda:procedure': procedure }),\n        ...(offering && { 'gda:offering': offering }),\n        ...(features && features.length && { 'gda:featureOfInterest': features }),\n        ...(properties && properties.length && { 'gda:observedProperty': properties }),\n      },\n    };\n\n    sendXml(this._url, request, (response) => {\n      const cleanResponse = toArray(response.GetDataAvailabilityResponse.dataAvailabilityMember)\n        .map((member) => ({\n          featureOfInterest: member.featureOfInterest.href,\n          procedure: member.procedure.href,\n          observedProperty: member.observedProperty.href,\n          phenomenonTime: [\n            member.phenomenonTime.TimePeriod.beginPosition,\n            member.phenomenonTime.TimePeriod.endPosition,\n          ],\n        }));\n\n      callback(cleanResponse);\n    }, errorHandler);\n\n    return this;\n  },\n\n  getObservation(offering, features, properties, time, callback, errorHandler) {\n    let temporalFilter;\n    if (time) {\n      if (time.length && time.length === 2) {\n        temporalFilter = {\n          'fes:During': {\n            'fes:ValueReference': 'resultTime',\n            'gml:TimePeriod': {\n              '@gml:id': 'tp_1',\n              'gml:beginPosition': time[0],\n              'gml:endPosition': time[1],\n            },\n          },\n        };\n      } else {\n        temporalFilter = {\n          'fes:TEquals': {\n            'fes:ValueReference': 'resultTime',\n            'gml:TimeInstant': {\n              '@gml:id': 'ti_1',\n              'gml:timePosition': time,\n            },\n          },\n        };\n      }\n    }\n\n    const request = {\n      'sos:GetObservation': {\n        '@xmlns:sos': 'http://www.opengis.net/sos/2.0',\n        '@xmlns:fes': 'http://www.opengis.net/fes/2.0',\n        '@xmlns:gml': 'http://www.opengis.net/gml/3.2',\n        '@service': 'SOS',\n        '@version': '2.0.0',\n        ...(offering && { 'sos:offering': offering }),\n        ...(properties && properties.length && { 'sos:observedProperty': properties }),\n        ...(temporalFilter && { 'sos:temporalFilter': temporalFilter }),\n        ...(features && features.length && { 'sos:featureOfInterest': features }),\n      },\n    };\n\n    sendXml(this._url, request, (response) => {\n      const cleanResponse = toArray(response.GetObservationResponse.observationData)\n        .map((observation) => observation.OM_Observation)\n        .map((observation) => ({\n          type: observation.type.href,\n          procedure: observation.procedure.href,\n          observableProperty: observation.observedProperty.href,\n          featureOfInterest: {\n            identifier: {\n              codespace: 'http://www.opengis.net/def/nil/OGC/0/unknown',\n              value: observation.featureOfInterest.href,\n            },\n            name: {\n              codespace: 'http://www.opengis.net/def/nil/OGC/0/unknown',\n              value: observation.featureOfInterest.title,\n            },\n          },\n          phenomenonTime: observation.phenomenonTime.TimeInstant\n            ? observation.phenomenonTime.TimeInstant.timePosition\n            : [observation.phenomenonTime.TimePeriod.beginPosition,\n              observation.phenomenonTime.TimePeriod.endPosition],\n          resultTime: observation.resultTime.TimeInstant.timePosition,\n          result: {\n            uom: observation.result.uom,\n            value: observation.result['#text'],\n          },\n        }));\n      callback(cleanResponse);\n    }, errorHandler);\n\n    return this;\n  },\n};\n","import ld from './locale-date';\n\nfunction loadCSS(url) {\n  const link = document.createElement('link');\n  link.setAttribute('rel', 'stylesheet');\n  link.setAttribute('type', 'text/css');\n  link.setAttribute('href', url);\n  if (typeof link !== 'undefined') {\n    document.getElementsByTagName('head')[0].appendChild(link);\n  }\n}\n\nexport default {\n  inputs: ['service', 'offering'],\n  optional_inputs: ['footnote', 'custom_css_url', 'display_utc_times'],\n\n  init(config, el) {\n    if (config.custom_css_url !== undefined) {\n      loadCSS(config.custom_css_url);\n    }\n    if (config.footnote !== undefined && el.querySelector('.footnote')) {\n      // eslint-disable-next-line no-param-reassign\n      el.querySelector('.footnote').innerHTML = config.footnote;\n    }\n    if (config.display_utc_times) {\n      ld.utc(true);\n    }\n  },\n};\n","import i18n from './i18n';\n\nconst date = {\n  utc: false,\n  locale: navigator.language || navigator.browserLanguage,\n};\n\nexport default {\n  display(d) {\n    if (!d) {\n      return i18n.t('(no date)');\n    }\n    if (date.utc) {\n      return `${d.toLocaleString(date.locale, {\n        timeZone: 'UTC',\n      })} UTC`;\n    }\n    return d.toLocaleString(date.locale);\n  },\n  locale(l) {\n    if (l) {\n      date.locale = l;\n    }\n    return date.locale;\n  },\n  utc(u) {\n    if (typeof u !== 'undefined') {\n      date.utc = u;\n    }\n    return date.utc;\n  },\n};\n"],"sourceRoot":""}