(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["vendors~widget-jqgrid-js"],{

/***/ "./node_modules/css-loader/dist/cjs.js!./node_modules/jqgrid/css/ui.jqgrid.css":
/*!*************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./node_modules/jqgrid/css/ui.jqgrid.css ***!
  \*************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
/* harmony import */ var _css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__);
// Imports

var ___CSS_LOADER_EXPORT___ = _css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()(true);
// Module
___CSS_LOADER_EXPORT___.push([module.i, "/*Grid*/\r\n.ui-jqgrid {position: relative;}\r\n.ui-jqgrid .ui-jqgrid-view {position: relative;left:0; top: 0; padding: 0; font-size:11px;}\r\n/* caption*/\r\n.ui-jqgrid .ui-jqgrid-titlebar {padding: .3em .2em .2em .3em; position: relative; font-size: 12px; border-left: 0 none;border-right: 0 none; border-top: 0 none;}\r\n.ui-jqgrid .ui-jqgrid-caption {text-align: left;}\r\n.ui-jqgrid .ui-jqgrid-title { margin: .1em 0 .2em; }\r\n.ui-jqgrid .ui-jqgrid-titlebar-close { position: absolute;top: 50%; width: 19px; margin: -10px 0 0 0; padding: 1px; height:18px; cursor:pointer;}\r\n.ui-jqgrid .ui-jqgrid-titlebar-close span { display: block; margin: 1px; }\r\n.ui-jqgrid .ui-jqgrid-titlebar-close:hover { padding: 0; }\r\n/* header*/\r\n.ui-jqgrid .ui-jqgrid-hdiv {position: relative; margin: 0;padding: 0; overflow-x: hidden; border-left: 0 none !important; border-top : 0 none !important; border-right : 0 none !important;}\r\n.ui-jqgrid .ui-jqgrid-hbox {float: left; padding-right: 20px;}\r\n.ui-jqgrid .ui-jqgrid-htable {table-layout:fixed;margin:0;}\r\n.ui-jqgrid .ui-jqgrid-htable th {height:22px;padding: 0 2px 0 2px;}\r\n.ui-jqgrid .ui-jqgrid-htable th div {overflow: hidden; position:relative; height:17px;}\r\n.ui-th-column, .ui-jqgrid .ui-jqgrid-htable th.ui-th-column {overflow: hidden;white-space: nowrap;text-align:center;border-top : 0 none;border-bottom : 0 none;}\r\n.ui-th-ltr, .ui-jqgrid .ui-jqgrid-htable th.ui-th-ltr {border-left : 0 none;}\r\n.ui-th-rtl, .ui-jqgrid .ui-jqgrid-htable th.ui-th-rtl {border-right : 0 none;}\r\n.ui-first-th-ltr {border-right: 1px solid; }\r\n.ui-first-th-rtl {border-left: 1px solid; }\r\n.ui-jqgrid .ui-th-div-ie {white-space: nowrap; zoom :1; height:17px;}\r\n.ui-jqgrid .ui-jqgrid-resize {height:20px !important;position: relative; cursor :e-resize;display: inline;overflow: hidden;}\r\n.ui-jqgrid .ui-grid-ico-sort {overflow:hidden;position:absolute;display:inline; cursor: pointer !important;}\r\n.ui-jqgrid .ui-icon-asc {margin-top:-3px; height:12px;}\r\n.ui-jqgrid .ui-icon-desc {margin-top:3px;height:12px;}\r\n.ui-jqgrid .ui-i-asc {margin-top:0;height:16px;}\r\n.ui-jqgrid .ui-i-desc {margin-top:0;margin-left:13px;height:16px;}\r\n.ui-jqgrid .ui-jqgrid-sortable {cursor:pointer;}\r\n.ui-jqgrid tr.ui-search-toolbar th { border-top-width: 1px !important; border-top-color: inherit !important; border-top-style: ridge !important }\r\ntr.ui-search-toolbar input {margin: 1px 0 0 0}\r\ntr.ui-search-toolbar select {margin: 1px 0 0 0}\r\n/* body */ \r\n.ui-jqgrid .ui-jqgrid-bdiv {position: relative; margin: 0; padding:0; overflow: auto; text-align:left;}\r\n.ui-jqgrid .ui-jqgrid-btable {table-layout:fixed; margin:0; outline-style: none; }\r\n.ui-jqgrid tr.jqgrow { outline-style: none; }\r\n.ui-jqgrid tr.jqgroup { outline-style: none; }\r\n.ui-jqgrid tr.jqgrow td {font-weight: normal; overflow: hidden; white-space: pre; height: 22px;padding: 0 2px 0 2px;border-bottom-width: 1px; border-bottom-color: inherit; border-bottom-style: solid;}\r\n.ui-jqgrid tr.jqgfirstrow td {padding: 0 2px 0 2px;border-right-width: 1px; border-right-style: solid;}\r\n.ui-jqgrid tr.jqgroup td {font-weight: normal; overflow: hidden; white-space: pre; height: 22px;padding: 0 2px 0 2px;border-bottom-width: 1px; border-bottom-color: inherit; border-bottom-style: solid;}\r\n.ui-jqgrid tr.jqfoot td {font-weight: bold; overflow: hidden; white-space: pre; height: 22px;padding: 0 2px 0 2px;border-bottom-width: 1px; border-bottom-color: inherit; border-bottom-style: solid;}\r\n.ui-jqgrid tr.ui-row-ltr td {text-align:left;border-right-width: 1px; border-right-color: inherit; border-right-style: solid;}\r\n.ui-jqgrid tr.ui-row-rtl td {text-align:right;border-left-width: 1px; border-left-color: inherit; border-left-style: solid;}\r\n.ui-jqgrid td.jqgrid-rownum { padding: 0 2px 0 2px; margin: 0; border: 0 none;}\r\n.ui-jqgrid .ui-jqgrid-resize-mark { width:2px; left:0; background-color:#777; cursor: e-resize; cursor: col-resize; position:absolute; top:0; height:100px; overflow:hidden; display:none; border:0 none; z-index: 99999;}\r\n/* footer */\r\n.ui-jqgrid .ui-jqgrid-sdiv {position: relative; margin: 0;padding: 0; overflow: hidden; border-left: 0 none !important; border-top : 0 none !important; border-right : 0 none !important;}\r\n.ui-jqgrid .ui-jqgrid-ftable {table-layout:fixed; margin-bottom:0;}\r\n.ui-jqgrid tr.footrow td {font-weight: bold; overflow: hidden; white-space:nowrap; height: 21px;padding: 0 2px 0 2px;border-top-width: 1px; border-top-color: inherit; border-top-style: solid;}\r\n.ui-jqgrid tr.footrow-ltr td {text-align:left;border-right-width: 1px; border-right-color: inherit; border-right-style: solid;}\r\n.ui-jqgrid tr.footrow-rtl td {text-align:right;border-left-width: 1px; border-left-color: inherit; border-left-style: solid;}\r\n/* Pager*/\r\n.ui-jqgrid .ui-jqgrid-pager { border-left: 0 none !important;border-right: 0 none !important; border-bottom: 0 none !important; margin: 0 !important; padding: 0 !important; position: relative; height: 25px;white-space: nowrap;overflow: hidden;font-size:11px;}\r\n.ui-jqgrid .ui-pager-control {position: relative;}\r\n.ui-jqgrid .ui-pg-table {position: relative; padding-bottom:2px; width:auto; margin: 0;}\r\n.ui-jqgrid .ui-pg-table td {font-weight:normal; vertical-align:middle; padding:1px;}\r\n.ui-jqgrid .ui-pg-button  { height:19px !important;}\r\n.ui-jqgrid .ui-pg-button span { display: block; margin: 1px; float:left;}\r\n.ui-jqgrid .ui-pg-button:hover { padding: 0; }\r\n.ui-jqgrid .ui-state-disabled:hover {padding:1px;}\r\n.ui-jqgrid .ui-pg-input { height:13px;font-size:.8em; margin: 0;}\r\n.ui-jqgrid .ui-pg-selbox {font-size:.8em; line-height:18px; display:block; height:18px; margin: 0;}\r\n.ui-jqgrid .ui-separator {height: 18px; border-left: 1px solid #ccc ; border-right: 1px solid #ccc ; margin: 1px; float: right;}\r\n.ui-jqgrid .ui-paging-info {font-weight: normal;height:19px; margin-top:3px;margin-right:4px;}\r\n.ui-jqgrid .ui-jqgrid-pager .ui-pg-div {padding:1px 0;float:left;position:relative;}\r\n.ui-jqgrid .ui-jqgrid-pager .ui-pg-button { cursor:pointer; }\r\n.ui-jqgrid .ui-jqgrid-pager .ui-pg-div  span.ui-icon {float:left;margin:0 2px;}\r\n.ui-jqgrid td input, .ui-jqgrid td select .ui-jqgrid td textarea { margin: 0;}\r\n.ui-jqgrid td textarea {width:auto;height:auto;}\r\n.ui-jqgrid .ui-jqgrid-toppager {border-left: 0 none !important;border-right: 0 none !important; border-top: 0 none !important; margin: 0 !important; padding: 0 !important; position: relative; height: 25px !important;white-space: nowrap;overflow: hidden;}\r\n.ui-jqgrid .ui-jqgrid-toppager .ui-pg-div {padding:1px 0;float:left;position:relative;}\r\n.ui-jqgrid .ui-jqgrid-toppager .ui-pg-button { cursor:pointer; }\r\n.ui-jqgrid .ui-jqgrid-toppager .ui-pg-div  span.ui-icon {float:left;margin:0 2px;}\r\n/*subgrid*/\r\n.ui-jqgrid .ui-jqgrid-btable .ui-sgcollapsed span {display: block;}\r\n.ui-jqgrid .ui-subgrid {margin:0;padding:0; width:100%;}\r\n.ui-jqgrid .ui-subgrid table {table-layout: fixed;}\r\n.ui-jqgrid .ui-subgrid tr.ui-subtblcell td {height:18px;border-right-width: 1px; border-right-color: inherit; border-right-style: solid;border-bottom-width: 1px; border-bottom-color: inherit; border-bottom-style: solid;}\r\n.ui-jqgrid .ui-subgrid td.subgrid-data {border-top:  0 none !important;}\r\n.ui-jqgrid .ui-subgrid td.subgrid-cell {border-width: 0 0 1px 0;}\r\n.ui-jqgrid .ui-th-subgrid {height:20px;}\r\n/* loading */\r\n.ui-jqgrid .loading {position: absolute; top: 45%;left: 45%;width: auto;z-index:101;padding: 6px; margin: 5px;text-align: center;font-weight: bold;display: none;border-width: 2px !important; font-size:11px;}\r\n.ui-jqgrid .jqgrid-overlay {display:none;z-index:100;}\r\n/* IE * html .jqgrid-overlay {width: expression(this.parentNode.offsetWidth+'px');height: expression(this.parentNode.offsetHeight+'px');} */\r\n* .jqgrid-overlay iframe {position:absolute;top:0;left:0;z-index:-1;}\r\n/* IE width: expression(this.parentNode.offsetWidth+'px');height: expression(this.parentNode.offsetHeight+'px');}*/\r\n/* end loading div */\r\n/* toolbar */\r\n.ui-jqgrid .ui-userdata {border-left: 0 none;    border-right: 0 none;\theight : 21px;overflow: hidden;\t}\r\n/*Modal Window */\r\n.ui-jqdialog { display: none; width: 300px; position: absolute; padding: .2em; font-size:11px; overflow:visible;}\r\n.ui-jqdialog .ui-jqdialog-titlebar { padding: .3em .2em; position: relative;  }\r\n.ui-jqdialog .ui-jqdialog-title { margin: .1em 0 .2em; } \r\n.ui-jqdialog .ui-jqdialog-titlebar-close { position: absolute;  top: 50%; width: 19px; margin: -10px 0 0 0; padding: 1px; height: 18px; cursor:pointer;}\r\n\r\n.ui-jqdialog .ui-jqdialog-titlebar-close span { display: block; margin: 1px; }\r\n.ui-jqdialog .ui-jqdialog-titlebar-close:hover, .ui-jqdialog .ui-jqdialog-titlebar-close:focus { padding: 0; }\r\n.ui-jqdialog-content, .ui-jqdialog .ui-jqdialog-content { border: 0; padding: .3em .2em; background: none; height:auto;}\r\n.ui-jqdialog .ui-jqconfirm {padding: .4em 1em; border-width:3px;position:absolute;bottom:10px;right:10px;overflow:visible;display:none;height:80px;width:220px;text-align:center;}\r\n.ui-jqdialog>.ui-resizable-se { bottom: -3px; right: -3px}\r\n.ui-jqgrid>.ui-resizable-se { bottom: -3px; right: -3px }\r\n/* end Modal window*/\r\n/* Form edit */\r\n.ui-jqdialog-content .FormGrid {margin: 0;}\r\n.ui-jqdialog-content .EditTable { width: 100%; margin-bottom:0;}\r\n.ui-jqdialog-content .DelTable { width: 100%; margin-bottom:0;}\r\n.EditTable td input, .EditTable td select, .EditTable td textarea {margin: 0;}\r\n.EditTable td textarea { width:auto; height:auto;}\r\n.ui-jqdialog-content td.EditButton {text-align: right;border-top: 0 none;border-left: 0 none;border-right: 0 none; padding-bottom:5px; padding-top:5px;}\r\n.ui-jqdialog-content td.navButton {text-align: center; border-left: 0 none;border-top: 0 none;border-right: 0 none; padding-bottom:5px; padding-top:5px;}\r\n.ui-jqdialog-content input.FormElement {padding:.3em}\r\n.ui-jqdialog-content select.FormElement {padding:.3em}\r\n.ui-jqdialog-content .data-line {padding-top:.1em;border: 0 none;}\r\n\r\n.ui-jqdialog-content .CaptionTD {vertical-align: middle;border: 0 none; padding: 2px;white-space: nowrap;}\r\n.ui-jqdialog-content .DataTD {padding: 2px; border: 0 none; vertical-align: top;}\r\n.ui-jqdialog-content .form-view-data {white-space:pre}\r\n.fm-button { display: inline-block; margin:0 4px 0 0; padding: .4em .5em; text-decoration:none !important; cursor:pointer; position: relative; text-align: center; zoom: 1; }\r\n.fm-button-icon-left { padding-left: 1.9em; }\r\n.fm-button-icon-right { padding-right: 1.9em; }\r\n.fm-button-icon-left .ui-icon { right: auto; left: .2em; margin-left: 0; position: absolute; top: 50%; margin-top: -8px; }\r\n.fm-button-icon-right .ui-icon { left: auto; right: .2em; margin-left: 0; position: absolute; top: 50%; margin-top: -8px;}\r\n#nData, #pData { float: left; margin:3px;padding: 0; width: 15px; }\r\n/* End Eorm edit */\r\n/*.ui-jqgrid .edit-cell {}*/\r\n.ui-jqgrid .selected-row, div.ui-jqgrid .selected-row td {font-style : normal;border-left: 0 none;}\r\n/* inline edit actions button*/\r\n.ui-inline-del.ui-state-hover span, .ui-inline-edit.ui-state-hover span,\r\n.ui-inline-save.ui-state-hover span, .ui-inline-cancel.ui-state-hover span {\r\n    margin: -1px;\r\n}\r\n/* Tree Grid */\r\n.ui-jqgrid .tree-wrap {float: left; position: relative;height: 18px;white-space: nowrap;overflow: hidden;}\r\n.ui-jqgrid .tree-minus {position: absolute; height: 18px; width: 18px; overflow: hidden;}\r\n.ui-jqgrid .tree-plus {position: absolute;\theight: 18px; width: 18px;\toverflow: hidden;}\r\n.ui-jqgrid .tree-leaf {position: absolute;\theight: 18px; width: 18px;overflow: hidden;}\r\n.ui-jqgrid .treeclick {cursor: pointer;}\r\n/* moda dialog */\r\n* iframe.jqm {position:absolute;top:0;left:0;z-index:-1;}\r\n/*\t width: expression(this.parentNode.offsetWidth+'px');height: expression(this.parentNode.offsetHeight+'px');}*/\r\n.ui-jqgrid-dnd tr td {border-right-width: 1px; border-right-color: inherit; border-right-style: solid; height:20px}\r\n/* RTL Support */\r\n.ui-jqgrid .ui-jqgrid-caption-rtl {text-align: right;}\r\n.ui-jqgrid .ui-jqgrid-hbox-rtl {float: right; padding-left: 20px;}\r\n.ui-jqgrid .ui-jqgrid-resize-ltr {float: right;margin: -2px -2px -2px 0;}\r\n.ui-jqgrid .ui-jqgrid-resize-rtl {float: left;margin: -2px 0 -1px -3px;}\r\n.ui-jqgrid .ui-sort-rtl {left:0;}\r\n.ui-jqgrid .tree-wrap-ltr {float: left;}\r\n.ui-jqgrid .tree-wrap-rtl {float: right;}\r\n.ui-jqgrid .ui-ellipsis {-moz-text-overflow:ellipsis;text-overflow:ellipsis;}\r\n\r\n/* Toolbar Search Menu */\r\n.ui-search-menu { position: absolute; padding: 2px 5px;}\r\n.ui-jqgrid .ui-search-table { padding: 0; border: 0 none; height:20px; width:100%;}\r\n.ui-jqgrid .ui-search-table .ui-search-oper { width:20px; }\r\na.g-menu-item, a.soptclass, a.clearsearchclass { cursor: pointer; }\r\n.ui-jqgrid .ui-search-table .ui-search-input>input,\r\n.ui-jqgrid .ui-search-table .ui-search-input>select\r\n{\r\n    display: block;\r\n    -moz-box-sizing: border-box;\r\n    -webkit-box-sizing: border-box;\r\n    box-sizing: border-box;\r\n} \r\n.ui-jqgrid .ui-jqgrid-view input,\r\n.ui-jqgrid .ui-jqgrid-view select,\r\n.ui-jqgrid .ui-jqgrid-view textarea,\r\n.ui-jqgrid .ui-jqgrid-view button {\r\n    font-size: 11px\r\n}\r\n", "",{"version":3,"sources":["webpack://node_modules/jqgrid/css/ui.jqgrid.css"],"names":[],"mappings":"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","sourcesContent":["/*Grid*/\r\n.ui-jqgrid {position: relative;}\r\n.ui-jqgrid .ui-jqgrid-view {position: relative;left:0; top: 0; padding: 0; font-size:11px;}\r\n/* caption*/\r\n.ui-jqgrid .ui-jqgrid-titlebar {padding: .3em .2em .2em .3em; position: relative; font-size: 12px; border-left: 0 none;border-right: 0 none; border-top: 0 none;}\r\n.ui-jqgrid .ui-jqgrid-caption {text-align: left;}\r\n.ui-jqgrid .ui-jqgrid-title { margin: .1em 0 .2em; }\r\n.ui-jqgrid .ui-jqgrid-titlebar-close { position: absolute;top: 50%; width: 19px; margin: -10px 0 0 0; padding: 1px; height:18px; cursor:pointer;}\r\n.ui-jqgrid .ui-jqgrid-titlebar-close span { display: block; margin: 1px; }\r\n.ui-jqgrid .ui-jqgrid-titlebar-close:hover { padding: 0; }\r\n/* header*/\r\n.ui-jqgrid .ui-jqgrid-hdiv {position: relative; margin: 0;padding: 0; overflow-x: hidden; border-left: 0 none !important; border-top : 0 none !important; border-right : 0 none !important;}\r\n.ui-jqgrid .ui-jqgrid-hbox {float: left; padding-right: 20px;}\r\n.ui-jqgrid .ui-jqgrid-htable {table-layout:fixed;margin:0;}\r\n.ui-jqgrid .ui-jqgrid-htable th {height:22px;padding: 0 2px 0 2px;}\r\n.ui-jqgrid .ui-jqgrid-htable th div {overflow: hidden; position:relative; height:17px;}\r\n.ui-th-column, .ui-jqgrid .ui-jqgrid-htable th.ui-th-column {overflow: hidden;white-space: nowrap;text-align:center;border-top : 0 none;border-bottom : 0 none;}\r\n.ui-th-ltr, .ui-jqgrid .ui-jqgrid-htable th.ui-th-ltr {border-left : 0 none;}\r\n.ui-th-rtl, .ui-jqgrid .ui-jqgrid-htable th.ui-th-rtl {border-right : 0 none;}\r\n.ui-first-th-ltr {border-right: 1px solid; }\r\n.ui-first-th-rtl {border-left: 1px solid; }\r\n.ui-jqgrid .ui-th-div-ie {white-space: nowrap; zoom :1; height:17px;}\r\n.ui-jqgrid .ui-jqgrid-resize {height:20px !important;position: relative; cursor :e-resize;display: inline;overflow: hidden;}\r\n.ui-jqgrid .ui-grid-ico-sort {overflow:hidden;position:absolute;display:inline; cursor: pointer !important;}\r\n.ui-jqgrid .ui-icon-asc {margin-top:-3px; height:12px;}\r\n.ui-jqgrid .ui-icon-desc {margin-top:3px;height:12px;}\r\n.ui-jqgrid .ui-i-asc {margin-top:0;height:16px;}\r\n.ui-jqgrid .ui-i-desc {margin-top:0;margin-left:13px;height:16px;}\r\n.ui-jqgrid .ui-jqgrid-sortable {cursor:pointer;}\r\n.ui-jqgrid tr.ui-search-toolbar th { border-top-width: 1px !important; border-top-color: inherit !important; border-top-style: ridge !important }\r\ntr.ui-search-toolbar input {margin: 1px 0 0 0}\r\ntr.ui-search-toolbar select {margin: 1px 0 0 0}\r\n/* body */ \r\n.ui-jqgrid .ui-jqgrid-bdiv {position: relative; margin: 0; padding:0; overflow: auto; text-align:left;}\r\n.ui-jqgrid .ui-jqgrid-btable {table-layout:fixed; margin:0; outline-style: none; }\r\n.ui-jqgrid tr.jqgrow { outline-style: none; }\r\n.ui-jqgrid tr.jqgroup { outline-style: none; }\r\n.ui-jqgrid tr.jqgrow td {font-weight: normal; overflow: hidden; white-space: pre; height: 22px;padding: 0 2px 0 2px;border-bottom-width: 1px; border-bottom-color: inherit; border-bottom-style: solid;}\r\n.ui-jqgrid tr.jqgfirstrow td {padding: 0 2px 0 2px;border-right-width: 1px; border-right-style: solid;}\r\n.ui-jqgrid tr.jqgroup td {font-weight: normal; overflow: hidden; white-space: pre; height: 22px;padding: 0 2px 0 2px;border-bottom-width: 1px; border-bottom-color: inherit; border-bottom-style: solid;}\r\n.ui-jqgrid tr.jqfoot td {font-weight: bold; overflow: hidden; white-space: pre; height: 22px;padding: 0 2px 0 2px;border-bottom-width: 1px; border-bottom-color: inherit; border-bottom-style: solid;}\r\n.ui-jqgrid tr.ui-row-ltr td {text-align:left;border-right-width: 1px; border-right-color: inherit; border-right-style: solid;}\r\n.ui-jqgrid tr.ui-row-rtl td {text-align:right;border-left-width: 1px; border-left-color: inherit; border-left-style: solid;}\r\n.ui-jqgrid td.jqgrid-rownum { padding: 0 2px 0 2px; margin: 0; border: 0 none;}\r\n.ui-jqgrid .ui-jqgrid-resize-mark { width:2px; left:0; background-color:#777; cursor: e-resize; cursor: col-resize; position:absolute; top:0; height:100px; overflow:hidden; display:none; border:0 none; z-index: 99999;}\r\n/* footer */\r\n.ui-jqgrid .ui-jqgrid-sdiv {position: relative; margin: 0;padding: 0; overflow: hidden; border-left: 0 none !important; border-top : 0 none !important; border-right : 0 none !important;}\r\n.ui-jqgrid .ui-jqgrid-ftable {table-layout:fixed; margin-bottom:0;}\r\n.ui-jqgrid tr.footrow td {font-weight: bold; overflow: hidden; white-space:nowrap; height: 21px;padding: 0 2px 0 2px;border-top-width: 1px; border-top-color: inherit; border-top-style: solid;}\r\n.ui-jqgrid tr.footrow-ltr td {text-align:left;border-right-width: 1px; border-right-color: inherit; border-right-style: solid;}\r\n.ui-jqgrid tr.footrow-rtl td {text-align:right;border-left-width: 1px; border-left-color: inherit; border-left-style: solid;}\r\n/* Pager*/\r\n.ui-jqgrid .ui-jqgrid-pager { border-left: 0 none !important;border-right: 0 none !important; border-bottom: 0 none !important; margin: 0 !important; padding: 0 !important; position: relative; height: 25px;white-space: nowrap;overflow: hidden;font-size:11px;}\r\n.ui-jqgrid .ui-pager-control {position: relative;}\r\n.ui-jqgrid .ui-pg-table {position: relative; padding-bottom:2px; width:auto; margin: 0;}\r\n.ui-jqgrid .ui-pg-table td {font-weight:normal; vertical-align:middle; padding:1px;}\r\n.ui-jqgrid .ui-pg-button  { height:19px !important;}\r\n.ui-jqgrid .ui-pg-button span { display: block; margin: 1px; float:left;}\r\n.ui-jqgrid .ui-pg-button:hover { padding: 0; }\r\n.ui-jqgrid .ui-state-disabled:hover {padding:1px;}\r\n.ui-jqgrid .ui-pg-input { height:13px;font-size:.8em; margin: 0;}\r\n.ui-jqgrid .ui-pg-selbox {font-size:.8em; line-height:18px; display:block; height:18px; margin: 0;}\r\n.ui-jqgrid .ui-separator {height: 18px; border-left: 1px solid #ccc ; border-right: 1px solid #ccc ; margin: 1px; float: right;}\r\n.ui-jqgrid .ui-paging-info {font-weight: normal;height:19px; margin-top:3px;margin-right:4px;}\r\n.ui-jqgrid .ui-jqgrid-pager .ui-pg-div {padding:1px 0;float:left;position:relative;}\r\n.ui-jqgrid .ui-jqgrid-pager .ui-pg-button { cursor:pointer; }\r\n.ui-jqgrid .ui-jqgrid-pager .ui-pg-div  span.ui-icon {float:left;margin:0 2px;}\r\n.ui-jqgrid td input, .ui-jqgrid td select .ui-jqgrid td textarea { margin: 0;}\r\n.ui-jqgrid td textarea {width:auto;height:auto;}\r\n.ui-jqgrid .ui-jqgrid-toppager {border-left: 0 none !important;border-right: 0 none !important; border-top: 0 none !important; margin: 0 !important; padding: 0 !important; position: relative; height: 25px !important;white-space: nowrap;overflow: hidden;}\r\n.ui-jqgrid .ui-jqgrid-toppager .ui-pg-div {padding:1px 0;float:left;position:relative;}\r\n.ui-jqgrid .ui-jqgrid-toppager .ui-pg-button { cursor:pointer; }\r\n.ui-jqgrid .ui-jqgrid-toppager .ui-pg-div  span.ui-icon {float:left;margin:0 2px;}\r\n/*subgrid*/\r\n.ui-jqgrid .ui-jqgrid-btable .ui-sgcollapsed span {display: block;}\r\n.ui-jqgrid .ui-subgrid {margin:0;padding:0; width:100%;}\r\n.ui-jqgrid .ui-subgrid table {table-layout: fixed;}\r\n.ui-jqgrid .ui-subgrid tr.ui-subtblcell td {height:18px;border-right-width: 1px; border-right-color: inherit; border-right-style: solid;border-bottom-width: 1px; border-bottom-color: inherit; border-bottom-style: solid;}\r\n.ui-jqgrid .ui-subgrid td.subgrid-data {border-top:  0 none !important;}\r\n.ui-jqgrid .ui-subgrid td.subgrid-cell {border-width: 0 0 1px 0;}\r\n.ui-jqgrid .ui-th-subgrid {height:20px;}\r\n/* loading */\r\n.ui-jqgrid .loading {position: absolute; top: 45%;left: 45%;width: auto;z-index:101;padding: 6px; margin: 5px;text-align: center;font-weight: bold;display: none;border-width: 2px !important; font-size:11px;}\r\n.ui-jqgrid .jqgrid-overlay {display:none;z-index:100;}\r\n/* IE * html .jqgrid-overlay {width: expression(this.parentNode.offsetWidth+'px');height: expression(this.parentNode.offsetHeight+'px');} */\r\n* .jqgrid-overlay iframe {position:absolute;top:0;left:0;z-index:-1;}\r\n/* IE width: expression(this.parentNode.offsetWidth+'px');height: expression(this.parentNode.offsetHeight+'px');}*/\r\n/* end loading div */\r\n/* toolbar */\r\n.ui-jqgrid .ui-userdata {border-left: 0 none;    border-right: 0 none;\theight : 21px;overflow: hidden;\t}\r\n/*Modal Window */\r\n.ui-jqdialog { display: none; width: 300px; position: absolute; padding: .2em; font-size:11px; overflow:visible;}\r\n.ui-jqdialog .ui-jqdialog-titlebar { padding: .3em .2em; position: relative;  }\r\n.ui-jqdialog .ui-jqdialog-title { margin: .1em 0 .2em; } \r\n.ui-jqdialog .ui-jqdialog-titlebar-close { position: absolute;  top: 50%; width: 19px; margin: -10px 0 0 0; padding: 1px; height: 18px; cursor:pointer;}\r\n\r\n.ui-jqdialog .ui-jqdialog-titlebar-close span { display: block; margin: 1px; }\r\n.ui-jqdialog .ui-jqdialog-titlebar-close:hover, .ui-jqdialog .ui-jqdialog-titlebar-close:focus { padding: 0; }\r\n.ui-jqdialog-content, .ui-jqdialog .ui-jqdialog-content { border: 0; padding: .3em .2em; background: none; height:auto;}\r\n.ui-jqdialog .ui-jqconfirm {padding: .4em 1em; border-width:3px;position:absolute;bottom:10px;right:10px;overflow:visible;display:none;height:80px;width:220px;text-align:center;}\r\n.ui-jqdialog>.ui-resizable-se { bottom: -3px; right: -3px}\r\n.ui-jqgrid>.ui-resizable-se { bottom: -3px; right: -3px }\r\n/* end Modal window*/\r\n/* Form edit */\r\n.ui-jqdialog-content .FormGrid {margin: 0;}\r\n.ui-jqdialog-content .EditTable { width: 100%; margin-bottom:0;}\r\n.ui-jqdialog-content .DelTable { width: 100%; margin-bottom:0;}\r\n.EditTable td input, .EditTable td select, .EditTable td textarea {margin: 0;}\r\n.EditTable td textarea { width:auto; height:auto;}\r\n.ui-jqdialog-content td.EditButton {text-align: right;border-top: 0 none;border-left: 0 none;border-right: 0 none; padding-bottom:5px; padding-top:5px;}\r\n.ui-jqdialog-content td.navButton {text-align: center; border-left: 0 none;border-top: 0 none;border-right: 0 none; padding-bottom:5px; padding-top:5px;}\r\n.ui-jqdialog-content input.FormElement {padding:.3em}\r\n.ui-jqdialog-content select.FormElement {padding:.3em}\r\n.ui-jqdialog-content .data-line {padding-top:.1em;border: 0 none;}\r\n\r\n.ui-jqdialog-content .CaptionTD {vertical-align: middle;border: 0 none; padding: 2px;white-space: nowrap;}\r\n.ui-jqdialog-content .DataTD {padding: 2px; border: 0 none; vertical-align: top;}\r\n.ui-jqdialog-content .form-view-data {white-space:pre}\r\n.fm-button { display: inline-block; margin:0 4px 0 0; padding: .4em .5em; text-decoration:none !important; cursor:pointer; position: relative; text-align: center; zoom: 1; }\r\n.fm-button-icon-left { padding-left: 1.9em; }\r\n.fm-button-icon-right { padding-right: 1.9em; }\r\n.fm-button-icon-left .ui-icon { right: auto; left: .2em; margin-left: 0; position: absolute; top: 50%; margin-top: -8px; }\r\n.fm-button-icon-right .ui-icon { left: auto; right: .2em; margin-left: 0; position: absolute; top: 50%; margin-top: -8px;}\r\n#nData, #pData { float: left; margin:3px;padding: 0; width: 15px; }\r\n/* End Eorm edit */\r\n/*.ui-jqgrid .edit-cell {}*/\r\n.ui-jqgrid .selected-row, div.ui-jqgrid .selected-row td {font-style : normal;border-left: 0 none;}\r\n/* inline edit actions button*/\r\n.ui-inline-del.ui-state-hover span, .ui-inline-edit.ui-state-hover span,\r\n.ui-inline-save.ui-state-hover span, .ui-inline-cancel.ui-state-hover span {\r\n    margin: -1px;\r\n}\r\n/* Tree Grid */\r\n.ui-jqgrid .tree-wrap {float: left; position: relative;height: 18px;white-space: nowrap;overflow: hidden;}\r\n.ui-jqgrid .tree-minus {position: absolute; height: 18px; width: 18px; overflow: hidden;}\r\n.ui-jqgrid .tree-plus {position: absolute;\theight: 18px; width: 18px;\toverflow: hidden;}\r\n.ui-jqgrid .tree-leaf {position: absolute;\theight: 18px; width: 18px;overflow: hidden;}\r\n.ui-jqgrid .treeclick {cursor: pointer;}\r\n/* moda dialog */\r\n* iframe.jqm {position:absolute;top:0;left:0;z-index:-1;}\r\n/*\t width: expression(this.parentNode.offsetWidth+'px');height: expression(this.parentNode.offsetHeight+'px');}*/\r\n.ui-jqgrid-dnd tr td {border-right-width: 1px; border-right-color: inherit; border-right-style: solid; height:20px}\r\n/* RTL Support */\r\n.ui-jqgrid .ui-jqgrid-caption-rtl {text-align: right;}\r\n.ui-jqgrid .ui-jqgrid-hbox-rtl {float: right; padding-left: 20px;}\r\n.ui-jqgrid .ui-jqgrid-resize-ltr {float: right;margin: -2px -2px -2px 0;}\r\n.ui-jqgrid .ui-jqgrid-resize-rtl {float: left;margin: -2px 0 -1px -3px;}\r\n.ui-jqgrid .ui-sort-rtl {left:0;}\r\n.ui-jqgrid .tree-wrap-ltr {float: left;}\r\n.ui-jqgrid .tree-wrap-rtl {float: right;}\r\n.ui-jqgrid .ui-ellipsis {-moz-text-overflow:ellipsis;text-overflow:ellipsis;}\r\n\r\n/* Toolbar Search Menu */\r\n.ui-search-menu { position: absolute; padding: 2px 5px;}\r\n.ui-jqgrid .ui-search-table { padding: 0; border: 0 none; height:20px; width:100%;}\r\n.ui-jqgrid .ui-search-table .ui-search-oper { width:20px; }\r\na.g-menu-item, a.soptclass, a.clearsearchclass { cursor: pointer; }\r\n.ui-jqgrid .ui-search-table .ui-search-input>input,\r\n.ui-jqgrid .ui-search-table .ui-search-input>select\r\n{\r\n    display: block;\r\n    -moz-box-sizing: border-box;\r\n    -webkit-box-sizing: border-box;\r\n    box-sizing: border-box;\r\n} \r\n.ui-jqgrid .ui-jqgrid-view input,\r\n.ui-jqgrid .ui-jqgrid-view select,\r\n.ui-jqgrid .ui-jqgrid-view textarea,\r\n.ui-jqgrid .ui-jqgrid-view button {\r\n    font-size: 11px\r\n}\r\n"],"sourceRoot":""}]);
// Exports
/* harmony default export */ __webpack_exports__["default"] = (___CSS_LOADER_EXPORT___);


/***/ }),

/***/ "./node_modules/css-loader/dist/runtime/getUrl.js":
/*!********************************************************!*\
  !*** ./node_modules/css-loader/dist/runtime/getUrl.js ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (url, options) {
  if (!options) {
    // eslint-disable-next-line no-param-reassign
    options = {};
  } // eslint-disable-next-line no-underscore-dangle, no-param-reassign


  url = url && url.__esModule ? url.default : url;

  if (typeof url !== 'string') {
    return url;
  } // If url is already wrapped in quotes, remove them


  if (/^['"].*['"]$/.test(url)) {
    // eslint-disable-next-line no-param-reassign
    url = url.slice(1, -1);
  }

  if (options.hash) {
    // eslint-disable-next-line no-param-reassign
    url += options.hash;
  } // Should url be wrapped?
  // See https://drafts.csswg.org/css-values-3/#urls


  if (/["'() \t\n]/.test(url) || options.needQuotes) {
    return "\"".concat(url.replace(/"/g, '\\"').replace(/\n/g, '\\n'), "\"");
  }

  return url;
};

/***/ }),

/***/ "./node_modules/jqgrid/css/ui.jqgrid.css":
/*!***********************************************!*\
  !*** ./node_modules/jqgrid/css/ui.jqgrid.css ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var api = __webpack_require__(/*! ../../style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
            var content = __webpack_require__(/*! !../../css-loader/dist/cjs.js!./ui.jqgrid.css */ "./node_modules/css-loader/dist/cjs.js!./node_modules/jqgrid/css/ui.jqgrid.css");

            content = content.__esModule ? content.default : content;

            if (typeof content === 'string') {
              content = [[module.i, content, '']];
            }

var options = {};

options.insert = "head";
options.singleton = false;

var update = api(content, options);



module.exports = content.locals || {};

/***/ }),

/***/ "./node_modules/jqgrid/js/i18n/grid.locale-en.js":
/*!*******************************************************!*\
  !*** ./node_modules/jqgrid/js/i18n/grid.locale-en.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

//@add
module.exports = function(jQuery) {
//@add
;(function($){
/**
 * jqGrid English Translation
 * Tony Tomov tony@trirand.com
 * http://trirand.com/blog/
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
**/
$.jgrid = $.jgrid || {};
$.extend($.jgrid,{
	defaults : {
		recordtext: "View {0} - {1} of {2}",
		emptyrecords: "No records to view",
		loadtext: "Loading...",
		pgtext : "Page {0} of {1}"
	},
	search : {
		caption: "Search...",
		Find: "Find",
		Reset: "Reset",
		odata: [{ oper:'eq', text:'equal'},{ oper:'ne', text:'not equal'},{ oper:'lt', text:'less'},{ oper:'le', text:'less or equal'},{ oper:'gt', text:'greater'},{ oper:'ge', text:'greater or equal'},{ oper:'bw', text:'begins with'},{ oper:'bn', text:'does not begin with'},{ oper:'in', text:'is in'},{ oper:'ni', text:'is not in'},{ oper:'ew', text:'ends with'},{ oper:'en', text:'does not end with'},{ oper:'cn', text:'contains'},{ oper:'nc', text:'does not contain'},{ oper:'nu', text:'is null'},{ oper:'nn', text:'is not null'}],
		groupOps: [{ op: "AND", text: "all" },{ op: "OR",  text: "any" }],
		operandTitle : "Click to select search operation.",
		resetTitle : "Reset Search Value"
	},
	edit : {
		addCaption: "Add Record",
		editCaption: "Edit Record",
		bSubmit: "Submit",
		bCancel: "Cancel",
		bClose: "Close",
		saveData: "Data has been changed! Save changes?",
		bYes : "Yes",
		bNo : "No",
		bExit : "Cancel",
		msg: {
			required:"Field is required",
			number:"Please, enter valid number",
			minValue:"value must be greater than or equal to ",
			maxValue:"value must be less than or equal to",
			email: "is not a valid e-mail",
			integer: "Please, enter valid integer value",
			date: "Please, enter valid date value",
			url: "is not a valid URL. Prefix required ('http://' or 'https://')",
			nodefined : " is not defined!",
			novalue : " return value is required!",
			customarray : "Custom function should return array!",
			customfcheck : "Custom function should be present in case of custom checking!"

		}
	},
	view : {
		caption: "View Record",
		bClose: "Close"
	},
	del : {
		caption: "Delete",
		msg: "Delete selected record(s)?",
		bSubmit: "Delete",
		bCancel: "Cancel"
	},
	nav : {
		edittext: "",
		edittitle: "Edit selected row",
		addtext:"",
		addtitle: "Add new row",
		deltext: "",
		deltitle: "Delete selected row",
		searchtext: "",
		searchtitle: "Find records",
		refreshtext: "",
		refreshtitle: "Reload Grid",
		alertcap: "Warning",
		alerttext: "Please, select row",
		viewtext: "",
		viewtitle: "View selected row"
	},
	col : {
		caption: "Select columns",
		bSubmit: "Ok",
		bCancel: "Cancel"
	},
	errors : {
		errcap : "Error",
		nourl : "No url is set",
		norecords: "No records to process",
		model : "Length of colNames <> colModel!"
	},
	formatter : {
		integer : {thousandsSeparator: ",", defaultValue: '0'},
		number : {decimalSeparator:".", thousandsSeparator: ",", decimalPlaces: 2, defaultValue: '0.00'},
		currency : {decimalSeparator:".", thousandsSeparator: ",", decimalPlaces: 2, prefix: "", suffix:"", defaultValue: '0.00'},
		date : {
			dayNames:   [
				"Sun", "Mon", "Tue", "Wed", "Thr", "Fri", "Sat",
				"Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"
			],
			monthNames: [
				"Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec",
				"January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"
			],
			AmPm : ["am","pm","AM","PM"],
			S: function (j) {return j < 11 || j > 13 ? ['st', 'nd', 'rd', 'th'][Math.min((j - 1) % 10, 3)] : 'th';},
			srcformat: 'Y-m-d',
			newformat: 'n/j/Y',
			parseRe : /[#%\\\/:_;.,\t\s-]/,
			masks : {
				// see http://php.net/manual/en/function.date.php for PHP format used in jqGrid
				// and see http://docs.jquery.com/UI/Datepicker/formatDate
				// and https://github.com/jquery/globalize#dates for alternative formats used frequently
				// one can find on https://github.com/jquery/globalize/tree/master/lib/cultures many
				// information about date, time, numbers and currency formats used in different countries
				// one should just convert the information in PHP format
				ISO8601Long:"Y-m-d H:i:s",
				ISO8601Short:"Y-m-d",
				// short date:
				//    n - Numeric representation of a month, without leading zeros
				//    j - Day of the month without leading zeros
				//    Y - A full numeric representation of a year, 4 digits
				// example: 3/1/2012 which means 1 March 2012
				ShortDate: "n/j/Y", // in jQuery UI Datepicker: "M/d/yyyy"
				// long date:
				//    l - A full textual representation of the day of the week
				//    F - A full textual representation of a month
				//    d - Day of the month, 2 digits with leading zeros
				//    Y - A full numeric representation of a year, 4 digits
				LongDate: "l, F d, Y", // in jQuery UI Datepicker: "dddd, MMMM dd, yyyy"
				// long date with long time:
				//    l - A full textual representation of the day of the week
				//    F - A full textual representation of a month
				//    d - Day of the month, 2 digits with leading zeros
				//    Y - A full numeric representation of a year, 4 digits
				//    g - 12-hour format of an hour without leading zeros
				//    i - Minutes with leading zeros
				//    s - Seconds, with leading zeros
				//    A - Uppercase Ante meridiem and Post meridiem (AM or PM)
				FullDateTime: "l, F d, Y g:i:s A", // in jQuery UI Datepicker: "dddd, MMMM dd, yyyy h:mm:ss tt"
				// month day:
				//    F - A full textual representation of a month
				//    d - Day of the month, 2 digits with leading zeros
				MonthDay: "F d", // in jQuery UI Datepicker: "MMMM dd"
				// short time (without seconds)
				//    g - 12-hour format of an hour without leading zeros
				//    i - Minutes with leading zeros
				//    A - Uppercase Ante meridiem and Post meridiem (AM or PM)
				ShortTime: "g:i A", // in jQuery UI Datepicker: "h:mm tt"
				// long time (with seconds)
				//    g - 12-hour format of an hour without leading zeros
				//    i - Minutes with leading zeros
				//    s - Seconds, with leading zeros
				//    A - Uppercase Ante meridiem and Post meridiem (AM or PM)
				LongTime: "g:i:s A", // in jQuery UI Datepicker: "h:mm:ss tt"
				SortableDateTime: "Y-m-d\\TH:i:s",
				UniversalSortableDateTime: "Y-m-d H:i:sO",
				// month with year
				//    Y - A full numeric representation of a year, 4 digits
				//    F - A full textual representation of a month
				YearMonth: "F, Y" // in jQuery UI Datepicker: "MMMM, yyyy"
			},
			reformatAfterEdit : false
		},
		baseLinkUrl: '',
		showAction: '',
		target: '',
		checkbox : {disabled:true},
		idName : 'id'
	}
});
})(jQuery);
//@add
};
//@add


/***/ }),

/***/ "./node_modules/jqgrid/js/jquery.jqGrid.src.js":
/*!*****************************************************!*\
  !*** ./node_modules/jqgrid/js/jquery.jqGrid.src.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

// ==ClosureCompiler==
// @compilation_level SIMPLE_OPTIMIZATIONS

/**
 * @license jqGrid  4.6.0 - jQuery Grid
 * Copyright (c) 2008, Tony Tomov, tony@trirand.com
 * Dual licensed under the MIT and GPL licenses
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
 * Date: 2014-02-20
 */
//jsHint options
/*jshint evil:true, eqeqeq:false, eqnull:true, devel:true */
/*global jQuery */
//@add
module.exports = function(jQuery) {
//@add
(function ($) {
"use strict";
$.jgrid = $.jgrid || {};
$.extend($.jgrid,{
	version : "4.6.0",
	htmlDecode : function(value){
		if(value && (value==='&nbsp;' || value==='&#160;' || (value.length===1 && value.charCodeAt(0)===160))) { return "";}
		return !value ? value : String(value).replace(/&gt;/g, ">").replace(/&lt;/g, "<").replace(/&quot;/g, '"').replace(/&amp;/g, "&");
	},
	htmlEncode : function (value){
		return !value ? value : String(value).replace(/&/g, "&amp;").replace(/\"/g, "&quot;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
	},
	format : function(format){ //jqgformat
		var args = $.makeArray(arguments).slice(1);
		if(format==null) { format = ""; }
		return format.replace(/\{(\d+)\}/g, function(m, i){
			return args[i];
		});
	},
	msie : navigator.appName === 'Microsoft Internet Explorer',
	msiever : function () {
		var rv = -1;
		var ua = navigator.userAgent;
		var re  = new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");
		if (re.exec(ua) != null) {
			rv = parseFloat( RegExp.$1 );
		}
		return rv;
	},
	getCellIndex : function (cell) {
		var c = $(cell);
		if (c.is('tr')) { return -1; }
		c = (!c.is('td') && !c.is('th') ? c.closest("td,th") : c)[0];
		if ($.jgrid.msie) { return $.inArray(c, c.parentNode.cells); }
		return c.cellIndex;
	},
	stripHtml : function(v) {
		v = String(v);
		var regexp = /<("[^"]*"|'[^']*'|[^'">])*>/gi;
		if (v) {
			v = v.replace(regexp,"");
			return (v && v !== '&nbsp;' && v !== '&#160;') ? v.replace(/\"/g,"'") : "";
		}
			return v;
	},
	stripPref : function (pref, id) {
		var obj = $.type( pref );
		if( obj === "string" || obj === "number") {
			pref =  String(pref);
			id = pref !== "" ? String(id).replace(String(pref), "") : id;
		}
		return id;
	},
	parse : function(jsonString) {
		var js = jsonString;
		if (js.substr(0,9) === "while(1);") { js = js.substr(9); }
		if (js.substr(0,2) === "/*") { js = js.substr(2,js.length-4); }
		if(!js) { js = "{}"; }
		return ($.jgrid.useJSON===true && typeof JSON === 'object' && typeof JSON.parse === 'function') ?
			JSON.parse(js) :
			eval('(' + js + ')');
	},
	parseDate : function(format, date, newformat, opts) {
		var	token = /\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,
		timezone = /\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,
		timezoneClip = /[^-+\dA-Z]/g,
		msDateRegExp = new RegExp("^\/Date\\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\\)\/$"),
		msMatch = ((typeof date === 'string') ? date.match(msDateRegExp): null),
		pad = function (value, length) {
			value = String(value);
			length = parseInt(length,10) || 2;
			while (value.length < length)  { value = '0' + value; }
			return value;
		},
		ts = {m : 1, d : 1, y : 1970, h : 0, i : 0, s : 0, u:0},
		timestamp=0, dM, k,hl,
		h12to24 = function(ampm, h){
			if (ampm === 0){ if (h === 12) { h = 0;} }
			else { if (h !== 12) { h += 12; } }
			return h;
		};
		if(opts === undefined) {
			opts = $.jgrid.formatter.date;
		}
		// old lang files
		if(opts.parseRe === undefined ) {
			opts.parseRe = /[#%\\\/:_;.,\t\s-]/;
		}
		if( opts.masks.hasOwnProperty(format) ) { format = opts.masks[format]; }
		if(date && date != null) {
			if( !isNaN( date - 0 ) && String(format).toLowerCase() === "u") {
				//Unix timestamp
				timestamp = new Date( parseFloat(date)*1000 );
			} else if(date.constructor === Date) {
				timestamp = date;
				// Microsoft date format support
			} else if( msMatch !== null ) {
				timestamp = new Date(parseInt(msMatch[1], 10));
				if (msMatch[3]) {
					var offset = Number(msMatch[5]) * 60 + Number(msMatch[6]);
					offset *= ((msMatch[4] === '-') ? 1 : -1);
					offset -= timestamp.getTimezoneOffset();
					timestamp.setTime(Number(Number(timestamp) + (offset * 60 * 1000)));
				}
			} else {
				var offset = 0;
				//Support ISO8601Long that have Z at the end to indicate UTC timezone
				if(opts.srcformat === 'ISO8601Long' && date.charAt(date.length - 1) === 'Z') {
					offset -= (new Date()).getTimezoneOffset();
				}
				date = String(date).replace(/\T/g,"#").replace(/\t/,"%").split(opts.parseRe);
				format = format.replace(/\T/g,"#").replace(/\t/,"%").split(opts.parseRe);
				// parsing for month names
				for(k=0,hl=format.length;k<hl;k++){
					if(format[k] === 'M') {
						dM = $.inArray(date[k],opts.monthNames);
						if(dM !== -1 && dM < 12){date[k] = dM+1; ts.m = date[k];}
					}
					if(format[k] === 'F') {
						dM = $.inArray(date[k],opts.monthNames,12);
						if(dM !== -1 && dM > 11){date[k] = dM+1-12; ts.m = date[k];}
					}
					if(format[k] === 'a') {
						dM = $.inArray(date[k],opts.AmPm);
						if(dM !== -1 && dM < 2 && date[k] === opts.AmPm[dM]){
							date[k] = dM;
							ts.h = h12to24(date[k], ts.h);
						}
					}
					if(format[k] === 'A') {
						dM = $.inArray(date[k],opts.AmPm);
						if(dM !== -1 && dM > 1 && date[k] === opts.AmPm[dM]){
							date[k] = dM-2;
							ts.h = h12to24(date[k], ts.h);
						}
					}
					if (format[k] === 'g') {
						ts.h = parseInt(date[k], 10);
					}
					if(date[k] !== undefined) {
						ts[format[k].toLowerCase()] = parseInt(date[k],10);
					}
				}
				if(ts.f) {ts.m = ts.f;}
				if( ts.m === 0 && ts.y === 0 && ts.d === 0) {
					return "&#160;" ;
				}
				ts.m = parseInt(ts.m,10)-1;
				var ty = ts.y;
				if (ty >= 70 && ty <= 99) {ts.y = 1900+ts.y;}
				else if (ty >=0 && ty <=69) {ts.y= 2000+ts.y;}
				timestamp = new Date(ts.y, ts.m, ts.d, ts.h, ts.i, ts.s, ts.u);
				//Apply offset to show date as local time.
				if(offset > 0) {
					timestamp.setTime(Number(Number(timestamp) + (offset * 60 * 1000)));
				}
			}
		} else {
			timestamp = new Date(ts.y, ts.m, ts.d, ts.h, ts.i, ts.s, ts.u);
		}
		if( newformat === undefined ) {
			return timestamp;
		}
		if( opts.masks.hasOwnProperty(newformat) )  {
			newformat = opts.masks[newformat];
		} else if ( !newformat ) {
			newformat = 'Y-m-d';
		}
		var
			G = timestamp.getHours(),
			i = timestamp.getMinutes(),
			j = timestamp.getDate(),
			n = timestamp.getMonth() + 1,
			o = timestamp.getTimezoneOffset(),
			s = timestamp.getSeconds(),
			u = timestamp.getMilliseconds(),
			w = timestamp.getDay(),
			Y = timestamp.getFullYear(),
			N = (w + 6) % 7 + 1,
			z = (new Date(Y, n - 1, j) - new Date(Y, 0, 1)) / 86400000,
			flags = {
				// Day
				d: pad(j),
				D: opts.dayNames[w],
				j: j,
				l: opts.dayNames[w + 7],
				N: N,
				S: opts.S(j),
				//j < 11 || j > 13 ? ['st', 'nd', 'rd', 'th'][Math.min((j - 1) % 10, 3)] : 'th',
				w: w,
				z: z,
				// Week
				W: N < 5 ? Math.floor((z + N - 1) / 7) + 1 : Math.floor((z + N - 1) / 7) || ((new Date(Y - 1, 0, 1).getDay() + 6) % 7 < 4 ? 53 : 52),
				// Month
				F: opts.monthNames[n - 1 + 12],
				m: pad(n),
				M: opts.monthNames[n - 1],
				n: n,
				t: '?',
				// Year
				L: '?',
				o: '?',
				Y: Y,
				y: String(Y).substring(2),
				// Time
				a: G < 12 ? opts.AmPm[0] : opts.AmPm[1],
				A: G < 12 ? opts.AmPm[2] : opts.AmPm[3],
				B: '?',
				g: G % 12 || 12,
				G: G,
				h: pad(G % 12 || 12),
				H: pad(G),
				i: pad(i),
				s: pad(s),
				u: u,
				// Timezone
				e: '?',
				I: '?',
				O: (o > 0 ? "-" : "+") + pad(Math.floor(Math.abs(o) / 60) * 100 + Math.abs(o) % 60, 4),
				P: '?',
				T: (String(timestamp).match(timezone) || [""]).pop().replace(timezoneClip, ""),
				Z: '?',
				// Full Date/Time
				c: '?',
				r: '?',
				U: Math.floor(timestamp / 1000)
			};
		return newformat.replace(token, function ($0) {
			return flags.hasOwnProperty($0) ? flags[$0] : $0.substring(1);
		});
	},
	jqID : function(sid){
		return String(sid).replace(/[!"#$%&'()*+,.\/:; <=>?@\[\\\]\^`{|}~]/g,"\\$&");
	},
	guid : 1,
	uidPref: 'jqg',
	randId : function( prefix )	{
		return (prefix || $.jgrid.uidPref) + ($.jgrid.guid++);
	},
	getAccessor : function(obj, expr) {
		var ret,p,prm = [], i;
		if( typeof expr === 'function') { return expr(obj); }
		ret = obj[expr];
		if(ret===undefined) {
			try {
				if ( typeof expr === 'string' ) {
					prm = expr.split('.');
				}
				i = prm.length;
				if( i ) {
					ret = obj;
					while (ret && i--) {
						p = prm.shift();
						ret = ret[p];
					}
				}
			} catch (e) {}
		}
		return ret;
	},
	getXmlData: function (obj, expr, returnObj) {
		var ret, m = typeof expr === 'string' ? expr.match(/^(.*)\[(\w+)\]$/) : null;
		if (typeof expr === 'function') { return expr(obj); }
		if (m && m[2]) {
			// m[2] is the attribute selector
			// m[1] is an optional element selector
			// examples: "[id]", "rows[page]"
			return m[1] ? $(m[1], obj).attr(m[2]) : $(obj).attr(m[2]);
		}
			ret = $(expr, obj);
			if (returnObj) { return ret; }
			//$(expr, obj).filter(':last'); // we use ':last' to be more compatible with old version of jqGrid
			return ret.length > 0 ? $(ret).text() : undefined;
	},
	cellWidth : function () {
		var $testDiv = $("<div class='ui-jqgrid' style='left:10000px'><table class='ui-jqgrid-btable' style='width:5px;'><tr class='jqgrow'><td style='width:5px;display:block;'></td></tr></table></div>"),
		testCell = $testDiv.appendTo("body")
			.find("td")
			.width();
		$testDiv.remove();
		return Math.abs(testCell-5) > 0.1;
	},
	cell_width : true,
	ajaxOptions: {},
	from : function(source){
		// Original Author Hugo Bonacci
		// License MIT http://jlinq.codeplex.com/license
		var QueryObject=function(d,q){
		if(typeof d==="string"){
			d=$.data(d);
		}
		var self=this,
		_data=d,
		_usecase=true,
		_trim=false,
		_query=q,
		_stripNum = /[\$,%]/g,
		_lastCommand=null,
		_lastField=null,
		_orDepth=0,
		_negate=false,
		_queuedOperator="",
		_sorting=[],
		_useProperties=true;
		if(typeof d==="object"&&d.push) {
			if(d.length>0){
				if(typeof d[0]!=="object"){
					_useProperties=false;
				}else{
					_useProperties=true;
				}
			}
		}else{
			throw "data provides is not an array";
		}
		this._hasData=function(){
			return _data===null?false:_data.length===0?false:true;
		};
		this._getStr=function(s){
			var phrase=[];
			if(_trim){
				phrase.push("jQuery.trim(");
			}
			phrase.push("String("+s+")");
			if(_trim){
				phrase.push(")");
			}
			if(!_usecase){
				phrase.push(".toLowerCase()");
			}
			return phrase.join("");
		};
		this._strComp=function(val){
			if(typeof val==="string"){
				return".toString()";
			}
			return"";
		};
		this._group=function(f,u){
			return({field:f.toString(),unique:u,items:[]});
		};
		this._toStr=function(phrase){
			if(_trim){
				phrase=$.trim(phrase);
			}
			phrase=phrase.toString().replace(/\\/g,'\\\\').replace(/\"/g,'\\"');
			return _usecase ? phrase : phrase.toLowerCase();
		};
		this._funcLoop=function(func){
			var results=[];
			$.each(_data,function(i,v){
				results.push(func(v));
			});
			return results;
		};
		this._append=function(s){
			var i;
			if(_query===null){
				_query="";
			} else {
				_query+=_queuedOperator === "" ? " && " :_queuedOperator;
			}
			for (i=0;i<_orDepth;i++){
				_query+="(";
			}
			if(_negate){
				_query+="!";
			}
			_query+="("+s+")";
			_negate=false;
			_queuedOperator="";
			_orDepth=0;
		};
		this._setCommand=function(f,c){
			_lastCommand=f;
			_lastField=c;
		};
		this._resetNegate=function(){
			_negate=false;
		};
		this._repeatCommand=function(f,v){
			if(_lastCommand===null){
				return self;
			}
			if(f!==null&&v!==null){
				return _lastCommand(f,v);
			}
			if(_lastField===null){
				return _lastCommand(f);
			}
			if(!_useProperties){
				return _lastCommand(f);
			}
			return _lastCommand(_lastField,f);
		};
		this._equals=function(a,b){
			return(self._compare(a,b,1)===0);
		};
		this._compare=function(a,b,d){
			var toString = Object.prototype.toString;
			if( d === undefined) { d = 1; }
			if(a===undefined) { a = null; }
			if(b===undefined) { b = null; }
			if(a===null && b===null){
				return 0;
			}
			if(a===null&&b!==null){
				return 1;
			}
			if(a!==null&&b===null){
				return -1;
			}
			if (toString.call(a) === '[object Date]' && toString.call(b) === '[object Date]') {
				if (a < b) { return -d; }
				if (a > b) { return d; }
				return 0;
			}
			if(!_usecase && typeof a !== "number" && typeof b !== "number" ) {
				a=String(a);
				b=String(b);
			}
			if(a<b){return -d;}
			if(a>b){return d;}
			return 0;
		};
		this._performSort=function(){
			if(_sorting.length===0){return;}
			_data=self._doSort(_data,0);
		};
		this._doSort=function(d,q){
			var by=_sorting[q].by,
			dir=_sorting[q].dir,
			type = _sorting[q].type,
			dfmt = _sorting[q].datefmt,
			sfunc = _sorting[q].sfunc;
			if(q===_sorting.length-1){
				return self._getOrder(d, by, dir, type, dfmt, sfunc);
			}
			q++;
			var values=self._getGroup(d,by,dir,type,dfmt), results=[], i, j, sorted;
			for(i=0;i<values.length;i++){
				sorted=self._doSort(values[i].items,q);
				for(j=0;j<sorted.length;j++){
					results.push(sorted[j]);
				}
			}
			return results;
		};
		this._getOrder=function(data,by,dir,type, dfmt, sfunc){
			var sortData=[],_sortData=[], newDir = dir==="a" ? 1 : -1, i,ab,j,
			findSortKey;

			if(type === undefined ) { type = "text"; }
			if (type === 'float' || type=== 'number' || type=== 'currency' || type=== 'numeric') {
				findSortKey = function($cell) {
					var key = parseFloat( String($cell).replace(_stripNum, ''));
					return isNaN(key) ? 0.00 : key;
				};
			} else if (type==='int' || type==='integer') {
				findSortKey = function($cell) {
					return $cell ? parseFloat(String($cell).replace(_stripNum, '')) : 0;
				};
			} else if(type === 'date' || type === 'datetime') {
				findSortKey = function($cell) {
					return $.jgrid.parseDate(dfmt,$cell).getTime();
				};
			} else if($.isFunction(type)) {
				findSortKey = type;
			} else {
				findSortKey = function($cell) {
					$cell = $cell ? $.trim(String($cell)) : "";
					return _usecase ? $cell : $cell.toLowerCase();
				};
			}
			$.each(data,function(i,v){
				ab = by!=="" ? $.jgrid.getAccessor(v,by) : v;
				if(ab === undefined) { ab = ""; }
				ab = findSortKey(ab, v);
				_sortData.push({ 'vSort': ab,'index':i});
			});
			if($.isFunction(sfunc)) {
				_sortData.sort(function(a,b){
					a = a.vSort;
					b = b.vSort;
					return sfunc.call(this,a,b,newDir);
				});
			} else {
				_sortData.sort(function(a,b){
					a = a.vSort;
					b = b.vSort;
					return self._compare(a,b,newDir);
				});
			}
			j=0;
			var nrec= data.length;
			// overhead, but we do not change the original data.
			while(j<nrec) {
				i = _sortData[j].index;
				sortData.push(data[i]);
				j++;
			}
			return sortData;
		};
		this._getGroup=function(data,by,dir,type, dfmt){
			var results=[],
			group=null,
			last=null, val;
			$.each(self._getOrder(data,by,dir,type, dfmt),function(i,v){
				val = $.jgrid.getAccessor(v, by);
				if(val == null) { val = ""; }
				if(!self._equals(last,val)){
					last=val;
					if(group !== null){
						results.push(group);
					}
					group=self._group(by,val);
				}
				group.items.push(v);
			});
			if(group !== null){
				results.push(group);
			}
			return results;
		};
		this.ignoreCase=function(){
			_usecase=false;
			return self;
		};
		this.useCase=function(){
			_usecase=true;
			return self;
		};
		this.trim=function(){
			_trim=true;
			return self;
		};
		this.noTrim=function(){
			_trim=false;
			return self;
		};
		this.execute=function(){
			var match=_query, results=[];
			if(match === null){
				return self;
			}
			$.each(_data,function(){
				if(eval(match)){results.push(this);}
			});
			_data=results;
			return self;
		};
		this.data=function(){
			return _data;
		};
		this.select=function(f){
			self._performSort();
			if(!self._hasData()){ return[]; }
			self.execute();
			if($.isFunction(f)){
				var results=[];
				$.each(_data,function(i,v){
					results.push(f(v));
				});
				return results;
			}
			return _data;
		};
		this.hasMatch=function(){
			if(!self._hasData()) { return false; }
			self.execute();
			return _data.length>0;
		};
		this.andNot=function(f,v,x){
			_negate=!_negate;
			return self.and(f,v,x);
		};
		this.orNot=function(f,v,x){
			_negate=!_negate;
			return self.or(f,v,x);
		};
		this.not=function(f,v,x){
			return self.andNot(f,v,x);
		};
		this.and=function(f,v,x){
			_queuedOperator=" && ";
			if(f===undefined){
				return self;
			}
			return self._repeatCommand(f,v,x);
		};
		this.or=function(f,v,x){
			_queuedOperator=" || ";
			if(f===undefined) { return self; }
			return self._repeatCommand(f,v,x);
		};
		this.orBegin=function(){
			_orDepth++;
			return self;
		};
		this.orEnd=function(){
			if (_query !== null){
				_query+=")";
			}
			return self;
		};
		this.isNot=function(f){
			_negate=!_negate;
			return self.is(f);
		};
		this.is=function(f){
			self._append('this.'+f);
			self._resetNegate();
			return self;
		};
		this._compareValues=function(func,f,v,how,t){
			var fld;
			if(_useProperties){
				fld='jQuery.jgrid.getAccessor(this,\''+f+'\')';
			}else{
				fld='this';
			}
			if(v===undefined) { v = null; }
			//var val=v===null?f:v,
			var val =v,
			swst = t.stype === undefined ? "text" : t.stype;
			if(v !== null) {
			switch(swst) {
				case 'int':
				case 'integer':
					val = (isNaN(Number(val)) || val==="") ? '0' : val; // To be fixed with more inteligent code
					fld = 'parseInt('+fld+',10)';
					val = 'parseInt('+val+',10)';
					break;
				case 'float':
				case 'number':
				case 'numeric':
					val = String(val).replace(_stripNum, '');
					val = (isNaN(Number(val)) || val==="") ? '0' : val; // To be fixed with more inteligent code
					fld = 'parseFloat('+fld+')';
					val = 'parseFloat('+val+')';
					break;
				case 'date':
				case 'datetime':
					val = String($.jgrid.parseDate(t.newfmt || 'Y-m-d',val).getTime());
					fld = 'jQuery.jgrid.parseDate("'+t.srcfmt+'",'+fld+').getTime()';
					break;
				default :
					fld=self._getStr(fld);
					val=self._getStr('"'+self._toStr(val)+'"');
			}
			}
			self._append(fld+' '+how+' '+val);
			self._setCommand(func,f);
			self._resetNegate();
			return self;
		};
		this.equals=function(f,v,t){
			return self._compareValues(self.equals,f,v,"==",t);
		};
		this.notEquals=function(f,v,t){
			return self._compareValues(self.equals,f,v,"!==",t);
		};
		this.isNull = function(f,v,t){
			return self._compareValues(self.equals,f,null,"===",t);
		};
		this.greater=function(f,v,t){
			return self._compareValues(self.greater,f,v,">",t);
		};
		this.less=function(f,v,t){
			return self._compareValues(self.less,f,v,"<",t);
		};
		this.greaterOrEquals=function(f,v,t){
			return self._compareValues(self.greaterOrEquals,f,v,">=",t);
		};
		this.lessOrEquals=function(f,v,t){
			return self._compareValues(self.lessOrEquals,f,v,"<=",t);
		};
		this.startsWith=function(f,v){
			var val = (v==null) ? f: v,
			length=_trim ? $.trim(val.toString()).length : val.toString().length;
			if(_useProperties){
				self._append(self._getStr('jQuery.jgrid.getAccessor(this,\''+f+'\')')+'.substr(0,'+length+') == '+self._getStr('"'+self._toStr(v)+'"'));
			}else{
				if (v!=null) { length=_trim?$.trim(v.toString()).length:v.toString().length; }
				self._append(self._getStr('this')+'.substr(0,'+length+') == '+self._getStr('"'+self._toStr(f)+'"'));
			}
			self._setCommand(self.startsWith,f);
			self._resetNegate();
			return self;
		};
		this.endsWith=function(f,v){
			var val = (v==null) ? f: v,
			length=_trim ? $.trim(val.toString()).length:val.toString().length;
			if(_useProperties){
				self._append(self._getStr('jQuery.jgrid.getAccessor(this,\''+f+'\')')+'.substr('+self._getStr('jQuery.jgrid.getAccessor(this,\''+f+'\')')+'.length-'+length+','+length+') == "'+self._toStr(v)+'"');
			} else {
				self._append(self._getStr('this')+'.substr('+self._getStr('this')+'.length-"'+self._toStr(f)+'".length,"'+self._toStr(f)+'".length) == "'+self._toStr(f)+'"');
			}
			self._setCommand(self.endsWith,f);self._resetNegate();
			return self;
		};
		this.contains=function(f,v){
			if(_useProperties){
				self._append(self._getStr('jQuery.jgrid.getAccessor(this,\''+f+'\')')+'.indexOf("'+self._toStr(v)+'",0) > -1');
			}else{
				self._append(self._getStr('this')+'.indexOf("'+self._toStr(f)+'",0) > -1');
			}
			self._setCommand(self.contains,f);
			self._resetNegate();
			return self;
		};
		this.groupBy=function(by,dir,type, datefmt){
			if(!self._hasData()){
				return null;
			}
			return self._getGroup(_data,by,dir,type, datefmt);
		};
		this.orderBy=function(by,dir,stype, dfmt, sfunc){
			dir = dir == null ? "a" :$.trim(dir.toString().toLowerCase());
			if(stype == null) { stype = "text"; }
			if(dfmt == null) { dfmt = "Y-m-d"; }
			if(sfunc == null) { sfunc = false; }
			if(dir==="desc"||dir==="descending"){dir="d";}
			if(dir==="asc"||dir==="ascending"){dir="a";}
			_sorting.push({by:by,dir:dir,type:stype, datefmt: dfmt, sfunc: sfunc});
			return self;
		};
		return self;
		};
	return new QueryObject(source,null);
	},
	getMethod: function (name) {
        return this.getAccessor($.fn.jqGrid, name);
	},
	extend : function(methods) {
		$.extend($.fn.jqGrid,methods);
		if (!this.no_legacy_api) {
			$.fn.extend(methods);
		}
	}
});

$.fn.jqGrid = function( pin ) {
	if (typeof pin === 'string') {
		var fn = $.jgrid.getMethod(pin);
		if (!fn) {
			throw ("jqGrid - No such method: " + pin);
		}
		var args = $.makeArray(arguments).slice(1);
		return fn.apply(this,args);
	}
	return this.each( function() {
		if(this.grid) {return;}

		var p = $.extend(true,{
			url: "",
			height: 150,
			page: 1,
			rowNum: 20,
			rowTotal : null,
			records: 0,
			pager: "",
			pgbuttons: true,
			pginput: true,
			colModel: [],
			rowList: [],
			colNames: [],
			sortorder: "asc",
			sortname: "",
			datatype: "xml",
			mtype: "GET",
			altRows: false,
			selarrrow: [],
			savedRow: [],
			shrinkToFit: true,
			xmlReader: {},
			jsonReader: {},
			subGrid: false,
			subGridModel :[],
			reccount: 0,
			lastpage: 0,
			lastsort: 0,
			selrow: null,
			beforeSelectRow: null,
			onSelectRow: null,
			onSortCol: null,
			ondblClickRow: null,
			onRightClickRow: null,
			onPaging: null,
			onSelectAll: null,
			onInitGrid : null,
			loadComplete: null,
			gridComplete: null,
			loadError: null,
			loadBeforeSend: null,
			afterInsertRow: null,
			beforeRequest: null,
			beforeProcessing : null,
			onHeaderClick: null,
			viewrecords: false,
			loadonce: false,
			multiselect: false,
			multikey: false,
			editurl: null,
			search: false,
			caption: "",
			hidegrid: true,
			hiddengrid: false,
			postData: {},
			userData: {},
			treeGrid : false,
			treeGridModel : 'nested',
			treeReader : {},
			treeANode : -1,
			ExpandColumn: null,
			tree_root_level : 0,
			prmNames: {page:"page",rows:"rows", sort: "sidx",order: "sord", search:"_search", nd:"nd", id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del", subgridid:"id", npage: null, totalrows:"totalrows"},
			forceFit : false,
			gridstate : "visible",
			cellEdit: false,
			cellsubmit: "remote",
			nv:0,
			loadui: "enable",
			toolbar: [false,""],
			scroll: false,
			multiboxonly : false,
			deselectAfterSort : true,
			scrollrows : false,
			autowidth: false,
			scrollOffset :18,
			cellLayout: 5,
			subGridWidth: 20,
			multiselectWidth: 20,
			gridview: false,
			rownumWidth: 25,
			rownumbers : false,
			pagerpos: 'center',
			recordpos: 'right',
			footerrow : false,
			userDataOnFooter : false,
			hoverrows : true,
			altclass : 'ui-priority-secondary',
			viewsortcols : [false,'vertical',true],
			resizeclass : '',
			autoencode : false,
			remapColumns : [],
			ajaxGridOptions :{},
			direction : "ltr",
			toppager: false,
			headertitles: false,
			scrollTimeout: 40,
			data : [],
			_index : {},
			grouping : false,
			groupingView : {groupField:[],groupOrder:[], groupText:[],groupColumnShow:[],groupSummary:[], showSummaryOnHide: false, sortitems:[], sortnames:[], summary:[],summaryval:[], plusicon: 'ui-icon-circlesmall-plus', minusicon: 'ui-icon-circlesmall-minus', displayField: [], groupSummaryPos:[], formatDisplayField : [], _locgr : false},
			ignoreCase : false,
			cmTemplate : {},
			idPrefix : "",
			multiSort :  false
		}, $.jgrid.defaults, pin || {});
		var ts= this, grid={
			headers:[],
			cols:[],
			footers: [],
			dragStart: function(i,x,y) {
				var gridLeftPos = $(this.bDiv).offset().left;
				this.resizing = { idx: i, startX: x.clientX, sOL : x.clientX - gridLeftPos };
				this.hDiv.style.cursor = "col-resize";
				this.curGbox = $("#rs_m"+$.jgrid.jqID(p.id),"#gbox_"+$.jgrid.jqID(p.id));
				this.curGbox.css({display:"block",left:x.clientX-gridLeftPos,top:y[1],height:y[2]});
				$(ts).triggerHandler("jqGridResizeStart", [x, i]);
				if($.isFunction(p.resizeStart)) { p.resizeStart.call(ts,x,i); }
				document.onselectstart=function(){return false;};
			},
			dragMove: function(x) {
				if(this.resizing) {
					var diff = x.clientX-this.resizing.startX,
					h = this.headers[this.resizing.idx],
					newWidth = p.direction === "ltr" ? h.width + diff : h.width - diff, hn, nWn;
					if(newWidth > 33) {
						this.curGbox.css({left:this.resizing.sOL+diff});
						if(p.forceFit===true ){
							hn = this.headers[this.resizing.idx+p.nv];
							nWn = p.direction === "ltr" ? hn.width - diff : hn.width + diff;
							if(nWn >33) {
								h.newWidth = newWidth;
								hn.newWidth = nWn;
							}
						} else {
							this.newWidth = p.direction === "ltr" ? p.tblwidth+diff : p.tblwidth-diff;
							h.newWidth = newWidth;
						}
					}
				}
			},
			dragEnd: function() {
				this.hDiv.style.cursor = "default";
				if(this.resizing) {
					var idx = this.resizing.idx,
					nw = this.headers[idx].newWidth || this.headers[idx].width;
					nw = parseInt(nw,10);
					this.resizing = false;
					$("#rs_m"+$.jgrid.jqID(p.id)).css("display","none");
					p.colModel[idx].width = nw;
					this.headers[idx].width = nw;
					this.headers[idx].el.style.width = nw + "px";
					this.cols[idx].style.width = nw+"px";
					if(this.footers.length>0) {this.footers[idx].style.width = nw+"px";}
					if(p.forceFit===true){
						nw = this.headers[idx+p.nv].newWidth || this.headers[idx+p.nv].width;
						this.headers[idx+p.nv].width = nw;
						this.headers[idx+p.nv].el.style.width = nw + "px";
						this.cols[idx+p.nv].style.width = nw+"px";
						if(this.footers.length>0) {this.footers[idx+p.nv].style.width = nw+"px";}
						p.colModel[idx+p.nv].width = nw;
					} else {
						p.tblwidth = this.newWidth || p.tblwidth;
						$('table:first',this.bDiv).css("width",p.tblwidth+"px");
						$('table:first',this.hDiv).css("width",p.tblwidth+"px");
						this.hDiv.scrollLeft = this.bDiv.scrollLeft;
						if(p.footerrow) {
							$('table:first',this.sDiv).css("width",p.tblwidth+"px");
							this.sDiv.scrollLeft = this.bDiv.scrollLeft;
						}
					}
					$(ts).triggerHandler("jqGridResizeStop", [nw, idx]);
					if($.isFunction(p.resizeStop)) { p.resizeStop.call(ts,nw,idx); }
				}
				this.curGbox = null;
				document.onselectstart=function(){return true;};
			},
			populateVisible: function() {
				if (grid.timer) { clearTimeout(grid.timer); }
				grid.timer = null;
				var dh = $(grid.bDiv).height();
				if (!dh) { return; }
				var table = $("table:first", grid.bDiv);
				var rows, rh;
				if(table[0].rows.length) {
					try {
						rows = table[0].rows[1];
						rh = rows ? $(rows).outerHeight() || grid.prevRowHeight : grid.prevRowHeight;
					} catch (pv) {
						rh = grid.prevRowHeight;
					}
				}
				if (!rh) { return; }
				grid.prevRowHeight = rh;
				var rn = p.rowNum;
				var scrollTop = grid.scrollTop = grid.bDiv.scrollTop;
				var ttop = Math.round(table.position().top) - scrollTop;
				var tbot = ttop + table.height();
				var div = rh * rn;
				var page, npage, empty;
				if ( tbot < dh && ttop <= 0 &&
					(p.lastpage===undefined||parseInt((tbot + scrollTop + div - 1) / div,10) <= p.lastpage))
				{
					npage = parseInt((dh - tbot + div - 1) / div,10);
					if (tbot >= 0 || npage < 2 || p.scroll === true) {
						page = Math.round((tbot + scrollTop) / div) + 1;
						ttop = -1;
					} else {
						ttop = 1;
					}
				}
				if (ttop > 0) {
					page = parseInt(scrollTop / div,10) + 1;
					npage = parseInt((scrollTop + dh) / div,10) + 2 - page;
					empty = true;
				}
				if (npage) {
					if (p.lastpage && (page > p.lastpage || p.lastpage===1 || (page === p.page && page===p.lastpage)) ) {
						return;
					}
					if (grid.hDiv.loading) {
						grid.timer = setTimeout(grid.populateVisible, p.scrollTimeout);
					} else {
						p.page = page;
						if (empty) {
							grid.selectionPreserver(table[0]);
							grid.emptyRows.call(table[0], false, false);
						}
						grid.populate(npage);
					}
				}
			},
			scrollGrid: function( e ) {
				if(p.scroll) {
					var scrollTop = grid.bDiv.scrollTop;
					if(grid.scrollTop === undefined) { grid.scrollTop = 0; }
					if (scrollTop !== grid.scrollTop) {
						grid.scrollTop = scrollTop;
						if (grid.timer) { clearTimeout(grid.timer); }
						grid.timer = setTimeout(grid.populateVisible, p.scrollTimeout);
					}
				}
				grid.hDiv.scrollLeft = grid.bDiv.scrollLeft;
				if(p.footerrow) {
					grid.sDiv.scrollLeft = grid.bDiv.scrollLeft;
				}
				if( e ) { e.stopPropagation(); }
			},
			selectionPreserver : function(ts) {
				var p = ts.p,
				sr = p.selrow, sra = p.selarrrow ? $.makeArray(p.selarrrow) : null,
				left = ts.grid.bDiv.scrollLeft,
				restoreSelection = function() {
					var i;
					p.selrow = null;
					p.selarrrow = [];
					if(p.multiselect && sra && sra.length>0) {
						for(i=0;i<sra.length;i++){
							if (sra[i] !== sr) {
								$(ts).jqGrid("setSelection",sra[i],false, null);
							}
						}
					}
					if (sr) {
						$(ts).jqGrid("setSelection",sr,false,null);
					}
					ts.grid.bDiv.scrollLeft = left;
					$(ts).unbind('.selectionPreserver', restoreSelection);
				};
				$(ts).bind('jqGridGridComplete.selectionPreserver', restoreSelection);
			}
		};
		if(this.tagName.toUpperCase() !== 'TABLE') {
			alert("Element is not a table");
			return;
		}
		if(document.documentMode !== undefined ) { // IE only
			if(document.documentMode <= 5) {
				alert("Grid can not be used in this ('quirks') mode!");
				return;
			}
		}
		$(this).empty().attr("tabindex","0");
		this.p = p ;
		this.p.useProp = !!$.fn.prop;
		var i, dir;
		if(this.p.colNames.length === 0) {
			for (i=0;i<this.p.colModel.length;i++){
				this.p.colNames[i] = this.p.colModel[i].label || this.p.colModel[i].name;
			}
		}
		if( this.p.colNames.length !== this.p.colModel.length ) {
			alert($.jgrid.errors.model);
			return;
		}
		var gv = $("<div class='ui-jqgrid-view'></div>"),
		isMSIE = $.jgrid.msie;
		ts.p.direction = $.trim(ts.p.direction.toLowerCase());
		if($.inArray(ts.p.direction,["ltr","rtl"]) === -1) { ts.p.direction = "ltr"; }
		dir = ts.p.direction;

		$(gv).insertBefore(this);
		$(this).removeClass("scroll").appendTo(gv);
		var eg = $("<div class='ui-jqgrid ui-widget ui-widget-content ui-corner-all'></div>");
		$(eg).attr({"id" : "gbox_"+this.id,"dir":dir}).insertBefore(gv);
		$(gv).attr("id","gview_"+this.id).appendTo(eg);
		$("<div class='ui-widget-overlay jqgrid-overlay' id='lui_"+this.id+"'></div>").insertBefore(gv);
		$("<div class='loading ui-state-default ui-state-active' id='load_"+this.id+"'>"+this.p.loadtext+"</div>").insertBefore(gv);
		$(this).attr({cellspacing:"0",cellpadding:"0",border:"0","role":"grid","aria-multiselectable":!!this.p.multiselect,"aria-labelledby":"gbox_"+this.id});
		var sortkeys = ["shiftKey","altKey","ctrlKey"],
		intNum = function(val,defval) {
			val = parseInt(val,10);
			if (isNaN(val)) { return defval || 0;}
			return val;
		},
		formatCol = function (pos, rowInd, tv, rawObject, rowId, rdata){
			var cm = ts.p.colModel[pos],
			ral = cm.align, result="style=\"", clas = cm.classes, nm = cm.name, celp, acp=[];
			if(ral) { result += "text-align:"+ral+";"; }
			if(cm.hidden===true) { result += "display:none;"; }
			if(rowInd===0) {
				result += "width: "+grid.headers[pos].width+"px;";
			} else if (cm.cellattr && $.isFunction(cm.cellattr))
			{
				celp = cm.cellattr.call(ts, rowId, tv, rawObject, cm, rdata);
				if(celp && typeof celp === "string") {
					celp = celp.replace(/style/i,'style').replace(/title/i,'title');
					if(celp.indexOf('title') > -1) { cm.title=false;}
					if(celp.indexOf('class') > -1) { clas = undefined;}
					acp = celp.replace('-style','-sti').split(/style/);
					if(acp.length === 2 ) {
						acp[1] =  $.trim(acp[1].replace('-sti','-style').replace("=",""));
						if(acp[1].indexOf("'") === 0 || acp[1].indexOf('"') === 0) {
							acp[1] = acp[1].substring(1);
						}
						result += acp[1].replace(/'/gi,'"');
					} else {
						result += "\"";
					}
				}
			}
			if(!acp.length) { acp[0] = ""; result += "\"";}
			result += (clas !== undefined ? (" class=\""+clas+"\"") :"") + ((cm.title && tv) ? (" title=\""+$.jgrid.stripHtml(tv)+"\"") :"");
			result += " aria-describedby=\""+ts.p.id+"_"+nm+"\"";
			return result + acp[0];
		},
		cellVal =  function (val) {
			return val == null || val === "" ? "&#160;" : (ts.p.autoencode ? $.jgrid.htmlEncode(val) : String(val));
		},
		formatter = function (rowId, cellval , colpos, rwdat, _act){
			var cm = ts.p.colModel[colpos],v;
			if(cm.formatter !== undefined) {
				rowId = String(ts.p.idPrefix) !== "" ? $.jgrid.stripPref(ts.p.idPrefix, rowId) : rowId;
				var opts= {rowId: rowId, colModel:cm, gid:ts.p.id, pos:colpos };
				if($.isFunction( cm.formatter ) ) {
					v = cm.formatter.call(ts,cellval,opts,rwdat,_act);
				} else if($.fmatter){
					v = $.fn.fmatter.call(ts,cm.formatter,cellval,opts,rwdat,_act);
				} else {
					v = cellVal(cellval);
				}
			} else {
				v = cellVal(cellval);
			}
			return v;
		},
		addCell = function(rowId,cell,pos,irow, srvr, rdata) {
			var v,prp;
			v = formatter(rowId,cell,pos,srvr,'add');
			prp = formatCol( pos,irow, v, srvr, rowId, rdata);
			return "<td role=\"gridcell\" "+prp+">"+v+"</td>";
		},
		addMulti = function(rowid,pos,irow,checked){
			var	v = "<input role=\"checkbox\" type=\"checkbox\""+" id=\"jqg_"+ts.p.id+"_"+rowid+"\" class=\"cbox\" name=\"jqg_"+ts.p.id+"_"+rowid+"\"" + (checked ? "checked=\"checked\"" : "")+"/>",
			prp = formatCol( pos,irow,'',null, rowid, true);
			return "<td role=\"gridcell\" "+prp+">"+v+"</td>";
		},
		addRowNum = function (pos,irow,pG,rN) {
			var v =  (parseInt(pG,10)-1)*parseInt(rN,10)+1+irow,
			prp = formatCol( pos,irow,v, null, irow, true);
			return "<td role=\"gridcell\" class=\"ui-state-default jqgrid-rownum\" "+prp+">"+v+"</td>";
		},
		reader = function (datatype) {
			var field, f=[], j=0, i;
			for(i =0; i<ts.p.colModel.length; i++){
				field = ts.p.colModel[i];
				if (field.name !== 'cb' && field.name !=='subgrid' && field.name !=='rn') {
					f[j]= datatype === "local" ?
					field.name :
					( (datatype==="xml" || datatype === "xmlstring") ? field.xmlmap || field.name : field.jsonmap || field.name );
					if(ts.p.keyIndex !== false && field.key===true ) {
						ts.p.keyName = f[j];
					}
					j++;
				}
			}
			return f;
		},
		orderedCols = function (offset) {
			var order = ts.p.remapColumns;
			if (!order || !order.length) {
				order = $.map(ts.p.colModel, function(v,i) { return i; });
			}
			if (offset) {
				order = $.map(order, function(v) { return v<offset?null:v-offset; });
			}
			return order;
		},
		emptyRows = function (scroll, locdata) {
			var firstrow;
			if (this.p.deepempty) {
				$(this.rows).slice(1).remove();
			} else {
				firstrow = this.rows.length > 0 ? this.rows[0] : null;
				$(this.firstChild).empty().append(firstrow);
			}
			if (scroll && this.p.scroll) {
				$(this.grid.bDiv.firstChild).css({height: "auto"});
				$(this.grid.bDiv.firstChild.firstChild).css({height: 0, display: "none"});
				if (this.grid.bDiv.scrollTop !== 0) {
					this.grid.bDiv.scrollTop = 0;
				}
			}
			if(locdata === true && this.p.treeGrid) {
				this.p.data = []; this.p._index = {};
			}
		},
		refreshIndex = function() {
			var datalen = ts.p.data.length, idname, i, val,
			ni = ts.p.rownumbers===true ? 1 :0,
			gi = ts.p.multiselect ===true ? 1 :0,
			si = ts.p.subGrid===true ? 1 :0;

			if(ts.p.keyIndex === false || ts.p.loadonce === true) {
				idname = ts.p.localReader.id;
			} else {
				idname = ts.p.colModel[ts.p.keyIndex+gi+si+ni].name;
			}
			for(i =0;i < datalen; i++) {
				val = $.jgrid.getAccessor(ts.p.data[i],idname);
				if (val === undefined) { val=String(i+1); }
				ts.p._index[val] = i;
			}
		},
		constructTr = function(id, hide, altClass, rd, cur, selected) {
			var tabindex = '-1', restAttr = '', attrName, style = hide ? 'display:none;' : '',
				classes = 'ui-widget-content jqgrow ui-row-' + ts.p.direction + (altClass ? ' ' + altClass : '') + (selected ? ' ui-state-highlight' : ''),
				rowAttrObj = $(ts).triggerHandler("jqGridRowAttr", [rd, cur, id]);
				if( typeof rowAttrObj !== "object" ) {
					rowAttrObj =   $.isFunction(ts.p.rowattr) ? ts.p.rowattr.call(ts, rd, cur, id) :{};
				}
			if(!$.isEmptyObject( rowAttrObj )) {
				if (rowAttrObj.hasOwnProperty("id")) {
					id = rowAttrObj.id;
					delete rowAttrObj.id;
				}
				if (rowAttrObj.hasOwnProperty("tabindex")) {
					tabindex = rowAttrObj.tabindex;
					delete rowAttrObj.tabindex;
				}
				if (rowAttrObj.hasOwnProperty("style")) {
					style += rowAttrObj.style;
					delete rowAttrObj.style;
				}
				if (rowAttrObj.hasOwnProperty("class")) {
					classes += ' ' + rowAttrObj['class'];
					delete rowAttrObj['class'];
				}
				// dot't allow to change role attribute
				try { delete rowAttrObj.role; } catch(ra){}
				for (attrName in rowAttrObj) {
					if (rowAttrObj.hasOwnProperty(attrName)) {
						restAttr += ' ' + attrName + '=' + rowAttrObj[attrName];
					}
				}
			}
			return '<tr role="row" id="' + id + '" tabindex="' + tabindex + '" class="' + classes + '"' +
				(style === '' ? '' : ' style="' + style + '"') + restAttr + '>';
		},
		addXmlData = function (xml,t, rcnt, more, adjust) {
			var startReq = new Date(),
			locdata = (ts.p.datatype !== "local" && ts.p.loadonce) || ts.p.datatype === "xmlstring",
			xmlid = "_id_", xmlRd = ts.p.xmlReader,
			frd = ts.p.datatype === "local" ? "local" : "xml";
			if(locdata) {
				ts.p.data = [];
				ts.p._index = {};
				ts.p.localReader.id = xmlid;
			}
			ts.p.reccount = 0;
			if($.isXMLDoc(xml)) {
				if(ts.p.treeANode===-1 && !ts.p.scroll) {
					emptyRows.call(ts, false, true);
					rcnt=1;
				} else { rcnt = rcnt > 1 ? rcnt :1; }
			} else { return; }
			var self= $(ts), i,fpos,ir=0,v,gi=ts.p.multiselect===true?1:0,si=0,addSubGridCell,ni=ts.p.rownumbers===true?1:0,idn, getId,f=[],F,rd ={}, xmlr,rid, rowData=[], cn=(ts.p.altRows === true) ? ts.p.altclass:"",cn1;
			if(ts.p.subGrid===true) {
				si = 1;
				addSubGridCell = $.jgrid.getMethod("addSubGridCell");
			}
			if(!xmlRd.repeatitems) {f = reader(frd);}
			if( ts.p.keyIndex===false) {
				idn = $.isFunction( xmlRd.id ) ?  xmlRd.id.call(ts, xml) : xmlRd.id;
			} else {
				idn = ts.p.keyIndex;
			}
			if(f.length>0 && !isNaN(idn)) {
				idn=ts.p.keyName;
			}
			if( String(idn).indexOf("[") === -1 ) {
				if (f.length) {
					getId = function( trow, k) {return $(idn,trow).text() || k;};
				} else {
					getId = function( trow, k) {return $(xmlRd.cell,trow).eq(idn).text() || k;};
				}
			}
			else {
				getId = function( trow, k) {return trow.getAttribute(idn.replace(/[\[\]]/g,"")) || k;};
			}
			ts.p.userData = {};
			ts.p.page = intNum($.jgrid.getXmlData(xml, xmlRd.page), ts.p.page);
			ts.p.lastpage = intNum($.jgrid.getXmlData(xml, xmlRd.total), 1);
			ts.p.records = intNum($.jgrid.getXmlData(xml, xmlRd.records));
			if($.isFunction(xmlRd.userdata)) {
				ts.p.userData = xmlRd.userdata.call(ts, xml) || {};
			} else {
				$.jgrid.getXmlData(xml, xmlRd.userdata, true).each(function() {ts.p.userData[this.getAttribute("name")]= $(this).text();});
			}
			var gxml = $.jgrid.getXmlData( xml, xmlRd.root, true);
			gxml = $.jgrid.getXmlData( gxml, xmlRd.row, true);
			if (!gxml) { gxml = []; }
			var gl = gxml.length, j=0, grpdata=[], rn = parseInt(ts.p.rowNum,10), br=ts.p.scroll?$.jgrid.randId():1, altr;
			if (gl > 0 &&  ts.p.page <= 0) { ts.p.page = 1; }
			if(gxml && gl){
			if (adjust) { rn *= adjust+1; }
			var afterInsRow = $.isFunction(ts.p.afterInsertRow), hiderow=false, groupingPrepare;
			if(ts.p.grouping)  {
				hiderow = ts.p.groupingView.groupCollapse === true;
				groupingPrepare = $.jgrid.getMethod("groupingPrepare");
			}
			while (j<gl) {
				xmlr = gxml[j];
				rid = getId(xmlr,br+j);
				rid  = ts.p.idPrefix + rid;
				altr = rcnt === 0 ? 0 : rcnt+1;
				cn1 = (altr+j)%2 === 1 ? cn : '';
				var iStartTrTag = rowData.length;
				rowData.push("");
				if( ni ) {
					rowData.push( addRowNum(0,j,ts.p.page,ts.p.rowNum) );
				}
				if( gi ) {
					rowData.push( addMulti(rid,ni,j, false) );
				}
				if( si ) {
					rowData.push( addSubGridCell.call(self,gi+ni,j+rcnt) );
				}
				if(xmlRd.repeatitems){
					if (!F) { F=orderedCols(gi+si+ni); }
					var cells = $.jgrid.getXmlData( xmlr, xmlRd.cell, true);
					$.each(F, function (k) {
						var cell = cells[this];
						if (!cell) { return false; }
						v = cell.textContent || cell.text;
						rd[ts.p.colModel[k+gi+si+ni].name] = v;
						rowData.push( addCell(rid,v,k+gi+si+ni,j+rcnt,xmlr, rd) );
					});
				} else {
					for(i = 0; i < f.length;i++) {
						v = $.jgrid.getXmlData( xmlr, f[i]);
						rd[ts.p.colModel[i+gi+si+ni].name] = v;
						rowData.push( addCell(rid, v, i+gi+si+ni, j+rcnt, xmlr, rd) );
					}
				}
				rowData[iStartTrTag] = constructTr(rid, hiderow, cn1, rd, xmlr, false);
				rowData.push("</tr>");
				if(ts.p.grouping) {
					grpdata.push( rowData );
					if(!ts.p.groupingView._locgr) {
						groupingPrepare.call(self, rd, j );
					}
					rowData = [];
				}
				if(locdata || ts.p.treeGrid === true) {
					rd[xmlid] = $.jgrid.stripPref(ts.p.idPrefix, rid);
					ts.p.data.push(rd);
					ts.p._index[rd[xmlid]] = ts.p.data.length-1;
				}
				if(ts.p.gridview === false ) {
					$("tbody:first",t).append(rowData.join(''));
					self.triggerHandler("jqGridAfterInsertRow", [rid, rd, xmlr]);
					if(afterInsRow) {ts.p.afterInsertRow.call(ts,rid,rd,xmlr);}
					rowData=[];
				}
				rd={};
				ir++;
				j++;
				if(ir===rn) {break;}
			}
			}
			if(ts.p.gridview === true) {
				fpos = ts.p.treeANode > -1 ? ts.p.treeANode: 0;
				if(ts.p.grouping) {
					if(!locdata) {
						self.jqGrid('groupingRender',grpdata,ts.p.colModel.length, ts.p.page, rn);
					}
					grpdata = null;
				} else if(ts.p.treeGrid === true && fpos > 0) {
					$(ts.rows[fpos]).after(rowData.join(''));
				} else {
					$("tbody:first",t).append(rowData.join(''));
				}
			}
			if(ts.p.subGrid === true ) {
				try {self.jqGrid("addSubGrid",gi+ni);} catch (_){}
			}
			ts.p.totaltime = new Date() - startReq;
			if(ir>0) { if(ts.p.records===0) { ts.p.records=gl;} }
			rowData =null;
			if( ts.p.treeGrid === true) {
				try {self.jqGrid("setTreeNode", fpos+1, ir+fpos+1);} catch (e) {}
			}
			if(!ts.p.treeGrid && !ts.p.scroll) {ts.grid.bDiv.scrollTop = 0;}
			ts.p.reccount=ir;
			ts.p.treeANode = -1;
			if(ts.p.userDataOnFooter) { self.jqGrid("footerData","set",ts.p.userData,true); }
			if(locdata) {
				ts.p.records = gl;
				ts.p.lastpage = Math.ceil(gl/ rn);
			}
			if (!more) { ts.updatepager(false,true); }
			if(locdata) {
				while (ir<gl) {
					xmlr = gxml[ir];
					rid = getId(xmlr,ir+br);
					rid  = ts.p.idPrefix + rid;
					if(xmlRd.repeatitems){
						if (!F) { F=orderedCols(gi+si+ni); }
						var cells2 = $.jgrid.getXmlData( xmlr, xmlRd.cell, true);
						$.each(F, function (k) {
							var cell = cells2[this];
							if (!cell) { return false; }
							v = cell.textContent || cell.text;
							rd[ts.p.colModel[k+gi+si+ni].name] = v;
						});
					} else {
						for(i = 0; i < f.length;i++) {
							v = $.jgrid.getXmlData( xmlr, f[i]);
							rd[ts.p.colModel[i+gi+si+ni].name] = v;
						}
					}
					rd[xmlid] = $.jgrid.stripPref(ts.p.idPrefix, rid);
					if(ts.p.grouping) {
						groupingPrepare.call(self, rd, ir );
					}
					ts.p.data.push(rd);
					ts.p._index[rd[xmlid]] = ts.p.data.length-1;
					rd = {};
					ir++;
				}
				if(ts.p.grouping) {
					ts.p.groupingView._locgr = true;
					self.jqGrid('groupingRender', grpdata, ts.p.colModel.length, ts.p.page, rn);
					grpdata = null;
				}
			}
		},
		addJSONData = function(data,t, rcnt, more, adjust) {
			var startReq = new Date();
			if(data) {
				if(ts.p.treeANode === -1 && !ts.p.scroll) {
					emptyRows.call(ts, false, true);
					rcnt=1;
				} else { rcnt = rcnt > 1 ? rcnt :1; }
			} else { return; }

			var dReader, locid = "_id_", frd,
			locdata = (ts.p.datatype !== "local" && ts.p.loadonce) || ts.p.datatype === "jsonstring";
			if(locdata) { ts.p.data = []; ts.p._index = {}; ts.p.localReader.id = locid;}
			ts.p.reccount = 0;
			if(ts.p.datatype === "local") {
				dReader =  ts.p.localReader;
				frd= 'local';
			} else {
				dReader =  ts.p.jsonReader;
				frd='json';
			}
			var self = $(ts), ir=0,v,i,j,f=[],cur,gi=ts.p.multiselect?1:0,si=ts.p.subGrid===true?1:0,addSubGridCell,ni=ts.p.rownumbers===true?1:0,arrayReader=orderedCols(gi+si+ni),objectReader=reader(frd),rowReader,len,drows,idn,rd={}, fpos, idr,rowData=[],cn=(ts.p.altRows === true) ? ts.p.altclass:"",cn1;
			ts.p.page = intNum($.jgrid.getAccessor(data,dReader.page), ts.p.page);
			ts.p.lastpage = intNum($.jgrid.getAccessor(data,dReader.total), 1);
			ts.p.records = intNum($.jgrid.getAccessor(data,dReader.records));
			ts.p.userData = $.jgrid.getAccessor(data,dReader.userdata) || {};
			if(si) {
				addSubGridCell = $.jgrid.getMethod("addSubGridCell");
			}
			if( ts.p.keyIndex===false ) {
				idn = $.isFunction(dReader.id) ? dReader.id.call(ts, data) : dReader.id;
			} else {
				idn = ts.p.keyIndex;
			}
			if(!dReader.repeatitems) {
				f = objectReader;
				if(f.length>0 && !isNaN(idn)) {
					idn=ts.p.keyName;
				}
			}
			drows = $.jgrid.getAccessor(data,dReader.root);
			if (drows == null && $.isArray(data)) { drows = data; }
			if (!drows) { drows = []; }
			len = drows.length; i=0;
			if (len > 0 && ts.p.page <= 0) { ts.p.page = 1; }
			var rn = parseInt(ts.p.rowNum,10),br=ts.p.scroll?$.jgrid.randId():1, altr, selected=false, selr;
			if (adjust) { rn *= adjust+1; }
			if(ts.p.datatype === "local" && !ts.p.deselectAfterSort) {
				selected = true;
			}
			var afterInsRow = $.isFunction(ts.p.afterInsertRow), grpdata=[],hiderow=false, groupingPrepare;
			if(ts.p.grouping)  {
				hiderow = ts.p.groupingView.groupCollapse === true;
				groupingPrepare = $.jgrid.getMethod("groupingPrepare");
			}
			while (i<len) {
				cur = drows[i];
				idr = $.jgrid.getAccessor(cur,idn);
				if(idr === undefined) {
					if (typeof idn === "number" && ts.p.colModel[idn+gi+si+ni] != null) {
						// reread id by name
						idr = $.jgrid.getAccessor(cur,ts.p.colModel[idn+gi+si+ni].name);
					}
					if(idr === undefined) {
						idr = br+i;
						if(f.length===0){
							if(dReader.cell){
								var ccur = $.jgrid.getAccessor(cur,dReader.cell) || cur;
								idr = ccur != null && ccur[idn] !== undefined ? ccur[idn] : idr;
								ccur=null;
							}
						}
					}
				}
				idr  = ts.p.idPrefix + idr;
				altr = rcnt === 1 ? 0 : rcnt;
				cn1 = (altr+i)%2 === 1 ? cn : '';
				if( selected) {
					if( ts.p.multiselect) {
						selr = ($.inArray(idr, ts.p.selarrrow) !== -1);
					} else {
						selr = (idr === ts.p.selrow);
					}
				}
				var iStartTrTag = rowData.length;
				rowData.push("");
				if( ni ) {
					rowData.push( addRowNum(0,i,ts.p.page,ts.p.rowNum) );
				}
				if( gi ){
					rowData.push( addMulti(idr,ni,i,selr) );
				}
				if( si ) {
					rowData.push( addSubGridCell.call(self,gi+ni,i+rcnt) );
				}
				rowReader=objectReader;
				if (dReader.repeatitems) {
					if(dReader.cell) {cur = $.jgrid.getAccessor(cur,dReader.cell) || cur;}
					if ($.isArray(cur)) { rowReader=arrayReader; }
				}
				for (j=0;j<rowReader.length;j++) {
					v = $.jgrid.getAccessor(cur,rowReader[j]);
					rd[ts.p.colModel[j+gi+si+ni].name] = v;
					rowData.push( addCell(idr,v,j+gi+si+ni,i+rcnt,cur, rd) );
				}
				rowData[iStartTrTag] = constructTr(idr, hiderow, cn1, rd, cur, selr);
				rowData.push( "</tr>" );
				if(ts.p.grouping) {
					grpdata.push( rowData );
					if(!ts.p.groupingView._locgr) {
						groupingPrepare.call(self, rd, i);
					}
					rowData = [];
				}
				if(locdata || ts.p.treeGrid===true) {
					rd[locid] = $.jgrid.stripPref(ts.p.idPrefix, idr);
					ts.p.data.push(rd);
					ts.p._index[rd[locid]] = ts.p.data.length-1;
				}
				if(ts.p.gridview === false ) {
					$("#"+$.jgrid.jqID(ts.p.id)+" tbody:first").append(rowData.join(''));
					self.triggerHandler("jqGridAfterInsertRow", [idr, rd, cur]);
					if(afterInsRow) {ts.p.afterInsertRow.call(ts,idr,rd,cur);}
					rowData=[];//ari=0;
				}
				rd={};
				ir++;
				i++;
				if(ir===rn) { break; }
			}
			if(ts.p.gridview === true ) {
				fpos = ts.p.treeANode > -1 ? ts.p.treeANode: 0;
				if(ts.p.grouping) {
					if(!locdata) {
						self.jqGrid('groupingRender', grpdata, ts.p.colModel.length, ts.p.page, rn);
						grpdata = null;
					}
				} else if(ts.p.treeGrid === true && fpos > 0) {
					$(ts.rows[fpos]).after(rowData.join(''));
				} else {
					$("#"+$.jgrid.jqID(ts.p.id)+" tbody:first").append(rowData.join(''));
				}
			}
			if(ts.p.subGrid === true ) {
				try { self.jqGrid("addSubGrid",gi+ni);} catch (_){}
			}
			ts.p.totaltime = new Date() - startReq;
			if(ir>0) {
				if(ts.p.records===0) { ts.p.records=len; }
			}
			rowData = null;
			if( ts.p.treeGrid === true) {
				try {self.jqGrid("setTreeNode", fpos+1, ir+fpos+1);} catch (e) {}
			}
			if(!ts.p.treeGrid && !ts.p.scroll) {ts.grid.bDiv.scrollTop = 0;}
			ts.p.reccount=ir;
			ts.p.treeANode = -1;
			if(ts.p.userDataOnFooter) { self.jqGrid("footerData","set",ts.p.userData,true); }
			if(locdata) {
				ts.p.records = len;
				ts.p.lastpage = Math.ceil(len/ rn);
			}
			if (!more) { ts.updatepager(false,true); }
			if(locdata) {
				while (ir<len && drows[ir]) {
					cur = drows[ir];
					idr = $.jgrid.getAccessor(cur,idn);
					if(idr === undefined) {
						if (typeof idn === "number" && ts.p.colModel[idn+gi+si+ni] != null) {
							// reread id by name
							idr = $.jgrid.getAccessor(cur,ts.p.colModel[idn+gi+si+ni].name);
						}
						if(idr === undefined) {
							idr = br+ir;
							if(f.length===0){
								if(dReader.cell){
									var ccur2 = $.jgrid.getAccessor(cur,dReader.cell) || cur;
									idr = ccur2 != null && ccur2[idn] !== undefined ? ccur2[idn] : idr;
									ccur2=null;
								}
							}
						}
					}
					if(cur) {
						idr  = ts.p.idPrefix + idr;
						rowReader=objectReader;
						if (dReader.repeatitems) {
							if(dReader.cell) {cur = $.jgrid.getAccessor(cur,dReader.cell) || cur;}
							if ($.isArray(cur)) { rowReader=arrayReader; }
						}

						for (j=0;j<rowReader.length;j++) {
							rd[ts.p.colModel[j+gi+si+ni].name] = $.jgrid.getAccessor(cur,rowReader[j]);
						}
						rd[locid] = $.jgrid.stripPref(ts.p.idPrefix, idr);
						if(ts.p.grouping) {
							groupingPrepare.call(self, rd, ir );
						}
						ts.p.data.push(rd);
						ts.p._index[rd[locid]] = ts.p.data.length-1;
						rd = {};
					}
					ir++;
				}
				if(ts.p.grouping) {
					ts.p.groupingView._locgr = true;
					self.jqGrid('groupingRender', grpdata, ts.p.colModel.length, ts.p.page, rn);
					grpdata = null;
				}
			}
		},
		addLocalData = function() {
			var st = ts.p.multiSort ? [] : "", sto=[], fndsort=false, cmtypes={}, grtypes=[], grindexes=[], srcformat, sorttype, newformat;
			if(!$.isArray(ts.p.data)) {
				return;
			}
			var grpview = ts.p.grouping ? ts.p.groupingView : false, lengrp, gin;
			$.each(ts.p.colModel,function(){
				sorttype = this.sorttype || "text";
				if(sorttype === "date" || sorttype === "datetime") {
					if(this.formatter && typeof this.formatter === 'string' && this.formatter === 'date') {
						if(this.formatoptions && this.formatoptions.srcformat) {
							srcformat = this.formatoptions.srcformat;
						} else {
							srcformat = $.jgrid.formatter.date.srcformat;
						}
						if(this.formatoptions && this.formatoptions.newformat) {
							newformat = this.formatoptions.newformat;
						} else {
							newformat = $.jgrid.formatter.date.newformat;
						}
					} else {
						srcformat = newformat = this.datefmt || "Y-m-d";
					}
					cmtypes[this.name] = {"stype": sorttype, "srcfmt": srcformat,"newfmt":newformat, "sfunc": this.sortfunc || null};
				} else {
					cmtypes[this.name] = {"stype": sorttype, "srcfmt":'',"newfmt":'', "sfunc": this.sortfunc || null};
				}
				if(ts.p.grouping ) {
					for(gin =0, lengrp = grpview.groupField.length; gin< lengrp; gin++) {
						if( this.name === grpview.groupField[gin]) {
							var grindex = this.name;
							if (this.index) {
								grindex = this.index;
							}
							grtypes[gin] = cmtypes[grindex];
							grindexes[gin]= grindex;
						}
					}
				}
				if(ts.p.multiSort) {
					if(this.lso) {
						st.push(this.name);
						var tmplso= this.lso.split("-");
						sto.push( tmplso[tmplso.length-1] );
					}
				} else {
					if(!fndsort && (this.index === ts.p.sortname || this.name === ts.p.sortname)){
						st = this.name; // ???
						fndsort = true;
					}
				}
			});
			if(ts.p.treeGrid) {
				$(ts).jqGrid("SortTree", st, ts.p.sortorder, cmtypes[st].stype || 'text', cmtypes[st].srcfmt || '');
				return;
			}
			var compareFnMap = {
				'eq':function(queryObj) {return queryObj.equals;},
				'ne':function(queryObj) {return queryObj.notEquals;},
				'lt':function(queryObj) {return queryObj.less;},
				'le':function(queryObj) {return queryObj.lessOrEquals;},
				'gt':function(queryObj) {return queryObj.greater;},
				'ge':function(queryObj) {return queryObj.greaterOrEquals;},
				'cn':function(queryObj) {return queryObj.contains;},
				'nc':function(queryObj,op) {return op === "OR" ? queryObj.orNot().contains : queryObj.andNot().contains;},
				'bw':function(queryObj) {return queryObj.startsWith;},
				'bn':function(queryObj,op) {return op === "OR" ? queryObj.orNot().startsWith : queryObj.andNot().startsWith;},
				'en':function(queryObj,op) {return op === "OR" ? queryObj.orNot().endsWith : queryObj.andNot().endsWith;},
				'ew':function(queryObj) {return queryObj.endsWith;},
				'ni':function(queryObj,op) {return op === "OR" ? queryObj.orNot().equals : queryObj.andNot().equals;},
				'in':function(queryObj) {return queryObj.equals;},
				'nu':function(queryObj) {return queryObj.isNull;},
				'nn':function(queryObj,op) {return op === "OR" ? queryObj.orNot().isNull : queryObj.andNot().isNull;}

			},
			query = $.jgrid.from(ts.p.data);
			if (ts.p.ignoreCase) { query = query.ignoreCase(); }
			function tojLinq ( group ) {
				var s = 0, index, gor, ror, opr, rule;
				if (group.groups != null) {
					gor = group.groups.length && group.groupOp.toString().toUpperCase() === "OR";
					if (gor) {
						query.orBegin();
					}
					for (index = 0; index < group.groups.length; index++) {
						if (s > 0 && gor) {
							query.or();
						}
						try {
							tojLinq(group.groups[index]);
						} catch (e) {alert(e);}
						s++;
					}
					if (gor) {
						query.orEnd();
					}
				}
				if (group.rules != null) {
					//if(s>0) {
					//	var result = query.select();
					//	query = $.jgrid.from( result);
					//	if (ts.p.ignoreCase) { query = query.ignoreCase(); }
					//}
					try{
						ror = group.rules.length && group.groupOp.toString().toUpperCase() === "OR";
						if (ror) {
							query.orBegin();
						}
						for (index = 0; index < group.rules.length; index++) {
							rule = group.rules[index];
							opr = group.groupOp.toString().toUpperCase();
							if (compareFnMap[rule.op] && rule.field ) {
								if(s > 0 && opr && opr === "OR") {
									query = query.or();
								}
								query = compareFnMap[rule.op](query, opr)(rule.field, rule.data, cmtypes[rule.field]);
							}
							s++;
						}
						if (ror) {
							query.orEnd();
						}
					} catch (g) {alert(g);}
				}
			}

			if (ts.p.search === true) {
				var srules = ts.p.postData.filters;
				if(srules) {
					if(typeof srules === "string") { srules = $.jgrid.parse(srules);}
					tojLinq( srules );
				} else {
					try {
						query = compareFnMap[ts.p.postData.searchOper](query)(ts.p.postData.searchField, ts.p.postData.searchString,cmtypes[ts.p.postData.searchField]);
					} catch (se){}
				}
			}
			if(ts.p.grouping) {
				for(gin=0; gin<lengrp;gin++) {
					query.orderBy(grindexes[gin],grpview.groupOrder[gin],grtypes[gin].stype, grtypes[gin].srcfmt);
				}
			}
			if(ts.p.multiSort) {
				$.each(st,function(i){
					query.orderBy(this, sto[i], cmtypes[this].stype, cmtypes[this].srcfmt, cmtypes[this].sfunc);
				});
			} else {
				if (st && ts.p.sortorder && fndsort) {
					if(ts.p.sortorder.toUpperCase() === "DESC") {
						query.orderBy(ts.p.sortname, "d", cmtypes[st].stype, cmtypes[st].srcfmt, cmtypes[st].sfunc);
					} else {
						query.orderBy(ts.p.sortname, "a", cmtypes[st].stype, cmtypes[st].srcfmt, cmtypes[st].sfunc);
					}
				}
			}
			var queryResults = query.select(),
			recordsperpage = parseInt(ts.p.rowNum,10),
			total = queryResults.length,
			page = parseInt(ts.p.page,10),
			totalpages = Math.ceil(total / recordsperpage),
			retresult = {};
			if((ts.p.search || ts.p.resetsearch) && ts.p.grouping && ts.p.groupingView._locgr) {
				ts.p.groupingView.groups =[];
				var j, grPrepare = $.jgrid.getMethod("groupingPrepare"), key, udc;
				if(ts.p.footerrow && ts.p.userDataOnFooter) {
					for (key in ts.p.userData) {
						if(ts.p.userData.hasOwnProperty(key)) {
							ts.p.userData[key] = 0;
						}
					}
					udc = true;
				}
				for(j=0; j<total; j++) {
					if(udc) {
						for(key in ts.p.userData){
							ts.p.userData[key] += parseFloat(queryResults[j][key] || 0);
						}
					}
					grPrepare.call($(ts),queryResults[j],j, recordsperpage );
				}
			}
			queryResults = queryResults.slice( (page-1)*recordsperpage , page*recordsperpage );
			query = null;
			cmtypes = null;
			retresult[ts.p.localReader.total] = totalpages;
			retresult[ts.p.localReader.page] = page;
			retresult[ts.p.localReader.records] = total;
			retresult[ts.p.localReader.root] = queryResults;
			retresult[ts.p.localReader.userdata] = ts.p.userData;
			queryResults = null;
			return  retresult;
		},
		updatepager = function(rn, dnd) {
			var cp, last, base, from,to,tot,fmt, pgboxes = "", sppg,
			tspg = ts.p.pager ? "_"+$.jgrid.jqID(ts.p.pager.substr(1)) : "",
			tspg_t = ts.p.toppager ? "_"+ts.p.toppager.substr(1) : "";
			base = parseInt(ts.p.page,10)-1;
			if(base < 0) { base = 0; }
			base = base*parseInt(ts.p.rowNum,10);
			to = base + ts.p.reccount;
			if (ts.p.scroll) {
				var rows = $("tbody:first > tr:gt(0)", ts.grid.bDiv);
				base = to - rows.length;
				ts.p.reccount = rows.length;
				var rh = rows.outerHeight() || ts.grid.prevRowHeight;
				if (rh) {
					var top = base * rh;
					var height = parseInt(ts.p.records,10) * rh;
					$(">div:first",ts.grid.bDiv).css({height : height}).children("div:first").css({height:top,display:top?"":"none"});
					if (ts.grid.bDiv.scrollTop == 0 && ts.p.page > 1) {
						ts.grid.bDiv.scrollTop = ts.p.rowNum * (ts.p.page - 1) * rh;
					}
				}
				ts.grid.bDiv.scrollLeft = ts.grid.hDiv.scrollLeft;
			}
			pgboxes = ts.p.pager || "";
			pgboxes += ts.p.toppager ?  (pgboxes ? "," + ts.p.toppager : ts.p.toppager) : "";
			if(pgboxes) {
				fmt = $.jgrid.formatter.integer || {};
				cp = intNum(ts.p.page);
				last = intNum(ts.p.lastpage);
				$(".selbox",pgboxes)[ this.p.useProp ? 'prop' : 'attr' ]("disabled",false);
				if(ts.p.pginput===true) {
					$('.ui-pg-input',pgboxes).val(ts.p.page);
					sppg = ts.p.toppager ? '#sp_1'+tspg+",#sp_1"+tspg_t : '#sp_1'+tspg;
					$(sppg).html($.fmatter ? $.fmatter.util.NumberFormat(ts.p.lastpage,fmt):ts.p.lastpage);

				}
				if (ts.p.viewrecords){
					if(ts.p.reccount === 0) {
						$(".ui-paging-info",pgboxes).html(ts.p.emptyrecords);
					} else {
						from = base+1;
						tot=ts.p.records;
						if($.fmatter) {
							from = $.fmatter.util.NumberFormat(from,fmt);
							to = $.fmatter.util.NumberFormat(to,fmt);
							tot = $.fmatter.util.NumberFormat(tot,fmt);
						}
						$(".ui-paging-info",pgboxes).html($.jgrid.format(ts.p.recordtext,from,to,tot));
					}
				}
				if(ts.p.pgbuttons===true) {
					if(cp<=0) {cp = last = 0;}
					if(cp===1 || cp === 0) {
						$("#first"+tspg+", #prev"+tspg).addClass('ui-state-disabled').removeClass('ui-state-hover');
						if(ts.p.toppager) { $("#first_t"+tspg_t+", #prev_t"+tspg_t).addClass('ui-state-disabled').removeClass('ui-state-hover'); }
					} else {
						$("#first"+tspg+", #prev"+tspg).removeClass('ui-state-disabled');
						if(ts.p.toppager) { $("#first_t"+tspg_t+", #prev_t"+tspg_t).removeClass('ui-state-disabled'); }
					}
					if(cp===last || cp === 0) {
						$("#next"+tspg+", #last"+tspg).addClass('ui-state-disabled').removeClass('ui-state-hover');
						if(ts.p.toppager) { $("#next_t"+tspg_t+", #last_t"+tspg_t).addClass('ui-state-disabled').removeClass('ui-state-hover'); }
					} else {
						$("#next"+tspg+", #last"+tspg).removeClass('ui-state-disabled');
						if(ts.p.toppager) { $("#next_t"+tspg_t+", #last_t"+tspg_t).removeClass('ui-state-disabled'); }
					}
				}
			}
			if(rn===true && ts.p.rownumbers === true) {
				$(">td.jqgrid-rownum",ts.rows).each(function(i){
					$(this).html(base+1+i);
				});
			}
			if(dnd && ts.p.jqgdnd) { $(ts).jqGrid('gridDnD','updateDnD');}
			$(ts).triggerHandler("jqGridGridComplete");
			if($.isFunction(ts.p.gridComplete)) {ts.p.gridComplete.call(ts);}
			$(ts).triggerHandler("jqGridAfterGridComplete");
		},
		beginReq = function() {
			ts.grid.hDiv.loading = true;
			if(ts.p.hiddengrid) { return;}
			switch(ts.p.loadui) {
				case "disable":
					break;
				case "enable":
					$("#load_"+$.jgrid.jqID(ts.p.id)).show();
					break;
				case "block":
					$("#lui_"+$.jgrid.jqID(ts.p.id)).show();
					$("#load_"+$.jgrid.jqID(ts.p.id)).show();
					break;
			}
		},
		endReq = function() {
			ts.grid.hDiv.loading = false;
			switch(ts.p.loadui) {
				case "disable":
					break;
				case "enable":
					$("#load_"+$.jgrid.jqID(ts.p.id)).hide();
					break;
				case "block":
					$("#lui_"+$.jgrid.jqID(ts.p.id)).hide();
					$("#load_"+$.jgrid.jqID(ts.p.id)).hide();
					break;
			}
		},
		populate = function (npage) {
			if(!ts.grid.hDiv.loading) {
				var pvis = ts.p.scroll && npage === false,
				prm = {}, dt, dstr, pN=ts.p.prmNames;
				if(ts.p.page <=0) { ts.p.page = Math.min(1,ts.p.lastpage); }
				if(pN.search !== null) {prm[pN.search] = ts.p.search;} if(pN.nd !== null) {prm[pN.nd] = new Date().getTime();}
				if(pN.rows !== null) {prm[pN.rows]= ts.p.rowNum;} if(pN.page !== null) {prm[pN.page]= ts.p.page;}
				if(pN.sort !== null) {prm[pN.sort]= ts.p.sortname;} if(pN.order !== null) {prm[pN.order]= ts.p.sortorder;}
				if(ts.p.rowTotal !== null && pN.totalrows !== null) { prm[pN.totalrows]= ts.p.rowTotal; }
				var lcf = $.isFunction(ts.p.loadComplete), lc = lcf ? ts.p.loadComplete : null;
				var adjust = 0;
				npage = npage || 1;
				if (npage > 1) {
					if(pN.npage !== null) {
						prm[pN.npage] = npage;
						adjust = npage - 1;
						npage = 1;
					} else {
						lc = function(req) {
							ts.p.page++;
							ts.grid.hDiv.loading = false;
							if (lcf) {
								ts.p.loadComplete.call(ts,req);
							}
							populate(npage-1);
						};
					}
				} else if (pN.npage !== null) {
					delete ts.p.postData[pN.npage];
				}
				if(ts.p.grouping) {
					$(ts).jqGrid('groupingSetup');
					var grp = ts.p.groupingView, gi, gs="";
					for(gi=0;gi<grp.groupField.length;gi++) {
						var index = grp.groupField[gi];
						$.each(ts.p.colModel, function(cmIndex, cmValue) {
							if (cmValue.name === index && cmValue.index){
								index = cmValue.index;
							}
						} );
						gs += index +" "+grp.groupOrder[gi]+", ";
					}
					prm[pN.sort] = gs + prm[pN.sort];
				}
				$.extend(ts.p.postData,prm);
				var rcnt = !ts.p.scroll ? 1 : ts.rows.length-1;
				var bfr = $(ts).triggerHandler("jqGridBeforeRequest");
				if (bfr === false || bfr === 'stop') { return; }
				if ($.isFunction(ts.p.datatype)) { ts.p.datatype.call(ts,ts.p.postData,"load_"+ts.p.id, rcnt, npage, adjust); return;}
				if ($.isFunction(ts.p.beforeRequest)) {
					bfr = ts.p.beforeRequest.call(ts);
					if(bfr === undefined) { bfr = true; }
					if ( bfr === false ) { return; }
				}
				dt = ts.p.datatype.toLowerCase();
				switch(dt)
				{
				case "json":
				case "jsonp":
				case "xml":
				case "script":
					$.ajax($.extend({
						url:ts.p.url,
						type:ts.p.mtype,
						dataType: dt ,
						data: $.isFunction(ts.p.serializeGridData)? ts.p.serializeGridData.call(ts,ts.p.postData) : ts.p.postData,
						success:function(data,st, xhr) {
							if ($.isFunction(ts.p.beforeProcessing)) {
								if (ts.p.beforeProcessing.call(ts, data, st, xhr) === false) {
									endReq();
									return;
								}
							}
							if(dt === "xml") { addXmlData(data,ts.grid.bDiv,rcnt,npage>1,adjust); }
							else { addJSONData(data,ts.grid.bDiv,rcnt,npage>1,adjust); }
							$(ts).triggerHandler("jqGridLoadComplete", [data]);
							if(lc) { lc.call(ts,data); }
							$(ts).triggerHandler("jqGridAfterLoadComplete", [data]);
							if (pvis) { ts.grid.populateVisible(); }
							if( ts.p.loadonce || ts.p.treeGrid) {ts.p.datatype = "local";}
							data=null;
							if (npage === 1) { endReq(); }
						},
						error:function(xhr,st,err){
							if($.isFunction(ts.p.loadError)) { ts.p.loadError.call(ts,xhr,st,err); }
							if (npage === 1) { endReq(); }
							xhr=null;
						},
						beforeSend: function(xhr, settings ){
							var gotoreq = true;
							if($.isFunction(ts.p.loadBeforeSend)) {
								gotoreq = ts.p.loadBeforeSend.call(ts,xhr, settings);
							}
							if(gotoreq === undefined) { gotoreq = true; }
							if(gotoreq === false) {
								return false;
							}
								beginReq();
							}
					},$.jgrid.ajaxOptions, ts.p.ajaxGridOptions));
				break;
				case "xmlstring":
					beginReq();
					dstr = typeof ts.p.datastr !== 'string' ? ts.p.datastr : $.parseXML(ts.p.datastr);
					addXmlData(dstr,ts.grid.bDiv);
					$(ts).triggerHandler("jqGridLoadComplete", [dstr]);
					if(lcf) {ts.p.loadComplete.call(ts,dstr);}
					$(ts).triggerHandler("jqGridAfterLoadComplete", [dstr]);
					ts.p.datatype = "local";
					ts.p.datastr = null;
					endReq();
				break;
				case "jsonstring":
					beginReq();
					if(typeof ts.p.datastr === 'string') { dstr = $.jgrid.parse(ts.p.datastr); }
					else { dstr = ts.p.datastr; }
					addJSONData(dstr,ts.grid.bDiv);
					$(ts).triggerHandler("jqGridLoadComplete", [dstr]);
					if(lcf) {ts.p.loadComplete.call(ts,dstr);}
					$(ts).triggerHandler("jqGridAfterLoadComplete", [dstr]);
					ts.p.datatype = "local";
					ts.p.datastr = null;
					endReq();
				break;
				case "local":
				case "clientside":
					beginReq();
					ts.p.datatype = "local";
					var req = addLocalData();
					addJSONData(req,ts.grid.bDiv,rcnt,npage>1,adjust);
					$(ts).triggerHandler("jqGridLoadComplete", [req]);
					if(lc) { lc.call(ts,req); }
					$(ts).triggerHandler("jqGridAfterLoadComplete", [req]);
					if (pvis) { ts.grid.populateVisible(); }
					endReq();
				break;
				}
			}
		},
		setHeadCheckBox = function ( checked ) {
			$('#cb_'+$.jgrid.jqID(ts.p.id),ts.grid.hDiv)[ts.p.useProp ? 'prop': 'attr']("checked", checked);
			var fid = ts.p.frozenColumns ? ts.p.id+"_frozen" : "";
			if(fid) {
				$('#cb_'+$.jgrid.jqID(ts.p.id),ts.grid.fhDiv)[ts.p.useProp ? 'prop': 'attr']("checked", checked);
			}
		},
		setPager = function (pgid, tp){
			// TBD - consider escaping pgid with pgid = $.jgrid.jqID(pgid);
			var sep = "<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",
			pginp = "",
			pgl="<table cellspacing='0' cellpadding='0' border='0' style='table-layout:auto;' class='ui-pg-table'><tbody><tr>",
			str="", pgcnt, lft, cent, rgt, twd, tdw, i,
			clearVals = function(onpaging){
				var ret;
				if ($.isFunction(ts.p.onPaging) ) { ret = ts.p.onPaging.call(ts,onpaging); }
				if(ret==='stop') {return false;}
				ts.p.selrow = null;
				if(ts.p.multiselect) {ts.p.selarrrow =[]; setHeadCheckBox( false );}
				ts.p.savedRow = [];
				return true;
			};
			pgid = pgid.substr(1);
			tp += "_" + pgid;
			pgcnt = "pg_"+pgid;
			lft = pgid+"_left"; cent = pgid+"_center"; rgt = pgid+"_right";
			$("#"+$.jgrid.jqID(pgid) )
			.append("<div id='"+pgcnt+"' class='ui-pager-control' role='group'><table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table' style='width:100%;table-layout:fixed;height:100%;' role='row'><tbody><tr><td id='"+lft+"' align='left'></td><td id='"+cent+"' align='center' style='white-space:pre;'></td><td id='"+rgt+"' align='right'></td></tr></tbody></table></div>")
			.attr("dir","ltr"); //explicit setting
			if(ts.p.rowList.length >0){
				str = "<td dir='"+dir+"'>";
				str +="<select class='ui-pg-selbox' role='listbox'>";
				for(i=0;i<ts.p.rowList.length;i++){
					str +="<option role=\"option\" value=\""+ts.p.rowList[i]+"\""+((ts.p.rowNum === ts.p.rowList[i])?" selected=\"selected\"":"")+">"+ts.p.rowList[i]+"</option>";
				}
				str +="</select></td>";
			}
			if(dir==="rtl") { pgl += str; }
			if(ts.p.pginput===true) { pginp= "<td dir='"+dir+"'>"+$.jgrid.format(ts.p.pgtext || "","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+$.jgrid.jqID(pgid)+"'></span>")+"</td>";}
			if(ts.p.pgbuttons===true) {
				var po=["first"+tp,"prev"+tp, "next"+tp,"last"+tp]; if(dir==="rtl") { po.reverse(); }
				pgl += "<td id='"+po[0]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-first'></span></td>";
				pgl += "<td id='"+po[1]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-prev'></span></td>";
				pgl += pginp !== "" ? sep+pginp+sep:"";
				pgl += "<td id='"+po[2]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-next'></span></td>";
				pgl += "<td id='"+po[3]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-end'></span></td>";
			} else if (pginp !== "") { pgl += pginp; }
			if(dir==="ltr") { pgl += str; }
			pgl += "</tr></tbody></table>";
			if(ts.p.viewrecords===true) {$("td#"+pgid+"_"+ts.p.recordpos,"#"+pgcnt).append("<div dir='"+dir+"' style='text-align:"+ts.p.recordpos+"' class='ui-paging-info'></div>");}
			$("td#"+pgid+"_"+ts.p.pagerpos,"#"+pgcnt).append(pgl);
			tdw = $(".ui-jqgrid").css("font-size") || "11px";
			$(document.body).append("<div id='testpg' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+tdw+";visibility:hidden;' ></div>");
			twd = $(pgl).clone().appendTo("#testpg").width();
			$("#testpg").remove();
			if(twd > 0) {
				if(pginp !== "") { twd += 50; } //should be param
				$("td#"+pgid+"_"+ts.p.pagerpos,"#"+pgcnt).width(twd);
			}
			ts.p._nvtd = [];
			ts.p._nvtd[0] = twd ? Math.floor((ts.p.width - twd)/2) : Math.floor(ts.p.width/3);
			ts.p._nvtd[1] = 0;
			pgl=null;
			$('.ui-pg-selbox',"#"+pgcnt).bind('change',function() {
				if(!clearVals('records')) { return false; }
				ts.p.page = Math.round(ts.p.rowNum*(ts.p.page-1)/this.value-0.5)+1;
				ts.p.rowNum = this.value;
				if(ts.p.pager) { $('.ui-pg-selbox',ts.p.pager).val(this.value); }
				if(ts.p.toppager) { $('.ui-pg-selbox',ts.p.toppager).val(this.value); }
				populate();
				return false;
			});
			if(ts.p.pgbuttons===true) {
			$(".ui-pg-button","#"+pgcnt).hover(function(){
				if($(this).hasClass('ui-state-disabled')) {
					this.style.cursor='default';
				} else {
					$(this).addClass('ui-state-hover');
					this.style.cursor='pointer';
				}
			},function() {
				if(!$(this).hasClass('ui-state-disabled')) {
					$(this).removeClass('ui-state-hover');
					this.style.cursor= "default";
				}
			});
			$("#first"+$.jgrid.jqID(tp)+", #prev"+$.jgrid.jqID(tp)+", #next"+$.jgrid.jqID(tp)+", #last"+$.jgrid.jqID(tp)).click( function() {
				if ($(this).hasClass("ui-state-disabled")) {
					return false;
				}
				var cp = intNum(ts.p.page,1),
				last = intNum(ts.p.lastpage,1), selclick = false,
				fp=true, pp=true, np=true,lp=true;
				if(last ===0 || last===1) {fp=false;pp=false;np=false;lp=false; }
				else if( last>1 && cp >=1) {
					if( cp === 1) { fp=false; pp=false; }
					//else if( cp>1 && cp <last){ }
					else if( cp===last){ np=false;lp=false; }
				} else if( last>1 && cp===0 ) { np=false;lp=false; cp=last-1;}
				if(!clearVals(this.id)) { return false; }
				if( this.id === 'first'+tp && fp ) { ts.p.page=1; selclick=true;}
				if( this.id === 'prev'+tp && pp) { ts.p.page=(cp-1); selclick=true;}
				if( this.id === 'next'+tp && np) { ts.p.page=(cp+1); selclick=true;}
				if( this.id === 'last'+tp && lp) { ts.p.page=last; selclick=true;}
				if(selclick) {
					populate();
				}
				return false;
			});
			}
			if(ts.p.pginput===true) {
			$('input.ui-pg-input',"#"+pgcnt).keypress( function(e) {
				var key = e.charCode || e.keyCode || 0;
				if(key === 13) {
					if(!clearVals('user')) { return false; }
					$(this).val( intNum( $(this).val(), 1));
					ts.p.page = ($(this).val()>0) ? $(this).val():ts.p.page;
					populate();
					return false;
				}
				return this;
			});
			}
		},
		multiSort = function(iCol, obj ) {
			var splas, sort="", cm = ts.p.colModel, fs=false, ls,
					selTh = ts.p.frozenColumns ?  obj : ts.grid.headers[iCol].el, so="";
			$("span.ui-grid-ico-sort",selTh).addClass('ui-state-disabled');
			$(selTh).attr("aria-selected","false");

			if(cm[iCol].lso) {
				if(cm[iCol].lso==="asc") {
					cm[iCol].lso += "-desc";
					so = "desc";
				} else if(cm[iCol].lso==="desc") {
					cm[iCol].lso += "-asc";
					so = "asc";
				} else if(cm[iCol].lso==="asc-desc" || cm[iCol].lso==="desc-asc") {
					cm[iCol].lso="";
				}
			} else {
				cm[iCol].lso = so = cm[iCol].firstsortorder || 'asc';
			}
			if( so ) {
				$("span.s-ico",selTh).show();
				$("span.ui-icon-"+so,selTh).removeClass('ui-state-disabled');
				$(selTh).attr("aria-selected","true");
			} else {
				if(!ts.p.viewsortcols[0]) {
					$("span.s-ico",selTh).hide();
				}
			}
			ts.p.sortorder = "";
			$.each(cm, function(i){
				if(this.lso) {
					if(i>0 && fs) {
						sort += ", ";
					}
					splas = this.lso.split("-");
					sort += cm[i].index || cm[i].name;
					sort += " "+splas[splas.length-1];
					fs = true;
					ts.p.sortorder = splas[splas.length-1];
				}
			});
			ls = sort.lastIndexOf(ts.p.sortorder);
			sort = sort.substring(0, ls);
			ts.p.sortname = sort;
		},
		sortData = function (index, idxcol,reload,sor, obj){
			if(!ts.p.colModel[idxcol].sortable) { return; }
			if(ts.p.savedRow.length > 0) {return;}
			if(!reload) {
				if( ts.p.lastsort === idxcol ) {
					if( ts.p.sortorder === 'asc') {
						ts.p.sortorder = 'desc';
					} else if(ts.p.sortorder === 'desc') { ts.p.sortorder = 'asc';}
				} else { ts.p.sortorder = ts.p.colModel[idxcol].firstsortorder || 'asc'; }
				ts.p.page = 1;
			}
			if(ts.p.multiSort) {
				multiSort( idxcol, obj);
			} else {
				if(sor) {
					if(ts.p.lastsort === idxcol && ts.p.sortorder === sor && !reload) { return; }
					ts.p.sortorder = sor;
				}
				var previousSelectedTh = ts.grid.headers[ts.p.lastsort].el, newSelectedTh = ts.p.frozenColumns ?  obj : ts.grid.headers[idxcol].el;

				$("span.ui-grid-ico-sort",previousSelectedTh).addClass('ui-state-disabled');
				$(previousSelectedTh).attr("aria-selected","false");
				if(ts.p.frozenColumns) {
					ts.grid.fhDiv.find("span.ui-grid-ico-sort").addClass('ui-state-disabled');
					ts.grid.fhDiv.find("th").attr("aria-selected","false");
				}
				$("span.ui-icon-"+ts.p.sortorder,newSelectedTh).removeClass('ui-state-disabled');
				$(newSelectedTh).attr("aria-selected","true");
				if(!ts.p.viewsortcols[0]) {
					if(ts.p.lastsort !== idxcol) {
						if(ts.p.frozenColumns){
							ts.grid.fhDiv.find("span.s-ico").hide();
						}
						$("span.s-ico",previousSelectedTh).hide();
						$("span.s-ico",newSelectedTh).show();
					}
				}
				index = index.substring(5 + ts.p.id.length + 1); // bad to be changed!?!
				ts.p.sortname = ts.p.colModel[idxcol].index || index;
			}
			if ($(ts).triggerHandler("jqGridSortCol", [ts.p.sortname, idxcol, ts.p.sortorder]) === 'stop') {
				ts.p.lastsort = idxcol;
				return;
			}
			if($.isFunction(ts.p.onSortCol)) {if (ts.p.onSortCol.call(ts, ts.p.sortname, idxcol, ts.p.sortorder)==='stop') {ts.p.lastsort = idxcol; return;}}
			if(ts.p.datatype === "local") {
				if(ts.p.deselectAfterSort) {$(ts).jqGrid("resetSelection");}
			} else {
				ts.p.selrow = null;
				if(ts.p.multiselect){setHeadCheckBox( false );}
				ts.p.selarrrow =[];
				ts.p.savedRow =[];
			}
			if(ts.p.scroll) {
				var sscroll = ts.grid.bDiv.scrollLeft;
				emptyRows.call(ts, true, false);
				ts.grid.hDiv.scrollLeft = sscroll;
			}
			if(ts.p.subGrid && ts.p.datatype === 'local') {
				$("td.sgexpanded","#"+$.jgrid.jqID(ts.p.id)).each(function(){
					$(this).trigger("click");
				});
			}
			populate();
			ts.p.lastsort = idxcol;
			if(ts.p.sortname !== index && idxcol) {ts.p.lastsort = idxcol;}
		},
		setColWidth = function () {
			var initwidth = 0, brd=$.jgrid.cell_width? 0: intNum(ts.p.cellLayout,0), vc=0, lvc, scw=intNum(ts.p.scrollOffset,0),cw,hs=false,aw,gw=0,cr;
			$.each(ts.p.colModel, function() {
				if(this.hidden === undefined) {this.hidden=false;}
				if(ts.p.grouping && ts.p.autowidth) {
					var ind = $.inArray(this.name, ts.p.groupingView.groupField);
					if(ind >= 0 && ts.p.groupingView.groupColumnShow.length > ind) {
						this.hidden = !ts.p.groupingView.groupColumnShow[ind];
					}
				}
				this.widthOrg = cw = intNum(this.width,0);
				if(this.hidden===false){
					initwidth += cw+brd;
					if(this.fixed) {
						gw += cw+brd;
					} else {
						vc++;
					}
				}
			});
			if(isNaN(ts.p.width)) {
				ts.p.width  = initwidth + ((ts.p.shrinkToFit ===false && !isNaN(ts.p.height)) ? scw : 0);
			}
			grid.width = ts.p.width;
			ts.p.tblwidth = initwidth;
			if(ts.p.shrinkToFit ===false && ts.p.forceFit === true) {ts.p.forceFit=false;}
			if(ts.p.shrinkToFit===true && vc > 0) {
				aw = grid.width-brd*vc-gw;
				if(!isNaN(ts.p.height)) {
					aw -= scw;
					hs = true;
				}
				initwidth =0;
				$.each(ts.p.colModel, function(i) {
					if(this.hidden === false && !this.fixed){
						cw = Math.round(aw*this.width/(ts.p.tblwidth-brd*vc-gw));
						this.width =cw;
						initwidth += cw;
						lvc = i;
					}
				});
				cr =0;
				if (hs) {
					if(grid.width-gw-(initwidth+brd*vc) !== scw){
						cr = grid.width-gw-(initwidth+brd*vc)-scw;
					}
				} else if(!hs && Math.abs(grid.width-gw-(initwidth+brd*vc)) !== 1) {
					cr = grid.width-gw-(initwidth+brd*vc);
				}
				ts.p.colModel[lvc].width += cr;
				ts.p.tblwidth = initwidth+cr+brd*vc+gw;
				if(ts.p.tblwidth > ts.p.width) {
					ts.p.colModel[lvc].width -= (ts.p.tblwidth - parseInt(ts.p.width,10));
					ts.p.tblwidth = ts.p.width;
				}
			}
		},
		nextVisible= function(iCol) {
			var ret = iCol, j=iCol, i;
			for (i = iCol+1;i<ts.p.colModel.length;i++){
				if(ts.p.colModel[i].hidden !== true ) {
					j=i; break;
				}
			}
			return j-ret;
		},
		getOffset = function (iCol) {
			var $th = $(ts.grid.headers[iCol].el), ret = [$th.position().left + $th.outerWidth()];
			if(ts.p.direction==="rtl") { ret[0] = ts.p.width - ret[0]; }
			ret[0] -= ts.grid.bDiv.scrollLeft;
			ret.push($(ts.grid.hDiv).position().top);
			ret.push($(ts.grid.bDiv).offset().top - $(ts.grid.hDiv).offset().top + $(ts.grid.bDiv).height());
			return ret;
		},
		getColumnHeaderIndex = function (th) {
			var i, headers = ts.grid.headers, ci = $.jgrid.getCellIndex(th);
			for (i = 0; i < headers.length; i++) {
				if (th === headers[i].el) {
					ci = i;
					break;
				}
			}
			return ci;
		};
		this.p.id = this.id;
		if ($.inArray(ts.p.multikey,sortkeys) === -1 ) {ts.p.multikey = false;}
		ts.p.keyIndex=false;
		ts.p.keyName=false;
		for (i=0; i<ts.p.colModel.length;i++) {
			ts.p.colModel[i] = $.extend(true, {}, ts.p.cmTemplate, ts.p.colModel[i].template || {}, ts.p.colModel[i]);
			if (ts.p.keyIndex === false && ts.p.colModel[i].key===true) {
				ts.p.keyIndex = i;
			}
		}
		ts.p.sortorder = ts.p.sortorder.toLowerCase();
		$.jgrid.cell_width = $.jgrid.cellWidth();
		if(ts.p.grouping===true) {
			ts.p.scroll = false;
			ts.p.rownumbers = false;
			//ts.p.subGrid = false; expiremental
			ts.p.treeGrid = false;
			ts.p.gridview = true;
		}
		if(this.p.treeGrid === true) {
			try { $(this).jqGrid("setTreeGrid");} catch (_) {}
			if(ts.p.datatype !== "local") { ts.p.localReader = {id: "_id_"};	}
		}
		if(this.p.subGrid) {
			try { $(ts).jqGrid("setSubGrid");} catch (s){}
		}
		if(this.p.multiselect) {
			this.p.colNames.unshift("<input role='checkbox' id='cb_"+this.p.id+"' class='cbox' type='checkbox'/>");
			this.p.colModel.unshift({name:'cb',width:$.jgrid.cell_width ? ts.p.multiselectWidth+ts.p.cellLayout : ts.p.multiselectWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:'center',fixed:true});
		}
		if(this.p.rownumbers) {
			this.p.colNames.unshift("");
			this.p.colModel.unshift({name:'rn',width:ts.p.rownumWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:'center',fixed:true});
		}
		ts.p.xmlReader = $.extend(true,{
			root: "rows",
			row: "row",
			page: "rows>page",
			total: "rows>total",
			records : "rows>records",
			repeatitems: true,
			cell: "cell",
			id: "[id]",
			userdata: "userdata",
			subgrid: {root:"rows", row: "row", repeatitems: true, cell:"cell"}
		}, ts.p.xmlReader);
		ts.p.jsonReader = $.extend(true,{
			root: "rows",
			page: "page",
			total: "total",
			records: "records",
			repeatitems: true,
			cell: "cell",
			id: "id",
			userdata: "userdata",
			subgrid: {root:"rows", repeatitems: true, cell:"cell"}
		},ts.p.jsonReader);
		ts.p.localReader = $.extend(true,{
			root: "rows",
			page: "page",
			total: "total",
			records: "records",
			repeatitems: false,
			cell: "cell",
			id: "id",
			userdata: "userdata",
			subgrid: {root:"rows", repeatitems: true, cell:"cell"}
		},ts.p.localReader);
		if(ts.p.scroll){
			ts.p.pgbuttons = false; ts.p.pginput=false; ts.p.rowList=[];
		}
		if(ts.p.data.length) { refreshIndex(); }
		var thead = "<thead><tr class='ui-jqgrid-labels' role='rowheader'>",
		tdc, idn, w, res, sort,
		td, ptr, tbody, imgs,iac="",idc="",sortarr=[], sortord=[], sotmp=[];
		if(ts.p.shrinkToFit===true && ts.p.forceFit===true) {
			for (i=ts.p.colModel.length-1;i>=0;i--){
				if(!ts.p.colModel[i].hidden) {
					ts.p.colModel[i].resizable=false;
					break;
				}
			}
		}
		if(ts.p.viewsortcols[1] === 'horizontal') {iac=" ui-i-asc";idc=" ui-i-desc";}
		tdc = isMSIE ?  "class='ui-th-div-ie'" :"";
		imgs = "<span class='s-ico' style='display:none'><span sort='asc' class='ui-grid-ico-sort ui-icon-asc"+iac+" ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-"+dir+"'></span>";
		imgs += "<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+idc+" ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-"+dir+"'></span></span>";
		if(ts.p.multiSort) {
			sortarr = ts.p.sortname.split(",");
			for (i=0; i<sortarr.length; i++) {
				sotmp = $.trim(sortarr[i]).split(" ");
				sortarr[i] = $.trim(sotmp[0]);
				sortord[i] = sotmp[1] ? $.trim(sotmp[1]) : ts.p.sortorder || "asc";
			}
		}
		for(i=0;i<this.p.colNames.length;i++){
			var tooltip = ts.p.headertitles ? (" title=\""+$.jgrid.stripHtml(ts.p.colNames[i])+"\"") :"";
			thead += "<th id='"+ts.p.id+"_"+ts.p.colModel[i].name+"' role='columnheader' class='ui-state-default ui-th-column ui-th-"+dir+"'"+ tooltip+">";
			idn = ts.p.colModel[i].index || ts.p.colModel[i].name;
			thead += "<div id='jqgh_"+ts.p.id+"_"+ts.p.colModel[i].name+"' "+tdc+">"+ts.p.colNames[i];
			if(!ts.p.colModel[i].width)  { ts.p.colModel[i].width = 150; }
			else { ts.p.colModel[i].width = parseInt(ts.p.colModel[i].width,10); }
			if(typeof ts.p.colModel[i].title !== "boolean") { ts.p.colModel[i].title = true; }
			ts.p.colModel[i].lso = "";
			if (idn === ts.p.sortname) {
				ts.p.lastsort = i;
			}
			if(ts.p.multiSort) {
				sotmp = $.inArray(idn,sortarr);
				if( sotmp !== -1 ) {
					ts.p.colModel[i].lso = sortord[sotmp];
				}
			}
			thead += imgs+"</div></th>";
		}
		thead += "</tr></thead>";
		imgs = null;
		$(this).append(thead);
		$("thead tr:first th",this).hover(function(){$(this).addClass('ui-state-hover');},function(){$(this).removeClass('ui-state-hover');});
		if(this.p.multiselect) {
			var emp=[], chk;
			$('#cb_'+$.jgrid.jqID(ts.p.id),this).bind('click',function(){
				ts.p.selarrrow = [];
				var froz = ts.p.frozenColumns === true ? ts.p.id + "_frozen" : "";
				if (this.checked) {
					$(ts.rows).each(function(i) {
						if (i>0) {
							if(!$(this).hasClass("ui-subgrid") && !$(this).hasClass("jqgroup") && !$(this).hasClass('ui-state-disabled')){
								$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(this.id) )[ts.p.useProp ? 'prop': 'attr']("checked",true);
								$(this).addClass("ui-state-highlight").attr("aria-selected","true");
								ts.p.selarrrow.push(this.id);
								ts.p.selrow = this.id;
								if(froz) {
									$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(this.id), ts.grid.fbDiv )[ts.p.useProp ? 'prop': 'attr']("checked",true);
									$("#"+$.jgrid.jqID(this.id), ts.grid.fbDiv).addClass("ui-state-highlight");
								}
							}
						}
					});
					chk=true;
					emp=[];
				}
				else {
					$(ts.rows).each(function(i) {
						if(i>0) {
							if(!$(this).hasClass("ui-subgrid") && !$(this).hasClass('ui-state-disabled')){
								$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(this.id) )[ts.p.useProp ? 'prop': 'attr']("checked", false);
								$(this).removeClass("ui-state-highlight").attr("aria-selected","false");
								emp.push(this.id);
								if(froz) {
									$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(this.id), ts.grid.fbDiv )[ts.p.useProp ? 'prop': 'attr']("checked",false);
									$("#"+$.jgrid.jqID(this.id), ts.grid.fbDiv).removeClass("ui-state-highlight");
								}
							}
						}
					});
					ts.p.selrow = null;
					chk=false;
				}
				$(ts).triggerHandler("jqGridSelectAll", [chk ? ts.p.selarrrow : emp, chk]);
				if($.isFunction(ts.p.onSelectAll)) {ts.p.onSelectAll.call(ts, chk ? ts.p.selarrrow : emp,chk);}
			});
		}

		if(ts.p.autowidth===true) {
			var pw = $(eg).innerWidth();
			ts.p.width = pw > 0?  pw: 'nw';
		}
		setColWidth();
		$(eg).css("width",grid.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+ts.p.id+"'>&#160;</div>");
		$(gv).css("width",grid.width+"px");
		thead = $("thead:first",ts).get(0);
		var	tfoot = "";
		if(ts.p.footerrow) { tfoot += "<table role='grid' style='width:"+ts.p.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow footrow-"+dir+"'>"; }
		var thr = $("tr:first",thead),
		firstr = "<tr class='jqgfirstrow' role='row' style='height:auto'>";
		ts.p.disableClick=false;
		$("th",thr).each(function ( j ) {
			w = ts.p.colModel[j].width;
			if(ts.p.colModel[j].resizable === undefined) {ts.p.colModel[j].resizable = true;}
			if(ts.p.colModel[j].resizable){
				res = document.createElement("span");
				$(res).html("&#160;").addClass('ui-jqgrid-resize ui-jqgrid-resize-'+dir)
				.css("cursor","col-resize");
				$(this).addClass(ts.p.resizeclass);
			} else {
				res = "";
			}
			$(this).css("width",w+"px").prepend(res);
			res = null;
			var hdcol = "";
			if( ts.p.colModel[j].hidden ) {
				$(this).css("display","none");
				hdcol = "display:none;";
			}
			firstr += "<td role='gridcell' style='height:0px;width:"+w+"px;"+hdcol+"'></td>";
			grid.headers[j] = { width: w, el: this };
			sort = ts.p.colModel[j].sortable;
			if( typeof sort !== 'boolean') {ts.p.colModel[j].sortable =  true; sort=true;}
			var nm = ts.p.colModel[j].name;
			if( !(nm === 'cb' || nm==='subgrid' || nm==='rn') ) {
				if(ts.p.viewsortcols[2]){
					$(">div",this).addClass('ui-jqgrid-sortable');
				}
			}
			if(sort) {
				if(ts.p.multiSort) {
					if(ts.p.viewsortcols[0]) {
						$("div span.s-ico",this).show();
						if(ts.p.colModel[j].lso){
							$("div span.ui-icon-"+ts.p.colModel[j].lso,this).removeClass("ui-state-disabled");
						}
					} else if( ts.p.colModel[j].lso) {
						$("div span.s-ico",this).show();
						$("div span.ui-icon-"+ts.p.colModel[j].lso,this).removeClass("ui-state-disabled");
					}
				} else {
					if(ts.p.viewsortcols[0]) {$("div span.s-ico",this).show(); if(j===ts.p.lastsort){ $("div span.ui-icon-"+ts.p.sortorder,this).removeClass("ui-state-disabled");}}
					else if( j === ts.p.lastsort) {$("div span.s-ico",this).show();$("div span.ui-icon-"+ts.p.sortorder,this).removeClass("ui-state-disabled");}
				}
			}
			if(ts.p.footerrow) { tfoot += "<td role='gridcell' "+formatCol(j,0,'', null, '', false)+">&#160;</td>"; }
		}).mousedown(function(e) {
			if ($(e.target).closest("th>span.ui-jqgrid-resize").length !== 1) { return; }
			var ci = getColumnHeaderIndex(this);
			if(ts.p.forceFit===true) {ts.p.nv= nextVisible(ci);}
			grid.dragStart(ci, e, getOffset(ci));
			return false;
		}).click(function(e) {
			if (ts.p.disableClick) {
				ts.p.disableClick = false;
				return false;
			}
			var s = "th>div.ui-jqgrid-sortable",r,d;
			if (!ts.p.viewsortcols[2]) { s = "th>div>span>span.ui-grid-ico-sort"; }
			var t = $(e.target).closest(s);
			if (t.length !== 1) { return; }
			var ci;
			if(ts.p.frozenColumns) {
				var tid =  $(this)[0].id.substring( ts.p.id.length + 1 );
				$(ts.p.colModel).each(function(i){
					if (this.name === tid) {
						ci = i;return false;
					}
				});
			} else {
				ci = getColumnHeaderIndex(this);
			}
			if (!ts.p.viewsortcols[2]) { r=true;d=t.attr("sort"); }
			if(ci != null){
				sortData( $('div',this)[0].id, ci, r, d, this);
			}
			return false;
		});
		if (ts.p.sortable && $.fn.sortable) {
			try {
				$(ts).jqGrid("sortableColumns", thr);
			} catch (e){}
		}
		if(ts.p.footerrow) { tfoot += "</tr></tbody></table>"; }
		firstr += "</tr>";
		tbody = document.createElement("tbody");
		this.appendChild(tbody);
		$(this).addClass('ui-jqgrid-btable').append(firstr);
		firstr = null;
		var hTable = $("<table class='ui-jqgrid-htable' style='width:"+ts.p.tblwidth+"px' role='grid' aria-labelledby='gbox_"+this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(thead),
		hg = (ts.p.caption && ts.p.hiddengrid===true) ? true : false,
		hb = $("<div class='ui-jqgrid-hbox" + (dir==="rtl" ? "-rtl" : "" )+"'></div>");
		thead = null;
		grid.hDiv = document.createElement("div");
		$(grid.hDiv)
			.css({ width: grid.width+"px"})
			.addClass("ui-state-default ui-jqgrid-hdiv")
			.append(hb);
		$(hb).append(hTable);
		hTable = null;
		if(hg) { $(grid.hDiv).hide(); }
		if(ts.p.pager){
			// TBD -- escape ts.p.pager here?
			if(typeof ts.p.pager === "string") {if(ts.p.pager.substr(0,1) !== "#") { ts.p.pager = "#"+ts.p.pager;} }
			else { ts.p.pager = "#"+ $(ts.p.pager).attr("id");}
			$(ts.p.pager).css({width: grid.width+"px"}).addClass('ui-state-default ui-jqgrid-pager ui-corner-bottom').appendTo(eg);
			if(hg) {$(ts.p.pager).hide();}
			setPager(ts.p.pager,'');
		}
		if( ts.p.cellEdit === false && ts.p.hoverrows === true) {
		$(ts).bind('mouseover',function(e) {
			ptr = $(e.target).closest("tr.jqgrow");
			if($(ptr).attr("class") !== "ui-subgrid") {
				$(ptr).addClass("ui-state-hover");
			}
		}).bind('mouseout',function(e) {
			ptr = $(e.target).closest("tr.jqgrow");
			$(ptr).removeClass("ui-state-hover");
		});
		}
		var ri,ci, tdHtml;
		$(ts).before(grid.hDiv).click(function(e) {
			td = e.target;
			ptr = $(td,ts.rows).closest("tr.jqgrow");
			if($(ptr).length === 0 || ptr[0].className.indexOf( 'ui-state-disabled' ) > -1 || ($(td,ts).closest("table.ui-jqgrid-btable").attr('id') || '').replace("_frozen","") !== ts.id ) {
				return this;
			}
			var scb = $(td).hasClass("cbox"),
			cSel = $(ts).triggerHandler("jqGridBeforeSelectRow", [ptr[0].id, e]);
			cSel = (cSel === false || cSel === 'stop') ? false : true;
			if(cSel && $.isFunction(ts.p.beforeSelectRow)) { cSel = ts.p.beforeSelectRow.call(ts,ptr[0].id, e); }
			if (td.tagName === 'A' || ((td.tagName === 'INPUT' || td.tagName === 'TEXTAREA' || td.tagName === 'OPTION' || td.tagName === 'SELECT' ) && !scb) ) { return; }
			if(cSel === true) {
				ri = ptr[0].id;
				ci = $.jgrid.getCellIndex(td);
				tdHtml = $(td).closest("td,th").html();
				$(ts).triggerHandler("jqGridCellSelect", [ri,ci,tdHtml,e]);
				if($.isFunction(ts.p.onCellSelect)) {
					ts.p.onCellSelect.call(ts,ri,ci,tdHtml,e);
				}
				if(ts.p.cellEdit === true) {
					if(ts.p.multiselect && scb){
						$(ts).jqGrid("setSelection", ri ,true,e);
					} else {
						ri = ptr[0].rowIndex;
						try {$(ts).jqGrid("editCell",ri,ci,true);} catch (_) {}
					}
				} else if ( !ts.p.multikey ) {
					if(ts.p.multiselect && ts.p.multiboxonly) {
						if(scb){$(ts).jqGrid("setSelection",ri,true,e);}
						else {
							var frz = ts.p.frozenColumns ? ts.p.id+"_frozen" : "";
							$(ts.p.selarrrow).each(function(i,n){
								var trid = $(ts).jqGrid('getGridRowById',n);
								$( trid ).removeClass("ui-state-highlight");
								$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(n))[ts.p.useProp ? 'prop': 'attr']("checked", false);
								if(frz) {
									$("#"+$.jgrid.jqID(n), "#"+$.jgrid.jqID(frz)).removeClass("ui-state-highlight");
									$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(n), "#"+$.jgrid.jqID(frz))[ts.p.useProp ? 'prop': 'attr']("checked", false);
								}
							});
							ts.p.selarrrow = [];
							$(ts).jqGrid("setSelection",ri,true,e);
						}
					} else {
						$(ts).jqGrid("setSelection",ri,true,e);
					}
				} else {
					if(e[ts.p.multikey]) {
						$(ts).jqGrid("setSelection",ri,true,e);
					} else if(ts.p.multiselect && scb) {
						scb = $("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+ri).is(":checked");
						$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+ri)[ts.p.useProp ? 'prop' : 'attr']("checked", scb);
					}
				}
			}
		}).bind('reloadGrid', function(e,opts) {
			if(ts.p.treeGrid ===true) {	ts.p.datatype = ts.p.treedatatype;}
			if (opts && opts.current) {
				ts.grid.selectionPreserver(ts);
			}
			if(ts.p.datatype==="local"){ $(ts).jqGrid("resetSelection");  if(ts.p.data.length) { refreshIndex();} }
			else if(!ts.p.treeGrid) {
				ts.p.selrow=null;
				if(ts.p.multiselect) {ts.p.selarrrow =[];setHeadCheckBox(false);}
				ts.p.savedRow = [];
			}
			if(ts.p.scroll) {emptyRows.call(ts, true, false);}
			if (opts && opts.page) {
				var page = opts.page;
				if (page > ts.p.lastpage) { page = ts.p.lastpage; }
				if (page < 1) { page = 1; }
				ts.p.page = page;
				if (ts.grid.prevRowHeight) {
					ts.grid.bDiv.scrollTop = (page - 1) * ts.grid.prevRowHeight * ts.p.rowNum;
				} else {
					ts.grid.bDiv.scrollTop = 0;
				}
			}
			if (ts.grid.prevRowHeight && ts.p.scroll) {
				delete ts.p.lastpage;
				ts.grid.populateVisible();
			} else {
				ts.grid.populate();
			}
			if(ts.p._inlinenav===true) {$(ts).jqGrid('showAddEditButtons');}
			return false;
		})
		.dblclick(function(e) {
			td = e.target;
			ptr = $(td,ts.rows).closest("tr.jqgrow");
			if($(ptr).length === 0 ){return;}
			ri = ptr[0].rowIndex;
			ci = $.jgrid.getCellIndex(td);
			$(ts).triggerHandler("jqGridDblClickRow", [$(ptr).attr("id"),ri,ci,e]);
			if ($.isFunction(ts.p.ondblClickRow)) { ts.p.ondblClickRow.call(ts,$(ptr).attr("id"),ri,ci, e); }
		})
		.bind('contextmenu', function(e) {
			td = e.target;
			ptr = $(td,ts.rows).closest("tr.jqgrow");
			if($(ptr).length === 0 ){return;}
			if(!ts.p.multiselect) {	$(ts).jqGrid("setSelection",ptr[0].id,true,e);	}
			ri = ptr[0].rowIndex;
			ci = $.jgrid.getCellIndex(td);
			$(ts).triggerHandler("jqGridRightClickRow", [$(ptr).attr("id"),ri,ci,e]);
			if ($.isFunction(ts.p.onRightClickRow)) { ts.p.onRightClickRow.call(ts,$(ptr).attr("id"),ri,ci, e); }
		});
		grid.bDiv = document.createElement("div");
		if(isMSIE) { if(String(ts.p.height).toLowerCase() === "auto") { ts.p.height = "100%"; } }
		$(grid.bDiv)
			.append($('<div style="position:relative;'+(isMSIE && $.jgrid.msiever() < 8 ? "height:0.01%;" : "")+'"></div>').append('<div></div>').append(this))
			.addClass("ui-jqgrid-bdiv")
			.css({ height: ts.p.height+(isNaN(ts.p.height)?"":"px"), width: (grid.width)+"px"})
			.scroll(grid.scrollGrid);
		$("table:first",grid.bDiv).css({width:ts.p.tblwidth+"px"});
		if( !$.support.tbody ) { //IE
			if( $("tbody",this).length === 2 ) { $("tbody:gt(0)",this).remove();}
		}
		if(ts.p.multikey){
			if( $.jgrid.msie) {
				$(grid.bDiv).bind("selectstart",function(){return false;});
			} else {
				$(grid.bDiv).bind("mousedown",function(){return false;});
			}
		}
		if(hg) {$(grid.bDiv).hide();}
		grid.cDiv = document.createElement("div");
		var arf = ts.p.hidegrid===true ? $("<a role='link' class='ui-jqgrid-titlebar-close ui-corner-all HeaderButton' />").hover(
			function(){ arf.addClass('ui-state-hover');},
			function() {arf.removeClass('ui-state-hover');})
		.append("<span class='ui-icon ui-icon-circle-triangle-n'></span>").css((dir==="rtl"?"left":"right"),"0px") : "";
		$(grid.cDiv).append(arf).append("<span class='ui-jqgrid-title'>"+ts.p.caption+"</span>")
		.addClass("ui-jqgrid-titlebar ui-jqgrid-caption"+(dir==="rtl" ? "-rtl" :"" )+" ui-widget-header ui-corner-top ui-helper-clearfix");
		$(grid.cDiv).insertBefore(grid.hDiv);
		if( ts.p.toolbar[0] ) {
			grid.uDiv = document.createElement("div");
			if(ts.p.toolbar[1] === "top") {$(grid.uDiv).insertBefore(grid.hDiv);}
			else if (ts.p.toolbar[1]==="bottom" ) {$(grid.uDiv).insertAfter(grid.hDiv);}
			if(ts.p.toolbar[1]==="both") {
				grid.ubDiv = document.createElement("div");
				$(grid.uDiv).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id).insertBefore(grid.hDiv);
				$(grid.ubDiv).addClass("ui-userdata ui-state-default").attr("id","tb_"+this.id).insertAfter(grid.hDiv);
				if(hg)  {$(grid.ubDiv).hide();}
			} else {
				$(grid.uDiv).width(grid.width).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id);
			}
			if(hg) {$(grid.uDiv).hide();}
		}
		if(ts.p.toppager) {
			ts.p.toppager = $.jgrid.jqID(ts.p.id)+"_toppager";
			grid.topDiv = $("<div id='"+ts.p.toppager+"'></div>")[0];
			ts.p.toppager = "#"+ts.p.toppager;
			$(grid.topDiv).addClass('ui-state-default ui-jqgrid-toppager').width(grid.width).insertBefore(grid.hDiv);
			setPager(ts.p.toppager,'_t');
		}
		if(ts.p.footerrow) {
			grid.sDiv = $("<div class='ui-jqgrid-sdiv'></div>")[0];
			hb = $("<div class='ui-jqgrid-hbox"+(dir==="rtl"?"-rtl":"")+"'></div>");
			$(grid.sDiv).append(hb).width(grid.width).insertAfter(grid.hDiv);
			$(hb).append(tfoot);
			grid.footers = $(".ui-jqgrid-ftable",grid.sDiv)[0].rows[0].cells;
			if(ts.p.rownumbers) { grid.footers[0].className = 'ui-state-default jqgrid-rownum'; }
			if(hg) {$(grid.sDiv).hide();}
		}
		hb = null;
		if(ts.p.caption) {
			var tdt = ts.p.datatype;
			if(ts.p.hidegrid===true) {
				$(".ui-jqgrid-titlebar-close",grid.cDiv).click( function(e){
					var onHdCl = $.isFunction(ts.p.onHeaderClick),
					elems = ".ui-jqgrid-bdiv, .ui-jqgrid-hdiv, .ui-jqgrid-pager, .ui-jqgrid-sdiv",
					counter, self = this;
					if(ts.p.toolbar[0]===true) {
						if( ts.p.toolbar[1]==='both') {
							elems += ', #' + $(grid.ubDiv).attr('id');
						}
						elems += ', #' + $(grid.uDiv).attr('id');
					}
					counter = $(elems,"#gview_"+$.jgrid.jqID(ts.p.id)).length;

					if(ts.p.gridstate === 'visible') {
						$(elems,"#gbox_"+$.jgrid.jqID(ts.p.id)).slideUp("fast", function() {
							counter--;
							if (counter === 0) {
								$("span",self).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");
								ts.p.gridstate = 'hidden';
								if($("#gbox_"+$.jgrid.jqID(ts.p.id)).hasClass("ui-resizable")) { $(".ui-resizable-handle","#gbox_"+$.jgrid.jqID(ts.p.id)).hide(); }
								$(ts).triggerHandler("jqGridHeaderClick", [ts.p.gridstate,e]);
								if(onHdCl) {if(!hg) {ts.p.onHeaderClick.call(ts,ts.p.gridstate,e);}}
							}
						});
					} else if(ts.p.gridstate === 'hidden'){
						$(elems,"#gbox_"+$.jgrid.jqID(ts.p.id)).slideDown("fast", function() {
							counter--;
							if (counter === 0) {
								$("span",self).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");
								if(hg) {ts.p.datatype = tdt;populate();hg=false;}
								ts.p.gridstate = 'visible';
								if($("#gbox_"+$.jgrid.jqID(ts.p.id)).hasClass("ui-resizable")) { $(".ui-resizable-handle","#gbox_"+$.jgrid.jqID(ts.p.id)).show(); }
								$(ts).triggerHandler("jqGridHeaderClick", [ts.p.gridstate,e]);
								if(onHdCl) {if(!hg) {ts.p.onHeaderClick.call(ts,ts.p.gridstate,e);}}
							}
						});
					}
					return false;
				});
				if(hg) {ts.p.datatype="local"; $(".ui-jqgrid-titlebar-close",grid.cDiv).trigger("click");}
			}
		} else {$(grid.cDiv).hide();}
		$(grid.hDiv).after(grid.bDiv)
		.mousemove(function (e) {
			if(grid.resizing){grid.dragMove(e);return false;}
		});
		$(".ui-jqgrid-labels",grid.hDiv).bind("selectstart", function () { return false; });
		$(document).bind( "mouseup.jqGrid" + ts.p.id, function () {
			if(grid.resizing) {	grid.dragEnd(); return false;}
			return true;
		});
		ts.formatCol = formatCol;
		ts.sortData = sortData;
		ts.updatepager = updatepager;
		ts.refreshIndex = refreshIndex;
		ts.setHeadCheckBox = setHeadCheckBox;
		ts.constructTr = constructTr;
		ts.formatter = function ( rowId, cellval , colpos, rwdat, act){return formatter(rowId, cellval , colpos, rwdat, act);};
		$.extend(grid,{populate : populate, emptyRows: emptyRows, beginReq: beginReq, endReq: endReq});
		this.grid = grid;
		ts.addXmlData = function(d) {addXmlData(d,ts.grid.bDiv);};
		ts.addJSONData = function(d) {addJSONData(d,ts.grid.bDiv);};
		this.grid.cols = this.rows[0].cells;
		$(ts).triggerHandler("jqGridInitGrid");
		if ($.isFunction( ts.p.onInitGrid )) { ts.p.onInitGrid.call(ts); }

		populate();ts.p.hiddengrid=false;
	});
};
$.jgrid.extend({
	getGridParam : function(pName) {
		var $t = this[0];
		if (!$t || !$t.grid) {return;}
		if (!pName) { return $t.p; }
		return $t.p[pName] !== undefined ? $t.p[pName] : null;
	},
	setGridParam : function (newParams){
		return this.each(function(){
			if (this.grid && typeof newParams === 'object') {$.extend(true,this.p,newParams);}
		});
	},
	getGridRowById: function ( rowid ) {
		var row;
		this.each( function(){
			try {
				//row = this.rows.namedItem( rowid );
				var i = this.rows.length;
				while(i--) {
					if( rowid.toString() === this.rows[i].id) {
						row = this.rows[i];
						break;
					}
				}
			} catch ( e ) {
				row = $(this.grid.bDiv).find( "#" + $.jgrid.jqID( rowid ));
			}
		});
		return row;
	},
	getDataIDs : function () {
		var ids=[], i=0, len, j=0;
		this.each(function(){
			len = this.rows.length;
			if(len && len>0){
				while(i<len) {
					if($(this.rows[i]).hasClass('jqgrow')) {
						ids[j] = this.rows[i].id;
						j++;
					}
					i++;
				}
			}
		});
		return ids;
	},
	setSelection : function(selection,onsr, e) {
		return this.each(function(){
			var $t = this, stat,pt, ner, ia, tpsr, fid;
			if(selection === undefined) { return; }
			onsr = onsr === false ? false : true;
			pt=$($t).jqGrid('getGridRowById', selection);
			if(!pt || !pt.className || pt.className.indexOf( 'ui-state-disabled' ) > -1 ) { return; }
			function scrGrid(iR){
				var ch = $($t.grid.bDiv)[0].clientHeight,
				st = $($t.grid.bDiv)[0].scrollTop,
				rpos = $($t.rows[iR]).position().top,
				rh = $t.rows[iR].clientHeight;
				if(rpos+rh >= ch+st) { $($t.grid.bDiv)[0].scrollTop = rpos-(ch+st)+rh+st; }
				else if(rpos < ch+st) {
					if(rpos < st) {
						$($t.grid.bDiv)[0].scrollTop = rpos;
					}
				}
			}
			if($t.p.scrollrows===true) {
				ner = $($t).jqGrid('getGridRowById',selection).rowIndex;
				if(ner >=0 ){
					scrGrid(ner);
				}
			}
			if($t.p.frozenColumns === true ) {
				fid = $t.p.id+"_frozen";
			}
			if(!$t.p.multiselect) {
				if(pt.className !== "ui-subgrid") {
					if( $t.p.selrow !== pt.id) {
						$( $($t).jqGrid('getGridRowById', $t.p.selrow) ).removeClass("ui-state-highlight").attr({"aria-selected":"false", "tabindex" : "-1"});
						$(pt).addClass("ui-state-highlight").attr({"aria-selected":"true", "tabindex" : "0"});//.focus();
						if(fid) {
							$("#"+$.jgrid.jqID($t.p.selrow), "#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight");
							$("#"+$.jgrid.jqID(selection), "#"+$.jgrid.jqID(fid)).addClass("ui-state-highlight");
						}
						stat = true;
					} else {
						stat = false;
					}
					$t.p.selrow = pt.id;
					if( onsr ) {
						$($t).triggerHandler("jqGridSelectRow", [pt.id, stat, e]);
						if( $t.p.onSelectRow) { $t.p.onSelectRow.call($t, pt.id, stat, e); }
					}
				}
			} else {
				//unselect selectall checkbox when deselecting a specific row
				$t.setHeadCheckBox( false );
				$t.p.selrow = pt.id;
				ia = $.inArray($t.p.selrow,$t.p.selarrrow);
				if (  ia === -1 ){
					if(pt.className !== "ui-subgrid") { $(pt).addClass("ui-state-highlight").attr("aria-selected","true");}
					stat = true;
					$t.p.selarrrow.push($t.p.selrow);
				} else {
					if(pt.className !== "ui-subgrid") { $(pt).removeClass("ui-state-highlight").attr("aria-selected","false");}
					stat = false;
					$t.p.selarrrow.splice(ia,1);
					tpsr = $t.p.selarrrow[0];
					$t.p.selrow = (tpsr === undefined) ? null : tpsr;
				}
				$("#jqg_"+$.jgrid.jqID($t.p.id)+"_"+$.jgrid.jqID(pt.id))[$t.p.useProp ? 'prop': 'attr']("checked",stat);
				if(fid) {
					if(ia === -1) {
						$("#"+$.jgrid.jqID(selection), "#"+$.jgrid.jqID(fid)).addClass("ui-state-highlight");
					} else {
						$("#"+$.jgrid.jqID(selection), "#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight");
					}
					$("#jqg_"+$.jgrid.jqID($t.p.id)+"_"+$.jgrid.jqID(selection), "#"+$.jgrid.jqID(fid))[$t.p.useProp ? 'prop': 'attr']("checked",stat);
				}
				if( onsr ) {
					$($t).triggerHandler("jqGridSelectRow", [pt.id, stat, e]);
					if( $t.p.onSelectRow) { $t.p.onSelectRow.call($t, pt.id , stat, e); }
				}
			}
		});
	},
	resetSelection : function( rowid ){
		return this.each(function(){
			var t = this, sr, fid;
			if( t.p.frozenColumns === true ) {
				fid = t.p.id+"_frozen";
			}
			if(rowid !== undefined ) {
				sr = rowid === t.p.selrow ? t.p.selrow : rowid;
				$("#"+$.jgrid.jqID(t.p.id)+" tbody:first tr#"+$.jgrid.jqID(sr)).removeClass("ui-state-highlight").attr("aria-selected","false");
				if (fid) { $("#"+$.jgrid.jqID(sr), "#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight"); }
				if(t.p.multiselect) {
					$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(sr), "#"+$.jgrid.jqID(t.p.id))[t.p.useProp ? 'prop': 'attr']("checked",false);
					if(fid) { $("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(sr), "#"+$.jgrid.jqID(fid))[t.p.useProp ? 'prop': 'attr']("checked",false); }
					t.setHeadCheckBox( false);
				}
				sr = null;
			} else if(!t.p.multiselect) {
				if(t.p.selrow) {
					$("#"+$.jgrid.jqID(t.p.id)+" tbody:first tr#"+$.jgrid.jqID(t.p.selrow)).removeClass("ui-state-highlight").attr("aria-selected","false");
					if(fid) { $("#"+$.jgrid.jqID(t.p.selrow), "#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight"); }
					t.p.selrow = null;
				}
			} else {
				$(t.p.selarrrow).each(function(i,n){
					$( $(t).jqGrid('getGridRowById',n) ).removeClass("ui-state-highlight").attr("aria-selected","false");
					$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(n))[t.p.useProp ? 'prop': 'attr']("checked",false);
					if(fid) {
						$("#"+$.jgrid.jqID(n), "#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight");
						$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(n), "#"+$.jgrid.jqID(fid))[t.p.useProp ? 'prop': 'attr']("checked",false);
					}
				});
				t.setHeadCheckBox( false );
				t.p.selarrrow = [];
				t.p.selrow = null;
			}
			if(t.p.cellEdit === true) {
				if(parseInt(t.p.iCol,10)>=0  && parseInt(t.p.iRow,10)>=0) {
					$("td:eq("+t.p.iCol+")",t.rows[t.p.iRow]).removeClass("edit-cell ui-state-highlight");
					$(t.rows[t.p.iRow]).removeClass("selected-row ui-state-hover");
				}
			}
			t.p.savedRow = [];
		});
	},
	getRowData : function( rowid ) {
		var res = {}, resall, getall=false, len, j=0;
		this.each(function(){
			var $t = this,nm,ind;
			if(rowid === undefined) {
				getall = true;
				resall = [];
				len = $t.rows.length;
			} else {
				ind = $($t).jqGrid('getGridRowById', rowid);
				if(!ind) { return res; }
				len = 2;
			}
			while(j<len){
				if(getall) { ind = $t.rows[j]; }
				if( $(ind).hasClass('jqgrow') ) {
					$('td[role="gridcell"]',ind).each( function(i) {
						nm = $t.p.colModel[i].name;
						if ( nm !== 'cb' && nm !== 'subgrid' && nm !== 'rn') {
							if($t.p.treeGrid===true && nm === $t.p.ExpandColumn) {
								res[nm] = $.jgrid.htmlDecode($("span:first",this).html());
							} else {
								try {
									res[nm] = $.unformat.call($t,this,{rowId:ind.id, colModel:$t.p.colModel[i]},i);
								} catch (e){
									res[nm] = $.jgrid.htmlDecode($(this).html());
								}
							}
						}
					});
					if(getall) { resall.push(res); res={}; }
				}
				j++;
			}
		});
		return resall || res;
	},
	delRowData : function(rowid) {
		var success = false, rowInd, ia;
		this.each(function() {
			var $t = this;
			rowInd = $($t).jqGrid('getGridRowById', rowid);
			if(!rowInd) {return false;}
				$(rowInd).remove();
				$t.p.records--;
				$t.p.reccount--;
				$t.updatepager(true,false);
				success=true;
				if($t.p.multiselect) {
					ia = $.inArray(rowid,$t.p.selarrrow);
					if(ia !== -1) { $t.p.selarrrow.splice(ia,1);}
				}
				if ($t.p.multiselect && $t.p.selarrrow.length > 0) {
					$t.p.selrow = $t.p.selarrrow[$t.p.selarrrow.length-1];
				} else {
					$t.p.selrow = null;
				}
			if($t.p.datatype === 'local') {
				var id = $.jgrid.stripPref($t.p.idPrefix, rowid),
				pos = $t.p._index[id];
				if(pos !== undefined) {
					$t.p.data.splice(pos,1);
					$t.refreshIndex();
				}
			}
			if( $t.p.altRows === true && success ) {
				var cn = $t.p.altclass;
				$($t.rows).each(function(i){
					if(i % 2 === 1) { $(this).addClass(cn); }
					else { $(this).removeClass(cn); }
				});
			}
		});
		return success;
	},
	setRowData : function(rowid, data, cssp) {
		var nm, success=true, title;
		this.each(function(){
			if(!this.grid) {return false;}
			var t = this, vl, ind, cp = typeof cssp, lcdata={};
			ind = $(this).jqGrid('getGridRowById', rowid);
			if(!ind) { return false; }
			if( data ) {
				try {
					$(this.p.colModel).each(function(i){
						nm = this.name;
						var dval =$.jgrid.getAccessor(data,nm);
						if( dval !== undefined) {
							lcdata[nm] = this.formatter && typeof this.formatter === 'string' && this.formatter === 'date' ? $.unformat.date.call(t,dval,this) : dval;
							vl = t.formatter( rowid, dval, i, data, 'edit');
							title = this.title ? {"title":$.jgrid.stripHtml(vl)} : {};
							if(t.p.treeGrid===true && nm === t.p.ExpandColumn) {
								$("td[role='gridcell']:eq("+i+") > span:first",ind).html(vl).attr(title);
							} else {
								$("td[role='gridcell']:eq("+i+")",ind).html(vl).attr(title);
							}
						}
					});
					if(t.p.datatype === 'local') {
						var id = $.jgrid.stripPref(t.p.idPrefix, rowid),
						pos = t.p._index[id], key;
						if(t.p.treeGrid) {
							for(key in t.p.treeReader){
								if(t.p.treeReader.hasOwnProperty(key)) {
									delete lcdata[t.p.treeReader[key]];
								}
							}
						}
						if(pos !== undefined) {
							t.p.data[pos] = $.extend(true, t.p.data[pos], lcdata);
						}
						lcdata = null;
					}
				} catch (e) {
					success = false;
				}
			}
			if(success) {
				if(cp === 'string') {$(ind).addClass(cssp);} else if(cssp !== null && cp === 'object') {$(ind).css(cssp);}
				$(t).triggerHandler("jqGridAfterGridComplete");
			}
		});
		return success;
	},
	addRowData : function(rowid,rdata,pos,src) {
		if(!pos) {pos = "last";}
		var success = false, nm, row, gi, si, ni,sind, i, v, prp="", aradd, cnm, cn, data, cm, id;
		if(rdata) {
			if($.isArray(rdata)) {
				aradd=true;
				pos = "last";
				cnm = rowid;
			} else {
				rdata = [rdata];
				aradd = false;
			}
			this.each(function() {
				var t = this, datalen = rdata.length;
				ni = t.p.rownumbers===true ? 1 :0;
				gi = t.p.multiselect ===true ? 1 :0;
				si = t.p.subGrid===true ? 1 :0;
				if(!aradd) {
					if(rowid !== undefined) { rowid = String(rowid);}
					else {
						rowid = $.jgrid.randId();
						if(t.p.keyIndex !== false) {
							cnm = t.p.colModel[t.p.keyIndex+gi+si+ni].name;
							if(rdata[0][cnm] !== undefined) { rowid = rdata[0][cnm]; }
						}
					}
				}
				cn = t.p.altclass;
				var k = 0, cna ="", lcdata = {},
				air = $.isFunction(t.p.afterInsertRow) ? true : false;
				while(k < datalen) {
					data = rdata[k];
					row=[];
					if(aradd) {
						try {
							rowid = data[cnm];
							if(rowid===undefined) {
								rowid = $.jgrid.randId();
							}
						}
						catch (e) {rowid = $.jgrid.randId();}
						cna = t.p.altRows === true ?  (t.rows.length-1)%2 === 0 ? cn : "" : "";
					}
					id = rowid;
					rowid  = t.p.idPrefix + rowid;
					if(ni){
						prp = t.formatCol(0,1,'',null,rowid, true);
						row[row.length] = "<td role=\"gridcell\" class=\"ui-state-default jqgrid-rownum\" "+prp+">0</td>";
					}
					if(gi) {
						v = "<input role=\"checkbox\" type=\"checkbox\""+" id=\"jqg_"+t.p.id+"_"+rowid+"\" class=\"cbox\"/>";
						prp = t.formatCol(ni,1,'', null, rowid, true);
						row[row.length] = "<td role=\"gridcell\" "+prp+">"+v+"</td>";
					}
					if(si) {
						row[row.length] = $(t).jqGrid("addSubGridCell",gi+ni,1);
					}
					for(i = gi+si+ni; i < t.p.colModel.length;i++){
						cm = t.p.colModel[i];
						nm = cm.name;
						lcdata[nm] = data[nm];
						v = t.formatter( rowid, $.jgrid.getAccessor(data,nm), i, data );
						prp = t.formatCol(i,1,v, data, rowid, lcdata);
						row[row.length] = "<td role=\"gridcell\" "+prp+">"+v+"</td>";
					}
					row.unshift( t.constructTr(rowid, false, cna, lcdata, data, false ) );
					row[row.length] = "</tr>";
					if(t.rows.length === 0){
						$("table:first",t.grid.bDiv).append(row.join(''));
					} else {
						switch (pos) {
							case 'last':
								$(t.rows[t.rows.length-1]).after(row.join(''));
								sind = t.rows.length-1;
								break;
							case 'first':
								$(t.rows[0]).after(row.join(''));
								sind = 1;
								break;
							case 'after':
								sind = $(t).jqGrid('getGridRowById', src);
								if (sind) {
									if($(t.rows[sind.rowIndex+1]).hasClass("ui-subgrid")) { $(t.rows[sind.rowIndex+1]).after(row); }
									else { $(sind).after(row.join('')); }
									sind=sind.rowIndex + 1;
								}
								break;
							case 'before':
								sind = $(t).jqGrid('getGridRowById', src);
								if(sind) {
									$(sind).before(row.join(''));
									sind=sind.rowIndex - 1;
								}
								break;
						}
					}
					if(t.p.subGrid===true) {
						$(t).jqGrid("addSubGrid",gi+ni, sind);
					}
					t.p.records++;
					t.p.reccount++;
					$(t).triggerHandler("jqGridAfterInsertRow", [rowid,data,data]);
					if(air) { t.p.afterInsertRow.call(t,rowid,data,data); }
					k++;
					if(t.p.datatype === 'local') {
						lcdata[t.p.localReader.id] = id;
						t.p._index[id] = t.p.data.length;
						t.p.data.push(lcdata);
						lcdata = {};
					}
				}
				if( t.p.altRows === true && !aradd) {
					if (pos === "last") {
						if ((t.rows.length-1)%2 === 1)  {$(t.rows[t.rows.length-1]).addClass(cn);}
					} else {
						$(t.rows).each(function(i){
							if(i % 2 ===1) { $(this).addClass(cn); }
							else { $(this).removeClass(cn); }
						});
					}
				}
				t.updatepager(true,true);
				success = true;
			});
		}
		return success;
	},
	footerData : function(action,data, format) {
		var nm, success=false, res={}, title;
		function isEmpty(obj) {
			var i;
			for(i in obj) {
				if (obj.hasOwnProperty(i)) { return false; }
			}
			return true;
		}
		if(action == undefined) { action = "get"; }
		if(typeof format !== "boolean") { format  = true; }
		action = action.toLowerCase();
		this.each(function(){
			var t = this, vl;
			if(!t.grid || !t.p.footerrow) {return false;}
			if(action === "set") { if(isEmpty(data)) { return false; } }
			success=true;
			$(this.p.colModel).each(function(i){
				nm = this.name;
				if(action === "set") {
					if( data[nm] !== undefined) {
						vl = format ? t.formatter( "", data[nm], i, data, 'edit') : data[nm];
						title = this.title ? {"title":$.jgrid.stripHtml(vl)} : {};
						$("tr.footrow td:eq("+i+")",t.grid.sDiv).html(vl).attr(title);
						success = true;
					}
				} else if(action === "get") {
					res[nm] = $("tr.footrow td:eq("+i+")",t.grid.sDiv).html();
				}
			});
		});
		return action === "get" ? res : success;
	},
	showHideCol : function(colname,show) {
		return this.each(function() {
			var $t = this, fndh=false, brd=$.jgrid.cell_width ? 0: $t.p.cellLayout, cw;
			if (!$t.grid ) {return;}
			if( typeof colname === 'string') {colname=[colname];}
			show = show !== "none" ? "" : "none";
			var sw = show === "" ? true :false,
			gh = $t.p.groupHeader && (typeof $t.p.groupHeader === 'object' || $.isFunction($t.p.groupHeader) );
			if(gh) { $($t).jqGrid('destroyGroupHeader', false); }
			$(this.p.colModel).each(function(i) {
				if ($.inArray(this.name,colname) !== -1 && this.hidden === sw) {
					if($t.p.frozenColumns === true && this.frozen === true) {
						return true;
					}
					$("tr[role=rowheader]",$t.grid.hDiv).each(function(){
						$(this.cells[i]).css("display", show);
					});
					$($t.rows).each(function(){
						if (!$(this).hasClass("jqgroup")) {
							$(this.cells[i]).css("display", show);
						}
					});
					if($t.p.footerrow) { $("tr.footrow td:eq("+i+")", $t.grid.sDiv).css("display", show); }
					cw =  parseInt(this.width,10);
					if(show === "none") {
						$t.p.tblwidth -= cw+brd;
					} else {
						$t.p.tblwidth += cw+brd;
					}
					this.hidden = !sw;
					fndh=true;
					$($t).triggerHandler("jqGridShowHideCol", [sw,this.name,i]);
				}
			});
			if(fndh===true) {
				if($t.p.shrinkToFit === true && !isNaN($t.p.height)) { $t.p.tblwidth += parseInt($t.p.scrollOffset,10);}
				$($t).jqGrid("setGridWidth",$t.p.shrinkToFit === true ? $t.p.tblwidth : $t.p.width );
			}
			if( gh )  {
				$($t).jqGrid('setGroupHeaders',$t.p.groupHeader);
			}
		});
	},
	hideCol : function (colname) {
		return this.each(function(){$(this).jqGrid("showHideCol",colname,"none");});
	},
	showCol : function(colname) {
		return this.each(function(){$(this).jqGrid("showHideCol",colname,"");});
	},
	remapColumns : function(permutation, updateCells, keepHeader)
	{
		function resortArray(a) {
			var ac;
			if (a.length) {
				ac = $.makeArray(a);
			} else {
				ac = $.extend({}, a);
			}
			$.each(permutation, function(i) {
				a[i] = ac[this];
			});
		}
		var ts = this.get(0);
		function resortRows(parent, clobj) {
			$(">tr"+(clobj||""), parent).each(function() {
				var row = this;
				var elems = $.makeArray(row.cells);
				$.each(permutation, function() {
					var e = elems[this];
					if (e) {
						row.appendChild(e);
					}
				});
			});
		}
		resortArray(ts.p.colModel);
		resortArray(ts.p.colNames);
		resortArray(ts.grid.headers);
		resortRows($("thead:first", ts.grid.hDiv), keepHeader && ":not(.ui-jqgrid-labels)");
		if (updateCells) {
			resortRows($("#"+$.jgrid.jqID(ts.p.id)+" tbody:first"), ".jqgfirstrow, tr.jqgrow, tr.jqfoot");
		}
		if (ts.p.footerrow) {
			resortRows($("tbody:first", ts.grid.sDiv));
		}
		if (ts.p.remapColumns) {
			if (!ts.p.remapColumns.length){
				ts.p.remapColumns = $.makeArray(permutation);
			} else {
				resortArray(ts.p.remapColumns);
			}
		}
		ts.p.lastsort = $.inArray(ts.p.lastsort, permutation);
		if(ts.p.treeGrid) { ts.p.expColInd = $.inArray(ts.p.expColInd, permutation); }
		$(ts).triggerHandler("jqGridRemapColumns", [permutation, updateCells, keepHeader]);
	},
	setGridWidth : function(nwidth, shrink) {
		return this.each(function(){
			if (!this.grid ) {return;}
			var $t = this, cw,
			initwidth = 0, brd=$.jgrid.cell_width ? 0: $t.p.cellLayout, lvc, vc=0, hs=false, scw=$t.p.scrollOffset, aw, gw=0, cr;
			if(typeof shrink !== 'boolean') {
				shrink=$t.p.shrinkToFit;
			}
			if(isNaN(nwidth)) {return;}
			nwidth = parseInt(nwidth,10);
			$t.grid.width = $t.p.width = nwidth;
			$("#gbox_"+$.jgrid.jqID($t.p.id)).css("width",nwidth+"px");
			$("#gview_"+$.jgrid.jqID($t.p.id)).css("width",nwidth+"px");
			$($t.grid.bDiv).css("width",nwidth+"px");
			$($t.grid.hDiv).css("width",nwidth+"px");
			if($t.p.pager ) {$($t.p.pager).css("width",nwidth+"px");}
			if($t.p.toppager ) {$($t.p.toppager).css("width",nwidth+"px");}
			if($t.p.toolbar[0] === true){
				$($t.grid.uDiv).css("width",nwidth+"px");
				if($t.p.toolbar[1]==="both") {$($t.grid.ubDiv).css("width",nwidth+"px");}
			}
			if($t.p.footerrow) { $($t.grid.sDiv).css("width",nwidth+"px"); }
			if(shrink ===false && $t.p.forceFit === true) {$t.p.forceFit=false;}
			if(shrink===true) {
				$.each($t.p.colModel, function() {
					if(this.hidden===false){
						cw = this.widthOrg;
						initwidth += cw+brd;
						if(this.fixed) {
							gw += cw+brd;
						} else {
							vc++;
						}
					}
				});
				if(vc  === 0) { return; }
				$t.p.tblwidth = initwidth;
				aw = nwidth-brd*vc-gw;
				if(!isNaN($t.p.height)) {
					if($($t.grid.bDiv)[0].clientHeight < $($t.grid.bDiv)[0].scrollHeight || $t.rows.length === 1){
						hs = true;
						aw -= scw;
					}
				}
				initwidth =0;
				var cle = $t.grid.cols.length >0;
				$.each($t.p.colModel, function(i) {
					if(this.hidden === false && !this.fixed){
						cw = this.widthOrg;
						cw = Math.round(aw*cw/($t.p.tblwidth-brd*vc-gw));
						if (cw < 0) { return; }
						this.width =cw;
						initwidth += cw;
						$t.grid.headers[i].width=cw;
						$t.grid.headers[i].el.style.width=cw+"px";
						if($t.p.footerrow) { $t.grid.footers[i].style.width = cw+"px"; }
						if(cle) { $t.grid.cols[i].style.width = cw+"px"; }
						lvc = i;
					}
				});

				if (!lvc) { return; }

				cr =0;
				if (hs) {
					if(nwidth-gw-(initwidth+brd*vc) !== scw){
						cr = nwidth-gw-(initwidth+brd*vc)-scw;
					}
				} else if( Math.abs(nwidth-gw-(initwidth+brd*vc)) !== 1) {
					cr = nwidth-gw-(initwidth+brd*vc);
				}
				$t.p.colModel[lvc].width += cr;
				$t.p.tblwidth = initwidth+cr+brd*vc+gw;
				if($t.p.tblwidth > nwidth) {
					var delta = $t.p.tblwidth - parseInt(nwidth,10);
					$t.p.tblwidth = nwidth;
					cw = $t.p.colModel[lvc].width = $t.p.colModel[lvc].width-delta;
				} else {
					cw= $t.p.colModel[lvc].width;
				}
				$t.grid.headers[lvc].width = cw;
				$t.grid.headers[lvc].el.style.width=cw+"px";
				if(cle) { $t.grid.cols[lvc].style.width = cw+"px"; }
				if($t.p.footerrow) {
					$t.grid.footers[lvc].style.width = cw+"px";
				}
			}
			if($t.p.tblwidth) {
				$('table:first',$t.grid.bDiv).css("width",$t.p.tblwidth+"px");
				$('table:first',$t.grid.hDiv).css("width",$t.p.tblwidth+"px");
				$t.grid.hDiv.scrollLeft = $t.grid.bDiv.scrollLeft;
				if($t.p.footerrow) {
					$('table:first',$t.grid.sDiv).css("width",$t.p.tblwidth+"px");
				}
			}
		});
	},
	setGridHeight : function (nh) {
		return this.each(function (){
			var $t = this;
			if(!$t.grid) {return;}
			var bDiv = $($t.grid.bDiv);
			bDiv.css({height: nh+(isNaN(nh)?"":"px")});
			if($t.p.frozenColumns === true){
				//follow the original set height to use 16, better scrollbar width detection
				$('#'+$.jgrid.jqID($t.p.id)+"_frozen").parent().height(bDiv.height() - 16);
			}
			$t.p.height = nh;
			if ($t.p.scroll) { $t.grid.populateVisible(); }
		});
	},
	setCaption : function (newcap){
		return this.each(function(){
			this.p.caption=newcap;
			$("span.ui-jqgrid-title, span.ui-jqgrid-title-rtl",this.grid.cDiv).html(newcap);
			$(this.grid.cDiv).show();
		});
	},
	setLabel : function(colname, nData, prop, attrp ){
		return this.each(function(){
			var $t = this, pos=-1;
			if(!$t.grid) {return;}
			if(colname !== undefined) {
				$($t.p.colModel).each(function(i){
					if (this.name === colname) {
						pos = i;return false;
					}
				});
			} else { return; }
			if(pos>=0) {
				var thecol = $("tr.ui-jqgrid-labels th:eq("+pos+")",$t.grid.hDiv);
				if (nData){
					var ico = $(".s-ico",thecol);
					$("[id^=jqgh_]",thecol).empty().html(nData).append(ico);
					$t.p.colNames[pos] = nData;
				}
				if (prop) {
					if(typeof prop === 'string') {$(thecol).addClass(prop);} else {$(thecol).css(prop);}
				}
				if(typeof attrp === 'object') {$(thecol).attr(attrp);}
			}
		});
	},
	setCell : function(rowid,colname,nData,cssp,attrp, forceupd) {
		return this.each(function(){
			var $t = this, pos =-1,v, title;
			if(!$t.grid) {return;}
			if(isNaN(colname)) {
				$($t.p.colModel).each(function(i){
					if (this.name === colname) {
						pos = i;return false;
					}
				});
			} else {pos = parseInt(colname,10);}
			if(pos>=0) {
				var ind = $($t).jqGrid('getGridRowById', rowid);
				if (ind){
					var tcell = $("td:eq("+pos+")",ind);
					if(nData !== "" || forceupd === true) {
						v = $t.formatter(rowid, nData, pos,ind,'edit');
						title = $t.p.colModel[pos].title ? {"title":$.jgrid.stripHtml(v)} : {};
						if($t.p.treeGrid && $(".tree-wrap",$(tcell)).length>0) {
							$("span",$(tcell)).html(v).attr(title);
						} else {
							$(tcell).html(v).attr(title);
						}
						if($t.p.datatype === "local") {
							var cm = $t.p.colModel[pos], index;
							nData = cm.formatter && typeof cm.formatter === 'string' && cm.formatter === 'date' ? $.unformat.date.call($t,nData,cm) : nData;
							index = $t.p._index[$.jgrid.stripPref($t.p.idPrefix, rowid)];
							if(index !== undefined) {
								$t.p.data[index][cm.name] = nData;
							}
						}
					}
					if(typeof cssp === 'string'){
						$(tcell).addClass(cssp);
					} else if(cssp) {
						$(tcell).css(cssp);
					}
					if(typeof attrp === 'object') {$(tcell).attr(attrp);}
				}
			}
		});
	},
	getCell : function(rowid,col) {
		var ret = false;
		this.each(function(){
			var $t=this, pos=-1;
			if(!$t.grid) {return;}
			if(isNaN(col)) {
				$($t.p.colModel).each(function(i){
					if (this.name === col) {
						pos = i;return false;
					}
				});
			} else {pos = parseInt(col,10);}
			if(pos>=0) {
				var ind = $($t).jqGrid('getGridRowById', rowid);
				if(ind) {
					try {
						ret = $.unformat.call($t,$("td:eq("+pos+")",ind),{rowId:ind.id, colModel:$t.p.colModel[pos]},pos);
					} catch (e){
						ret = $.jgrid.htmlDecode($("td:eq("+pos+")",ind).html());
					}
				}
			}
		});
		return ret;
	},
	getCol : function (col, obj, mathopr) {
		var ret = [], val, sum=0, min, max, v;
		obj = typeof obj !== 'boolean' ? false : obj;
		if(mathopr === undefined) { mathopr = false; }
		this.each(function(){
			var $t=this, pos=-1;
			if(!$t.grid) {return;}
			if(isNaN(col)) {
				$($t.p.colModel).each(function(i){
					if (this.name === col) {
						pos = i;return false;
					}
				});
			} else {pos = parseInt(col,10);}
			if(pos>=0) {
				var ln = $t.rows.length, i =0, dlen=0;
				if (ln && ln>0){
					while(i<ln){
						if($($t.rows[i]).hasClass('jqgrow')) {
							try {
								val = $.unformat.call($t,$($t.rows[i].cells[pos]),{rowId:$t.rows[i].id, colModel:$t.p.colModel[pos]},pos);
							} catch (e) {
								val = $.jgrid.htmlDecode($t.rows[i].cells[pos].innerHTML);
							}
							if(mathopr) {
								v = parseFloat(val);
								if(!isNaN(v)) {
									sum += v;
									if (max === undefined) {max = min = v;}
									min = Math.min(min, v);
									max = Math.max(max, v);
									dlen++;
								}
							}
							else if(obj) { ret.push( {id:$t.rows[i].id,value:val} ); }
							else { ret.push( val ); }
						}
						i++;
					}
					if(mathopr) {
						switch(mathopr.toLowerCase()){
							case 'sum': ret =sum; break;
							case 'avg': ret = sum/dlen; break;
							case 'count': ret = (ln-1); break;
							case 'min': ret = min; break;
							case 'max': ret = max; break;
						}
					}
				}
			}
		});
		return ret;
	},
	clearGridData : function(clearfooter) {
		return this.each(function(){
			var $t = this;
			if(!$t.grid) {return;}
			if(typeof clearfooter !== 'boolean') { clearfooter = false; }
			if($t.p.deepempty) {$("#"+$.jgrid.jqID($t.p.id)+" tbody:first tr:gt(0)").remove();}
			else {
				var trf = $("#"+$.jgrid.jqID($t.p.id)+" tbody:first tr:first")[0];
				$("#"+$.jgrid.jqID($t.p.id)+" tbody:first").empty().append(trf);
			}
			if($t.p.footerrow && clearfooter) { $(".ui-jqgrid-ftable td",$t.grid.sDiv).html("&#160;"); }
			$t.p.selrow = null; $t.p.selarrrow= []; $t.p.savedRow = [];
			$t.p.records = 0;$t.p.page=1;$t.p.lastpage=0;$t.p.reccount=0;
			$t.p.data = []; $t.p._index = {};
			$t.updatepager(true,false);
		});
	},
	getInd : function(rowid,rc){
		var ret =false,rw;
		this.each(function(){
			rw = $(this).jqGrid('getGridRowById', rowid);
			if(rw) {
				ret = rc===true ? rw: rw.rowIndex;
			}
		});
		return ret;
	},
	bindKeys : function( settings ){
		var o = $.extend({
			onEnter: null,
			onSpace: null,
			onLeftKey: null,
			onRightKey: null,
			scrollingRows : true
		},settings || {});
		return this.each(function(){
			var $t = this;
			if( !$('body').is('[role]') ){$('body').attr('role','application');}
			$t.p.scrollrows = o.scrollingRows;
			$($t).keydown(function(event){
				var target = $($t).find('tr[tabindex=0]')[0], id, r, mind,
				expanded = $t.p.treeReader.expanded_field;
				//check for arrow keys
				if(target) {
					mind = $t.p._index[$.jgrid.stripPref($t.p.idPrefix, target.id)];
					if(event.keyCode === 37 || event.keyCode === 38 || event.keyCode === 39 || event.keyCode === 40){
						// up key
						if(event.keyCode === 38 ){
							r = target.previousSibling;
							id = "";
							if(r) {
								if($(r).is(":hidden")) {
									while(r) {
										r = r.previousSibling;
										if(!$(r).is(":hidden") && $(r).hasClass('jqgrow')) {id = r.id;break;}
									}
								} else {
									id = r.id;
								}
							}
							$($t).jqGrid('setSelection', id, true, event);
							event.preventDefault();
						}
						//if key is down arrow
						if(event.keyCode === 40){
							r = target.nextSibling;
							id ="";
							if(r) {
								if($(r).is(":hidden")) {
									while(r) {
										r = r.nextSibling;
										if(!$(r).is(":hidden") && $(r).hasClass('jqgrow') ) {id = r.id;break;}
									}
								} else {
									id = r.id;
								}
							}
							$($t).jqGrid('setSelection', id, true, event);
							event.preventDefault();
						}
						// left
						if(event.keyCode === 37 ){
							if($t.p.treeGrid && $t.p.data[mind][expanded]) {
								$(target).find("div.treeclick").trigger('click');
							}
							$($t).triggerHandler("jqGridKeyLeft", [$t.p.selrow]);
							if($.isFunction(o.onLeftKey)) {
								o.onLeftKey.call($t, $t.p.selrow);
							}
						}
						// right
						if(event.keyCode === 39 ){
							if($t.p.treeGrid && !$t.p.data[mind][expanded]) {
								$(target).find("div.treeclick").trigger('click');
							}
							$($t).triggerHandler("jqGridKeyRight", [$t.p.selrow]);
							if($.isFunction(o.onRightKey)) {
								o.onRightKey.call($t, $t.p.selrow);
							}
						}
					}
					//check if enter was pressed on a grid or treegrid node
					else if( event.keyCode === 13 ){
						$($t).triggerHandler("jqGridKeyEnter", [$t.p.selrow]);
						if($.isFunction(o.onEnter)) {
							o.onEnter.call($t, $t.p.selrow);
						}
					} else if(event.keyCode === 32) {
						$($t).triggerHandler("jqGridKeySpace", [$t.p.selrow]);
						if($.isFunction(o.onSpace)) {
							o.onSpace.call($t, $t.p.selrow);
						}
					}
				}
			});
		});
	},
	unbindKeys : function(){
		return this.each(function(){
			$(this).unbind('keydown');
		});
	},
	getLocalRow : function (rowid) {
		var ret = false, ind;
		this.each(function(){
			if(rowid !== undefined) {
				ind = this.p._index[$.jgrid.stripPref(this.p.idPrefix, rowid)];
				if(ind >= 0 ) {
					ret = this.p.data[ind];
				}
			}
		});
		return ret;
	}
});
})(jQuery);
/*jshint eqeqeq:false */
/*global jQuery */
(function($){
/**
 * jqGrid extension for custom methods
 * Tony Tomov tony@trirand.com
 * http://trirand.com/blog/
 *
 * Wildraid wildraid@mail.ru
 * Oleg Kiriljuk oleg.kiriljuk@ok-soft-gmbh.com
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
**/
"use strict";
$.jgrid.extend({
	getColProp : function(colname){
		var ret ={}, $t = this[0];
		if ( !$t.grid ) { return false; }
		var cM = $t.p.colModel, i;
		for ( i=0;i<cM.length;i++ ) {
			if ( cM[i].name === colname ) {
				ret = cM[i];
				break;
			}
		}
		return ret;
	},
	setColProp : function(colname, obj){
		//do not set width will not work
		return this.each(function(){
			if ( this.grid ) {
				if ( obj ) {
					var cM = this.p.colModel, i;
					for ( i=0;i<cM.length;i++ ) {
						if ( cM[i].name === colname ) {
							$.extend(true, this.p.colModel[i],obj);
							break;
						}
					}
				}
			}
		});
	},
	sortGrid : function(colname,reload, sor){
		return this.each(function(){
			var $t=this,idx=-1,i, sobj=false;
			if ( !$t.grid ) { return;}
			if ( !colname ) { colname = $t.p.sortname; }
			for ( i=0;i<$t.p.colModel.length;i++ ) {
				if ( $t.p.colModel[i].index === colname || $t.p.colModel[i].name === colname ) {
					idx = i;
					if($t.p.frozenColumns === true && $t.p.colModel[i].frozen === true) {
						sobj = $t.grid.fhDiv.find("#" + $t.p.id + "_" + colname);
					}
					break;
				}
			}
			if ( idx !== -1 ){
				var sort = $t.p.colModel[idx].sortable;
				if(!sobj) {
					sobj = $t.grid.headers[idx].el;
				}
				if ( typeof sort !== 'boolean' ) { sort =  true; }
				if ( typeof reload !=='boolean' ) { reload = false; }
				if ( sort ) { $t.sortData("jqgh_"+$t.p.id+"_" + colname, idx, reload, sor, sobj); }
			}
		});
	},
	clearBeforeUnload : function () {
		return this.each(function(){
			var grid = this.grid;
			if ($.isFunction(grid.emptyRows)) {
				grid.emptyRows.call(this, true, true); // this work quick enough and reduce the size of memory leaks if we have someone
			}

			$(document).unbind("mouseup.jqGrid" + this.p.id );
			$(grid.hDiv).unbind("mousemove"); // TODO add namespace
			$(this).unbind();

			grid.dragEnd = null;
			grid.dragMove = null;
			grid.dragStart = null;
			grid.emptyRows = null;
			grid.populate = null;
			grid.populateVisible = null;
			grid.scrollGrid = null;
			grid.selectionPreserver = null;

			grid.bDiv = null;
			grid.cDiv = null;
			grid.hDiv = null;
			grid.cols = null;
			var i, l = grid.headers.length;
			for (i = 0; i < l; i++) {
				grid.headers[i].el = null;
			}

			this.formatCol = null;
			this.sortData = null;
			this.updatepager = null;
			this.refreshIndex = null;
			this.setHeadCheckBox = null;
			this.constructTr = null;
			this.formatter = null;
			this.addXmlData = null;
			this.addJSONData = null;
			this.grid = null;
		});
	},
	GridDestroy : function () {
		return this.each(function(){
			if ( this.grid ) {
				if ( this.p.pager ) { // if not part of grid
					$(this.p.pager).remove();
				}
				try {
					$(this).jqGrid('clearBeforeUnload');
					$("#gbox_"+$.jgrid.jqID(this.id)).remove();
				} catch (_) {}
			}
		});
	},
	GridUnload : function(){
		return this.each(function(){
			if ( !this.grid ) {return;}
			var defgrid = {id: $(this).attr('id'),cl: $(this).attr('class')};
			if (this.p.pager) {
				$(this.p.pager).empty().removeClass("ui-state-default ui-jqgrid-pager ui-corner-bottom");
			}
			var newtable = document.createElement('table');
			$(newtable).attr({id:defgrid.id});
			newtable.className = defgrid.cl;
			var gid = $.jgrid.jqID(this.id);
			$(newtable).removeClass("ui-jqgrid-btable");
			if( $(this.p.pager).parents("#gbox_"+gid).length === 1 ) {
				$(newtable).insertBefore("#gbox_"+gid).show();
				$(this.p.pager).insertBefore("#gbox_"+gid);
			} else {
				$(newtable).insertBefore("#gbox_"+gid).show();
			}
			$(this).jqGrid('clearBeforeUnload');
			$("#gbox_"+gid).remove();
		});
	},
	setGridState : function(state) {
		return this.each(function(){
			if ( !this.grid ) {return;}
			var $t = this;
			if(state === 'hidden'){
				$(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+$.jgrid.jqID($t.p.id)).slideUp("fast");
				if($t.p.pager) {$($t.p.pager).slideUp("fast");}
				if($t.p.toppager) {$($t.p.toppager).slideUp("fast");}
				if($t.p.toolbar[0]===true) {
					if( $t.p.toolbar[1] === 'both') {
						$($t.grid.ubDiv).slideUp("fast");
					}
					$($t.grid.uDiv).slideUp("fast");
				}
				if($t.p.footerrow) { $(".ui-jqgrid-sdiv","#gbox_"+$.jgrid.jqID($t.p.id)).slideUp("fast"); }
				$(".ui-jqgrid-titlebar-close span",$t.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");
				$t.p.gridstate = 'hidden';
			} else if(state === 'visible') {
				$(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+$.jgrid.jqID($t.p.id)).slideDown("fast");
				if($t.p.pager) {$($t.p.pager).slideDown("fast");}
				if($t.p.toppager) {$($t.p.toppager).slideDown("fast");}
				if($t.p.toolbar[0]===true) {
					if( $t.p.toolbar[1] === 'both') {
						$($t.grid.ubDiv).slideDown("fast");
					}
					$($t.grid.uDiv).slideDown("fast");
				}
				if($t.p.footerrow) { $(".ui-jqgrid-sdiv","#gbox_"+$.jgrid.jqID($t.p.id)).slideDown("fast"); }
				$(".ui-jqgrid-titlebar-close span",$t.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");
				$t.p.gridstate = 'visible';
			}

		});
	},
	filterToolbar : function(p){
		p = $.extend({
			autosearch: true,
			searchOnEnter : true,
			beforeSearch: null,
			afterSearch: null,
			beforeClear: null,
			afterClear: null,
			searchurl : '',
			stringResult: false,
			groupOp: 'AND',
			defaultSearch : "bw",
			searchOperators : false,
			resetIcon : "x",
			operands : { "eq" :"==", "ne":"!","lt":"<","le":"<=","gt":">","ge":">=","bw":"^","bn":"!^","in":"=","ni":"!=","ew":"|","en":"!@","cn":"~","nc":"!~","nu":"#","nn":"!#"}
		}, $.jgrid.search , p  || {});
		return this.each(function(){
			var $t = this;
			if(this.ftoolbar) { return; }
			var triggerToolbar = function() {
				var sdata={}, j=0, v, nm, sopt={},so;
				$.each($t.p.colModel,function(){
					var $elem = $("#gs_"+$.jgrid.jqID(this.name), (this.frozen===true && $t.p.frozenColumns === true) ?  $t.grid.fhDiv : $t.grid.hDiv);
					nm = this.index || this.name;
					if(p.searchOperators ) {
						so = $elem.parent().prev().children("a").attr("soper") || p.defaultSearch;
					} else {
						so  = (this.searchoptions && this.searchoptions.sopt) ? this.searchoptions.sopt[0] : this.stype==='select'?  'eq' : p.defaultSearch;
					}
					v = this.stype === "custom" && $.isFunction(this.searchoptions.custom_value) && $elem.length > 0 && $elem[0].nodeName.toUpperCase() === "SPAN" ?
						this.searchoptions.custom_value.call($t, $elem.children(".customelement:first"), "get") :
						$elem.val();
					if(v || so==="nu" || so==="nn") {
						sdata[nm] = v;
						sopt[nm] = so;
						j++;
					} else {
						try {
							delete $t.p.postData[nm];
						} catch (z) {}
					}
				});
				var sd =  j>0 ? true : false;
				if(p.stringResult === true || $t.p.datatype === "local") {
					var ruleGroup = "{\"groupOp\":\"" + p.groupOp + "\",\"rules\":[";
					var gi=0;
					$.each(sdata,function(i,n){
						if (gi > 0) {ruleGroup += ",";}
						ruleGroup += "{\"field\":\"" + i + "\",";
						ruleGroup += "\"op\":\"" + sopt[i] + "\",";
						n+="";
						ruleGroup += "\"data\":\"" + n.replace(/\\/g,'\\\\').replace(/\"/g,'\\"') + "\"}";
						gi++;
					});
					ruleGroup += "]}";
					$.extend($t.p.postData,{filters:ruleGroup});
					$.each(['searchField', 'searchString', 'searchOper'], function(i, n){
						if($t.p.postData.hasOwnProperty(n)) { delete $t.p.postData[n];}
					});
				} else {
					$.extend($t.p.postData,sdata);
				}
				var saveurl;
				if($t.p.searchurl) {
					saveurl = $t.p.url;
					$($t).jqGrid("setGridParam",{url:$t.p.searchurl});
				}
				var bsr = $($t).triggerHandler("jqGridToolbarBeforeSearch") === 'stop' ? true : false;
				if(!bsr && $.isFunction(p.beforeSearch)){bsr = p.beforeSearch.call($t);}
				if(!bsr) { $($t).jqGrid("setGridParam",{search:sd}).trigger("reloadGrid",[{page:1}]); }
				if(saveurl) {$($t).jqGrid("setGridParam",{url:saveurl});}
				$($t).triggerHandler("jqGridToolbarAfterSearch");
				if($.isFunction(p.afterSearch)){p.afterSearch.call($t);}
			},
			clearToolbar = function(trigger){
				var sdata={}, j=0, nm;
				trigger = (typeof trigger !== 'boolean') ? true : trigger;
				$.each($t.p.colModel,function(){
					var v, $elem = $("#gs_"+$.jgrid.jqID(this.name),(this.frozen===true && $t.p.frozenColumns === true) ?  $t.grid.fhDiv : $t.grid.hDiv);
					if(this.searchoptions && this.searchoptions.defaultValue !== undefined) { v = this.searchoptions.defaultValue; }
					nm = this.index || this.name;
					switch (this.stype) {
						case 'select' :
							$elem.find("option").each(function (i){
								if(i===0) { this.selected = true; }
								if ($(this).val() === v) {
									this.selected = true;
									return false;
								}
							});
							if ( v !== undefined ) {
								// post the key and not the text
								sdata[nm] = v;
								j++;
							} else {
								try {
									delete $t.p.postData[nm];
								} catch(e) {}
							}
							break;
						case 'text':
							$elem.val(v || "");
							if(v !== undefined) {
								sdata[nm] = v;
								j++;
							} else {
								try {
									delete $t.p.postData[nm];
								} catch (y){}
							}
							break;
						case 'custom':
							if ($.isFunction(this.searchoptions.custom_value) && $elem.length > 0 && $elem[0].nodeName.toUpperCase() === "SPAN") {
								this.searchoptions.custom_value.call($t, $elem.children(".customelement:first"), "set", v || "");
							}
							break;
					}
				});
				var sd =  j>0 ? true : false;
				$t.p.resetsearch =  true;
				if(p.stringResult === true || $t.p.datatype === "local") {
					var ruleGroup = "{\"groupOp\":\"" + p.groupOp + "\",\"rules\":[";
					var gi=0;
					$.each(sdata,function(i,n){
						if (gi > 0) {ruleGroup += ",";}
						ruleGroup += "{\"field\":\"" + i + "\",";
						ruleGroup += "\"op\":\"" + "eq" + "\",";
						n+="";
						ruleGroup += "\"data\":\"" + n.replace(/\\/g,'\\\\').replace(/\"/g,'\\"') + "\"}";
						gi++;
					});
					ruleGroup += "]}";
					$.extend($t.p.postData,{filters:ruleGroup});
					$.each(['searchField', 'searchString', 'searchOper'], function(i, n){
						if($t.p.postData.hasOwnProperty(n)) { delete $t.p.postData[n];}
					});
				} else {
					$.extend($t.p.postData,sdata);
				}
				var saveurl;
				if($t.p.searchurl) {
					saveurl = $t.p.url;
					$($t).jqGrid("setGridParam",{url:$t.p.searchurl});
				}
				var bcv = $($t).triggerHandler("jqGridToolbarBeforeClear") === 'stop' ? true : false;
				if(!bcv && $.isFunction(p.beforeClear)){bcv = p.beforeClear.call($t);}
				if(!bcv) {
					if(trigger) {
						$($t).jqGrid("setGridParam",{search:sd}).trigger("reloadGrid",[{page:1}]);
					}
				}
				if(saveurl) {$($t).jqGrid("setGridParam",{url:saveurl});}
				$($t).triggerHandler("jqGridToolbarAfterClear");
				if($.isFunction(p.afterClear)){p.afterClear();}
			},
			toggleToolbar = function(){
				var trow = $("tr.ui-search-toolbar",$t.grid.hDiv),
				trow2 = $t.p.frozenColumns === true ?  $("tr.ui-search-toolbar",$t.grid.fhDiv) : false;
				if(trow.css("display") === 'none') {
					trow.show();
					if(trow2) {
						trow2.show();
					}
				} else {
					trow.hide();
					if(trow2) {
						trow2.hide();
					}
				}
			},
			buildRuleMenu = function( elem, left, top ){
				$("#sopt_menu").remove();

				left=parseInt(left,10);
				top=parseInt(top,10) + 18;

				var fs =  $('.ui-jqgrid-view').css('font-size') || '11px';
				var str = '<ul id="sopt_menu" class="ui-search-menu" role="menu" tabindex="0" style="font-size:'+fs+';left:'+left+'px;top:'+top+'px;">',
				selected = $(elem).attr("soper"), selclass,
				aoprs = [], ina;
				var i=0, nm =$(elem).attr("colname"),len = $t.p.colModel.length;
				while(i<len) {
					if($t.p.colModel[i].name === nm) {
						break;
					}
					i++;
				}
				var cm = $t.p.colModel[i], options = $.extend({}, cm.searchoptions);
				if(!options.sopt) {
					options.sopt = [];
					options.sopt[0]= cm.stype==='select' ?  'eq' : p.defaultSearch;
				}
				$.each(p.odata, function() { aoprs.push(this.oper); });
				for ( i = 0 ; i < options.sopt.length; i++) {
					ina = $.inArray(options.sopt[i],aoprs);
					if(ina !== -1) {
						selclass = selected === p.odata[ina].oper ? "ui-state-highlight" : "";
						str += '<li class="ui-menu-item '+selclass+'" role="presentation"><a class="ui-corner-all g-menu-item" tabindex="0" role="menuitem" value="'+p.odata[ina].oper+'" oper="'+p.operands[p.odata[ina].oper]+'"><table cellspacing="0" cellpadding="0" border="0"><tr><td width="25px">'+p.operands[p.odata[ina].oper]+'</td><td>'+ p.odata[ina].text+'</td></tr></table></a></li>';
					}
				}
				str += "</ul>";
				$('body').append(str);
				$("#sopt_menu").addClass("ui-menu ui-widget ui-widget-content ui-corner-all");
				$("#sopt_menu > li > a").hover(
					function(){ $(this).addClass("ui-state-hover"); },
					function(){ $(this).removeClass("ui-state-hover"); }
				).click(function( e ){
					var v = $(this).attr("value"),
					oper = $(this).attr("oper");
					$($t).triggerHandler("jqGridToolbarSelectOper", [v, oper, elem]);
					$("#sopt_menu").hide();
					$(elem).text(oper).attr("soper",v);
					if(p.autosearch===true){
						var inpelm = $(elem).parent().next().children()[0];
						if( $(inpelm).val() || v==="nu" || v ==="nn") {
							triggerToolbar();
						}
					}
				});
			};
			// create the row
			var tr = $("<tr class='ui-search-toolbar' role='rowheader'></tr>");
			var timeoutHnd;
			$.each($t.p.colModel,function(ci){
				var cm=this, soptions, surl, self, select = "", sot="=", so, i,
				th = $("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+$t.p.direction+"'></th>"),
				thd = $("<div style='position:relative;height:100%;padding-right:0.3em;padding-left:0.3em;'></div>"),
				stbl = $("<table class='ui-search-table' cellspacing='0'><tr><td class='ui-search-oper'></td><td class='ui-search-input'></td><td class='ui-search-clear'></td></tr></table>");
				if(this.hidden===true) { $(th).css("display","none");}
				this.search = this.search === false ? false : true;
				if(this.stype === undefined) {this.stype='text';}
				soptions = $.extend({},this.searchoptions || {});
				if(this.search){
					if(p.searchOperators) {
						so  = (soptions.sopt) ? soptions.sopt[0] : cm.stype==='select' ?  'eq' : p.defaultSearch;
						for(i = 0;i<p.odata.length;i++) {
							if(p.odata[i].oper === so) {
								sot = p.operands[so] || "";
								break;
							}
						}
						var st = soptions.searchtitle != null ? soptions.searchtitle : p.operandTitle;
						select = "<a title='"+st+"' style='padding-right: 0.5em;' soper='"+so+"' class='soptclass' colname='"+this.name+"'>"+sot+"</a>";
					}
					$("td:eq(0)",stbl).attr("colindex",ci).append(select);
					if(soptions.clearSearch === undefined) {
						soptions.clearSearch = true;
					}
					if(soptions.clearSearch) {
						var csv = p.resetTitle || 'Clear Search Value';
						$("td:eq(2)",stbl).append("<a title='"+csv+"' style='padding-right: 0.3em;padding-left: 0.3em;' class='clearsearchclass'>"+p.resetIcon+"</a>");
					} else {
						$("td:eq(2)", stbl).hide();
					}
					switch (this.stype)
					{
					case "select":
						surl = this.surl || soptions.dataUrl;
						if(surl) {
							// data returned should have already constructed html select
							// primitive jQuery load
							self = thd;
							$(self).append(stbl);
							$.ajax($.extend({
								url: surl,
								dataType: "html",
								success: function(res) {
									if(soptions.buildSelect !== undefined) {
										var d = soptions.buildSelect(res);
										if (d) {
											$("td:eq(1)",stbl).append(d);
										}
									} else {
										$("td:eq(1)",stbl).append(res);
									}
									if(soptions.defaultValue !== undefined) { $("select",self).val(soptions.defaultValue); }
									$("select",self).attr({name:cm.index || cm.name, id: "gs_"+cm.name});
									if(soptions.attr) {$("select",self).attr(soptions.attr);}
									$("select",self).css({width: "100%"});
									// preserve autoserch
									$.jgrid.bindEv.call($t, $("select",self)[0], soptions);
									if(p.autosearch===true){
										$("select",self).change(function(){
											triggerToolbar();
											return false;
										});
									}
									res=null;
								}
							}, $.jgrid.ajaxOptions, $t.p.ajaxSelectOptions || {} ));
						} else {
							var oSv, sep, delim;
							if(cm.searchoptions) {
								oSv = cm.searchoptions.value === undefined ? "" : cm.searchoptions.value;
								sep = cm.searchoptions.separator === undefined ? ":" : cm.searchoptions.separator;
								delim = cm.searchoptions.delimiter === undefined ? ";" : cm.searchoptions.delimiter;
							} else if(cm.editoptions) {
								oSv = cm.editoptions.value === undefined ? "" : cm.editoptions.value;
								sep = cm.editoptions.separator === undefined ? ":" : cm.editoptions.separator;
								delim = cm.editoptions.delimiter === undefined ? ";" : cm.editoptions.delimiter;
							}
							if (oSv) {
								var elem = document.createElement("select");
								elem.style.width = "100%";
								$(elem).attr({name:cm.index || cm.name, id: "gs_"+cm.name});
								var sv, ov, key, k;
								if(typeof oSv === "string") {
									so = oSv.split(delim);
									for(k=0; k<so.length;k++){
										sv = so[k].split(sep);
										ov = document.createElement("option");
										ov.value = sv[0]; ov.innerHTML = sv[1];
										elem.appendChild(ov);
									}
								} else if(typeof oSv === "object" ) {
									for (key in oSv) {
										if(oSv.hasOwnProperty(key)) {
											ov = document.createElement("option");
											ov.value = key; ov.innerHTML = oSv[key];
											elem.appendChild(ov);
										}
									}
								}
								if(soptions.defaultValue !== undefined) { $(elem).val(soptions.defaultValue); }
								if(soptions.attr) {$(elem).attr(soptions.attr);}
								$(thd).append(stbl);
								$.jgrid.bindEv.call($t, elem , soptions);
								$("td:eq(1)",stbl).append( elem );
								if(p.autosearch===true){
									$(elem).change(function(){
										triggerToolbar();
										return false;
									});
								}
							}
						}
						break;
					case "text":
						var df = soptions.defaultValue !== undefined ? soptions.defaultValue: "";

						$("td:eq(1)",stbl).append("<input type='text' style='width:100%;padding:0px;' name='"+(cm.index || cm.name)+"' id='gs_"+cm.name+"' value='"+df+"'/>");
						$(thd).append(stbl);

						if(soptions.attr) {$("input",thd).attr(soptions.attr);}
						$.jgrid.bindEv.call($t, $("input",thd)[0], soptions);
						if(p.autosearch===true){
							if(p.searchOnEnter) {
								$("input",thd).keypress(function(e){
									var key = e.charCode || e.keyCode || 0;
									if(key === 13){
										triggerToolbar();
										return false;
									}
									return this;
								});
							} else {
								$("input",thd).keydown(function(e){
									var key = e.which;
									switch (key) {
										case 13:
											return false;
										case 9 :
										case 16:
										case 37:
										case 38:
										case 39:
										case 40:
										case 27:
											break;
										default :
											if(timeoutHnd) { clearTimeout(timeoutHnd); }
											timeoutHnd = setTimeout(function(){triggerToolbar();},500);
									}
								});
							}
						}
						break;
					case "custom":
						$("td:eq(1)",stbl).append("<span style='width:95%;padding:0px;' name='"+(cm.index || cm.name)+"' id='gs_"+cm.name+"'/>");
						$(thd).append(stbl);
						try {
							if($.isFunction(soptions.custom_element)) {
								var celm = soptions.custom_element.call($t,soptions.defaultValue !== undefined ? soptions.defaultValue: "",soptions);
								if(celm) {
									celm = $(celm).addClass("customelement");
									$(thd).find(">span").append(celm);
								} else {
									throw "e2";
								}
							} else {
								throw "e1";
							}
						} catch (e) {
							if (e === "e1") { $.jgrid.info_dialog($.jgrid.errors.errcap,"function 'custom_element' "+$.jgrid.edit.msg.nodefined,$.jgrid.edit.bClose);}
							if (e === "e2") { $.jgrid.info_dialog($.jgrid.errors.errcap,"function 'custom_element' "+$.jgrid.edit.msg.novalue,$.jgrid.edit.bClose);}
							else { $.jgrid.info_dialog($.jgrid.errors.errcap,typeof e==="string"?e:e.message,$.jgrid.edit.bClose); }
						}
						break;
					}
				}
				$(th).append(thd);
				$(tr).append(th);
				if(!p.searchOperators) {
					$("td:eq(0)",stbl).hide();
				}
			});
			$("table thead",$t.grid.hDiv).append(tr);
			if(p.searchOperators) {
				$(".soptclass",tr).click(function(e){
					var offset = $(this).offset(),
					left = ( offset.left ),
					top = ( offset.top);
					buildRuleMenu(this, left, top );
					e.stopPropagation();
				});
				$("body").on('click', function(e){
					if(e.target.className !== "soptclass") {
						$("#sopt_menu").hide();
					}
				});
			}
			$(".clearsearchclass",tr).click(function(e){
				var ptr = $(this).parents("tr:first"),
				coli = parseInt($("td.ui-search-oper", ptr).attr('colindex'),10),
				sval  = $.extend({},$t.p.colModel[coli].searchoptions || {}),
				dval = sval.defaultValue ? sval.defaultValue : "";
				if($t.p.colModel[coli].stype === "select") {
					if(dval) {
						$("td.ui-search-input select", ptr).val( dval );
					} else {
						$("td.ui-search-input select", ptr)[0].selectedIndex = 0;
					}
				} else {
					$("td.ui-search-input input", ptr).val( dval );
				}
				// ToDo custom search type
				if(p.autosearch===true){
					triggerToolbar();
				}

			});
			this.ftoolbar = true;
			this.triggerToolbar = triggerToolbar;
			this.clearToolbar = clearToolbar;
			this.toggleToolbar = toggleToolbar;
		});
	},
	destroyFilterToolbar: function () {
		return this.each(function () {
			if (!this.ftoolbar) {
				return;
			}
			this.triggerToolbar = null;
			this.clearToolbar = null;
			this.toggleToolbar = null;
			this.ftoolbar = false;
			$(this.grid.hDiv).find("table thead tr.ui-search-toolbar").remove();
		});
	},
	destroyGroupHeader : function(nullHeader)
	{
		if(nullHeader === undefined) {
			nullHeader = true;
		}
		return this.each(function()
		{
			var $t = this, $tr, i, l, headers, $th, $resizing, grid = $t.grid,
			thead = $("table.ui-jqgrid-htable thead", grid.hDiv), cm = $t.p.colModel, hc;
			if(!grid) { return; }

			$(this).unbind('.setGroupHeaders');
			$tr = $("<tr>", {role: "rowheader"}).addClass("ui-jqgrid-labels");
			headers = grid.headers;
			for (i = 0, l = headers.length; i < l; i++) {
				hc = cm[i].hidden ? "none" : "";
				$th = $(headers[i].el)
					.width(headers[i].width)
					.css('display',hc);
				try {
					$th.removeAttr("rowSpan");
				} catch (rs) {
					//IE 6/7
					$th.attr("rowSpan",1);
				}
				$tr.append($th);
				$resizing = $th.children("span.ui-jqgrid-resize");
				if ($resizing.length>0) {// resizable column
					$resizing[0].style.height = "";
				}
				$th.children("div")[0].style.top = "";
			}
			$(thead).children('tr.ui-jqgrid-labels').remove();
			$(thead).prepend($tr);

			if(nullHeader === true) {
				$($t).jqGrid('setGridParam',{ 'groupHeader': null});
			}
		});
	},
	setGroupHeaders : function ( o ) {
		o = $.extend({
			useColSpanStyle :  false,
			groupHeaders: []
		},o  || {});
		return this.each(function(){
			this.p.groupHeader = o;
			var ts = this,
			i, cmi, skip = 0, $tr, $colHeader, th, $th, thStyle,
			iCol,
			cghi,
			//startColumnName,
			numberOfColumns,
			titleText,
			cVisibleColumns,
			colModel = ts.p.colModel,
			cml = colModel.length,
			ths = ts.grid.headers,
			$htable = $("table.ui-jqgrid-htable", ts.grid.hDiv),
			$trLabels = $htable.children("thead").children("tr.ui-jqgrid-labels:last").addClass("jqg-second-row-header"),
			$thead = $htable.children("thead"),
			$theadInTable,
			$firstHeaderRow = $htable.find(".jqg-first-row-header");
			if($firstHeaderRow[0] === undefined) {
				$firstHeaderRow = $('<tr>', {role: "row", "aria-hidden": "true"}).addClass("jqg-first-row-header").css("height", "auto");
			} else {
				$firstHeaderRow.empty();
			}
			var $firstRow,
			inColumnHeader = function (text, columnHeaders) {
				var length = columnHeaders.length, i;
				for (i = 0; i < length; i++) {
					if (columnHeaders[i].startColumnName === text) {
						return i;
					}
				}
				return -1;
			};

			$(ts).prepend($thead);
			$tr = $('<tr>', {role: "rowheader"}).addClass("ui-jqgrid-labels jqg-third-row-header");
			for (i = 0; i < cml; i++) {
				th = ths[i].el;
				$th = $(th);
				cmi = colModel[i];
				// build the next cell for the first header row
				thStyle = { height: '0px', width: ths[i].width + 'px', display: (cmi.hidden ? 'none' : '')};
				$("<th>", {role: 'gridcell'}).css(thStyle).addClass("ui-first-th-"+ts.p.direction).appendTo($firstHeaderRow);

				th.style.width = ""; // remove unneeded style
				iCol = inColumnHeader(cmi.name, o.groupHeaders);
				if (iCol >= 0) {
					cghi = o.groupHeaders[iCol];
					numberOfColumns = cghi.numberOfColumns;
					titleText = cghi.titleText;

					// caclulate the number of visible columns from the next numberOfColumns columns
					for (cVisibleColumns = 0, iCol = 0; iCol < numberOfColumns && (i + iCol < cml); iCol++) {
						if (!colModel[i + iCol].hidden) {
							cVisibleColumns++;
						}
					}

					// The next numberOfColumns headers will be moved in the next row
					// in the current row will be placed the new column header with the titleText.
					// The text will be over the cVisibleColumns columns
					$colHeader = $('<th>').attr({role: "columnheader"})
						.addClass("ui-state-default ui-th-column-header ui-th-"+ts.p.direction)
						.css({'height':'22px', 'border-top': '0 none'})
						.html(titleText);
					if(cVisibleColumns > 0) {
						$colHeader.attr("colspan", String(cVisibleColumns));
					}
					if (ts.p.headertitles) {
						$colHeader.attr("title", $colHeader.text());
					}
					// hide if not a visible cols
					if( cVisibleColumns === 0) {
						$colHeader.hide();
					}

					$th.before($colHeader); // insert new column header before the current
					$tr.append(th);         // move the current header in the next row

					// set the coumter of headers which will be moved in the next row
					skip = numberOfColumns - 1;
				} else {
					if (skip === 0) {
						if (o.useColSpanStyle) {
							// expand the header height to two rows
							$th.attr("rowspan", "2");
						} else {
							$('<th>', {role: "columnheader"})
								.addClass("ui-state-default ui-th-column-header ui-th-"+ts.p.direction)
								.css({"display": cmi.hidden ? 'none' : '', 'border-top': '0 none'})
								.insertBefore($th);
							$tr.append(th);
						}
					} else {
						// move the header to the next row
						//$th.css({"padding-top": "2px", height: "19px"});
						$tr.append(th);
						skip--;
					}
				}
			}
			$theadInTable = $(ts).children("thead");
			$theadInTable.prepend($firstHeaderRow);
			$tr.insertAfter($trLabels);
			$htable.append($theadInTable);

			if (o.useColSpanStyle) {
				// Increase the height of resizing span of visible headers
				$htable.find("span.ui-jqgrid-resize").each(function () {
					var $parent = $(this).parent();
					if ($parent.is(":visible")) {
						this.style.cssText = 'height: ' + $parent.height() + 'px !important; cursor: col-resize;';
					}
				});

				// Set position of the sortable div (the main lable)
				// with the column header text to the middle of the cell.
				// One should not do this for hidden headers.
				$htable.find("div.ui-jqgrid-sortable").each(function () {
					var $ts = $(this), $parent = $ts.parent();
					if ($parent.is(":visible") && $parent.is(":has(span.ui-jqgrid-resize)")) {
						$ts.css('top', ($parent.height() - $ts.outerHeight()) / 2 + 'px');
					}
				});
			}

			$firstRow = $theadInTable.find("tr.jqg-first-row-header");
			$(ts).bind('jqGridResizeStop.setGroupHeaders', function (e, nw, idx) {
				$firstRow.find('th').eq(idx).width(nw);
			});
		});
	},
	setFrozenColumns : function () {
		return this.each(function() {
			if ( !this.grid ) {return;}
			var $t = this, cm = $t.p.colModel,i=0, len = cm.length, maxfrozen = -1, frozen= false;
			// TODO treeGrid and grouping  Support
			if($t.p.subGrid === true || $t.p.treeGrid === true || $t.p.cellEdit === true || $t.p.sortable || $t.p.scroll )
			{
				return;
			}
			if($t.p.rownumbers) { i++; }
			if($t.p.multiselect) { i++; }

			// get the max index of frozen col
			while(i<len)
			{
				// from left, no breaking frozen
				if(cm[i].frozen === true)
				{
					frozen = true;
					maxfrozen = i;
				} else {
					break;
				}
				i++;
			}
			if( maxfrozen>=0 && frozen) {
				var top = $t.p.caption ? $($t.grid.cDiv).outerHeight() : 0,
				hth = $(".ui-jqgrid-htable","#gview_"+$.jgrid.jqID($t.p.id)).height();
				//headers
				if($t.p.toppager) {
					top = top + $($t.grid.topDiv).outerHeight();
				}
				if($t.p.toolbar[0] === true) {
					if($t.p.toolbar[1] !== "bottom") {
						top = top + $($t.grid.uDiv).outerHeight();
					}
				}
				$t.grid.fhDiv = $('<div style="position:absolute;left:0px;top:'+top+'px;height:'+hth+'px;" class="frozen-div ui-state-default ui-jqgrid-hdiv"></div>');
				$t.grid.fbDiv = $('<div style="position:absolute;left:0px;top:'+(parseInt(top,10)+parseInt(hth,10) + 1)+'px;overflow-y:hidden" class="frozen-bdiv ui-jqgrid-bdiv"></div>');
				$("#gview_"+$.jgrid.jqID($t.p.id)).append($t.grid.fhDiv);
				var htbl = $(".ui-jqgrid-htable","#gview_"+$.jgrid.jqID($t.p.id)).clone(true);
				// groupheader support - only if useColSpanstyle is false
				if($t.p.groupHeader) {
					$("tr.jqg-first-row-header, tr.jqg-third-row-header", htbl).each(function(){
						$("th:gt("+maxfrozen+")",this).remove();
					});
					var swapfroz = -1, fdel = -1, cs, rs;
					$("tr.jqg-second-row-header th", htbl).each(function(){
						cs= parseInt($(this).attr("colspan"),10);
						rs= parseInt($(this).attr("rowspan"),10);
						if(rs) {
							swapfroz++;
							fdel++;
						}
						if(cs) {
							swapfroz = swapfroz+cs;
							fdel++;
						}
						if(swapfroz === maxfrozen) {
							return false;
						}
					});
					if(swapfroz !== maxfrozen) {
						fdel = maxfrozen;
					}
					$("tr.jqg-second-row-header", htbl).each(function(){
						$("th:gt("+fdel+")",this).remove();
					});
				} else {
					$("tr",htbl).each(function(){
						$("th:gt("+maxfrozen+")",this).remove();
					});
				}
				$(htbl).width(1);
				// resizing stuff
				$($t.grid.fhDiv).append(htbl)
				.mousemove(function (e) {
					if($t.grid.resizing){ $t.grid.dragMove(e);return false; }
				});
				$($t).bind('jqGridResizeStop.setFrozenColumns', function (e, w, index) {
					var rhth = $(".ui-jqgrid-htable",$t.grid.fhDiv);
					$("th:eq("+index+")",rhth).width( w );
					var btd = $(".ui-jqgrid-btable",$t.grid.fbDiv);
					$("tr:first td:eq("+index+")",btd).width( w );
				});
				// sorting stuff
				$($t).bind('jqGridSortCol.setFrozenColumns', function (e, index, idxcol) {

					var previousSelectedTh = $("tr.ui-jqgrid-labels:last th:eq("+$t.p.lastsort+")",$t.grid.fhDiv), newSelectedTh = $("tr.ui-jqgrid-labels:last th:eq("+idxcol+")",$t.grid.fhDiv);

					$("span.ui-grid-ico-sort",previousSelectedTh).addClass('ui-state-disabled');
					$(previousSelectedTh).attr("aria-selected","false");
					$("span.ui-icon-"+$t.p.sortorder,newSelectedTh).removeClass('ui-state-disabled');
					$(newSelectedTh).attr("aria-selected","true");
					if(!$t.p.viewsortcols[0]) {
						if($t.p.lastsort !== idxcol) {
							$("span.s-ico",previousSelectedTh).hide();
							$("span.s-ico",newSelectedTh).show();
						}
					}
				});

				// data stuff
				//TODO support for setRowData
				$("#gview_"+$.jgrid.jqID($t.p.id)).append($t.grid.fbDiv);
				$($t.grid.bDiv).scroll(function () {
					$($t.grid.fbDiv).scrollTop($(this).scrollTop());
				});
				if($t.p.hoverrows === true) {
					$("#"+$.jgrid.jqID($t.p.id)).unbind('mouseover').unbind('mouseout');
				}
				$($t).bind('jqGridAfterGridComplete.setFrozenColumns', function () {
					$("#"+$.jgrid.jqID($t.p.id)+"_frozen").remove();
					$($t.grid.fbDiv).height($($t.grid.bDiv).height()-16);
					var btbl = $("#"+$.jgrid.jqID($t.p.id)).clone(true);
					$("tr[role=row]",btbl).each(function(){
						$("td[role=gridcell]:gt("+maxfrozen+")",this).remove();
					});

					$(btbl).width(1).attr("id",$t.p.id+"_frozen");
					$($t.grid.fbDiv).append(btbl);
					if($t.p.hoverrows === true) {
						$("tr.jqgrow", btbl).hover(
							function(){ $(this).addClass("ui-state-hover"); $("#"+$.jgrid.jqID(this.id), "#"+$.jgrid.jqID($t.p.id)).addClass("ui-state-hover"); },
							function(){ $(this).removeClass("ui-state-hover"); $("#"+$.jgrid.jqID(this.id), "#"+$.jgrid.jqID($t.p.id)).removeClass("ui-state-hover"); }
						);
						$("tr.jqgrow", "#"+$.jgrid.jqID($t.p.id)).hover(
							function(){ $(this).addClass("ui-state-hover"); $("#"+$.jgrid.jqID(this.id), "#"+$.jgrid.jqID($t.p.id)+"_frozen").addClass("ui-state-hover");},
							function(){ $(this).removeClass("ui-state-hover"); $("#"+$.jgrid.jqID(this.id), "#"+$.jgrid.jqID($t.p.id)+"_frozen").removeClass("ui-state-hover"); }
						);
					}
					btbl=null;
				});
				if(!$t.grid.hDiv.loading) {
					$($t).triggerHandler("jqGridAfterGridComplete");
				}
				$t.p.frozenColumns = true;
			}
		});
	},
	destroyFrozenColumns :  function() {
		return this.each(function() {
			if ( !this.grid ) {return;}
			if(this.p.frozenColumns === true) {
				var $t = this;
				$($t.grid.fhDiv).remove();
				$($t.grid.fbDiv).remove();
				$t.grid.fhDiv = null; $t.grid.fbDiv=null;
				$(this).unbind('.setFrozenColumns');
				if($t.p.hoverrows === true) {
					var ptr;
					$("#"+$.jgrid.jqID($t.p.id)).bind('mouseover',function(e) {
						ptr = $(e.target).closest("tr.jqgrow");
						if($(ptr).attr("class") !== "ui-subgrid") {
						$(ptr).addClass("ui-state-hover");
					}
					}).bind('mouseout',function(e) {
						ptr = $(e.target).closest("tr.jqgrow");
						$(ptr).removeClass("ui-state-hover");
					});
				}
				this.p.frozenColumns = false;
			}
		});
	}
});
})(jQuery);
/*
 * jqModal - Minimalist Modaling with jQuery
 *   (http://dev.iceburg.net/jquery/jqmodal/)
 *
 * Copyright (c) 2007,2008 Brice Burgess <bhb@iceburg.net>
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * $Version: 07/06/2008 +r13
 */
(function($) {
$.fn.jqm=function(o){
var p={
overlay: 50,
closeoverlay : true,
overlayClass: 'jqmOverlay',
closeClass: 'jqmClose',
trigger: '.jqModal',
ajax: F,
ajaxText: '',
target: F,
modal: F,
toTop: F,
onShow: F,
onHide: F,
onLoad: F
};
return this.each(function(){if(this._jqm)return H[this._jqm].c=$.extend({},H[this._jqm].c,o);s++;this._jqm=s;
H[s]={c:$.extend(p,$.jqm.params,o),a:F,w:$(this).addClass('jqmID'+s),s:s};
if(p.trigger)$(this).jqmAddTrigger(p.trigger);
});};

$.fn.jqmAddClose=function(e){return hs(this,e,'jqmHide');};
$.fn.jqmAddTrigger=function(e){return hs(this,e,'jqmShow');};
$.fn.jqmShow=function(t){return this.each(function(){$.jqm.open(this._jqm,t);});};
$.fn.jqmHide=function(t){return this.each(function(){$.jqm.close(this._jqm,t)});};

$.jqm = {
hash:{},
open:function(s,t){var h=H[s],c=h.c,cc='.'+c.closeClass,z=(parseInt(h.w.css('z-index')));z=(z>0)?z:3000;var o=$('<div></div>').css({height:'100%',width:'100%',position:'fixed',left:0,top:0,'z-index':z-1,opacity:c.overlay/100});if(h.a)return F;h.t=t;h.a=true;h.w.css('z-index',z);
 if(c.modal) {if(!A[0])setTimeout(function(){L('bind');},1);A.push(s);}
 else if(c.overlay > 0) {if(c.closeoverlay) h.w.jqmAddClose(o);}
 else o=F;

 h.o=(o)?o.addClass(c.overlayClass).prependTo('body'):F;

 if(c.ajax) {var r=c.target||h.w,u=c.ajax;r=(typeof r == 'string')?$(r,h.w):$(r);u=(u.substr(0,1) == '@')?$(t).attr(u.substring(1)):u;
  r.html(c.ajaxText).load(u,function(){if(c.onLoad)c.onLoad.call(this,h);if(cc)h.w.jqmAddClose($(cc,h.w));e(h);});}
 else if(cc)h.w.jqmAddClose($(cc,h.w));

 if(c.toTop&&h.o)h.w.before('<span id="jqmP'+h.w[0]._jqm+'"></span>').insertAfter(h.o);
 (c.onShow)?c.onShow(h):h.w.show();e(h);return F;
},
close:function(s){var h=H[s];if(!h.a)return F;h.a=F;
 if(A[0]){A.pop();if(!A[0])L('unbind');}
 if(h.c.toTop&&h.o)$('#jqmP'+h.w[0]._jqm).after(h.w).remove();
 if(h.c.onHide)h.c.onHide(h);else{h.w.hide();if(h.o)h.o.remove();} return F;
},
params:{}};
var s=0,H=$.jqm.hash,A=[],F=false,
e=function(h){f(h);},
f=function(h){try{$(':input:visible',h.w)[0].focus();}catch(_){}},
L=function(t){$(document)[t]("keypress",m)[t]("keydown",m)[t]("mousedown",m);},
m=function(e){var h=H[A[A.length-1]],r=(!$(e.target).parents('.jqmID'+h.s)[0]);if(r){$('.jqmID'+h.s).each(function(){var $self=$(this),offset=$self.offset();if(offset.top<=e.pageY && e.pageY<=offset.top+$self.height() && offset.left<=e.pageX && e.pageX<=offset.left+$self.width()){r=false;return false;}});f(h);}return !r;},
hs=function(w,t,c){return w.each(function(){var s=this._jqm;$(t).each(function() {
 if(!this[c]){this[c]=[];$(this).click(function(){for(var i in {jqmShow:1,jqmHide:1})for(var s in this[i])if(H[this[i][s]])H[this[i][s]].w[i](this);return F;});}this[c].push(s);});});};
})(jQuery);/*
 * jqDnR - Minimalistic Drag'n'Resize for jQuery.
 *
 * Copyright (c) 2007 Brice Burgess <bhb@iceburg.net>, http://www.iceburg.net
 * Licensed under the MIT License:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * $Version: 2007.08.19 +r2
 */

(function($){
$.fn.jqDrag=function(h){return i(this,h,'d');};
$.fn.jqResize=function(h,ar){return i(this,h,'r',ar);};
$.jqDnR={
	dnr:{},
	e:0,
	drag:function(v){
		if(M.k == 'd'){E.css({left:M.X+v.pageX-M.pX,top:M.Y+v.pageY-M.pY});}
		else {
			E.css({width:Math.max(v.pageX-M.pX+M.W,0),height:Math.max(v.pageY-M.pY+M.H,0)});
			if(M1){E1.css({width:Math.max(v.pageX-M1.pX+M1.W,0),height:Math.max(v.pageY-M1.pY+M1.H,0)});}
		}
		return false;
	},
	stop:function(){
		//E.css('opacity',M.o);
		$(document).unbind('mousemove',J.drag).unbind('mouseup',J.stop);
	}
};
var J=$.jqDnR,M=J.dnr,E=J.e,E1,M1,
i=function(e,h,k,aR){
	return e.each(function(){
		h=(h)?$(h,e):e;
		h.bind('mousedown',{e:e,k:k},function(v){
			var d=v.data,p={};E=d.e;E1 = aR ? $(aR) : false;
			// attempt utilization of dimensions plugin to fix IE issues
			if(E.css('position') != 'relative'){try{E.position(p);}catch(e){}}
			M={
				X:p.left||f('left')||0,
				Y:p.top||f('top')||0,
				W:f('width')||E[0].scrollWidth||0,
				H:f('height')||E[0].scrollHeight||0,
				pX:v.pageX,
				pY:v.pageY,
				k:d.k
				//o:E.css('opacity')
			};
			// also resize
			if(E1 && d.k != 'd'){
				M1={
					X:p.left||f1('left')||0,
					Y:p.top||f1('top')||0,
					W:E1[0].offsetWidth||f1('width')||0,
					H:E1[0].offsetHeight||f1('height')||0,
					pX:v.pageX,
					pY:v.pageY,
					k:d.k
				};
			} else {M1 = false;}
			//E.css({opacity:0.8});
			if($("input.hasDatepicker",E[0])[0]) {
			try {$("input.hasDatepicker",E[0]).datepicker('hide');}catch (dpe){}
			}
			$(document).mousemove($.jqDnR.drag).mouseup($.jqDnR.stop);
			return false;
		});
	});
},
f=function(k){return parseInt(E.css(k),10)||false;},
f1=function(k){return parseInt(E1.css(k),10)||false;};
})(jQuery);/*
	The below work is licensed under Creative Commons GNU LGPL License.

	Original work:

	License:     http://creativecommons.org/licenses/LGPL/2.1/
	Author:      Stefan Goessner/2006
	Web:         http://goessner.net/

	Modifications made:

	Version:     0.9-p5
	Description: Restructured code, JSLint validated (no strict whitespaces),
	             added handling of empty arrays, empty strings, and int/floats values.
	Author:      Michael Schøler/2008-01-29
	Web:         http://michael.hinnerup.net/blog/2008/01/26/converting-json-to-xml-and-xml-to-json/

	Description: json2xml added support to convert functions as CDATA
	             so it will be easy to write characters that cause some problems when convert
	Author:      Tony Tomov
*/

/*global alert */
var xmlJsonClass = {
	// Param "xml": Element or document DOM node.
	// Param "tab": Tab or indent string for pretty output formatting omit or use empty string "" to supress.
	// Returns:     JSON string
	xml2json: function(xml, tab) {
		if (xml.nodeType === 9) {
			// document node
			xml = xml.documentElement;
		}
		var nws = this.removeWhite(xml);
		var obj = this.toObj(nws);
		var json = this.toJson(obj, xml.nodeName, "\t");
		return "{\n" + tab + (tab ? json.replace(/\t/g, tab) : json.replace(/\t|\n/g, "")) + "\n}";
	},

	// Param "o":   JavaScript object
	// Param "tab": tab or indent string for pretty output formatting omit or use empty string "" to supress.
	// Returns:     XML string
	json2xml: function(o, tab) {
		var toXml = function(v, name, ind) {
			var xml = "";
			var i, n;
			if (v instanceof Array) {
				if (v.length === 0) {
					xml += ind + "<"+name+">__EMPTY_ARRAY_</"+name+">\n";
				}
				else {
					for (i = 0, n = v.length; i < n; i += 1) {
						var sXml = ind + toXml(v[i], name, ind+"\t") + "\n";
						xml += sXml;
					}
				}
			}
			else if (typeof(v) === "object") {
				var hasChild = false;
				xml += ind + "<" + name;
				var m;
				for (m in v) if (v.hasOwnProperty(m)) {
					if (m.charAt(0) === "@") {
						xml += " " + m.substr(1) + "=\"" + v[m].toString() + "\"";
					}
					else {
						hasChild = true;
					}
				}
				xml += hasChild ? ">" : "/>";
				if (hasChild) {
					for (m in v) if (v.hasOwnProperty(m)) {
						if (m === "#text") {
							xml += v[m];
						}
						else if (m === "#cdata") {
							xml += "<![CDATA[" + v[m] + "]]>";
						}
						else if (m.charAt(0) !== "@") {
							xml += toXml(v[m], m, ind+"\t");
						}
					}
					xml += (xml.charAt(xml.length - 1) === "\n" ? ind : "") + "</" + name + ">";
				}
			}
			else if (typeof(v) === "function") {
				xml += ind + "<" + name + ">" + "<![CDATA[" + v + "]]>" + "</" + name + ">";
			}
			else {
				if (v === undefined ) { v = ""; }
				if (v.toString() === "\"\"" || v.toString().length === 0) {
					xml += ind + "<" + name + ">__EMPTY_STRING_</" + name + ">";
				}
				else {
					xml += ind + "<" + name + ">" + v.toString() + "</" + name + ">";
				}
			}
			return xml;
		};
		var xml = "";
		var m;
		for (m in o) if (o.hasOwnProperty(m)) {
			xml += toXml(o[m], m, "");
		}
		return tab ? xml.replace(/\t/g, tab) : xml.replace(/\t|\n/g, "");
	},
	// Internal methods
	toObj: function(xml) {
		var o = {};
		var FuncTest = /function/i;
		if (xml.nodeType === 1) {
			// element node ..
			if (xml.attributes.length) {
				// element with attributes ..
				var i;
				for (i = 0; i < xml.attributes.length; i += 1) {
					o["@" + xml.attributes[i].nodeName] = (xml.attributes[i].nodeValue || "").toString();
				}
			}
			if (xml.firstChild) {
				// element has child nodes ..
				var textChild = 0, cdataChild = 0, hasElementChild = false;
				var n;
				for (n = xml.firstChild; n; n = n.nextSibling) {
					if (n.nodeType === 1) {
						hasElementChild = true;
					}
					else if (n.nodeType === 3 && n.nodeValue.match(/[^ \f\n\r\t\v]/)) {
						// non-whitespace text
						textChild += 1;
					}
					else if (n.nodeType === 4) {
						// cdata section node
						cdataChild += 1;
					}
				}
				if (hasElementChild) {
					if (textChild < 2 && cdataChild < 2) {
						// structured element with evtl. a single text or/and cdata node ..
						this.removeWhite(xml);
						for (n = xml.firstChild; n; n = n.nextSibling) {
							if (n.nodeType === 3) {
								// text node
								o["#text"] = this.escape(n.nodeValue);
							}
							else if (n.nodeType === 4) {
								// cdata node
								if (FuncTest.test(n.nodeValue)) {
									o[n.nodeName] = [o[n.nodeName], n.nodeValue];
								} else {
									o["#cdata"] = this.escape(n.nodeValue);
								}
							}
							else if (o[n.nodeName]) {
								// multiple occurence of element ..
								if (o[n.nodeName] instanceof Array) {
									o[n.nodeName][o[n.nodeName].length] = this.toObj(n);
								}
								else {
									o[n.nodeName] = [o[n.nodeName], this.toObj(n)];
								}
							}
							else {
								// first occurence of element ..
								o[n.nodeName] = this.toObj(n);
							}
						}
					}
					else {
						// mixed content
						if (!xml.attributes.length) {
							o = this.escape(this.innerXml(xml));
						}
						else {
							o["#text"] = this.escape(this.innerXml(xml));
						}
					}
				}
				else if (textChild) {
					// pure text
					if (!xml.attributes.length) {
						o = this.escape(this.innerXml(xml));
						if (o === "__EMPTY_ARRAY_") {
							o = "[]";
						} else if (o === "__EMPTY_STRING_") {
							o = "";
						}
					}
					else {
						o["#text"] = this.escape(this.innerXml(xml));
					}
				}
				else if (cdataChild) {
					// cdata
					if (cdataChild > 1) {
						o = this.escape(this.innerXml(xml));
					}
					else {
						for (n = xml.firstChild; n; n = n.nextSibling) {
							if(FuncTest.test(xml.firstChild.nodeValue)) {
								o = xml.firstChild.nodeValue;
								break;
							} else {
								o["#cdata"] = this.escape(n.nodeValue);
							}
						}
					}
				}
			}
			if (!xml.attributes.length && !xml.firstChild) {
				o = null;
			}
		}
		else if (xml.nodeType === 9) {
			// document.node
			o = this.toObj(xml.documentElement);
		}
		else {
			alert("unhandled node type: " + xml.nodeType);
		}
		return o;
	},
	toJson: function(o, name, ind, wellform) {
		if(wellform === undefined) wellform = true;
		var json = name ? ("\"" + name + "\"") : "", tab = "\t", newline = "\n";
		if(!wellform) {
			tab= ""; newline= "";
		}

		if (o === "[]") {
			json += (name ? ":[]" : "[]");
		}
		else if (o instanceof Array) {
			var n, i, ar=[];
			for (i = 0, n = o.length; i < n; i += 1) {
				ar[i] = this.toJson(o[i], "", ind + tab, wellform);
			}
			json += (name ? ":[" : "[") + (ar.length > 1 ? (newline + ind + tab + ar.join(","+newline + ind + tab) + newline + ind) : ar.join("")) + "]";
		}
		else if (o === null) {
			json += (name && ":") + "null";
		}
		else if (typeof(o) === "object") {
			var arr = [], m;
			for (m in o) {
				if (o.hasOwnProperty(m)) {
					arr[arr.length] = this.toJson(o[m], m, ind + tab, wellform);
			}
		}
			json += (name ? ":{" : "{") + (arr.length > 1 ? (newline + ind + tab + arr.join(","+newline + ind + tab) + newline + ind) : arr.join("")) + "}";
		}
		else if (typeof(o) === "string") {
			/*
			var objRegExp  = /(^-?\d+\.?\d*$)/;
			var FuncTest = /function/i;
			var os = o.toString();
			if (objRegExp.test(os) || FuncTest.test(os) || os==="false" || os==="true") {
				// int or float
				json += (name && ":")  + "\"" +os + "\"";
			}
			else {
			*/
				json += (name && ":") + "\"" + o.replace(/\\/g,'\\\\').replace(/\"/g,'\\"') + "\"";
			//}
			}
		else {
			json += (name && ":") +  o.toString();
		}
		return json;
	},
	innerXml: function(node) {
		var s = "";
		if ("innerHTML" in node) {
			s = node.innerHTML;
		}
		else {
			var asXml = function(n) {
				var s = "", i;
				if (n.nodeType === 1) {
					s += "<" + n.nodeName;
					for (i = 0; i < n.attributes.length; i += 1) {
						s += " " + n.attributes[i].nodeName + "=\"" + (n.attributes[i].nodeValue || "").toString() + "\"";
					}
					if (n.firstChild) {
						s += ">";
						for (var c = n.firstChild; c; c = c.nextSibling) {
							s += asXml(c);
						}
						s += "</" + n.nodeName + ">";
					}
					else {
						s += "/>";
					}
				}
				else if (n.nodeType === 3) {
					s += n.nodeValue;
				}
				else if (n.nodeType === 4) {
					s += "<![CDATA[" + n.nodeValue + "]]>";
				}
				return s;
			};
			for (var c = node.firstChild; c; c = c.nextSibling) {
				s += asXml(c);
			}
		}
		return s;
	},
	escape: function(txt) {
		return txt.replace(/[\\]/g, "\\\\").replace(/[\"]/g, '\\"').replace(/[\n]/g, '\\n').replace(/[\r]/g, '\\r');
	},
	removeWhite: function(e) {
		e.normalize();
		var n;
		for (n = e.firstChild; n; ) {
			if (n.nodeType === 3) {
				// text node
				if (!n.nodeValue.match(/[^ \f\n\r\t\v]/)) {
					// pure whitespace text node
					var nxt = n.nextSibling;
					e.removeChild(n);
					n = nxt;
				}
				else {
					n = n.nextSibling;
				}
			}
			else if (n.nodeType === 1) {
				// element node
				this.removeWhite(n);
				n = n.nextSibling;
			}
			else {
				// any other node
				n = n.nextSibling;
			}
		}
		return e;
	}
};/*
**
 * formatter for values but most of the values if for jqGrid
 * Some of this was inspired and based on how YUI does the table datagrid but in jQuery fashion
 * we are trying to keep it as light as possible
 * Joshua Burnett josh@9ci.com
 * http://www.greenbill.com
 *
 * Changes from Tony Tomov tony@trirand.com
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
 *
**/
/*jshint eqeqeq:false */
/*global jQuery */

(function($) {
"use strict";
	$.fmatter = {};
	//opts can be id:row id for the row, rowdata:the data for the row, colmodel:the column model for this column
	//example {id:1234,}
	$.extend($.fmatter,{
		isBoolean : function(o) {
			return typeof o === 'boolean';
		},
		isObject : function(o) {
			return (o && (typeof o === 'object' || $.isFunction(o))) || false;
		},
		isString : function(o) {
			return typeof o === 'string';
		},
		isNumber : function(o) {
			return typeof o === 'number' && isFinite(o);
		},
		isValue : function (o) {
			return (this.isObject(o) || this.isString(o) || this.isNumber(o) || this.isBoolean(o));
		},
		isEmpty : function(o) {
			if(!this.isString(o) && this.isValue(o)) {
				return false;
			}
			if (!this.isValue(o)){
				return true;
			}
			o = $.trim(o).replace(/\&nbsp\;/ig,'').replace(/\&#160\;/ig,'');
			return o==="";
		}
	});
	$.fn.fmatter = function(formatType, cellval, opts, rwd, act) {
		// build main options before element iteration
		var v=cellval;
		opts = $.extend({}, $.jgrid.formatter, opts);

		try {
			v = $.fn.fmatter[formatType].call(this, cellval, opts, rwd, act);
		} catch(fe){}
		return v;
	};
	$.fmatter.util = {
		// Taken from YAHOO utils
		NumberFormat : function(nData,opts) {
			if(!$.fmatter.isNumber(nData)) {
				nData *= 1;
			}
			if($.fmatter.isNumber(nData)) {
				var bNegative = (nData < 0);
				var sOutput = String(nData);
				var sDecimalSeparator = opts.decimalSeparator || ".";
				var nDotIndex;
				if($.fmatter.isNumber(opts.decimalPlaces)) {
					// Round to the correct decimal place
					var nDecimalPlaces = opts.decimalPlaces;
					var nDecimal = Math.pow(10, nDecimalPlaces);
					sOutput = String(Math.round(nData*nDecimal)/nDecimal);
					nDotIndex = sOutput.lastIndexOf(".");
					if(nDecimalPlaces > 0) {
					// Add the decimal separator
						if(nDotIndex < 0) {
							sOutput += sDecimalSeparator;
							nDotIndex = sOutput.length-1;
						}
						// Replace the "."
						else if(sDecimalSeparator !== "."){
							sOutput = sOutput.replace(".",sDecimalSeparator);
						}
					// Add missing zeros
						while((sOutput.length - 1 - nDotIndex) < nDecimalPlaces) {
							sOutput += "0";
						}
					}
				}
				if(opts.thousandsSeparator) {
					var sThousandsSeparator = opts.thousandsSeparator;
					nDotIndex = sOutput.lastIndexOf(sDecimalSeparator);
					nDotIndex = (nDotIndex > -1) ? nDotIndex : sOutput.length;
					var sNewOutput = sOutput.substring(nDotIndex);
					var nCount = -1, i;
					for (i=nDotIndex; i>0; i--) {
						nCount++;
						if ((nCount%3 === 0) && (i !== nDotIndex) && (!bNegative || (i > 1))) {
							sNewOutput = sThousandsSeparator + sNewOutput;
						}
						sNewOutput = sOutput.charAt(i-1) + sNewOutput;
					}
					sOutput = sNewOutput;
				}
				// Prepend prefix
				sOutput = (opts.prefix) ? opts.prefix + sOutput : sOutput;
				// Append suffix
				sOutput = (opts.suffix) ? sOutput + opts.suffix : sOutput;
				return sOutput;

			}
			return nData;
		}
	};
	$.fn.fmatter.defaultFormat = function(cellval, opts) {
		return ($.fmatter.isValue(cellval) && cellval!=="" ) ?  cellval : opts.defaultValue || "&#160;";
	};
	$.fn.fmatter.email = function(cellval, opts) {
		if(!$.fmatter.isEmpty(cellval)) {
			return "<a href=\"mailto:" + cellval + "\">" + cellval + "</a>";
		}
		return $.fn.fmatter.defaultFormat(cellval,opts );
	};
	$.fn.fmatter.checkbox =function(cval, opts) {
		var op = $.extend({},opts.checkbox), ds;
		if(opts.colModel !== undefined && opts.colModel.formatoptions !== undefined) {
			op = $.extend({},op,opts.colModel.formatoptions);
		}
		if(op.disabled===true) {ds = "disabled=\"disabled\"";} else {ds="";}
		if($.fmatter.isEmpty(cval) || cval === undefined ) {cval = $.fn.fmatter.defaultFormat(cval,op);}
		cval=String(cval);
		cval=(cval+"").toLowerCase();
		var bchk = cval.search(/(false|f|0|no|n|off|undefined)/i)<0 ? " checked='checked' " : "";
		return "<input type=\"checkbox\" " + bchk  + " value=\""+ cval+"\" offval=\"no\" "+ds+ "/>";
	};
	$.fn.fmatter.link = function(cellval, opts) {
		var op = {target:opts.target};
		var target = "";
		if(opts.colModel !== undefined && opts.colModel.formatoptions !== undefined) {
			op = $.extend({},op,opts.colModel.formatoptions);
		}
		if(op.target) {target = 'target=' + op.target;}
		if(!$.fmatter.isEmpty(cellval)) {
			return "<a "+target+" href=\"" + cellval + "\">" + cellval + "</a>";
		}
		return $.fn.fmatter.defaultFormat(cellval,opts);
	};
	$.fn.fmatter.showlink = function(cellval, opts) {
		var op = {baseLinkUrl: opts.baseLinkUrl,showAction:opts.showAction, addParam: opts.addParam || "", target: opts.target, idName: opts.idName},
		target = "", idUrl;
		if(opts.colModel !== undefined && opts.colModel.formatoptions !== undefined) {
			op = $.extend({},op,opts.colModel.formatoptions);
		}
		if(op.target) {target = 'target=' + op.target;}
		idUrl = op.baseLinkUrl+op.showAction + '?'+ op.idName+'='+opts.rowId+op.addParam;
		if($.fmatter.isString(cellval) || $.fmatter.isNumber(cellval)) {	//add this one even if its blank string
			return "<a "+target+" href=\"" + idUrl + "\">" + cellval + "</a>";
		}
		return $.fn.fmatter.defaultFormat(cellval,opts);
	};
	$.fn.fmatter.integer = function(cellval, opts) {
		var op = $.extend({},opts.integer);
		if(opts.colModel !== undefined && opts.colModel.formatoptions !== undefined) {
			op = $.extend({},op,opts.colModel.formatoptions);
		}
		if($.fmatter.isEmpty(cellval)) {
			return op.defaultValue;
		}
		return $.fmatter.util.NumberFormat(cellval,op);
	};
	$.fn.fmatter.number = function (cellval, opts) {
		var op = $.extend({},opts.number);
		if(opts.colModel !== undefined && opts.colModel.formatoptions !== undefined) {
			op = $.extend({},op,opts.colModel.formatoptions);
		}
		if($.fmatter.isEmpty(cellval)) {
			return op.defaultValue;
		}
		return $.fmatter.util.NumberFormat(cellval,op);
	};
	$.fn.fmatter.currency = function (cellval, opts) {
		var op = $.extend({},opts.currency);
		if(opts.colModel !== undefined && opts.colModel.formatoptions !== undefined) {
			op = $.extend({},op,opts.colModel.formatoptions);
		}
		if($.fmatter.isEmpty(cellval)) {
			return op.defaultValue;
		}
		return $.fmatter.util.NumberFormat(cellval,op);
	};
	$.fn.fmatter.date = function (cellval, opts, rwd, act) {
		var op = $.extend({},opts.date);
		if(opts.colModel !== undefined && opts.colModel.formatoptions !== undefined) {
			op = $.extend({},op,opts.colModel.formatoptions);
		}
		if(!op.reformatAfterEdit && act === 'edit'){
			return $.fn.fmatter.defaultFormat(cellval, opts);
		}
		if(!$.fmatter.isEmpty(cellval)) {
			return $.jgrid.parseDate(op.srcformat,cellval,op.newformat,op);
		}
		return $.fn.fmatter.defaultFormat(cellval, opts);
	};
	$.fn.fmatter.select = function (cellval,opts) {
		// jqGrid specific
		cellval = String(cellval);
		var oSelect = false, ret=[], sep, delim;
		if(opts.colModel.formatoptions !== undefined){
			oSelect= opts.colModel.formatoptions.value;
			sep = opts.colModel.formatoptions.separator === undefined ? ":" : opts.colModel.formatoptions.separator;
			delim = opts.colModel.formatoptions.delimiter === undefined ? ";" : opts.colModel.formatoptions.delimiter;
		} else if(opts.colModel.editoptions !== undefined){
			oSelect= opts.colModel.editoptions.value;
			sep = opts.colModel.editoptions.separator === undefined ? ":" : opts.colModel.editoptions.separator;
			delim = opts.colModel.editoptions.delimiter === undefined ? ";" : opts.colModel.editoptions.delimiter;
		}
		if (oSelect) {
			var	msl =  opts.colModel.editoptions.multiple === true ? true : false,
			scell = [], sv;
			if(msl) {scell = cellval.split(",");scell = $.map(scell,function(n){return $.trim(n);});}
			if ($.fmatter.isString(oSelect)) {
				// mybe here we can use some caching with care ????
				var so = oSelect.split(delim), j=0, i;
				for(i=0; i<so.length;i++){
					sv = so[i].split(sep);
					if(sv.length > 2 ) {
						sv[1] = $.map(sv,function(n,i){if(i>0) {return n;}}).join(sep);
					}
					if(msl) {
						if($.inArray(sv[0],scell)>-1) {
							ret[j] = sv[1];
							j++;
						}
					} else if($.trim(sv[0]) === $.trim(cellval)) {
						ret[0] = sv[1];
						break;
					}
				}
			} else if($.fmatter.isObject(oSelect)) {
				// this is quicker
				if(msl) {
					ret = $.map(scell, function(n){
						return oSelect[n];
					});
				} else {
					ret[0] = oSelect[cellval] || "";
				}
			}
		}
		cellval = ret.join(", ");
		return  cellval === "" ? $.fn.fmatter.defaultFormat(cellval,opts) : cellval;
	};
	$.fn.fmatter.rowactions = function(act) {
		var $tr = $(this).closest("tr.jqgrow"),
			rid = $tr.attr("id"),
			$id = $(this).closest("table.ui-jqgrid-btable").attr('id').replace(/_frozen([^_]*)$/,'$1'),
			$grid = $("#"+$id),
			$t = $grid[0],
			p = $t.p,
			cm = p.colModel[$.jgrid.getCellIndex(this)],
			$actionsDiv = cm.frozen ? $("tr#"+rid+" td:eq("+$.jgrid.getCellIndex(this)+") > div",$grid) :$(this).parent(),
			op = {
				extraparam: {}
			},
			saverow = function(rowid, res) {
				if($.isFunction(op.afterSave)) { op.afterSave.call($t, rowid, res); }
				$actionsDiv.find("div.ui-inline-edit,div.ui-inline-del").show();
				$actionsDiv.find("div.ui-inline-save,div.ui-inline-cancel").hide();
			},
			restorerow = function(rowid) {
				if($.isFunction(op.afterRestore)) { op.afterRestore.call($t, rowid); }
				$actionsDiv.find("div.ui-inline-edit,div.ui-inline-del").show();
				$actionsDiv.find("div.ui-inline-save,div.ui-inline-cancel").hide();
			};

		if (cm.formatoptions !== undefined) {
			op = $.extend(op,cm.formatoptions);
		}
		if (p.editOptions !== undefined) {
			op.editOptions = p.editOptions;
		}
		if (p.delOptions !== undefined) {
			op.delOptions = p.delOptions;
		}
		if ($tr.hasClass("jqgrid-new-row")){
			op.extraparam[p.prmNames.oper] = p.prmNames.addoper;
		}
		var actop = {
			keys: op.keys,
			oneditfunc: op.onEdit,
			successfunc: op.onSuccess,
			url: op.url,
			extraparam: op.extraparam,
			aftersavefunc: saverow,
			errorfunc: op.onError,
			afterrestorefunc: restorerow,
			restoreAfterError: op.restoreAfterError,
			mtype: op.mtype
		};
		switch(act)
		{
			case 'edit':
				$grid.jqGrid('editRow', rid, actop);
				$actionsDiv.find("div.ui-inline-edit,div.ui-inline-del").hide();
				$actionsDiv.find("div.ui-inline-save,div.ui-inline-cancel").show();
				$grid.triggerHandler("jqGridAfterGridComplete");
				break;
			case 'save':
				if ($grid.jqGrid('saveRow', rid, actop)) {
					$actionsDiv.find("div.ui-inline-edit,div.ui-inline-del").show();
					$actionsDiv.find("div.ui-inline-save,div.ui-inline-cancel").hide();
					$grid.triggerHandler("jqGridAfterGridComplete");
				}
				break;
			case 'cancel' :
				$grid.jqGrid('restoreRow', rid, restorerow);
				$actionsDiv.find("div.ui-inline-edit,div.ui-inline-del").show();
				$actionsDiv.find("div.ui-inline-save,div.ui-inline-cancel").hide();
				$grid.triggerHandler("jqGridAfterGridComplete");
				break;
			case 'del':
				$grid.jqGrid('delGridRow', rid, op.delOptions);
				break;
			case 'formedit':
				$grid.jqGrid('setSelection', rid);
				$grid.jqGrid('editGridRow', rid, op.editOptions);
				break;
		}
	};
	$.fn.fmatter.actions = function(cellval,opts) {
		var op={keys:false, editbutton:true, delbutton:true, editformbutton: false},
			rowid=opts.rowId, str="",ocl;
		if(opts.colModel.formatoptions !== undefined) {
			op = $.extend(op,opts.colModel.formatoptions);
		}
		if(rowid === undefined || $.fmatter.isEmpty(rowid)) {return "";}
		if(op.editformbutton){
			ocl = "id='jEditButton_"+rowid+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'formedit'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";
			str += "<div title='"+$.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+ocl+"><span class='ui-icon ui-icon-pencil'></span></div>";
		} else if(op.editbutton){
			ocl = "id='jEditButton_"+rowid+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'edit'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover') ";
			str += "<div title='"+$.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+ocl+"><span class='ui-icon ui-icon-pencil'></span></div>";
		}
		if(op.delbutton) {
			ocl = "id='jDeleteButton_"+rowid+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'del'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";
			str += "<div title='"+$.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+ocl+"><span class='ui-icon ui-icon-trash'></span></div>";
		}
		ocl = "id='jSaveButton_"+rowid+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'save'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";
		str += "<div title='"+$.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save' "+ocl+"><span class='ui-icon ui-icon-disk'></span></div>";
		ocl = "id='jCancelButton_"+rowid+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'cancel'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";
		str += "<div title='"+$.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel' "+ocl+"><span class='ui-icon ui-icon-cancel'></span></div>";
		return "<div style='margin-left:8px;'>" + str + "</div>";
	};
	$.unformat = function (cellval,options,pos,cnt) {
		// specific for jqGrid only
		var ret, formatType = options.colModel.formatter,
		op =options.colModel.formatoptions || {}, sep,
		re = /([\.\*\_\'\(\)\{\}\+\?\\])/g,
		unformatFunc = options.colModel.unformat||($.fn.fmatter[formatType] && $.fn.fmatter[formatType].unformat);
		if(unformatFunc !== undefined && $.isFunction(unformatFunc) ) {
			ret = unformatFunc.call(this, $(cellval).text(), options, cellval);
		} else if(formatType !== undefined && $.fmatter.isString(formatType) ) {
			var opts = $.jgrid.formatter || {}, stripTag;
			switch(formatType) {
				case 'integer' :
					op = $.extend({},opts.integer,op);
					sep = op.thousandsSeparator.replace(re,"\\$1");
					stripTag = new RegExp(sep, "g");
					ret = $(cellval).text().replace(stripTag,'');
					break;
				case 'number' :
					op = $.extend({},opts.number,op);
					sep = op.thousandsSeparator.replace(re,"\\$1");
					stripTag = new RegExp(sep, "g");
					ret = $(cellval).text().replace(stripTag,"").replace(op.decimalSeparator,'.');
					break;
				case 'currency':
					op = $.extend({},opts.currency,op);
					sep = op.thousandsSeparator.replace(re,"\\$1");
					stripTag = new RegExp(sep, "g");
					ret = $(cellval).text();
					if (op.prefix && op.prefix.length) {
						ret = ret.substr(op.prefix.length);
					}
					if (op.suffix && op.suffix.length) {
						ret = ret.substr(0, ret.length - op.suffix.length);
					}
					ret = ret.replace(stripTag,'').replace(op.decimalSeparator,'.');
					break;
				case 'checkbox':
					var cbv = (options.colModel.editoptions) ? options.colModel.editoptions.value.split(":") : ["Yes","No"];
					ret = $('input',cellval).is(":checked") ? cbv[0] : cbv[1];
					break;
				case 'select' :
					ret = $.unformat.select(cellval,options,pos,cnt);
					break;
				case 'actions':
					return "";
				default:
					ret= $(cellval).text();
			}
		}
		return ret !== undefined ? ret : cnt===true ? $(cellval).text() : $.jgrid.htmlDecode($(cellval).html());
	};
	$.unformat.select = function (cellval,options,pos,cnt) {
		// Spacial case when we have local data and perform a sort
		// cnt is set to true only in sortDataArray
		var ret = [];
		var cell = $(cellval).text();
		if(cnt===true) {return cell;}
		var op = $.extend({}, options.colModel.formatoptions !== undefined ? options.colModel.formatoptions: options.colModel.editoptions),
		sep = op.separator === undefined ? ":" : op.separator,
		delim = op.delimiter === undefined ? ";" : op.delimiter;

		if(op.value){
			var oSelect = op.value,
			msl =  op.multiple === true ? true : false,
			scell = [], sv;
			if(msl) {scell = cell.split(",");scell = $.map(scell,function(n){return $.trim(n);});}
			if ($.fmatter.isString(oSelect)) {
				var so = oSelect.split(delim), j=0, i;
				for(i=0; i<so.length;i++){
					sv = so[i].split(sep);
					if(sv.length > 2 ) {
						sv[1] = $.map(sv,function(n,i){if(i>0) {return n;}}).join(sep);
					}
					if(msl) {
						if($.inArray(sv[1],scell)>-1) {
							ret[j] = sv[0];
							j++;
						}
					} else if($.trim(sv[1]) === $.trim(cell)) {
						ret[0] = sv[0];
						break;
					}
				}
			} else if($.fmatter.isObject(oSelect) || $.isArray(oSelect) ){
				if(!msl) {scell[0] =  cell;}
				ret = $.map(scell, function(n){
					var rv;
					$.each(oSelect, function(i,val){
						if (val === n) {
							rv = i;
							return false;
						}
					});
					if( rv !== undefined ) {return rv;}
				});
			}
			return ret.join(", ");
		}
		return cell || "";
	};
	$.unformat.date = function (cellval, opts) {
		var op = $.jgrid.formatter.date || {};
		if(opts.formatoptions !== undefined) {
			op = $.extend({},op,opts.formatoptions);
		}
		if(!$.fmatter.isEmpty(cellval)) {
			return $.jgrid.parseDate(op.newformat,cellval,op.srcformat,op);
		}
		return $.fn.fmatter.defaultFormat(cellval, opts);
	};
})(jQuery);
/*jshint eqeqeq:false */
/*global jQuery */
(function($){
/*
 * jqGrid common function
 * Tony Tomov tony@trirand.com
 * http://trirand.com/blog/
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
*/
"use strict";
$.extend($.jgrid,{
// Modal functions
	showModal : function(h) {
		h.w.show();
	},
	closeModal : function(h) {
		h.w.hide().attr("aria-hidden","true");
		if(h.o) {h.o.remove();}
	},
	hideModal : function (selector,o) {
		o = $.extend({jqm : true, gb :''}, o || {});
		if(o.onClose) {
			var oncret = o.gb && typeof o.gb === "string" && o.gb.substr(0,6) === "#gbox_" ? o.onClose.call($("#" + o.gb.substr(6))[0], selector) : o.onClose(selector);
			if (typeof oncret === 'boolean'  && !oncret ) { return; }
		}
		if ($.fn.jqm && o.jqm === true) {
			$(selector).attr("aria-hidden","true").jqmHide();
		} else {
			if(o.gb !== '') {
				try {$(".jqgrid-overlay:first",o.gb).hide();} catch (e){}
			}
			$(selector).hide().attr("aria-hidden","true");
		}
	},
//Helper functions
	findPos : function(obj) {
		var curleft = 0, curtop = 0;
		if (obj.offsetParent) {
			do {
				curleft += obj.offsetLeft;
				curtop += obj.offsetTop;
			} while (obj = obj.offsetParent);
			//do not change obj == obj.offsetParent
		}
		return [curleft,curtop];
	},
	createModal : function(aIDs, content, p, insertSelector, posSelector, appendsel, css) {
		p = $.extend(true, {}, $.jgrid.jqModal || {}, p);
		var mw  = document.createElement('div'), rtlsup, self = this;
		css = $.extend({}, css || {});
		rtlsup = $(p.gbox).attr("dir") === "rtl" ? true : false;
		mw.className= "ui-widget ui-widget-content ui-corner-all ui-jqdialog";
		mw.id = aIDs.themodal;
		var mh = document.createElement('div');
		mh.className = "ui-jqdialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix";
		mh.id = aIDs.modalhead;
		$(mh).append("<span class='ui-jqdialog-title'>"+p.caption+"</span>");
		var ahr= $("<a class='ui-jqdialog-titlebar-close ui-corner-all'></a>")
		.hover(function(){ahr.addClass('ui-state-hover');},
			function(){ahr.removeClass('ui-state-hover');})
		.append("<span class='ui-icon ui-icon-closethick'></span>");
		$(mh).append(ahr);
		if(rtlsup) {
			mw.dir = "rtl";
			$(".ui-jqdialog-title",mh).css("float","right");
			$(".ui-jqdialog-titlebar-close",mh).css("left",0.3+"em");
		} else {
			mw.dir = "ltr";
			$(".ui-jqdialog-title",mh).css("float","left");
			$(".ui-jqdialog-titlebar-close",mh).css("right",0.3+"em");
		}
		var mc = document.createElement('div');
		$(mc).addClass("ui-jqdialog-content ui-widget-content").attr("id",aIDs.modalcontent);
		$(mc).append(content);
		mw.appendChild(mc);
		$(mw).prepend(mh);
		if(appendsel===true) { $('body').append(mw); } //append as first child in body -for alert dialog
		else if (typeof appendsel === "string") {
			$(appendsel).append(mw);
		} else {$(mw).insertBefore(insertSelector);}
		$(mw).css(css);
		if(p.jqModal === undefined) {p.jqModal = true;} // internal use
		var coord = {};
		if ( $.fn.jqm && p.jqModal === true) {
			if(p.left ===0 && p.top===0 && p.overlay) {
				var pos = [];
				pos = $.jgrid.findPos(posSelector);
				p.left = pos[0] + 4;
				p.top = pos[1] + 4;
			}
			coord.top = p.top+"px";
			coord.left = p.left;
		} else if(p.left !==0 || p.top!==0) {
			coord.left = p.left;
			coord.top = p.top+"px";
		}
		$("a.ui-jqdialog-titlebar-close",mh).click(function(){
			var oncm = $("#"+$.jgrid.jqID(aIDs.themodal)).data("onClose") || p.onClose;
			var gboxclose = $("#"+$.jgrid.jqID(aIDs.themodal)).data("gbox") || p.gbox;
			self.hideModal("#"+$.jgrid.jqID(aIDs.themodal),{gb:gboxclose,jqm:p.jqModal,onClose:oncm});
			return false;
		});
		if (p.width === 0 || !p.width) {p.width = 300;}
		if(p.height === 0 || !p.height) {p.height =200;}
		if(!p.zIndex) {
			var parentZ = $(insertSelector).parents("*[role=dialog]").filter(':first').css("z-index");
			if(parentZ) {
				p.zIndex = parseInt(parentZ,10)+2;
			} else {
				p.zIndex = 950;
			}
		}
		var rtlt = 0;
		if( rtlsup && coord.left && !appendsel) {
			rtlt = $(p.gbox).width()- (!isNaN(p.width) ? parseInt(p.width,10) :0) - 8; // to do
		// just in case
			coord.left = parseInt(coord.left,10) + parseInt(rtlt,10);
		}
		if(coord.left) { coord.left += "px"; }
		$(mw).css($.extend({
			width: isNaN(p.width) ? "auto": p.width+"px",
			height:isNaN(p.height) ? "auto" : p.height + "px",
			zIndex:p.zIndex,
			overflow: 'hidden'
		},coord))
		.attr({tabIndex: "-1","role":"dialog","aria-labelledby":aIDs.modalhead,"aria-hidden":"true"});
		if(p.drag === undefined) { p.drag=true;}
		if(p.resize === undefined) {p.resize=true;}
		if (p.drag) {
			$(mh).css('cursor','move');
			if($.fn.jqDrag) {
				$(mw).jqDrag(mh);
			} else {
				try {
					$(mw).draggable({handle: $("#"+$.jgrid.jqID(mh.id))});
				} catch (e) {}
			}
		}
		if(p.resize) {
			if($.fn.jqResize) {
				$(mw).append("<div class='jqResize ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se'></div>");
				$("#"+$.jgrid.jqID(aIDs.themodal)).jqResize(".jqResize",aIDs.scrollelm ? "#"+$.jgrid.jqID(aIDs.scrollelm) : false);
			} else {
				try {
					$(mw).resizable({handles: 'se, sw',alsoResize: aIDs.scrollelm ? "#"+$.jgrid.jqID(aIDs.scrollelm) : false});
				} catch (r) {}
			}
		}
		if(p.closeOnEscape === true){
			$(mw).keydown( function( e ) {
				if( e.which == 27 ) {
					var cone = $("#"+$.jgrid.jqID(aIDs.themodal)).data("onClose") || p.onClose;
					self.hideModal("#"+$.jgrid.jqID(aIDs.themodal),{gb:p.gbox,jqm:p.jqModal,onClose: cone});
				}
			});
		}
	},
	viewModal : function (selector,o){
		o = $.extend({
			toTop: true,
			overlay: 10,
			modal: false,
			overlayClass : 'ui-widget-overlay',
			onShow: $.jgrid.showModal,
			onHide: $.jgrid.closeModal,
			gbox: '',
			jqm : true,
			jqM : true
		}, o || {});
		if ($.fn.jqm && o.jqm === true) {
			if(o.jqM) { $(selector).attr("aria-hidden","false").jqm(o).jqmShow(); }
			else {$(selector).attr("aria-hidden","false").jqmShow();}
		} else {
			if(o.gbox !== '') {
				$(".jqgrid-overlay:first",o.gbox).show();
				$(selector).data("gbox",o.gbox);
			}
			$(selector).show().attr("aria-hidden","false");
			try{$(':input:visible',selector)[0].focus();}catch(_){}
		}
	},
	info_dialog : function(caption, content,c_b, modalopt) {
		var mopt = {
			width:290,
			height:'auto',
			dataheight: 'auto',
			drag: true,
			resize: false,
			left:250,
			top:170,
			zIndex : 1000,
			jqModal : true,
			modal : false,
			closeOnEscape : true,
			align: 'center',
			buttonalign : 'center',
			buttons : []
		// {text:'textbutt', id:"buttid", onClick : function(){...}}
		// if the id is not provided we set it like info_button_+ the index in the array - i.e info_button_0,info_button_1...
		};
		$.extend(true, mopt, $.jgrid.jqModal || {}, {caption:"<b>"+caption+"</b>"}, modalopt || {});
		var jm = mopt.jqModal, self = this;
		if($.fn.jqm && !jm) { jm = false; }
		// in case there is no jqModal
		var buttstr ="", i;
		if(mopt.buttons.length > 0) {
			for(i=0;i<mopt.buttons.length;i++) {
				if(mopt.buttons[i].id === undefined) { mopt.buttons[i].id = "info_button_"+i; }
				buttstr += "<a id='"+mopt.buttons[i].id+"' class='fm-button ui-state-default ui-corner-all'>"+mopt.buttons[i].text+"</a>";
			}
		}
		var dh = isNaN(mopt.dataheight) ? mopt.dataheight : mopt.dataheight+"px",
		cn = "text-align:"+mopt.align+";";
		var cnt = "<div id='info_id'>";
		cnt += "<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+dh+";"+cn+"'>"+content+"</div>";
		cnt += c_b ? "<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+mopt.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a id='closedialog' class='fm-button ui-state-default ui-corner-all'>"+c_b+"</a>"+buttstr+"</div>" :
			buttstr !== ""  ? "<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+mopt.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+buttstr+"</div>" : "";
		cnt += "</div>";

		try {
			if($("#info_dialog").attr("aria-hidden") === "false") {
				$.jgrid.hideModal("#info_dialog",{jqm:jm});
			}
			$("#info_dialog").remove();
		} catch (e){}
		$.jgrid.createModal({
			themodal:'info_dialog',
			modalhead:'info_head',
			modalcontent:'info_content',
			scrollelm: 'infocnt'},
			cnt,
			mopt,
			'','',true
		);
		// attach onclick after inserting into the dom
		if(buttstr) {
			$.each(mopt.buttons,function(i){
				$("#"+$.jgrid.jqID(this.id),"#info_id").bind('click',function(){mopt.buttons[i].onClick.call($("#info_dialog")); return false;});
			});
		}
		$("#closedialog", "#info_id").click(function(){
			self.hideModal("#info_dialog",{
				jqm:jm,
				onClose: $("#info_dialog").data("onClose") || mopt.onClose,
				gb: $("#info_dialog").data("gbox") || mopt.gbox
			});
			return false;
		});
		$(".fm-button","#info_dialog").hover(
			function(){$(this).addClass('ui-state-hover');},
			function(){$(this).removeClass('ui-state-hover');}
		);
		if($.isFunction(mopt.beforeOpen) ) { mopt.beforeOpen(); }
		$.jgrid.viewModal("#info_dialog",{
			onHide: function(h) {
				h.w.hide().remove();
				if(h.o) { h.o.remove(); }
			},
			modal :mopt.modal,
			jqm:jm
		});
		if($.isFunction(mopt.afterOpen) ) { mopt.afterOpen(); }
		try{ $("#info_dialog").focus();} catch (m){}
	},
	bindEv: function  (el, opt) {
		var $t = this;
		if($.isFunction(opt.dataInit)) {
			opt.dataInit.call($t,el,opt);
		}
		if(opt.dataEvents) {
			$.each(opt.dataEvents, function() {
				if (this.data !== undefined) {
					$(el).bind(this.type, this.data, this.fn);
				} else {
					$(el).bind(this.type, this.fn);
				}
			});
		}
	},
// Form Functions
	createEl : function(eltype,options,vl,autowidth, ajaxso) {
		var elem = "", $t = this;
		function setAttributes(elm, atr, exl ) {
			var exclude = ['dataInit','dataEvents','dataUrl', 'buildSelect','sopt', 'searchhidden', 'defaultValue', 'attr', 'custom_element', 'custom_value'];
			if(exl !== undefined && $.isArray(exl)) {
				$.merge(exclude, exl);
			}
			$.each(atr, function(key, value){
				if($.inArray(key, exclude) === -1) {
					$(elm).attr(key,value);
				}
			});
			if(!atr.hasOwnProperty('id')) {
				$(elm).attr('id', $.jgrid.randId());
			}
		}
		switch (eltype)
		{
			case "textarea" :
				elem = document.createElement("textarea");
				if(autowidth) {
					if(!options.cols) { $(elem).css({width:"98%"});}
				} else if (!options.cols) { options.cols = 20; }
				if(!options.rows) { options.rows = 2; }
				if(vl==='&nbsp;' || vl==='&#160;' || (vl.length===1 && vl.charCodeAt(0)===160)) {vl="";}
				elem.value = vl;
				setAttributes(elem, options);
				$(elem).attr({"role":"textbox","multiline":"true"});
			break;
			case "checkbox" : //what code for simple checkbox
				elem = document.createElement("input");
				elem.type = "checkbox";
				if( !options.value ) {
					var vl1 = (vl+"").toLowerCase();
					if(vl1.search(/(false|f|0|no|n|off|undefined)/i)<0 && vl1!=="") {
						elem.checked=true;
						elem.defaultChecked=true;
						elem.value = vl;
					} else {
						elem.value = "on";
					}
					$(elem).attr("offval","off");
				} else {
					var cbval = options.value.split(":");
					if(vl === cbval[0]) {
						elem.checked=true;
						elem.defaultChecked=true;
					}
					elem.value = cbval[0];
					$(elem).attr("offval",cbval[1]);
				}
				setAttributes(elem, options, ['value']);
				$(elem).attr("role","checkbox");
			break;
			case "select" :
				elem = document.createElement("select");
				elem.setAttribute("role","select");
				var msl, ovm = [];
				if(options.multiple===true) {
					msl = true;
					elem.multiple="multiple";
					$(elem).attr("aria-multiselectable","true");
				} else { msl = false; }
				if(options.dataUrl !== undefined) {
					var rowid = options.name ? String(options.id).substring(0, String(options.id).length - String(options.name).length - 1) : String(options.id),
						postData = options.postData || ajaxso.postData;

					if ($t.p && $t.p.idPrefix) {
						rowid = $.jgrid.stripPref($t.p.idPrefix, rowid);
					}
					$.ajax($.extend({
						url: $.isFunction(options.dataUrl) ? options.dataUrl.call($t, rowid, vl, String(options.name)) : options.dataUrl,
						type : "GET",
						dataType: "html",
						data: $.isFunction(postData) ? postData.call($t, rowid, vl, String(options.name)) : postData,
						context: {elem:elem, options:options, vl:vl},
						success: function(data){
							var ovm = [], elem = this.elem, vl = this.vl,
							options = $.extend({},this.options),
							msl = options.multiple===true,
							a = $.isFunction(options.buildSelect) ? options.buildSelect.call($t,data) : data;
							if(typeof a === 'string') {
								a = $( $.trim( a ) ).html();
							}
							if(a) {
								$(elem).append(a);
								setAttributes(elem, options, postData ? ['postData'] : undefined );
								if(options.size === undefined) { options.size =  msl ? 3 : 1;}
								if(msl) {
									ovm = vl.split(",");
									ovm = $.map(ovm,function(n){return $.trim(n);});
								} else {
									ovm[0] = $.trim(vl);
								}
								//$(elem).attr(options);
								setTimeout(function(){
									$("option",elem).each(function(i){
										//if(i===0) { this.selected = ""; }
										// fix IE8/IE7 problem with selecting of the first item on multiple=true
										if (i === 0 && elem.multiple) { this.selected = false; }
										$(this).attr("role","option");
										if($.inArray($.trim($(this).text()),ovm) > -1 || $.inArray($.trim($(this).val()),ovm) > -1 ) {
											this.selected= "selected";
										}
									});
								},0);
							}
						}
					},ajaxso || {}));
				} else if(options.value) {
					var i;
					if(options.size === undefined) {
						options.size = msl ? 3 : 1;
					}
					if(msl) {
						ovm = vl.split(",");
						ovm = $.map(ovm,function(n){return $.trim(n);});
					}
					if(typeof options.value === 'function') { options.value = options.value(); }
					var so,sv, ov,
					sep = options.separator === undefined ? ":" : options.separator,
					delim = options.delimiter === undefined ? ";" : options.delimiter;
					if(typeof options.value === 'string') {
						so = options.value.split(delim);
						for(i=0; i<so.length;i++){
							sv = so[i].split(sep);
							if(sv.length > 2 ) {
								sv[1] = $.map(sv,function(n,ii){if(ii>0) { return n;} }).join(sep);
							}
							ov = document.createElement("option");
							ov.setAttribute("role","option");
							ov.value = sv[0]; ov.innerHTML = sv[1];
							elem.appendChild(ov);
							if (!msl &&  ($.trim(sv[0]) === $.trim(vl) || $.trim(sv[1]) === $.trim(vl))) { ov.selected ="selected"; }
							if (msl && ($.inArray($.trim(sv[1]), ovm)>-1 || $.inArray($.trim(sv[0]), ovm)>-1)) {ov.selected ="selected";}
						}
					} else if (typeof options.value === 'object') {
						var oSv = options.value, key;
						for (key in oSv) {
							if (oSv.hasOwnProperty(key ) ){
								ov = document.createElement("option");
								ov.setAttribute("role","option");
								ov.value = key; ov.innerHTML = oSv[key];
								elem.appendChild(ov);
								if (!msl &&  ( $.trim(key) === $.trim(vl) || $.trim(oSv[key]) === $.trim(vl)) ) { ov.selected ="selected"; }
								if (msl && ($.inArray($.trim(oSv[key]),ovm)>-1 || $.inArray($.trim(key),ovm)>-1)) { ov.selected ="selected"; }
							}
						}
					}
					setAttributes(elem, options, ['value']);
				}
			break;
			case "text" :
			case "password" :
			case "button" :
				var role;
				if(eltype==="button") { role = "button"; }
				else { role = "textbox"; }
				elem = document.createElement("input");
				elem.type = eltype;
				elem.value = vl;
				setAttributes(elem, options);
				if(eltype !== "button"){
					if(autowidth) {
						if(!options.size) { $(elem).css({width:"98%"}); }
					} else if (!options.size) { options.size = 20; }
				}
				$(elem).attr("role",role);
			break;
			case "image" :
			case "file" :
				elem = document.createElement("input");
				elem.type = eltype;
				setAttributes(elem, options);
				break;
			case "custom" :
				elem = document.createElement("span");
				try {
					if($.isFunction(options.custom_element)) {
						var celm = options.custom_element.call($t,vl,options);
						if(celm) {
							celm = $(celm).addClass("customelement").attr({id:options.id,name:options.name});
							$(elem).empty().append(celm);
						} else {
							throw "e2";
						}
					} else {
						throw "e1";
					}
				} catch (e) {
					if (e==="e1") { $.jgrid.info_dialog($.jgrid.errors.errcap,"function 'custom_element' "+$.jgrid.edit.msg.nodefined, $.jgrid.edit.bClose);}
					if (e==="e2") { $.jgrid.info_dialog($.jgrid.errors.errcap,"function 'custom_element' "+$.jgrid.edit.msg.novalue,$.jgrid.edit.bClose);}
					else { $.jgrid.info_dialog($.jgrid.errors.errcap,typeof e==="string"?e:e.message,$.jgrid.edit.bClose); }
				}
			break;
		}
		return elem;
	},
// Date Validation Javascript
	checkDate : function (format, date) {
		var daysInFebruary = function(year){
		// February has 29 days in any year evenly divisible by four,
		// EXCEPT for centurial years which are not also divisible by 400.
			return (((year % 4 === 0) && ( year % 100 !== 0 || (year % 400 === 0))) ? 29 : 28 );
		},
		tsp = {}, sep;
		format = format.toLowerCase();
		//we search for /,-,. for the date separator
		if(format.indexOf("/") !== -1) {
			sep = "/";
		} else if(format.indexOf("-") !== -1) {
			sep = "-";
		} else if(format.indexOf(".") !== -1) {
			sep = ".";
		} else {
			sep = "/";
		}
		format = format.split(sep);
		date = date.split(sep);
		if (date.length !== 3) { return false; }
		var j=-1,yln, dln=-1, mln=-1, i;
		for(i=0;i<format.length;i++){
			var dv =  isNaN(date[i]) ? 0 : parseInt(date[i],10);
			tsp[format[i]] = dv;
			yln = format[i];
			if(yln.indexOf("y") !== -1) { j=i; }
			if(yln.indexOf("m") !== -1) { mln=i; }
			if(yln.indexOf("d") !== -1) { dln=i; }
		}
		if (format[j] === "y" || format[j] === "yyyy") {
			yln=4;
		} else if(format[j] ==="yy"){
			yln = 2;
		} else {
			yln = -1;
		}
		var daysInMonth = [0,31,29,31,30,31,30,31,31,30,31,30,31],
		strDate;
		if (j === -1) {
			return false;
		}
			strDate = tsp[format[j]].toString();
			if(yln === 2 && strDate.length === 1) {yln = 1;}
			if (strDate.length !== yln || (tsp[format[j]]===0 && date[j]!=="00")){
				return false;
			}
		if(mln === -1) {
			return false;
		}
			strDate = tsp[format[mln]].toString();
			if (strDate.length<1 || tsp[format[mln]]<1 || tsp[format[mln]]>12){
				return false;
			}
		if(dln === -1) {
			return false;
		}
			strDate = tsp[format[dln]].toString();
			if (strDate.length<1 || tsp[format[dln]]<1 || tsp[format[dln]]>31 || (tsp[format[mln]]===2 && tsp[format[dln]]>daysInFebruary(tsp[format[j]])) || tsp[format[dln]] > daysInMonth[tsp[format[mln]]]){
				return false;
			}
		return true;
	},
	isEmpty : function(val)
	{
		if (val.match(/^\s+$/) || val === "")	{
			return true;
		}
			return false;
	},
	checkTime : function(time){
	// checks only hh:ss (and optional am/pm)
		var re = /^(\d{1,2}):(\d{2})([apAP][Mm])?$/,regs;
		if(!$.jgrid.isEmpty(time))
		{
			regs = time.match(re);
			if(regs) {
				if(regs[3]) {
					if(regs[1] < 1 || regs[1] > 12) { return false; }
				} else {
					if(regs[1] > 23) { return false; }
				}
				if(regs[2] > 59) {
					return false;
				}
			} else {
				return false;
			}
		}
		return true;
	},
	checkValues : function(val, valref, customobject, nam) {
		var edtrul,i, nm, dft, len, g = this, cm = g.p.colModel;
		if(customobject === undefined) {
			if(typeof valref==='string'){
				for( i =0, len=cm.length;i<len; i++){
					if(cm[i].name===valref) {
						edtrul = cm[i].editrules;
						valref = i;
						if(cm[i].formoptions != null) { nm = cm[i].formoptions.label; }
						break;
					}
				}
			} else if(valref >=0) {
				edtrul = cm[valref].editrules;
			}
		} else {
			edtrul = customobject;
			nm = nam===undefined ? "_" : nam;
		}
		if(edtrul) {
			if(!nm) { nm = g.p.colNames != null ? g.p.colNames[valref] : cm[valref].label; }
			if(edtrul.required === true) {
				if( $.jgrid.isEmpty(val) )  { return [false,nm+": "+$.jgrid.edit.msg.required,""]; }
			}
			// force required
			var rqfield = edtrul.required === false ? false : true;
			if(edtrul.number === true) {
				if( !(rqfield === false && $.jgrid.isEmpty(val)) ) {
					if(isNaN(val)) { return [false,nm+": "+$.jgrid.edit.msg.number,""]; }
				}
			}
			if(edtrul.minValue !== undefined && !isNaN(edtrul.minValue)) {
				if (parseFloat(val) < parseFloat(edtrul.minValue) ) { return [false,nm+": "+$.jgrid.edit.msg.minValue+" "+edtrul.minValue,""];}
			}
			if(edtrul.maxValue !== undefined && !isNaN(edtrul.maxValue)) {
				if (parseFloat(val) > parseFloat(edtrul.maxValue) ) { return [false,nm+": "+$.jgrid.edit.msg.maxValue+" "+edtrul.maxValue,""];}
			}
			var filter;
			if(edtrul.email === true) {
				if( !(rqfield === false && $.jgrid.isEmpty(val)) ) {
				// taken from $ Validate plugin
					filter = /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;
					if(!filter.test(val)) {return [false,nm+": "+$.jgrid.edit.msg.email,""];}
				}
			}
			if(edtrul.integer === true) {
				if( !(rqfield === false && $.jgrid.isEmpty(val)) ) {
					if(isNaN(val)) { return [false,nm+": "+$.jgrid.edit.msg.integer,""]; }
					if ((val % 1 !== 0) || (val.indexOf('.') !== -1)) { return [false,nm+": "+$.jgrid.edit.msg.integer,""];}
				}
			}
			if(edtrul.date === true) {
				if( !(rqfield === false && $.jgrid.isEmpty(val)) ) {
					if(cm[valref].formatoptions && cm[valref].formatoptions.newformat) {
						dft = cm[valref].formatoptions.newformat;
						if( $.jgrid.formatter.date.masks.hasOwnProperty(dft) ) {
							dft = $.jgrid.formatter.date.masks[dft];
						}
					} else {
						dft = cm[valref].datefmt || "Y-m-d";
					}
					if(!$.jgrid.checkDate (dft, val)) { return [false,nm+": "+$.jgrid.edit.msg.date+" - "+dft,""]; }
				}
			}
			if(edtrul.time === true) {
				if( !(rqfield === false && $.jgrid.isEmpty(val)) ) {
					if(!$.jgrid.checkTime (val)) { return [false,nm+": "+$.jgrid.edit.msg.date+" - hh:mm (am/pm)",""]; }
				}
			}
			if(edtrul.url === true) {
				if( !(rqfield === false && $.jgrid.isEmpty(val)) ) {
					filter = /^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i;
					if(!filter.test(val)) {return [false,nm+": "+$.jgrid.edit.msg.url,""];}
				}
			}
			if(edtrul.custom === true) {
				if( !(rqfield === false && $.jgrid.isEmpty(val)) ) {
					if($.isFunction(edtrul.custom_func)) {
						var ret = edtrul.custom_func.call(g,val,nm,valref);
						return $.isArray(ret) ? ret : [false,$.jgrid.edit.msg.customarray,""];
					}
					return [false,$.jgrid.edit.msg.customfcheck,""];
				}
			}
		}
		return [true,"",""];
	}
});
})(jQuery);
/*
 * jqFilter  jQuery jqGrid filter addon.
 * Copyright (c) 2011, Tony Tomov, tony@trirand.com
 * Dual licensed under the MIT and GPL licenses
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
 *
 * The work is inspired from this Stefan Pirvu
 * http://www.codeproject.com/KB/scripting/json-filtering.aspx
 *
 * The filter uses JSON entities to hold filter rules and groups. Here is an example of a filter:

{ "groupOp": "AND",
      "groups" : [
        { "groupOp": "OR",
            "rules": [
                { "field": "name", "op": "eq", "data": "England" },
                { "field": "id", "op": "le", "data": "5"}
             ]
        }
      ],
      "rules": [
        { "field": "name", "op": "eq", "data": "Romania" },
        { "field": "id", "op": "le", "data": "1"}
      ]
}
*/
/*jshint eqeqeq:false, eqnull:true, devel:true */
/*global jQuery */

(function ($) {
"use strict";

$.fn.jqFilter = function( arg ) {
	if (typeof arg === 'string') {

		var fn = $.fn.jqFilter[arg];
		if (!fn) {
			throw ("jqFilter - No such method: " + arg);
		}
		var args = $.makeArray(arguments).slice(1);
		return fn.apply(this,args);
	}

	var p = $.extend(true,{
		filter: null,
		columns: [],
		onChange : null,
		afterRedraw : null,
		checkValues : null,
		error: false,
		errmsg : "",
		errorcheck : true,
		showQuery : true,
		sopt : null,
		ops : [],
		operands : null,
		numopts : ['eq','ne', 'lt', 'le', 'gt', 'ge', 'nu', 'nn', 'in', 'ni'],
		stropts : ['eq', 'ne', 'bw', 'bn', 'ew', 'en', 'cn', 'nc', 'nu', 'nn', 'in', 'ni'],
		strarr : ['text', 'string', 'blob'],
		groupOps : [{ op: "AND", text: "AND" },	{ op: "OR",  text: "OR" }],
		groupButton : true,
		ruleButtons : true,
		direction : "ltr"
	}, $.jgrid.filter, arg || {});
	return this.each( function() {
		if (this.filter) {return;}
		this.p = p;
		// setup filter in case if they is not defined
		if (this.p.filter === null || this.p.filter === undefined) {
			this.p.filter = {
				groupOp: this.p.groupOps[0].op,
				rules: [],
				groups: []
			};
		}
		var i, len = this.p.columns.length, cl,
		isIE = /msie/i.test(navigator.userAgent) && !window.opera;

		// translating the options
		this.p.initFilter = $.extend(true,{},this.p.filter);

		// set default values for the columns if they are not set
		if( !len ) {return;}
		for(i=0; i < len; i++) {
			cl = this.p.columns[i];
			if( cl.stype ) {
				// grid compatibility
				cl.inputtype = cl.stype;
			} else if(!cl.inputtype) {
				cl.inputtype = 'text';
			}
			if( cl.sorttype ) {
				// grid compatibility
				cl.searchtype = cl.sorttype;
			} else if (!cl.searchtype) {
				cl.searchtype = 'string';
			}
			if(cl.hidden === undefined) {
				// jqGrid compatibility
				cl.hidden = false;
			}
			if(!cl.label) {
				cl.label = cl.name;
			}
			if(cl.index) {
				cl.name = cl.index;
			}
			if(!cl.hasOwnProperty('searchoptions')) {
				cl.searchoptions = {};
			}
			if(!cl.hasOwnProperty('searchrules')) {
				cl.searchrules = {};
			}

		}
		if(this.p.showQuery) {
			$(this).append("<table class='queryresult ui-widget ui-widget-content' style='display:block;max-width:440px;border:0px none;' dir='"+this.p.direction+"'><tbody><tr><td class='query'></td></tr></tbody></table>");
		}
		var getGrid = function () {
			return $("#" + $.jgrid.jqID(p.id))[0] || null;
		};
		/*
		 *Perform checking.
		 *
		*/
		var checkData = function(val, colModelItem) {
			var ret = [true,""], $t = getGrid();
			if($.isFunction(colModelItem.searchrules)) {
				ret = colModelItem.searchrules.call($t, val, colModelItem);
			} else if($.jgrid && $.jgrid.checkValues) {
				try {
					ret = $.jgrid.checkValues.call($t, val, -1, colModelItem.searchrules, colModelItem.label);
				} catch (e) {}
			}
			if(ret && ret.length && ret[0] === false) {
				p.error = !ret[0];
				p.errmsg = ret[1];
			}
		};
		/* moving to common
		randId = function() {
			return Math.floor(Math.random()*10000).toString();
		};
		*/

		this.onchange = function (  ){
			// clear any error
			this.p.error = false;
			this.p.errmsg="";
			return $.isFunction(this.p.onChange) ? this.p.onChange.call( this, this.p ) : false;
		};
		/*
		 * Redraw the filter every time when new field is added/deleted
		 * and field is  changed
		 */
		this.reDraw = function() {
			$("table.group:first",this).remove();
			var t = this.createTableForGroup(p.filter, null);
			$(this).append(t);
			if($.isFunction(this.p.afterRedraw) ) {
				this.p.afterRedraw.call(this, this.p);
			}
		};
		/*
		 * Creates a grouping data for the filter
		 * @param group - object
		 * @param parentgroup - object
		 */
		this.createTableForGroup = function(group, parentgroup) {
			var that = this,  i;
			// this table will hold all the group (tables) and rules (rows)
			var table = $("<table class='group ui-widget ui-widget-content' style='border:0px none;'><tbody></tbody></table>"),
			// create error message row
			align = "left";
			if(this.p.direction === "rtl") {
				align = "right";
				table.attr("dir","rtl");
			}
			if(parentgroup === null) {
				table.append("<tr class='error' style='display:none;'><th colspan='5' class='ui-state-error' align='"+align+"'></th></tr>");
			}

			var tr = $("<tr></tr>");
			table.append(tr);
			// this header will hold the group operator type and group action buttons for
			// creating subgroup "+ {}", creating rule "+" or deleting the group "-"
			var th = $("<th colspan='5' align='"+align+"'></th>");
			tr.append(th);

			if(this.p.ruleButtons === true) {
			// dropdown for: choosing group operator type
			var groupOpSelect = $("<select class='opsel'></select>");
			th.append(groupOpSelect);
			// populate dropdown with all posible group operators: or, and
			var str= "", selected;
			for (i = 0; i < p.groupOps.length; i++) {
				selected =  group.groupOp === that.p.groupOps[i].op ? " selected='selected'" :"";
				str += "<option value='"+that.p.groupOps[i].op+"'" + selected+">"+that.p.groupOps[i].text+"</option>";
			}

			groupOpSelect
			.append(str)
			.bind('change',function() {
				group.groupOp = $(groupOpSelect).val();
				that.onchange(); // signals that the filter has changed
			});
			}
			// button for adding a new subgroup
			var inputAddSubgroup ="<span></span>";
			if(this.p.groupButton) {
				inputAddSubgroup = $("<input type='button' value='+ {}' title='Add subgroup' class='add-group'/>");
				inputAddSubgroup.bind('click',function() {
					if (group.groups === undefined ) {
						group.groups = [];
					}

					group.groups.push({
						groupOp: p.groupOps[0].op,
						rules: [],
						groups: []
					}); // adding a new group

					that.reDraw(); // the html has changed, force reDraw

					that.onchange(); // signals that the filter has changed
					return false;
				});
			}
			th.append(inputAddSubgroup);
			if(this.p.ruleButtons === true) {
			// button for adding a new rule
			var inputAddRule = $("<input type='button' value='+' title='Add rule' class='add-rule ui-add'/>"), cm;
			inputAddRule.bind('click',function() {
				//if(!group) { group = {};}
				if (group.rules === undefined) {
					group.rules = [];
				}
				for (i = 0; i < that.p.columns.length; i++) {
				// but show only serchable and serchhidden = true fields
					var searchable = (that.p.columns[i].search === undefined) ?  true: that.p.columns[i].search,
					hidden = (that.p.columns[i].hidden === true),
					ignoreHiding = (that.p.columns[i].searchoptions.searchhidden === true);
					if ((ignoreHiding && searchable) || (searchable && !hidden)) {
						cm = that.p.columns[i];
						break;
					}
				}

				var opr;
				if( cm.searchoptions.sopt ) {opr = cm.searchoptions.sopt;}
				else if(that.p.sopt) { opr= that.p.sopt; }
				else if  ( $.inArray(cm.searchtype, that.p.strarr) !== -1 ) {opr = that.p.stropts;}
				else {opr = that.p.numopts;}

				group.rules.push({
					field: cm.name,
					op: opr[0],
					data: ""
				}); // adding a new rule

				that.reDraw(); // the html has changed, force reDraw
				// for the moment no change have been made to the rule, so
				// this will not trigger onchange event
				return false;
			});
			th.append(inputAddRule);
			}

			// button for delete the group
			if (parentgroup !== null) { // ignore the first group
				var inputDeleteGroup = $("<input type='button' value='-' title='Delete group' class='delete-group'/>");
				th.append(inputDeleteGroup);
				inputDeleteGroup.bind('click',function() {
				// remove group from parent
					for (i = 0; i < parentgroup.groups.length; i++) {
						if (parentgroup.groups[i] === group) {
							parentgroup.groups.splice(i, 1);
							break;
						}
					}

					that.reDraw(); // the html has changed, force reDraw

					that.onchange(); // signals that the filter has changed
					return false;
				});
			}

			// append subgroup rows
			if (group.groups !== undefined) {
				for (i = 0; i < group.groups.length; i++) {
					var trHolderForSubgroup = $("<tr></tr>");
					table.append(trHolderForSubgroup);

					var tdFirstHolderForSubgroup = $("<td class='first'></td>");
					trHolderForSubgroup.append(tdFirstHolderForSubgroup);

					var tdMainHolderForSubgroup = $("<td colspan='4'></td>");
					tdMainHolderForSubgroup.append(this.createTableForGroup(group.groups[i], group));
					trHolderForSubgroup.append(tdMainHolderForSubgroup);
				}
			}
			if(group.groupOp === undefined) {
				group.groupOp = that.p.groupOps[0].op;
			}

			// append rules rows
			if (group.rules !== undefined) {
				for (i = 0; i < group.rules.length; i++) {
					table.append(
                       this.createTableRowForRule(group.rules[i], group)
					);
				}
			}

			return table;
		};
		/*
		 * Create the rule data for the filter
		 */
		this.createTableRowForRule = function(rule, group ) {
			// save current entity in a variable so that it could
			// be referenced in anonimous method calls

			var that=this, $t = getGrid(), tr = $("<tr></tr>"),
			//document.createElement("tr"),

			// first column used for padding
			//tdFirstHolderForRule = document.createElement("td"),
			i, op, trpar, cm, str="", selected;
			//tdFirstHolderForRule.setAttribute("class", "first");
			tr.append("<td class='first'></td>");


			// create field container
			var ruleFieldTd = $("<td class='columns'></td>");
			tr.append(ruleFieldTd);


			// dropdown for: choosing field
			var ruleFieldSelect = $("<select></select>"), ina, aoprs = [];
			ruleFieldTd.append(ruleFieldSelect);
			ruleFieldSelect.bind('change',function() {
				rule.field = $(ruleFieldSelect).val();

				trpar = $(this).parents("tr:first");
				for (i=0;i<that.p.columns.length;i++) {
					if(that.p.columns[i].name ===  rule.field) {
						cm = that.p.columns[i];
						break;
					}
				}
				if(!cm) {return;}
				cm.searchoptions.id = $.jgrid.randId();
				if(isIE && cm.inputtype === "text") {
					if(!cm.searchoptions.size) {
						cm.searchoptions.size = 10;
					}
				}
				var elm = $.jgrid.createEl.call($t, cm.inputtype,cm.searchoptions, "", true, that.p.ajaxSelectOptions || {}, true);
				$(elm).addClass("input-elm");
				//that.createElement(rule, "");

				if( cm.searchoptions.sopt ) {op = cm.searchoptions.sopt;}
				else if(that.p.sopt) { op= that.p.sopt; }
				else if  ($.inArray(cm.searchtype, that.p.strarr) !== -1) {op = that.p.stropts;}
				else {op = that.p.numopts;}
				// operators
				var s ="", so = 0;
				aoprs = [];
				$.each(that.p.ops, function() { aoprs.push(this.oper); });
				for ( i = 0 ; i < op.length; i++) {
					ina = $.inArray(op[i],aoprs);
					if(ina !== -1) {
						if(so===0) {
							rule.op = that.p.ops[ina].oper;
						}
						s += "<option value='"+that.p.ops[ina].oper+"'>"+that.p.ops[ina].text+"</option>";
						so++;
					}
				}
				$(".selectopts",trpar).empty().append( s );
				$(".selectopts",trpar)[0].selectedIndex = 0;
				if( $.jgrid.msie && $.jgrid.msiever() < 9) {
					var sw = parseInt($("select.selectopts",trpar)[0].offsetWidth, 10) + 1;
					$(".selectopts",trpar).width( sw );
					$(".selectopts",trpar).css("width","auto");
				}
				// data
				$(".data",trpar).empty().append( elm );
				$.jgrid.bindEv.call($t, elm, cm.searchoptions);
				$(".input-elm",trpar).bind('change',function( e ) {
					var elem = e.target;
					rule.data = elem.nodeName.toUpperCase() === "SPAN" && cm.searchoptions && $.isFunction(cm.searchoptions.custom_value) ?
						cm.searchoptions.custom_value.call($t, $(elem).children(".customelement:first"), 'get') : elem.value;
					that.onchange(); // signals that the filter has changed
				});
				setTimeout(function(){ //IE, Opera, Chrome
				rule.data = $(elm).val();
				that.onchange();  // signals that the filter has changed
				}, 0);
			});

			// populate drop down with user provided column definitions
			var j=0;
			for (i = 0; i < that.p.columns.length; i++) {
				// but show only serchable and serchhidden = true fields
				var searchable = (that.p.columns[i].search === undefined) ? true: that.p.columns[i].search,
				hidden = (that.p.columns[i].hidden === true),
				ignoreHiding = (that.p.columns[i].searchoptions.searchhidden === true);
				if ((ignoreHiding && searchable) || (searchable && !hidden)) {
					selected = "";
					if(rule.field === that.p.columns[i].name) {
						selected = " selected='selected'";
						j=i;
					}
					str += "<option value='"+that.p.columns[i].name+"'" +selected+">"+that.p.columns[i].label+"</option>";
				}
			}
			ruleFieldSelect.append( str );


			// create operator container
			var ruleOperatorTd = $("<td class='operators'></td>");
			tr.append(ruleOperatorTd);
			cm = p.columns[j];
			// create it here so it can be referentiated in the onchange event
			//var RD = that.createElement(rule, rule.data);
			cm.searchoptions.id = $.jgrid.randId();
			if(isIE && cm.inputtype === "text") {
				if(!cm.searchoptions.size) {
					cm.searchoptions.size = 10;
				}
			}
			var ruleDataInput = $.jgrid.createEl.call($t, cm.inputtype,cm.searchoptions, rule.data, true, that.p.ajaxSelectOptions || {}, true);
			if(rule.op === 'nu' || rule.op === 'nn') {
				$(ruleDataInput).attr('readonly','true');
				$(ruleDataInput).attr('disabled','true');
			} //retain the state of disabled text fields in case of null ops
			// dropdown for: choosing operator
			var ruleOperatorSelect = $("<select class='selectopts'></select>");
			ruleOperatorTd.append(ruleOperatorSelect);
			ruleOperatorSelect.bind('change',function() {
				rule.op = $(ruleOperatorSelect).val();
				trpar = $(this).parents("tr:first");
				var rd = $(".input-elm",trpar)[0];
				if (rule.op === "nu" || rule.op === "nn") { // disable for operator "is null" and "is not null"
					rule.data = "";
					if(rd.tagName.toUpperCase() !== 'SELECT') rd.value = "";
					rd.setAttribute("readonly", "true");
					rd.setAttribute("disabled", "true");
				} else {
					if(rd.tagName.toUpperCase() === 'SELECT') rule.data = rd.value;
					rd.removeAttribute("readonly");
					rd.removeAttribute("disabled");
				}

				that.onchange();  // signals that the filter has changed
			});

			// populate drop down with all available operators
			if( cm.searchoptions.sopt ) {op = cm.searchoptions.sopt;}
			else if(that.p.sopt) { op= that.p.sopt; }
			else if  ($.inArray(cm.searchtype, that.p.strarr) !== -1) {op = that.p.stropts;}
			else {op = that.p.numopts;}
			str="";
			$.each(that.p.ops, function() { aoprs.push(this.oper); });
			for ( i = 0; i < op.length; i++) {
				ina = $.inArray(op[i],aoprs);
				if(ina !== -1) {
					selected = rule.op === that.p.ops[ina].oper ? " selected='selected'" : "";
					str += "<option value='"+that.p.ops[ina].oper+"'"+selected+">"+that.p.ops[ina].text+"</option>";
				}
			}
			ruleOperatorSelect.append( str );
			// create data container
			var ruleDataTd = $("<td class='data'></td>");
			tr.append(ruleDataTd);

			// textbox for: data
			// is created previously
			//ruleDataInput.setAttribute("type", "text");
			ruleDataTd.append(ruleDataInput);
			$.jgrid.bindEv.call($t, ruleDataInput, cm.searchoptions);
			$(ruleDataInput)
			.addClass("input-elm")
			.bind('change', function() {
				rule.data = cm.inputtype === 'custom' ? cm.searchoptions.custom_value.call($t, $(this).children(".customelement:first"),'get') : $(this).val();
				that.onchange(); // signals that the filter has changed
			});

			// create action container
			var ruleDeleteTd = $("<td></td>");
			tr.append(ruleDeleteTd);

			// create button for: delete rule
			if(this.p.ruleButtons === true) {
			var ruleDeleteInput = $("<input type='button' value='-' title='Delete rule' class='delete-rule ui-del'/>");
			ruleDeleteTd.append(ruleDeleteInput);
			//$(ruleDeleteInput).html("").height(20).width(30).button({icons: {  primary: "ui-icon-minus", text:false}});
			ruleDeleteInput.bind('click',function() {
				// remove rule from group
				for (i = 0; i < group.rules.length; i++) {
					if (group.rules[i] === rule) {
						group.rules.splice(i, 1);
						break;
					}
				}

				that.reDraw(); // the html has changed, force reDraw

				that.onchange(); // signals that the filter has changed
				return false;
			});
			}
			return tr;
		};

		this.getStringForGroup = function(group) {
			var s = "(", index;
			if (group.groups !== undefined) {
				for (index = 0; index < group.groups.length; index++) {
					if (s.length > 1) {
						s += " " + group.groupOp + " ";
					}
					try {
						s += this.getStringForGroup(group.groups[index]);
					} catch (eg) {alert(eg);}
				}
			}

			if (group.rules !== undefined) {
				try{
					for (index = 0; index < group.rules.length; index++) {
						if (s.length > 1) {
							s += " " + group.groupOp + " ";
						}
						s += this.getStringForRule(group.rules[index]);
					}
				} catch (e) {alert(e);}
			}

			s += ")";

			if (s === "()") {
				return ""; // ignore groups that don't have rules
			}
			return s;
		};
		this.getStringForRule = function(rule) {
			var opUF = "",opC="", i, cm, ret, val,
			numtypes = ['int', 'integer', 'float', 'number', 'currency']; // jqGrid
			for (i = 0; i < this.p.ops.length; i++) {
				if (this.p.ops[i].oper === rule.op) {
					opUF = this.p.operands.hasOwnProperty(rule.op) ? this.p.operands[rule.op] : "";
					opC = this.p.ops[i].oper;
					break;
				}
			}
			for (i=0; i<this.p.columns.length; i++) {
				if(this.p.columns[i].name === rule.field) {
					cm = this.p.columns[i];
					break;
				}
			}
			if (cm == undefined) { return ""; }
			val = rule.data;
			if(opC === 'bw' || opC === 'bn') { val = val+"%"; }
			if(opC === 'ew' || opC === 'en') { val = "%"+val; }
			if(opC === 'cn' || opC === 'nc') { val = "%"+val+"%"; }
			if(opC === 'in' || opC === 'ni') { val = " ("+val+")"; }
			if(p.errorcheck) { checkData(rule.data, cm); }
			if($.inArray(cm.searchtype, numtypes) !== -1 || opC === 'nn' || opC === 'nu') { ret = rule.field + " " + opUF + " " + val; }
			else { ret = rule.field + " " + opUF + " \"" + val + "\""; }
			return ret;
		};
		this.resetFilter = function () {
			this.p.filter = $.extend(true,{},this.p.initFilter);
			this.reDraw();
			this.onchange();
		};
		this.hideError = function() {
			$("th.ui-state-error", this).html("");
			$("tr.error", this).hide();
		};
		this.showError = function() {
			$("th.ui-state-error", this).html(this.p.errmsg);
			$("tr.error", this).show();
		};
		this.toUserFriendlyString = function() {
			return this.getStringForGroup(p.filter);
		};
		this.toString = function() {
			// this will obtain a string that can be used to match an item.
			var that = this;
			function getStringRule(rule) {
				if(that.p.errorcheck) {
					var i, cm;
					for (i=0; i<that.p.columns.length; i++) {
						if(that.p.columns[i].name === rule.field) {
							cm = that.p.columns[i];
							break;
						}
					}
					if(cm) {checkData(rule.data, cm);}
				}
				return rule.op + "(item." + rule.field + ",'" + rule.data + "')";
			}

			function getStringForGroup(group) {
				var s = "(", index;

				if (group.groups !== undefined) {
					for (index = 0; index < group.groups.length; index++) {
						if (s.length > 1) {
							if (group.groupOp === "OR") {
								s += " || ";
							}
							else {
								s += " && ";
							}
						}
						s += getStringForGroup(group.groups[index]);
					}
				}

				if (group.rules !== undefined) {
					for (index = 0; index < group.rules.length; index++) {
						if (s.length > 1) {
							if (group.groupOp === "OR") {
								s += " || ";
							}
							else  {
								s += " && ";
							}
						}
						s += getStringRule(group.rules[index]);
					}
				}

				s += ")";

				if (s === "()") {
					return ""; // ignore groups that don't have rules
				}
				return s;
			}

			return getStringForGroup(this.p.filter);
		};

		// Here we init the filter
		this.reDraw();

		if(this.p.showQuery) {
			this.onchange();
		}
		// mark is as created so that it will not be created twice on this element
		this.filter = true;
	});
};
$.extend($.fn.jqFilter,{
	/*
	 * Return SQL like string. Can be used directly
	 */
	toSQLString : function()
	{
		var s ="";
		this.each(function(){
			s = this.toUserFriendlyString();
		});
		return s;
	},
	/*
	 * Return filter data as object.
	 */
	filterData : function()
	{
		var s;
		this.each(function(){
			s = this.p.filter;
		});
		return s;

	},
	getParameter : function (param) {
		if(param !== undefined) {
			if (this.p.hasOwnProperty(param) ) {
				return this.p[param];
			}
		}
		return this.p;
	},
	resetFilter: function() {
		return this.each(function(){
			this.resetFilter();
		});
	},
	addFilter: function (pfilter) {
		if (typeof pfilter === "string") {
			pfilter = $.jgrid.parse( pfilter );
	}
		this.each(function(){
			this.p.filter = pfilter;
			this.reDraw();
			this.onchange();
		});
	}

});
})(jQuery);
/*jshint eqeqeq:false, eqnull:true, devel:true */
/*global xmlJsonClass, jQuery */
(function($){
/**
 * jqGrid extension for form editing Grid Data
 * Tony Tomov tony@trirand.com
 * http://trirand.com/blog/
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
**/
"use strict";
var rp_ge = {};
$.jgrid.extend({
	searchGrid : function (p) {
		p = $.extend(true, {
			recreateFilter: false,
			drag: true,
			sField:'searchField',
			sValue:'searchString',
			sOper: 'searchOper',
			sFilter: 'filters',
			loadDefaults: true, // this options activates loading of default filters from grid's postData for Multipe Search only.
			beforeShowSearch: null,
			afterShowSearch : null,
			onInitializeSearch: null,
			afterRedraw : null,
			afterChange: null,
			closeAfterSearch : false,
			closeAfterReset: false,
			closeOnEscape : false,
			searchOnEnter : false,
			multipleSearch : false,
			multipleGroup : false,
			//cloneSearchRowOnAdd: true,
			top : 0,
			left: 0,
			jqModal : true,
			modal: false,
			resize : true,
			width: 450,
			height: 'auto',
			dataheight: 'auto',
			showQuery: false,
			errorcheck : true,
			sopt: null,
			stringResult: undefined,
			onClose : null,
			onSearch : null,
			onReset : null,
			toTop : true,
			overlay : 30,
			columns : [],
			tmplNames : null,
			tmplFilters : null,
			tmplLabel : ' Template: ',
			showOnLoad: false,
			layer: null,
			operands : { "eq" :"=", "ne":"<>","lt":"<","le":"<=","gt":">","ge":">=","bw":"LIKE","bn":"NOT LIKE","in":"IN","ni":"NOT IN","ew":"LIKE","en":"NOT LIKE","cn":"LIKE","nc":"NOT LIKE","nu":"IS NULL","nn":"ISNOT NULL"}
		}, $.jgrid.search, p || {});
		return this.each(function() {
			var $t = this;
			if(!$t.grid) {return;}
			var fid = "fbox_"+$t.p.id,
			showFrm = true,
			mustReload = true,
			IDs = {themodal:'searchmod'+fid,modalhead:'searchhd'+fid,modalcontent:'searchcnt'+fid, scrollelm : fid},
			defaultFilters  = $t.p.postData[p.sFilter];
			if(typeof defaultFilters === "string") {
				defaultFilters = $.jgrid.parse( defaultFilters );
			}
			if(p.recreateFilter === true) {
				$("#"+$.jgrid.jqID(IDs.themodal)).remove();
			}
			function showFilter(_filter) {
				showFrm = $($t).triggerHandler("jqGridFilterBeforeShow", [_filter]);
				if(showFrm === undefined) {
					showFrm = true;
				}
				if(showFrm && $.isFunction(p.beforeShowSearch)) {
					showFrm = p.beforeShowSearch.call($t,_filter);
				}
				if(showFrm) {
					$.jgrid.viewModal("#"+$.jgrid.jqID(IDs.themodal),{gbox:"#gbox_"+$.jgrid.jqID(fid),jqm:p.jqModal, modal:p.modal, overlay: p.overlay, toTop: p.toTop});
					$($t).triggerHandler("jqGridFilterAfterShow", [_filter]);
					if($.isFunction(p.afterShowSearch)) {
						p.afterShowSearch.call($t, _filter);
					}
				}
			}
			if ( $("#"+$.jgrid.jqID(IDs.themodal))[0] !== undefined ) {
				showFilter($("#fbox_"+$.jgrid.jqID(+$t.p.id)));
			} else {
				var fil = $("<div><div id='"+fid+"' class='searchFilter' style='overflow:auto'></div></div>").insertBefore("#gview_"+$.jgrid.jqID($t.p.id)),
				align = "left", butleft ="";
				if($t.p.direction === "rtl") {
					align = "right";
					butleft = " style='text-align:left'";
					fil.attr("dir","rtl");
				}
				var columns = $.extend([],$t.p.colModel),
				bS  ="<a id='"+fid+"_search' class='fm-button ui-state-default ui-corner-all fm-button-icon-right ui-reset'><span class='ui-icon ui-icon-search'></span>"+p.Find+"</a>",
				bC  ="<a id='"+fid+"_reset' class='fm-button ui-state-default ui-corner-all fm-button-icon-left ui-search'><span class='ui-icon ui-icon-arrowreturnthick-1-w'></span>"+p.Reset+"</a>",
				bQ = "", tmpl="", colnm, found = false, bt, cmi=-1;
				if(p.showQuery) {
					bQ ="<a id='"+fid+"_query' class='fm-button ui-state-default ui-corner-all fm-button-icon-left'><span class='ui-icon ui-icon-comment'></span>Query</a>";
				}
				if(!p.columns.length) {
					$.each(columns, function(i,n){
						if(!n.label) {
							n.label = $t.p.colNames[i];
						}
						// find first searchable column and set it if no default filter
						if(!found) {
							var searchable = (n.search === undefined) ?  true: n.search ,
							hidden = (n.hidden === true),
							ignoreHiding = (n.searchoptions && n.searchoptions.searchhidden === true);
							if ((ignoreHiding && searchable) || (searchable && !hidden)) {
								found = true;
								colnm = n.index || n.name;
								cmi =i;
							}
						}
					});
				} else {
					columns = p.columns;
					cmi = 0;
					colnm = columns[0].index || columns[0].name;
				}
				// old behaviour
				if( (!defaultFilters && colnm) || p.multipleSearch === false  ) {
					var cmop = "eq";
					if(cmi >=0 && columns[cmi].searchoptions && columns[cmi].searchoptions.sopt) {
						cmop = columns[cmi].searchoptions.sopt[0];
					} else if(p.sopt && p.sopt.length) {
						cmop = p.sopt[0];
					}
					defaultFilters = {groupOp: "AND", rules: [{field: colnm, op: cmop, data: ""}]};
				}
				found = false;
				if(p.tmplNames && p.tmplNames.length) {
					found = true;
					tmpl = p.tmplLabel;
					tmpl += "<select class='ui-template'>";
					tmpl += "<option value='default'>Default</option>";
					$.each(p.tmplNames, function(i,n){
						tmpl += "<option value='"+i+"'>"+n+"</option>";
					});
					tmpl += "</select>";
				}

				bt = "<table class='EditTable' style='border:0px none;margin-top:5px' id='"+fid+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:"+align+"'>"+bC+tmpl+"</td><td class='EditButton' "+butleft+">"+bQ+bS+"</td></tr></tbody></table>";
				fid = $.jgrid.jqID( fid);
				$("#"+fid).jqFilter({
					columns : columns,
					filter: p.loadDefaults ? defaultFilters : null,
					showQuery: p.showQuery,
					errorcheck : p.errorcheck,
					sopt: p.sopt,
					groupButton : p.multipleGroup,
					ruleButtons : p.multipleSearch,
					afterRedraw : p.afterRedraw,
					ops : p.odata,
					operands : p.operands,
					ajaxSelectOptions: $t.p.ajaxSelectOptions,
					groupOps: p.groupOps,
					onChange : function() {
						if(this.p.showQuery) {
							$('.query',this).html(this.toUserFriendlyString());
						}
						if ($.isFunction(p.afterChange)) {
							p.afterChange.call($t, $("#"+fid), p);
						}
					},
					direction : $t.p.direction,
					id: $t.p.id
				});
				fil.append( bt );
				if(found && p.tmplFilters && p.tmplFilters.length) {
					$(".ui-template", fil).bind('change', function(){
						var curtempl = $(this).val();
						if(curtempl==="default") {
							$("#"+fid).jqFilter('addFilter', defaultFilters);
						} else {
							$("#"+fid).jqFilter('addFilter', p.tmplFilters[parseInt(curtempl,10)]);
						}
						return false;
					});
				}
				if(p.multipleGroup === true) {p.multipleSearch = true;}
				$($t).triggerHandler("jqGridFilterInitialize", [$("#"+fid)]);
				if($.isFunction(p.onInitializeSearch) ) {
					p.onInitializeSearch.call($t, $("#"+fid));
				}
				p.gbox = "#gbox_"+fid;
				if (p.layer) {
					$.jgrid.createModal(IDs ,fil,p,"#gview_"+$.jgrid.jqID($t.p.id),$("#gbox_"+$.jgrid.jqID($t.p.id))[0], "#"+$.jgrid.jqID(p.layer), {position: "relative"});
				} else {
					$.jgrid.createModal(IDs ,fil,p,"#gview_"+$.jgrid.jqID($t.p.id),$("#gbox_"+$.jgrid.jqID($t.p.id))[0]);
				}
				if (p.searchOnEnter || p.closeOnEscape) {
					$("#"+$.jgrid.jqID(IDs.themodal)).keydown(function (e) {
						var $target = $(e.target);
						if (p.searchOnEnter && e.which === 13 && // 13 === $.ui.keyCode.ENTER
								!$target.hasClass('add-group') && !$target.hasClass('add-rule') &&
								!$target.hasClass('delete-group') && !$target.hasClass('delete-rule') &&
								(!$target.hasClass("fm-button") || !$target.is("[id$=_query]"))) {
							$("#"+fid+"_search").click();
							return false;
						}
						if (p.closeOnEscape && e.which === 27) { // 27 === $.ui.keyCode.ESCAPE
							$("#"+$.jgrid.jqID(IDs.modalhead)).find(".ui-jqdialog-titlebar-close").click();
							return false;
						}
					});
				}
				if(bQ) {
					$("#"+fid+"_query").bind('click', function(){
						$(".queryresult", fil).toggle();
						return false;
					});
				}
				if (p.stringResult===undefined) {
					// to provide backward compatibility, inferring stringResult value from multipleSearch
					p.stringResult = p.multipleSearch;
				}
				$("#"+fid+"_search").bind('click', function(){
					var fl = $("#"+fid), sdata={}, res, filters;
					fl.find(".input-elm:focus").change();
					filters = fl.jqFilter('filterData');
					if(p.errorcheck) {
						fl[0].hideError();
						if(!p.showQuery) {fl.jqFilter('toSQLString');}
						if(fl[0].p.error) {
							fl[0].showError();
							return false;
						}
					}

					if(p.stringResult) {
						try {
							// xmlJsonClass or JSON.stringify
							res = xmlJsonClass.toJson(filters, '', '', false);
						} catch (e) {
							try {
								res = JSON.stringify(filters);
							} catch (e2) { }
						}
						if(typeof res==="string") {
							sdata[p.sFilter] = res;
							$.each([p.sField,p.sValue, p.sOper], function() {sdata[this] = "";});
						}
					} else {
						if(p.multipleSearch) {
							sdata[p.sFilter] = filters;
							$.each([p.sField,p.sValue, p.sOper], function() {sdata[this] = "";});
						} else {
							sdata[p.sField] = filters.rules[0].field;
							sdata[p.sValue] = filters.rules[0].data;
							sdata[p.sOper] = filters.rules[0].op;
							sdata[p.sFilter] = "";
						}
					}
					$t.p.search = true;
					$.extend($t.p.postData,sdata);
					mustReload = $($t).triggerHandler("jqGridFilterSearch");
					if( mustReload === undefined) {
						mustReload = true;
					}
					if(mustReload && $.isFunction(p.onSearch) ) {
						mustReload = p.onSearch.call($t, $t.p.filters);
					}
					if (mustReload !== false) {
						$($t).trigger("reloadGrid",[{page:1}]);
					}
					if(p.closeAfterSearch) {
						$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID($t.p.id),jqm:p.jqModal,onClose: p.onClose});
					}
					return false;
				});
				$("#"+fid+"_reset").bind('click', function(){
					var sdata={},
					fl = $("#"+fid);
					$t.p.search = false;
					$t.p.resetsearch =  true;
					if(p.multipleSearch===false) {
						sdata[p.sField] = sdata[p.sValue] = sdata[p.sOper] = "";
					} else {
						sdata[p.sFilter] = "";
					}
					fl[0].resetFilter();
					if(found) {
						$(".ui-template", fil).val("default");
					}
					$.extend($t.p.postData,sdata);
					mustReload = $($t).triggerHandler("jqGridFilterReset");
					if(mustReload === undefined) {
						mustReload = true;
					}
					if(mustReload && $.isFunction(p.onReset) ) {
						mustReload = p.onReset.call($t);
					}
					if(mustReload !== false) {
						$($t).trigger("reloadGrid",[{page:1}]);
					}
					if (p.closeAfterReset) {
						$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID($t.p.id),jqm:p.jqModal,onClose: p.onClose});
					}
					return false;
				});
				showFilter($("#"+fid));
				$(".fm-button:not(.ui-state-disabled)",fil).hover(
					function(){$(this).addClass('ui-state-hover');},
					function(){$(this).removeClass('ui-state-hover');}
				);
			}
		});
	},
	editGridRow : function(rowid, p){
		p = $.extend(true, {
			top : 0,
			left: 0,
			width: 300,
			datawidth: 'auto',
			height: 'auto',
			dataheight: 'auto',
			modal: false,
			overlay : 30,
			drag: true,
			resize: true,
			url: null,
			mtype : "POST",
			clearAfterAdd :true,
			closeAfterEdit : false,
			reloadAfterSubmit : true,
			onInitializeForm: null,
			beforeInitData: null,
			beforeShowForm: null,
			afterShowForm: null,
			beforeSubmit: null,
			afterSubmit: null,
			onclickSubmit: null,
			afterComplete: null,
			onclickPgButtons : null,
			afterclickPgButtons: null,
			editData : {},
			recreateForm : false,
			jqModal : true,
			closeOnEscape : false,
			addedrow : "first",
			topinfo : '',
			bottominfo: '',
			saveicon : [],
			closeicon : [],
			savekey: [false,13],
			navkeys: [false,38,40],
			checkOnSubmit : false,
			checkOnUpdate : false,
			_savedData : {},
			processing : false,
			onClose : null,
			ajaxEditOptions : {},
			serializeEditData : null,
			viewPagerButtons : true,
			overlayClass : 'ui-widget-overlay'
		}, $.jgrid.edit, p || {});
		rp_ge[$(this)[0].p.id] = p;
		return this.each(function(){
			var $t = this;
			if (!$t.grid || !rowid) {return;}
			var gID = $t.p.id,
			frmgr = "FrmGrid_"+gID, frmtborg = "TblGrid_"+gID, frmtb = "#"+$.jgrid.jqID(frmtborg),
			IDs = {themodal:'editmod'+gID,modalhead:'edithd'+gID,modalcontent:'editcnt'+gID, scrollelm : frmgr},
			onBeforeShow = $.isFunction(rp_ge[$t.p.id].beforeShowForm) ? rp_ge[$t.p.id].beforeShowForm : false,
			onAfterShow = $.isFunction(rp_ge[$t.p.id].afterShowForm) ? rp_ge[$t.p.id].afterShowForm : false,
			onBeforeInit = $.isFunction(rp_ge[$t.p.id].beforeInitData) ? rp_ge[$t.p.id].beforeInitData : false,
			onInitializeForm = $.isFunction(rp_ge[$t.p.id].onInitializeForm) ? rp_ge[$t.p.id].onInitializeForm : false,
			showFrm = true,
			maxCols = 1, maxRows=0,	postdata, diff, frmoper;
			frmgr = $.jgrid.jqID(frmgr);
			if (rowid === "new") {
				rowid = "_empty";
				frmoper = "add";
				p.caption=rp_ge[$t.p.id].addCaption;
			} else {
				p.caption=rp_ge[$t.p.id].editCaption;
				frmoper = "edit";
			}
			if(!p.recreateForm) {
				if( $($t).data("formProp") ) {
					$.extend(rp_ge[$(this)[0].p.id], $($t).data("formProp"));
				}
			}
			var closeovrl = true;
			if(p.checkOnUpdate && p.jqModal && !p.modal) {
				closeovrl = false;
			}
			function getFormData(){
				$(frmtb+" > tbody > tr > td > .FormElement").each(function() {
					var celm = $(".customelement", this);
					if (celm.length) {
						var  elem = celm[0], nm = $(elem).attr('name');
						$.each($t.p.colModel, function(){
							if(this.name === nm && this.editoptions && $.isFunction(this.editoptions.custom_value)) {
								try {
									postdata[nm] = this.editoptions.custom_value.call($t, $("#"+$.jgrid.jqID(nm),frmtb),'get');
									if (postdata[nm] === undefined) {throw "e1";}
								} catch (e) {
									if (e==="e1") {$.jgrid.info_dialog($.jgrid.errors.errcap,"function 'custom_value' "+$.jgrid.edit.msg.novalue,$.jgrid.edit.bClose);}
									else {$.jgrid.info_dialog($.jgrid.errors.errcap,e.message,$.jgrid.edit.bClose);}
								}
								return true;
							}
						});
					} else {
					switch ($(this).get(0).type) {
						case "checkbox":
							if($(this).is(":checked")) {
								postdata[this.name]= $(this).val();
							}else {
								var ofv = $(this).attr("offval");
								postdata[this.name]= ofv;
							}
						break;
						case "select-one":
							postdata[this.name]= $("option:selected",this).val();
						break;
						case "select-multiple":
							postdata[this.name]= $(this).val();
							if(postdata[this.name]) {postdata[this.name] = postdata[this.name].join(",");}
							else {postdata[this.name] ="";}
							var selectedText = [];
							$("option:selected",this).each(
								function(i,selected){
									selectedText[i] = $(selected).text();
								}
							);
						break;
						case "password":
						case "text":
						case "textarea":
						case "button":
							postdata[this.name] = $(this).val();

						break;
					}
					if($t.p.autoencode) {postdata[this.name] = $.jgrid.htmlEncode(postdata[this.name]);}
					}
				});
				return true;
			}
			function createData(rowid,obj,tb,maxcols){
				var nm, hc,trdata, cnt=0,tmp, dc,elc, retpos=[], ind=false,
				tdtmpl = "<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>", tmpl="", i; //*2
				for (i =1; i<=maxcols;i++) {
					tmpl += tdtmpl;
				}
				if(rowid !== '_empty') {
					ind = $(obj).jqGrid("getInd",rowid);
				}
				$(obj.p.colModel).each( function(i) {
					nm = this.name;
					// hidden fields are included in the form
					if(this.editrules && this.editrules.edithidden === true) {
						hc = false;
					} else {
						hc = this.hidden === true ? true : false;
					}
					dc = hc ? "style='display:none'" : "";
					if ( nm !== 'cb' && nm !== 'subgrid' && this.editable===true && nm !== 'rn') {
						if(ind === false) {
							tmp = "";
						} else {
							if(nm === obj.p.ExpandColumn && obj.p.treeGrid === true) {
								tmp = $("td[role='gridcell']:eq("+i+")",obj.rows[ind]).text();
							} else {
								try {
									tmp =  $.unformat.call(obj, $("td[role='gridcell']:eq("+i+")",obj.rows[ind]),{rowId:rowid, colModel:this},i);
								} catch (_) {
									tmp =  (this.edittype && this.edittype === "textarea") ? $("td[role='gridcell']:eq("+i+")",obj.rows[ind]).text() : $("td[role='gridcell']:eq("+i+")",obj.rows[ind]).html();
								}
								if(!tmp || tmp === "&nbsp;" || tmp === "&#160;" || (tmp.length===1 && tmp.charCodeAt(0)===160) ) {tmp='';}
							}
						}
						var opt = $.extend({}, this.editoptions || {} ,{id:nm,name:nm}),
						frmopt = $.extend({}, {elmprefix:'',elmsuffix:'',rowabove:false,rowcontent:''}, this.formoptions || {}),
						rp = parseInt(frmopt.rowpos,10) || cnt+1,
						cp = parseInt((parseInt(frmopt.colpos,10) || 1)*2,10);
						if(rowid === "_empty" && opt.defaultValue ) {
							tmp = $.isFunction(opt.defaultValue) ? opt.defaultValue.call($t) : opt.defaultValue;
						}
						if(!this.edittype) {this.edittype = "text";}
						if($t.p.autoencode) {tmp = $.jgrid.htmlDecode(tmp);}
						elc = $.jgrid.createEl.call($t,this.edittype,opt,tmp,false,$.extend({},$.jgrid.ajaxOptions,obj.p.ajaxSelectOptions || {}));
						//if(tmp === "" && this.edittype == "checkbox") {tmp = $(elc).attr("offval");}
						//if(tmp === "" && this.edittype == "select") {tmp = $("option:eq(0)",elc).text();}
						if(rp_ge[$t.p.id].checkOnSubmit || rp_ge[$t.p.id].checkOnUpdate) {rp_ge[$t.p.id]._savedData[nm] = tmp;}
						$(elc).addClass("FormElement");
						if( $.inArray(this.edittype, ['text','textarea','password','select']) > -1) {
							$(elc).addClass("ui-widget-content ui-corner-all");
						}
						trdata = $(tb).find("tr[rowpos="+rp+"]");
						if(frmopt.rowabove) {
							var newdata = $("<tr><td class='contentinfo' colspan='"+(maxcols*2)+"'>"+frmopt.rowcontent+"</td></tr>");
							$(tb).append(newdata);
							newdata[0].rp = rp;
						}
						if ( trdata.length===0 ) {
							trdata = $("<tr "+dc+" rowpos='"+rp+"'></tr>").addClass("FormData").attr("id","tr_"+nm);
							$(trdata).append(tmpl);
							$(tb).append(trdata);
							trdata[0].rp = rp;
						}
						$("td:eq("+(cp-2)+")",trdata[0]).html(frmopt.label === undefined ? obj.p.colNames[i]: frmopt.label);
						$("td:eq("+(cp-1)+")",trdata[0]).append(frmopt.elmprefix).append(elc).append(frmopt.elmsuffix);
						if(this.edittype==='custom' && $.isFunction(opt.custom_value) ) {
							opt.custom_value.call($t, $("#"+nm,"#"+frmgr),'set',tmp);
						}
						$.jgrid.bindEv.call($t, elc, opt);
						retpos[cnt] = i;
						cnt++;
					}
				});
				if( cnt > 0) {
					var idrow = $("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+ (maxcols*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+obj.p.id+"_id' value='"+rowid+"'/></td></tr>");
					idrow[0].rp = cnt+999;
					$(tb).append(idrow);
					if(rp_ge[$t.p.id].checkOnSubmit || rp_ge[$t.p.id].checkOnUpdate) {rp_ge[$t.p.id]._savedData[obj.p.id+"_id"] = rowid;}
				}
				return retpos;
			}
			function fillData(rowid,obj,fmid){
				var nm,cnt=0,tmp, fld,opt,vl,vlc;
				if(rp_ge[$t.p.id].checkOnSubmit || rp_ge[$t.p.id].checkOnUpdate) {rp_ge[$t.p.id]._savedData = {};rp_ge[$t.p.id]._savedData[obj.p.id+"_id"]=rowid;}
				var cm = obj.p.colModel;
				if(rowid === '_empty') {
					$(cm).each(function(){
						nm = this.name;
						opt = $.extend({}, this.editoptions || {} );
						fld = $("#"+$.jgrid.jqID(nm),"#"+fmid);
						if(fld && fld.length && fld[0] !== null) {
							vl = "";
							if(this.edittype === 'custom' && $.isFunction(opt.custom_value)) {
								opt.custom_value.call($t, $("#"+nm,"#"+fmid),'set',vl);
							} else if(opt.defaultValue ) {
								vl = $.isFunction(opt.defaultValue) ? opt.defaultValue.call($t) : opt.defaultValue;
								if(fld[0].type==='checkbox') {
									vlc = vl.toLowerCase();
									if(vlc.search(/(false|f|0|no|n|off|undefined)/i)<0 && vlc!=="") {
										fld[0].checked = true;
										fld[0].defaultChecked = true;
										fld[0].value = vl;
									} else {
										fld[0].checked = false;
										fld[0].defaultChecked = false;
									}
								} else {fld.val(vl);}
							} else {
								if( fld[0].type==='checkbox' ) {
									fld[0].checked = false;
									fld[0].defaultChecked = false;
									vl = $(fld).attr("offval");
								} else if (fld[0].type && fld[0].type.substr(0,6)==='select') {
									fld[0].selectedIndex = 0;
								} else {
									fld.val(vl);
								}
							}
							if(rp_ge[$t.p.id].checkOnSubmit===true || rp_ge[$t.p.id].checkOnUpdate) {rp_ge[$t.p.id]._savedData[nm] = vl;}
						}
					});
					$("#id_g","#"+fmid).val(rowid);
					return;
				}
				var tre = $(obj).jqGrid("getInd",rowid,true);
				if(!tre) {return;}
				$('td[role="gridcell"]',tre).each( function(i) {
					nm = cm[i].name;
					// hidden fields are included in the form
					if ( nm !== 'cb' && nm !== 'subgrid' && nm !== 'rn' && cm[i].editable===true) {
						if(nm === obj.p.ExpandColumn && obj.p.treeGrid === true) {
							tmp = $(this).text();
						} else {
							try {
								tmp =  $.unformat.call(obj, $(this),{rowId:rowid, colModel:cm[i]},i);
							} catch (_) {
								tmp = cm[i].edittype==="textarea" ? $(this).text() : $(this).html();
							}
						}
						if($t.p.autoencode) {tmp = $.jgrid.htmlDecode(tmp);}
						if(rp_ge[$t.p.id].checkOnSubmit===true || rp_ge[$t.p.id].checkOnUpdate) {rp_ge[$t.p.id]._savedData[nm] = tmp;}
						nm = $.jgrid.jqID(nm);
						switch (cm[i].edittype) {
							case "password":
							case "text":
							case "button" :
							case "image":
							case "textarea":
								if(tmp === "&nbsp;" || tmp === "&#160;" || (tmp.length===1 && tmp.charCodeAt(0)===160) ) {tmp='';}
								$("#"+nm,"#"+fmid).val(tmp);
								break;
							case "select":
								var opv = tmp.split(",");
								opv = $.map(opv,function(n){return $.trim(n);});
								$("#"+nm+" option","#"+fmid).each(function(){
									if (!cm[i].editoptions.multiple && ($.trim(tmp) === $.trim($(this).text()) || opv[0] === $.trim($(this).text()) || opv[0] === $.trim($(this).val())) ){
										this.selected= true;
									} else if (cm[i].editoptions.multiple){
										if(  $.inArray($.trim($(this).text()), opv ) > -1 || $.inArray($.trim($(this).val()), opv ) > -1  ){
											this.selected = true;
										}else{
											this.selected = false;
										}
									} else {
										this.selected = false;
									}
								});
								break;
							case "checkbox":
								tmp = String(tmp);
								if(cm[i].editoptions && cm[i].editoptions.value) {
									var cb = cm[i].editoptions.value.split(":");
									if(cb[0] === tmp) {
										$("#"+nm,"#"+fmid)[$t.p.useProp ? 'prop': 'attr']({"checked":true, "defaultChecked" : true});
									} else {
										$("#"+nm,"#"+fmid)[$t.p.useProp ? 'prop': 'attr']({"checked":false, "defaultChecked" : false});
									}
								} else {
									tmp = tmp.toLowerCase();
									if(tmp.search(/(false|f|0|no|n|off|undefined)/i)<0 && tmp!=="") {
										$("#"+nm,"#"+fmid)[$t.p.useProp ? 'prop': 'attr']("checked",true);
										$("#"+nm,"#"+fmid)[$t.p.useProp ? 'prop': 'attr']("defaultChecked",true); //ie
									} else {
										$("#"+nm,"#"+fmid)[$t.p.useProp ? 'prop': 'attr']("checked", false);
										$("#"+nm,"#"+fmid)[$t.p.useProp ? 'prop': 'attr']("defaultChecked", false); //ie
									}
								}
								break;
							case 'custom' :
								try {
									if(cm[i].editoptions && $.isFunction(cm[i].editoptions.custom_value)) {
										cm[i].editoptions.custom_value.call($t, $("#"+nm,"#"+fmid),'set',tmp);
									} else {throw "e1";}
								} catch (e) {
									if (e==="e1") {$.jgrid.info_dialog($.jgrid.errors.errcap,"function 'custom_value' "+$.jgrid.edit.msg.nodefined,$.jgrid.edit.bClose);}
									else {$.jgrid.info_dialog($.jgrid.errors.errcap,e.message,$.jgrid.edit.bClose);}
								}
								break;
						}
						cnt++;
					}
				});
				if(cnt>0) {$("#id_g",frmtb).val(rowid);}
			}
			function setNulls() {
				$.each($t.p.colModel, function(i,n){
					if(n.editoptions && n.editoptions.NullIfEmpty === true) {
						if(postdata.hasOwnProperty(n.name) && postdata[n.name] === "") {
							postdata[n.name] = 'null';
						}
					}
				});
			}
			function postIt() {
				var copydata, ret=[true,"",""], onCS = {}, opers = $t.p.prmNames, idname, oper, key, selr, i;

				var retvals = $($t).triggerHandler("jqGridAddEditBeforeCheckValues", [$("#"+frmgr), frmoper]);
				if(retvals && typeof retvals === 'object') {postdata = retvals;}

				if($.isFunction(rp_ge[$t.p.id].beforeCheckValues)) {
					retvals = rp_ge[$t.p.id].beforeCheckValues.call($t, postdata,$("#"+frmgr),frmoper);
					if(retvals && typeof retvals === 'object') {postdata = retvals;}
				}
				for( key in postdata ){
					if(postdata.hasOwnProperty(key)) {
						ret = $.jgrid.checkValues.call($t,postdata[key],key);
						if(ret[0] === false) {break;}
					}
				}
				setNulls();
				if(ret[0]) {
					onCS = $($t).triggerHandler("jqGridAddEditClickSubmit", [rp_ge[$t.p.id], postdata, frmoper]);
					if( onCS === undefined && $.isFunction( rp_ge[$t.p.id].onclickSubmit)) {
						onCS = rp_ge[$t.p.id].onclickSubmit.call($t, rp_ge[$t.p.id], postdata, frmoper) || {};
					}
					ret = $($t).triggerHandler("jqGridAddEditBeforeSubmit", [postdata, $("#"+frmgr), frmoper]);
					if(ret === undefined) {
						ret = [true,"",""];
					}
					if( ret[0] && $.isFunction(rp_ge[$t.p.id].beforeSubmit))  {
						ret = rp_ge[$t.p.id].beforeSubmit.call($t,postdata,$("#"+frmgr), frmoper);
					}
				}

				if(ret[0] && !rp_ge[$t.p.id].processing) {
					rp_ge[$t.p.id].processing = true;
					$("#sData", frmtb+"_2").addClass('ui-state-active');
					oper = opers.oper;
					idname = opers.id;
					// we add to pos data array the action - the name is oper
					postdata[oper] = ($.trim(postdata[$t.p.id+"_id"]) === "_empty") ? opers.addoper : opers.editoper;
					if(postdata[oper] !== opers.addoper) {
						postdata[idname] = postdata[$t.p.id+"_id"];
					} else {
						// check to see if we have allredy this field in the form and if yes lieve it
						if( postdata[idname] === undefined ) {postdata[idname] = postdata[$t.p.id+"_id"];}
					}
					delete postdata[$t.p.id+"_id"];
					postdata = $.extend(postdata,rp_ge[$t.p.id].editData,onCS);
					if($t.p.treeGrid === true)  {
						if(postdata[oper] === opers.addoper) {
						selr = $($t).jqGrid("getGridParam", 'selrow');
							var tr_par_id = $t.p.treeGridModel === 'adjacency' ? $t.p.treeReader.parent_id_field : 'parent_id';
							postdata[tr_par_id] = selr;
						}
						for(i in $t.p.treeReader){
							if($t.p.treeReader.hasOwnProperty(i)) {
								var itm = $t.p.treeReader[i];
								if(postdata.hasOwnProperty(itm)) {
									if(postdata[oper] === opers.addoper && i === 'parent_id_field') {continue;}
									delete postdata[itm];
								}
							}
						}
					}

					postdata[idname] = $.jgrid.stripPref($t.p.idPrefix, postdata[idname]);
					var ajaxOptions = $.extend({
						url: rp_ge[$t.p.id].url || $($t).jqGrid('getGridParam','editurl'),
						type: rp_ge[$t.p.id].mtype,
						data: $.isFunction(rp_ge[$t.p.id].serializeEditData) ? rp_ge[$t.p.id].serializeEditData.call($t,postdata) :  postdata,
						complete:function(data,status){
							var key;
							postdata[idname] = $t.p.idPrefix + postdata[idname];
							if(data.status >= 300 && data.status !== 304) {
								ret[0] = false;
								ret[1] = $($t).triggerHandler("jqGridAddEditErrorTextFormat", [data, frmoper]);
								if ($.isFunction(rp_ge[$t.p.id].errorTextFormat)) {
									ret[1] = rp_ge[$t.p.id].errorTextFormat.call($t, data, frmoper);
								} else {
									ret[1] = status + " Status: '" + data.statusText + "'. Error code: " + data.status;
								}
							} else {
								// data is posted successful
								// execute aftersubmit with the returned data from server
								ret = $($t).triggerHandler("jqGridAddEditAfterSubmit", [data, postdata, frmoper]);
								if(ret === undefined) {
									ret = [true,"",""];
								}
								if( ret[0] && $.isFunction(rp_ge[$t.p.id].afterSubmit) ) {
									ret = rp_ge[$t.p.id].afterSubmit.call($t, data,postdata, frmoper);
								}
							}
							if(ret[0] === false) {
								$("#FormError>td",frmtb).html(ret[1]);
								$("#FormError",frmtb).show();
							} else {
								if($t.p.autoencode) {
									$.each(postdata,function(n,v){
										postdata[n] = $.jgrid.htmlDecode(v);
									});
								}
								//rp_ge[$t.p.id].reloadAfterSubmit = rp_ge[$t.p.id].reloadAfterSubmit && $t.p.datatype != "local";
								// the action is add
								if(postdata[oper] === opers.addoper ) {
									//id processing
									// user not set the id ret[2]
									if(!ret[2]) {ret[2] = $.jgrid.randId();}
									postdata[idname] = ret[2];
									if(rp_ge[$t.p.id].reloadAfterSubmit) {
										$($t).trigger("reloadGrid");
									} else {
										if($t.p.treeGrid === true){
											$($t).jqGrid("addChildNode",ret[2],selr,postdata );
										} else {
											$($t).jqGrid("addRowData",ret[2],postdata,p.addedrow);
										}
									}
									if(rp_ge[$t.p.id].closeAfterAdd) {
										if($t.p.treeGrid !== true){
											$($t).jqGrid("setSelection",ret[2]);
										}
										$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose: rp_ge[$t.p.id].onClose});
									} else if (rp_ge[$t.p.id].clearAfterAdd) {
										fillData("_empty",$t,frmgr);
									}
								} else {
									// the action is update
									if(rp_ge[$t.p.id].reloadAfterSubmit) {
										$($t).trigger("reloadGrid");
										if( !rp_ge[$t.p.id].closeAfterEdit ) {setTimeout(function(){$($t).jqGrid("setSelection",postdata[idname]);},1000);}
									} else {
										if($t.p.treeGrid === true) {
											$($t).jqGrid("setTreeRow", postdata[idname],postdata);
										} else {
											$($t).jqGrid("setRowData", postdata[idname],postdata);
										}
									}
									if(rp_ge[$t.p.id].closeAfterEdit) {$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose: rp_ge[$t.p.id].onClose});}
								}
								if($.isFunction(rp_ge[$t.p.id].afterComplete)) {
									copydata = data;
									setTimeout(function(){
										$($t).triggerHandler("jqGridAddEditAfterComplete", [copydata, postdata, $("#"+frmgr), frmoper]);
										rp_ge[$t.p.id].afterComplete.call($t, copydata, postdata, $("#"+frmgr), frmoper);
										copydata=null;
									},500);
								}
								if(rp_ge[$t.p.id].checkOnSubmit || rp_ge[$t.p.id].checkOnUpdate) {
									$("#"+frmgr).data("disabled",false);
									if(rp_ge[$t.p.id]._savedData[$t.p.id+"_id"] !== "_empty"){
										for(key in rp_ge[$t.p.id]._savedData) {
											if(rp_ge[$t.p.id]._savedData.hasOwnProperty(key) && postdata[key]) {
												rp_ge[$t.p.id]._savedData[key] = postdata[key];
											}
										}
									}
								}
							}
							rp_ge[$t.p.id].processing=false;
							$("#sData", frmtb+"_2").removeClass('ui-state-active');
							try{$(':input:visible',"#"+frmgr)[0].focus();} catch (e){}
						}
					}, $.jgrid.ajaxOptions, rp_ge[$t.p.id].ajaxEditOptions );

					if (!ajaxOptions.url && !rp_ge[$t.p.id].useDataProxy) {
						if ($.isFunction($t.p.dataProxy)) {
							rp_ge[$t.p.id].useDataProxy = true;
						} else {
							ret[0]=false;ret[1] += " "+$.jgrid.errors.nourl;
						}
					}
					if (ret[0]) {
						if (rp_ge[$t.p.id].useDataProxy) {
							var dpret = $t.p.dataProxy.call($t, ajaxOptions, "set_"+$t.p.id);
							if(dpret === undefined) {
								dpret = [true, ""];
							}
							if(dpret[0] === false ) {
								ret[0] = false;
								ret[1] = dpret[1] || "Error deleting the selected row!" ;
							} else {
								if(ajaxOptions.data.oper === opers.addoper && rp_ge[$t.p.id].closeAfterAdd ) {
									$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal, onClose: rp_ge[$t.p.id].onClose});
								}
								if(ajaxOptions.data.oper === opers.editoper && rp_ge[$t.p.id].closeAfterEdit ) {
									$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal, onClose: rp_ge[$t.p.id].onClose});
								}
							}
						} else {
							$.ajax(ajaxOptions);
						}
					}
				}
				if(ret[0] === false) {
					$("#FormError>td",frmtb).html(ret[1]);
					$("#FormError",frmtb).show();
					// return;
				}
			}
			function compareData(nObj, oObj ) {
				var ret = false,key;
				for (key in nObj) {
					if(nObj.hasOwnProperty(key) && nObj[key] != oObj[key]) {
						ret = true;
						break;
					}
				}
				return ret;
			}
			function checkUpdates () {
				var stat = true;
				$("#FormError",frmtb).hide();
				if(rp_ge[$t.p.id].checkOnUpdate) {
					postdata = {};
					getFormData();
					diff = compareData(postdata,rp_ge[$t.p.id]._savedData);
					if(diff) {
						$("#"+frmgr).data("disabled",true);
						$(".confirm","#"+IDs.themodal).show();
						stat = false;
					}
				}
				return stat;
			}
			function restoreInline()
			{
				var i;
				if (rowid !== "_empty" && $t.p.savedRow !== undefined && $t.p.savedRow.length > 0 && $.isFunction($.fn.jqGrid.restoreRow)) {
					for (i=0;i<$t.p.savedRow.length;i++) {
						if ($t.p.savedRow[i].id == rowid) {
							$($t).jqGrid('restoreRow',rowid);
							break;
						}
					}
				}
			}
			function updateNav(cr, posarr){
				var totr = posarr[1].length-1;
				if (cr===0) {
					$("#pData",frmtb+"_2").addClass('ui-state-disabled');
				} else if( posarr[1][cr-1] !== undefined && $("#"+$.jgrid.jqID(posarr[1][cr-1])).hasClass('ui-state-disabled')) {
						$("#pData",frmtb+"_2").addClass('ui-state-disabled');
				} else {
					$("#pData",frmtb+"_2").removeClass('ui-state-disabled');
				}

				if (cr===totr) {
					$("#nData",frmtb+"_2").addClass('ui-state-disabled');
				} else if( posarr[1][cr+1] !== undefined && $("#"+$.jgrid.jqID(posarr[1][cr+1])).hasClass('ui-state-disabled')) {
					$("#nData",frmtb+"_2").addClass('ui-state-disabled');
				} else {
					$("#nData",frmtb+"_2").removeClass('ui-state-disabled');
				}
			}
			function getCurrPos() {
				var rowsInGrid = $($t).jqGrid("getDataIDs"),
				selrow = $("#id_g",frmtb).val(),
				pos = $.inArray(selrow,rowsInGrid);
				return [pos,rowsInGrid];
			}

			var dh = isNaN(rp_ge[$(this)[0].p.id].dataheight) ? rp_ge[$(this)[0].p.id].dataheight : rp_ge[$(this)[0].p.id].dataheight+"px",
			dw = isNaN(rp_ge[$(this)[0].p.id].datawidth) ? rp_ge[$(this)[0].p.id].datawidth : rp_ge[$(this)[0].p.id].datawidth+"px",
			frm = $("<form name='FormPost' id='"+frmgr+"' class='FormGrid' onSubmit='return false;' style='width:"+dw+";overflow:auto;position:relative;height:"+dh+";'></form>").data("disabled",false),
			tbl = $("<table id='"+frmtborg+"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>");
			showFrm = $($t).triggerHandler("jqGridAddEditBeforeInitData", [$("#"+frmgr), frmoper]);
			if(showFrm === undefined) {
				showFrm = true;
			}
			if(showFrm && onBeforeInit) {
				showFrm = onBeforeInit.call($t,$("#"+frmgr),frmoper);
			}
			if(showFrm === false) {return;}
			restoreInline();
			$($t.p.colModel).each( function() {
				var fmto = this.formoptions;
				maxCols = Math.max(maxCols, fmto ? fmto.colpos || 0 : 0 );
				maxRows = Math.max(maxRows, fmto ? fmto.rowpos || 0 : 0 );
			});
			$(frm).append(tbl);
			var flr = $("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+(maxCols*2)+"'></td></tr>");
			flr[0].rp = 0;
			$(tbl).append(flr);
			//topinfo
			flr = $("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+(maxCols*2)+"'>"+rp_ge[$t.p.id].topinfo+"</td></tr>");
			flr[0].rp = 0;
			$(tbl).append(flr);
			// set the id.
			// use carefull only to change here colproperties.
			// create data
			var rtlb = $t.p.direction === "rtl" ? true :false,
			bp = rtlb ? "nData" : "pData",
			bn = rtlb ? "pData" : "nData";
			createData(rowid,$t,tbl,maxCols);
			// buttons at footer
			var bP = "<a id='"+bp+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",
			bN = "<a id='"+bn+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",
			bS  ="<a id='sData' class='fm-button ui-state-default ui-corner-all'>"+p.bSubmit+"</a>",
			bC  ="<a id='cData' class='fm-button ui-state-default ui-corner-all'>"+p.bCancel+"</a>";
			var bt = "<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+frmtborg+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(rtlb ? bN+bP : bP+bN)+"</td><td class='EditButton'>"+bS+bC+"</td></tr>";
			bt += "<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+rp_ge[$t.p.id].bottominfo+"</td></tr>";
			bt += "</tbody></table>";
			if(maxRows >  0) {
				var sd=[];
				$.each($(tbl)[0].rows,function(i,r){
					sd[i] = r;
				});
				sd.sort(function(a,b){
					if(a.rp > b.rp) {return 1;}
					if(a.rp < b.rp) {return -1;}
					return 0;
				});
				$.each(sd, function(index, row) {
					$('tbody',tbl).append(row);
				});
			}
			p.gbox = "#gbox_"+$.jgrid.jqID(gID);
			var cle = false;
			if(p.closeOnEscape===true){
				p.closeOnEscape = false;
				cle = true;
			}
			var tms = $("<div></div>").append(frm).append(bt);
			$.jgrid.createModal(IDs,tms, rp_ge[$(this)[0].p.id] ,"#gview_"+$.jgrid.jqID($t.p.id),$("#gbox_"+$.jgrid.jqID($t.p.id))[0]);
			if(rtlb) {
				$("#pData, #nData",frmtb+"_2").css("float","right");
				$(".EditButton",frmtb+"_2").css("text-align","left");
			}
			if(rp_ge[$t.p.id].topinfo) {$(".tinfo",frmtb).show();}
			if(rp_ge[$t.p.id].bottominfo) {$(".binfo",frmtb+"_2").show();}
			tms = null;bt=null;
			$("#"+$.jgrid.jqID(IDs.themodal)).keydown( function( e ) {
				var wkey = e.target;
				if ($("#"+frmgr).data("disabled")===true ) {return false;}//??
				if(rp_ge[$t.p.id].savekey[0] === true && e.which === rp_ge[$t.p.id].savekey[1]) { // save
					if(wkey.tagName !== "TEXTAREA") {
						$("#sData", frmtb+"_2").trigger("click");
						return false;
					}
				}
				if(e.which === 27) {
					if(!checkUpdates()) {return false;}
					if(cle)	{$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:p.gbox,jqm:p.jqModal, onClose: rp_ge[$t.p.id].onClose});}
					return false;
				}
				if(rp_ge[$t.p.id].navkeys[0]===true) {
					if($("#id_g",frmtb).val() === "_empty") {return true;}
					if(e.which === rp_ge[$t.p.id].navkeys[1]){ //up
						$("#pData", frmtb+"_2").trigger("click");
						return false;
					}
					if(e.which === rp_ge[$t.p.id].navkeys[2]){ //down
						$("#nData", frmtb+"_2").trigger("click");
						return false;
					}
				}
			});
			if(p.checkOnUpdate) {
				$("a.ui-jqdialog-titlebar-close span","#"+$.jgrid.jqID(IDs.themodal)).removeClass("jqmClose");
				$("a.ui-jqdialog-titlebar-close","#"+$.jgrid.jqID(IDs.themodal)).unbind("click")
				.click(function(){
					if(!checkUpdates()) {return false;}
					$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose: rp_ge[$t.p.id].onClose});
					return false;
				});
			}
			p.saveicon = $.extend([true,"left","ui-icon-disk"],p.saveicon);
			p.closeicon = $.extend([true,"left","ui-icon-close"],p.closeicon);
			// beforeinitdata after creation of the form
			if(p.saveicon[0]===true) {
				$("#sData",frmtb+"_2").addClass(p.saveicon[1] === "right" ? 'fm-button-icon-right' : 'fm-button-icon-left')
				.append("<span class='ui-icon "+p.saveicon[2]+"'></span>");
			}
			if(p.closeicon[0]===true) {
				$("#cData",frmtb+"_2").addClass(p.closeicon[1] === "right" ? 'fm-button-icon-right' : 'fm-button-icon-left')
				.append("<span class='ui-icon "+p.closeicon[2]+"'></span>");
			}
			if(rp_ge[$t.p.id].checkOnSubmit || rp_ge[$t.p.id].checkOnUpdate) {
				bS  ="<a id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+p.bYes+"</a>";
				bN  ="<a id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+p.bNo+"</a>";
				bC  ="<a id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+p.bExit+"</a>";
				var zI = p.zIndex  || 999;zI ++;
				$("<div class='"+ p.overlayClass+" jqgrid-overlay confirm' style='z-index:"+zI+";display:none;'>&#160;"+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(zI+1)+"'>"+p.saveData+"<br/><br/>"+bS+bN+bC+"</div>").insertAfter("#"+frmgr);
				$("#sNew","#"+$.jgrid.jqID(IDs.themodal)).click(function(){
					postIt();
					$("#"+frmgr).data("disabled",false);
					$(".confirm","#"+$.jgrid.jqID(IDs.themodal)).hide();
					return false;
				});
				$("#nNew","#"+$.jgrid.jqID(IDs.themodal)).click(function(){
					$(".confirm","#"+$.jgrid.jqID(IDs.themodal)).hide();
					$("#"+frmgr).data("disabled",false);
					setTimeout(function(){$(":input:visible","#"+frmgr)[0].focus();},0);
					return false;
				});
				$("#cNew","#"+$.jgrid.jqID(IDs.themodal)).click(function(){
					$(".confirm","#"+$.jgrid.jqID(IDs.themodal)).hide();
					$("#"+frmgr).data("disabled",false);
					$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose: rp_ge[$t.p.id].onClose});
					return false;
				});
			}
			// here initform - only once
			$($t).triggerHandler("jqGridAddEditInitializeForm", [$("#"+frmgr), frmoper]);
			if(onInitializeForm) {onInitializeForm.call($t,$("#"+frmgr), frmoper);}
			if(rowid==="_empty" || !rp_ge[$t.p.id].viewPagerButtons) {$("#pData,#nData",frmtb+"_2").hide();} else {$("#pData,#nData",frmtb+"_2").show();}
			$($t).triggerHandler("jqGridAddEditBeforeShowForm", [$("#"+frmgr), frmoper]);
			if(onBeforeShow) { onBeforeShow.call($t, $("#"+frmgr), frmoper);}
			$("#"+$.jgrid.jqID(IDs.themodal)).data("onClose",rp_ge[$t.p.id].onClose);
			$.jgrid.viewModal("#"+$.jgrid.jqID(IDs.themodal),{
				gbox:"#gbox_"+$.jgrid.jqID(gID),
				jqm:p.jqModal,
				overlay: p.overlay,
				modal:p.modal,
				overlayClass: p.overlayClass,
				onHide :  function(h) {
					$($t).data("formProp", {
						top:parseFloat($(h.w).css("top")),
						left : parseFloat($(h.w).css("left")),
						width : $(h.w).width(),
						height : $(h.w).height(),
						dataheight : $("#"+frmgr).height(),
						datawidth: $("#"+frmgr).width()
					});
					h.w.remove();
					if(h.o) {h.o.remove();}
				}
			});
			if(!closeovrl) {
				$("." + $.jgrid.jqID(p.overlayClass)).click(function(){
					if(!checkUpdates()) {return false;}
					$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal, onClose: rp_ge[$t.p.id].onClose});
					return false;
				});
			}
			$(".fm-button","#"+$.jgrid.jqID(IDs.themodal)).hover(
				function(){$(this).addClass('ui-state-hover');},
				function(){$(this).removeClass('ui-state-hover');}
			);
			$("#sData", frmtb+"_2").click(function(){
				postdata = {};
				$("#FormError",frmtb).hide();
				// all depend on ret array
				//ret[0] - succes
				//ret[1] - msg if not succes
				//ret[2] - the id  that will be set if reload after submit false
				getFormData();
				if(postdata[$t.p.id+"_id"] === "_empty")	{postIt();}
				else if(p.checkOnSubmit===true ) {
					diff = compareData(postdata,rp_ge[$t.p.id]._savedData);
					if(diff) {
						$("#"+frmgr).data("disabled",true);
						$(".confirm","#"+$.jgrid.jqID(IDs.themodal)).show();
					} else {
						postIt();
					}
				} else {
					postIt();
				}
				return false;
			});
			$("#cData", frmtb+"_2").click(function(){
				if(!checkUpdates()) {return false;}
				$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose: rp_ge[$t.p.id].onClose});
				return false;
			});
			$("#nData", frmtb+"_2").click(function(){
				if(!checkUpdates()) {return false;}
				$("#FormError",frmtb).hide();
				var npos = getCurrPos();
				npos[0] = parseInt(npos[0],10);
				if(npos[0] !== -1 && npos[1][npos[0]+1]) {
					$($t).triggerHandler("jqGridAddEditClickPgButtons", ['next',$("#"+frmgr),npos[1][npos[0]]]);
					var nposret;
					if($.isFunction(p.onclickPgButtons)) {
						nposret = p.onclickPgButtons.call($t, 'next',$("#"+frmgr),npos[1][npos[0]]);
						if( nposret !== undefined && nposret === false ) {return false;}
					}
					if( $("#"+$.jgrid.jqID(npos[1][npos[0]+1])).hasClass('ui-state-disabled')) {return false;}
					fillData(npos[1][npos[0]+1],$t,frmgr);
					$($t).jqGrid("setSelection",npos[1][npos[0]+1]);
					$($t).triggerHandler("jqGridAddEditAfterClickPgButtons", ['next',$("#"+frmgr),npos[1][npos[0]]]);
					if($.isFunction(p.afterclickPgButtons)) {
						p.afterclickPgButtons.call($t, 'next',$("#"+frmgr),npos[1][npos[0]+1]);
					}
					updateNav(npos[0]+1,npos);
				}
				return false;
			});
			$("#pData", frmtb+"_2").click(function(){
				if(!checkUpdates()) {return false;}
				$("#FormError",frmtb).hide();
				var ppos = getCurrPos();
				if(ppos[0] !== -1 && ppos[1][ppos[0]-1]) {
					$($t).triggerHandler("jqGridAddEditClickPgButtons", ['prev',$("#"+frmgr),ppos[1][ppos[0]]]);
					var pposret;
					if($.isFunction(p.onclickPgButtons)) {
						pposret = p.onclickPgButtons.call($t, 'prev',$("#"+frmgr),ppos[1][ppos[0]]);
						if( pposret !== undefined && pposret === false ) {return false;}
					}
					if( $("#"+$.jgrid.jqID(ppos[1][ppos[0]-1])).hasClass('ui-state-disabled')) {return false;}
					fillData(ppos[1][ppos[0]-1],$t,frmgr);
					$($t).jqGrid("setSelection",ppos[1][ppos[0]-1]);
					$($t).triggerHandler("jqGridAddEditAfterClickPgButtons", ['prev',$("#"+frmgr),ppos[1][ppos[0]]]);
					if($.isFunction(p.afterclickPgButtons)) {
						p.afterclickPgButtons.call($t, 'prev',$("#"+frmgr),ppos[1][ppos[0]-1]);
					}
					updateNav(ppos[0]-1,ppos);
				}
				return false;
			});
			$($t).triggerHandler("jqGridAddEditAfterShowForm", [$("#"+frmgr), frmoper]);
			if(onAfterShow) { onAfterShow.call($t, $("#"+frmgr), frmoper); }
			var posInit =getCurrPos();
			updateNav(posInit[0],posInit);
		});
	},
	viewGridRow : function(rowid, p){
		p = $.extend(true, {
			top : 0,
			left: 0,
			width: 0,
			datawidth: 'auto',
			height: 'auto',
			dataheight: 'auto',
			modal: false,
			overlay: 30,
			drag: true,
			resize: true,
			jqModal: true,
			closeOnEscape : false,
			labelswidth: '30%',
			closeicon: [],
			navkeys: [false,38,40],
			onClose: null,
			beforeShowForm : null,
			beforeInitData : null,
			viewPagerButtons : true,
			recreateForm : false
		}, $.jgrid.view, p || {});
		rp_ge[$(this)[0].p.id] = p;
		return this.each(function(){
			var $t = this;
			if (!$t.grid || !rowid) {return;}
			var gID = $t.p.id,
			frmgr = "ViewGrid_"+$.jgrid.jqID( gID  ), frmtb = "ViewTbl_" + $.jgrid.jqID( gID ),
			frmgr_id = "ViewGrid_"+gID, frmtb_id = "ViewTbl_"+gID,
			IDs = {themodal:'viewmod'+gID,modalhead:'viewhd'+gID,modalcontent:'viewcnt'+gID, scrollelm : frmgr},
			onBeforeInit = $.isFunction(rp_ge[$t.p.id].beforeInitData) ? rp_ge[$t.p.id].beforeInitData : false,
			showFrm = true,
			maxCols = 1, maxRows=0;
			if(!p.recreateForm) {
				if( $($t).data("viewProp") ) {
					$.extend(rp_ge[$(this)[0].p.id], $($t).data("viewProp"));
				}
			}
			function focusaref(){ //Sfari 3 issues
				if(rp_ge[$t.p.id].closeOnEscape===true || rp_ge[$t.p.id].navkeys[0]===true) {
					setTimeout(function(){$(".ui-jqdialog-titlebar-close","#"+$.jgrid.jqID(IDs.modalhead)).focus();},0);
				}
			}
			function createData(rowid,obj,tb,maxcols){
				var nm, hc,trdata, cnt=0,tmp, dc, retpos=[], ind=false, i,
				tdtmpl = "<td class='CaptionTD form-view-label ui-widget-content' width='"+p.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>", tmpl="",
				tdtmpl2 = "<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>",
				fmtnum = ['integer','number','currency'],max1 =0, max2=0 ,maxw,setme, viewfld;
				for (i=1;i<=maxcols;i++) {
					tmpl += i === 1 ? tdtmpl : tdtmpl2;
				}
				// find max number align rigth with property formatter
				$(obj.p.colModel).each( function() {
					if(this.editrules && this.editrules.edithidden === true) {
						hc = false;
					} else {
						hc = this.hidden === true ? true : false;
					}
					if(!hc && this.align==='right') {
						if(this.formatter && $.inArray(this.formatter,fmtnum) !== -1 ) {
							max1 = Math.max(max1,parseInt(this.width,10));
						} else {
							max2 = Math.max(max2,parseInt(this.width,10));
						}
					}
				});
				maxw  = max1 !==0 ? max1 : max2 !==0 ? max2 : 0;
				ind = $(obj).jqGrid("getInd",rowid);
				$(obj.p.colModel).each( function(i) {
					nm = this.name;
					setme = false;
					// hidden fields are included in the form
					if(this.editrules && this.editrules.edithidden === true) {
						hc = false;
					} else {
						hc = this.hidden === true ? true : false;
					}
					dc = hc ? "style='display:none'" : "";
					viewfld = (typeof this.viewable !== 'boolean') ? true : this.viewable;
					if ( nm !== 'cb' && nm !== 'subgrid' && nm !== 'rn' && viewfld) {
						if(ind === false) {
							tmp = "";
						} else {
							if(nm === obj.p.ExpandColumn && obj.p.treeGrid === true) {
								tmp = $("td:eq("+i+")",obj.rows[ind]).text();
							} else {
								tmp = $("td:eq("+i+")",obj.rows[ind]).html();
							}
						}
						setme = this.align === 'right' && maxw !==0 ? true : false;
						var frmopt = $.extend({},{rowabove:false,rowcontent:''}, this.formoptions || {}),
						rp = parseInt(frmopt.rowpos,10) || cnt+1,
						cp = parseInt((parseInt(frmopt.colpos,10) || 1)*2,10);
						if(frmopt.rowabove) {
							var newdata = $("<tr><td class='contentinfo' colspan='"+(maxcols*2)+"'>"+frmopt.rowcontent+"</td></tr>");
							$(tb).append(newdata);
							newdata[0].rp = rp;
						}
						trdata = $(tb).find("tr[rowpos="+rp+"]");
						if ( trdata.length===0 ) {
							trdata = $("<tr "+dc+" rowpos='"+rp+"'></tr>").addClass("FormData").attr("id","trv_"+nm);
							$(trdata).append(tmpl);
							$(tb).append(trdata);
							trdata[0].rp = rp;
						}
						$("td:eq("+(cp-2)+")",trdata[0]).html('<b>'+ (frmopt.label === undefined ? obj.p.colNames[i]: frmopt.label)+'</b>');
						$("td:eq("+(cp-1)+")",trdata[0]).append("<span>"+tmp+"</span>").attr("id","v_"+nm);
						if(setme){
							$("td:eq("+(cp-1)+") span",trdata[0]).css({'text-align':'right',width:maxw+"px"});
						}
						retpos[cnt] = i;
						cnt++;
					}
				});
				if( cnt > 0) {
					var idrow = $("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+ (maxcols*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+rowid+"'/></td></tr>");
					idrow[0].rp = cnt+99;
					$(tb).append(idrow);
				}
				return retpos;
			}
			function fillData(rowid,obj){
				var nm, hc,cnt=0,tmp,trv;
				trv = $(obj).jqGrid("getInd",rowid,true);
				if(!trv) {return;}
				$('td',trv).each( function(i) {
					nm = obj.p.colModel[i].name;
					// hidden fields are included in the form
					if(obj.p.colModel[i].editrules && obj.p.colModel[i].editrules.edithidden === true) {
						hc = false;
					} else {
						hc = obj.p.colModel[i].hidden === true ? true : false;
					}
					if ( nm !== 'cb' && nm !== 'subgrid' && nm !== 'rn') {
						if(nm === obj.p.ExpandColumn && obj.p.treeGrid === true) {
							tmp = $(this).text();
						} else {
							tmp = $(this).html();
						}
						nm = $.jgrid.jqID("v_"+nm);
						$("#"+nm+" span","#"+frmtb).html(tmp);
						if (hc) {$("#"+nm,"#"+frmtb).parents("tr:first").hide();}
						cnt++;
					}
				});
				if(cnt>0) {$("#id_g","#"+frmtb).val(rowid);}
			}
			function updateNav(cr,posarr){
				var totr = posarr[1].length-1;
				if (cr===0) {
					$("#pData","#"+frmtb+"_2").addClass('ui-state-disabled');
				} else if( posarr[1][cr-1] !== undefined && $("#"+$.jgrid.jqID(posarr[1][cr-1])).hasClass('ui-state-disabled')) {
					$("#pData",frmtb+"_2").addClass('ui-state-disabled');
				} else {
					$("#pData","#"+frmtb+"_2").removeClass('ui-state-disabled');
				}
				if (cr===totr) {
					$("#nData","#"+frmtb+"_2").addClass('ui-state-disabled');
				} else if( posarr[1][cr+1] !== undefined && $("#"+$.jgrid.jqID(posarr[1][cr+1])).hasClass('ui-state-disabled')) {
					$("#nData",frmtb+"_2").addClass('ui-state-disabled');
				} else {
					$("#nData","#"+frmtb+"_2").removeClass('ui-state-disabled');
				}
			}
			function getCurrPos() {
				var rowsInGrid = $($t).jqGrid("getDataIDs"),
				selrow = $("#id_g","#"+frmtb).val(),
				pos = $.inArray(selrow,rowsInGrid);
				return [pos,rowsInGrid];
			}

			var dh = isNaN(rp_ge[$(this)[0].p.id].dataheight) ? rp_ge[$(this)[0].p.id].dataheight : rp_ge[$(this)[0].p.id].dataheight+"px",
			dw = isNaN(rp_ge[$(this)[0].p.id].datawidth) ? rp_ge[$(this)[0].p.id].datawidth : rp_ge[$(this)[0].p.id].datawidth+"px",
			frm = $("<form name='FormPost' id='"+frmgr_id+"' class='FormGrid' style='width:"+dw+";overflow:auto;position:relative;height:"+dh+";'></form>"),
			tbl =$("<table id='"+frmtb_id+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");
			if(onBeforeInit) {
				showFrm = onBeforeInit.call($t,$("#"+frmgr));
				if(showFrm === undefined) {
					showFrm = true;
				}
			}
			if(showFrm === false) {return;}
			$($t.p.colModel).each( function() {
				var fmto = this.formoptions;
				maxCols = Math.max(maxCols, fmto ? fmto.colpos || 0 : 0 );
				maxRows = Math.max(maxRows, fmto ? fmto.rowpos || 0 : 0 );
			});
			// set the id.
			$(frm).append(tbl);
			createData(rowid, $t, tbl, maxCols);
			var rtlb = $t.p.direction === "rtl" ? true :false,
			bp = rtlb ? "nData" : "pData",
			bn = rtlb ? "pData" : "nData",
				// buttons at footer
			bP = "<a id='"+bp+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",
			bN = "<a id='"+bn+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",
			bC  ="<a id='cData' class='fm-button ui-state-default ui-corner-all'>"+p.bClose+"</a>";
			if(maxRows >  0) {
				var sd=[];
				$.each($(tbl)[0].rows,function(i,r){
					sd[i] = r;
				});
				sd.sort(function(a,b){
					if(a.rp > b.rp) {return 1;}
					if(a.rp < b.rp) {return -1;}
					return 0;
				});
				$.each(sd, function(index, row) {
					$('tbody',tbl).append(row);
				});
			}
			p.gbox = "#gbox_"+$.jgrid.jqID(gID);
			var bt = $("<div></div>").append(frm).append("<table border='0' class='EditTable' id='"+frmtb+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+p.labelswidth+"'>"+(rtlb ? bN+bP : bP+bN)+"</td><td class='EditButton'>"+bC+"</td></tr></tbody></table>");
			$.jgrid.createModal(IDs,bt,p,"#gview_"+$.jgrid.jqID($t.p.id),$("#gview_"+$.jgrid.jqID($t.p.id))[0]);
			if(rtlb) {
				$("#pData, #nData","#"+frmtb+"_2").css("float","right");
				$(".EditButton","#"+frmtb+"_2").css("text-align","left");
			}
			if(!p.viewPagerButtons) {$("#pData, #nData","#"+frmtb+"_2").hide();}
			bt = null;
			$("#"+IDs.themodal).keydown( function( e ) {
				if(e.which === 27) {
					if(rp_ge[$t.p.id].closeOnEscape) {$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:p.gbox,jqm:p.jqModal, onClose: p.onClose});}
					return false;
				}
				if(p.navkeys[0]===true) {
					if(e.which === p.navkeys[1]){ //up
						$("#pData", "#"+frmtb+"_2").trigger("click");
						return false;
					}
					if(e.which === p.navkeys[2]){ //down
						$("#nData", "#"+frmtb+"_2").trigger("click");
						return false;
					}
				}
			});
			p.closeicon = $.extend([true,"left","ui-icon-close"],p.closeicon);
			if(p.closeicon[0]===true) {
				$("#cData","#"+frmtb+"_2").addClass(p.closeicon[1] === "right" ? 'fm-button-icon-right' : 'fm-button-icon-left')
				.append("<span class='ui-icon "+p.closeicon[2]+"'></span>");
			}
			if($.isFunction(p.beforeShowForm)) {p.beforeShowForm.call($t,$("#"+frmgr));}
			$.jgrid.viewModal("#"+$.jgrid.jqID(IDs.themodal),{
				gbox:"#gbox_"+$.jgrid.jqID(gID),
				jqm:p.jqModal,
				overlay: p.overlay,
				modal:p.modal,
				onHide :  function(h) {
					$($t).data("viewProp", {
						top:parseFloat($(h.w).css("top")),
						left : parseFloat($(h.w).css("left")),
						width : $(h.w).width(),
						height : $(h.w).height(),
						dataheight : $("#"+frmgr).height(),
						datawidth: $("#"+frmgr).width()
					});
					h.w.remove();
					if(h.o) {h.o.remove();}
				}
			});
			$(".fm-button:not(.ui-state-disabled)","#"+frmtb+"_2").hover(
				function(){$(this).addClass('ui-state-hover');},
				function(){$(this).removeClass('ui-state-hover');}
			);
			focusaref();
			$("#cData", "#"+frmtb+"_2").click(function(){
				$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal, onClose: p.onClose});
				return false;
			});
			$("#nData", "#"+frmtb+"_2").click(function(){
				$("#FormError","#"+frmtb).hide();
				var npos = getCurrPos();
				npos[0] = parseInt(npos[0],10);
				if(npos[0] !== -1 && npos[1][npos[0]+1]) {
					if($.isFunction(p.onclickPgButtons)) {
						p.onclickPgButtons.call($t,'next',$("#"+frmgr),npos[1][npos[0]]);
					}
					fillData(npos[1][npos[0]+1],$t);
					$($t).jqGrid("setSelection",npos[1][npos[0]+1]);
					if($.isFunction(p.afterclickPgButtons)) {
						p.afterclickPgButtons.call($t,'next',$("#"+frmgr),npos[1][npos[0]+1]);
					}
					updateNav(npos[0]+1,npos);
				}
				focusaref();
				return false;
			});
			$("#pData", "#"+frmtb+"_2").click(function(){
				$("#FormError","#"+frmtb).hide();
				var ppos = getCurrPos();
				if(ppos[0] !== -1 && ppos[1][ppos[0]-1]) {
					if($.isFunction(p.onclickPgButtons)) {
						p.onclickPgButtons.call($t,'prev',$("#"+frmgr),ppos[1][ppos[0]]);
					}
					fillData(ppos[1][ppos[0]-1],$t);
					$($t).jqGrid("setSelection",ppos[1][ppos[0]-1]);
					if($.isFunction(p.afterclickPgButtons)) {
						p.afterclickPgButtons.call($t,'prev',$("#"+frmgr),ppos[1][ppos[0]-1]);
					}
					updateNav(ppos[0]-1,ppos);
				}
				focusaref();
				return false;
			});
			var posInit =getCurrPos();
			updateNav(posInit[0],posInit);
		});
	},
	delGridRow : function(rowids,p) {
		p = $.extend(true, {
			top : 0,
			left: 0,
			width: 240,
			height: 'auto',
			dataheight : 'auto',
			modal: false,
			overlay: 30,
			drag: true,
			resize: true,
			url : '',
			mtype : "POST",
			reloadAfterSubmit: true,
			beforeShowForm: null,
			beforeInitData : null,
			afterShowForm: null,
			beforeSubmit: null,
			onclickSubmit: null,
			afterSubmit: null,
			jqModal : true,
			closeOnEscape : false,
			delData: {},
			delicon : [],
			cancelicon : [],
			onClose : null,
			ajaxDelOptions : {},
			processing : false,
			serializeDelData : null,
			useDataProxy : false
		}, $.jgrid.del, p ||{});
		rp_ge[$(this)[0].p.id] = p;
		return this.each(function(){
			var $t = this;
			if (!$t.grid ) {return;}
			if(!rowids) {return;}
			var onBeforeShow = $.isFunction( rp_ge[$t.p.id].beforeShowForm  ),
			onAfterShow = $.isFunction( rp_ge[$t.p.id].afterShowForm ),
			onBeforeInit = $.isFunction(rp_ge[$t.p.id].beforeInitData) ? rp_ge[$t.p.id].beforeInitData : false,
			gID = $t.p.id, onCS = {},
			showFrm = true,
			dtbl = "DelTbl_"+$.jgrid.jqID(gID),postd, idname, opers, oper,
			dtbl_id = "DelTbl_" + gID,
			IDs = {themodal:'delmod'+gID,modalhead:'delhd'+gID,modalcontent:'delcnt'+gID, scrollelm: dtbl};
			if ($.isArray(rowids)) {rowids = rowids.join();}
			if ( $("#"+$.jgrid.jqID(IDs.themodal))[0] !== undefined ) {
				if(onBeforeInit) {
					showFrm = onBeforeInit.call($t,$("#"+dtbl));
					if(showFrm === undefined) {
						showFrm = true;
					}
				}
				if(showFrm === false) {return;}
				$("#DelData>td","#"+dtbl).text(rowids);
				$("#DelError","#"+dtbl).hide();
				if( rp_ge[$t.p.id].processing === true) {
					rp_ge[$t.p.id].processing=false;
					$("#dData", "#"+dtbl).removeClass('ui-state-active');
				}
				if(onBeforeShow) {rp_ge[$t.p.id].beforeShowForm.call($t,$("#"+dtbl));}
				$.jgrid.viewModal("#"+$.jgrid.jqID(IDs.themodal),{gbox:"#gbox_"+$.jgrid.jqID(gID),jqm:rp_ge[$t.p.id].jqModal,jqM: false, overlay: rp_ge[$t.p.id].overlay, modal:rp_ge[$t.p.id].modal});
				if(onAfterShow) {rp_ge[$t.p.id].afterShowForm.call($t,$("#"+dtbl));}
			} else {
				var dh = isNaN(rp_ge[$t.p.id].dataheight) ? rp_ge[$t.p.id].dataheight : rp_ge[$t.p.id].dataheight+"px",
				dw = isNaN(p.datawidth) ? p.datawidth : p.datawidth+"px",
				tbl = "<div id='"+dtbl_id+"' class='formdata' style='width:"+dw+";overflow:auto;position:relative;height:"+dh+";'>";
				tbl += "<table class='DelTable'><tbody>";
				// error data
				tbl += "<tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>";
				tbl += "<tr id='DelData' style='display:none'><td >"+rowids+"</td></tr>";
				tbl += "<tr><td class=\"delmsg\" style=\"white-space:pre;\">"+rp_ge[$t.p.id].msg+"</td></tr><tr><td >&#160;</td></tr>";
				// buttons at footer
				tbl += "</tbody></table></div>";
				var bS  = "<a id='dData' class='fm-button ui-state-default ui-corner-all'>"+p.bSubmit+"</a>",
				bC  = "<a id='eData' class='fm-button ui-state-default ui-corner-all'>"+p.bCancel+"</a>";
				tbl += "<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+dtbl+"_2'><tbody><tr><td><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton'>"+bS+"&#160;"+bC+"</td></tr></tbody></table>";
				p.gbox = "#gbox_"+$.jgrid.jqID(gID);
				$.jgrid.createModal(IDs,tbl,p,"#gview_"+$.jgrid.jqID($t.p.id),$("#gview_"+$.jgrid.jqID($t.p.id))[0]);

				if(onBeforeInit) {
					showFrm = onBeforeInit.call($t,$("#"+dtbl));
					if(showFrm === undefined) {
						showFrm = true;
					}
				}
				if(showFrm === false) {return;}

				$(".fm-button","#"+dtbl+"_2").hover(
					function(){$(this).addClass('ui-state-hover');},
					function(){$(this).removeClass('ui-state-hover');}
				);
				p.delicon = $.extend([true,"left","ui-icon-scissors"],rp_ge[$t.p.id].delicon);
				p.cancelicon = $.extend([true,"left","ui-icon-cancel"],rp_ge[$t.p.id].cancelicon);
				if(p.delicon[0]===true) {
					$("#dData","#"+dtbl+"_2").addClass(p.delicon[1] === "right" ? 'fm-button-icon-right' : 'fm-button-icon-left')
					.append("<span class='ui-icon "+p.delicon[2]+"'></span>");
				}
				if(p.cancelicon[0]===true) {
					$("#eData","#"+dtbl+"_2").addClass(p.cancelicon[1] === "right" ? 'fm-button-icon-right' : 'fm-button-icon-left')
					.append("<span class='ui-icon "+p.cancelicon[2]+"'></span>");
				}
				$("#dData","#"+dtbl+"_2").click(function(){
					var ret=[true,""], pk,
					postdata = $("#DelData>td","#"+dtbl).text(); //the pair is name=val1,val2,...
					onCS = {};
					if( $.isFunction( rp_ge[$t.p.id].onclickSubmit ) ) {onCS = rp_ge[$t.p.id].onclickSubmit.call($t,rp_ge[$t.p.id], postdata) || {};}
					if( $.isFunction( rp_ge[$t.p.id].beforeSubmit ) ) {ret = rp_ge[$t.p.id].beforeSubmit.call($t,postdata);}
					if(ret[0] && !rp_ge[$t.p.id].processing) {
						rp_ge[$t.p.id].processing = true;
						opers = $t.p.prmNames;
						postd = $.extend({},rp_ge[$t.p.id].delData, onCS);
						oper = opers.oper;
						postd[oper] = opers.deloper;
						idname = opers.id;
						postdata = String(postdata).split(",");
						if(!postdata.length) { return false; }
						for(pk in postdata) {
							if(postdata.hasOwnProperty(pk)) {
								postdata[pk] = $.jgrid.stripPref($t.p.idPrefix, postdata[pk]);
							}
						}
						postd[idname] = postdata.join();
						$(this).addClass('ui-state-active');
						var ajaxOptions = $.extend({
							url: rp_ge[$t.p.id].url || $($t).jqGrid('getGridParam','editurl'),
							type: rp_ge[$t.p.id].mtype,
							data: $.isFunction(rp_ge[$t.p.id].serializeDelData) ? rp_ge[$t.p.id].serializeDelData.call($t,postd) : postd,
							complete:function(data,status){
								var i;
								if(data.status >= 300 && data.status !== 304) {
									ret[0] = false;
									if ($.isFunction(rp_ge[$t.p.id].errorTextFormat)) {
										ret[1] = rp_ge[$t.p.id].errorTextFormat.call($t,data);
									} else {
										ret[1] = status + " Status: '" + data.statusText + "'. Error code: " + data.status;
									}
								} else {
									// data is posted successful
									// execute aftersubmit with the returned data from server
									if( $.isFunction( rp_ge[$t.p.id].afterSubmit ) ) {
										ret = rp_ge[$t.p.id].afterSubmit.call($t,data,postd);
									}
								}
								if(ret[0] === false) {
									$("#DelError>td","#"+dtbl).html(ret[1]);
									$("#DelError","#"+dtbl).show();
								} else {
									if(rp_ge[$t.p.id].reloadAfterSubmit && $t.p.datatype !== "local") {
										$($t).trigger("reloadGrid");
									} else {
										if($t.p.treeGrid===true){
												try {$($t).jqGrid("delTreeNode",$t.p.idPrefix+postdata[0]);} catch(e){}
										} else {
											for(i=0;i<postdata.length;i++) {
												$($t).jqGrid("delRowData",$t.p.idPrefix+ postdata[i]);
											}
										}
										$t.p.selrow = null;
										$t.p.selarrrow = [];
									}
									if($.isFunction(rp_ge[$t.p.id].afterComplete)) {
										setTimeout(function(){rp_ge[$t.p.id].afterComplete.call($t,data,postdata);},500);
									}
								}
								rp_ge[$t.p.id].processing=false;
								$("#dData", "#"+dtbl+"_2").removeClass('ui-state-active');
								if(ret[0]) {$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal, onClose: rp_ge[$t.p.id].onClose});}
							}
						}, $.jgrid.ajaxOptions, rp_ge[$t.p.id].ajaxDelOptions);


						if (!ajaxOptions.url && !rp_ge[$t.p.id].useDataProxy) {
							if ($.isFunction($t.p.dataProxy)) {
								rp_ge[$t.p.id].useDataProxy = true;
							} else {
								ret[0]=false;ret[1] += " "+$.jgrid.errors.nourl;
							}
						}
						if (ret[0]) {
							if (rp_ge[$t.p.id].useDataProxy) {
								var dpret = $t.p.dataProxy.call($t, ajaxOptions, "del_"+$t.p.id);
								if(dpret === undefined) {
									dpret = [true, ""];
								}
								if(dpret[0] === false ) {
									ret[0] = false;
									ret[1] = dpret[1] || "Error deleting the selected row!" ;
								} else {
									$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal, onClose: rp_ge[$t.p.id].onClose});
								}
							}
							else {$.ajax(ajaxOptions);}
						}
					}

					if(ret[0] === false) {
						$("#DelError>td","#"+dtbl).html(ret[1]);
						$("#DelError","#"+dtbl).show();
					}
					return false;
				});
				$("#eData", "#"+dtbl+"_2").click(function(){
					$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:rp_ge[$t.p.id].jqModal, onClose: rp_ge[$t.p.id].onClose});
					return false;
				});
				if(onBeforeShow) {rp_ge[$t.p.id].beforeShowForm.call($t,$("#"+dtbl));}
				$.jgrid.viewModal("#"+$.jgrid.jqID(IDs.themodal),{gbox:"#gbox_"+$.jgrid.jqID(gID),jqm:rp_ge[$t.p.id].jqModal, overlay: rp_ge[$t.p.id].overlay, modal:rp_ge[$t.p.id].modal});
				if(onAfterShow) {rp_ge[$t.p.id].afterShowForm.call($t,$("#"+dtbl));}
			}
			if(rp_ge[$t.p.id].closeOnEscape===true) {
				setTimeout(function(){$(".ui-jqdialog-titlebar-close","#"+$.jgrid.jqID(IDs.modalhead)).focus();},0);
			}
		});
	},
	navGrid : function (elem, o, pEdit,pAdd,pDel,pSearch, pView) {
		o = $.extend({
			edit: true,
			editicon: "ui-icon-pencil",
			add: true,
			addicon:"ui-icon-plus",
			del: true,
			delicon:"ui-icon-trash",
			search: true,
			searchicon:"ui-icon-search",
			refresh: true,
			refreshicon:"ui-icon-refresh",
			refreshstate: 'firstpage',
			view: false,
			viewicon : "ui-icon-document",
			position : "left",
			closeOnEscape : true,
			beforeRefresh : null,
			afterRefresh : null,
			cloneToTop : false,
			alertwidth : 200,
			alertheight : 'auto',
			alerttop: null,
			alertleft: null,
			alertzIndex : null
		}, $.jgrid.nav, o ||{});
		return this.each(function() {
			if(this.nav) {return;}
			var alertIDs = {themodal: 'alertmod_' + this.p.id, modalhead: 'alerthd_' + this.p.id,modalcontent: 'alertcnt_' + this.p.id},
			$t = this, twd, tdw;
			if(!$t.grid || typeof elem !== 'string') {return;}
			if ($("#"+alertIDs.themodal)[0] === undefined) {
				if(!o.alerttop && !o.alertleft) {
					if (window.innerWidth !== undefined) {
						o.alertleft = window.innerWidth;
						o.alerttop = window.innerHeight;
					} else if (document.documentElement !== undefined && document.documentElement.clientWidth !== undefined && document.documentElement.clientWidth !== 0) {
						o.alertleft = document.documentElement.clientWidth;
						o.alerttop = document.documentElement.clientHeight;
					} else {
						o.alertleft=1024;
						o.alerttop=768;
					}
					o.alertleft = o.alertleft/2 - parseInt(o.alertwidth,10)/2;
					o.alerttop = o.alerttop/2-25;
				}
				$.jgrid.createModal(alertIDs,
					"<div>"+o.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",
					{
						gbox:"#gbox_"+$.jgrid.jqID($t.p.id),
						jqModal:true,
						drag:true,
						resize:true,
						caption:o.alertcap,
						top:o.alerttop,
						left:o.alertleft,
						width:o.alertwidth,
						height: o.alertheight,
						closeOnEscape:o.closeOnEscape,
						zIndex: o.alertzIndex
					},
					"#gview_"+$.jgrid.jqID($t.p.id),
					$("#gbox_"+$.jgrid.jqID($t.p.id))[0],
					true
				);
			}
			var clone = 1, i,
			onHoverIn = function () {
				if (!$(this).hasClass('ui-state-disabled')) {
					$(this).addClass("ui-state-hover");
				}
			},
			onHoverOut = function () {
				$(this).removeClass("ui-state-hover");
			};
			if(o.cloneToTop && $t.p.toppager) {clone = 2;}
			for(i = 0; i<clone; i++) {
				var tbd,
				navtbl = $("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),
				sep = "<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",
				pgid, elemids;
				if(i===0) {
					pgid = elem;
					elemids = $t.p.id;
					if(pgid === $t.p.toppager) {
						elemids += "_top";
						clone = 1;
					}
				} else {
					pgid = $t.p.toppager;
					elemids = $t.p.id+"_top";
				}
				if($t.p.direction === "rtl") {$(navtbl).attr("dir","rtl").css("float","right");}
				if (o.add) {
					pAdd = pAdd || {};
					tbd = $("<td class='ui-pg-button ui-corner-all'></td>");
					$(tbd).append("<div class='ui-pg-div'><span class='ui-icon "+o.addicon+"'></span>"+o.addtext+"</div>");
					$("tr",navtbl).append(tbd);
					$(tbd,navtbl)
					.attr({"title":o.addtitle || "",id : pAdd.id || "add_"+elemids})
					.click(function(){
						if (!$(this).hasClass('ui-state-disabled')) {
							if ($.isFunction( o.addfunc )) {
								o.addfunc.call($t);
							} else {
								$($t).jqGrid("editGridRow","new",pAdd);
							}
						}
						return false;
					}).hover(onHoverIn, onHoverOut);
					tbd = null;
				}
				if (o.edit) {
					tbd = $("<td class='ui-pg-button ui-corner-all'></td>");
					pEdit = pEdit || {};
					$(tbd).append("<div class='ui-pg-div'><span class='ui-icon "+o.editicon+"'></span>"+o.edittext+"</div>");
					$("tr",navtbl).append(tbd);
					$(tbd,navtbl)
					.attr({"title":o.edittitle || "",id: pEdit.id || "edit_"+elemids})
					.click(function(){
						if (!$(this).hasClass('ui-state-disabled')) {
							var sr = $t.p.selrow;
							if (sr) {
								if($.isFunction( o.editfunc ) ) {
									o.editfunc.call($t, sr);
								} else {
									$($t).jqGrid("editGridRow",sr,pEdit);
								}
							} else {
								$.jgrid.viewModal("#"+alertIDs.themodal,{gbox:"#gbox_"+$.jgrid.jqID($t.p.id),jqm:true});
								$("#jqg_alrt").focus();
							}
						}
						return false;
					}).hover(onHoverIn, onHoverOut);
					tbd = null;
				}
				if (o.view) {
					tbd = $("<td class='ui-pg-button ui-corner-all'></td>");
					pView = pView || {};
					$(tbd).append("<div class='ui-pg-div'><span class='ui-icon "+o.viewicon+"'></span>"+o.viewtext+"</div>");
					$("tr",navtbl).append(tbd);
					$(tbd,navtbl)
					.attr({"title":o.viewtitle || "",id: pView.id || "view_"+elemids})
					.click(function(){
						if (!$(this).hasClass('ui-state-disabled')) {
							var sr = $t.p.selrow;
							if (sr) {
								if($.isFunction( o.viewfunc ) ) {
									o.viewfunc.call($t, sr);
								} else {
									$($t).jqGrid("viewGridRow",sr,pView);
								}
							} else {
								$.jgrid.viewModal("#"+alertIDs.themodal,{gbox:"#gbox_"+$.jgrid.jqID($t.p.id),jqm:true});
								$("#jqg_alrt").focus();
							}
						}
						return false;
					}).hover(onHoverIn, onHoverOut);
					tbd = null;
				}
				if (o.del) {
					tbd = $("<td class='ui-pg-button ui-corner-all'></td>");
					pDel = pDel || {};
					$(tbd).append("<div class='ui-pg-div'><span class='ui-icon "+o.delicon+"'></span>"+o.deltext+"</div>");
					$("tr",navtbl).append(tbd);
					$(tbd,navtbl)
					.attr({"title":o.deltitle || "",id: pDel.id || "del_"+elemids})
					.click(function(){
						if (!$(this).hasClass('ui-state-disabled')) {
							var dr;
							if($t.p.multiselect) {
								dr = $t.p.selarrrow;
								if(dr.length===0) {dr = null;}
							} else {
								dr = $t.p.selrow;
							}
							if(dr){
								if($.isFunction( o.delfunc )){
									o.delfunc.call($t, dr);
								}else{
									$($t).jqGrid("delGridRow",dr,pDel);
								}
							} else  {
								$.jgrid.viewModal("#"+alertIDs.themodal,{gbox:"#gbox_"+$.jgrid.jqID($t.p.id),jqm:true});$("#jqg_alrt").focus();
							}
						}
						return false;
					}).hover(onHoverIn, onHoverOut);
					tbd = null;
				}
				if(o.add || o.edit || o.del || o.view) {$("tr",navtbl).append(sep);}
				if (o.search) {
					tbd = $("<td class='ui-pg-button ui-corner-all'></td>");
					pSearch = pSearch || {};
					$(tbd).append("<div class='ui-pg-div'><span class='ui-icon "+o.searchicon+"'></span>"+o.searchtext+"</div>");
					$("tr",navtbl).append(tbd);
					$(tbd,navtbl)
					.attr({"title":o.searchtitle  || "",id:pSearch.id || "search_"+elemids})
					.click(function(){
						if (!$(this).hasClass('ui-state-disabled')) {
							if($.isFunction( o.searchfunc )) {
								o.searchfunc.call($t, pSearch);
							} else {
								$($t).jqGrid("searchGrid",pSearch);
							}
						}
						return false;
					}).hover(onHoverIn, onHoverOut);
					if (pSearch.showOnLoad && pSearch.showOnLoad === true) {
						$(tbd,navtbl).click();
					}
					tbd = null;
				}
				if (o.refresh) {
					tbd = $("<td class='ui-pg-button ui-corner-all'></td>");
					$(tbd).append("<div class='ui-pg-div'><span class='ui-icon "+o.refreshicon+"'></span>"+o.refreshtext+"</div>");
					$("tr",navtbl).append(tbd);
					$(tbd,navtbl)
					.attr({"title":o.refreshtitle  || "",id: "refresh_"+elemids})
					.click(function(){
						if (!$(this).hasClass('ui-state-disabled')) {
							if($.isFunction(o.beforeRefresh)) {o.beforeRefresh.call($t);}
							$t.p.search = false;
							$t.p.resetsearch =  true;
							try {
								var gID = $t.p.id;
								$t.p.postData.filters ="";
								try {
								$("#fbox_"+$.jgrid.jqID(gID)).jqFilter('resetFilter');
								} catch(ef) {}
								if($.isFunction($t.clearToolbar)) {$t.clearToolbar.call($t,false);}
							} catch (e) {}
							switch (o.refreshstate) {
								case 'firstpage':
									$($t).trigger("reloadGrid", [{page:1}]);
									break;
								case 'current':
									$($t).trigger("reloadGrid", [{current:true}]);
									break;
							}
							if($.isFunction(o.afterRefresh)) {o.afterRefresh.call($t);}
						}
						return false;
					}).hover(onHoverIn, onHoverOut);
					tbd = null;
				}
				tdw = $(".ui-jqgrid").css("font-size") || "11px";
				$('body').append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+tdw+";visibility:hidden;' ></div>");
				twd = $(navtbl).clone().appendTo("#testpg2").width();
				$("#testpg2").remove();
				$(pgid+"_"+o.position,pgid).append(navtbl);
				if($t.p._nvtd) {
					if(twd > $t.p._nvtd[0] ) {
						$(pgid+"_"+o.position,pgid).width(twd);
						$t.p._nvtd[0] = twd;
					}
					$t.p._nvtd[1] = twd;
				}
				tdw =null;twd=null;navtbl =null;
				this.nav = true;
			}
		});
	},
	navButtonAdd : function (elem, p) {
		p = $.extend({
			caption : "newButton",
			title: '',
			buttonicon : 'ui-icon-newwin',
			onClickButton: null,
			position : "last",
			cursor : 'pointer'
		}, p ||{});
		return this.each(function() {
			if( !this.grid)  {return;}
			if( typeof elem === "string" && elem.indexOf("#") !== 0) {elem = "#"+$.jgrid.jqID(elem);}
			var findnav = $(".navtable",elem)[0], $t = this;
			if (findnav) {
				if( p.id && $("#"+$.jgrid.jqID(p.id), findnav)[0] !== undefined )  {return;}
				var tbd = $("<td></td>");
				if(p.buttonicon.toString().toUpperCase() === "NONE") {
                    $(tbd).addClass('ui-pg-button ui-corner-all').append("<div class='ui-pg-div'>"+p.caption+"</div>");
				} else	{
					$(tbd).addClass('ui-pg-button ui-corner-all').append("<div class='ui-pg-div'><span class='ui-icon "+p.buttonicon+"'></span>"+p.caption+"</div>");
				}
				if(p.id) {$(tbd).attr("id",p.id);}
				if(p.position==='first'){
					if(findnav.rows[0].cells.length ===0 ) {
						$("tr",findnav).append(tbd);
					} else {
						$("tr td:eq(0)",findnav).before(tbd);
					}
				} else {
					$("tr",findnav).append(tbd);
				}
				$(tbd,findnav)
				.attr("title",p.title  || "")
				.click(function(e){
					if (!$(this).hasClass('ui-state-disabled')) {
						if ($.isFunction(p.onClickButton) ) {p.onClickButton.call($t,e);}
					}
					return false;
				})
				.hover(
					function () {
						if (!$(this).hasClass('ui-state-disabled')) {
							$(this).addClass('ui-state-hover');
						}
					},
					function () {$(this).removeClass("ui-state-hover");}
				);
			}
		});
	},
	navSeparatorAdd:function (elem,p) {
		p = $.extend({
			sepclass : "ui-separator",
			sepcontent: '',
			position : "last"
		}, p ||{});
		return this.each(function() {
			if( !this.grid)  {return;}
			if( typeof elem === "string" && elem.indexOf("#") !== 0) {elem = "#"+$.jgrid.jqID(elem);}
			var findnav = $(".navtable",elem)[0];
			if(findnav) {
				var sep = "<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+p.sepclass+"'></span>"+p.sepcontent+"</td>";
				if (p.position === 'first') {
					if (findnav.rows[0].cells.length === 0) {
						$("tr", findnav).append(sep);
					} else {
						$("tr td:eq(0)", findnav).before(sep);
					}
				} else {
					$("tr", findnav).append(sep);
				}
			}
		});
	},
	GridToForm : function( rowid, formid ) {
		return this.each(function(){
			var $t = this, i;
			if (!$t.grid) {return;}
			var rowdata = $($t).jqGrid("getRowData",rowid);
			if (rowdata) {
				for(i in rowdata) {
					if(rowdata.hasOwnProperty(i)) {
					if ( $("[name="+$.jgrid.jqID(i)+"]",formid).is("input:radio") || $("[name="+$.jgrid.jqID(i)+"]",formid).is("input:checkbox"))  {
						$("[name="+$.jgrid.jqID(i)+"]",formid).each( function() {
							if( $(this).val() == rowdata[i] ) {
								$(this)[$t.p.useProp ? 'prop': 'attr']("checked",true);
							} else {
								$(this)[$t.p.useProp ? 'prop': 'attr']("checked", false);
							}
						});
					} else {
					// this is very slow on big table and form.
						$("[name="+$.jgrid.jqID(i)+"]",formid).val(rowdata[i]);
					}
				}
			}
			}
		});
	},
	FormToGrid : function(rowid, formid, mode, position){
		return this.each(function() {
			var $t = this;
			if(!$t.grid) {return;}
			if(!mode) {mode = 'set';}
			if(!position) {position = 'first';}
			var fields = $(formid).serializeArray();
			var griddata = {};
			$.each(fields, function(i, field){
				griddata[field.name] = field.value;
			});
			if(mode==='add') {$($t).jqGrid("addRowData",rowid,griddata, position);}
			else if(mode==='set') {$($t).jqGrid("setRowData",rowid,griddata);}
		});
	}
});
})(jQuery);
/*jshint eqeqeq:false, eqnull:true, devel:true */
/*global jQuery */
(function($){
/**
 * jqGrid extension for manipulating Grid Data
 * Tony Tomov tony@trirand.com
 * http://trirand.com/blog/
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
**/
"use strict";
$.jgrid.inlineEdit = $.jgrid.inlineEdit || {};
$.jgrid.extend({
//Editing
	editRow : function(rowid,keys,oneditfunc,successfunc, url, extraparam, aftersavefunc,errorfunc, afterrestorefunc) {
		// Compatible mode old versions
		var o={}, args = $.makeArray(arguments).slice(1);

		if( $.type(args[0]) === "object" ) {
			o = args[0];
		} else {
			if (keys !== undefined) { o.keys = keys; }
			if ($.isFunction(oneditfunc)) { o.oneditfunc = oneditfunc; }
			if ($.isFunction(successfunc)) { o.successfunc = successfunc; }
			if (url !== undefined) { o.url = url; }
			if (extraparam !== undefined) { o.extraparam = extraparam; }
			if ($.isFunction(aftersavefunc)) { o.aftersavefunc = aftersavefunc; }
			if ($.isFunction(errorfunc)) { o.errorfunc = errorfunc; }
			if ($.isFunction(afterrestorefunc)) { o.afterrestorefunc = afterrestorefunc; }
			// last two not as param, but as object (sorry)
			//if (restoreAfterError !== undefined) { o.restoreAfterError = restoreAfterError; }
			//if (mtype !== undefined) { o.mtype = mtype || "POST"; }
		}
		o = $.extend(true, {
			keys : false,
			oneditfunc: null,
			successfunc: null,
			url: null,
			extraparam: {},
			aftersavefunc: null,
			errorfunc: null,
			afterrestorefunc: null,
			restoreAfterError: true,
			mtype: "POST"
		}, $.jgrid.inlineEdit, o );

		// End compatible
		return this.each(function(){
			var $t = this, nm, tmp, editable, cnt=0, focus=null, svr={}, ind,cm, bfer;
			if (!$t.grid ) { return; }
			ind = $($t).jqGrid("getInd",rowid,true);
			if( ind === false ) {return;}
			bfer = $.isFunction( o.beforeEditRow ) ? o.beforeEditRow.call($t,o, rowid) :  undefined;
			if( bfer === undefined ) {
				bfer = true;
			}
			if(!bfer) { return; }
			editable = $(ind).attr("editable") || "0";
			if (editable === "0" && !$(ind).hasClass("not-editable-row")) {
				cm = $t.p.colModel;
				$('td[role="gridcell"]',ind).each( function(i) {
					nm = cm[i].name;
					var treeg = $t.p.treeGrid===true && nm === $t.p.ExpandColumn;
					if(treeg) { tmp = $("span:first",this).html();}
					else {
						try {
							tmp = $.unformat.call($t,this,{rowId:rowid, colModel:cm[i]},i);
						} catch (_) {
							tmp =  ( cm[i].edittype && cm[i].edittype === 'textarea' ) ? $(this).text() : $(this).html();
						}
					}
					if ( nm !== 'cb' && nm !== 'subgrid' && nm !== 'rn') {
						if($t.p.autoencode) { tmp = $.jgrid.htmlDecode(tmp); }
						svr[nm]=tmp;
						if(cm[i].editable===true) {
							if(focus===null) { focus = i; }
							if (treeg) { $("span:first",this).html(""); }
							else { $(this).html(""); }
							var opt = $.extend({},cm[i].editoptions || {},{id:rowid+"_"+nm,name:nm});
							if(!cm[i].edittype) { cm[i].edittype = "text"; }
							if(tmp === "&nbsp;" || tmp === "&#160;" || (tmp.length===1 && tmp.charCodeAt(0)===160) ) {tmp='';}
							var elc = $.jgrid.createEl.call($t,cm[i].edittype,opt,tmp,true,$.extend({},$.jgrid.ajaxOptions,$t.p.ajaxSelectOptions || {}));
							$(elc).addClass("editable");
							if(treeg) { $("span:first",this).append(elc); }
							else { $(this).append(elc); }
							$.jgrid.bindEv.call($t, elc, opt);
							//Again IE
							if(cm[i].edittype === "select" && cm[i].editoptions!==undefined && cm[i].editoptions.multiple===true  && cm[i].editoptions.dataUrl===undefined && $.jgrid.msie) {
								$(elc).width($(elc).width());
							}
							cnt++;
						}
					}
				});
				if(cnt > 0) {
					svr.id = rowid; $t.p.savedRow.push(svr);
					$(ind).attr("editable","1");
					setTimeout(function(){$("td:eq("+focus+") input",ind).focus();},0);
					if(o.keys===true) {
						$(ind).bind("keydown",function(e) {
							if (e.keyCode === 27) {
								$($t).jqGrid("restoreRow",rowid, o.afterrestorefunc);
								if($t.p._inlinenav) {
									try {
										$($t).jqGrid('showAddEditButtons');
									} catch (eer1) {}
								}
								return false;
							}
							if (e.keyCode === 13) {
								var ta = e.target;
								if(ta.tagName === 'TEXTAREA') { return true; }
								if( $($t).jqGrid("saveRow", rowid, o ) ) {
									if($t.p._inlinenav) {
										try {
											$($t).jqGrid('showAddEditButtons');
										} catch (eer2) {}
									}
								}
								return false;
							}
						});
					}
					$($t).triggerHandler("jqGridInlineEditRow", [rowid, o]);
					if( $.isFunction(o.oneditfunc)) { o.oneditfunc.call($t, rowid); }
				}
			}
		});
	},
	saveRow : function(rowid, successfunc, url, extraparam, aftersavefunc,errorfunc, afterrestorefunc) {
		// Compatible mode old versions
		var args = $.makeArray(arguments).slice(1), o = {};

		if( $.type(args[0]) === "object" ) {
			o = args[0];
		} else {
			if ($.isFunction(successfunc)) { o.successfunc = successfunc; }
			if (url !== undefined) { o.url = url; }
			if (extraparam !== undefined) { o.extraparam = extraparam; }
			if ($.isFunction(aftersavefunc)) { o.aftersavefunc = aftersavefunc; }
			if ($.isFunction(errorfunc)) { o.errorfunc = errorfunc; }
			if ($.isFunction(afterrestorefunc)) { o.afterrestorefunc = afterrestorefunc; }
		}
		o = $.extend(true, {
			successfunc: null,
			url: null,
			extraparam: {},
			aftersavefunc: null,
			errorfunc: null,
			afterrestorefunc: null,
			restoreAfterError: true,
			mtype: "POST"
		}, $.jgrid.inlineEdit, o );
		// End compatible

		var success = false;
		var $t = this[0], nm, tmp={}, tmp2={}, tmp3= {}, editable, fr, cv, ind;
		if (!$t.grid ) { return success; }
		ind = $($t).jqGrid("getInd",rowid,true);
		if(ind === false) {return success;}
		var bfsr = $.isFunction( o.beforeSaveRow ) ?	o.beforeSaveRow.call($t,o, rowid) :  undefined;
		if( bfsr === undefined ) {
			bfsr = true;
		}
		if(!bfsr) { return; }
		editable = $(ind).attr("editable");
		o.url = o.url || $t.p.editurl;
		if (editable==="1") {
			var cm;
			$('td[role="gridcell"]',ind).each(function(i) {
				cm = $t.p.colModel[i];
				nm = cm.name;
				if ( nm !== 'cb' && nm !== 'subgrid' && cm.editable===true && nm !== 'rn' && !$(this).hasClass('not-editable-cell')) {
					switch (cm.edittype) {
						case "checkbox":
							var cbv = ["Yes","No"];
							if(cm.editoptions ) {
								cbv = cm.editoptions.value.split(":");
							}
							tmp[nm]=  $("input",this).is(":checked") ? cbv[0] : cbv[1];
							break;
						case 'text':
						case 'password':
						case 'textarea':
						case "button" :
							tmp[nm]=$("input, textarea",this).val();
							break;
						case 'select':
							if(!cm.editoptions.multiple) {
								tmp[nm] = $("select option:selected",this).val();
								tmp2[nm] = $("select option:selected", this).text();
							} else {
								var sel = $("select",this), selectedText = [];
								tmp[nm] = $(sel).val();
								if(tmp[nm]) { tmp[nm]= tmp[nm].join(","); } else { tmp[nm] =""; }
								$("select option:selected",this).each(
									function(i,selected){
										selectedText[i] = $(selected).text();
									}
								);
								tmp2[nm] = selectedText.join(",");
							}
							if(cm.formatter && cm.formatter === 'select') { tmp2={}; }
							break;
						case 'custom' :
							try {
								if(cm.editoptions && $.isFunction(cm.editoptions.custom_value)) {
									tmp[nm] = cm.editoptions.custom_value.call($t, $(".customelement",this),'get');
									if (tmp[nm] === undefined) { throw "e2"; }
								} else { throw "e1"; }
							} catch (e) {
								if (e==="e1") { $.jgrid.info_dialog($.jgrid.errors.errcap,"function 'custom_value' "+$.jgrid.edit.msg.nodefined,$.jgrid.edit.bClose); }
								if (e==="e2") { $.jgrid.info_dialog($.jgrid.errors.errcap,"function 'custom_value' "+$.jgrid.edit.msg.novalue,$.jgrid.edit.bClose); }
								else { $.jgrid.info_dialog($.jgrid.errors.errcap,e.message,$.jgrid.edit.bClose); }
							}
							break;
					}
					cv = $.jgrid.checkValues.call($t,tmp[nm],i);
					if(cv[0] === false) {
						return false;
					}
					if($t.p.autoencode) { tmp[nm] = $.jgrid.htmlEncode(tmp[nm]); }
					if(o.url !== 'clientArray' && cm.editoptions && cm.editoptions.NullIfEmpty === true) {
						if(tmp[nm] === "") {
							tmp3[nm] = 'null';
						}
					}
				}
			});
			if (cv[0] === false){
				try {
					var tr = $($t).jqGrid('getGridRowById', rowid), positions = $.jgrid.findPos(tr);
					$.jgrid.info_dialog($.jgrid.errors.errcap,cv[1],$.jgrid.edit.bClose,{left:positions[0],top:positions[1]+$(tr).outerHeight()});
				} catch (e) {
					alert(cv[1]);
				}
				return success;
			}
			var idname, opers = $t.p.prmNames, oldRowId = rowid;
			if ($t.p.keyIndex === false) {
				idname = opers.id;
			} else {
				idname = $t.p.colModel[$t.p.keyIndex +
					($t.p.rownumbers === true ? 1 : 0) +
					($t.p.multiselect === true ? 1 : 0) +
					($t.p.subGrid === true ? 1 : 0)].name;
			}
			if(tmp) {
				tmp[opers.oper] = opers.editoper;
				if (tmp[idname] === undefined || tmp[idname]==="") {
					tmp[idname] = rowid;
				} else if (ind.id !== $t.p.idPrefix + tmp[idname]) {
					// rename rowid
					var oldid = $.jgrid.stripPref($t.p.idPrefix, rowid);
					if ($t.p._index[oldid] !== undefined) {
						$t.p._index[tmp[idname]] = $t.p._index[oldid];
						delete $t.p._index[oldid];
					}
					rowid = $t.p.idPrefix + tmp[idname];
					$(ind).attr("id", rowid);
					if ($t.p.selrow === oldRowId) {
						$t.p.selrow = rowid;
					}
					if ($.isArray($t.p.selarrrow)) {
						var i = $.inArray(oldRowId, $t.p.selarrrow);
						if (i>=0) {
							$t.p.selarrrow[i] = rowid;
						}
					}
					if ($t.p.multiselect) {
						var newCboxId = "jqg_" + $t.p.id + "_" + rowid;
						$("input.cbox",ind)
							.attr("id", newCboxId)
							.attr("name", newCboxId);
					}
					// TODO: to test the case of frozen columns
				}
				if($t.p.inlineData === undefined) { $t.p.inlineData ={}; }
				tmp = $.extend({},tmp,$t.p.inlineData,o.extraparam);
			}
			if (o.url === 'clientArray') {
				tmp = $.extend({},tmp, tmp2);
				if($t.p.autoencode) {
					$.each(tmp,function(n,v){
						tmp[n] = $.jgrid.htmlDecode(v);
					});
				}
				var k, resp = $($t).jqGrid("setRowData",rowid,tmp);
				$(ind).attr("editable","0");
				for(k=0;k<$t.p.savedRow.length;k++) {
					if( String($t.p.savedRow[k].id) === String(oldRowId)) {fr = k; break;}
				}
				if(fr >= 0) { $t.p.savedRow.splice(fr,1); }
				$($t).triggerHandler("jqGridInlineAfterSaveRow", [rowid, resp, tmp, o]);
				if( $.isFunction(o.aftersavefunc) ) { o.aftersavefunc.call($t, rowid,resp, o); }
				success = true;
				$(ind).removeClass("jqgrid-new-row").unbind("keydown");
			} else {
				$("#lui_"+$.jgrid.jqID($t.p.id)).show();
				tmp3 = $.extend({},tmp,tmp3);
				tmp3[idname] = $.jgrid.stripPref($t.p.idPrefix, tmp3[idname]);
				$.ajax($.extend({
					url:o.url,
					data: $.isFunction($t.p.serializeRowData) ? $t.p.serializeRowData.call($t, tmp3) : tmp3,
					type: o.mtype,
					async : false, //?!?
					complete: function(res,stat){
						$("#lui_"+$.jgrid.jqID($t.p.id)).hide();
						if (stat === "success"){
							var ret = true, sucret, k;
							sucret = $($t).triggerHandler("jqGridInlineSuccessSaveRow", [res, rowid, o]);
							if (!$.isArray(sucret)) {sucret = [true, tmp];}
							if (sucret[0] && $.isFunction(o.successfunc)) {sucret = o.successfunc.call($t, res);}
							if($.isArray(sucret)) {
								// expect array - status, data, rowid
								ret = sucret[0];
								tmp = sucret[1] || tmp;
							} else {
								ret = sucret;
							}
							if (ret===true) {
								if($t.p.autoencode) {
									$.each(tmp,function(n,v){
										tmp[n] = $.jgrid.htmlDecode(v);
									});
								}
								tmp = $.extend({},tmp, tmp2);
								$($t).jqGrid("setRowData",rowid,tmp);
								$(ind).attr("editable","0");
								for(k=0;k<$t.p.savedRow.length;k++) {
									if( String($t.p.savedRow[k].id) === String(rowid)) {fr = k; break;}
								}
								if(fr >= 0) { $t.p.savedRow.splice(fr,1); }
								$($t).triggerHandler("jqGridInlineAfterSaveRow", [rowid, res, tmp, o]);
								if( $.isFunction(o.aftersavefunc) ) { o.aftersavefunc.call($t, rowid,res); }
								success = true;
								$(ind).removeClass("jqgrid-new-row").unbind("keydown");
							} else {
								$($t).triggerHandler("jqGridInlineErrorSaveRow", [rowid, res, stat, null, o]);
								if($.isFunction(o.errorfunc) ) {
									o.errorfunc.call($t, rowid, res, stat, null);
								}
								if(o.restoreAfterError === true) {
									$($t).jqGrid("restoreRow",rowid, o.afterrestorefunc);
								}
							}
						}
					},
					error:function(res,stat,err){
						$("#lui_"+$.jgrid.jqID($t.p.id)).hide();
						$($t).triggerHandler("jqGridInlineErrorSaveRow", [rowid, res, stat, err, o]);
						if($.isFunction(o.errorfunc) ) {
							o.errorfunc.call($t, rowid, res, stat, err);
						} else {
							var rT = res.responseText || res.statusText;
							try {
								$.jgrid.info_dialog($.jgrid.errors.errcap,'<div class="ui-state-error">'+ rT +'</div>', $.jgrid.edit.bClose,{buttonalign:'right'});
							} catch(e) {
								alert(rT);
							}
						}
						if(o.restoreAfterError === true) {
							$($t).jqGrid("restoreRow",rowid, o.afterrestorefunc);
						}
					}
				}, $.jgrid.ajaxOptions, $t.p.ajaxRowOptions || {}));
			}
		}
		return success;
	},
	restoreRow : function(rowid, afterrestorefunc) {
		// Compatible mode old versions
		var args = $.makeArray(arguments).slice(1), o={};

		if( $.type(args[0]) === "object" ) {
			o = args[0];
		} else {
			if ($.isFunction(afterrestorefunc)) { o.afterrestorefunc = afterrestorefunc; }
		}
		o = $.extend(true, {}, $.jgrid.inlineEdit, o );

		// End compatible

		return this.each(function(){
			var $t= this, fr=-1, ind, ares={}, k;
			if (!$t.grid ) { return; }
			ind = $($t).jqGrid("getInd",rowid,true);
			if(ind === false) {return;}
			var bfcr = $.isFunction( o.beforeCancelRow ) ?	o.beforeCancelRow.call($t, o, sr) :  undefined;
			if( bfcr === undefined ) {
				bfcr = true;
			}
			if(!bfcr) { return; }
			for(k=0;k<$t.p.savedRow.length;k++) {
				if( String($t.p.savedRow[k].id) === String(rowid)) {fr = k; break;}
			}
			if(fr >= 0) {
				if($.isFunction($.fn.datepicker)) {
					try {
						$("input.hasDatepicker","#"+$.jgrid.jqID(ind.id)).datepicker('hide');
					} catch (e) {}
				}
				$.each($t.p.colModel, function(){
					if(this.editable === true && $t.p.savedRow[fr].hasOwnProperty(this.name)) {
						ares[this.name] = $t.p.savedRow[fr][this.name];
					}
				});
				$($t).jqGrid("setRowData",rowid,ares);
				$(ind).attr("editable","0").unbind("keydown");
				$t.p.savedRow.splice(fr,1);
				if($("#"+$.jgrid.jqID(rowid), "#"+$.jgrid.jqID($t.p.id)).hasClass("jqgrid-new-row")){
					setTimeout(function(){
						$($t).jqGrid("delRowData",rowid);
						$($t).jqGrid('showAddEditButtons');
					},0);
				}
			}
			$($t).triggerHandler("jqGridInlineAfterRestoreRow", [rowid]);
			if ($.isFunction(o.afterrestorefunc))
			{
				o.afterrestorefunc.call($t, rowid);
			}
		});
	},
	addRow : function ( p ) {
		p = $.extend(true, {
			rowID : null,
			initdata : {},
			position :"first",
			useDefValues : true,
			useFormatter : false,
			addRowParams : {extraparam:{}}
		},p  || {});
		return this.each(function(){
			if (!this.grid ) { return; }
			var $t = this;
			var bfar = $.isFunction( p.beforeAddRow ) ?	p.beforeAddRow.call($t,p.addRowParams) :  undefined;
			if( bfar === undefined ) {
				bfar = true;
			}
			if(!bfar) { return; }
			p.rowID = $.isFunction(p.rowID) ? p.rowID.call($t, p) : ( (p.rowID != null) ? p.rowID : $.jgrid.randId());
			if(p.useDefValues === true) {
				$($t.p.colModel).each(function(){
					if( this.editoptions && this.editoptions.defaultValue ) {
						var opt = this.editoptions.defaultValue,
						tmp = $.isFunction(opt) ? opt.call($t) : opt;
						p.initdata[this.name] = tmp;
					}
				});
			}
			$($t).jqGrid('addRowData', p.rowID, p.initdata, p.position);
			p.rowID = $t.p.idPrefix + p.rowID;
			$("#"+$.jgrid.jqID(p.rowID), "#"+$.jgrid.jqID($t.p.id)).addClass("jqgrid-new-row");
			if(p.useFormatter) {
				$("#"+$.jgrid.jqID(p.rowID)+" .ui-inline-edit", "#"+$.jgrid.jqID($t.p.id)).click();
			} else {
				var opers = $t.p.prmNames,
				oper = opers.oper;
				p.addRowParams.extraparam[oper] = opers.addoper;
				$($t).jqGrid('editRow', p.rowID, p.addRowParams);
				$($t).jqGrid('setSelection', p.rowID);
			}
		});
	},
	inlineNav : function (elem, o) {
		o = $.extend(true,{
			edit: true,
			editicon: "ui-icon-pencil",
			add: true,
			addicon:"ui-icon-plus",
			save: true,
			saveicon:"ui-icon-disk",
			cancel: true,
			cancelicon:"ui-icon-cancel",
			addParams : {addRowParams: {extraparam: {}}},
			editParams : {},
			restoreAfterSelect : true
		}, $.jgrid.nav, o ||{});
		return this.each(function(){
			if (!this.grid ) { return; }
			var $t = this, onSelect, gID = $.jgrid.jqID($t.p.id);
			$t.p._inlinenav = true;
			// detect the formatactions column
			if(o.addParams.useFormatter === true) {
				var cm = $t.p.colModel,i;
				for (i = 0; i<cm.length; i++) {
					if(cm[i].formatter && cm[i].formatter === "actions" ) {
						if(cm[i].formatoptions) {
							var defaults =  {
								keys:false,
								onEdit : null,
								onSuccess: null,
								afterSave:null,
								onError: null,
								afterRestore: null,
								extraparam: {},
								url: null
							},
							ap = $.extend( defaults, cm[i].formatoptions );
							o.addParams.addRowParams = {
								"keys" : ap.keys,
								"oneditfunc" : ap.onEdit,
								"successfunc" : ap.onSuccess,
								"url" : ap.url,
								"extraparam" : ap.extraparam,
								"aftersavefunc" : ap.afterSave,
								"errorfunc": ap.onError,
								"afterrestorefunc" : ap.afterRestore
							};
						}
						break;
					}
				}
			}
			if(o.add) {
				$($t).jqGrid('navButtonAdd', elem,{
					caption : o.addtext,
					title : o.addtitle,
					buttonicon : o.addicon,
					id : $t.p.id+"_iladd",
					onClickButton : function () {
						$($t).jqGrid('addRow', o.addParams);
						if(!o.addParams.useFormatter) {
							$("#"+gID+"_ilsave").removeClass('ui-state-disabled');
							$("#"+gID+"_ilcancel").removeClass('ui-state-disabled');
							$("#"+gID+"_iladd").addClass('ui-state-disabled');
							$("#"+gID+"_iledit").addClass('ui-state-disabled');
						}
					}
				});
			}
			if(o.edit) {
				$($t).jqGrid('navButtonAdd', elem,{
					caption : o.edittext,
					title : o.edittitle,
					buttonicon : o.editicon,
					id : $t.p.id+"_iledit",
					onClickButton : function () {
						var sr = $($t).jqGrid('getGridParam','selrow');
						if(sr) {
							$($t).jqGrid('editRow', sr, o.editParams);
							$("#"+gID+"_ilsave").removeClass('ui-state-disabled');
							$("#"+gID+"_ilcancel").removeClass('ui-state-disabled');
							$("#"+gID+"_iladd").addClass('ui-state-disabled');
							$("#"+gID+"_iledit").addClass('ui-state-disabled');
						} else {
							$.jgrid.viewModal("#alertmod",{gbox:"#gbox_"+gID,jqm:true});$("#jqg_alrt").focus();
						}
					}
				});
			}
			if(o.save) {
				$($t).jqGrid('navButtonAdd', elem,{
					caption : o.savetext || '',
					title : o.savetitle || 'Save row',
					buttonicon : o.saveicon,
					id : $t.p.id+"_ilsave",
					onClickButton : function () {
						var sr = $t.p.savedRow[0].id;
						if(sr) {
							var opers = $t.p.prmNames,
							oper = opers.oper, tmpParams = o.editParams;
							if($("#"+$.jgrid.jqID(sr), "#"+gID ).hasClass("jqgrid-new-row")) {
								o.addParams.addRowParams.extraparam[oper] = opers.addoper;
								tmpParams = o.addParams.addRowParams;
							} else {
								if(!o.editParams.extraparam) {
									o.editParams.extraparam = {};
								}
								o.editParams.extraparam[oper] = opers.editoper;
							}
							if( $($t).jqGrid('saveRow', sr, tmpParams) ) {
								$($t).jqGrid('showAddEditButtons');
							}
						} else {
							$.jgrid.viewModal("#alertmod",{gbox:"#gbox_"+gID,jqm:true});$("#jqg_alrt").focus();
						}
					}
				});
				$("#"+gID+"_ilsave").addClass('ui-state-disabled');
			}
			if(o.cancel) {
				$($t).jqGrid('navButtonAdd', elem,{
					caption : o.canceltext || '',
					title : o.canceltitle || 'Cancel row editing',
					buttonicon : o.cancelicon,
					id : $t.p.id+"_ilcancel",
					onClickButton : function () {
						var sr = $t.p.savedRow[0].id, cancelPrm = o.editParams;
						if(sr) {
							if($("#"+$.jgrid.jqID(sr), "#"+gID ).hasClass("jqgrid-new-row")) {
								cancelPrm = o.addParams.addRowParams;
							}
							$($t).jqGrid('restoreRow', sr, cancelPrm);
							$($t).jqGrid('showAddEditButtons');
						} else {
							$.jgrid.viewModal("#alertmod",{gbox:"#gbox_"+gID,jqm:true});$("#jqg_alrt").focus();
						}
					}
				});
				$("#"+gID+"_ilcancel").addClass('ui-state-disabled');
			}
			if(o.restoreAfterSelect === true) {
				if($.isFunction($t.p.beforeSelectRow)) {
					onSelect = $t.p.beforeSelectRow;
				} else {
					onSelect =  false;
				}
				$t.p.beforeSelectRow = function(id, stat) {
					var ret = true;
					if($t.p.savedRow.length > 0 && $t.p._inlinenav===true && ( id !== $t.p.selrow && $t.p.selrow !==null) ) {
						if($t.p.selrow === o.addParams.rowID ) {
							$($t).jqGrid('delRowData', $t.p.selrow);
						} else {
							$($t).jqGrid('restoreRow', $t.p.selrow, o.editParams);
						}
						$($t).jqGrid('showAddEditButtons');
					}
					if(onSelect) {
						ret = onSelect.call($t, id, stat);
					}
					return ret;
				};
			}

		});
	},
	showAddEditButtons : function()  {
		return this.each(function(){
			if (!this.grid ) { return; }
			var gID = $.jgrid.jqID(this.p.id);
			$("#"+gID+"_ilsave").addClass('ui-state-disabled');
			$("#"+gID+"_ilcancel").addClass('ui-state-disabled');
			$("#"+gID+"_iladd").removeClass('ui-state-disabled');
			$("#"+gID+"_iledit").removeClass('ui-state-disabled');
		});
	}
//end inline edit
});
})(jQuery);
/*jshint eqeqeq:false */
/*global jQuery */
(function($){
/*
**
 * jqGrid extension for cellediting Grid Data
 * Tony Tomov tony@trirand.com
 * http://trirand.com/blog/
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
**/
/**
 * all events and options here are aded anonynous and not in the base grid
 * since the array is to big. Here is the order of execution.
 * From this point we use jQuery isFunction
 * formatCell
 * beforeEditCell,
 * onSelectCell (used only for noneditable cels)
 * afterEditCell,
 * beforeSaveCell, (called before validation of values if any)
 * beforeSubmitCell (if cellsubmit remote (ajax))
 * afterSubmitCell(if cellsubmit remote (ajax)),
 * afterSaveCell,
 * errorCell,
 * serializeCellData - new
 * Options
 * cellsubmit (remote,clientArray) (added in grid options)
 * cellurl
 * ajaxCellOptions
* */
"use strict";
$.jgrid.extend({
	editCell : function (iRow,iCol, ed){
		return this.each(function (){
			var $t = this, nm, tmp,cc, cm;
			if (!$t.grid || $t.p.cellEdit !== true) {return;}
			iCol = parseInt(iCol,10);
			// select the row that can be used for other methods
			$t.p.selrow = $t.rows[iRow].id;
			if (!$t.p.knv) {$($t).jqGrid("GridNav");}
			// check to see if we have already edited cell
			if ($t.p.savedRow.length>0) {
				// prevent second click on that field and enable selects
				if (ed===true ) {
					if(iRow == $t.p.iRow && iCol == $t.p.iCol){
						return;
					}
				}
				// save the cell
				$($t).jqGrid("saveCell",$t.p.savedRow[0].id,$t.p.savedRow[0].ic);
			} else {
				window.setTimeout(function () { $("#"+$.jgrid.jqID($t.p.knv)).attr("tabindex","-1").focus();},0);
			}
			cm = $t.p.colModel[iCol];
			nm = cm.name;
			if (nm==='subgrid' || nm==='cb' || nm==='rn') {return;}
			cc = $("td:eq("+iCol+")",$t.rows[iRow]);
			if (cm.editable===true && ed===true && !cc.hasClass("not-editable-cell")) {
				if(parseInt($t.p.iCol,10)>=0  && parseInt($t.p.iRow,10)>=0) {
					$("td:eq("+$t.p.iCol+")",$t.rows[$t.p.iRow]).removeClass("edit-cell ui-state-highlight");
					$($t.rows[$t.p.iRow]).removeClass("selected-row ui-state-hover");
				}
				$(cc).addClass("edit-cell ui-state-highlight");
				$($t.rows[iRow]).addClass("selected-row ui-state-hover");
				try {
					tmp =  $.unformat.call($t,cc,{rowId: $t.rows[iRow].id, colModel:cm},iCol);
				} catch (_) {
					tmp = ( cm.edittype && cm.edittype === 'textarea' ) ? $(cc).text() : $(cc).html();
				}
				if($t.p.autoencode) { tmp = $.jgrid.htmlDecode(tmp); }
				if (!cm.edittype) {cm.edittype = "text";}
				$t.p.savedRow.push({id:iRow,ic:iCol,name:nm,v:tmp});
				if(tmp === "&nbsp;" || tmp === "&#160;" || (tmp.length===1 && tmp.charCodeAt(0)===160) ) {tmp='';}
				if($.isFunction($t.p.formatCell)) {
					var tmp2 = $t.p.formatCell.call($t, $t.rows[iRow].id,nm,tmp,iRow,iCol);
					if(tmp2 !== undefined ) {tmp = tmp2;}
				}
				$($t).triggerHandler("jqGridBeforeEditCell", [$t.rows[iRow].id, nm, tmp, iRow, iCol]);
				if ($.isFunction($t.p.beforeEditCell)) {
					$t.p.beforeEditCell.call($t, $t.rows[iRow].id,nm,tmp,iRow,iCol);
				}
				var opt = $.extend({}, cm.editoptions || {} ,{id:iRow+"_"+nm,name:nm});
				var elc = $.jgrid.createEl.call($t,cm.edittype,opt,tmp,true,$.extend({},$.jgrid.ajaxOptions,$t.p.ajaxSelectOptions || {}));
				$(cc).html("").append(elc).attr("tabindex","0");
				$.jgrid.bindEv.call($t, elc, opt);
				window.setTimeout(function () { $(elc).focus();},0);
				$("input, select, textarea",cc).bind("keydown",function(e) {
					if (e.keyCode === 27) {
						if($("input.hasDatepicker",cc).length >0) {
							if( $(".ui-datepicker").is(":hidden") )  { $($t).jqGrid("restoreCell",iRow,iCol); }
							else { $("input.hasDatepicker",cc).datepicker('hide'); }
						} else {
							$($t).jqGrid("restoreCell",iRow,iCol);
						}
					} //ESC
					if (e.keyCode === 13) {
						$($t).jqGrid("saveCell",iRow,iCol);
						// Prevent default action
						return false;
					} //Enter
					if (e.keyCode === 9)  {
						if(!$t.grid.hDiv.loading ) {
							if (e.shiftKey) {$($t).jqGrid("prevCell",iRow,iCol);} //Shift TAb
							else {$($t).jqGrid("nextCell",iRow,iCol);} //Tab
						} else {
							return false;
						}
					}
					e.stopPropagation();
				});
				$($t).triggerHandler("jqGridAfterEditCell", [$t.rows[iRow].id, nm, tmp, iRow, iCol]);
				if ($.isFunction($t.p.afterEditCell)) {
					$t.p.afterEditCell.call($t, $t.rows[iRow].id,nm,tmp,iRow,iCol);
				}
			} else {
				if (parseInt($t.p.iCol,10)>=0  && parseInt($t.p.iRow,10)>=0) {
					$("td:eq("+$t.p.iCol+")",$t.rows[$t.p.iRow]).removeClass("edit-cell ui-state-highlight");
					$($t.rows[$t.p.iRow]).removeClass("selected-row ui-state-hover");
				}
				cc.addClass("edit-cell ui-state-highlight");
				$($t.rows[iRow]).addClass("selected-row ui-state-hover");
				tmp = cc.html().replace(/\&#160\;/ig,'');
				$($t).triggerHandler("jqGridSelectCell", [$t.rows[iRow].id, nm, tmp, iRow, iCol]);
				if ($.isFunction($t.p.onSelectCell)) {
					$t.p.onSelectCell.call($t, $t.rows[iRow].id,nm,tmp,iRow,iCol);
				}
			}
			$t.p.iCol = iCol; $t.p.iRow = iRow;
		});
	},
	saveCell : function (iRow, iCol){
		return this.each(function(){
			var $t= this, fr;
			if (!$t.grid || $t.p.cellEdit !== true) {return;}
			if ( $t.p.savedRow.length >= 1) {fr = 0;} else {fr=null;}
			if(fr !== null) {
				var cc = $("td:eq("+iCol+")",$t.rows[iRow]),v,v2,
				cm = $t.p.colModel[iCol], nm = cm.name, nmjq = $.jgrid.jqID(nm) ;
				switch (cm.edittype) {
					case "select":
						if(!cm.editoptions.multiple) {
							v = $("#"+iRow+"_"+nmjq+" option:selected",$t.rows[iRow]).val();
							v2 = $("#"+iRow+"_"+nmjq+" option:selected",$t.rows[iRow]).text();
						} else {
							var sel = $("#"+iRow+"_"+nmjq,$t.rows[iRow]), selectedText = [];
							v = $(sel).val();
							if(v) { v.join(",");} else { v=""; }
							$("option:selected",sel).each(
								function(i,selected){
									selectedText[i] = $(selected).text();
								}
							);
							v2 = selectedText.join(",");
						}
						if(cm.formatter) { v2 = v; }
						break;
					case "checkbox":
						var cbv  = ["Yes","No"];
						if(cm.editoptions){
							cbv = cm.editoptions.value.split(":");
						}
						v = $("#"+iRow+"_"+nmjq,$t.rows[iRow]).is(":checked") ? cbv[0] : cbv[1];
						v2=v;
						break;
					case "password":
					case "text":
					case "textarea":
					case "button" :
						v = $("#"+iRow+"_"+nmjq,$t.rows[iRow]).val();
						v2=v;
						break;
					case 'custom' :
						try {
							if(cm.editoptions && $.isFunction(cm.editoptions.custom_value)) {
								v = cm.editoptions.custom_value.call($t, $(".customelement",cc),'get');
								if (v===undefined) { throw "e2";} else { v2=v; }
							} else { throw "e1"; }
						} catch (e) {
							if (e==="e1") { $.jgrid.info_dialog($.jgrid.errors.errcap,"function 'custom_value' "+$.jgrid.edit.msg.nodefined,$.jgrid.edit.bClose); }
							if (e==="e2") { $.jgrid.info_dialog($.jgrid.errors.errcap,"function 'custom_value' "+$.jgrid.edit.msg.novalue,$.jgrid.edit.bClose); }
							else {$.jgrid.info_dialog($.jgrid.errors.errcap,e.message,$.jgrid.edit.bClose); }
						}
						break;
				}
				// The common approach is if nothing changed do not do anything
				if (v2 !== $t.p.savedRow[fr].v){
					var vvv = $($t).triggerHandler("jqGridBeforeSaveCell", [$t.rows[iRow].id, nm, v, iRow, iCol]);
					if (vvv) {v = vvv; v2=vvv;}
					if ($.isFunction($t.p.beforeSaveCell)) {
						var vv = $t.p.beforeSaveCell.call($t, $t.rows[iRow].id,nm, v, iRow,iCol);
						if (vv) {v = vv; v2=vv;}
					}
					var cv = $.jgrid.checkValues.call($t,v,iCol);
					if(cv[0] === true) {
						var addpost = $($t).triggerHandler("jqGridBeforeSubmitCell", [$t.rows[iRow].id, nm, v, iRow, iCol]) || {};
						if ($.isFunction($t.p.beforeSubmitCell)) {
							addpost = $t.p.beforeSubmitCell.call($t, $t.rows[iRow].id,nm, v, iRow,iCol);
							if (!addpost) {addpost={};}
						}
						if( $("input.hasDatepicker",cc).length >0) { $("input.hasDatepicker",cc).datepicker('hide'); }
						if ($t.p.cellsubmit === 'remote') {
							if ($t.p.cellurl) {
								var postdata = {};
								if($t.p.autoencode) { v = $.jgrid.htmlEncode(v); }
								postdata[nm] = v;
								var idname,oper, opers;
								opers = $t.p.prmNames;
								idname = opers.id;
								oper = opers.oper;
								postdata[idname] = $.jgrid.stripPref($t.p.idPrefix, $t.rows[iRow].id);
								postdata[oper] = opers.editoper;
								postdata = $.extend(addpost,postdata);
								$("#lui_"+$.jgrid.jqID($t.p.id)).show();
								$t.grid.hDiv.loading = true;
								$.ajax( $.extend( {
									url: $t.p.cellurl,
									data :$.isFunction($t.p.serializeCellData) ? $t.p.serializeCellData.call($t, postdata) : postdata,
									type: "POST",
									complete: function (result, stat) {
										$("#lui_"+$t.p.id).hide();
										$t.grid.hDiv.loading = false;
										if (stat === 'success') {
											var ret = $($t).triggerHandler("jqGridAfterSubmitCell", [$t, result, postdata.id, nm, v, iRow, iCol]) || [true, ''];
											if (ret[0] === true && $.isFunction($t.p.afterSubmitCell)) {
												ret = $t.p.afterSubmitCell.call($t, result,postdata.id,nm,v,iRow,iCol);
											}
											if(ret[0] === true){
												$(cc).empty();
												$($t).jqGrid("setCell",$t.rows[iRow].id, iCol, v2, false, false, true);
												$(cc).addClass("dirty-cell");
												$($t.rows[iRow]).addClass("edited");
												$($t).triggerHandler("jqGridAfterSaveCell", [$t.rows[iRow].id, nm, v, iRow, iCol]);
												if ($.isFunction($t.p.afterSaveCell)) {
													$t.p.afterSaveCell.call($t, $t.rows[iRow].id,nm, v, iRow,iCol);
												}
												$t.p.savedRow.splice(0,1);
											} else {
												$.jgrid.info_dialog($.jgrid.errors.errcap,ret[1],$.jgrid.edit.bClose);
												$($t).jqGrid("restoreCell",iRow,iCol);
											}
										}
									},
									error:function(res,stat,err) {
										$("#lui_"+$.jgrid.jqID($t.p.id)).hide();
										$t.grid.hDiv.loading = false;
										$($t).triggerHandler("jqGridErrorCell", [res, stat, err]);
										if ($.isFunction($t.p.errorCell)) {
											$t.p.errorCell.call($t, res,stat,err);
											$($t).jqGrid("restoreCell",iRow,iCol);
										} else {
											$.jgrid.info_dialog($.jgrid.errors.errcap,res.status+" : "+res.statusText+"<br/>"+stat,$.jgrid.edit.bClose);
											$($t).jqGrid("restoreCell",iRow,iCol);
										}
									}
								}, $.jgrid.ajaxOptions, $t.p.ajaxCellOptions || {}));
							} else {
								try {
									$.jgrid.info_dialog($.jgrid.errors.errcap,$.jgrid.errors.nourl,$.jgrid.edit.bClose);
									$($t).jqGrid("restoreCell",iRow,iCol);
								} catch (e) {}
							}
						}
						if ($t.p.cellsubmit === 'clientArray') {
							$(cc).empty();
							$($t).jqGrid("setCell",$t.rows[iRow].id,iCol, v2, false, false, true);
							$(cc).addClass("dirty-cell");
							$($t.rows[iRow]).addClass("edited");
							$($t).triggerHandler("jqGridAfterSaveCell", [$t.rows[iRow].id, nm, v, iRow, iCol]);
							if ($.isFunction($t.p.afterSaveCell)) {
								$t.p.afterSaveCell.call($t, $t.rows[iRow].id,nm, v, iRow,iCol);
							}
							$t.p.savedRow.splice(0,1);
						}
					} else {
						try {
							window.setTimeout(function(){$.jgrid.info_dialog($.jgrid.errors.errcap,v+" "+cv[1],$.jgrid.edit.bClose);},100);
							$($t).jqGrid("restoreCell",iRow,iCol);
						} catch (e) {}
					}
				} else {
					$($t).jqGrid("restoreCell",iRow,iCol);
				}
			}
			window.setTimeout(function () { $("#"+$.jgrid.jqID($t.p.knv)).attr("tabindex","-1").focus();},0);
		});
	},
	restoreCell : function(iRow, iCol) {
		return this.each(function(){
			var $t= this, fr;
			if (!$t.grid || $t.p.cellEdit !== true ) {return;}
			if ( $t.p.savedRow.length >= 1) {fr = 0;} else {fr=null;}
			if(fr !== null) {
				var cc = $("td:eq("+iCol+")",$t.rows[iRow]);
				// datepicker fix
				if($.isFunction($.fn.datepicker)) {
					try {
						$("input.hasDatepicker",cc).datepicker('hide');
					} catch (e) {}
				}
				$(cc).empty().attr("tabindex","-1");
				$($t).jqGrid("setCell",$t.rows[iRow].id, iCol, $t.p.savedRow[fr].v, false, false, true);
				$($t).triggerHandler("jqGridAfterRestoreCell", [$t.rows[iRow].id, $t.p.savedRow[fr].v, iRow, iCol]);
				if ($.isFunction($t.p.afterRestoreCell)) {
					$t.p.afterRestoreCell.call($t, $t.rows[iRow].id, $t.p.savedRow[fr].v, iRow, iCol);
				}
				$t.p.savedRow.splice(0,1);
			}
			window.setTimeout(function () { $("#"+$t.p.knv).attr("tabindex","-1").focus();},0);
		});
	},
	nextCell : function (iRow,iCol) {
		return this.each(function (){
			var $t = this, nCol=false, i;
			if (!$t.grid || $t.p.cellEdit !== true) {return;}
			// try to find next editable cell
			for (i=iCol+1; i<$t.p.colModel.length; i++) {
				if ( $t.p.colModel[i].editable ===true) {
					nCol = i; break;
				}
			}
			if(nCol !== false) {
				$($t).jqGrid("editCell",iRow,nCol,true);
			} else {
				if ($t.p.savedRow.length >0) {
					$($t).jqGrid("saveCell",iRow,iCol);
				}
			}
		});
	},
	prevCell : function (iRow,iCol) {
		return this.each(function (){
			var $t = this, nCol=false, i;
			if (!$t.grid || $t.p.cellEdit !== true) {return;}
			// try to find next editable cell
			for (i=iCol-1; i>=0; i--) {
				if ( $t.p.colModel[i].editable ===true) {
					nCol = i; break;
				}
			}
			if(nCol !== false) {
				$($t).jqGrid("editCell",iRow,nCol,true);
			} else {
				if ($t.p.savedRow.length >0) {
					$($t).jqGrid("saveCell",iRow,iCol);
				}
			}
		});
	},
	GridNav : function() {
		return this.each(function () {
			var  $t = this;
			if (!$t.grid || $t.p.cellEdit !== true ) {return;}
			// trick to process keydown on non input elements
			$t.p.knv = $t.p.id + "_kn";
			var selection = $("<div style='position:fixed;top:0px;width:1px;height:1px;' tabindex='0'><div tabindex='-1' style='width:1px;height:1px;' id='"+$t.p.knv+"'></div></div>"),
			i, kdir;
			function scrollGrid(iR, iC, tp){
				if (tp.substr(0,1)==='v') {
					var ch = $($t.grid.bDiv)[0].clientHeight,
					st = $($t.grid.bDiv)[0].scrollTop,
					nROT = $t.rows[iR].offsetTop+$t.rows[iR].clientHeight,
					pROT = $t.rows[iR].offsetTop;
					if(tp === 'vd') {
						if(nROT >= ch) {
							$($t.grid.bDiv)[0].scrollTop = $($t.grid.bDiv)[0].scrollTop + $t.rows[iR].clientHeight;
						}
					}
					if(tp === 'vu'){
						if (pROT < st ) {
							$($t.grid.bDiv)[0].scrollTop = $($t.grid.bDiv)[0].scrollTop - $t.rows[iR].clientHeight;
						}
					}
				}
				if(tp==='h') {
					var cw = $($t.grid.bDiv)[0].clientWidth,
					sl = $($t.grid.bDiv)[0].scrollLeft,
					nCOL = $t.rows[iR].cells[iC].offsetLeft+$t.rows[iR].cells[iC].clientWidth,
					pCOL = $t.rows[iR].cells[iC].offsetLeft;
					if(nCOL >= cw+parseInt(sl,10)) {
						$($t.grid.bDiv)[0].scrollLeft = $($t.grid.bDiv)[0].scrollLeft + $t.rows[iR].cells[iC].clientWidth;
					} else if (pCOL < sl) {
						$($t.grid.bDiv)[0].scrollLeft = $($t.grid.bDiv)[0].scrollLeft - $t.rows[iR].cells[iC].clientWidth;
					}
				}
			}
			function findNextVisible(iC,act){
				var ind, i;
				if(act === 'lft') {
					ind = iC+1;
					for (i=iC;i>=0;i--){
						if ($t.p.colModel[i].hidden !== true) {
							ind = i;
							break;
						}
					}
				}
				if(act === 'rgt') {
					ind = iC-1;
					for (i=iC; i<$t.p.colModel.length;i++){
						if ($t.p.colModel[i].hidden !== true) {
							ind = i;
							break;
						}
					}
				}
				return ind;
			}

			$(selection).insertBefore($t.grid.cDiv);
			$("#"+$t.p.knv)
			.focus()
			.keydown(function (e){
				kdir = e.keyCode;
				if($t.p.direction === "rtl") {
					if(kdir===37) { kdir = 39;}
					else if (kdir===39) { kdir = 37; }
				}
				switch (kdir) {
					case 38:
						if ($t.p.iRow-1 >0 ) {
							scrollGrid($t.p.iRow-1,$t.p.iCol,'vu');
							$($t).jqGrid("editCell",$t.p.iRow-1,$t.p.iCol,false);
						}
					break;
					case 40 :
						if ($t.p.iRow+1 <=  $t.rows.length-1) {
							scrollGrid($t.p.iRow+1,$t.p.iCol,'vd');
							$($t).jqGrid("editCell",$t.p.iRow+1,$t.p.iCol,false);
						}
					break;
					case 37 :
						if ($t.p.iCol -1 >=  0) {
							i = findNextVisible($t.p.iCol-1,'lft');
							scrollGrid($t.p.iRow, i,'h');
							$($t).jqGrid("editCell",$t.p.iRow, i,false);
						}
					break;
					case 39 :
						if ($t.p.iCol +1 <=  $t.p.colModel.length-1) {
							i = findNextVisible($t.p.iCol+1,'rgt');
							scrollGrid($t.p.iRow,i,'h');
							$($t).jqGrid("editCell",$t.p.iRow,i,false);
						}
					break;
					case 13:
						if (parseInt($t.p.iCol,10)>=0 && parseInt($t.p.iRow,10)>=0) {
							$($t).jqGrid("editCell",$t.p.iRow,$t.p.iCol,true);
						}
					break;
					default :
						return true;
				}
				return false;
			});
		});
	},
	getChangedCells : function (mthd) {
		var ret=[];
		if (!mthd) {mthd='all';}
		this.each(function(){
			var $t= this,nm;
			if (!$t.grid || $t.p.cellEdit !== true ) {return;}
			$($t.rows).each(function(j){
				var res = {};
				if ($(this).hasClass("edited")) {
					$('td',this).each( function(i) {
						nm = $t.p.colModel[i].name;
						if ( nm !== 'cb' && nm !== 'subgrid') {
							if (mthd==='dirty') {
								if ($(this).hasClass('dirty-cell')) {
									try {
										res[nm] = $.unformat.call($t,this,{rowId:$t.rows[j].id, colModel:$t.p.colModel[i]},i);
									} catch (e){
										res[nm] = $.jgrid.htmlDecode($(this).html());
									}
								}
							} else {
								try {
									res[nm] = $.unformat.call($t,this,{rowId:$t.rows[j].id,colModel:$t.p.colModel[i]},i);
								} catch (e) {
									res[nm] = $.jgrid.htmlDecode($(this).html());
								}
							}
						}
					});
					res.id = this.id;
					ret.push(res);
				}
			});
		});
		return ret;
	}
/// end  cell editing
});
})(jQuery);
/*jshint eqeqeq:false */
/*global jQuery */
(function($){
/**
 * jqGrid extension for SubGrid Data
 * Tony Tomov tony@trirand.com
 * http://trirand.com/blog/
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
**/
"use strict";
$.jgrid.extend({
setSubGrid : function () {
	return this.each(function (){
		var $t = this, cm, i,
		suboptions = {
			plusicon : "ui-icon-plus",
			minusicon : "ui-icon-minus",
			openicon: "ui-icon-carat-1-sw",
			expandOnLoad:  false,
			delayOnLoad : 50,
			selectOnExpand : false,
			selectOnCollapse : false,
			reloadOnExpand : true
		};
		$t.p.subGridOptions = $.extend(suboptions, $t.p.subGridOptions || {});
		$t.p.colNames.unshift("");
		$t.p.colModel.unshift({name:'subgrid',width: $.jgrid.cell_width ?  $t.p.subGridWidth+$t.p.cellLayout : $t.p.subGridWidth,sortable: false,resizable:false,hidedlg:true,search:false,fixed:true});
		cm = $t.p.subGridModel;
		if(cm[0]) {
			cm[0].align = $.extend([],cm[0].align || []);
			for(i=0;i<cm[0].name.length;i++) { cm[0].align[i] = cm[0].align[i] || 'left';}
		}
	});
},
addSubGridCell :function (pos,iRow) {
	var prp='',ic,sid;
	this.each(function(){
		prp = this.formatCol(pos,iRow);
		sid= this.p.id;
		ic = this.p.subGridOptions.plusicon;
	});
	return "<td role=\"gridcell\" aria-describedby=\""+sid+"_subgrid\" class=\"ui-sgcollapsed sgcollapsed\" "+prp+"><a style='cursor:pointer;'><span class='ui-icon "+ic+"'></span></a></td>";
},
addSubGrid : function( pos, sind ) {
	return this.each(function(){
		var ts = this;
		if (!ts.grid ) { return; }
		//-------------------------
		var subGridCell = function(trdiv,cell,pos)
		{
			var tddiv = $("<td align='"+ts.p.subGridModel[0].align[pos]+"'></td>").html(cell);
			$(trdiv).append(tddiv);
		};
		var subGridXml = function(sjxml, sbid){
			var tddiv, i,  sgmap,
			dummy = $("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),
			trdiv = $("<tr></tr>");
			for (i = 0; i<ts.p.subGridModel[0].name.length; i++) {
				tddiv = $("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+ts.p.direction+"'></th>");
				$(tddiv).html(ts.p.subGridModel[0].name[i]);
				$(tddiv).width( ts.p.subGridModel[0].width[i]);
				$(trdiv).append(tddiv);
			}
			$(dummy).append(trdiv);
			if (sjxml){
				sgmap = ts.p.xmlReader.subgrid;
				$(sgmap.root+" "+sgmap.row, sjxml).each( function(){
					trdiv = $("<tr class='ui-widget-content ui-subtblcell'></tr>");
					if(sgmap.repeatitems === true) {
						$(sgmap.cell,this).each( function(i) {
							subGridCell(trdiv, $(this).text() || '&#160;',i);
						});
					} else {
						var f = ts.p.subGridModel[0].mapping || ts.p.subGridModel[0].name;
						if (f) {
							for (i=0;i<f.length;i++) {
								subGridCell(trdiv, $(f[i],this).text() || '&#160;',i);
							}
						}
					}
					$(dummy).append(trdiv);
				});
			}
			var pID = $("table:first",ts.grid.bDiv).attr("id")+"_";
			$("#"+$.jgrid.jqID(pID+sbid)).append(dummy);
			ts.grid.hDiv.loading = false;
			$("#load_"+$.jgrid.jqID(ts.p.id)).hide();
			return false;
		};
		var subGridJson = function(sjxml, sbid){
			var tddiv,result,i,cur, sgmap,j,
			dummy = $("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),
			trdiv = $("<tr></tr>");
			for (i = 0; i<ts.p.subGridModel[0].name.length; i++) {
				tddiv = $("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+ts.p.direction+"'></th>");
				$(tddiv).html(ts.p.subGridModel[0].name[i]);
				$(tddiv).width( ts.p.subGridModel[0].width[i]);
				$(trdiv).append(tddiv);
			}
			$(dummy).append(trdiv);
			if (sjxml){
				sgmap = ts.p.jsonReader.subgrid;
				result = $.jgrid.getAccessor(sjxml, sgmap.root);
				if ( result !== undefined ) {
					for (i=0;i<result.length;i++) {
						cur = result[i];
						trdiv = $("<tr class='ui-widget-content ui-subtblcell'></tr>");
						if(sgmap.repeatitems === true) {
							if(sgmap.cell) { cur=cur[sgmap.cell]; }
							for (j=0;j<cur.length;j++) {
								subGridCell(trdiv, cur[j] || '&#160;',j);
							}
						} else {
							var f = ts.p.subGridModel[0].mapping || ts.p.subGridModel[0].name;
							if(f.length) {
								for (j=0;j<f.length;j++) {
									subGridCell(trdiv, cur[f[j]] || '&#160;',j);
								}
							}
						}
						$(dummy).append(trdiv);
					}
				}
			}
			var pID = $("table:first",ts.grid.bDiv).attr("id")+"_";
			$("#"+$.jgrid.jqID(pID+sbid)).append(dummy);
			ts.grid.hDiv.loading = false;
			$("#load_"+$.jgrid.jqID(ts.p.id)).hide();
			return false;
		};
		var populatesubgrid = function( rd )
		{
			var sid,dp, i, j;
			sid = $(rd).attr("id");
			dp = {nd_: (new Date().getTime())};
			dp[ts.p.prmNames.subgridid]=sid;
			if(!ts.p.subGridModel[0]) { return false; }
			if(ts.p.subGridModel[0].params) {
				for(j=0; j < ts.p.subGridModel[0].params.length; j++) {
					for(i=0; i<ts.p.colModel.length; i++) {
						if(ts.p.colModel[i].name === ts.p.subGridModel[0].params[j]) {
							dp[ts.p.colModel[i].name]= $("td:eq("+i+")",rd).text().replace(/\&#160\;/ig,'');
						}
					}
				}
			}
			if(!ts.grid.hDiv.loading) {
				ts.grid.hDiv.loading = true;
				$("#load_"+$.jgrid.jqID(ts.p.id)).show();
				if(!ts.p.subgridtype) { ts.p.subgridtype = ts.p.datatype; }
				if($.isFunction(ts.p.subgridtype)) {
					ts.p.subgridtype.call(ts, dp);
				} else {
					ts.p.subgridtype = ts.p.subgridtype.toLowerCase();
				}
				switch(ts.p.subgridtype) {
					case "xml":
					case "json":
					$.ajax($.extend({
						type:ts.p.mtype,
						url: ts.p.subGridUrl,
						dataType:ts.p.subgridtype,
						data: $.isFunction(ts.p.serializeSubGridData)? ts.p.serializeSubGridData.call(ts, dp) : dp,
						complete: function(sxml) {
							if(ts.p.subgridtype === "xml") {
								subGridXml(sxml.responseXML, sid);
							} else {
								subGridJson($.jgrid.parse(sxml.responseText),sid);
							}
							sxml=null;
						}
					}, $.jgrid.ajaxOptions, ts.p.ajaxSubgridOptions || {}));
					break;
				}
			}
			return false;
		};
		var _id, pID,atd, nhc=0, bfsc, r;
		$.each(ts.p.colModel,function(){
			if(this.hidden === true || this.name === 'rn' || this.name === 'cb') {
				nhc++;
			}
		});
		var len = ts.rows.length, i=1;
		if( sind !== undefined && sind > 0) {
			i = sind;
			len = sind+1;
		}
		while(i < len) {
			if($(ts.rows[i]).hasClass('jqgrow')) {
				$(ts.rows[i].cells[pos]).bind('click', function() {
					var tr = $(this).parent("tr")[0];
					r = tr.nextSibling;
					if($(this).hasClass("sgcollapsed")) {
						pID = ts.p.id;
						_id = tr.id;
						if(ts.p.subGridOptions.reloadOnExpand === true || ( ts.p.subGridOptions.reloadOnExpand === false && !$(r).hasClass('ui-subgrid') ) ) {
							atd = pos >=1 ? "<td colspan='"+pos+"'>&#160;</td>":"";
							bfsc = $(ts).triggerHandler("jqGridSubGridBeforeExpand", [pID + "_" + _id, _id]);
							bfsc = (bfsc === false || bfsc === 'stop') ? false : true;
							if(bfsc && $.isFunction(ts.p.subGridBeforeExpand)) {
								bfsc = ts.p.subGridBeforeExpand.call(ts, pID+"_"+_id,_id);
							}
							if(bfsc === false) {return false;}
							$(tr).after( "<tr role='row' class='ui-subgrid'>"+atd+"<td class='ui-widget-content subgrid-cell'><span class='ui-icon "+ts.p.subGridOptions.openicon+"'></span></td><td colspan='"+parseInt(ts.p.colNames.length-1-nhc,10)+"' class='ui-widget-content subgrid-data'><div id="+pID+"_"+_id+" class='tablediv'></div></td></tr>" );
							$(ts).triggerHandler("jqGridSubGridRowExpanded", [pID + "_" + _id, _id]);
							if( $.isFunction(ts.p.subGridRowExpanded)) {
								ts.p.subGridRowExpanded.call(ts, pID+"_"+ _id,_id);
							} else {
								populatesubgrid(tr);
							}
						} else {
							$(r).show();
						}
						$(this).html("<a style='cursor:pointer;'><span class='ui-icon "+ts.p.subGridOptions.minusicon+"'></span></a>").removeClass("sgcollapsed").addClass("sgexpanded");
						if(ts.p.subGridOptions.selectOnExpand) {
							$(ts).jqGrid('setSelection',_id);
						}
					} else if($(this).hasClass("sgexpanded")) {
						bfsc = $(ts).triggerHandler("jqGridSubGridRowColapsed", [pID + "_" + _id, _id]);
						bfsc = (bfsc === false || bfsc === 'stop') ? false : true;
						_id = tr.id;
						if( bfsc &&  $.isFunction(ts.p.subGridRowColapsed)) {
							bfsc = ts.p.subGridRowColapsed.call(ts, pID+"_"+_id,_id );
						}
						if(bfsc===false) {return false;}
						if(ts.p.subGridOptions.reloadOnExpand === true) {
							$(r).remove(".ui-subgrid");
						} else if($(r).hasClass('ui-subgrid')) { // incase of dynamic deleting
							$(r).hide();
						}
						$(this).html("<a style='cursor:pointer;'><span class='ui-icon "+ts.p.subGridOptions.plusicon+"'></span></a>").removeClass("sgexpanded").addClass("sgcollapsed");
						if(ts.p.subGridOptions.selectOnCollapse) {
							$(ts).jqGrid('setSelection',_id);
						}
					}
					return false;
				});
			}
			i++;
		}
		if(ts.p.subGridOptions.expandOnLoad === true) {
			$(ts.rows).filter('.jqgrow').each(function(index,row){
				$(row.cells[0]).click();
			});
		}
		ts.subGridXml = function(xml,sid) {subGridXml(xml,sid);};
		ts.subGridJson = function(json,sid) {subGridJson(json,sid);};
	});
},
expandSubGridRow : function(rowid) {
	return this.each(function () {
		var $t = this;
		if(!$t.grid && !rowid) {return;}
		if($t.p.subGrid===true) {
			var rc = $(this).jqGrid("getInd",rowid,true);
			if(rc) {
				var sgc = $("td.sgcollapsed",rc)[0];
				if(sgc) {
					$(sgc).trigger("click");
				}
			}
		}
	});
},
collapseSubGridRow : function(rowid) {
	return this.each(function () {
		var $t = this;
		if(!$t.grid && !rowid) {return;}
		if($t.p.subGrid===true) {
			var rc = $(this).jqGrid("getInd",rowid,true);
			if(rc) {
				var sgc = $("td.sgexpanded",rc)[0];
				if(sgc) {
					$(sgc).trigger("click");
				}
			}
		}
	});
},
toggleSubGridRow : function(rowid) {
	return this.each(function () {
		var $t = this;
		if(!$t.grid && !rowid) {return;}
		if($t.p.subGrid===true) {
			var rc = $(this).jqGrid("getInd",rowid,true);
			if(rc) {
				var sgc = $("td.sgcollapsed",rc)[0];
				if(sgc) {
					$(sgc).trigger("click");
				} else {
					sgc = $("td.sgexpanded",rc)[0];
					if(sgc) {
						$(sgc).trigger("click");
					}
				}
			}
		}
	});
}
});
})(jQuery);
/**
 * jqGrid extension - Tree Grid
 * Tony Tomov tony@trirand.com
 * http://trirand.com/blog/
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
**/

/*jshint eqeqeq:false */
/*global jQuery */
(function($) {
"use strict";
$.jgrid.extend({
	setTreeNode : function(i, len){
		return this.each(function(){
			var $t = this;
			if( !$t.grid || !$t.p.treeGrid ) {return;}
			var expCol = $t.p.expColInd,
			expanded = $t.p.treeReader.expanded_field,
			isLeaf = $t.p.treeReader.leaf_field,
			level = $t.p.treeReader.level_field,
			icon = $t.p.treeReader.icon_field,
			loaded = $t.p.treeReader.loaded,  lft, rgt, curLevel, ident,lftpos, twrap,
			ldat, lf;
			while(i<len) {
				var ind = $.jgrid.stripPref($t.p.idPrefix, $t.rows[i].id), dind = $t.p._index[ind], expan;
				ldat = $t.p.data[dind];
				//$t.rows[i].level = ldat[level];
				if($t.p.treeGridModel === 'nested') {
					if(!ldat[isLeaf]) {
					lft = parseInt(ldat[$t.p.treeReader.left_field],10);
					rgt = parseInt(ldat[$t.p.treeReader.right_field],10);
					// NS Model
						ldat[isLeaf] = (rgt === lft+1) ? 'true' : 'false';
						$t.rows[i].cells[$t.p._treeleafpos].innerHTML = ldat[isLeaf];
					}
				}
				//else {
					//row.parent_id = rd[$t.p.treeReader.parent_id_field];
				//}
				curLevel = parseInt(ldat[level],10);
				if($t.p.tree_root_level === 0) {
					ident = curLevel+1;
					lftpos = curLevel;
				} else {
					ident = curLevel;
					lftpos = curLevel -1;
				}
				twrap = "<div class='tree-wrap tree-wrap-"+$t.p.direction+"' style='width:"+(ident*18)+"px;'>";
				twrap += "<div style='"+($t.p.direction==="rtl" ? "right:" : "left:")+(lftpos*18)+"px;' class='ui-icon ";


				if(ldat[loaded] !== undefined) {
					if(ldat[loaded]==="true" || ldat[loaded]===true) {
						ldat[loaded] = true;
					} else {
						ldat[loaded] = false;
					}
				}
				if(ldat[isLeaf] === "true" || ldat[isLeaf] === true) {
					twrap += ((ldat[icon] !== undefined && ldat[icon] !== "") ? ldat[icon] : $t.p.treeIcons.leaf)+" tree-leaf treeclick";
					ldat[isLeaf] = true;
					lf="leaf";
				} else {
					ldat[isLeaf] = false;
					lf="";
				}
				ldat[expanded] = ((ldat[expanded] === "true" || ldat[expanded] === true) ? true : false) && (ldat[loaded] || ldat[loaded] === undefined);
				if(ldat[expanded] === false) {
					twrap += ((ldat[isLeaf] === true) ? "'" : $t.p.treeIcons.plus+" tree-plus treeclick'");
				} else {
					twrap += ((ldat[isLeaf] === true) ? "'" : $t.p.treeIcons.minus+" tree-minus treeclick'");
				}

				twrap += "></div></div>";
				$($t.rows[i].cells[expCol]).wrapInner("<span class='cell-wrapper"+lf+"'></span>").prepend(twrap);

				if(curLevel !== parseInt($t.p.tree_root_level,10)) {
					var pn = $($t).jqGrid('getNodeParent',ldat);
					expan = pn && pn.hasOwnProperty(expanded) ? pn[expanded] : true;
					if( !expan ){
						$($t.rows[i]).css("display","none");
					}
				}
				$($t.rows[i].cells[expCol])
					.find("div.treeclick")
					.bind("click",function(e){
						var target = e.target || e.srcElement,
						ind2 =$.jgrid.stripPref($t.p.idPrefix,$(target,$t.rows).closest("tr.jqgrow")[0].id),
						pos = $t.p._index[ind2];
						if(!$t.p.data[pos][isLeaf]){
							if($t.p.data[pos][expanded]){
								$($t).jqGrid("collapseRow",$t.p.data[pos]);
								$($t).jqGrid("collapseNode",$t.p.data[pos]);
							} else {
								$($t).jqGrid("expandRow",$t.p.data[pos]);
								$($t).jqGrid("expandNode",$t.p.data[pos]);
							}
						}
						return false;
					});
				if($t.p.ExpandColClick === true) {
					$($t.rows[i].cells[expCol])
						.find("span.cell-wrapper")
						.css("cursor","pointer")
						.bind("click",function(e) {
							var target = e.target || e.srcElement,
							ind2 =$.jgrid.stripPref($t.p.idPrefix,$(target,$t.rows).closest("tr.jqgrow")[0].id),
							pos = $t.p._index[ind2];
							if(!$t.p.data[pos][isLeaf]){
								if($t.p.data[pos][expanded]){
									$($t).jqGrid("collapseRow",$t.p.data[pos]);
									$($t).jqGrid("collapseNode",$t.p.data[pos]);
								} else {
									$($t).jqGrid("expandRow",$t.p.data[pos]);
									$($t).jqGrid("expandNode",$t.p.data[pos]);
								}
							}
							$($t).jqGrid("setSelection",ind2);
							return false;
						});
				}
				i++;
			}

		});
	},
	setTreeGrid : function() {
		return this.each(function (){
			var $t = this, i=0, pico, ecol = false, nm, key, tkey, dupcols=[];
			if(!$t.p.treeGrid) {return;}
			if(!$t.p.treedatatype ) {$.extend($t.p,{treedatatype: $t.p.datatype});}
			$t.p.subGrid = false;$t.p.altRows =false;
			$t.p.pgbuttons = false;$t.p.pginput = false;
			$t.p.gridview =  true;
			if($t.p.rowTotal === null ) { $t.p.rowNum = 10000; }
			$t.p.multiselect = false;$t.p.rowList = [];
			$t.p.expColInd = 0;
			pico = 'ui-icon-triangle-1-' + ($t.p.direction==="rtl" ? 'w' : 'e');
			$t.p.treeIcons = $.extend({plus:pico,minus:'ui-icon-triangle-1-s',leaf:'ui-icon-radio-off'},$t.p.treeIcons || {});
			if($t.p.treeGridModel === 'nested') {
				$t.p.treeReader = $.extend({
					level_field: "level",
					left_field:"lft",
					right_field: "rgt",
					leaf_field: "isLeaf",
					expanded_field: "expanded",
					loaded: "loaded",
					icon_field: "icon"
				},$t.p.treeReader);
			} else if($t.p.treeGridModel === 'adjacency') {
				$t.p.treeReader = $.extend({
						level_field: "level",
						parent_id_field: "parent",
						leaf_field: "isLeaf",
						expanded_field: "expanded",
						loaded: "loaded",
						icon_field: "icon"
				},$t.p.treeReader );
			}
			for ( key in $t.p.colModel){
				if($t.p.colModel.hasOwnProperty(key)) {
					nm = $t.p.colModel[key].name;
					if( nm === $t.p.ExpandColumn && !ecol ) {
						ecol = true;
						$t.p.expColInd = i;
					}
					i++;
					//
					for(tkey in $t.p.treeReader) {
						if($t.p.treeReader.hasOwnProperty(tkey) && $t.p.treeReader[tkey] === nm) {
							dupcols.push(nm);
						}
					}
				}
			}
			$.each($t.p.treeReader,function(j,n){
				if(n && $.inArray(n, dupcols) === -1){
					if(j==='leaf_field') { $t.p._treeleafpos= i; }
				i++;
					$t.p.colNames.push(n);
					$t.p.colModel.push({name:n,width:1,hidden:true,sortable:false,resizable:false,hidedlg:true,editable:true,search:false});
				}
			});
		});
	},
	expandRow: function (record){
		this.each(function(){
			var $t = this;
			if(!$t.grid || !$t.p.treeGrid) {return;}
			var childern = $($t).jqGrid("getNodeChildren",record),
			//if ($($t).jqGrid("isVisibleNode",record)) {
			expanded = $t.p.treeReader.expanded_field;
			$(childern).each(function(){
				var id  = $t.p.idPrefix + $.jgrid.getAccessor(this,$t.p.localReader.id);
				$($($t).jqGrid('getGridRowById', id)).css("display","");
				if(this[expanded]) {
					$($t).jqGrid("expandRow",this);
				}
			});
			//}
		});
	},
	collapseRow : function (record) {
		this.each(function(){
			var $t = this;
			if(!$t.grid || !$t.p.treeGrid) {return;}
			var childern = $($t).jqGrid("getNodeChildren",record),
			expanded = $t.p.treeReader.expanded_field;
			$(childern).each(function(){
				var id  = $t.p.idPrefix + $.jgrid.getAccessor(this,$t.p.localReader.id);
				$($($t).jqGrid('getGridRowById', id)).css("display","none");
				if(this[expanded]){
					$($t).jqGrid("collapseRow",this);
				}
			});
		});
	},
	// NS ,adjacency models
	getRootNodes : function() {
		var result = [];
		this.each(function(){
			var $t = this;
			if(!$t.grid || !$t.p.treeGrid) {return;}
			switch ($t.p.treeGridModel) {
				case 'nested' :
					var level = $t.p.treeReader.level_field;
					$($t.p.data).each(function(){
						if(parseInt(this[level],10) === parseInt($t.p.tree_root_level,10)) {
							result.push(this);
						}
					});
					break;
				case 'adjacency' :
					var parent_id = $t.p.treeReader.parent_id_field;
					$($t.p.data).each(function(){
						if(this[parent_id] === null || String(this[parent_id]).toLowerCase() === "null") {
							result.push(this);
						}
					});
					break;
			}
		});
		return result;
	},
	getNodeDepth : function(rc) {
		var ret = null;
		this.each(function(){
			if(!this.grid || !this.p.treeGrid) {return;}
			var $t = this;
			switch ($t.p.treeGridModel) {
				case 'nested' :
					var level = $t.p.treeReader.level_field;
					ret = parseInt(rc[level],10) - parseInt($t.p.tree_root_level,10);
					break;
				case 'adjacency' :
					ret = $($t).jqGrid("getNodeAncestors",rc).length;
					break;
			}
		});
		return ret;
	},
	getNodeParent : function(rc) {
		var result = null;
		this.each(function(){
			var $t = this;
			if(!$t.grid || !$t.p.treeGrid) {return;}
			switch ($t.p.treeGridModel) {
				case 'nested' :
					var lftc = $t.p.treeReader.left_field,
					rgtc = $t.p.treeReader.right_field,
					levelc = $t.p.treeReader.level_field,
					lft = parseInt(rc[lftc],10), rgt = parseInt(rc[rgtc],10), level = parseInt(rc[levelc],10);
					$(this.p.data).each(function(){
						if(parseInt(this[levelc],10) === level-1 && parseInt(this[lftc],10) < lft && parseInt(this[rgtc],10) > rgt) {
							result = this;
							return false;
						}
					});
					break;
				case 'adjacency' :
					var parent_id = $t.p.treeReader.parent_id_field,
					dtid = $t.p.localReader.id;
					$(this.p.data).each(function(){
						if(this[dtid] === $.jgrid.stripPref($t.p.idPrefix, rc[parent_id]) ) {
							result = this;
							return false;
						}
					});
					break;
			}
		});
		return result;
	},
	getNodeChildren : function(rc) {
		var result = [];
		this.each(function(){
			var $t = this;
			if(!$t.grid || !$t.p.treeGrid) {return;}
			switch ($t.p.treeGridModel) {
				case 'nested' :
					var lftc = $t.p.treeReader.left_field,
					rgtc = $t.p.treeReader.right_field,
					levelc = $t.p.treeReader.level_field,
					lft = parseInt(rc[lftc],10), rgt = parseInt(rc[rgtc],10), level = parseInt(rc[levelc],10);
					$(this.p.data).each(function(){
						if(parseInt(this[levelc],10) === level+1 && parseInt(this[lftc],10) > lft && parseInt(this[rgtc],10) < rgt) {
							result.push(this);
						}
					});
					break;
				case 'adjacency' :
					var parent_id = $t.p.treeReader.parent_id_field,
					dtid = $t.p.localReader.id;
					$(this.p.data).each(function(){
						if(this[parent_id] == $.jgrid.stripPref($t.p.idPrefix, rc[dtid])) {
							result.push(this);
						}
					});
					break;
			}
		});
		return result;
	},
	getFullTreeNode : function(rc) {
		var result = [];
		this.each(function(){
			var $t = this, len;
			if(!$t.grid || !$t.p.treeGrid) {return;}
			switch ($t.p.treeGridModel) {
				case 'nested' :
					var lftc = $t.p.treeReader.left_field,
					rgtc = $t.p.treeReader.right_field,
					levelc = $t.p.treeReader.level_field,
					lft = parseInt(rc[lftc],10), rgt = parseInt(rc[rgtc],10), level = parseInt(rc[levelc],10);
					$(this.p.data).each(function(){
						if(parseInt(this[levelc],10) >= level && parseInt(this[lftc],10) >= lft && parseInt(this[lftc],10) <= rgt) {
							result.push(this);
						}
					});
					break;
				case 'adjacency' :
					if(rc) {
					result.push(rc);
					var parent_id = $t.p.treeReader.parent_id_field,
					dtid = $t.p.localReader.id;
					$(this.p.data).each(function(i){
						len = result.length;
						for (i = 0; i < len; i++) {
							if ($.jgrid.stripPref($t.p.idPrefix, result[i][dtid]) === this[parent_id]) {
								result.push(this);
								break;
							}
						}
					});
					}
					break;
			}
		});
		return result;
	},
	// End NS, adjacency Model
	getNodeAncestors : function(rc) {
		var ancestors = [];
		this.each(function(){
			if(!this.grid || !this.p.treeGrid) {return;}
			var parent = $(this).jqGrid("getNodeParent",rc);
			while (parent) {
				ancestors.push(parent);
				parent = $(this).jqGrid("getNodeParent",parent);
			}
		});
		return ancestors;
	},
	isVisibleNode : function(rc) {
		var result = true;
		this.each(function(){
			var $t = this;
			if(!$t.grid || !$t.p.treeGrid) {return;}
			var ancestors = $($t).jqGrid("getNodeAncestors",rc),
			expanded = $t.p.treeReader.expanded_field;
			$(ancestors).each(function(){
				result = result && this[expanded];
				if(!result) {return false;}
			});
		});
		return result;
	},
	isNodeLoaded : function(rc) {
		var result;
		this.each(function(){
			var $t = this;
			if(!$t.grid || !$t.p.treeGrid) {return;}
			var isLeaf = $t.p.treeReader.leaf_field,
			loaded = $t.p.treeReader.loaded;
			if(rc !== undefined ) {
				if(rc[loaded] !== undefined) {
					result = rc[loaded];
				} else if( rc[isLeaf] || $($t).jqGrid("getNodeChildren",rc).length > 0){
					result = true;
				} else {
					result = false;
				}
			} else {
				result = false;
			}
		});
		return result;
	},
	expandNode : function(rc) {
		return this.each(function(){
			if(!this.grid || !this.p.treeGrid) {return;}
			var expanded = this.p.treeReader.expanded_field,
			parent = this.p.treeReader.parent_id_field,
			loaded = this.p.treeReader.loaded,
			level = this.p.treeReader.level_field,
			lft = this.p.treeReader.left_field,
			rgt = this.p.treeReader.right_field;

			if(!rc[expanded]) {
				var id = $.jgrid.getAccessor(rc,this.p.localReader.id);
				var rc1 = $("#" + this.p.idPrefix + $.jgrid.jqID(id),this.grid.bDiv)[0];
				var position = this.p._index[id];
				if( $(this).jqGrid("isNodeLoaded",this.p.data[position]) ) {
					rc[expanded] = true;
					$("div.treeclick",rc1).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus");
				} else if (!this.grid.hDiv.loading) {
					rc[expanded] = true;
					$("div.treeclick",rc1).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus");
					this.p.treeANode = rc1.rowIndex;
					this.p.datatype = this.p.treedatatype;
					if(this.p.treeGridModel === 'nested') {
						$(this).jqGrid("setGridParam",{postData:{nodeid:id,n_left:rc[lft],n_right:rc[rgt],n_level:rc[level]}});
					} else {
						$(this).jqGrid("setGridParam",{postData:{nodeid:id,parentid:rc[parent],n_level:rc[level]}} );
					}
					$(this).trigger("reloadGrid");
					rc[loaded] = true;
					if(this.p.treeGridModel === 'nested') {
						$(this).jqGrid("setGridParam",{postData:{nodeid:'',n_left:'',n_right:'',n_level:''}});
					} else {
						$(this).jqGrid("setGridParam",{postData:{nodeid:'',parentid:'',n_level:''}});
					}
				}
			}
		});
	},
	collapseNode : function(rc) {
		return this.each(function(){
			if(!this.grid || !this.p.treeGrid) {return;}
			var expanded = this.p.treeReader.expanded_field;
			if(rc[expanded]) {
				rc[expanded] = false;
				var id = $.jgrid.getAccessor(rc,this.p.localReader.id);
				var rc1 = $("#" + this.p.idPrefix + $.jgrid.jqID(id),this.grid.bDiv)[0];
				$("div.treeclick",rc1).removeClass(this.p.treeIcons.minus+" tree-minus").addClass(this.p.treeIcons.plus+" tree-plus");
			}
		});
	},
	SortTree : function( sortname, newDir, st, datefmt) {
		return this.each(function(){
			if(!this.grid || !this.p.treeGrid) {return;}
			var i, len,
			rec, records = [], $t = this, query, roots,
			rt = $(this).jqGrid("getRootNodes");
			// Sorting roots
			query = $.jgrid.from(rt);
			query.orderBy(sortname,newDir,st, datefmt);
			roots = query.select();

			// Sorting children
			for (i = 0, len = roots.length; i < len; i++) {
				rec = roots[i];
				records.push(rec);
				$(this).jqGrid("collectChildrenSortTree",records, rec, sortname, newDir,st, datefmt);
			}
			$.each(records, function(index) {
				var id  = $.jgrid.getAccessor(this,$t.p.localReader.id);
				$('#'+$.jgrid.jqID($t.p.id)+ ' tbody tr:eq('+index+')').after($('tr#'+$.jgrid.jqID(id),$t.grid.bDiv));
			});
			query = null;roots=null;records=null;
		});
	},
	collectChildrenSortTree : function(records, rec, sortname, newDir,st, datefmt) {
		return this.each(function(){
			if(!this.grid || !this.p.treeGrid) {return;}
			var i, len,
			child, ch, query, children;
			ch = $(this).jqGrid("getNodeChildren",rec);
			query = $.jgrid.from(ch);
			query.orderBy(sortname, newDir, st, datefmt);
			children = query.select();
			for (i = 0, len = children.length; i < len; i++) {
				child = children[i];
				records.push(child);
				$(this).jqGrid("collectChildrenSortTree",records, child, sortname, newDir, st, datefmt);
			}
		});
	},
	// experimental
	setTreeRow : function(rowid, data) {
		var success=false;
		this.each(function(){
			var t = this;
			if(!t.grid || !t.p.treeGrid) {return;}
			success = $(t).jqGrid("setRowData",rowid,data);
		});
		return success;
	},
	delTreeNode : function (rowid) {
		return this.each(function () {
			var $t = this, rid = $t.p.localReader.id, i,
			left = $t.p.treeReader.left_field,
			right = $t.p.treeReader.right_field, myright, width, res, key;
			if(!$t.grid || !$t.p.treeGrid) {return;}
			var rc = $t.p._index[rowid];
			if (rc !== undefined) {
				// nested
				myright = parseInt($t.p.data[rc][right],10);
				width = myright -  parseInt($t.p.data[rc][left],10) + 1;
				var dr = $($t).jqGrid("getFullTreeNode",$t.p.data[rc]);
				if(dr.length>0){
					for (i=0;i<dr.length;i++){
						$($t).jqGrid("delRowData",dr[i][rid]);
					}
				}
				if( $t.p.treeGridModel === "nested") {
					// ToDo - update grid data
					res = $.jgrid.from($t.p.data)
						.greater(left,myright,{stype:'integer'})
						.select();
					if(res.length) {
						for( key in res) {
							if(res.hasOwnProperty(key)) {
								res[key][left] = parseInt(res[key][left],10) - width ;
							}
						}
					}
					res = $.jgrid.from($t.p.data)
						.greater(right,myright,{stype:'integer'})
						.select();
					if(res.length) {
						for( key in res) {
							if(res.hasOwnProperty(key)) {
								res[key][right] = parseInt(res[key][right],10) - width ;
							}
						}
					}
				}
			}
		});
	},
	addChildNode : function( nodeid, parentid, data, expandData ) {
		//return this.each(function(){
		var $t = this[0];
		if(data) {
			// we suppose tha the id is autoincremet and
			var expanded = $t.p.treeReader.expanded_field,
			isLeaf = $t.p.treeReader.leaf_field,
			level = $t.p.treeReader.level_field,
			//icon = $t.p.treeReader.icon_field,
			parent = $t.p.treeReader.parent_id_field,
			left = $t.p.treeReader.left_field,
			right = $t.p.treeReader.right_field,
			loaded = $t.p.treeReader.loaded,
			method, parentindex, parentdata, parentlevel, i, len, max=0, rowind = parentid, leaf, maxright;
			if(expandData===undefined) {expandData = false;}
			if ( nodeid === undefined || nodeid === null ) {
				i = $t.p.data.length-1;
				if(	i>= 0 ) {
					while(i>=0){max = Math.max(max, parseInt($t.p.data[i][$t.p.localReader.id],10)); i--;}
				}
				nodeid = max+1;
			}
			var prow = $($t).jqGrid('getInd', parentid);
			leaf = false;
			// if not a parent we assume root
			if ( parentid === undefined  || parentid === null || parentid==="") {
				parentid = null;
				rowind = null;
				method = 'last';
				parentlevel = $t.p.tree_root_level;
				i = $t.p.data.length+1;
			} else {
				method = 'after';
				parentindex = $t.p._index[parentid];
				parentdata = $t.p.data[parentindex];
				parentid = parentdata[$t.p.localReader.id];
				parentlevel = parseInt(parentdata[level],10)+1;
				var childs = $($t).jqGrid('getFullTreeNode', parentdata);
				// if there are child nodes get the last index of it
				if(childs.length) {
					i = childs[childs.length-1][$t.p.localReader.id];
					rowind = i;
					i = $($t).jqGrid('getInd',rowind)+1;
				} else {
					i = $($t).jqGrid('getInd', parentid)+1;
				}
				// if the node is leaf
				if(parentdata[isLeaf]) {
					leaf = true;
					parentdata[expanded] = true;
					//var prow = $($t).jqGrid('getInd', parentid);
					$($t.rows[prow])
						.find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper")
						.end()
						.find("div.tree-leaf").removeClass($t.p.treeIcons.leaf+" tree-leaf").addClass($t.p.treeIcons.minus+" tree-minus");
					$t.p.data[parentindex][isLeaf] = false;
					parentdata[loaded] = true;
				}
			}
			len = i+1;

			if( data[expanded]===undefined)  {data[expanded]= false;}
			if( data[loaded]===undefined )  { data[loaded] = false;}
			data[level] = parentlevel;
			if( data[isLeaf]===undefined) {data[isLeaf]= true;}
			if( $t.p.treeGridModel === "adjacency") {
				data[parent] = parentid;
			}
			if( $t.p.treeGridModel === "nested") {
				// this method requiere more attention
				var query, res, key;
				//maxright = parseInt(maxright,10);
				// ToDo - update grid data
				if(parentid !== null) {
					maxright = parseInt(parentdata[right],10);
					query = $.jgrid.from($t.p.data);
					query = query.greaterOrEquals(right,maxright,{stype:'integer'});
					res = query.select();
					if(res.length) {
						for( key in res) {
							if(res.hasOwnProperty(key)) {
								res[key][left] = res[key][left] > maxright ? parseInt(res[key][left],10) +2 : res[key][left];
								res[key][right] = res[key][right] >= maxright ? parseInt(res[key][right],10) +2 : res[key][right];
							}
						}
					}
					data[left] = maxright;
					data[right]= maxright+1;
				} else {
					maxright = parseInt( $($t).jqGrid('getCol', right, false, 'max'), 10);
					res = $.jgrid.from($t.p.data)
						.greater(left,maxright,{stype:'integer'})
						.select();
					if(res.length) {
						for( key in res) {
							if(res.hasOwnProperty(key)) {
								res[key][left] = parseInt(res[key][left],10) +2 ;
							}
						}
					}
					res = $.jgrid.from($t.p.data)
						.greater(right,maxright,{stype:'integer'})
						.select();
					if(res.length) {
						for( key in res) {
							if(res.hasOwnProperty(key)) {
								res[key][right] = parseInt(res[key][right],10) +2 ;
							}
						}
					}
					data[left] = maxright+1;
					data[right] = maxright + 2;
				}
			}
			if( parentid === null || $($t).jqGrid("isNodeLoaded",parentdata) || leaf ) {
					$($t).jqGrid('addRowData', nodeid, data, method, rowind);
					$($t).jqGrid('setTreeNode', i, len);
			}
			if(parentdata && !parentdata[expanded] && expandData) {
				$($t.rows[prow])
					.find("div.treeclick")
					.click();
			}
		}
		//});
	}
});
})(jQuery);
/*jshint eqeqeq:false, eqnull:true */
/*global jQuery */
// Grouping module
(function($){
"use strict";
$.extend($.jgrid,{
	template : function(format){ //jqgformat
		var args = $.makeArray(arguments).slice(1), j, al = args.length;
		if(format==null) { format = ""; }
		return format.replace(/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g, function(m,i){
			if(!isNaN(parseInt(i,10))) {
				return args[parseInt(i,10)];
			}
			for(j=0; j < al;j++) {
				if($.isArray(args[j])) {
					var nmarr = args[ j ],
					k = nmarr.length;
					while(k--) {
						if(i===nmarr[k].nm) {
							return nmarr[k].v;
						}
					}
				}
			}
		});
	}
});
$.jgrid.extend({
	groupingSetup : function () {
		return this.each(function (){
			var $t = this, i, j, cml, cm = $t.p.colModel, grp = $t.p.groupingView;
			if(grp !== null && ( (typeof grp === 'object') || $.isFunction(grp) ) ) {
				if(!grp.groupField.length) {
					$t.p.grouping = false;
				} else {
					if (grp.visibiltyOnNextGrouping === undefined) {
						grp.visibiltyOnNextGrouping = [];
					}

					grp.lastvalues=[];
					if(!grp._locgr) {
						grp.groups =[];
					}
					grp.counters =[];
					for(i=0;i<grp.groupField.length;i++) {
						if(!grp.groupOrder[i]) {
							grp.groupOrder[i] = 'asc';
						}
						if(!grp.groupText[i]) {
							grp.groupText[i] = '{0}';
						}
						if( typeof grp.groupColumnShow[i] !== 'boolean') {
							grp.groupColumnShow[i] = true;
						}
						if( typeof grp.groupSummary[i] !== 'boolean') {
							grp.groupSummary[i] = false;
						}
						if( !grp.groupSummaryPos[i]) {
							grp.groupSummaryPos[i] = 'footer';
						}
						if(grp.groupColumnShow[i] === true) {
							grp.visibiltyOnNextGrouping[i] = true;
							$($t).jqGrid('showCol',grp.groupField[i]);
						} else {
							grp.visibiltyOnNextGrouping[i] = $("#"+$.jgrid.jqID($t.p.id+"_"+grp.groupField[i])).is(":visible");
							$($t).jqGrid('hideCol',grp.groupField[i]);
						}
					}
					grp.summary =[];
					if(grp.hideFirstGroupCol) {
						grp.formatDisplayField[0] = function (v) { return v;};
					}
					for(j=0, cml = cm.length; j < cml; j++) {
						if(grp.hideFirstGroupCol) {
							if(!cm[j].hidden && grp.groupField[0] === cm[j].name) {
								cm[j].formatter = function(){return '';};
							}
						}
						if(cm[j].summaryType ) {
							if(cm[j].summaryDivider) {
								grp.summary.push({nm:cm[j].name,st:cm[j].summaryType, v: '', sd:cm[j].summaryDivider, vd:'', sr: cm[j].summaryRound, srt: cm[j].summaryRoundType || 'round'});
							} else {
								grp.summary.push({nm:cm[j].name,st:cm[j].summaryType, v: '', sr: cm[j].summaryRound, srt: cm[j].summaryRoundType || 'round'});
							}
						}
					}
				}
			} else {
				$t.p.grouping = false;
			}
		});
	},
	groupingPrepare : function ( record, irow ) {
		this.each(function(){
			var grp = this.p.groupingView, $t= this, i,
			grlen = grp.groupField.length,
			fieldName,
			v,
			displayName,
			displayValue,
			changed = 0;
			for(i=0;i<grlen;i++) {
				fieldName = grp.groupField[i];
				displayName = grp.displayField[i];
				v = record[fieldName];
				displayValue = displayName == null ? null : record[displayName];

				if( displayValue == null ) {
					displayValue = v;
				}
				if( v !== undefined ) {
					if(irow === 0 ) {
						// First record always starts a new group
						grp.groups.push({idx:i,dataIndex:fieldName,value:v, displayValue: displayValue, startRow: irow, cnt:1, summary : [] } );
						grp.lastvalues[i] = v;
						grp.counters[i] = {cnt:1, pos:grp.groups.length-1, summary: $.extend(true,[],grp.summary)};
						$.each(grp.counters[i].summary,function() {
							if ($.isFunction(this.st)) {
								this.v = this.st.call($t, this.v, this.nm, record);
							} else {
								this.v = $($t).jqGrid('groupingCalculations.handler',this.st, this.v, this.nm, this.sr, this.srt, record);
								if(this.st.toLowerCase() === 'avg' && this.sd) {
									this.vd = $($t).jqGrid('groupingCalculations.handler',this.st, this.vd, this.sd, this.sr, this.srt, record);
								}
							}
						});
						grp.groups[grp.counters[i].pos].summary = grp.counters[i].summary;
					} else {
						if (typeof v !== "object" && ($.isArray(grp.isInTheSameGroup) && $.isFunction(grp.isInTheSameGroup[i]) ? ! grp.isInTheSameGroup[i].call($t, grp.lastvalues[i], v, i, grp): grp.lastvalues[i] !== v)) {
							// This record is not in same group as previous one
							grp.groups.push({idx:i,dataIndex:fieldName,value:v, displayValue: displayValue, startRow: irow, cnt:1, summary : [] } );
							grp.lastvalues[i] = v;
							changed = 1;
							grp.counters[i] = {cnt:1, pos:grp.groups.length-1, summary: $.extend(true,[],grp.summary)};
							$.each(grp.counters[i].summary,function() {
								if ($.isFunction(this.st)) {
									this.v = this.st.call($t, this.v, this.nm, record);
								} else {
									this.v = $($t).jqGrid('groupingCalculations.handler',this.st, this.v, this.nm, this.sr, this.srt, record);
									if(this.st.toLowerCase() === 'avg' && this.sd) {
										this.vd = $($t).jqGrid('groupingCalculations.handler',this.st, this.vd, this.sd, this.sr, this.srt, record);
									}
								}
							});
							grp.groups[grp.counters[i].pos].summary = grp.counters[i].summary;
						} else {
							if (changed === 1) {
								// This group has changed because an earlier group changed.
								grp.groups.push({idx:i,dataIndex:fieldName,value:v, displayValue: displayValue, startRow: irow, cnt:1, summary : [] } );
								grp.lastvalues[i] = v;
								grp.counters[i] = {cnt:1, pos:grp.groups.length-1, summary: $.extend(true,[],grp.summary)};
								$.each(grp.counters[i].summary,function() {
									if ($.isFunction(this.st)) {
										this.v = this.st.call($t, this.v, this.nm, record);
									} else {
										this.v = $($t).jqGrid('groupingCalculations.handler',this.st, this.v, this.nm, this.sr, this.srt, record);
										if(this.st.toLowerCase() === 'avg' && this.sd) {
											this.vd = $($t).jqGrid('groupingCalculations.handler',this.st, this.vd, this.sd, this.sr, this.srt, record);
										}
									}
								});
								grp.groups[grp.counters[i].pos].summary = grp.counters[i].summary;
							} else {
								grp.counters[i].cnt += 1;
								grp.groups[grp.counters[i].pos].cnt = grp.counters[i].cnt;
								$.each(grp.counters[i].summary,function() {
									if ($.isFunction(this.st)) {
										this.v = this.st.call($t, this.v, this.nm, record);
									} else {
										this.v = $($t).jqGrid('groupingCalculations.handler',this.st, this.v, this.nm, this.sr, this.srt, record);
										if(this.st.toLowerCase() === 'avg' && this.sd) {
											this.vd = $($t).jqGrid('groupingCalculations.handler',this.st, this.vd, this.sd, this.sr, this.srt, record);
										}
									}
								});
								grp.groups[grp.counters[i].pos].summary = grp.counters[i].summary;
							}
						}
					}
				}
			}
			//gdata.push( rData );
		});
		return this;
	},
	groupingToggle : function(hid){
		this.each(function(){
			var $t = this,
			grp = $t.p.groupingView,
			strpos = hid.split('_'),
			num = parseInt(strpos[strpos.length-2], 10);
			strpos.splice(strpos.length-2,2);
			var uid = strpos.join("_"),
			minus = grp.minusicon,
			plus = grp.plusicon,
			tar = $("#"+$.jgrid.jqID(hid)),
			r = tar.length ? tar[0].nextSibling : null,
			tarspan = $("#"+$.jgrid.jqID(hid)+" span."+"tree-wrap-"+$t.p.direction),
			getGroupingLevelFromClass = function (className) {
				var nums = $.map(className.split(" "), function (item) {
					if (item.substring(0, uid.length + 1) === uid + "_") {
						return parseInt(item.substring(uid.length + 1), 10);
					}
				});
				return nums.length > 0 ? nums[0] : undefined;
			},
			itemGroupingLevel,
			showData,
			collapsed = false,
			frz = $t.p.frozenColumns ? $t.p.id+"_frozen" : false,
			tar2 = frz ? $("#"+$.jgrid.jqID(hid), "#"+$.jgrid.jqID(frz) ) : false,
			r2 = (tar2 && tar2.length) ? tar2[0].nextSibling : null;
			if( tarspan.hasClass(minus) ) {
				if(grp.showSummaryOnHide) {
					if(r){
						while(r) {
							if($(r).hasClass('jqfoot') ) {
								var lv = parseInt($(r).attr("jqfootlevel"),10);
								if(  lv <= num) {
									break;
								}
							}
							$(r).hide();
							r = r.nextSibling;
							if(frz) {
								$(r2).hide();
								r2 = r2.nextSibling;
							}
						}
					}
				} else  {
					if(r){
						while(r) {
							itemGroupingLevel = getGroupingLevelFromClass(r.className);
							if (itemGroupingLevel !== undefined && itemGroupingLevel <= num) {
								break;
							}
							$(r).hide();
							r = r.nextSibling;
							if(frz) {
								$(r2).hide();
								r2 = r2.nextSibling;
							}
						}
					}
				}
				tarspan.removeClass(minus).addClass(plus);
				collapsed = true;
			} else {
				if(r){
					showData = undefined;
					while(r) {
						itemGroupingLevel = getGroupingLevelFromClass(r.className);
						if (showData === undefined) {
							showData = itemGroupingLevel === undefined; // if the first row after the opening group is data row then show the data rows
						}
						if (itemGroupingLevel !== undefined) {
							if (itemGroupingLevel <= num) {
								break;// next item of the same lever are found
							}
							if (itemGroupingLevel === num + 1) {
								$(r).show().find(">td>span."+"tree-wrap-"+$t.p.direction).removeClass(minus).addClass(plus);
								if(frz) {
									$(r2).show().find(">td>span."+"tree-wrap-"+$t.p.direction).removeClass(minus).addClass(plus);
								}
							}
						} else if (showData) {
							$(r).show();
							if(frz) {
								$(r2).show();
							}
						}
						r = r.nextSibling;
						if(frz) {
							r2 = r2.nextSibling;
						}
					}
				}
				tarspan.removeClass(plus).addClass(minus);
			}
			$($t).triggerHandler("jqGridGroupingClickGroup", [hid , collapsed]);
			if( $.isFunction($t.p.onClickGroup)) { $t.p.onClickGroup.call($t, hid , collapsed); }

		});
		return false;
	},
	groupingRender : function (grdata, colspans, page, rn ) {
		return this.each(function(){
			var $t = this,
			grp = $t.p.groupingView,
			str = "", icon = "", hid, clid, pmrtl = grp.groupCollapse ? grp.plusicon : grp.minusicon, gv, cp=[], len =grp.groupField.length;
			pmrtl += " tree-wrap-"+$t.p.direction;
			$.each($t.p.colModel, function (i,n){
				var ii;
				for(ii=0;ii<len;ii++) {
					if(grp.groupField[ii] === n.name ) {
						cp[ii] = i;
						break;
					}
				}
			});
			var toEnd = 0;
			function findGroupIdx( ind , offset, grp) {
				var ret = false, i;
				if(offset===0) {
					ret = grp[ind];
				} else {
					var id = grp[ind].idx;
					if(id===0) {
						ret = grp[ind];
					}  else {
						for(i=ind;i >= 0; i--) {
							if(grp[i].idx === id-offset) {
								ret = grp[i];
								break;
							}
						}
					}
				}
				return ret;
			}
			function buildSummaryTd(i, ik, grp, foffset) {
				var fdata = findGroupIdx(i, ik, grp),
				cm = $t.p.colModel,
				vv, grlen = fdata.cnt, str="", k;
				for(k=foffset; k<colspans;k++) {
					var tmpdata = "<td "+$t.formatCol(k,1,'')+">&#160;</td>",
					tplfld = "{0}";
					$.each(fdata.summary,function(){
						if(this.nm === cm[k].name) {
							if(cm[k].summaryTpl)  {
								tplfld = cm[k].summaryTpl;
							}
							if(typeof this.st === 'string' && this.st.toLowerCase() === 'avg') {
								if(this.sd && this.vd) {
									this.v = (this.v/this.vd);
								} else if(this.v && grlen > 0) {
									this.v = (this.v/grlen);
								}
							}
							try {
								this.groupCount = fdata.cnt;
								this.groupIndex = fdata.dataIndex;
								this.groupValue = fdata.value;
								vv = $t.formatter('', this.v, k, this);
							} catch (ef) {
								vv = this.v;
							}
							tmpdata= "<td "+$t.formatCol(k,1,'')+">"+$.jgrid.format(tplfld,vv)+ "</td>";
							return false;
						}
					});
					str += tmpdata;
				}
				return str;
			}
			var sumreverse = $.makeArray(grp.groupSummary);
			sumreverse.reverse();
			$.each(grp.groups,function(i,n){
				if(grp._locgr) {
					if( !(n.startRow +n.cnt > (page-1)*rn && n.startRow < page*rn)) {
						return true;
					}
				}
				toEnd++;
				clid = $t.p.id+"ghead_"+n.idx;
				hid = clid+"_"+i;
				icon = "<span style='cursor:pointer;' class='ui-icon "+pmrtl+"' onclick=\"jQuery('#"+$.jgrid.jqID($t.p.id)+"').jqGrid('groupingToggle','"+hid+"');return false;\"></span>";
				try {
					if ($.isArray(grp.formatDisplayField) && $.isFunction(grp.formatDisplayField[n.idx])) {
						n.displayValue = grp.formatDisplayField[n.idx].call($t, n.displayValue, n.value, $t.p.colModel[cp[n.idx]], n.idx, grp);
						gv = n.displayValue;
					} else {
						gv = $t.formatter(hid, n.displayValue, cp[n.idx], n.value );
					}
				} catch (egv) {
					gv = n.displayValue;
				}
				if(grp.groupSummaryPos[n.idx] === 'header')  {
					str += "<tr id=\""+hid+"\"" +(grp.groupCollapse && n.idx>0 ? " style=\"display:none;\" " : " ") + "role=\"row\" class= \"ui-widget-content jqgroup ui-row-"+$t.p.direction+" "+clid+"\"><td style=\"padding-left:"+(n.idx * 12) + "px;"+"\">"+icon+$.jgrid.template(grp.groupText[n.idx], gv, n.cnt, n.summary)+"</td>";
					str += buildSummaryTd(i, n.idx-1, grp.groups, 1);
					str += "</tr>";
				} else {
					str += "<tr id=\""+hid+"\"" +(grp.groupCollapse && n.idx>0 ? " style=\"display:none;\" " : " ") + "role=\"row\" class= \"ui-widget-content jqgroup ui-row-"+$t.p.direction+" "+clid+"\"><td style=\"padding-left:"+(n.idx * 12) + "px;"+"\" colspan=\""+colspans+"\">"+icon+$.jgrid.template(grp.groupText[n.idx], gv, n.cnt, n.summary)+"</td></tr>";
				}
				var leaf = len-1 === n.idx;
				if( leaf ) {
					var gg = grp.groups[i+1], kk, ik, offset = 0, sgr = n.startRow,
					end = gg !== undefined ?  grp.groups[i+1].startRow : grdata.length;
					if(grp._locgr) {
						offset = (page-1)*rn;
						if(offset > n.startRow) {
							sgr = offset;
						}
					}
					for(kk=sgr;kk<end;kk++) {
						if(!grdata[kk - offset]) { break; }
						str += grdata[kk - offset].join('');
					}
					if(grp.groupSummaryPos[n.idx] !== 'header') {
						var jj;
						if (gg !== undefined) {
							for (jj = 0; jj < grp.groupField.length; jj++) {
								if (gg.dataIndex === grp.groupField[jj]) {
									break;
								}
							}
							toEnd = grp.groupField.length - jj;
						}
						for (ik = 0; ik < toEnd; ik++) {
							if(!sumreverse[ik]) { continue; }
							var hhdr = "";
							if(grp.groupCollapse && !grp.showSummaryOnHide) {
								hhdr = " style=\"display:none;\"";
							}
							str += "<tr"+hhdr+" jqfootlevel=\""+(n.idx-ik)+"\" role=\"row\" class=\"ui-widget-content jqfoot ui-row-"+$t.p.direction+"\">";
							str += buildSummaryTd(i, ik, grp.groups, 0);
							str += "</tr>";
						}
						toEnd = jj;
					}
				}
			});
			$("#"+$.jgrid.jqID($t.p.id)+" tbody:first").append(str);
			// free up memory
			str = null;
		});
	},
	groupingGroupBy : function (name, options ) {
		return this.each(function(){
			var $t = this;
			if(typeof name === "string") {
				name = [name];
			}
			var grp = $t.p.groupingView;
			$t.p.grouping = true;

			//Set default, in case visibilityOnNextGrouping is undefined
			if (grp.visibiltyOnNextGrouping === undefined) {
				grp.visibiltyOnNextGrouping = [];
			}
			var i;
			// show previous hidden groups if they are hidden and weren't removed yet
			for(i=0;i<grp.groupField.length;i++) {
				if(!grp.groupColumnShow[i] && grp.visibiltyOnNextGrouping[i]) {
				$($t).jqGrid('showCol',grp.groupField[i]);
				}
			}
			// set visibility status of current group columns on next grouping
			for(i=0;i<name.length;i++) {
				grp.visibiltyOnNextGrouping[i] = $("#"+$.jgrid.jqID($t.p.id)+"_"+$.jgrid.jqID(name[i])).is(":visible");
			}
			$t.p.groupingView = $.extend($t.p.groupingView, options || {});
			grp.groupField = name;
			$($t).trigger("reloadGrid");
		});
	},
	groupingRemove : function (current) {
		return this.each(function(){
			var $t = this;
			if(current === undefined) {
				current = true;
			}
			$t.p.grouping = false;
			if(current===true) {
				var grp = $t.p.groupingView, i;
				// show previous hidden groups if they are hidden and weren't removed yet
				for(i=0;i<grp.groupField.length;i++) {
				if (!grp.groupColumnShow[i] && grp.visibiltyOnNextGrouping[i]) {
						$($t).jqGrid('showCol', grp.groupField);
					}
				}
				$("tr.jqgroup, tr.jqfoot","#"+$.jgrid.jqID($t.p.id)+" tbody:first").remove();
				$("tr.jqgrow:hidden","#"+$.jgrid.jqID($t.p.id)+" tbody:first").show();
			} else {
				$($t).trigger("reloadGrid");
			}
		});
	},
	groupingCalculations : {
		handler: function(fn, v, field, round, roundType, rc) {
			var funcs = {
				sum: function() {
					return parseFloat(v||0) + parseFloat((rc[field]||0));
				},

				min: function() {
					if(v==="") {
						return parseFloat(rc[field]||0);
					}
					return Math.min(parseFloat(v),parseFloat(rc[field]||0));
				},

				max: function() {
					if(v==="") {
						return parseFloat(rc[field]||0);
					}
					return Math.max(parseFloat(v),parseFloat(rc[field]||0));
				},

				count: function() {
					if(v==="") {v=0;}
					if(rc.hasOwnProperty(field)) {
						return v+1;
					}
					return 0;
				},

				avg: function() {
					// the same as sum, but at end we divide it
					// so use sum instead of duplicating the code (?)
					return funcs.sum();
				}
			};

			if(!funcs[fn]) {
				throw ("jqGrid Grouping No such method: " + fn);
			}
			var res = funcs[fn]();

			if (round != null) {
				if (roundType === 'fixed') {
					res = res.toFixed(round);
				} else {
					var mul = Math.pow(10, round);
					res = Math.round(res * mul) / mul;
				}
			}

			return res;
		}
	}
});
})(jQuery);
/*jshint eqeqeq:false, eqnull:true, devel:true */
/*global jQuery, xmlJsonClass */
(function($){
/*
 * jqGrid extension for constructing Grid Data from external file
 * Tony Tomov tony@trirand.com
 * http://trirand.com/blog/
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
**/

"use strict";
    $.jgrid.extend({
        jqGridImport : function(o) {
            o = $.extend({
                imptype : "xml", // xml, json, xmlstring, jsonstring
                impstring: "",
                impurl: "",
                mtype: "GET",
                impData : {},
                xmlGrid :{
                    config : "roots>grid",
                    data: "roots>rows"
                },
                jsonGrid :{
                    config : "grid",
                    data: "data"
                },
                ajaxOptions :{}
            }, o || {});
            return this.each(function(){
                var $t = this;
                var xmlConvert = function (xml,o) {
                    var cnfg = $(o.xmlGrid.config,xml)[0];
                    var xmldata = $(o.xmlGrid.data,xml)[0], jstr, jstr1, key;
                    if(xmlJsonClass.xml2json && $.jgrid.parse) {
                        jstr = xmlJsonClass.xml2json(cnfg," ");
                        jstr = $.jgrid.parse(jstr);
                        for(key in jstr) {
                            if(jstr.hasOwnProperty(key)) {
                                jstr1=jstr[key];
                            }
                        }
                        if(xmldata) {
                        // save the datatype
                            var svdatatype = jstr.grid.datatype;
                            jstr.grid.datatype = 'xmlstring';
                            jstr.grid.datastr = xml;
                            $($t).jqGrid( jstr1 ).jqGrid("setGridParam",{datatype:svdatatype});
                        } else {
                            $($t).jqGrid( jstr1 );
                        }
                        jstr = null;jstr1=null;
                    } else {
                        alert("xml2json or parse are not present");
                    }
                };
                var jsonConvert = function (jsonstr,o){
                    if (jsonstr && typeof jsonstr === 'string') {
						var _jsonparse = false;
						if($.jgrid.useJSON) {
							$.jgrid.useJSON = false;
							_jsonparse = true;
						}
                        var json = $.jgrid.parse(jsonstr);
						if(_jsonparse) { $.jgrid.useJSON = true; }
                        var gprm = json[o.jsonGrid.config];
                        var jdata = json[o.jsonGrid.data];
                        if(jdata) {
                            var svdatatype = gprm.datatype;
                            gprm.datatype = 'jsonstring';
                            gprm.datastr = jdata;
                            $($t).jqGrid( gprm ).jqGrid("setGridParam",{datatype:svdatatype});
                        } else {
                            $($t).jqGrid( gprm );
                        }
                    }
                };
                switch (o.imptype){
                    case 'xml':
                        $.ajax($.extend({
                            url:o.impurl,
                            type:o.mtype,
                            data: o.impData,
                            dataType:"xml",
                            complete: function(xml,stat) {
                                if(stat === 'success') {
                                    xmlConvert(xml.responseXML,o);
                                    $($t).triggerHandler("jqGridImportComplete", [xml, o]);
                                    if($.isFunction(o.importComplete)) {
                                        o.importComplete(xml);
                                    }
                                }
                                xml=null;
                            }
                        }, o.ajaxOptions));
                        break;
                    case 'xmlstring' :
                        // we need to make just the conversion and use the same code as xml
                        if(o.impstring && typeof o.impstring === 'string') {
                            var xmld = $.parseXML(o.impstring);
                            if(xmld) {
                                xmlConvert(xmld,o);
                                $($t).triggerHandler("jqGridImportComplete", [xmld, o]);
                                if($.isFunction(o.importComplete)) {
                                    o.importComplete(xmld);
                                }
                                o.impstring = null;
                            }
                            xmld = null;
                        }
                        break;
                    case 'json':
                        $.ajax($.extend({
                            url:o.impurl,
                            type:o.mtype,
                            data: o.impData,
                            dataType:"json",
                            complete: function(json) {
                                try {
                                    jsonConvert(json.responseText,o );
                                    $($t).triggerHandler("jqGridImportComplete", [json, o]);
                                    if($.isFunction(o.importComplete)) {
                                        o.importComplete(json);
                                    }
                                } catch (ee){}
                                json=null;
                            }
                        }, o.ajaxOptions ));
                        break;
                    case 'jsonstring' :
                        if(o.impstring && typeof o.impstring === 'string') {
                            jsonConvert(o.impstring,o );
                            $($t).triggerHandler("jqGridImportComplete", [o.impstring, o]);
                            if($.isFunction(o.importComplete)) {
                                o.importComplete(o.impstring);
                            }
                            o.impstring = null;
                        }
                        break;
                }
            });
        },
        jqGridExport : function(o) {
            o = $.extend({
                exptype : "xmlstring",
                root: "grid",
                ident: "\t"
            }, o || {});
            var ret = null;
            this.each(function () {
                if(!this.grid) { return;}
                var key, gprm = $.extend(true, {},$(this).jqGrid("getGridParam"));
                // we need to check for:
                // 1.multiselect, 2.subgrid  3. treegrid and remove the unneded columns from colNames
                if(gprm.rownumbers) {
                    gprm.colNames.splice(0,1);
                    gprm.colModel.splice(0,1);
                }
                if(gprm.multiselect) {
                    gprm.colNames.splice(0,1);
                    gprm.colModel.splice(0,1);
                }
                if(gprm.subGrid) {
                    gprm.colNames.splice(0,1);
                    gprm.colModel.splice(0,1);
                }
                gprm.knv = null;
                if(gprm.treeGrid) {
                    for (key in gprm.treeReader) {
                        if(gprm.treeReader.hasOwnProperty(key)) {
                            gprm.colNames.splice(gprm.colNames.length-1);
                            gprm.colModel.splice(gprm.colModel.length-1);
                        }
                    }
                }
                switch (o.exptype) {
                    case 'xmlstring' :
                        ret = "<"+o.root+">"+xmlJsonClass.json2xml(gprm,o.ident)+"</"+o.root+">";
                        break;
                    case 'jsonstring' :
                        ret = "{"+ xmlJsonClass.toJson(gprm,o.root,o.ident,false)+"}";
                        if(gprm.postData.filters !== undefined) {
                            ret=ret.replace(/filters":"/,'filters":');
                            ret=ret.replace(/}]}"/,'}]}');
                        }
                        break;
                }
            });
            return ret;
        },
        excelExport : function(o) {
            o = $.extend({
                exptype : "remote",
                url : null,
                oper: "oper",
                tag: "excel",
                exportOptions : {}
            }, o || {});
            return this.each(function(){
                if(!this.grid) { return;}
                var url;
                if(o.exptype === "remote") {
                    var pdata = $.extend({},this.p.postData);
                    pdata[o.oper] = o.tag;
                    var params = jQuery.param(pdata);
                    if(o.url.indexOf("?") !== -1) { url = o.url+"&"+params; }
                    else { url = o.url+"?"+params; }
                    window.location = url;
                }
            });
        }
    });
})(jQuery);
/*jshint evil:true, eqeqeq:false, eqnull:true, devel:true */
/*global jQuery */
(function($){
/*
**
 * jqGrid addons using jQuery UI
 * Author: Mark Williams
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
 * depends on jQuery UI
**/
"use strict";
if ($.jgrid.msie && $.jgrid.msiever()===8) {
	$.expr[":"].hidden = function(elem) {
		return elem.offsetWidth === 0 || elem.offsetHeight === 0 ||
			elem.style.display === "none";
	};
}
// requiere load multiselect before grid
$.jgrid._multiselect = false;
if($.ui) {
	if ($.ui.multiselect ) {
		if($.ui.multiselect.prototype._setSelected) {
			var setSelected = $.ui.multiselect.prototype._setSelected;
			$.ui.multiselect.prototype._setSelected = function(item,selected) {
				var ret = setSelected.call(this,item,selected);
				if (selected && this.selectedList) {
					var elt = this.element;
					this.selectedList.find('li').each(function() {
						if ($(this).data('optionLink')) {
							$(this).data('optionLink').remove().appendTo(elt);
						}
					});
				}
				return ret;
			};
		}
		if($.ui.multiselect.prototype.destroy) {
			$.ui.multiselect.prototype.destroy = function() {
				this.element.show();
				this.container.remove();
				if ($.Widget === undefined) {
					$.widget.prototype.destroy.apply(this, arguments);
				} else {
					$.Widget.prototype.destroy.apply(this, arguments);
				}
			};
		}
		$.jgrid._multiselect = true;
	}
}

$.jgrid.extend({
	sortableColumns : function (tblrow)
	{
		return this.each(function (){
			var ts = this, tid= $.jgrid.jqID( ts.p.id );
			function start() {ts.p.disableClick = true;}
			var sortable_opts = {
				"tolerance" : "pointer",
				"axis" : "x",
				"scrollSensitivity": "1",
				"items": '>th:not(:has(#jqgh_'+tid+'_cb'+',#jqgh_'+tid+'_rn'+',#jqgh_'+tid+'_subgrid),:hidden)',
				"placeholder": {
					element: function(item) {
						var el = $(document.createElement(item[0].nodeName))
						.addClass(item[0].className+" ui-sortable-placeholder ui-state-highlight")
						.removeClass("ui-sortable-helper")[0];
						return el;
					},
					update: function(self, p) {
						p.height(self.currentItem.innerHeight() - parseInt(self.currentItem.css('paddingTop')||0, 10) - parseInt(self.currentItem.css('paddingBottom')||0, 10));
						p.width(self.currentItem.innerWidth() - parseInt(self.currentItem.css('paddingLeft')||0, 10) - parseInt(self.currentItem.css('paddingRight')||0, 10));
					}
				},
				"update": function(event, ui) {
					var p = $(ui.item).parent(),
					th = $(">th", p),
					colModel = ts.p.colModel,
					cmMap = {}, tid= ts.p.id+"_";
					$.each(colModel, function(i) { cmMap[this.name]=i; });
					var permutation = [];
					th.each(function() {
						var id = $(">div", this).get(0).id.replace(/^jqgh_/, "").replace(tid,"");
							if (cmMap.hasOwnProperty(id)) {
								permutation.push(cmMap[id]);
							}
					});

					$(ts).jqGrid("remapColumns",permutation, true, true);
					if ($.isFunction(ts.p.sortable.update)) {
						ts.p.sortable.update(permutation);
					}
					setTimeout(function(){ts.p.disableClick=false;}, 50);
				}
			};
			if (ts.p.sortable.options) {
				$.extend(sortable_opts, ts.p.sortable.options);
			} else if ($.isFunction(ts.p.sortable)) {
				ts.p.sortable = { "update" : ts.p.sortable };
			}
			if (sortable_opts.start) {
				var s = sortable_opts.start;
				sortable_opts.start = function(e,ui) {
					start();
					s.call(this,e,ui);
				};
			} else {
				sortable_opts.start = start;
			}
			if (ts.p.sortable.exclude) {
				sortable_opts.items += ":not("+ts.p.sortable.exclude+")";
			}
			tblrow.sortable(sortable_opts).data("sortable").floating = true;
		});
	},
    columnChooser : function(opts) {
        var self = this;
		if($("#colchooser_"+$.jgrid.jqID(self[0].p.id)).length ) { return; }
        var selector = $('<div id="colchooser_'+self[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>');
        var select = $('select', selector);

		function insert(perm,i,v) {
			if(i>=0){
				var a = perm.slice();
				var b = a.splice(i,Math.max(perm.length-i,i));
				if(i>perm.length) { i = perm.length; }
				a[i] = v;
				return a.concat(b);
			}
		}
        opts = $.extend({
            "width" : 420,
            "height" : 240,
            "classname" : null,
            "done" : function(perm) { if (perm) { self.jqGrid("remapColumns", perm, true); } },
            /* msel is either the name of a ui widget class that
               extends a multiselect, or a function that supports
               creating a multiselect object (with no argument,
               or when passed an object), and destroying it (when
               passed the string "destroy"). */
            "msel" : "multiselect",
            /* "msel_opts" : {}, */

            /* dlog is either the name of a ui widget class that
               behaves in a dialog-like way, or a function, that
               supports creating a dialog (when passed dlog_opts)
               or destroying a dialog (when passed the string
               "destroy")
               */
            "dlog" : "dialog",
			"dialog_opts" : {
				"minWidth": 470
			},
            /* dlog_opts is either an option object to be passed
               to "dlog", or (more likely) a function that creates
               the options object.
               The default produces a suitable options object for
               ui.dialog */
            "dlog_opts" : function(opts) {
                var buttons = {};
                buttons[opts.bSubmit] = function() {
                    opts.apply_perm();
                    opts.cleanup(false);
                };
                buttons[opts.bCancel] = function() {
                    opts.cleanup(true);
                };
                return $.extend(true, {
                    "buttons": buttons,
                    "close": function() {
                        opts.cleanup(true);
                    },
					"modal" : opts.modal || false,
					"resizable": opts.resizable || true,
                    "width": opts.width+20
                }, opts.dialog_opts || {});
            },
            /* Function to get the permutation array, and pass it to the
               "done" function */
            "apply_perm" : function() {
                $('option',select).each(function() {
                    if (this.selected) {
                        self.jqGrid("showCol", colModel[this.value].name);
                    } else {
                        self.jqGrid("hideCol", colModel[this.value].name);
                    }
                });

                var perm = [];
				//fixedCols.slice(0);
                $('option:selected',select).each(function() { perm.push(parseInt(this.value,10)); });
                $.each(perm, function() { delete colMap[colModel[parseInt(this,10)].name]; });
                $.each(colMap, function() {
					var ti = parseInt(this,10);
					perm = insert(perm,ti,ti);
				});
                if (opts.done) {
                    opts.done.call(self, perm);
                }
            },
            /* Function to cleanup the dialog, and select. Also calls the
               done function with no permutation (to indicate that the
               columnChooser was aborted */
            "cleanup" : function(calldone) {
                call(opts.dlog, selector, 'destroy');
                call(opts.msel, select, 'destroy');
                selector.remove();
                if (calldone && opts.done) {
                    opts.done.call(self);
                }
            },
			"msel_opts" : {}
        }, $.jgrid.col, opts || {});
		if($.ui) {
			if ($.ui.multiselect ) {
				if(opts.msel === "multiselect") {
					if(!$.jgrid._multiselect) {
						// should be in language file
						alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");
						return;
					}
					opts.msel_opts = $.extend($.ui.multiselect.defaults,opts.msel_opts);
				}
			}
		}
        if (opts.caption) {
            selector.attr("title", opts.caption);
        }
        if (opts.classname) {
            selector.addClass(opts.classname);
            select.addClass(opts.classname);
        }
        if (opts.width) {
            $(">div",selector).css({"width": opts.width,"margin":"0 auto"});
            select.css("width", opts.width);
        }
        if (opts.height) {
            $(">div",selector).css("height", opts.height);
            select.css("height", opts.height - 10);
        }
        var colModel = self.jqGrid("getGridParam", "colModel");
        var colNames = self.jqGrid("getGridParam", "colNames");
        var colMap = {}, fixedCols = [];

        select.empty();
        $.each(colModel, function(i) {
            colMap[this.name] = i;
            if (this.hidedlg) {
                if (!this.hidden) {
                    fixedCols.push(i);
                }
                return;
            }

            select.append("<option value='"+i+"' "+
                          (this.hidden?"":"selected='selected'")+">"+$.jgrid.stripHtml(colNames[i])+"</option>");
        });
        function call(fn, obj) {
            if (!fn) { return; }
            if (typeof fn === 'string') {
                if ($.fn[fn]) {
                    $.fn[fn].apply(obj, $.makeArray(arguments).slice(2));
                }
            } else if ($.isFunction(fn)) {
                fn.apply(obj, $.makeArray(arguments).slice(2));
            }
        }

        var dopts = $.isFunction(opts.dlog_opts) ? opts.dlog_opts.call(self, opts) : opts.dlog_opts;
        call(opts.dlog, selector, dopts);
        var mopts = $.isFunction(opts.msel_opts) ? opts.msel_opts.call(self, opts) : opts.msel_opts;
        call(opts.msel, select, mopts);
    },
	sortableRows : function (opts) {
		// Can accept all sortable options and events
		return this.each(function(){
			var $t = this;
			if(!$t.grid) { return; }
			// Currently we disable a treeGrid sortable
			if($t.p.treeGrid) { return; }
			if($.fn.sortable) {
				opts = $.extend({
					"cursor":"move",
					"axis" : "y",
					"items": ".jqgrow"
					},
				opts || {});
				if(opts.start && $.isFunction(opts.start)) {
					opts._start_ = opts.start;
					delete opts.start;
				} else {opts._start_=false;}
				if(opts.update && $.isFunction(opts.update)) {
					opts._update_ = opts.update;
					delete opts.update;
				} else {opts._update_ = false;}
				opts.start = function(ev,ui) {
					$(ui.item).css("border-width","0");
					$("td",ui.item).each(function(i){
						this.style.width = $t.grid.cols[i].style.width;
					});
					if($t.p.subGrid) {
						var subgid = $(ui.item).attr("id");
						try {
							$($t).jqGrid('collapseSubGridRow',subgid);
						} catch (e) {}
					}
					if(opts._start_) {
						opts._start_.apply(this,[ev,ui]);
					}
				};
				opts.update = function (ev,ui) {
					$(ui.item).css("border-width","");
					if($t.p.rownumbers === true) {
						$("td.jqgrid-rownum",$t.rows).each(function( i ){
							$(this).html( i+1+(parseInt($t.p.page,10)-1)*parseInt($t.p.rowNum,10) );
						});
					}
					if(opts._update_) {
						opts._update_.apply(this,[ev,ui]);
					}
				};
				$("tbody:first",$t).sortable(opts);
				$("tbody:first",$t).disableSelection();
			}
		});
	},
	gridDnD : function(opts) {
		return this.each(function(){
		var $t = this, i, cn;
		if(!$t.grid) { return; }
		// Currently we disable a treeGrid drag and drop
		if($t.p.treeGrid) { return; }
		if(!$.fn.draggable || !$.fn.droppable) { return; }
		function updateDnD ()
		{
			var datadnd = $.data($t,"dnd");
			$("tr.jqgrow:not(.ui-draggable)",$t).draggable($.isFunction(datadnd.drag) ? datadnd.drag.call($($t),datadnd) : datadnd.drag);
		}
		var appender = "<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>";
		if($("#jqgrid_dnd")[0] === undefined) {
			$('body').append(appender);
		}

		if(typeof opts === 'string' && opts === 'updateDnD' && $t.p.jqgdnd===true) {
			updateDnD();
			return;
		}
		opts = $.extend({
			"drag" : function (opts) {
				return $.extend({
					start : function (ev, ui) {
						var i, subgid;
						// if we are in subgrid mode try to collapse the node
						if($t.p.subGrid) {
							subgid = $(ui.helper).attr("id");
							try {
								$($t).jqGrid('collapseSubGridRow',subgid);
							} catch (e) {}
						}
						// hack
						// drag and drop does not insert tr in table, when the table has no rows
						// we try to insert new empty row on the target(s)
						for (i=0;i<$.data($t,"dnd").connectWith.length;i++){
							if($($.data($t,"dnd").connectWith[i]).jqGrid('getGridParam','reccount') === 0 ){
								$($.data($t,"dnd").connectWith[i]).jqGrid('addRowData','jqg_empty_row',{});
							}
						}
						ui.helper.addClass("ui-state-highlight");
						$("td",ui.helper).each(function(i) {
							this.style.width = $t.grid.headers[i].width+"px";
						});
						if(opts.onstart && $.isFunction(opts.onstart) ) { opts.onstart.call($($t),ev,ui); }
					},
					stop :function(ev,ui) {
						var i, ids;
						if(ui.helper.dropped && !opts.dragcopy) {
							ids = $(ui.helper).attr("id");
							if(ids === undefined) { ids = $(this).attr("id"); }
							$($t).jqGrid('delRowData',ids );
						}
						// if we have a empty row inserted from start event try to delete it
						for (i=0;i<$.data($t,"dnd").connectWith.length;i++){
							$($.data($t,"dnd").connectWith[i]).jqGrid('delRowData','jqg_empty_row');
						}
						if(opts.onstop && $.isFunction(opts.onstop) ) { opts.onstop.call($($t),ev,ui); }
					}
				},opts.drag_opts || {});
			},
			"drop" : function (opts) {
				return $.extend({
					accept: function(d) {
						if (!$(d).hasClass('jqgrow')) { return d;}
						var tid = $(d).closest("table.ui-jqgrid-btable");
						if(tid.length > 0 && $.data(tid[0],"dnd") !== undefined) {
							var cn = $.data(tid[0],"dnd").connectWith;
							return $.inArray('#'+$.jgrid.jqID(this.id),cn) !== -1 ? true : false;
						}
						return false;
					},
					drop: function(ev, ui) {
						if (!$(ui.draggable).hasClass('jqgrow')) { return; }
						var accept = $(ui.draggable).attr("id");
						var getdata = ui.draggable.parent().parent().jqGrid('getRowData',accept);
						if(!opts.dropbyname) {
							var j =0, tmpdata = {}, nm, key;
							var dropmodel = $("#"+$.jgrid.jqID(this.id)).jqGrid('getGridParam','colModel');
							try {
								for (key in getdata) {
									if (getdata.hasOwnProperty(key)) {
									nm = dropmodel[j].name;
									if( !(nm === 'cb' || nm === 'rn' || nm === 'subgrid' )) {
										if(getdata.hasOwnProperty(key) && dropmodel[j]) {
											tmpdata[nm] = getdata[key];
										}
									}
									j++;
								}
								}
								getdata = tmpdata;
							} catch (e) {}
						}
						ui.helper.dropped = true;
						if(opts.beforedrop && $.isFunction(opts.beforedrop) ) {
							//parameters to this callback - event, element, data to be inserted, sender, reciever
							// should return object which will be inserted into the reciever
							var datatoinsert = opts.beforedrop.call(this,ev,ui,getdata,$('#'+$.jgrid.jqID($t.p.id)),$(this));
							if (datatoinsert !== undefined && datatoinsert !== null && typeof datatoinsert === "object") { getdata = datatoinsert; }
						}
						if(ui.helper.dropped) {
							var grid;
							if(opts.autoid) {
								if($.isFunction(opts.autoid)) {
									grid = opts.autoid.call(this,getdata);
								} else {
									grid = Math.ceil(Math.random()*1000);
									grid = opts.autoidprefix+grid;
								}
							}
							// NULL is interpreted as undefined while null as object
							$("#"+$.jgrid.jqID(this.id)).jqGrid('addRowData',grid,getdata,opts.droppos);
						}
						if(opts.ondrop && $.isFunction(opts.ondrop) ) { opts.ondrop.call(this,ev,ui, getdata); }
					}}, opts.drop_opts || {});
			},
			"onstart" : null,
			"onstop" : null,
			"beforedrop": null,
			"ondrop" : null,
			"drop_opts" : {
				"activeClass": "ui-state-active",
				"hoverClass": "ui-state-hover"
			},
			"drag_opts" : {
				"revert": "invalid",
				"helper": "clone",
				"cursor": "move",
				"appendTo" : "#jqgrid_dnd",
				"zIndex": 5000
			},
			"dragcopy": false,
			"dropbyname" : false,
			"droppos" : "first",
			"autoid" : true,
			"autoidprefix" : "dnd_"
		}, opts || {});

		if(!opts.connectWith) { return; }
		opts.connectWith = opts.connectWith.split(",");
		opts.connectWith = $.map(opts.connectWith,function(n){return $.trim(n);});
		$.data($t,"dnd",opts);

		if($t.p.reccount !== 0 && !$t.p.jqgdnd) {
			updateDnD();
		}
		$t.p.jqgdnd = true;
		for (i=0;i<opts.connectWith.length;i++){
			cn =opts.connectWith[i];
			$(cn).droppable($.isFunction(opts.drop) ? opts.drop.call($($t),opts) : opts.drop);
		}
		});
	},
	gridResize : function(opts) {
		return this.each(function(){
			var $t = this, gID = $.jgrid.jqID($t.p.id);
			if(!$t.grid || !$.fn.resizable) { return; }
			opts = $.extend({}, opts || {});
			if(opts.alsoResize ) {
				opts._alsoResize_ = opts.alsoResize;
				delete opts.alsoResize;
			} else {
				opts._alsoResize_ = false;
			}
			if(opts.stop && $.isFunction(opts.stop)) {
				opts._stop_ = opts.stop;
				delete opts.stop;
			} else {
				opts._stop_ = false;
			}
			opts.stop = function (ev, ui) {
				$($t).jqGrid('setGridParam',{height:$("#gview_"+gID+" .ui-jqgrid-bdiv").height()});
				$($t).jqGrid('setGridWidth',ui.size.width,opts.shrinkToFit);
				if(opts._stop_) { opts._stop_.call($t,ev,ui); }
			};
			if(opts._alsoResize_) {
				var optstest = "{\'#gview_"+gID+" .ui-jqgrid-bdiv\':true,'" +opts._alsoResize_+"':true}";
				opts.alsoResize = eval('('+optstest+')'); // the only way that I found to do this
			} else {
				opts.alsoResize = $(".ui-jqgrid-bdiv","#gview_"+gID);
			}
			delete opts._alsoResize_;
			$("#gbox_"+gID).resizable(opts);
		});
	}
});
})(jQuery);
/*
 Transform a table to a jqGrid.
 Peter Romianowski <peter.romianowski@optivo.de>
 If the first column of the table contains checkboxes or
 radiobuttons then the jqGrid is made selectable.
*/
// Addition - selector can be a class or id
function tableToGrid(selector, options) {
jQuery(selector).each(function() {
	if(this.grid) {return;} //Adedd from Tony Tomov
	// This is a small "hack" to make the width of the jqGrid 100%
	jQuery(this).width("99%");
	var w = jQuery(this).width();

	// Text whether we have single or multi select
	var inputCheckbox = jQuery('tr td:first-child input[type=checkbox]:first', jQuery(this));
	var inputRadio = jQuery('tr td:first-child input[type=radio]:first', jQuery(this));
	var selectMultiple = inputCheckbox.length > 0;
	var selectSingle = !selectMultiple && inputRadio.length > 0;
	var selectable = selectMultiple || selectSingle;
	//var inputName = inputCheckbox.attr("name") || inputRadio.attr("name");

	// Build up the columnModel and the data
	var colModel = [];
	var colNames = [];
	jQuery('th', jQuery(this)).each(function() {
		if (colModel.length === 0 && selectable) {
			colModel.push({
				name: '__selection__',
				index: '__selection__',
				width: 0,
				hidden: true
			});
			colNames.push('__selection__');
		} else {
			colModel.push({
				name: jQuery(this).attr("id") || jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(' ').join('_'),
				index: jQuery(this).attr("id") || jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(' ').join('_'),
				width: jQuery(this).width() || 150
			});
			colNames.push(jQuery(this).html());
		}
	});
	var data = [];
	var rowIds = [];
	var rowChecked = [];
	jQuery('tbody > tr', jQuery(this)).each(function() {
		var row = {};
		var rowPos = 0;
		jQuery('td', jQuery(this)).each(function() {
			if (rowPos === 0 && selectable) {
				var input = jQuery('input', jQuery(this));
				var rowId = input.attr("value");
				rowIds.push(rowId || data.length);
				if (input.is(":checked")) {
					rowChecked.push(rowId);
				}
				row[colModel[rowPos].name] = input.attr("value");
			} else {
				row[colModel[rowPos].name] = jQuery(this).html();
			}
			rowPos++;
		});
		if(rowPos >0) { data.push(row); }
	});

	// Clear the original HTML table
	jQuery(this).empty();

	// Mark it as jqGrid
	jQuery(this).addClass("scroll");

	jQuery(this).jqGrid(jQuery.extend({
		datatype: "local",
		width: w,
		colNames: colNames,
		colModel: colModel,
		multiselect: selectMultiple
		//inputName: inputName,
		//inputValueCol: imputName != null ? "__selection__" : null
	}, options || {}));

	// Add data
	var a;
	for (a = 0; a < data.length; a++) {
		var id = null;
		if (rowIds.length > 0) {
			id = rowIds[a];
			if (id && id.replace) {
				// We have to do this since the value of a checkbox
				// or radio button can be anything
				id = encodeURIComponent(id).replace(/[.\-%]/g, "_");
			}
		}
		if (id === null) {
			id = a + 1;
		}
		jQuery(this).jqGrid("addRowData",id, data[a]);
	}

	// Set the selection
	for (a = 0; a < rowChecked.length; a++) {
		jQuery(this).jqGrid("setSelection",rowChecked[a]);
	}
});
};
/*jshint eqeqeq:false */
/*global jQuery */
(function($){
/**
 * jqGrid pivot functions
 * Tony Tomov tony@trirand.com
 * http://trirand.com/blog/
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
*/
"use strict";
// To optimize the search we need custom array filter
// This code is taken from
// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter

function _pivotfilter (fn, context) {
	var i,
		value,
		result = [],
		length;

	if (!this || typeof fn !== 'function' || (fn instanceof RegExp)) {
		throw new TypeError();
	}

	length = this.length;

	for (i = 0; i < length; i++) {
		if (this.hasOwnProperty(i)) {
			value = this[i];
			if (fn.call(context, value, i, this)) {
				result.push(value);
				// We need break in order to cancel loop
				// in case the row is found
				break;
			}
		}
	}
	return result;
}
$.assocArraySize = function(obj) {
    // http://stackoverflow.com/a/6700/11236
    var size = 0, key;
    for (key in obj) {
        if (obj.hasOwnProperty(key)) {
        	size++;
        }
    }
    return size;
};

$.jgrid.extend({
	pivotSetup : function( data, options ){
		// data should come in json format
		// The function return the new colModel and the transformed data
		// again with group setup options which then will be passed to the grid
		var columns =[],
		pivotrows =[],
		summaries = [],
		member=[],
		groupOptions = {
			grouping : true,
			groupingView :  {
				groupField : [],
				groupSummary: [],
				groupSummaryPos:[]
			}
		},
		headers = [],
		o = $.extend ( {
			rowTotals : false,
			rowTotalsText : 'Total',
			// summary columns
			colTotals : false,
			groupSummary : true,
			groupSummaryPos :  'header',
			frozenStaticCols : false
		}, options || {});
		this.each(function(){

			var
				row,
				rowindex,
				i,

				rowlen = data.length,
				xlen, ylen, aggrlen,
				tmp,
				newObj,
				r=0;
			// utility funcs
			/*
			 * Filter the data to a given criteria. Return the firt occurance
			 */
			function find(ar, fun, extra) {
				var res;
				res = _pivotfilter.call(ar, fun, extra);
				return res.length > 0 ? res[0] : null;
			}
			/*
			 * Check if the grouped row column exist (See find)
			 * If the row is not find in pivot rows retun null,
			 * otherviese the column
			 */
			function findGroup(item, index) {
				var j = 0, ret = true, i;
				for(i in item) {
					if(item[i] != this[j]) {
						ret =  false;
						break;
					}
					j++;
					if(j>=this.length) {
						break;
					}
				}
				if(ret) {
					rowindex =  index;
				}
				return ret;
			}
			/*
			 * Perform calculations of the pivot values.
			 */
			function calculation(oper, v, field, rc)  {
				var ret;
				switch (oper) {
					case  "sum" :
						ret = parseFloat(v||0) + parseFloat((rc[field]||0));
						break;
					case "count" :
						if(v==="" || v == null) {
							v=0;
						}
						if(rc.hasOwnProperty(field)) {
							ret = v+1;
						} else {
							ret = 0;
						}
						break;
					case "min" :
						if(v==="" || v == null) {
							ret = parseFloat(rc[field]||0);
						} else {
							ret =Math.min(parseFloat(v),parseFloat(rc[field]||0));
						}
						break;
					case "max" :
						if(v==="" || v == null) {
							ret = parseFloat(rc[field]||0);
						} else {
							ret = Math.max(parseFloat(v),parseFloat(rc[field]||0));
						}
						break;
				}
				return ret;
			}
			/*
			 * The function agragates the values of the pivot grid.
			 * Return the current row with pivot summary values
			 */
			function agregateFunc ( row, aggr, value, curr) {
				// default is sum
				var arrln = aggr.length, i, label, j, jv;
				if($.isArray(value)) {
					jv = value.length;
				} else {
					jv = 1;
				}
				member = [];
				member.root = 0;
				for(j=0;j<jv;j++) {
					var  tmpmember = [], vl;
					for(i=0; i < arrln; i++) {
						if(value == null) {
							label = $.trim(aggr[i].member)+"_"+aggr[i].aggregator;
							vl = label;
						} else {
							vl = value[j].replace(/\s+/g, '');
							try {
								label = (arrln === 1 ? vl : vl+"_"+aggr[i].aggregator+"_"+i);
							} catch(e) {}
						}
						curr[label] =  tmpmember[label] = calculation( aggr[i].aggregator, curr[label], aggr[i].member, row);
					}
					member[vl] = tmpmember;
				}
				return curr;
			}
			// Making the row totals without to add in yDimension
			if(o.rowTotals && o.yDimension.length > 0) {
				var dn = o.yDimension[0].dataName;
				o.yDimension.splice(0,0,{dataName:dn});
				o.yDimension[0].converter =  function(){ return '_r_Totals'; };
			}
			// build initial columns (colModel) from xDimension
			xlen = $.isArray(o.xDimension) ? o.xDimension.length : 0;
			ylen = o.yDimension.length;
			aggrlen  = $.isArray(o.aggregates) ? o.aggregates.length : 0;
			if(xlen === 0 || aggrlen === 0) {
				throw("xDimension or aggregates optiona are not set!");
			}
			var colc;
			for(i = 0; i< xlen; i++) {
				colc = {name:o.xDimension[i].dataName, frozen: o.frozenStaticCols};
				colc = $.extend(true, colc, o.xDimension[i]);
				columns.push( colc );
			}
			var groupfields = xlen - 1, tree={};
			//tree = { text: 'root', leaf: false, children: [] };
			//loop over alll the source data
			while( r < rowlen ) {
				row = data[r];
				var xValue = [];
				var yValue = [];
				tmp = {};
				i = 0;
				// build the data from xDimension
				do {
					xValue[i]  = $.trim(row[o.xDimension[i].dataName]);
					tmp[o.xDimension[i].dataName] = xValue[i];
					i++;
				} while( i < xlen );

				var k = 0;
				rowindex = -1;
				// check to see if the row is in our new pivotrow set
				newObj = find(pivotrows, findGroup, xValue);
				if(!newObj) {
					// if the row is not in our set
					k = 0;
					// if yDimension is set
					if(ylen>=1) {
						// build the cols set in yDimension
						for(k=0;k<ylen;k++) {
							yValue[k] = $.trim(row[o.yDimension[k].dataName]);
							// Check to see if we have user defined conditions
							if(o.yDimension[k].converter && $.isFunction(o.yDimension[k].converter)) {
								yValue[k] = o.yDimension[k].converter.call(this, yValue[k], xValue, yValue);
							}
						}
						// make the colums based on aggregates definition
						// and return the members for late calculation
						tmp = agregateFunc( row, o.aggregates, yValue, tmp );
					} else  if( ylen === 0 ) {
						// if not set use direct the aggregates
						tmp = agregateFunc( row, o.aggregates, null, tmp );
					}
					// add the result in pivot rows
					pivotrows.push( tmp );
				} else {
					// the pivot exists
					if( rowindex >= 0) {
						k = 0;
						// make the recalculations
						if(ylen>=1) {
							for(k=0;k<ylen;k++) {
								yValue[k] = $.trim(row[o.yDimension[k].dataName]);
								if(o.yDimension[k].converter && $.isFunction(o.yDimension[k].converter)) {
									yValue[k] = o.yDimension[k].converter.call(this, yValue[k], xValue, yValue);
								}
							}
							newObj = agregateFunc( row, o.aggregates, yValue, newObj );
						} else  if( ylen === 0 ) {
							newObj = agregateFunc( row, o.aggregates, null, newObj );
						}
						// update the row
						pivotrows[rowindex] = newObj;
					}
				}
				var kj=0, current = null,existing = null, kk;
				// Build a JSON tree from the member (see aggregateFunc)
				// to make later the columns
				//
				for (kk in member) {
					if(kj === 0) {
						if (!tree.children||tree.children === undefined){
							tree = { text: kk, level : 0, children: [] };
						}
						current = tree.children;
					} else {
						existing = null;
						for (i=0; i < current.length; i++) {
							if (current[i].text === kk) {
								//current[i].fields=member[kk];
								existing = current[i];
								break;
							}
						}
						if (existing) {
							current = existing.children;
						} else {
							current.push({ children: [], text: kk, level: kj,  fields: member[kk] });
							current = current[current.length - 1].children;
						}
					}
					kj++;
				}
				r++;
			}
			var  lastval=[], initColLen = columns.length, swaplen = initColLen;
			if(ylen>0) {
				headers[ylen-1] = {	useColSpanStyle: false,	groupHeaders: []};
			}
			/*
			 * Recursive function which uses the tree to build the
			 * columns from the pivot values and set the group Headers
			 */
			function list(items) {
				var l, j, key, k, col;
				for (key in items) { // iterate
					if (items.hasOwnProperty(key)) {
					// write amount of spaces according to level
					// and write name and newline
						if(typeof items[key] !== "object") {
							// If not a object build the header of the appropriate level
							if( key === 'level') {
								if(lastval[items.level] === undefined) {
									lastval[items.level] ='';
									if(items.level>0 && items.text !== '_r_Totals') {
										headers[items.level-1] = {
											useColSpanStyle: false,
											groupHeaders: []
										};
									}
								}
								if(lastval[items.level] !== items.text && items.children.length && items.text !== '_r_Totals') {
									if(items.level>0) {
										headers[items.level-1].groupHeaders.push({
											titleText: items.text
										});
										var collen = headers[items.level-1].groupHeaders.length,
										colpos = collen === 1 ? swaplen : initColLen+(collen-1)*aggrlen;
										headers[items.level-1].groupHeaders[collen-1].startColumnName = columns[colpos].name;
										headers[items.level-1].groupHeaders[collen-1].numberOfColumns = columns.length - colpos;
										initColLen = columns.length;
									}
								}
								lastval[items.level] = items.text;
							}
							// This is in case when the member contain more than one summary item
							if(items.level === ylen  && key==='level' && ylen >0) {
								if( aggrlen > 1){
									var ll=1;
									for( l in items.fields) {
										if(ll===1) {
											headers[ylen-1].groupHeaders.push({startColumnName: l, numberOfColumns: 1, titleText: items.text});
										}
										ll++;
									}
									headers[ylen-1].groupHeaders[headers[ylen-1].groupHeaders.length-1].numberOfColumns = ll-1;
								} else {
									headers.splice(ylen-1,1);
								}
							}
						}
						// if object, call recursively
						if (items[key] != null && typeof items[key] === "object") {
							list(items[key]);
						}
						// Finally build the coulumns
						if( key === 'level') {
							if(items.level >0){
								j=0;
								for(l in items.fields) {
									col = {};
									for(k in o.aggregates[j]) {
										if(o.aggregates[j].hasOwnProperty(k)) {
											switch( k ) {
												case 'member':
												case 'label':
												case 'aggregator':
													break;
												default:
													col[k] = o.aggregates[j][k];
											}
										}
									}
									if(aggrlen>1) {
										col.name = l;
										col.label = o.aggregates[j].label || l;
									} else {
										col.name = items.text;
										col.label = items.text==='_r_Totals' ? o.rowTotalsText : items.text;
									}
									columns.push (col);
									j++;
								}
							}
						}
					}
				}
			}

			list(tree, 0);
			var nm;
			// loop again trougth the pivot rows in order to build grand total
			if(o.colTotals) {
				var plen = pivotrows.length;
				while(plen--) {
					for(i=xlen;i<columns.length;i++) {
						nm = columns[i].name;
						if(!summaries[nm]) {
							summaries[nm] = parseFloat(pivotrows[plen][nm] || 0);
						} else {
							summaries[nm] += parseFloat(pivotrows[plen][nm] || 0);
						}
					}
				}
			}
			// based on xDimension  levels build grouping
			if( groupfields > 0) {
				for(i=0;i<groupfields;i++) {
					groupOptions.groupingView.groupField[i] = columns[i].name;
					groupOptions.groupingView.groupSummary[i] = o.groupSummary;
					groupOptions.groupingView.groupSummaryPos[i] = o.groupSummaryPos;
				}
			} else {
				// no grouping is needed
				groupOptions.grouping = false;
			}
			groupOptions.sortname = columns[groupfields].name;
			groupOptions.groupingView.hideFirstGroupCol = true;
		});
		// return the final result.
		return { "colModel" : columns, "rows": pivotrows, "groupOptions" : groupOptions, "groupHeaders" :  headers, summary : summaries };
	},
	jqPivot : function( data, pivotOpt, gridOpt, ajaxOpt) {
		return this.each(function(){
			var $t = this;

			function pivot( data) {
				var pivotGrid = jQuery($t).jqGrid('pivotSetup',data, pivotOpt),
				footerrow = $.assocArraySize(pivotGrid.summary) > 0 ? true : false,
				query= $.jgrid.from(pivotGrid.rows), i;
				for(i=0; i< pivotGrid.groupOptions.groupingView.groupField.length; i++) {
					query.orderBy(pivotGrid.groupOptions.groupingView.groupField[i], "a", 'text', '');
				}
				jQuery($t).jqGrid($.extend({
					datastr: $.extend(query.select(),footerrow ? {userdata:pivotGrid.summary} : {}),
					datatype: "jsonstring",
					footerrow : footerrow,
					userDataOnFooter: footerrow,
					colModel: pivotGrid.colModel,
					viewrecords: true,
					sortname: pivotOpt.xDimension[0].dataName // ?????
				}, gridOpt || {}, pivotGrid.groupOptions));
				var gHead = pivotGrid.groupHeaders;
				if(gHead.length) {
					for( i = 0;i < gHead.length ; i++) {
						if(gHead[i] && gHead[i].groupHeaders.length) {
							jQuery($t).jqGrid('setGroupHeaders',gHead[i]);
						}
					}
				}
				if(pivotOpt.frozenStaticCols) {
					jQuery($t).jqGrid("setFrozenColumns");
				}
			}

			if(typeof data === "string") {
				$.ajax($.extend({
					url : data,
					dataType: 'json',
					success : function(response) {
						pivot($.jgrid.getAccessor(response, ajaxOpt && ajaxOpt.reader ? ajaxOpt.reader: 'rows') );
					}
				}, ajaxOpt || {}) );
			} else {
				pivot( data );
			}
		});
	}
});
})(jQuery);

//@add
};
//@add


/***/ }),

/***/ "./node_modules/jquery-ui/ui/version.js":
/*!**********************************************!*\
  !*** ./node_modules/jquery-ui/ui/version.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;( function( factory ) {
	if ( true ) {

		// AMD. Register as an anonymous module.
		!(__WEBPACK_AMD_DEFINE_ARRAY__ = [ __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js") ], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	} else {}
} ( function( $ ) {

$.ui = $.ui || {};

return $.ui.version = "1.12.1";

} ) );


/***/ }),

/***/ "./node_modules/jquery-ui/ui/widget.js":
/*!*********************************************!*\
  !*** ./node_modules/jquery-ui/ui/widget.js ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!
 * jQuery UI Widget 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Widget
//>>group: Core
//>>description: Provides a factory for creating stateful widgets with a common API.
//>>docs: http://api.jqueryui.com/jQuery.widget/
//>>demos: http://jqueryui.com/widget/

( function( factory ) {
	if ( true ) {

		// AMD. Register as an anonymous module.
		!(__WEBPACK_AMD_DEFINE_ARRAY__ = [ __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js"), __webpack_require__(/*! ./version */ "./node_modules/jquery-ui/ui/version.js") ], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	} else {}
}( function( $ ) {

var widgetUuid = 0;
var widgetSlice = Array.prototype.slice;

$.cleanData = ( function( orig ) {
	return function( elems ) {
		var events, elem, i;
		for ( i = 0; ( elem = elems[ i ] ) != null; i++ ) {
			try {

				// Only trigger remove when necessary to save time
				events = $._data( elem, "events" );
				if ( events && events.remove ) {
					$( elem ).triggerHandler( "remove" );
				}

			// Http://bugs.jquery.com/ticket/8235
			} catch ( e ) {}
		}
		orig( elems );
	};
} )( $.cleanData );

$.widget = function( name, base, prototype ) {
	var existingConstructor, constructor, basePrototype;

	// ProxiedPrototype allows the provided prototype to remain unmodified
	// so that it can be used as a mixin for multiple widgets (#8876)
	var proxiedPrototype = {};

	var namespace = name.split( "." )[ 0 ];
	name = name.split( "." )[ 1 ];
	var fullName = namespace + "-" + name;

	if ( !prototype ) {
		prototype = base;
		base = $.Widget;
	}

	if ( $.isArray( prototype ) ) {
		prototype = $.extend.apply( null, [ {} ].concat( prototype ) );
	}

	// Create selector for plugin
	$.expr[ ":" ][ fullName.toLowerCase() ] = function( elem ) {
		return !!$.data( elem, fullName );
	};

	$[ namespace ] = $[ namespace ] || {};
	existingConstructor = $[ namespace ][ name ];
	constructor = $[ namespace ][ name ] = function( options, element ) {

		// Allow instantiation without "new" keyword
		if ( !this._createWidget ) {
			return new constructor( options, element );
		}

		// Allow instantiation without initializing for simple inheritance
		// must use "new" keyword (the code above always passes args)
		if ( arguments.length ) {
			this._createWidget( options, element );
		}
	};

	// Extend with the existing constructor to carry over any static properties
	$.extend( constructor, existingConstructor, {
		version: prototype.version,

		// Copy the object used to create the prototype in case we need to
		// redefine the widget later
		_proto: $.extend( {}, prototype ),

		// Track widgets that inherit from this widget in case this widget is
		// redefined after a widget inherits from it
		_childConstructors: []
	} );

	basePrototype = new base();

	// We need to make the options hash a property directly on the new instance
	// otherwise we'll modify the options hash on the prototype that we're
	// inheriting from
	basePrototype.options = $.widget.extend( {}, basePrototype.options );
	$.each( prototype, function( prop, value ) {
		if ( !$.isFunction( value ) ) {
			proxiedPrototype[ prop ] = value;
			return;
		}
		proxiedPrototype[ prop ] = ( function() {
			function _super() {
				return base.prototype[ prop ].apply( this, arguments );
			}

			function _superApply( args ) {
				return base.prototype[ prop ].apply( this, args );
			}

			return function() {
				var __super = this._super;
				var __superApply = this._superApply;
				var returnValue;

				this._super = _super;
				this._superApply = _superApply;

				returnValue = value.apply( this, arguments );

				this._super = __super;
				this._superApply = __superApply;

				return returnValue;
			};
		} )();
	} );
	constructor.prototype = $.widget.extend( basePrototype, {

		// TODO: remove support for widgetEventPrefix
		// always use the name + a colon as the prefix, e.g., draggable:start
		// don't prefix for widgets that aren't DOM-based
		widgetEventPrefix: existingConstructor ? ( basePrototype.widgetEventPrefix || name ) : name
	}, proxiedPrototype, {
		constructor: constructor,
		namespace: namespace,
		widgetName: name,
		widgetFullName: fullName
	} );

	// If this widget is being redefined then we need to find all widgets that
	// are inheriting from it and redefine all of them so that they inherit from
	// the new version of this widget. We're essentially trying to replace one
	// level in the prototype chain.
	if ( existingConstructor ) {
		$.each( existingConstructor._childConstructors, function( i, child ) {
			var childPrototype = child.prototype;

			// Redefine the child widget using the same prototype that was
			// originally used, but inherit from the new version of the base
			$.widget( childPrototype.namespace + "." + childPrototype.widgetName, constructor,
				child._proto );
		} );

		// Remove the list of existing child constructors from the old constructor
		// so the old child constructors can be garbage collected
		delete existingConstructor._childConstructors;
	} else {
		base._childConstructors.push( constructor );
	}

	$.widget.bridge( name, constructor );

	return constructor;
};

$.widget.extend = function( target ) {
	var input = widgetSlice.call( arguments, 1 );
	var inputIndex = 0;
	var inputLength = input.length;
	var key;
	var value;

	for ( ; inputIndex < inputLength; inputIndex++ ) {
		for ( key in input[ inputIndex ] ) {
			value = input[ inputIndex ][ key ];
			if ( input[ inputIndex ].hasOwnProperty( key ) && value !== undefined ) {

				// Clone objects
				if ( $.isPlainObject( value ) ) {
					target[ key ] = $.isPlainObject( target[ key ] ) ?
						$.widget.extend( {}, target[ key ], value ) :

						// Don't extend strings, arrays, etc. with objects
						$.widget.extend( {}, value );

				// Copy everything else by reference
				} else {
					target[ key ] = value;
				}
			}
		}
	}
	return target;
};

$.widget.bridge = function( name, object ) {
	var fullName = object.prototype.widgetFullName || name;
	$.fn[ name ] = function( options ) {
		var isMethodCall = typeof options === "string";
		var args = widgetSlice.call( arguments, 1 );
		var returnValue = this;

		if ( isMethodCall ) {

			// If this is an empty collection, we need to have the instance method
			// return undefined instead of the jQuery instance
			if ( !this.length && options === "instance" ) {
				returnValue = undefined;
			} else {
				this.each( function() {
					var methodValue;
					var instance = $.data( this, fullName );

					if ( options === "instance" ) {
						returnValue = instance;
						return false;
					}

					if ( !instance ) {
						return $.error( "cannot call methods on " + name +
							" prior to initialization; " +
							"attempted to call method '" + options + "'" );
					}

					if ( !$.isFunction( instance[ options ] ) || options.charAt( 0 ) === "_" ) {
						return $.error( "no such method '" + options + "' for " + name +
							" widget instance" );
					}

					methodValue = instance[ options ].apply( instance, args );

					if ( methodValue !== instance && methodValue !== undefined ) {
						returnValue = methodValue && methodValue.jquery ?
							returnValue.pushStack( methodValue.get() ) :
							methodValue;
						return false;
					}
				} );
			}
		} else {

			// Allow multiple hashes to be passed on init
			if ( args.length ) {
				options = $.widget.extend.apply( null, [ options ].concat( args ) );
			}

			this.each( function() {
				var instance = $.data( this, fullName );
				if ( instance ) {
					instance.option( options || {} );
					if ( instance._init ) {
						instance._init();
					}
				} else {
					$.data( this, fullName, new object( options, this ) );
				}
			} );
		}

		return returnValue;
	};
};

$.Widget = function( /* options, element */ ) {};
$.Widget._childConstructors = [];

$.Widget.prototype = {
	widgetName: "widget",
	widgetEventPrefix: "",
	defaultElement: "<div>",

	options: {
		classes: {},
		disabled: false,

		// Callbacks
		create: null
	},

	_createWidget: function( options, element ) {
		element = $( element || this.defaultElement || this )[ 0 ];
		this.element = $( element );
		this.uuid = widgetUuid++;
		this.eventNamespace = "." + this.widgetName + this.uuid;

		this.bindings = $();
		this.hoverable = $();
		this.focusable = $();
		this.classesElementLookup = {};

		if ( element !== this ) {
			$.data( element, this.widgetFullName, this );
			this._on( true, this.element, {
				remove: function( event ) {
					if ( event.target === element ) {
						this.destroy();
					}
				}
			} );
			this.document = $( element.style ?

				// Element within the document
				element.ownerDocument :

				// Element is window or document
				element.document || element );
			this.window = $( this.document[ 0 ].defaultView || this.document[ 0 ].parentWindow );
		}

		this.options = $.widget.extend( {},
			this.options,
			this._getCreateOptions(),
			options );

		this._create();

		if ( this.options.disabled ) {
			this._setOptionDisabled( this.options.disabled );
		}

		this._trigger( "create", null, this._getCreateEventData() );
		this._init();
	},

	_getCreateOptions: function() {
		return {};
	},

	_getCreateEventData: $.noop,

	_create: $.noop,

	_init: $.noop,

	destroy: function() {
		var that = this;

		this._destroy();
		$.each( this.classesElementLookup, function( key, value ) {
			that._removeClass( value, key );
		} );

		// We can probably remove the unbind calls in 2.0
		// all event bindings should go through this._on()
		this.element
			.off( this.eventNamespace )
			.removeData( this.widgetFullName );
		this.widget()
			.off( this.eventNamespace )
			.removeAttr( "aria-disabled" );

		// Clean up events and states
		this.bindings.off( this.eventNamespace );
	},

	_destroy: $.noop,

	widget: function() {
		return this.element;
	},

	option: function( key, value ) {
		var options = key;
		var parts;
		var curOption;
		var i;

		if ( arguments.length === 0 ) {

			// Don't return a reference to the internal hash
			return $.widget.extend( {}, this.options );
		}

		if ( typeof key === "string" ) {

			// Handle nested keys, e.g., "foo.bar" => { foo: { bar: ___ } }
			options = {};
			parts = key.split( "." );
			key = parts.shift();
			if ( parts.length ) {
				curOption = options[ key ] = $.widget.extend( {}, this.options[ key ] );
				for ( i = 0; i < parts.length - 1; i++ ) {
					curOption[ parts[ i ] ] = curOption[ parts[ i ] ] || {};
					curOption = curOption[ parts[ i ] ];
				}
				key = parts.pop();
				if ( arguments.length === 1 ) {
					return curOption[ key ] === undefined ? null : curOption[ key ];
				}
				curOption[ key ] = value;
			} else {
				if ( arguments.length === 1 ) {
					return this.options[ key ] === undefined ? null : this.options[ key ];
				}
				options[ key ] = value;
			}
		}

		this._setOptions( options );

		return this;
	},

	_setOptions: function( options ) {
		var key;

		for ( key in options ) {
			this._setOption( key, options[ key ] );
		}

		return this;
	},

	_setOption: function( key, value ) {
		if ( key === "classes" ) {
			this._setOptionClasses( value );
		}

		this.options[ key ] = value;

		if ( key === "disabled" ) {
			this._setOptionDisabled( value );
		}

		return this;
	},

	_setOptionClasses: function( value ) {
		var classKey, elements, currentElements;

		for ( classKey in value ) {
			currentElements = this.classesElementLookup[ classKey ];
			if ( value[ classKey ] === this.options.classes[ classKey ] ||
					!currentElements ||
					!currentElements.length ) {
				continue;
			}

			// We are doing this to create a new jQuery object because the _removeClass() call
			// on the next line is going to destroy the reference to the current elements being
			// tracked. We need to save a copy of this collection so that we can add the new classes
			// below.
			elements = $( currentElements.get() );
			this._removeClass( currentElements, classKey );

			// We don't use _addClass() here, because that uses this.options.classes
			// for generating the string of classes. We want to use the value passed in from
			// _setOption(), this is the new value of the classes option which was passed to
			// _setOption(). We pass this value directly to _classes().
			elements.addClass( this._classes( {
				element: elements,
				keys: classKey,
				classes: value,
				add: true
			} ) );
		}
	},

	_setOptionDisabled: function( value ) {
		this._toggleClass( this.widget(), this.widgetFullName + "-disabled", null, !!value );

		// If the widget is becoming disabled, then nothing is interactive
		if ( value ) {
			this._removeClass( this.hoverable, null, "ui-state-hover" );
			this._removeClass( this.focusable, null, "ui-state-focus" );
		}
	},

	enable: function() {
		return this._setOptions( { disabled: false } );
	},

	disable: function() {
		return this._setOptions( { disabled: true } );
	},

	_classes: function( options ) {
		var full = [];
		var that = this;

		options = $.extend( {
			element: this.element,
			classes: this.options.classes || {}
		}, options );

		function processClassString( classes, checkOption ) {
			var current, i;
			for ( i = 0; i < classes.length; i++ ) {
				current = that.classesElementLookup[ classes[ i ] ] || $();
				if ( options.add ) {
					current = $( $.unique( current.get().concat( options.element.get() ) ) );
				} else {
					current = $( current.not( options.element ).get() );
				}
				that.classesElementLookup[ classes[ i ] ] = current;
				full.push( classes[ i ] );
				if ( checkOption && options.classes[ classes[ i ] ] ) {
					full.push( options.classes[ classes[ i ] ] );
				}
			}
		}

		this._on( options.element, {
			"remove": "_untrackClassesElement"
		} );

		if ( options.keys ) {
			processClassString( options.keys.match( /\S+/g ) || [], true );
		}
		if ( options.extra ) {
			processClassString( options.extra.match( /\S+/g ) || [] );
		}

		return full.join( " " );
	},

	_untrackClassesElement: function( event ) {
		var that = this;
		$.each( that.classesElementLookup, function( key, value ) {
			if ( $.inArray( event.target, value ) !== -1 ) {
				that.classesElementLookup[ key ] = $( value.not( event.target ).get() );
			}
		} );
	},

	_removeClass: function( element, keys, extra ) {
		return this._toggleClass( element, keys, extra, false );
	},

	_addClass: function( element, keys, extra ) {
		return this._toggleClass( element, keys, extra, true );
	},

	_toggleClass: function( element, keys, extra, add ) {
		add = ( typeof add === "boolean" ) ? add : extra;
		var shift = ( typeof element === "string" || element === null ),
			options = {
				extra: shift ? keys : extra,
				keys: shift ? element : keys,
				element: shift ? this.element : element,
				add: add
			};
		options.element.toggleClass( this._classes( options ), add );
		return this;
	},

	_on: function( suppressDisabledCheck, element, handlers ) {
		var delegateElement;
		var instance = this;

		// No suppressDisabledCheck flag, shuffle arguments
		if ( typeof suppressDisabledCheck !== "boolean" ) {
			handlers = element;
			element = suppressDisabledCheck;
			suppressDisabledCheck = false;
		}

		// No element argument, shuffle and use this.element
		if ( !handlers ) {
			handlers = element;
			element = this.element;
			delegateElement = this.widget();
		} else {
			element = delegateElement = $( element );
			this.bindings = this.bindings.add( element );
		}

		$.each( handlers, function( event, handler ) {
			function handlerProxy() {

				// Allow widgets to customize the disabled handling
				// - disabled as an array instead of boolean
				// - disabled class as method for disabling individual parts
				if ( !suppressDisabledCheck &&
						( instance.options.disabled === true ||
						$( this ).hasClass( "ui-state-disabled" ) ) ) {
					return;
				}
				return ( typeof handler === "string" ? instance[ handler ] : handler )
					.apply( instance, arguments );
			}

			// Copy the guid so direct unbinding works
			if ( typeof handler !== "string" ) {
				handlerProxy.guid = handler.guid =
					handler.guid || handlerProxy.guid || $.guid++;
			}

			var match = event.match( /^([\w:-]*)\s*(.*)$/ );
			var eventName = match[ 1 ] + instance.eventNamespace;
			var selector = match[ 2 ];

			if ( selector ) {
				delegateElement.on( eventName, selector, handlerProxy );
			} else {
				element.on( eventName, handlerProxy );
			}
		} );
	},

	_off: function( element, eventName ) {
		eventName = ( eventName || "" ).split( " " ).join( this.eventNamespace + " " ) +
			this.eventNamespace;
		element.off( eventName ).off( eventName );

		// Clear the stack to avoid memory leaks (#10056)
		this.bindings = $( this.bindings.not( element ).get() );
		this.focusable = $( this.focusable.not( element ).get() );
		this.hoverable = $( this.hoverable.not( element ).get() );
	},

	_delay: function( handler, delay ) {
		function handlerProxy() {
			return ( typeof handler === "string" ? instance[ handler ] : handler )
				.apply( instance, arguments );
		}
		var instance = this;
		return setTimeout( handlerProxy, delay || 0 );
	},

	_hoverable: function( element ) {
		this.hoverable = this.hoverable.add( element );
		this._on( element, {
			mouseenter: function( event ) {
				this._addClass( $( event.currentTarget ), null, "ui-state-hover" );
			},
			mouseleave: function( event ) {
				this._removeClass( $( event.currentTarget ), null, "ui-state-hover" );
			}
		} );
	},

	_focusable: function( element ) {
		this.focusable = this.focusable.add( element );
		this._on( element, {
			focusin: function( event ) {
				this._addClass( $( event.currentTarget ), null, "ui-state-focus" );
			},
			focusout: function( event ) {
				this._removeClass( $( event.currentTarget ), null, "ui-state-focus" );
			}
		} );
	},

	_trigger: function( type, event, data ) {
		var prop, orig;
		var callback = this.options[ type ];

		data = data || {};
		event = $.Event( event );
		event.type = ( type === this.widgetEventPrefix ?
			type :
			this.widgetEventPrefix + type ).toLowerCase();

		// The original event may come from any element
		// so we need to reset the target on the new event
		event.target = this.element[ 0 ];

		// Copy original event properties over to the new event
		orig = event.originalEvent;
		if ( orig ) {
			for ( prop in orig ) {
				if ( !( prop in event ) ) {
					event[ prop ] = orig[ prop ];
				}
			}
		}

		this.element.trigger( event, data );
		return !( $.isFunction( callback ) &&
			callback.apply( this.element[ 0 ], [ event ].concat( data ) ) === false ||
			event.isDefaultPrevented() );
	}
};

$.each( { show: "fadeIn", hide: "fadeOut" }, function( method, defaultEffect ) {
	$.Widget.prototype[ "_" + method ] = function( element, options, callback ) {
		if ( typeof options === "string" ) {
			options = { effect: options };
		}

		var hasOptions;
		var effectName = !options ?
			method :
			options === true || typeof options === "number" ?
				defaultEffect :
				options.effect || defaultEffect;

		options = options || {};
		if ( typeof options === "number" ) {
			options = { duration: options };
		}

		hasOptions = !$.isEmptyObject( options );
		options.complete = callback;

		if ( options.delay ) {
			element.delay( options.delay );
		}

		if ( hasOptions && $.effects && $.effects.effect[ effectName ] ) {
			element[ method ]( options );
		} else if ( effectName !== method && element[ effectName ] ) {
			element[ effectName ]( options.duration, options.easing, callback );
		} else {
			element.queue( function( next ) {
				$( this )[ method ]();
				if ( callback ) {
					callback.call( element[ 0 ] );
				}
				next();
			} );
		}
	};
} );

return $.widget;

} ) );


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvanFncmlkL2Nzcy91aS5qcWdyaWQuY3NzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9nZXRVcmwuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2pxZ3JpZC9jc3MvdWkuanFncmlkLmNzcz9hZGY4Iiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9qcWdyaWQvanMvaTE4bi9ncmlkLmxvY2FsZS1lbi5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvanFncmlkL2pzL2pxdWVyeS5qcUdyaWQuc3JjLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvdmVyc2lvbi5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL3dpZGdldC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDK0U7QUFDL0UsOEJBQThCLHNFQUEyQjtBQUN6RDtBQUNBLDhCQUE4QixRQUFTLDJCQUEyQixvQkFBb0IsZ0NBQWdDLG1CQUFtQixPQUFPLFFBQVEsWUFBWSxpQkFBaUIsb0RBQW9ELDZCQUE2QixvQkFBb0IsaUJBQWlCLHFCQUFxQixxQkFBcUIscUJBQXFCLG1DQUFtQyxrQkFBa0IsaUNBQWlDLHFCQUFxQixFQUFFLDBDQUEwQyxvQkFBb0IsU0FBUyxhQUFhLHFCQUFxQixjQUFjLGFBQWEsaUJBQWlCLCtDQUErQyxnQkFBZ0IsYUFBYSxFQUFFLGdEQUFnRCxZQUFZLEVBQUUsK0NBQStDLG1CQUFtQixXQUFXLFdBQVcsb0JBQW9CLGdDQUFnQyxnQ0FBZ0MsbUNBQW1DLGdDQUFnQyxZQUFZLHNCQUFzQixrQ0FBa0MsbUJBQW1CLFVBQVUscUNBQXFDLFlBQVksc0JBQXNCLHlDQUF5QyxpQkFBaUIsbUJBQW1CLGNBQWMsaUVBQWlFLGlCQUFpQixvQkFBb0Isa0JBQWtCLG9CQUFvQix3QkFBd0IsMkRBQTJELHNCQUFzQiwyREFBMkQsdUJBQXVCLHNCQUFzQix3QkFBd0IsRUFBRSxzQkFBc0IsdUJBQXVCLEVBQUUsOEJBQThCLG9CQUFvQixTQUFTLGNBQWMsa0NBQWtDLHVCQUF1QixtQkFBbUIsa0JBQWtCLGdCQUFnQixrQkFBa0Isa0NBQWtDLGdCQUFnQixrQkFBa0IsZUFBZSw2QkFBNkIsNkJBQTZCLGdCQUFnQixjQUFjLDhCQUE4QixlQUFlLGFBQWEsMEJBQTBCLGFBQWEsYUFBYSwyQkFBMkIsYUFBYSxpQkFBaUIsYUFBYSxvQ0FBb0MsZ0JBQWdCLHdDQUF3QyxrQ0FBa0Msc0NBQXNDLHFDQUFxQyxnQ0FBZ0Msa0JBQWtCLGlDQUFpQyxrQkFBa0IsK0NBQStDLG1CQUFtQixXQUFXLFdBQVcsZ0JBQWdCLGtCQUFrQixrQ0FBa0MsbUJBQW1CLFVBQVUscUJBQXFCLEVBQUUsMEJBQTBCLHFCQUFxQixFQUFFLDJCQUEyQixxQkFBcUIsRUFBRSw2QkFBNkIsb0JBQW9CLGtCQUFrQixrQkFBa0IsY0FBYyxxQkFBcUIseUJBQXlCLDhCQUE4Qiw2QkFBNkIsa0NBQWtDLHFCQUFxQix3QkFBd0IsNEJBQTRCLDhCQUE4QixvQkFBb0Isa0JBQWtCLGtCQUFrQixjQUFjLHFCQUFxQix5QkFBeUIsOEJBQThCLDZCQUE2Qiw2QkFBNkIsa0JBQWtCLGtCQUFrQixrQkFBa0IsY0FBYyxxQkFBcUIseUJBQXlCLDhCQUE4Qiw2QkFBNkIsaUNBQWlDLGdCQUFnQix3QkFBd0IsNkJBQTZCLDRCQUE0QixpQ0FBaUMsaUJBQWlCLHVCQUF1Qiw0QkFBNEIsMkJBQTJCLGlDQUFpQyxzQkFBc0IsV0FBVyxpQkFBaUIsdUNBQXVDLFdBQVcsUUFBUSx1QkFBdUIsa0JBQWtCLG9CQUFvQixtQkFBbUIsT0FBTyxjQUFjLGlCQUFpQixjQUFjLGVBQWUsaUJBQWlCLGdEQUFnRCxtQkFBbUIsV0FBVyxXQUFXLGtCQUFrQixnQ0FBZ0MsZ0NBQWdDLG1DQUFtQyxrQ0FBa0MsbUJBQW1CLGtCQUFrQiw4QkFBOEIsa0JBQWtCLGtCQUFrQixvQkFBb0IsY0FBYyxxQkFBcUIsc0JBQXNCLDJCQUEyQiwwQkFBMEIsa0NBQWtDLGdCQUFnQix3QkFBd0IsNkJBQTZCLDRCQUE0QixrQ0FBa0MsaUJBQWlCLHVCQUF1Qiw0QkFBNEIsMkJBQTJCLCtDQUErQyxnQ0FBZ0MsZ0NBQWdDLGtDQUFrQyxzQkFBc0IsdUJBQXVCLG9CQUFvQixjQUFjLG9CQUFvQixpQkFBaUIsZ0JBQWdCLGtDQUFrQyxvQkFBb0IsNkJBQTZCLG1CQUFtQixvQkFBb0IsWUFBWSxZQUFZLGdDQUFnQyxtQkFBbUIsdUJBQXVCLGNBQWMsK0JBQStCLHlCQUF5QixtQ0FBbUMsZ0JBQWdCLGFBQWEsYUFBYSxvQ0FBb0MsWUFBWSxFQUFFLHlDQUF5QyxhQUFhLDZCQUE2QixhQUFhLGVBQWUsWUFBWSw4QkFBOEIsZUFBZSxrQkFBa0IsZUFBZSxhQUFhLFlBQVksOEJBQThCLGFBQWEsOEJBQThCLCtCQUErQixhQUFhLGVBQWUsZ0NBQWdDLG9CQUFvQixZQUFZLGdCQUFnQixrQkFBa0IsNENBQTRDLGNBQWMsV0FBVyxtQkFBbUIsK0NBQStDLGdCQUFnQixFQUFFLDBEQUEwRCxXQUFXLGNBQWMsc0VBQXNFLFlBQVksNEJBQTRCLFdBQVcsYUFBYSxvQ0FBb0MsK0JBQStCLGdDQUFnQywrQkFBK0Isc0JBQXNCLHVCQUF1QixvQkFBb0IseUJBQXlCLG9CQUFvQixrQkFBa0IsK0NBQStDLGNBQWMsV0FBVyxtQkFBbUIsa0RBQWtELGdCQUFnQixFQUFFLDZEQUE2RCxXQUFXLGNBQWMsc0VBQXNFLGdCQUFnQiw0QkFBNEIsU0FBUyxVQUFVLGFBQWEsa0NBQWtDLHFCQUFxQixnREFBZ0QsWUFBWSx3QkFBd0IsNkJBQTZCLDJCQUEyQix5QkFBeUIsOEJBQThCLDZCQUE2Qiw0Q0FBNEMsZ0NBQWdDLDRDQUE0Qyx5QkFBeUIsK0JBQStCLGFBQWEsMENBQTBDLG1CQUFtQixVQUFVLFVBQVUsWUFBWSxZQUFZLGFBQWEsYUFBYSxtQkFBbUIsa0JBQWtCLGNBQWMsNkJBQTZCLGlCQUFpQixnQ0FBZ0MsYUFBYSxhQUFhLGtDQUFrQyxvREFBb0QsdURBQXVELGlDQUFpQyxrQkFBa0IsTUFBTSxPQUFPLFlBQVksOERBQThELHVEQUF1RCx5RUFBeUUsb0JBQW9CLHlCQUF5QixnQkFBZ0IsaUJBQWlCLEdBQUcsdUNBQXVDLGVBQWUsY0FBYyxvQkFBb0IsZUFBZSxnQkFBZ0IsbUJBQW1CLHdDQUF3QyxvQkFBb0Isb0JBQW9CLEdBQUcscUNBQXFDLHFCQUFxQixFQUFFLCtDQUErQyxvQkFBb0IsV0FBVyxhQUFhLHFCQUFxQixjQUFjLGNBQWMsaUJBQWlCLHVEQUF1RCxnQkFBZ0IsYUFBYSxFQUFFLG9HQUFvRyxZQUFZLEVBQUUsNkRBQTZELFdBQVcsb0JBQW9CLGtCQUFrQixjQUFjLGdDQUFnQyxrQkFBa0Isa0JBQWtCLGtCQUFrQixZQUFZLFdBQVcsaUJBQWlCLGFBQWEsWUFBWSxZQUFZLG1CQUFtQixtQ0FBbUMsY0FBYyxhQUFhLGlDQUFpQyxjQUFjLGNBQWMsZ0ZBQWdGLFdBQVcscUNBQXFDLGFBQWEsa0JBQWtCLG9DQUFvQyxhQUFhLGtCQUFrQix1RUFBdUUsV0FBVyw0QkFBNEIsWUFBWSxjQUFjLHdDQUF3QyxrQkFBa0IsbUJBQW1CLG9CQUFvQixxQkFBcUIsb0JBQW9CLGtCQUFrQix1Q0FBdUMsbUJBQW1CLHFCQUFxQixtQkFBbUIscUJBQXFCLG9CQUFvQixrQkFBa0IsNENBQTRDLGFBQWEsNkNBQTZDLGFBQWEscUNBQXFDLGlCQUFpQixnQkFBZ0IseUNBQXlDLHVCQUF1QixlQUFlLGNBQWMscUJBQXFCLGtDQUFrQyxhQUFhLGdCQUFnQixzQkFBc0IsMENBQTBDLGdCQUFnQixnQkFBZ0IsdUJBQXVCLGtCQUFrQixvQkFBb0IsaUNBQWlDLGdCQUFnQixvQkFBb0Isb0JBQW9CLFNBQVMsRUFBRSwwQkFBMEIscUJBQXFCLEVBQUUsMkJBQTJCLHNCQUFzQixFQUFFLG1DQUFtQyxhQUFhLFlBQVksZ0JBQWdCLG9CQUFvQixVQUFVLGtCQUFrQixFQUFFLG9DQUFvQyxZQUFZLGFBQWEsZ0JBQWdCLG9CQUFvQixVQUFVLG1CQUFtQixvQkFBb0IsYUFBYSxZQUFZLFdBQVcsYUFBYSxFQUFFLHFEQUFxRCxnRUFBZ0Usb0JBQW9CLHFCQUFxQiwrTEFBK0wscUJBQXFCLEtBQUssOENBQThDLFlBQVksb0JBQW9CLGFBQWEsb0JBQW9CLGtCQUFrQiw0QkFBNEIsbUJBQW1CLGNBQWMsYUFBYSxtQkFBbUIsMkJBQTJCLG1CQUFtQixlQUFlLGFBQWEsb0JBQW9CLDJCQUEyQixtQkFBbUIsZUFBZSxhQUFhLGtCQUFrQiwyQkFBMkIsaUJBQWlCLHVDQUF1QyxrQkFBa0IsTUFBTSxPQUFPLFlBQVksNkRBQTZELHVEQUF1RCw0QkFBNEIsd0JBQXdCLDZCQUE2QiwyQkFBMkIsYUFBYSw0REFBNEQsbUJBQW1CLG9DQUFvQyxhQUFhLHFCQUFxQixzQ0FBc0MsYUFBYSwwQkFBMEIsc0NBQXNDLFlBQVksMEJBQTBCLDZCQUE2QixRQUFRLCtCQUErQixhQUFhLCtCQUErQixjQUFjLDZCQUE2Qiw0QkFBNEIsd0JBQXdCLHNEQUFzRCxvQkFBb0IsbUJBQW1CLGlDQUFpQyxZQUFZLGdCQUFnQixhQUFhLGFBQWEsaURBQWlELFlBQVksRUFBRSxvREFBb0QsaUJBQWlCLEVBQUUsbUhBQW1ILHVCQUF1QixvQ0FBb0MsdUNBQXVDLCtCQUErQixLQUFLLDJKQUEySiw0QkFBNEIsV0FBVywyR0FBMkcsc0JBQXNCLGlFQUFpRSxXQUFXLGtGQUFrRix5QkFBeUIseUJBQXlCLHVGQUF1RixpQ0FBaUMsdUJBQXVCLFdBQVcsNEZBQTRGLG1DQUFtQyxtQ0FBbUMsbUNBQW1DLCtDQUErQyx5RUFBeUUseUJBQXlCLHlCQUF5Qix5QkFBeUIseUJBQXlCLDZDQUE2Qyx1RUFBdUUseURBQXlELGlDQUFpQyxpQ0FBaUMsaUNBQWlDLDZDQUE2Qyx1QkFBdUIsNENBQTRDLG9CQUFvQixvQkFBb0IsV0FBVyxnRUFBZ0UsK0NBQStDLHlCQUF5Qix5QkFBeUIsMkdBQTJHLGlEQUFpRCwyR0FBMkcsMkdBQTJHLDJEQUEyRCw2REFBNkQsNkNBQTZDLDZJQUE2SSxXQUFXLDRGQUE0RixtQ0FBbUMsMkdBQTJHLDJEQUEyRCw2REFBNkQsV0FBVyxnSUFBZ0kseUJBQXlCLHlEQUF5RCwrQ0FBK0MseUJBQXlCLDJDQUEyQyx1QkFBdUIsdUJBQXVCLDJDQUEyQyxpRUFBaUUsbUVBQW1FLHlEQUF5RCw2Q0FBNkMsdUJBQXVCLGlDQUFpQyx1QkFBdUIsaUNBQWlDLHlIQUF5SCw2Q0FBNkMsdUJBQXVCLGlDQUFpQyxXQUFXLHNCQUFzQiwyQ0FBMkMseUJBQXlCLCtGQUErRix5QkFBeUIseUJBQXlCLHVCQUF1QixXQUFXLDRJQUE0SSxpQ0FBaUMsYUFBYSx1REFBdUQsYUFBYSxhQUFhLFdBQVcsMERBQTBELGFBQWEsMkVBQTJFLHFDQUFxQyx5QkFBeUIsd0ZBQXdGLGlDQUFpQyx1QkFBdUIseURBQXlELDJIQUEySCw0QkFBNEIsNEJBQTRCLGFBQWEsV0FBVyxzQkFBc0IsaUNBQWlDLGlDQUFpQyx1QkFBdUIsaUNBQWlDLG1GQUFtRixtRkFBbUYsa0JBQWtCLGtCQUFrQixvQ0FBb0MseURBQXlELDZDQUE2QyxrQkFBa0IsdUdBQXVHLHlCQUF5Qix5QkFBeUIsNkVBQTZFLDZFQUE2RSxxREFBcUQsYUFBYSxhQUFhLHFDQUFxQyxhQUFhLE9BQU8sVUFBVSxNQUFNLFVBQVUsb0VBQW9FLHlEQUF5RCx5REFBeUQseURBQXlELHVCQUF1QixhQUFhLHFEQUFxRCxhQUFhLHNEQUFzRCxhQUFhLHlCQUF5QixtQ0FBbUMsbUNBQW1DLG1DQUFtQyx1QkFBdUIsdUJBQXVCLHVCQUF1QixzQ0FBc0MsYUFBYSxxQ0FBcUMscURBQXFELHVCQUF1Qix1QkFBdUIsUUFBUSxVQUFVLFlBQVksYUFBYSxhQUFhLE1BQU0sUUFBUSxLQUFLLGlEQUFpRCxvQkFBb0IsZ0NBQWdDLG1CQUFtQixPQUFPLFFBQVEsWUFBWSxpQkFBaUIsb0RBQW9ELDZCQUE2QixvQkFBb0IsaUJBQWlCLHFCQUFxQixxQkFBcUIscUJBQXFCLG1DQUFtQyxrQkFBa0IsaUNBQWlDLHFCQUFxQixFQUFFLDBDQUEwQyxvQkFBb0IsU0FBUyxhQUFhLHFCQUFxQixjQUFjLGFBQWEsaUJBQWlCLCtDQUErQyxnQkFBZ0IsYUFBYSxFQUFFLGdEQUFnRCxZQUFZLEVBQUUsK0NBQStDLG1CQUFtQixXQUFXLFdBQVcsb0JBQW9CLGdDQUFnQyxnQ0FBZ0MsbUNBQW1DLGdDQUFnQyxZQUFZLHNCQUFzQixrQ0FBa0MsbUJBQW1CLFVBQVUscUNBQXFDLFlBQVksc0JBQXNCLHlDQUF5QyxpQkFBaUIsbUJBQW1CLGNBQWMsaUVBQWlFLGlCQUFpQixvQkFBb0Isa0JBQWtCLG9CQUFvQix3QkFBd0IsMkRBQTJELHNCQUFzQiwyREFBMkQsdUJBQXVCLHNCQUFzQix3QkFBd0IsRUFBRSxzQkFBc0IsdUJBQXVCLEVBQUUsOEJBQThCLG9CQUFvQixTQUFTLGNBQWMsa0NBQWtDLHVCQUF1QixtQkFBbUIsa0JBQWtCLGdCQUFnQixrQkFBa0Isa0NBQWtDLGdCQUFnQixrQkFBa0IsZUFBZSw2QkFBNkIsNkJBQTZCLGdCQUFnQixjQUFjLDhCQUE4QixlQUFlLGFBQWEsMEJBQTBCLGFBQWEsYUFBYSwyQkFBMkIsYUFBYSxpQkFBaUIsYUFBYSxvQ0FBb0MsZ0JBQWdCLHdDQUF3QyxrQ0FBa0Msc0NBQXNDLHFDQUFxQyxnQ0FBZ0Msa0JBQWtCLGlDQUFpQyxrQkFBa0IsK0NBQStDLG1CQUFtQixXQUFXLFdBQVcsZ0JBQWdCLGtCQUFrQixrQ0FBa0MsbUJBQW1CLFVBQVUscUJBQXFCLEVBQUUsMEJBQTBCLHFCQUFxQixFQUFFLDJCQUEyQixxQkFBcUIsRUFBRSw2QkFBNkIsb0JBQW9CLGtCQUFrQixrQkFBa0IsY0FBYyxxQkFBcUIseUJBQXlCLDhCQUE4Qiw2QkFBNkIsa0NBQWtDLHFCQUFxQix3QkFBd0IsNEJBQTRCLDhCQUE4QixvQkFBb0Isa0JBQWtCLGtCQUFrQixjQUFjLHFCQUFxQix5QkFBeUIsOEJBQThCLDZCQUE2Qiw2QkFBNkIsa0JBQWtCLGtCQUFrQixrQkFBa0IsY0FBYyxxQkFBcUIseUJBQXlCLDhCQUE4Qiw2QkFBNkIsaUNBQWlDLGdCQUFnQix3QkFBd0IsNkJBQTZCLDRCQUE0QixpQ0FBaUMsaUJBQWlCLHVCQUF1Qiw0QkFBNEIsMkJBQTJCLGlDQUFpQyxzQkFBc0IsV0FBVyxpQkFBaUIsdUNBQXVDLFdBQVcsUUFBUSx1QkFBdUIsa0JBQWtCLG9CQUFvQixtQkFBbUIsT0FBTyxjQUFjLGlCQUFpQixjQUFjLGVBQWUsaUJBQWlCLGdEQUFnRCxtQkFBbUIsV0FBVyxXQUFXLGtCQUFrQixnQ0FBZ0MsZ0NBQWdDLG1DQUFtQyxrQ0FBa0MsbUJBQW1CLGtCQUFrQiw4QkFBOEIsa0JBQWtCLGtCQUFrQixvQkFBb0IsY0FBYyxxQkFBcUIsc0JBQXNCLDJCQUEyQiwwQkFBMEIsa0NBQWtDLGdCQUFnQix3QkFBd0IsNkJBQTZCLDRCQUE0QixrQ0FBa0MsaUJBQWlCLHVCQUF1Qiw0QkFBNEIsMkJBQTJCLCtDQUErQyxnQ0FBZ0MsZ0NBQWdDLGtDQUFrQyxzQkFBc0IsdUJBQXVCLG9CQUFvQixjQUFjLG9CQUFvQixpQkFBaUIsZ0JBQWdCLGtDQUFrQyxvQkFBb0IsNkJBQTZCLG1CQUFtQixvQkFBb0IsWUFBWSxZQUFZLGdDQUFnQyxtQkFBbUIsdUJBQXVCLGNBQWMsK0JBQStCLHlCQUF5QixtQ0FBbUMsZ0JBQWdCLGFBQWEsYUFBYSxvQ0FBb0MsWUFBWSxFQUFFLHlDQUF5QyxhQUFhLDZCQUE2QixhQUFhLGVBQWUsWUFBWSw4QkFBOEIsZUFBZSxrQkFBa0IsZUFBZSxhQUFhLFlBQVksOEJBQThCLGFBQWEsOEJBQThCLCtCQUErQixhQUFhLGVBQWUsZ0NBQWdDLG9CQUFvQixZQUFZLGdCQUFnQixrQkFBa0IsNENBQTRDLGNBQWMsV0FBVyxtQkFBbUIsK0NBQStDLGdCQUFnQixFQUFFLDBEQUEwRCxXQUFXLGNBQWMsc0VBQXNFLFlBQVksNEJBQTRCLFdBQVcsYUFBYSxvQ0FBb0MsK0JBQStCLGdDQUFnQywrQkFBK0Isc0JBQXNCLHVCQUF1QixvQkFBb0IseUJBQXlCLG9CQUFvQixrQkFBa0IsK0NBQStDLGNBQWMsV0FBVyxtQkFBbUIsa0RBQWtELGdCQUFnQixFQUFFLDZEQUE2RCxXQUFXLGNBQWMsc0VBQXNFLGdCQUFnQiw0QkFBNEIsU0FBUyxVQUFVLGFBQWEsa0NBQWtDLHFCQUFxQixnREFBZ0QsWUFBWSx3QkFBd0IsNkJBQTZCLDJCQUEyQix5QkFBeUIsOEJBQThCLDZCQUE2Qiw0Q0FBNEMsZ0NBQWdDLDRDQUE0Qyx5QkFBeUIsK0JBQStCLGFBQWEsMENBQTBDLG1CQUFtQixVQUFVLFVBQVUsWUFBWSxZQUFZLGFBQWEsYUFBYSxtQkFBbUIsa0JBQWtCLGNBQWMsNkJBQTZCLGlCQUFpQixnQ0FBZ0MsYUFBYSxhQUFhLGtDQUFrQyxvREFBb0QsdURBQXVELGlDQUFpQyxrQkFBa0IsTUFBTSxPQUFPLFlBQVksOERBQThELHVEQUF1RCx5RUFBeUUsb0JBQW9CLHlCQUF5QixnQkFBZ0IsaUJBQWlCLEdBQUcsdUNBQXVDLGVBQWUsY0FBYyxvQkFBb0IsZUFBZSxnQkFBZ0IsbUJBQW1CLHdDQUF3QyxvQkFBb0Isb0JBQW9CLEdBQUcscUNBQXFDLHFCQUFxQixFQUFFLCtDQUErQyxvQkFBb0IsV0FBVyxhQUFhLHFCQUFxQixjQUFjLGNBQWMsaUJBQWlCLHVEQUF1RCxnQkFBZ0IsYUFBYSxFQUFFLG9HQUFvRyxZQUFZLEVBQUUsNkRBQTZELFdBQVcsb0JBQW9CLGtCQUFrQixjQUFjLGdDQUFnQyxrQkFBa0Isa0JBQWtCLGtCQUFrQixZQUFZLFdBQVcsaUJBQWlCLGFBQWEsWUFBWSxZQUFZLG1CQUFtQixtQ0FBbUMsY0FBYyxhQUFhLGlDQUFpQyxjQUFjLGNBQWMsZ0ZBQWdGLFdBQVcscUNBQXFDLGFBQWEsa0JBQWtCLG9DQUFvQyxhQUFhLGtCQUFrQix1RUFBdUUsV0FBVyw0QkFBNEIsWUFBWSxjQUFjLHdDQUF3QyxrQkFBa0IsbUJBQW1CLG9CQUFvQixxQkFBcUIsb0JBQW9CLGtCQUFrQix1Q0FBdUMsbUJBQW1CLHFCQUFxQixtQkFBbUIscUJBQXFCLG9CQUFvQixrQkFBa0IsNENBQTRDLGFBQWEsNkNBQTZDLGFBQWEscUNBQXFDLGlCQUFpQixnQkFBZ0IseUNBQXlDLHVCQUF1QixlQUFlLGNBQWMscUJBQXFCLGtDQUFrQyxhQUFhLGdCQUFnQixzQkFBc0IsMENBQTBDLGdCQUFnQixnQkFBZ0IsdUJBQXVCLGtCQUFrQixvQkFBb0IsaUNBQWlDLGdCQUFnQixvQkFBb0Isb0JBQW9CLFNBQVMsRUFBRSwwQkFBMEIscUJBQXFCLEVBQUUsMkJBQTJCLHNCQUFzQixFQUFFLG1DQUFtQyxhQUFhLFlBQVksZ0JBQWdCLG9CQUFvQixVQUFVLGtCQUFrQixFQUFFLG9DQUFvQyxZQUFZLGFBQWEsZ0JBQWdCLG9CQUFvQixVQUFVLG1CQUFtQixvQkFBb0IsYUFBYSxZQUFZLFdBQVcsYUFBYSxFQUFFLHFEQUFxRCxnRUFBZ0Usb0JBQW9CLHFCQUFxQiwrTEFBK0wscUJBQXFCLEtBQUssOENBQThDLFlBQVksb0JBQW9CLGFBQWEsb0JBQW9CLGtCQUFrQiw0QkFBNEIsbUJBQW1CLGNBQWMsYUFBYSxtQkFBbUIsMkJBQTJCLG1CQUFtQixlQUFlLGFBQWEsb0JBQW9CLDJCQUEyQixtQkFBbUIsZUFBZSxhQUFhLGtCQUFrQiwyQkFBMkIsaUJBQWlCLHVDQUF1QyxrQkFBa0IsTUFBTSxPQUFPLFlBQVksNkRBQTZELHVEQUF1RCw0QkFBNEIsd0JBQXdCLDZCQUE2QiwyQkFBMkIsYUFBYSw0REFBNEQsbUJBQW1CLG9DQUFvQyxhQUFhLHFCQUFxQixzQ0FBc0MsYUFBYSwwQkFBMEIsc0NBQXNDLFlBQVksMEJBQTBCLDZCQUE2QixRQUFRLCtCQUErQixhQUFhLCtCQUErQixjQUFjLDZCQUE2Qiw0QkFBNEIsd0JBQXdCLHNEQUFzRCxvQkFBb0IsbUJBQW1CLGlDQUFpQyxZQUFZLGdCQUFnQixhQUFhLGFBQWEsaURBQWlELFlBQVksRUFBRSxvREFBb0QsaUJBQWlCLEVBQUUsbUhBQW1ILHVCQUF1QixvQ0FBb0MsdUNBQXVDLCtCQUErQixLQUFLLDJKQUEySiw0QkFBNEIsdUJBQXVCO0FBQzNyaEM7QUFDZSxzRkFBdUIsRUFBQzs7Ozs7Ozs7Ozs7OztBQ04xQjs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7OztBQUdIOztBQUVBO0FBQ0E7QUFDQSxHQUFHOzs7QUFHSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEU7Ozs7Ozs7Ozs7O0FDakNBLFVBQVUsbUJBQU8sQ0FBQyx5SUFBOEQ7QUFDaEYsMEJBQTBCLG1CQUFPLENBQUMsb0lBQWdEOztBQUVsRjs7QUFFQTtBQUNBLDBCQUEwQixRQUFTO0FBQ25DOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7Ozs7QUFJQSxzQzs7Ozs7Ozs7Ozs7QUNsQkE7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFO0FBQ3BDO0FBQ0E7QUFDQSxrQkFBa0IsRUFBRSxLQUFLLEVBQUU7QUFDM0IsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyx5QkFBeUIsRUFBRSw2QkFBNkIsRUFBRSx3QkFBd0IsRUFBRSxpQ0FBaUMsRUFBRSwyQkFBMkIsRUFBRSxvQ0FBb0MsRUFBRSwrQkFBK0IsRUFBRSx1Q0FBdUMsRUFBRSx5QkFBeUIsRUFBRSw2QkFBNkIsRUFBRSw2QkFBNkIsRUFBRSxxQ0FBcUMsRUFBRSw0QkFBNEIsRUFBRSxvQ0FBb0MsRUFBRSwyQkFBMkIsRUFBRSwrQkFBK0I7QUFDL2dCLGNBQWMseUJBQXlCLEVBQUUseUJBQXlCO0FBQ2xFO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBLGFBQWEsMkNBQTJDO0FBQ3hELFlBQVksc0ZBQXNGO0FBQ2xHLGNBQWMsNkdBQTZHO0FBQzNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHNGQUFzRjtBQUMxRztBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLGNBQWMsY0FBYztBQUM1QjtBQUNBO0FBQ0EsQ0FBQztBQUNELENBQUM7QUFDRDtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQy9LQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsb0JBQW9CLHdEQUF3RDtBQUMxRyxxREFBcUQsc0JBQXNCLHdCQUF3Qix1QkFBdUI7QUFDMUgsRUFBRTtBQUNGO0FBQ0EsNERBQTRELHlCQUF5QixzQkFBc0Isc0JBQXNCO0FBQ2pJLEVBQUU7QUFDRiwyQkFBMkI7QUFDM0I7QUFDQSxvQkFBb0IsYUFBYTtBQUNqQywyQkFBMkIsT0FBTztBQUNsQztBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsR0FBRyxRQUFRLEdBQUc7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLG1CQUFtQixXQUFXO0FBQzlCO0FBQ0EscUJBQXFCLHlDQUF5QztBQUM5RDtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLGtCQUFrQjtBQUMvQztBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxtQ0FBbUMsSUFBSSxtQkFBbUI7QUFDMUQsZ0NBQWdDLCtCQUErQjtBQUMvRCxXQUFXLFNBQVMsRUFBRTtBQUN0QjtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLDBJQUEwSSxFQUFFO0FBQzVJO0FBQ0Esb0VBQW9FLEVBQUUsUUFBUSxFQUFFO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLHFCQUFxQjtBQUN4RDtBQUNBLEdBQUc7QUFDSCxRQUFRLGlEQUFpRDtBQUN6RDtBQUNBO0FBQ0EsbUJBQW1CLGdCQUFnQixRQUFRO0FBQzNDLFNBQVMsZ0JBQWdCLFNBQVMsRUFBRTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBLDJDQUEyQyw2QkFBNkI7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLEtBQUs7QUFDbEM7QUFDQTtBQUNBLCtCQUErQixlQUFlO0FBQzlDO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixrQkFBa0I7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBLGdEQUFnRCxnQkFBZ0IsRUFBRTtBQUNsRSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLG1DQUFtQyxrQkFBa0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxtQ0FBbUMsa0JBQWtCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLFlBQVk7QUFDL0Isa0NBQWtDO0FBQ2xDO0FBQ0EsRUFBRTtBQUNGO0FBQ0EsaUhBQWlILDBDQUEwQyxjQUFjO0FBQ3pLO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxxQ0FBcUM7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsWUFBWSxXQUFXO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLE9BQU87QUFDaEMsc0JBQXNCLFVBQVU7QUFDaEMsc0JBQXNCLFVBQVU7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsV0FBVztBQUMzQixnQkFBZ0IsVUFBVTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsZ0JBQWdCO0FBQzNCO0FBQ0EsWUFBWSxnQkFBZ0I7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSw0QkFBNEIsZUFBZTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsU0FBUztBQUNuQztBQUNBLG9CQUFvQix1QkFBdUI7QUFDM0MsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsVUFBVTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQixJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixVQUFVO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixjQUFjO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsYUFBYTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0Esc0JBQXNCLFVBQVU7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0Q7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0Q7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixrQkFBa0IsOERBQThEO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsZ0JBQWdCO0FBQ3RDLHFCQUFxQixnQkFBZ0I7QUFDckMsc0JBQXNCLGVBQWU7QUFDckMsd0NBQXdDO0FBQ3hDLHNDQUFzQztBQUN0QyxrQkFBa0Isc0RBQXNEO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCOztBQUVqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmLGVBQWU7QUFDZjtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBLGNBQWMsb01BQW9NO0FBQ2xOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBLG1CQUFtQiwwVEFBMFQ7QUFDN1U7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBLEdBQUcsNkJBQTZCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0Esc0JBQXNCLGdFQUFnRTtBQUN0RjtBQUNBLHFDQUFxQyw0QkFBNEI7QUFDakUsc0NBQXNDO0FBQ3RDLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNEJBQTRCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsOEJBQThCO0FBQ25FO0FBQ0E7QUFDQSxzQ0FBc0M7QUFDdEMsSUFBSTtBQUNKO0FBQ0EscUJBQXFCLDBCQUEwQjtBQUMvQztBQUNBO0FBQ0EsY0FBYyxRQUFRO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxjQUFjLFFBQVE7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLG9CQUFvQjtBQUMzRDtBQUNBO0FBQ0EsdUJBQXVCLDBCQUEwQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEscUJBQXFCO0FBQ2xDLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLGFBQWE7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5QkFBeUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Qsd0JBQXdCO0FBQzlFOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsaUNBQWlDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix1SUFBdUk7QUFDdko7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLFlBQVksK0JBQStCLEVBQUU7QUFDN0MseUJBQXlCLHlCQUF5QixFQUFFO0FBQ3BEO0FBQ0Esb0RBQW9EO0FBQ3BELElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQyxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsYUFBYTtBQUNqQztBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSw2Q0FBNkM7QUFDN0MsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsWUFBWSx3QkFBd0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxVQUFVLEVBQUU7QUFDNUQ7QUFDQTtBQUNBLHNDQUFzQywrQkFBK0IsRUFBRTtBQUN2RTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLGVBQWU7QUFDckQsaURBQWlELDJCQUEyQjtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsWUFBWSxZQUFZO0FBQ3hCO0FBQ0EsNEJBQTRCLGlCQUFpQjtBQUM3QztBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsOEVBQThFO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLHdCQUF3QixFQUFFO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxPQUFPLDJCQUEyQjtBQUN2QyxJQUFJLE9BQU8sUUFBUTtBQUNuQiwySUFBMkk7QUFDM0k7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQyxLQUFLO0FBQ0wsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixtRUFBbUUsMERBQTBEO0FBQzdIO0FBQ0E7QUFDQTtBQUNBLGVBQWUsV0FBVztBQUMxQjtBQUNBLG1DQUFtQyxlQUFlO0FBQ2xEO0FBQ0EsZ0JBQWdCLGdCQUFnQjtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx5QkFBeUI7QUFDdkM7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGNBQWM7QUFDaEM7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLEtBQUs7QUFDTCxlQUFlLGNBQWM7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLGlDQUFpQztBQUMxQztBQUNBO0FBQ0EsYUFBYSx1QkFBdUIsa0JBQWtCO0FBQ3REO0FBQ0E7QUFDQSxTQUFTLCtDQUErQztBQUN4RDtBQUNBLHVDQUF1QztBQUN2QztBQUNBO0FBQ0EsOEJBQThCLG9EQUFvRDtBQUNsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsNEJBQTRCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUseUJBQXlCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixjQUFjO0FBQ2pDO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsTUFBTTtBQUNOLGdCQUFnQixjQUFjO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssT0FBTywyQkFBMkI7QUFDdkMsSUFBSSxPQUFPLFFBQVE7O0FBRW5CO0FBQ0E7QUFDQSxnQkFBZ0IsZ0JBQWdCLGtCQUFrQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxpT0FBaU87QUFDak87QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxjQUFjO0FBQ3hELGdCQUFnQixZQUFZO0FBQzVCLHNCQUFzQjtBQUN0QixtQ0FBbUMsZUFBZTtBQUNsRDtBQUNBLGdCQUFnQixnQkFBZ0I7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCLDBCQUEwQix1QkFBdUI7QUFDakQ7QUFDQSxhQUFhLG1CQUFtQjtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEIsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLE9BQU87QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsa0NBQWtDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixrQkFBa0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0EsU0FBUywrQ0FBK0M7QUFDeEQ7QUFDQSx1Q0FBdUM7QUFDdkM7QUFDQTtBQUNBLDhCQUE4QixvREFBb0Q7QUFDbEY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLDRCQUE0QjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekIsNEJBQTRCLHVCQUF1QjtBQUNuRDs7QUFFQSxlQUFlLG1CQUFtQjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSx1RUFBdUU7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLEtBQUs7QUFDTCwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBLG9EQUFvRCxhQUFhO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHdCQUF3QjtBQUNyRCw2QkFBNkIsMkJBQTJCO0FBQ3hELDZCQUE2QixzQkFBc0I7QUFDbkQsNkJBQTZCLDhCQUE4QjtBQUMzRCw2QkFBNkIseUJBQXlCO0FBQ3RELDZCQUE2QixpQ0FBaUM7QUFDOUQsNkJBQTZCLDBCQUEwQjtBQUN2RCxnQ0FBZ0MsNkVBQTZFO0FBQzdHLDZCQUE2Qiw0QkFBNEI7QUFDekQsZ0NBQWdDLGlGQUFpRjtBQUNqSCxnQ0FBZ0MsNkVBQTZFO0FBQzdHLDZCQUE2QiwwQkFBMEI7QUFDdkQsZ0NBQWdDLHlFQUF5RTtBQUN6Ryw2QkFBNkIsd0JBQXdCO0FBQ3JELDZCQUE2Qix3QkFBd0I7QUFDckQsZ0NBQWdDOztBQUVoQyxJQUFJO0FBQ0o7QUFDQSx5QkFBeUIsNEJBQTRCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDZCQUE2QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTyxZQUFZO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLDRCQUE0QjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsNEJBQTRCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxZQUFZO0FBQ2xCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsY0FBYyxZQUFZO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksU0FBUztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixVQUFVO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLGdCQUFnQiw2QkFBNkIsaUNBQWlDO0FBQ3JIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0EseUJBQXlCLHFHQUFxRztBQUM5SCxNQUFNO0FBQ047QUFDQSx5QkFBeUIsMEVBQTBFO0FBQ25HO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixvR0FBb0c7QUFDN0gsTUFBTTtBQUNOO0FBQ0EseUJBQXlCLHlFQUF5RTtBQUNsRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQSx3Q0FBd0M7QUFDeEM7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWix1QkFBdUIsdUNBQXVDO0FBQzlELDRCQUE0Qiw4QkFBOEIscUJBQXFCO0FBQy9FLDBCQUEwQiwyQkFBMkIsdUJBQXVCO0FBQzVFLDBCQUEwQiw2QkFBNkIsd0JBQXdCO0FBQy9FLHlEQUF5RCxrQ0FBa0M7QUFDM0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMseUJBQXlCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsUUFBUTtBQUNsRCxzQ0FBc0MsMkVBQTJFO0FBQ2pIO0FBQ0E7QUFDQSw0QkFBNEIsWUFBWTtBQUN4QywyQkFBMkIsUUFBUTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLG1EQUFtRDtBQUM1RSxhQUFhLG9EQUFvRDtBQUNqRTtBQUNBLGVBQWUsa0JBQWtCO0FBQ2pDO0FBQ0Esa0JBQWtCLDJCQUEyQjtBQUM3Qyw0Q0FBNEM7QUFDNUM7QUFDQSx5QkFBeUIsVUFBVTtBQUNuQyxPQUFPO0FBQ1A7QUFDQSx5Q0FBeUMsb0NBQW9DO0FBQzdFLHlCQUF5QixVQUFVO0FBQ25DO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsZ0JBQWdCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLG9DQUFvQztBQUMvRSxXQUFXLHFCQUFxQjtBQUNoQztBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsaUJBQWlCO0FBQzlCO0FBQ0EsZ0JBQWdCLDJCQUEyQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLDBFQUEwRTtBQUMxRTtBQUNBLG1GQUFtRjtBQUNuRjtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsdUNBQXVDO0FBQzlFLHNCQUFzQjtBQUN0QjtBQUNBLDBCQUEwQixtQkFBbUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHVCQUF1QjtBQUM3QztBQUNBLDhKQUE4SixtQkFBbUIsWUFBWSxtSEFBbUg7QUFDaFQsc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBLFlBQVksc0JBQXNCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFlBQVk7QUFDaEMsNEJBQTRCO0FBQzVCO0FBQ0EsdURBQXVELGtCQUFrQixjQUFjO0FBQ3ZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLHlCQUF5QixjQUFjO0FBQzNDLG9CQUFvQixZQUFZO0FBQ2hDO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQSxvSEFBb0gsa0JBQWtCO0FBQ3RJO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixXQUFXLEVBQUU7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsY0FBYztBQUM3QztBQUNBO0FBQ0Esb0JBQW9CLCtDQUErQztBQUNuRSx1QkFBdUIsa0RBQWtEO0FBQ3pFO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLFNBQVMsU0FBUyxTQUFTLFNBQVM7QUFDbkU7QUFDQSxvQkFBb0IsVUFBVSxVQUFVO0FBQ3hDLGtDQUFrQztBQUNsQyx5QkFBeUIsVUFBVSxTQUFTO0FBQzVDLEtBQUssOEJBQThCLFVBQVUsU0FBUztBQUN0RCw2QkFBNkIsY0FBYztBQUMzQyx3Q0FBd0MsYUFBYTtBQUNyRCxzQ0FBc0Msa0JBQWtCO0FBQ3hELHNDQUFzQyxrQkFBa0I7QUFDeEQsc0NBQXNDLGdCQUFnQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLGNBQWM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSx3Q0FBd0MsUUFBUTtBQUNoRCxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLHFDQUFxQztBQUMzQyxLQUFLLE9BQU8sZ0VBQWdFO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0Esd0VBQXdFLFFBQVE7QUFDaEY7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLDhFQUE4RSx1QkFBdUI7QUFDMUk7QUFDQSxnQ0FBZ0M7QUFDaEMsSUFBSTtBQUNKO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsMENBQTBDO0FBQzFDLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxtQkFBbUIsdUJBQXVCO0FBQzFDO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsK0JBQStCLDhCQUE4QjtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsY0FBYyxvQkFBb0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRDtBQUNsRDtBQUNBO0FBQ0EsV0FBVyx3QkFBd0I7QUFDbkMsdUNBQXVDLGtEQUFrRDtBQUN6RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLGdDQUFnQztBQUN4QyxrQ0FBa0MscUJBQXFCLFlBQVk7QUFDbkU7QUFDQTtBQUNBLFFBQVEsNkJBQTZCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixzTEFBc0w7QUFDbE47QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLG9IQUFvSDtBQUNoSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixHQUFHO0FBQ0g7QUFDQSwwQkFBMEIsb0JBQW9CO0FBQzlDO0FBQ0Esd0JBQXdCLGdCQUFnQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxLQUFLO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxnQkFBZ0I7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksa0JBQWtCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLHlCQUF5QjtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyw4QkFBOEI7QUFDL0QsU0FBUyw4REFBOEQ7QUFDdkUsb0RBQW9ELCtCQUErQjtBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0Msb0NBQW9DLFlBQVksdUNBQXVDO0FBQ3RJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDLElBQUk7QUFDSjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkdBQTJHO0FBQzNHO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiw4TUFBOE07QUFDcE87QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRDtBQUNqRDtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQSxvREFBb0QsY0FBYztBQUNsRSxzQkFBc0I7QUFDdEI7QUFDQSxtQ0FBbUMsa0NBQWtDO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCwrQkFBK0IsZ0NBQWdDLHVCQUF1QjtBQUN0RixvQ0FBb0MsZ0NBQWdDO0FBQ3BFO0FBQ0E7QUFDQSx1QkFBdUIsNEVBQTRFLE9BQU87QUFDMUcsR0FBRztBQUNILHNFQUFzRSxRQUFRO0FBQzlFO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQix5Q0FBeUM7QUFDeEU7QUFDQSx3QkFBd0IsUUFBUTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsS0FBSztBQUNMLElBQUk7QUFDSjtBQUNBO0FBQ0EsK0JBQStCLFFBQVEsaUJBQWlCO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLHNCQUFzQixrQ0FBa0M7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsd0JBQXdCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxxQkFBcUI7QUFDL0I7QUFDQTtBQUNBLHVDQUF1QyxvQ0FBb0MsOEJBQThCO0FBQ3pHLFNBQVM7QUFDVCxzQkFBc0IsdUJBQXVCO0FBQzdDLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxtREFBbUQ7QUFDdEcsdUpBQXVKLFFBQVE7QUFDL0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLFdBQVcscUNBQXFDO0FBQ2hEO0FBQ0EsS0FBSztBQUNMO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGdDQUFnQyx3QkFBd0IsaUJBQWlCO0FBQ3hHO0FBQ0E7QUFDQSwwQkFBMEIsbUJBQW1CO0FBQzdDO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBLCtCQUErQixzQkFBc0I7QUFDckQsbUJBQW1CLFVBQVU7QUFDN0I7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsd0RBQXdEO0FBQ2xHLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUIsMEJBQTBCLCtDQUErQztBQUN6RTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsMERBQTBEO0FBQ3RHLEdBQUc7QUFDSDtBQUNBLGNBQWMsbURBQW1ELHNCQUFzQixFQUFFO0FBQ3pGO0FBQ0EsNENBQTRDLG1EQUFtRDtBQUMvRjtBQUNBLFNBQVMsNEVBQTRFO0FBQ3JGO0FBQ0Esa0NBQWtDLHlCQUF5QjtBQUMzRCwwQkFBMEI7QUFDMUIsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxjQUFjO0FBQzdELElBQUk7QUFDSiw2Q0FBNkMsY0FBYztBQUMzRDtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSxjQUFjLGlDQUFpQztBQUMvQyxlQUFlLG1DQUFtQztBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEMsMENBQTBDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLElBQUk7QUFDSjtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsOERBQThEO0FBQ3RGLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3RUFBd0UsaUVBQWlFO0FBQ3pJO0FBQ0Esb0JBQW9CLFNBQVM7QUFDN0I7QUFDQSxPQUFPO0FBQ1AsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLG9CQUFvQixXQUFXO0FBQy9DO0FBQ0Esd0VBQXdFLGlFQUFpRTtBQUN6STtBQUNBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWSxzQkFBc0I7QUFDbEM7QUFDQSxHQUFHLE9BQU87QUFDVjtBQUNBO0FBQ0EscUJBQXFCLGlCQUFpQjtBQUN0QyxHQUFHO0FBQ0gsb0VBQW9FLGNBQWMsRUFBRTtBQUNwRjtBQUNBLHNCQUFzQixnQkFBZ0I7QUFDdEM7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFO0FBQ2pFLGlCQUFpQiw4RUFBOEU7QUFDL0Y7QUFDQSwrQkFBK0I7QUFDL0IsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQSx3Q0FBd0MsMEJBQTBCOztBQUVsRSxhQUFhO0FBQ2IsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCLGVBQWUsYUFBYTtBQUM1QjtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0Esb0RBQW9EO0FBQ3BELEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLFFBQVE7QUFDeEM7QUFDQTtBQUNBLGtGQUFrRixRQUFRO0FBQzFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsbURBQW1EO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtGQUErRiwyQ0FBMkM7QUFDMUksaURBQWlELHlDQUF5QyxFQUFFO0FBQzVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QiwyQ0FBMkM7QUFDeEU7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsd0NBQXdDO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsNENBQTRDO0FBQ3hFO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsa0ZBQWtGO0FBQ2hHO0FBQ0E7QUFDQSxjQUFjLDRIQUE0SDtBQUMxSTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLGNBQWMsMEZBQTBGO0FBQ3hHO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsY0FBYyxZQUFZO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixrQkFBa0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsNENBQTRDLHdDQUF3QztBQUNwRixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ04saUJBQWlCLGtCQUFrQixRQUFRO0FBQzNDO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixzQkFBc0I7QUFDNUMsV0FBVyx5QkFBeUI7QUFDcEMsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0EsYUFBYSxjQUFjO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsOEJBQThCO0FBQzNEO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qix1QkFBdUIsNENBQTRDO0FBQzVGO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxFQUFFO0FBQ0Y7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3Qyx1QkFBdUI7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix5QkFBeUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0UsdUNBQXVDO0FBQ3ZHLGVBQWUsNkJBQTZCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsNENBQTRDO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDLE1BQU07QUFDTjtBQUNBLHVCQUF1QixzQkFBc0I7QUFDN0MsYUFBYSx5QkFBeUI7QUFDdEMsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLGNBQWM7QUFDOUM7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGdCQUFnQjtBQUMzQyxtQ0FBbUMsZ0JBQWdCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQyx5QkFBeUIsb0JBQW9CLGNBQWMsRUFBRTtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsOEJBQThCO0FBQzFEO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkIscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBLFdBQVcsMkNBQTJDO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLHlCQUF5QixpRUFBaUU7QUFDMUY7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLDBEQUEwRDtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBLDhCQUE4Qiw4Q0FBOEM7QUFDNUUsRUFBRTtBQUNGO0FBQ0EsOEJBQThCLDBDQUEwQztBQUN4RSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix5REFBeUQ7QUFDOUU7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQix1QkFBdUI7QUFDdkI7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBLHVCQUF1QiwwQ0FBMEM7QUFDakUsa0RBQWtEO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxtQkFBbUIsUUFBUTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLFFBQVE7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMENBQTBDO0FBQ3BFLGVBQWUsdUNBQXVDO0FBQ3REO0FBQ0E7QUFDQSxLQUFLOztBQUVMLGVBQWUsUUFBUTs7QUFFdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx5Q0FBeUM7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhLCtCQUErQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLDJCQUEyQjtBQUNoRCxHQUFHO0FBQ0gsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQSxLQUFLO0FBQ0wsSUFBSSxPQUFPLFFBQVE7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQywwQkFBMEIsT0FBTztBQUNwRTtBQUNBLG1DQUFtQztBQUNuQztBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBLEtBQUs7QUFDTCxJQUFJLE9BQU87QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsNkJBQTZCO0FBQ3ZFO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQSxLQUFLO0FBQ0wsSUFBSSxPQUFPO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0QsMENBQTBDO0FBQ2xHLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsaUJBQWlCO0FBQzlDO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0EsS0FBSztBQUNMLElBQUksT0FBTztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxpREFBaUQ7QUFDNUcsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLFlBQVksMkJBQTJCLEdBQUc7QUFDL0QsYUFBYSxpQkFBaUI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QixrQ0FBa0M7QUFDbEMsa0NBQWtDO0FBQ2xDLDZCQUE2QjtBQUM3Qiw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLHlDQUF5QyxxQkFBcUI7QUFDOUQsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLG9EQUFvRCxHQUFHO0FBQzdGLHNCQUFzQixvQkFBb0I7QUFDMUMsb0JBQW9CLFlBQVksZ0JBQWdCO0FBQ2hELGtCQUFrQjtBQUNsQjtBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLGVBQWU7QUFDbEI7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCxVQUFVO0FBQ3hFO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrREFBK0QsVUFBVTtBQUN6RTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLENBQUM7QUFDRCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixtQkFBbUIsY0FBYztBQUNqQztBQUNBLFlBQVksWUFBWTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxZQUFZO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEIsb0JBQW9CLHlCQUF5QjtBQUM3QyxhQUFhLHVCQUF1QjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxjQUFjO0FBQ3BELHVDQUF1QyxnQkFBZ0I7QUFDdkQsaUJBQWlCLG9FQUFvRTtBQUNyRjtBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEM7QUFDMUM7O0FBRUE7QUFDQSxvQ0FBb0M7QUFDcEM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxPQUFPO0FBQ3JCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixjQUFjO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEIsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixxRUFBcUU7QUFDN0Y7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLG9CQUFvQjtBQUNwQix1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVFQUF1RTtBQUMvRjtBQUNBO0FBQ0E7O0FBRUEsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmLEdBQUcsMkJBQTJCO0FBQzlCO0FBQ0E7QUFDQSxzQkFBc0IsUUFBUTtBQUM5QjtBQUNBLGdCQUFnQixxQkFBcUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkIscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxzRkFBc0Y7QUFDdEY7QUFDQSxNQUFNO0FBQ04scUJBQXFCO0FBQ3JCLDZCQUE2QixrQkFBa0I7QUFDL0M7QUFDQSwyQ0FBMkM7QUFDM0MsTUFBTTtBQUNOLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLG1CQUFtQjtBQUNyRDtBQUNBO0FBQ0EsNkNBQTZDO0FBQzdDLGNBQWMsOEJBQThCLFVBQVUseUJBQXlCLE9BQU8sR0FBRztBQUN6RixpQkFBaUIsNkJBQTZCLFlBQVk7QUFDMUQ7QUFDQSxvQ0FBb0M7QUFDcEMsSUFBSTtBQUNKO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBLDhFQUE4RSxxQ0FBcUM7QUFDbkg7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsc0JBQXNCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0Esc0ZBQXNGO0FBQ3RGO0FBQ0EsTUFBTTtBQUNOLHFCQUFxQjtBQUNyQiw2QkFBNkIsa0JBQWtCO0FBQy9DO0FBQ0EsMkNBQTJDO0FBQzNDLE1BQU07QUFDTixLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxtQkFBbUI7QUFDckQ7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0EsbUNBQW1DLFVBQVUseUJBQXlCLE9BQU87QUFDN0U7QUFDQTtBQUNBLGlCQUFpQiw2QkFBNkIsWUFBWTtBQUMxRDtBQUNBLG1DQUFtQztBQUNuQyxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLDBHQUEwRyxnQkFBZ0IsY0FBYztBQUN4STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsdUJBQXVCLEVBQUU7QUFDekQsaUJBQWlCLHlCQUF5QjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixvQ0FBb0MsRUFBRTtBQUN0RCxnQkFBZ0IsdUNBQXVDO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxZQUFZLG9CQUFvQixtQkFBbUI7QUFDOUY7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQSxrQ0FBa0M7QUFDbEMsMEJBQTBCLHlCQUF5QjtBQUNuRDtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaUJBQWlCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RDtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdGQUFnRixvQkFBb0I7QUFDcEcsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLGtEQUFrRCw2Q0FBNkM7QUFDL0YsZ0NBQWdDLDRDQUE0QztBQUM1RSw0QkFBNEI7QUFDNUIsK0JBQStCLGNBQWM7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFFBQVEsbURBQW1EO0FBQzNELE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RDtBQUM3RCxRQUFRO0FBQ1I7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiw0Q0FBNEM7QUFDbEU7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGFBQWE7QUFDOUI7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxvQ0FBb0M7QUFDckYsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxzRUFBc0UsWUFBWTtBQUNsRjs7QUFFQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsMEJBQTBCO0FBQ3JELDhDQUE4QyxrQkFBa0I7QUFDaEU7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0QsWUFBWTtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxPQUFPO0FBQ1Asd0JBQXdCO0FBQ3hCLHdCQUF3QjtBQUN4QixhQUFhLGdHQUFnRztBQUM3RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qix3Q0FBd0M7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxRQUFROztBQUV0QjtBQUNBLG9CQUFvQixrQkFBa0I7QUFDdEM7QUFDQSxrQ0FBa0MsT0FBTztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxpQ0FBaUMscUJBQXFCO0FBQ3REO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsU0FBUztBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG1DQUFtQztBQUNwRSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsWUFBWTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBb0Isa0JBQWtCO0FBQ3RDLGNBQWMsU0FBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZixlQUFlLGlCQUFpQjs7QUFFaEMsd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx3Q0FBd0MsNENBQTRDO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxxQkFBcUI7QUFDdkQ7QUFDQSxZQUFZLHdDQUF3QztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDRCQUE0QjtBQUM1QixvQkFBb0I7O0FBRXBCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1Asa0JBQWtCLHFCQUFxQjtBQUN2QztBQUNBLGNBQWMsNERBQTREO0FBQzFFO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLGlCQUFpQixxQ0FBcUM7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwRUFBMEUsb0JBQW9CO0FBQzlGO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0gsRUFBRTtBQUNGO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLEtBQUs7QUFDN0IseUJBQXlCLEtBQUs7O0FBRTlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQsU0FBUyxjQUFjLGlCQUFpQjtBQUM3RixxREFBcUQsU0FBUyxrREFBa0Q7QUFDaEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLEtBQUs7QUFDTDtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIscUJBQXFCLGFBQWE7QUFDNUQsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNOztBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLG9DQUFvQyxvRkFBb0YsRUFBRTtBQUM1SSxrQkFBa0IsdUNBQXVDLHVGQUF1RjtBQUNoSjtBQUNBO0FBQ0Esa0JBQWtCLG9DQUFvQywrRkFBK0Y7QUFDckosa0JBQWtCLHVDQUF1QyxpR0FBaUc7QUFDMUo7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRTtBQUNGO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLENBQUM7QUFDRCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsOENBQThDLG1CQUFtQixJQUFJO0FBQ2pHLE1BQU07QUFDTjtBQUNBLENBQUM7O0FBRUQsNkJBQTZCO0FBQzdCLCtCQUErQjtBQUMvQix5QkFBeUIsNEJBQTRCLHlCQUF5QjtBQUM5RSx5QkFBeUIsNEJBQTRCLHlCQUF5Qjs7QUFFOUU7QUFDQSxPQUFPO0FBQ1AsbUJBQW1CLHNFQUFzRSxlQUFlLDRCQUE0Qiw2RkFBNkYsRUFBRSxnQkFBZ0IsTUFBTSxTQUFTO0FBQ2xRLGNBQWMsK0JBQStCLFdBQVcsSUFBSTtBQUM1RCx5QkFBeUI7QUFDekI7O0FBRUE7O0FBRUEsYUFBYSw2QkFBNkIsdUNBQXVDO0FBQ2pGLHVDQUF1QyxrQ0FBa0MsaUNBQWlDLE1BQU07QUFDaEg7O0FBRUE7QUFDQSxtQ0FBbUMsS0FBSztBQUN4QyxDQUFDO0FBQ0Qsa0JBQWtCLFdBQVcsaUJBQWlCO0FBQzlDLFVBQVUsUUFBUTtBQUNsQjtBQUNBLDZCQUE2QixLQUFLLFdBQVcscUJBQXFCO0FBQ2xFLENBQUM7QUFDRDtBQUNBO0FBQ0EsY0FBYyxNQUFNO0FBQ3BCLGNBQWMsSUFBSSxvQ0FBb0MsV0FBVztBQUNqRSxjQUFjLGdFQUFnRTtBQUM5RSxjQUFjLGlFQUFpRSxNQUFNLGdDQUFnQyx3Q0FBd0MsNEhBQTRILFFBQVEsZUFBZSxFQUFFLE1BQU0sV0FBVztBQUNuVSxtQkFBbUIseUJBQXlCLGdCQUFnQjtBQUM1RCxjQUFjLFdBQVcseUJBQXlCLGNBQWMsb0JBQW9CLGdFQUFnRSxVQUFVLEdBQUcsaUJBQWlCLEdBQUc7QUFDckwsQ0FBQyxVQUFVO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHdCQUF3QjtBQUN4Qiw2QkFBNkI7QUFDN0I7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLGlCQUFpQixPQUFPLDJDQUEyQztBQUNuRTtBQUNBLFVBQVUsdUVBQXVFO0FBQ2pGLFVBQVUsUUFBUSwyRUFBMkU7QUFDN0Y7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsUUFBUTtBQUM5QixxQkFBcUIsTUFBTTtBQUMzQjtBQUNBLHVDQUF1QyxJQUFJLGVBQWU7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxPQUFPO0FBQ1gsWUFBWSxZQUFZO0FBQ3hCO0FBQ0EsUUFBUSxrREFBa0Q7QUFDMUQ7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRixDQUFDO0FBQ0QsY0FBYyxxQ0FBcUM7QUFDbkQsZUFBZTtBQUNmLENBQUMsVUFBVTtBQUNYOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxnRkFBZ0Y7QUFDM0YsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsT0FBTztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixRQUFRO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLDJCQUEyQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixHQUFHO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLEdBQUc7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixHQUFHO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLHNDQUFzQywyQkFBMkIsRUFBRTtBQUNuRTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLHNDQUFzQywyQkFBMkIsRUFBRTtBQUNuRTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLHNDQUFzQywyQkFBMkIsRUFBRTtBQUNuRTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0EscUJBQXFCLFFBQVE7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsQ0FBQztBQUNELENBQUM7QUFDRDtBQUNB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QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0EsNEJBQTRCLGtCQUFrQjtBQUM5QyxFQUFFOztBQUVGO0FBQ0EsNEJBQTRCLGlCQUFpQjtBQUM3QyxFQUFFOztBQUVGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQSxlQUFlLG9CQUFvQjtBQUNuQztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7O0FBRUY7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7O0FBRUY7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsU0FBUyxrQ0FBa0M7QUFDM0M7QUFDQTtBQUNBLGNBQWM7QUFDZDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQSxDQUFDIiwiZmlsZSI6InZlbmRvcnN+d2lkZ2V0LWpxZ3JpZC1qcy5jaHVuay5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEltcG9ydHNcbmltcG9ydCBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18gZnJvbSBcIi4uLy4uL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qc1wiO1xudmFyIF9fX0NTU19MT0FERVJfRVhQT1JUX19fID0gX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fKHRydWUpO1xuLy8gTW9kdWxlXG5fX19DU1NfTE9BREVSX0VYUE9SVF9fXy5wdXNoKFttb2R1bGUuaWQsIFwiLypHcmlkKi9cXHJcXG4udWktanFncmlkIHtwb3NpdGlvbjogcmVsYXRpdmU7fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC12aWV3IHtwb3NpdGlvbjogcmVsYXRpdmU7bGVmdDowOyB0b3A6IDA7IHBhZGRpbmc6IDA7IGZvbnQtc2l6ZToxMXB4O31cXHJcXG4vKiBjYXB0aW9uKi9cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtdGl0bGViYXIge3BhZGRpbmc6IC4zZW0gLjJlbSAuMmVtIC4zZW07IHBvc2l0aW9uOiByZWxhdGl2ZTsgZm9udC1zaXplOiAxMnB4OyBib3JkZXItbGVmdDogMCBub25lO2JvcmRlci1yaWdodDogMCBub25lOyBib3JkZXItdG9wOiAwIG5vbmU7fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1jYXB0aW9uIHt0ZXh0LWFsaWduOiBsZWZ0O31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtdGl0bGUgeyBtYXJnaW46IC4xZW0gMCAuMmVtOyB9XFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXRpdGxlYmFyLWNsb3NlIHsgcG9zaXRpb246IGFic29sdXRlO3RvcDogNTAlOyB3aWR0aDogMTlweDsgbWFyZ2luOiAtMTBweCAwIDAgMDsgcGFkZGluZzogMXB4OyBoZWlnaHQ6MThweDsgY3Vyc29yOnBvaW50ZXI7fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC10aXRsZWJhci1jbG9zZSBzcGFuIHsgZGlzcGxheTogYmxvY2s7IG1hcmdpbjogMXB4OyB9XFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXRpdGxlYmFyLWNsb3NlOmhvdmVyIHsgcGFkZGluZzogMDsgfVxcclxcbi8qIGhlYWRlciovXFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLWhkaXYge3Bvc2l0aW9uOiByZWxhdGl2ZTsgbWFyZ2luOiAwO3BhZGRpbmc6IDA7IG92ZXJmbG93LXg6IGhpZGRlbjsgYm9yZGVyLWxlZnQ6IDAgbm9uZSAhaW1wb3J0YW50OyBib3JkZXItdG9wIDogMCBub25lICFpbXBvcnRhbnQ7IGJvcmRlci1yaWdodCA6IDAgbm9uZSAhaW1wb3J0YW50O31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtaGJveCB7ZmxvYXQ6IGxlZnQ7IHBhZGRpbmctcmlnaHQ6IDIwcHg7fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1odGFibGUge3RhYmxlLWxheW91dDpmaXhlZDttYXJnaW46MDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLWh0YWJsZSB0aCB7aGVpZ2h0OjIycHg7cGFkZGluZzogMCAycHggMCAycHg7fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1odGFibGUgdGggZGl2IHtvdmVyZmxvdzogaGlkZGVuOyBwb3NpdGlvbjpyZWxhdGl2ZTsgaGVpZ2h0OjE3cHg7fVxcclxcbi51aS10aC1jb2x1bW4sIC51aS1qcWdyaWQgLnVpLWpxZ3JpZC1odGFibGUgdGgudWktdGgtY29sdW1uIHtvdmVyZmxvdzogaGlkZGVuO3doaXRlLXNwYWNlOiBub3dyYXA7dGV4dC1hbGlnbjpjZW50ZXI7Ym9yZGVyLXRvcCA6IDAgbm9uZTtib3JkZXItYm90dG9tIDogMCBub25lO31cXHJcXG4udWktdGgtbHRyLCAudWktanFncmlkIC51aS1qcWdyaWQtaHRhYmxlIHRoLnVpLXRoLWx0ciB7Ym9yZGVyLWxlZnQgOiAwIG5vbmU7fVxcclxcbi51aS10aC1ydGwsIC51aS1qcWdyaWQgLnVpLWpxZ3JpZC1odGFibGUgdGgudWktdGgtcnRsIHtib3JkZXItcmlnaHQgOiAwIG5vbmU7fVxcclxcbi51aS1maXJzdC10aC1sdHIge2JvcmRlci1yaWdodDogMXB4IHNvbGlkOyB9XFxyXFxuLnVpLWZpcnN0LXRoLXJ0bCB7Ym9yZGVyLWxlZnQ6IDFweCBzb2xpZDsgfVxcclxcbi51aS1qcWdyaWQgLnVpLXRoLWRpdi1pZSB7d2hpdGUtc3BhY2U6IG5vd3JhcDsgem9vbSA6MTsgaGVpZ2h0OjE3cHg7fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1yZXNpemUge2hlaWdodDoyMHB4ICFpbXBvcnRhbnQ7cG9zaXRpb246IHJlbGF0aXZlOyBjdXJzb3IgOmUtcmVzaXplO2Rpc3BsYXk6IGlubGluZTtvdmVyZmxvdzogaGlkZGVuO31cXHJcXG4udWktanFncmlkIC51aS1ncmlkLWljby1zb3J0IHtvdmVyZmxvdzpoaWRkZW47cG9zaXRpb246YWJzb2x1dGU7ZGlzcGxheTppbmxpbmU7IGN1cnNvcjogcG9pbnRlciAhaW1wb3J0YW50O31cXHJcXG4udWktanFncmlkIC51aS1pY29uLWFzYyB7bWFyZ2luLXRvcDotM3B4OyBoZWlnaHQ6MTJweDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktaWNvbi1kZXNjIHttYXJnaW4tdG9wOjNweDtoZWlnaHQ6MTJweDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktaS1hc2Mge21hcmdpbi10b3A6MDtoZWlnaHQ6MTZweDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktaS1kZXNjIHttYXJnaW4tdG9wOjA7bWFyZ2luLWxlZnQ6MTNweDtoZWlnaHQ6MTZweDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXNvcnRhYmxlIHtjdXJzb3I6cG9pbnRlcjt9XFxyXFxuLnVpLWpxZ3JpZCB0ci51aS1zZWFyY2gtdG9vbGJhciB0aCB7IGJvcmRlci10b3Atd2lkdGg6IDFweCAhaW1wb3J0YW50OyBib3JkZXItdG9wLWNvbG9yOiBpbmhlcml0ICFpbXBvcnRhbnQ7IGJvcmRlci10b3Atc3R5bGU6IHJpZGdlICFpbXBvcnRhbnQgfVxcclxcbnRyLnVpLXNlYXJjaC10b29sYmFyIGlucHV0IHttYXJnaW46IDFweCAwIDAgMH1cXHJcXG50ci51aS1zZWFyY2gtdG9vbGJhciBzZWxlY3Qge21hcmdpbjogMXB4IDAgMCAwfVxcclxcbi8qIGJvZHkgKi8gXFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLWJkaXYge3Bvc2l0aW9uOiByZWxhdGl2ZTsgbWFyZ2luOiAwOyBwYWRkaW5nOjA7IG92ZXJmbG93OiBhdXRvOyB0ZXh0LWFsaWduOmxlZnQ7fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1idGFibGUge3RhYmxlLWxheW91dDpmaXhlZDsgbWFyZ2luOjA7IG91dGxpbmUtc3R5bGU6IG5vbmU7IH1cXHJcXG4udWktanFncmlkIHRyLmpxZ3JvdyB7IG91dGxpbmUtc3R5bGU6IG5vbmU7IH1cXHJcXG4udWktanFncmlkIHRyLmpxZ3JvdXAgeyBvdXRsaW5lLXN0eWxlOiBub25lOyB9XFxyXFxuLnVpLWpxZ3JpZCB0ci5qcWdyb3cgdGQge2ZvbnQtd2VpZ2h0OiBub3JtYWw7IG92ZXJmbG93OiBoaWRkZW47IHdoaXRlLXNwYWNlOiBwcmU7IGhlaWdodDogMjJweDtwYWRkaW5nOiAwIDJweCAwIDJweDtib3JkZXItYm90dG9tLXdpZHRoOiAxcHg7IGJvcmRlci1ib3R0b20tY29sb3I6IGluaGVyaXQ7IGJvcmRlci1ib3R0b20tc3R5bGU6IHNvbGlkO31cXHJcXG4udWktanFncmlkIHRyLmpxZ2ZpcnN0cm93IHRkIHtwYWRkaW5nOiAwIDJweCAwIDJweDtib3JkZXItcmlnaHQtd2lkdGg6IDFweDsgYm9yZGVyLXJpZ2h0LXN0eWxlOiBzb2xpZDt9XFxyXFxuLnVpLWpxZ3JpZCB0ci5qcWdyb3VwIHRkIHtmb250LXdlaWdodDogbm9ybWFsOyBvdmVyZmxvdzogaGlkZGVuOyB3aGl0ZS1zcGFjZTogcHJlOyBoZWlnaHQ6IDIycHg7cGFkZGluZzogMCAycHggMCAycHg7Ym9yZGVyLWJvdHRvbS13aWR0aDogMXB4OyBib3JkZXItYm90dG9tLWNvbG9yOiBpbmhlcml0OyBib3JkZXItYm90dG9tLXN0eWxlOiBzb2xpZDt9XFxyXFxuLnVpLWpxZ3JpZCB0ci5qcWZvb3QgdGQge2ZvbnQtd2VpZ2h0OiBib2xkOyBvdmVyZmxvdzogaGlkZGVuOyB3aGl0ZS1zcGFjZTogcHJlOyBoZWlnaHQ6IDIycHg7cGFkZGluZzogMCAycHggMCAycHg7Ym9yZGVyLWJvdHRvbS13aWR0aDogMXB4OyBib3JkZXItYm90dG9tLWNvbG9yOiBpbmhlcml0OyBib3JkZXItYm90dG9tLXN0eWxlOiBzb2xpZDt9XFxyXFxuLnVpLWpxZ3JpZCB0ci51aS1yb3ctbHRyIHRkIHt0ZXh0LWFsaWduOmxlZnQ7Ym9yZGVyLXJpZ2h0LXdpZHRoOiAxcHg7IGJvcmRlci1yaWdodC1jb2xvcjogaW5oZXJpdDsgYm9yZGVyLXJpZ2h0LXN0eWxlOiBzb2xpZDt9XFxyXFxuLnVpLWpxZ3JpZCB0ci51aS1yb3ctcnRsIHRkIHt0ZXh0LWFsaWduOnJpZ2h0O2JvcmRlci1sZWZ0LXdpZHRoOiAxcHg7IGJvcmRlci1sZWZ0LWNvbG9yOiBpbmhlcml0OyBib3JkZXItbGVmdC1zdHlsZTogc29saWQ7fVxcclxcbi51aS1qcWdyaWQgdGQuanFncmlkLXJvd251bSB7IHBhZGRpbmc6IDAgMnB4IDAgMnB4OyBtYXJnaW46IDA7IGJvcmRlcjogMCBub25lO31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtcmVzaXplLW1hcmsgeyB3aWR0aDoycHg7IGxlZnQ6MDsgYmFja2dyb3VuZC1jb2xvcjojNzc3OyBjdXJzb3I6IGUtcmVzaXplOyBjdXJzb3I6IGNvbC1yZXNpemU7IHBvc2l0aW9uOmFic29sdXRlOyB0b3A6MDsgaGVpZ2h0OjEwMHB4OyBvdmVyZmxvdzpoaWRkZW47IGRpc3BsYXk6bm9uZTsgYm9yZGVyOjAgbm9uZTsgei1pbmRleDogOTk5OTk7fVxcclxcbi8qIGZvb3RlciAqL1xcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1zZGl2IHtwb3NpdGlvbjogcmVsYXRpdmU7IG1hcmdpbjogMDtwYWRkaW5nOiAwOyBvdmVyZmxvdzogaGlkZGVuOyBib3JkZXItbGVmdDogMCBub25lICFpbXBvcnRhbnQ7IGJvcmRlci10b3AgOiAwIG5vbmUgIWltcG9ydGFudDsgYm9yZGVyLXJpZ2h0IDogMCBub25lICFpbXBvcnRhbnQ7fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1mdGFibGUge3RhYmxlLWxheW91dDpmaXhlZDsgbWFyZ2luLWJvdHRvbTowO31cXHJcXG4udWktanFncmlkIHRyLmZvb3Ryb3cgdGQge2ZvbnQtd2VpZ2h0OiBib2xkOyBvdmVyZmxvdzogaGlkZGVuOyB3aGl0ZS1zcGFjZTpub3dyYXA7IGhlaWdodDogMjFweDtwYWRkaW5nOiAwIDJweCAwIDJweDtib3JkZXItdG9wLXdpZHRoOiAxcHg7IGJvcmRlci10b3AtY29sb3I6IGluaGVyaXQ7IGJvcmRlci10b3Atc3R5bGU6IHNvbGlkO31cXHJcXG4udWktanFncmlkIHRyLmZvb3Ryb3ctbHRyIHRkIHt0ZXh0LWFsaWduOmxlZnQ7Ym9yZGVyLXJpZ2h0LXdpZHRoOiAxcHg7IGJvcmRlci1yaWdodC1jb2xvcjogaW5oZXJpdDsgYm9yZGVyLXJpZ2h0LXN0eWxlOiBzb2xpZDt9XFxyXFxuLnVpLWpxZ3JpZCB0ci5mb290cm93LXJ0bCB0ZCB7dGV4dC1hbGlnbjpyaWdodDtib3JkZXItbGVmdC13aWR0aDogMXB4OyBib3JkZXItbGVmdC1jb2xvcjogaW5oZXJpdDsgYm9yZGVyLWxlZnQtc3R5bGU6IHNvbGlkO31cXHJcXG4vKiBQYWdlciovXFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXBhZ2VyIHsgYm9yZGVyLWxlZnQ6IDAgbm9uZSAhaW1wb3J0YW50O2JvcmRlci1yaWdodDogMCBub25lICFpbXBvcnRhbnQ7IGJvcmRlci1ib3R0b206IDAgbm9uZSAhaW1wb3J0YW50OyBtYXJnaW46IDAgIWltcG9ydGFudDsgcGFkZGluZzogMCAhaW1wb3J0YW50OyBwb3NpdGlvbjogcmVsYXRpdmU7IGhlaWdodDogMjVweDt3aGl0ZS1zcGFjZTogbm93cmFwO292ZXJmbG93OiBoaWRkZW47Zm9udC1zaXplOjExcHg7fVxcclxcbi51aS1qcWdyaWQgLnVpLXBhZ2VyLWNvbnRyb2wge3Bvc2l0aW9uOiByZWxhdGl2ZTt9XFxyXFxuLnVpLWpxZ3JpZCAudWktcGctdGFibGUge3Bvc2l0aW9uOiByZWxhdGl2ZTsgcGFkZGluZy1ib3R0b206MnB4OyB3aWR0aDphdXRvOyBtYXJnaW46IDA7fVxcclxcbi51aS1qcWdyaWQgLnVpLXBnLXRhYmxlIHRkIHtmb250LXdlaWdodDpub3JtYWw7IHZlcnRpY2FsLWFsaWduOm1pZGRsZTsgcGFkZGluZzoxcHg7fVxcclxcbi51aS1qcWdyaWQgLnVpLXBnLWJ1dHRvbiAgeyBoZWlnaHQ6MTlweCAhaW1wb3J0YW50O31cXHJcXG4udWktanFncmlkIC51aS1wZy1idXR0b24gc3BhbiB7IGRpc3BsYXk6IGJsb2NrOyBtYXJnaW46IDFweDsgZmxvYXQ6bGVmdDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktcGctYnV0dG9uOmhvdmVyIHsgcGFkZGluZzogMDsgfVxcclxcbi51aS1qcWdyaWQgLnVpLXN0YXRlLWRpc2FibGVkOmhvdmVyIHtwYWRkaW5nOjFweDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktcGctaW5wdXQgeyBoZWlnaHQ6MTNweDtmb250LXNpemU6LjhlbTsgbWFyZ2luOiAwO31cXHJcXG4udWktanFncmlkIC51aS1wZy1zZWxib3gge2ZvbnQtc2l6ZTouOGVtOyBsaW5lLWhlaWdodDoxOHB4OyBkaXNwbGF5OmJsb2NrOyBoZWlnaHQ6MThweDsgbWFyZ2luOiAwO31cXHJcXG4udWktanFncmlkIC51aS1zZXBhcmF0b3Ige2hlaWdodDogMThweDsgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCAjY2NjIDsgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQgI2NjYyA7IG1hcmdpbjogMXB4OyBmbG9hdDogcmlnaHQ7fVxcclxcbi51aS1qcWdyaWQgLnVpLXBhZ2luZy1pbmZvIHtmb250LXdlaWdodDogbm9ybWFsO2hlaWdodDoxOXB4OyBtYXJnaW4tdG9wOjNweDttYXJnaW4tcmlnaHQ6NHB4O31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtcGFnZXIgLnVpLXBnLWRpdiB7cGFkZGluZzoxcHggMDtmbG9hdDpsZWZ0O3Bvc2l0aW9uOnJlbGF0aXZlO31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtcGFnZXIgLnVpLXBnLWJ1dHRvbiB7IGN1cnNvcjpwb2ludGVyOyB9XFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXBhZ2VyIC51aS1wZy1kaXYgIHNwYW4udWktaWNvbiB7ZmxvYXQ6bGVmdDttYXJnaW46MCAycHg7fVxcclxcbi51aS1qcWdyaWQgdGQgaW5wdXQsIC51aS1qcWdyaWQgdGQgc2VsZWN0IC51aS1qcWdyaWQgdGQgdGV4dGFyZWEgeyBtYXJnaW46IDA7fVxcclxcbi51aS1qcWdyaWQgdGQgdGV4dGFyZWEge3dpZHRoOmF1dG87aGVpZ2h0OmF1dG87fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC10b3BwYWdlciB7Ym9yZGVyLWxlZnQ6IDAgbm9uZSAhaW1wb3J0YW50O2JvcmRlci1yaWdodDogMCBub25lICFpbXBvcnRhbnQ7IGJvcmRlci10b3A6IDAgbm9uZSAhaW1wb3J0YW50OyBtYXJnaW46IDAgIWltcG9ydGFudDsgcGFkZGluZzogMCAhaW1wb3J0YW50OyBwb3NpdGlvbjogcmVsYXRpdmU7IGhlaWdodDogMjVweCAhaW1wb3J0YW50O3doaXRlLXNwYWNlOiBub3dyYXA7b3ZlcmZsb3c6IGhpZGRlbjt9XFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXRvcHBhZ2VyIC51aS1wZy1kaXYge3BhZGRpbmc6MXB4IDA7ZmxvYXQ6bGVmdDtwb3NpdGlvbjpyZWxhdGl2ZTt9XFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXRvcHBhZ2VyIC51aS1wZy1idXR0b24geyBjdXJzb3I6cG9pbnRlcjsgfVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC10b3BwYWdlciAudWktcGctZGl2ICBzcGFuLnVpLWljb24ge2Zsb2F0OmxlZnQ7bWFyZ2luOjAgMnB4O31cXHJcXG4vKnN1YmdyaWQqL1xcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1idGFibGUgLnVpLXNnY29sbGFwc2VkIHNwYW4ge2Rpc3BsYXk6IGJsb2NrO31cXHJcXG4udWktanFncmlkIC51aS1zdWJncmlkIHttYXJnaW46MDtwYWRkaW5nOjA7IHdpZHRoOjEwMCU7fVxcclxcbi51aS1qcWdyaWQgLnVpLXN1YmdyaWQgdGFibGUge3RhYmxlLWxheW91dDogZml4ZWQ7fVxcclxcbi51aS1qcWdyaWQgLnVpLXN1YmdyaWQgdHIudWktc3VidGJsY2VsbCB0ZCB7aGVpZ2h0OjE4cHg7Ym9yZGVyLXJpZ2h0LXdpZHRoOiAxcHg7IGJvcmRlci1yaWdodC1jb2xvcjogaW5oZXJpdDsgYm9yZGVyLXJpZ2h0LXN0eWxlOiBzb2xpZDtib3JkZXItYm90dG9tLXdpZHRoOiAxcHg7IGJvcmRlci1ib3R0b20tY29sb3I6IGluaGVyaXQ7IGJvcmRlci1ib3R0b20tc3R5bGU6IHNvbGlkO31cXHJcXG4udWktanFncmlkIC51aS1zdWJncmlkIHRkLnN1YmdyaWQtZGF0YSB7Ym9yZGVyLXRvcDogIDAgbm9uZSAhaW1wb3J0YW50O31cXHJcXG4udWktanFncmlkIC51aS1zdWJncmlkIHRkLnN1YmdyaWQtY2VsbCB7Ym9yZGVyLXdpZHRoOiAwIDAgMXB4IDA7fVxcclxcbi51aS1qcWdyaWQgLnVpLXRoLXN1YmdyaWQge2hlaWdodDoyMHB4O31cXHJcXG4vKiBsb2FkaW5nICovXFxyXFxuLnVpLWpxZ3JpZCAubG9hZGluZyB7cG9zaXRpb246IGFic29sdXRlOyB0b3A6IDQ1JTtsZWZ0OiA0NSU7d2lkdGg6IGF1dG87ei1pbmRleDoxMDE7cGFkZGluZzogNnB4OyBtYXJnaW46IDVweDt0ZXh0LWFsaWduOiBjZW50ZXI7Zm9udC13ZWlnaHQ6IGJvbGQ7ZGlzcGxheTogbm9uZTtib3JkZXItd2lkdGg6IDJweCAhaW1wb3J0YW50OyBmb250LXNpemU6MTFweDt9XFxyXFxuLnVpLWpxZ3JpZCAuanFncmlkLW92ZXJsYXkge2Rpc3BsYXk6bm9uZTt6LWluZGV4OjEwMDt9XFxyXFxuLyogSUUgKiBodG1sIC5qcWdyaWQtb3ZlcmxheSB7d2lkdGg6IGV4cHJlc3Npb24odGhpcy5wYXJlbnROb2RlLm9mZnNldFdpZHRoKydweCcpO2hlaWdodDogZXhwcmVzc2lvbih0aGlzLnBhcmVudE5vZGUub2Zmc2V0SGVpZ2h0KydweCcpO30gKi9cXHJcXG4qIC5qcWdyaWQtb3ZlcmxheSBpZnJhbWUge3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDt6LWluZGV4Oi0xO31cXHJcXG4vKiBJRSB3aWR0aDogZXhwcmVzc2lvbih0aGlzLnBhcmVudE5vZGUub2Zmc2V0V2lkdGgrJ3B4Jyk7aGVpZ2h0OiBleHByZXNzaW9uKHRoaXMucGFyZW50Tm9kZS5vZmZzZXRIZWlnaHQrJ3B4Jyk7fSovXFxyXFxuLyogZW5kIGxvYWRpbmcgZGl2ICovXFxyXFxuLyogdG9vbGJhciAqL1xcclxcbi51aS1qcWdyaWQgLnVpLXVzZXJkYXRhIHtib3JkZXItbGVmdDogMCBub25lOyAgICBib3JkZXItcmlnaHQ6IDAgbm9uZTtcXHRoZWlnaHQgOiAyMXB4O292ZXJmbG93OiBoaWRkZW47XFx0fVxcclxcbi8qTW9kYWwgV2luZG93ICovXFxyXFxuLnVpLWpxZGlhbG9nIHsgZGlzcGxheTogbm9uZTsgd2lkdGg6IDMwMHB4OyBwb3NpdGlvbjogYWJzb2x1dGU7IHBhZGRpbmc6IC4yZW07IGZvbnQtc2l6ZToxMXB4OyBvdmVyZmxvdzp2aXNpYmxlO31cXHJcXG4udWktanFkaWFsb2cgLnVpLWpxZGlhbG9nLXRpdGxlYmFyIHsgcGFkZGluZzogLjNlbSAuMmVtOyBwb3NpdGlvbjogcmVsYXRpdmU7ICB9XFxyXFxuLnVpLWpxZGlhbG9nIC51aS1qcWRpYWxvZy10aXRsZSB7IG1hcmdpbjogLjFlbSAwIC4yZW07IH0gXFxyXFxuLnVpLWpxZGlhbG9nIC51aS1qcWRpYWxvZy10aXRsZWJhci1jbG9zZSB7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgIHRvcDogNTAlOyB3aWR0aDogMTlweDsgbWFyZ2luOiAtMTBweCAwIDAgMDsgcGFkZGluZzogMXB4OyBoZWlnaHQ6IDE4cHg7IGN1cnNvcjpwb2ludGVyO31cXHJcXG5cXHJcXG4udWktanFkaWFsb2cgLnVpLWpxZGlhbG9nLXRpdGxlYmFyLWNsb3NlIHNwYW4geyBkaXNwbGF5OiBibG9jazsgbWFyZ2luOiAxcHg7IH1cXHJcXG4udWktanFkaWFsb2cgLnVpLWpxZGlhbG9nLXRpdGxlYmFyLWNsb3NlOmhvdmVyLCAudWktanFkaWFsb2cgLnVpLWpxZGlhbG9nLXRpdGxlYmFyLWNsb3NlOmZvY3VzIHsgcGFkZGluZzogMDsgfVxcclxcbi51aS1qcWRpYWxvZy1jb250ZW50LCAudWktanFkaWFsb2cgLnVpLWpxZGlhbG9nLWNvbnRlbnQgeyBib3JkZXI6IDA7IHBhZGRpbmc6IC4zZW0gLjJlbTsgYmFja2dyb3VuZDogbm9uZTsgaGVpZ2h0OmF1dG87fVxcclxcbi51aS1qcWRpYWxvZyAudWktanFjb25maXJtIHtwYWRkaW5nOiAuNGVtIDFlbTsgYm9yZGVyLXdpZHRoOjNweDtwb3NpdGlvbjphYnNvbHV0ZTtib3R0b206MTBweDtyaWdodDoxMHB4O292ZXJmbG93OnZpc2libGU7ZGlzcGxheTpub25lO2hlaWdodDo4MHB4O3dpZHRoOjIyMHB4O3RleHQtYWxpZ246Y2VudGVyO31cXHJcXG4udWktanFkaWFsb2c+LnVpLXJlc2l6YWJsZS1zZSB7IGJvdHRvbTogLTNweDsgcmlnaHQ6IC0zcHh9XFxyXFxuLnVpLWpxZ3JpZD4udWktcmVzaXphYmxlLXNlIHsgYm90dG9tOiAtM3B4OyByaWdodDogLTNweCB9XFxyXFxuLyogZW5kIE1vZGFsIHdpbmRvdyovXFxyXFxuLyogRm9ybSBlZGl0ICovXFxyXFxuLnVpLWpxZGlhbG9nLWNvbnRlbnQgLkZvcm1HcmlkIHttYXJnaW46IDA7fVxcclxcbi51aS1qcWRpYWxvZy1jb250ZW50IC5FZGl0VGFibGUgeyB3aWR0aDogMTAwJTsgbWFyZ2luLWJvdHRvbTowO31cXHJcXG4udWktanFkaWFsb2ctY29udGVudCAuRGVsVGFibGUgeyB3aWR0aDogMTAwJTsgbWFyZ2luLWJvdHRvbTowO31cXHJcXG4uRWRpdFRhYmxlIHRkIGlucHV0LCAuRWRpdFRhYmxlIHRkIHNlbGVjdCwgLkVkaXRUYWJsZSB0ZCB0ZXh0YXJlYSB7bWFyZ2luOiAwO31cXHJcXG4uRWRpdFRhYmxlIHRkIHRleHRhcmVhIHsgd2lkdGg6YXV0bzsgaGVpZ2h0OmF1dG87fVxcclxcbi51aS1qcWRpYWxvZy1jb250ZW50IHRkLkVkaXRCdXR0b24ge3RleHQtYWxpZ246IHJpZ2h0O2JvcmRlci10b3A6IDAgbm9uZTtib3JkZXItbGVmdDogMCBub25lO2JvcmRlci1yaWdodDogMCBub25lOyBwYWRkaW5nLWJvdHRvbTo1cHg7IHBhZGRpbmctdG9wOjVweDt9XFxyXFxuLnVpLWpxZGlhbG9nLWNvbnRlbnQgdGQubmF2QnV0dG9uIHt0ZXh0LWFsaWduOiBjZW50ZXI7IGJvcmRlci1sZWZ0OiAwIG5vbmU7Ym9yZGVyLXRvcDogMCBub25lO2JvcmRlci1yaWdodDogMCBub25lOyBwYWRkaW5nLWJvdHRvbTo1cHg7IHBhZGRpbmctdG9wOjVweDt9XFxyXFxuLnVpLWpxZGlhbG9nLWNvbnRlbnQgaW5wdXQuRm9ybUVsZW1lbnQge3BhZGRpbmc6LjNlbX1cXHJcXG4udWktanFkaWFsb2ctY29udGVudCBzZWxlY3QuRm9ybUVsZW1lbnQge3BhZGRpbmc6LjNlbX1cXHJcXG4udWktanFkaWFsb2ctY29udGVudCAuZGF0YS1saW5lIHtwYWRkaW5nLXRvcDouMWVtO2JvcmRlcjogMCBub25lO31cXHJcXG5cXHJcXG4udWktanFkaWFsb2ctY29udGVudCAuQ2FwdGlvblREIHt2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO2JvcmRlcjogMCBub25lOyBwYWRkaW5nOiAycHg7d2hpdGUtc3BhY2U6IG5vd3JhcDt9XFxyXFxuLnVpLWpxZGlhbG9nLWNvbnRlbnQgLkRhdGFURCB7cGFkZGluZzogMnB4OyBib3JkZXI6IDAgbm9uZTsgdmVydGljYWwtYWxpZ246IHRvcDt9XFxyXFxuLnVpLWpxZGlhbG9nLWNvbnRlbnQgLmZvcm0tdmlldy1kYXRhIHt3aGl0ZS1zcGFjZTpwcmV9XFxyXFxuLmZtLWJ1dHRvbiB7IGRpc3BsYXk6IGlubGluZS1ibG9jazsgbWFyZ2luOjAgNHB4IDAgMDsgcGFkZGluZzogLjRlbSAuNWVtOyB0ZXh0LWRlY29yYXRpb246bm9uZSAhaW1wb3J0YW50OyBjdXJzb3I6cG9pbnRlcjsgcG9zaXRpb246IHJlbGF0aXZlOyB0ZXh0LWFsaWduOiBjZW50ZXI7IHpvb206IDE7IH1cXHJcXG4uZm0tYnV0dG9uLWljb24tbGVmdCB7IHBhZGRpbmctbGVmdDogMS45ZW07IH1cXHJcXG4uZm0tYnV0dG9uLWljb24tcmlnaHQgeyBwYWRkaW5nLXJpZ2h0OiAxLjllbTsgfVxcclxcbi5mbS1idXR0b24taWNvbi1sZWZ0IC51aS1pY29uIHsgcmlnaHQ6IGF1dG87IGxlZnQ6IC4yZW07IG1hcmdpbi1sZWZ0OiAwOyBwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogNTAlOyBtYXJnaW4tdG9wOiAtOHB4OyB9XFxyXFxuLmZtLWJ1dHRvbi1pY29uLXJpZ2h0IC51aS1pY29uIHsgbGVmdDogYXV0bzsgcmlnaHQ6IC4yZW07IG1hcmdpbi1sZWZ0OiAwOyBwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogNTAlOyBtYXJnaW4tdG9wOiAtOHB4O31cXHJcXG4jbkRhdGEsICNwRGF0YSB7IGZsb2F0OiBsZWZ0OyBtYXJnaW46M3B4O3BhZGRpbmc6IDA7IHdpZHRoOiAxNXB4OyB9XFxyXFxuLyogRW5kIEVvcm0gZWRpdCAqL1xcclxcbi8qLnVpLWpxZ3JpZCAuZWRpdC1jZWxsIHt9Ki9cXHJcXG4udWktanFncmlkIC5zZWxlY3RlZC1yb3csIGRpdi51aS1qcWdyaWQgLnNlbGVjdGVkLXJvdyB0ZCB7Zm9udC1zdHlsZSA6IG5vcm1hbDtib3JkZXItbGVmdDogMCBub25lO31cXHJcXG4vKiBpbmxpbmUgZWRpdCBhY3Rpb25zIGJ1dHRvbiovXFxyXFxuLnVpLWlubGluZS1kZWwudWktc3RhdGUtaG92ZXIgc3BhbiwgLnVpLWlubGluZS1lZGl0LnVpLXN0YXRlLWhvdmVyIHNwYW4sXFxyXFxuLnVpLWlubGluZS1zYXZlLnVpLXN0YXRlLWhvdmVyIHNwYW4sIC51aS1pbmxpbmUtY2FuY2VsLnVpLXN0YXRlLWhvdmVyIHNwYW4ge1xcclxcbiAgICBtYXJnaW46IC0xcHg7XFxyXFxufVxcclxcbi8qIFRyZWUgR3JpZCAqL1xcclxcbi51aS1qcWdyaWQgLnRyZWUtd3JhcCB7ZmxvYXQ6IGxlZnQ7IHBvc2l0aW9uOiByZWxhdGl2ZTtoZWlnaHQ6IDE4cHg7d2hpdGUtc3BhY2U6IG5vd3JhcDtvdmVyZmxvdzogaGlkZGVuO31cXHJcXG4udWktanFncmlkIC50cmVlLW1pbnVzIHtwb3NpdGlvbjogYWJzb2x1dGU7IGhlaWdodDogMThweDsgd2lkdGg6IDE4cHg7IG92ZXJmbG93OiBoaWRkZW47fVxcclxcbi51aS1qcWdyaWQgLnRyZWUtcGx1cyB7cG9zaXRpb246IGFic29sdXRlO1xcdGhlaWdodDogMThweDsgd2lkdGg6IDE4cHg7XFx0b3ZlcmZsb3c6IGhpZGRlbjt9XFxyXFxuLnVpLWpxZ3JpZCAudHJlZS1sZWFmIHtwb3NpdGlvbjogYWJzb2x1dGU7XFx0aGVpZ2h0OiAxOHB4OyB3aWR0aDogMThweDtvdmVyZmxvdzogaGlkZGVuO31cXHJcXG4udWktanFncmlkIC50cmVlY2xpY2sge2N1cnNvcjogcG9pbnRlcjt9XFxyXFxuLyogbW9kYSBkaWFsb2cgKi9cXHJcXG4qIGlmcmFtZS5qcW0ge3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDt6LWluZGV4Oi0xO31cXHJcXG4vKlxcdCB3aWR0aDogZXhwcmVzc2lvbih0aGlzLnBhcmVudE5vZGUub2Zmc2V0V2lkdGgrJ3B4Jyk7aGVpZ2h0OiBleHByZXNzaW9uKHRoaXMucGFyZW50Tm9kZS5vZmZzZXRIZWlnaHQrJ3B4Jyk7fSovXFxyXFxuLnVpLWpxZ3JpZC1kbmQgdHIgdGQge2JvcmRlci1yaWdodC13aWR0aDogMXB4OyBib3JkZXItcmlnaHQtY29sb3I6IGluaGVyaXQ7IGJvcmRlci1yaWdodC1zdHlsZTogc29saWQ7IGhlaWdodDoyMHB4fVxcclxcbi8qIFJUTCBTdXBwb3J0ICovXFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLWNhcHRpb24tcnRsIHt0ZXh0LWFsaWduOiByaWdodDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLWhib3gtcnRsIHtmbG9hdDogcmlnaHQ7IHBhZGRpbmctbGVmdDogMjBweDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXJlc2l6ZS1sdHIge2Zsb2F0OiByaWdodDttYXJnaW46IC0ycHggLTJweCAtMnB4IDA7fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1yZXNpemUtcnRsIHtmbG9hdDogbGVmdDttYXJnaW46IC0ycHggMCAtMXB4IC0zcHg7fVxcclxcbi51aS1qcWdyaWQgLnVpLXNvcnQtcnRsIHtsZWZ0OjA7fVxcclxcbi51aS1qcWdyaWQgLnRyZWUtd3JhcC1sdHIge2Zsb2F0OiBsZWZ0O31cXHJcXG4udWktanFncmlkIC50cmVlLXdyYXAtcnRsIHtmbG9hdDogcmlnaHQ7fVxcclxcbi51aS1qcWdyaWQgLnVpLWVsbGlwc2lzIHstbW96LXRleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7dGV4dC1vdmVyZmxvdzplbGxpcHNpczt9XFxyXFxuXFxyXFxuLyogVG9vbGJhciBTZWFyY2ggTWVudSAqL1xcclxcbi51aS1zZWFyY2gtbWVudSB7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgcGFkZGluZzogMnB4IDVweDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktc2VhcmNoLXRhYmxlIHsgcGFkZGluZzogMDsgYm9yZGVyOiAwIG5vbmU7IGhlaWdodDoyMHB4OyB3aWR0aDoxMDAlO31cXHJcXG4udWktanFncmlkIC51aS1zZWFyY2gtdGFibGUgLnVpLXNlYXJjaC1vcGVyIHsgd2lkdGg6MjBweDsgfVxcclxcbmEuZy1tZW51LWl0ZW0sIGEuc29wdGNsYXNzLCBhLmNsZWFyc2VhcmNoY2xhc3MgeyBjdXJzb3I6IHBvaW50ZXI7IH1cXHJcXG4udWktanFncmlkIC51aS1zZWFyY2gtdGFibGUgLnVpLXNlYXJjaC1pbnB1dD5pbnB1dCxcXHJcXG4udWktanFncmlkIC51aS1zZWFyY2gtdGFibGUgLnVpLXNlYXJjaC1pbnB1dD5zZWxlY3RcXHJcXG57XFxyXFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcclxcbiAgICAtbW96LWJveC1zaXppbmc6IGJvcmRlci1ib3g7XFxyXFxuICAgIC13ZWJraXQtYm94LXNpemluZzogYm9yZGVyLWJveDtcXHJcXG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcXHJcXG59IFxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC12aWV3IGlucHV0LFxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC12aWV3IHNlbGVjdCxcXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtdmlldyB0ZXh0YXJlYSxcXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtdmlldyBidXR0b24ge1xcclxcbiAgICBmb250LXNpemU6IDExcHhcXHJcXG59XFxyXFxuXCIsIFwiXCIse1widmVyc2lvblwiOjMsXCJzb3VyY2VzXCI6W1wid2VicGFjazovL25vZGVfbW9kdWxlcy9qcWdyaWQvY3NzL3VpLmpxZ3JpZC5jc3NcIl0sXCJuYW1lc1wiOltdLFwibWFwcGluZ3NcIjpcIkFBQUEsT0FBTztBQUNQLFlBQVksa0JBQWtCLENBQUM7QUFDL0IsNEJBQTRCLGtCQUFrQixDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLGNBQWMsQ0FBQztBQUMxRixXQUFXO0FBQ1gsZ0NBQWdDLDRCQUE0QixFQUFFLGtCQUFrQixFQUFFLGVBQWUsRUFBRSxtQkFBbUIsQ0FBQyxvQkFBb0IsRUFBRSxrQkFBa0IsQ0FBQztBQUNoSywrQkFBK0IsZ0JBQWdCLENBQUM7QUFDaEQsOEJBQThCLG1CQUFtQixFQUFFO0FBQ25ELHVDQUF1QyxrQkFBa0IsQ0FBQyxRQUFRLEVBQUUsV0FBVyxFQUFFLG1CQUFtQixFQUFFLFlBQVksRUFBRSxXQUFXLEVBQUUsY0FBYyxDQUFDO0FBQ2hKLDRDQUE0QyxjQUFjLEVBQUUsV0FBVyxFQUFFO0FBQ3pFLDZDQUE2QyxVQUFVLEVBQUU7QUFDekQs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WUFBWSxFQUFFLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQztBQUN0Rix1QkFBdUIsZUFBZSxDQUFDO0FBQ3ZDLGdCQUFnQjtBQUNoQixjQUFjLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDO0FBQ3hELGdIQUFnSDtBQUNoSCxzQkFBc0IsdUJBQXVCLEVBQUUsMkJBQTJCLEVBQUUseUJBQXlCLEVBQUUsV0FBVztBQUNsSCxnQkFBZ0I7QUFDaEIsbUNBQW1DLGlCQUFpQixDQUFDO0FBQ3JELGdDQUFnQyxZQUFZLEVBQUUsa0JBQWtCLENBQUM7QUFDakUsa0NBQWtDLFlBQVksQ0FBQyx3QkFBd0IsQ0FBQztBQUN4RSxrQ0FBa0MsV0FBVyxDQUFDLHdCQUF3QixDQUFDO0FBQ3ZFLHlCQUF5QixNQUFNLENBQUM7QUFDaEMsMkJBQTJCLFdBQVcsQ0FBQztBQUN2QywyQkFBMkIsWUFBWSxDQUFDO0FBQ3hDLHlCQUF5QiwyQkFBMkIsQ0FBQyxzQkFBc0IsQ0FBQzs7QUFFNUUsd0JBQXdCO0FBQ3hCLGtCQUFrQixrQkFBa0IsRUFBRSxnQkFBZ0IsQ0FBQztBQUN2RCw4QkFBOEIsVUFBVSxFQUFFLGNBQWMsRUFBRSxXQUFXLEVBQUUsVUFBVSxDQUFDO0FBQ2xGLDhDQUE4QyxVQUFVLEVBQUU7QUFDMUQsaURBQWlELGVBQWUsRUFBRTtBQUNsRTs7O0lBR0ksY0FBYztJQUNkLDJCQUEyQjtJQUMzQiw4QkFBOEI7SUFDOUIsc0JBQXNCO0FBQzFCO0FBQ0E7Ozs7SUFJSTtBQUNKXCIsXCJzb3VyY2VzQ29udGVudFwiOltcIi8qR3JpZCovXFxyXFxuLnVpLWpxZ3JpZCB7cG9zaXRpb246IHJlbGF0aXZlO31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtdmlldyB7cG9zaXRpb246IHJlbGF0aXZlO2xlZnQ6MDsgdG9wOiAwOyBwYWRkaW5nOiAwOyBmb250LXNpemU6MTFweDt9XFxyXFxuLyogY2FwdGlvbiovXFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXRpdGxlYmFyIHtwYWRkaW5nOiAuM2VtIC4yZW0gLjJlbSAuM2VtOyBwb3NpdGlvbjogcmVsYXRpdmU7IGZvbnQtc2l6ZTogMTJweDsgYm9yZGVyLWxlZnQ6IDAgbm9uZTtib3JkZXItcmlnaHQ6IDAgbm9uZTsgYm9yZGVyLXRvcDogMCBub25lO31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtY2FwdGlvbiB7dGV4dC1hbGlnbjogbGVmdDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXRpdGxlIHsgbWFyZ2luOiAuMWVtIDAgLjJlbTsgfVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC10aXRsZWJhci1jbG9zZSB7IHBvc2l0aW9uOiBhYnNvbHV0ZTt0b3A6IDUwJTsgd2lkdGg6IDE5cHg7IG1hcmdpbjogLTEwcHggMCAwIDA7IHBhZGRpbmc6IDFweDsgaGVpZ2h0OjE4cHg7IGN1cnNvcjpwb2ludGVyO31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtdGl0bGViYXItY2xvc2Ugc3BhbiB7IGRpc3BsYXk6IGJsb2NrOyBtYXJnaW46IDFweDsgfVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC10aXRsZWJhci1jbG9zZTpob3ZlciB7IHBhZGRpbmc6IDA7IH1cXHJcXG4vKiBoZWFkZXIqL1xcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1oZGl2IHtwb3NpdGlvbjogcmVsYXRpdmU7IG1hcmdpbjogMDtwYWRkaW5nOiAwOyBvdmVyZmxvdy14OiBoaWRkZW47IGJvcmRlci1sZWZ0OiAwIG5vbmUgIWltcG9ydGFudDsgYm9yZGVyLXRvcCA6IDAgbm9uZSAhaW1wb3J0YW50OyBib3JkZXItcmlnaHQgOiAwIG5vbmUgIWltcG9ydGFudDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLWhib3gge2Zsb2F0OiBsZWZ0OyBwYWRkaW5nLXJpZ2h0OiAyMHB4O31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtaHRhYmxlIHt0YWJsZS1sYXlvdXQ6Zml4ZWQ7bWFyZ2luOjA7fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1odGFibGUgdGgge2hlaWdodDoyMnB4O3BhZGRpbmc6IDAgMnB4IDAgMnB4O31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtaHRhYmxlIHRoIGRpdiB7b3ZlcmZsb3c6IGhpZGRlbjsgcG9zaXRpb246cmVsYXRpdmU7IGhlaWdodDoxN3B4O31cXHJcXG4udWktdGgtY29sdW1uLCAudWktanFncmlkIC51aS1qcWdyaWQtaHRhYmxlIHRoLnVpLXRoLWNvbHVtbiB7b3ZlcmZsb3c6IGhpZGRlbjt3aGl0ZS1zcGFjZTogbm93cmFwO3RleHQtYWxpZ246Y2VudGVyO2JvcmRlci10b3AgOiAwIG5vbmU7Ym9yZGVyLWJvdHRvbSA6IDAgbm9uZTt9XFxyXFxuLnVpLXRoLWx0ciwgLnVpLWpxZ3JpZCAudWktanFncmlkLWh0YWJsZSB0aC51aS10aC1sdHIge2JvcmRlci1sZWZ0IDogMCBub25lO31cXHJcXG4udWktdGgtcnRsLCAudWktanFncmlkIC51aS1qcWdyaWQtaHRhYmxlIHRoLnVpLXRoLXJ0bCB7Ym9yZGVyLXJpZ2h0IDogMCBub25lO31cXHJcXG4udWktZmlyc3QtdGgtbHRyIHtib3JkZXItcmlnaHQ6IDFweCBzb2xpZDsgfVxcclxcbi51aS1maXJzdC10aC1ydGwge2JvcmRlci1sZWZ0OiAxcHggc29saWQ7IH1cXHJcXG4udWktanFncmlkIC51aS10aC1kaXYtaWUge3doaXRlLXNwYWNlOiBub3dyYXA7IHpvb20gOjE7IGhlaWdodDoxN3B4O31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtcmVzaXplIHtoZWlnaHQ6MjBweCAhaW1wb3J0YW50O3Bvc2l0aW9uOiByZWxhdGl2ZTsgY3Vyc29yIDplLXJlc2l6ZTtkaXNwbGF5OiBpbmxpbmU7b3ZlcmZsb3c6IGhpZGRlbjt9XFxyXFxuLnVpLWpxZ3JpZCAudWktZ3JpZC1pY28tc29ydCB7b3ZlcmZsb3c6aGlkZGVuO3Bvc2l0aW9uOmFic29sdXRlO2Rpc3BsYXk6aW5saW5lOyBjdXJzb3I6IHBvaW50ZXIgIWltcG9ydGFudDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktaWNvbi1hc2Mge21hcmdpbi10b3A6LTNweDsgaGVpZ2h0OjEycHg7fVxcclxcbi51aS1qcWdyaWQgLnVpLWljb24tZGVzYyB7bWFyZ2luLXRvcDozcHg7aGVpZ2h0OjEycHg7fVxcclxcbi51aS1qcWdyaWQgLnVpLWktYXNjIHttYXJnaW4tdG9wOjA7aGVpZ2h0OjE2cHg7fVxcclxcbi51aS1qcWdyaWQgLnVpLWktZGVzYyB7bWFyZ2luLXRvcDowO21hcmdpbi1sZWZ0OjEzcHg7aGVpZ2h0OjE2cHg7fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1zb3J0YWJsZSB7Y3Vyc29yOnBvaW50ZXI7fVxcclxcbi51aS1qcWdyaWQgdHIudWktc2VhcmNoLXRvb2xiYXIgdGggeyBib3JkZXItdG9wLXdpZHRoOiAxcHggIWltcG9ydGFudDsgYm9yZGVyLXRvcC1jb2xvcjogaW5oZXJpdCAhaW1wb3J0YW50OyBib3JkZXItdG9wLXN0eWxlOiByaWRnZSAhaW1wb3J0YW50IH1cXHJcXG50ci51aS1zZWFyY2gtdG9vbGJhciBpbnB1dCB7bWFyZ2luOiAxcHggMCAwIDB9XFxyXFxudHIudWktc2VhcmNoLXRvb2xiYXIgc2VsZWN0IHttYXJnaW46IDFweCAwIDAgMH1cXHJcXG4vKiBib2R5ICovIFxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1iZGl2IHtwb3NpdGlvbjogcmVsYXRpdmU7IG1hcmdpbjogMDsgcGFkZGluZzowOyBvdmVyZmxvdzogYXV0bzsgdGV4dC1hbGlnbjpsZWZ0O31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtYnRhYmxlIHt0YWJsZS1sYXlvdXQ6Zml4ZWQ7IG1hcmdpbjowOyBvdXRsaW5lLXN0eWxlOiBub25lOyB9XFxyXFxuLnVpLWpxZ3JpZCB0ci5qcWdyb3cgeyBvdXRsaW5lLXN0eWxlOiBub25lOyB9XFxyXFxuLnVpLWpxZ3JpZCB0ci5qcWdyb3VwIHsgb3V0bGluZS1zdHlsZTogbm9uZTsgfVxcclxcbi51aS1qcWdyaWQgdHIuanFncm93IHRkIHtmb250LXdlaWdodDogbm9ybWFsOyBvdmVyZmxvdzogaGlkZGVuOyB3aGl0ZS1zcGFjZTogcHJlOyBoZWlnaHQ6IDIycHg7cGFkZGluZzogMCAycHggMCAycHg7Ym9yZGVyLWJvdHRvbS13aWR0aDogMXB4OyBib3JkZXItYm90dG9tLWNvbG9yOiBpbmhlcml0OyBib3JkZXItYm90dG9tLXN0eWxlOiBzb2xpZDt9XFxyXFxuLnVpLWpxZ3JpZCB0ci5qcWdmaXJzdHJvdyB0ZCB7cGFkZGluZzogMCAycHggMCAycHg7Ym9yZGVyLXJpZ2h0LXdpZHRoOiAxcHg7IGJvcmRlci1yaWdodC1zdHlsZTogc29saWQ7fVxcclxcbi51aS1qcWdyaWQgdHIuanFncm91cCB0ZCB7Zm9udC13ZWlnaHQ6IG5vcm1hbDsgb3ZlcmZsb3c6IGhpZGRlbjsgd2hpdGUtc3BhY2U6IHByZTsgaGVpZ2h0OiAyMnB4O3BhZGRpbmc6IDAgMnB4IDAgMnB4O2JvcmRlci1ib3R0b20td2lkdGg6IDFweDsgYm9yZGVyLWJvdHRvbS1jb2xvcjogaW5oZXJpdDsgYm9yZGVyLWJvdHRvbS1zdHlsZTogc29saWQ7fVxcclxcbi51aS1qcWdyaWQgdHIuanFmb290IHRkIHtmb250LXdlaWdodDogYm9sZDsgb3ZlcmZsb3c6IGhpZGRlbjsgd2hpdGUtc3BhY2U6IHByZTsgaGVpZ2h0OiAyMnB4O3BhZGRpbmc6IDAgMnB4IDAgMnB4O2JvcmRlci1ib3R0b20td2lkdGg6IDFweDsgYm9yZGVyLWJvdHRvbS1jb2xvcjogaW5oZXJpdDsgYm9yZGVyLWJvdHRvbS1zdHlsZTogc29saWQ7fVxcclxcbi51aS1qcWdyaWQgdHIudWktcm93LWx0ciB0ZCB7dGV4dC1hbGlnbjpsZWZ0O2JvcmRlci1yaWdodC13aWR0aDogMXB4OyBib3JkZXItcmlnaHQtY29sb3I6IGluaGVyaXQ7IGJvcmRlci1yaWdodC1zdHlsZTogc29saWQ7fVxcclxcbi51aS1qcWdyaWQgdHIudWktcm93LXJ0bCB0ZCB7dGV4dC1hbGlnbjpyaWdodDtib3JkZXItbGVmdC13aWR0aDogMXB4OyBib3JkZXItbGVmdC1jb2xvcjogaW5oZXJpdDsgYm9yZGVyLWxlZnQtc3R5bGU6IHNvbGlkO31cXHJcXG4udWktanFncmlkIHRkLmpxZ3JpZC1yb3dudW0geyBwYWRkaW5nOiAwIDJweCAwIDJweDsgbWFyZ2luOiAwOyBib3JkZXI6IDAgbm9uZTt9XFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXJlc2l6ZS1tYXJrIHsgd2lkdGg6MnB4OyBsZWZ0OjA7IGJhY2tncm91bmQtY29sb3I6Izc3NzsgY3Vyc29yOiBlLXJlc2l6ZTsgY3Vyc29yOiBjb2wtcmVzaXplOyBwb3NpdGlvbjphYnNvbHV0ZTsgdG9wOjA7IGhlaWdodDoxMDBweDsgb3ZlcmZsb3c6aGlkZGVuOyBkaXNwbGF5Om5vbmU7IGJvcmRlcjowIG5vbmU7IHotaW5kZXg6IDk5OTk5O31cXHJcXG4vKiBmb290ZXIgKi9cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtc2RpdiB7cG9zaXRpb246IHJlbGF0aXZlOyBtYXJnaW46IDA7cGFkZGluZzogMDsgb3ZlcmZsb3c6IGhpZGRlbjsgYm9yZGVyLWxlZnQ6IDAgbm9uZSAhaW1wb3J0YW50OyBib3JkZXItdG9wIDogMCBub25lICFpbXBvcnRhbnQ7IGJvcmRlci1yaWdodCA6IDAgbm9uZSAhaW1wb3J0YW50O31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtZnRhYmxlIHt0YWJsZS1sYXlvdXQ6Zml4ZWQ7IG1hcmdpbi1ib3R0b206MDt9XFxyXFxuLnVpLWpxZ3JpZCB0ci5mb290cm93IHRkIHtmb250LXdlaWdodDogYm9sZDsgb3ZlcmZsb3c6IGhpZGRlbjsgd2hpdGUtc3BhY2U6bm93cmFwOyBoZWlnaHQ6IDIxcHg7cGFkZGluZzogMCAycHggMCAycHg7Ym9yZGVyLXRvcC13aWR0aDogMXB4OyBib3JkZXItdG9wLWNvbG9yOiBpbmhlcml0OyBib3JkZXItdG9wLXN0eWxlOiBzb2xpZDt9XFxyXFxuLnVpLWpxZ3JpZCB0ci5mb290cm93LWx0ciB0ZCB7dGV4dC1hbGlnbjpsZWZ0O2JvcmRlci1yaWdodC13aWR0aDogMXB4OyBib3JkZXItcmlnaHQtY29sb3I6IGluaGVyaXQ7IGJvcmRlci1yaWdodC1zdHlsZTogc29saWQ7fVxcclxcbi51aS1qcWdyaWQgdHIuZm9vdHJvdy1ydGwgdGQge3RleHQtYWxpZ246cmlnaHQ7Ym9yZGVyLWxlZnQtd2lkdGg6IDFweDsgYm9yZGVyLWxlZnQtY29sb3I6IGluaGVyaXQ7IGJvcmRlci1sZWZ0LXN0eWxlOiBzb2xpZDt9XFxyXFxuLyogUGFnZXIqL1xcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1wYWdlciB7IGJvcmRlci1sZWZ0OiAwIG5vbmUgIWltcG9ydGFudDtib3JkZXItcmlnaHQ6IDAgbm9uZSAhaW1wb3J0YW50OyBib3JkZXItYm90dG9tOiAwIG5vbmUgIWltcG9ydGFudDsgbWFyZ2luOiAwICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDAgIWltcG9ydGFudDsgcG9zaXRpb246IHJlbGF0aXZlOyBoZWlnaHQ6IDI1cHg7d2hpdGUtc3BhY2U6IG5vd3JhcDtvdmVyZmxvdzogaGlkZGVuO2ZvbnQtc2l6ZToxMXB4O31cXHJcXG4udWktanFncmlkIC51aS1wYWdlci1jb250cm9sIHtwb3NpdGlvbjogcmVsYXRpdmU7fVxcclxcbi51aS1qcWdyaWQgLnVpLXBnLXRhYmxlIHtwb3NpdGlvbjogcmVsYXRpdmU7IHBhZGRpbmctYm90dG9tOjJweDsgd2lkdGg6YXV0bzsgbWFyZ2luOiAwO31cXHJcXG4udWktanFncmlkIC51aS1wZy10YWJsZSB0ZCB7Zm9udC13ZWlnaHQ6bm9ybWFsOyB2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7IHBhZGRpbmc6MXB4O31cXHJcXG4udWktanFncmlkIC51aS1wZy1idXR0b24gIHsgaGVpZ2h0OjE5cHggIWltcG9ydGFudDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktcGctYnV0dG9uIHNwYW4geyBkaXNwbGF5OiBibG9jazsgbWFyZ2luOiAxcHg7IGZsb2F0OmxlZnQ7fVxcclxcbi51aS1qcWdyaWQgLnVpLXBnLWJ1dHRvbjpob3ZlciB7IHBhZGRpbmc6IDA7IH1cXHJcXG4udWktanFncmlkIC51aS1zdGF0ZS1kaXNhYmxlZDpob3ZlciB7cGFkZGluZzoxcHg7fVxcclxcbi51aS1qcWdyaWQgLnVpLXBnLWlucHV0IHsgaGVpZ2h0OjEzcHg7Zm9udC1zaXplOi44ZW07IG1hcmdpbjogMDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktcGctc2VsYm94IHtmb250LXNpemU6LjhlbTsgbGluZS1oZWlnaHQ6MThweDsgZGlzcGxheTpibG9jazsgaGVpZ2h0OjE4cHg7IG1hcmdpbjogMDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktc2VwYXJhdG9yIHtoZWlnaHQ6IDE4cHg7IGJvcmRlci1sZWZ0OiAxcHggc29saWQgI2NjYyA7IGJvcmRlci1yaWdodDogMXB4IHNvbGlkICNjY2MgOyBtYXJnaW46IDFweDsgZmxvYXQ6IHJpZ2h0O31cXHJcXG4udWktanFncmlkIC51aS1wYWdpbmctaW5mbyB7Zm9udC13ZWlnaHQ6IG5vcm1hbDtoZWlnaHQ6MTlweDsgbWFyZ2luLXRvcDozcHg7bWFyZ2luLXJpZ2h0OjRweDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXBhZ2VyIC51aS1wZy1kaXYge3BhZGRpbmc6MXB4IDA7ZmxvYXQ6bGVmdDtwb3NpdGlvbjpyZWxhdGl2ZTt9XFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXBhZ2VyIC51aS1wZy1idXR0b24geyBjdXJzb3I6cG9pbnRlcjsgfVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1wYWdlciAudWktcGctZGl2ICBzcGFuLnVpLWljb24ge2Zsb2F0OmxlZnQ7bWFyZ2luOjAgMnB4O31cXHJcXG4udWktanFncmlkIHRkIGlucHV0LCAudWktanFncmlkIHRkIHNlbGVjdCAudWktanFncmlkIHRkIHRleHRhcmVhIHsgbWFyZ2luOiAwO31cXHJcXG4udWktanFncmlkIHRkIHRleHRhcmVhIHt3aWR0aDphdXRvO2hlaWdodDphdXRvO31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtdG9wcGFnZXIge2JvcmRlci1sZWZ0OiAwIG5vbmUgIWltcG9ydGFudDtib3JkZXItcmlnaHQ6IDAgbm9uZSAhaW1wb3J0YW50OyBib3JkZXItdG9wOiAwIG5vbmUgIWltcG9ydGFudDsgbWFyZ2luOiAwICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDAgIWltcG9ydGFudDsgcG9zaXRpb246IHJlbGF0aXZlOyBoZWlnaHQ6IDI1cHggIWltcG9ydGFudDt3aGl0ZS1zcGFjZTogbm93cmFwO292ZXJmbG93OiBoaWRkZW47fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC10b3BwYWdlciAudWktcGctZGl2IHtwYWRkaW5nOjFweCAwO2Zsb2F0OmxlZnQ7cG9zaXRpb246cmVsYXRpdmU7fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC10b3BwYWdlciAudWktcGctYnV0dG9uIHsgY3Vyc29yOnBvaW50ZXI7IH1cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtdG9wcGFnZXIgLnVpLXBnLWRpdiAgc3Bhbi51aS1pY29uIHtmbG9hdDpsZWZ0O21hcmdpbjowIDJweDt9XFxyXFxuLypzdWJncmlkKi9cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtYnRhYmxlIC51aS1zZ2NvbGxhcHNlZCBzcGFuIHtkaXNwbGF5OiBibG9jazt9XFxyXFxuLnVpLWpxZ3JpZCAudWktc3ViZ3JpZCB7bWFyZ2luOjA7cGFkZGluZzowOyB3aWR0aDoxMDAlO31cXHJcXG4udWktanFncmlkIC51aS1zdWJncmlkIHRhYmxlIHt0YWJsZS1sYXlvdXQ6IGZpeGVkO31cXHJcXG4udWktanFncmlkIC51aS1zdWJncmlkIHRyLnVpLXN1YnRibGNlbGwgdGQge2hlaWdodDoxOHB4O2JvcmRlci1yaWdodC13aWR0aDogMXB4OyBib3JkZXItcmlnaHQtY29sb3I6IGluaGVyaXQ7IGJvcmRlci1yaWdodC1zdHlsZTogc29saWQ7Ym9yZGVyLWJvdHRvbS13aWR0aDogMXB4OyBib3JkZXItYm90dG9tLWNvbG9yOiBpbmhlcml0OyBib3JkZXItYm90dG9tLXN0eWxlOiBzb2xpZDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktc3ViZ3JpZCB0ZC5zdWJncmlkLWRhdGEge2JvcmRlci10b3A6ICAwIG5vbmUgIWltcG9ydGFudDt9XFxyXFxuLnVpLWpxZ3JpZCAudWktc3ViZ3JpZCB0ZC5zdWJncmlkLWNlbGwge2JvcmRlci13aWR0aDogMCAwIDFweCAwO31cXHJcXG4udWktanFncmlkIC51aS10aC1zdWJncmlkIHtoZWlnaHQ6MjBweDt9XFxyXFxuLyogbG9hZGluZyAqL1xcclxcbi51aS1qcWdyaWQgLmxvYWRpbmcge3Bvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiA0NSU7bGVmdDogNDUlO3dpZHRoOiBhdXRvO3otaW5kZXg6MTAxO3BhZGRpbmc6IDZweDsgbWFyZ2luOiA1cHg7dGV4dC1hbGlnbjogY2VudGVyO2ZvbnQtd2VpZ2h0OiBib2xkO2Rpc3BsYXk6IG5vbmU7Ym9yZGVyLXdpZHRoOiAycHggIWltcG9ydGFudDsgZm9udC1zaXplOjExcHg7fVxcclxcbi51aS1qcWdyaWQgLmpxZ3JpZC1vdmVybGF5IHtkaXNwbGF5Om5vbmU7ei1pbmRleDoxMDA7fVxcclxcbi8qIElFICogaHRtbCAuanFncmlkLW92ZXJsYXkge3dpZHRoOiBleHByZXNzaW9uKHRoaXMucGFyZW50Tm9kZS5vZmZzZXRXaWR0aCsncHgnKTtoZWlnaHQ6IGV4cHJlc3Npb24odGhpcy5wYXJlbnROb2RlLm9mZnNldEhlaWdodCsncHgnKTt9ICovXFxyXFxuKiAuanFncmlkLW92ZXJsYXkgaWZyYW1lIHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0OjA7ei1pbmRleDotMTt9XFxyXFxuLyogSUUgd2lkdGg6IGV4cHJlc3Npb24odGhpcy5wYXJlbnROb2RlLm9mZnNldFdpZHRoKydweCcpO2hlaWdodDogZXhwcmVzc2lvbih0aGlzLnBhcmVudE5vZGUub2Zmc2V0SGVpZ2h0KydweCcpO30qL1xcclxcbi8qIGVuZCBsb2FkaW5nIGRpdiAqL1xcclxcbi8qIHRvb2xiYXIgKi9cXHJcXG4udWktanFncmlkIC51aS11c2VyZGF0YSB7Ym9yZGVyLWxlZnQ6IDAgbm9uZTsgICAgYm9yZGVyLXJpZ2h0OiAwIG5vbmU7XFx0aGVpZ2h0IDogMjFweDtvdmVyZmxvdzogaGlkZGVuO1xcdH1cXHJcXG4vKk1vZGFsIFdpbmRvdyAqL1xcclxcbi51aS1qcWRpYWxvZyB7IGRpc3BsYXk6IG5vbmU7IHdpZHRoOiAzMDBweDsgcG9zaXRpb246IGFic29sdXRlOyBwYWRkaW5nOiAuMmVtOyBmb250LXNpemU6MTFweDsgb3ZlcmZsb3c6dmlzaWJsZTt9XFxyXFxuLnVpLWpxZGlhbG9nIC51aS1qcWRpYWxvZy10aXRsZWJhciB7IHBhZGRpbmc6IC4zZW0gLjJlbTsgcG9zaXRpb246IHJlbGF0aXZlOyAgfVxcclxcbi51aS1qcWRpYWxvZyAudWktanFkaWFsb2ctdGl0bGUgeyBtYXJnaW46IC4xZW0gMCAuMmVtOyB9IFxcclxcbi51aS1qcWRpYWxvZyAudWktanFkaWFsb2ctdGl0bGViYXItY2xvc2UgeyBwb3NpdGlvbjogYWJzb2x1dGU7ICB0b3A6IDUwJTsgd2lkdGg6IDE5cHg7IG1hcmdpbjogLTEwcHggMCAwIDA7IHBhZGRpbmc6IDFweDsgaGVpZ2h0OiAxOHB4OyBjdXJzb3I6cG9pbnRlcjt9XFxyXFxuXFxyXFxuLnVpLWpxZGlhbG9nIC51aS1qcWRpYWxvZy10aXRsZWJhci1jbG9zZSBzcGFuIHsgZGlzcGxheTogYmxvY2s7IG1hcmdpbjogMXB4OyB9XFxyXFxuLnVpLWpxZGlhbG9nIC51aS1qcWRpYWxvZy10aXRsZWJhci1jbG9zZTpob3ZlciwgLnVpLWpxZGlhbG9nIC51aS1qcWRpYWxvZy10aXRsZWJhci1jbG9zZTpmb2N1cyB7IHBhZGRpbmc6IDA7IH1cXHJcXG4udWktanFkaWFsb2ctY29udGVudCwgLnVpLWpxZGlhbG9nIC51aS1qcWRpYWxvZy1jb250ZW50IHsgYm9yZGVyOiAwOyBwYWRkaW5nOiAuM2VtIC4yZW07IGJhY2tncm91bmQ6IG5vbmU7IGhlaWdodDphdXRvO31cXHJcXG4udWktanFkaWFsb2cgLnVpLWpxY29uZmlybSB7cGFkZGluZzogLjRlbSAxZW07IGJvcmRlci13aWR0aDozcHg7cG9zaXRpb246YWJzb2x1dGU7Ym90dG9tOjEwcHg7cmlnaHQ6MTBweDtvdmVyZmxvdzp2aXNpYmxlO2Rpc3BsYXk6bm9uZTtoZWlnaHQ6ODBweDt3aWR0aDoyMjBweDt0ZXh0LWFsaWduOmNlbnRlcjt9XFxyXFxuLnVpLWpxZGlhbG9nPi51aS1yZXNpemFibGUtc2UgeyBib3R0b206IC0zcHg7IHJpZ2h0OiAtM3B4fVxcclxcbi51aS1qcWdyaWQ+LnVpLXJlc2l6YWJsZS1zZSB7IGJvdHRvbTogLTNweDsgcmlnaHQ6IC0zcHggfVxcclxcbi8qIGVuZCBNb2RhbCB3aW5kb3cqL1xcclxcbi8qIEZvcm0gZWRpdCAqL1xcclxcbi51aS1qcWRpYWxvZy1jb250ZW50IC5Gb3JtR3JpZCB7bWFyZ2luOiAwO31cXHJcXG4udWktanFkaWFsb2ctY29udGVudCAuRWRpdFRhYmxlIHsgd2lkdGg6IDEwMCU7IG1hcmdpbi1ib3R0b206MDt9XFxyXFxuLnVpLWpxZGlhbG9nLWNvbnRlbnQgLkRlbFRhYmxlIHsgd2lkdGg6IDEwMCU7IG1hcmdpbi1ib3R0b206MDt9XFxyXFxuLkVkaXRUYWJsZSB0ZCBpbnB1dCwgLkVkaXRUYWJsZSB0ZCBzZWxlY3QsIC5FZGl0VGFibGUgdGQgdGV4dGFyZWEge21hcmdpbjogMDt9XFxyXFxuLkVkaXRUYWJsZSB0ZCB0ZXh0YXJlYSB7IHdpZHRoOmF1dG87IGhlaWdodDphdXRvO31cXHJcXG4udWktanFkaWFsb2ctY29udGVudCB0ZC5FZGl0QnV0dG9uIHt0ZXh0LWFsaWduOiByaWdodDtib3JkZXItdG9wOiAwIG5vbmU7Ym9yZGVyLWxlZnQ6IDAgbm9uZTtib3JkZXItcmlnaHQ6IDAgbm9uZTsgcGFkZGluZy1ib3R0b206NXB4OyBwYWRkaW5nLXRvcDo1cHg7fVxcclxcbi51aS1qcWRpYWxvZy1jb250ZW50IHRkLm5hdkJ1dHRvbiB7dGV4dC1hbGlnbjogY2VudGVyOyBib3JkZXItbGVmdDogMCBub25lO2JvcmRlci10b3A6IDAgbm9uZTtib3JkZXItcmlnaHQ6IDAgbm9uZTsgcGFkZGluZy1ib3R0b206NXB4OyBwYWRkaW5nLXRvcDo1cHg7fVxcclxcbi51aS1qcWRpYWxvZy1jb250ZW50IGlucHV0LkZvcm1FbGVtZW50IHtwYWRkaW5nOi4zZW19XFxyXFxuLnVpLWpxZGlhbG9nLWNvbnRlbnQgc2VsZWN0LkZvcm1FbGVtZW50IHtwYWRkaW5nOi4zZW19XFxyXFxuLnVpLWpxZGlhbG9nLWNvbnRlbnQgLmRhdGEtbGluZSB7cGFkZGluZy10b3A6LjFlbTtib3JkZXI6IDAgbm9uZTt9XFxyXFxuXFxyXFxuLnVpLWpxZGlhbG9nLWNvbnRlbnQgLkNhcHRpb25URCB7dmVydGljYWwtYWxpZ246IG1pZGRsZTtib3JkZXI6IDAgbm9uZTsgcGFkZGluZzogMnB4O3doaXRlLXNwYWNlOiBub3dyYXA7fVxcclxcbi51aS1qcWRpYWxvZy1jb250ZW50IC5EYXRhVEQge3BhZGRpbmc6IDJweDsgYm9yZGVyOiAwIG5vbmU7IHZlcnRpY2FsLWFsaWduOiB0b3A7fVxcclxcbi51aS1qcWRpYWxvZy1jb250ZW50IC5mb3JtLXZpZXctZGF0YSB7d2hpdGUtc3BhY2U6cHJlfVxcclxcbi5mbS1idXR0b24geyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IG1hcmdpbjowIDRweCAwIDA7IHBhZGRpbmc6IC40ZW0gLjVlbTsgdGV4dC1kZWNvcmF0aW9uOm5vbmUgIWltcG9ydGFudDsgY3Vyc29yOnBvaW50ZXI7IHBvc2l0aW9uOiByZWxhdGl2ZTsgdGV4dC1hbGlnbjogY2VudGVyOyB6b29tOiAxOyB9XFxyXFxuLmZtLWJ1dHRvbi1pY29uLWxlZnQgeyBwYWRkaW5nLWxlZnQ6IDEuOWVtOyB9XFxyXFxuLmZtLWJ1dHRvbi1pY29uLXJpZ2h0IHsgcGFkZGluZy1yaWdodDogMS45ZW07IH1cXHJcXG4uZm0tYnV0dG9uLWljb24tbGVmdCAudWktaWNvbiB7IHJpZ2h0OiBhdXRvOyBsZWZ0OiAuMmVtOyBtYXJnaW4tbGVmdDogMDsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDUwJTsgbWFyZ2luLXRvcDogLThweDsgfVxcclxcbi5mbS1idXR0b24taWNvbi1yaWdodCAudWktaWNvbiB7IGxlZnQ6IGF1dG87IHJpZ2h0OiAuMmVtOyBtYXJnaW4tbGVmdDogMDsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDUwJTsgbWFyZ2luLXRvcDogLThweDt9XFxyXFxuI25EYXRhLCAjcERhdGEgeyBmbG9hdDogbGVmdDsgbWFyZ2luOjNweDtwYWRkaW5nOiAwOyB3aWR0aDogMTVweDsgfVxcclxcbi8qIEVuZCBFb3JtIGVkaXQgKi9cXHJcXG4vKi51aS1qcWdyaWQgLmVkaXQtY2VsbCB7fSovXFxyXFxuLnVpLWpxZ3JpZCAuc2VsZWN0ZWQtcm93LCBkaXYudWktanFncmlkIC5zZWxlY3RlZC1yb3cgdGQge2ZvbnQtc3R5bGUgOiBub3JtYWw7Ym9yZGVyLWxlZnQ6IDAgbm9uZTt9XFxyXFxuLyogaW5saW5lIGVkaXQgYWN0aW9ucyBidXR0b24qL1xcclxcbi51aS1pbmxpbmUtZGVsLnVpLXN0YXRlLWhvdmVyIHNwYW4sIC51aS1pbmxpbmUtZWRpdC51aS1zdGF0ZS1ob3ZlciBzcGFuLFxcclxcbi51aS1pbmxpbmUtc2F2ZS51aS1zdGF0ZS1ob3ZlciBzcGFuLCAudWktaW5saW5lLWNhbmNlbC51aS1zdGF0ZS1ob3ZlciBzcGFuIHtcXHJcXG4gICAgbWFyZ2luOiAtMXB4O1xcclxcbn1cXHJcXG4vKiBUcmVlIEdyaWQgKi9cXHJcXG4udWktanFncmlkIC50cmVlLXdyYXAge2Zsb2F0OiBsZWZ0OyBwb3NpdGlvbjogcmVsYXRpdmU7aGVpZ2h0OiAxOHB4O3doaXRlLXNwYWNlOiBub3dyYXA7b3ZlcmZsb3c6IGhpZGRlbjt9XFxyXFxuLnVpLWpxZ3JpZCAudHJlZS1taW51cyB7cG9zaXRpb246IGFic29sdXRlOyBoZWlnaHQ6IDE4cHg7IHdpZHRoOiAxOHB4OyBvdmVyZmxvdzogaGlkZGVuO31cXHJcXG4udWktanFncmlkIC50cmVlLXBsdXMge3Bvc2l0aW9uOiBhYnNvbHV0ZTtcXHRoZWlnaHQ6IDE4cHg7IHdpZHRoOiAxOHB4O1xcdG92ZXJmbG93OiBoaWRkZW47fVxcclxcbi51aS1qcWdyaWQgLnRyZWUtbGVhZiB7cG9zaXRpb246IGFic29sdXRlO1xcdGhlaWdodDogMThweDsgd2lkdGg6IDE4cHg7b3ZlcmZsb3c6IGhpZGRlbjt9XFxyXFxuLnVpLWpxZ3JpZCAudHJlZWNsaWNrIHtjdXJzb3I6IHBvaW50ZXI7fVxcclxcbi8qIG1vZGEgZGlhbG9nICovXFxyXFxuKiBpZnJhbWUuanFtIHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0OjA7ei1pbmRleDotMTt9XFxyXFxuLypcXHQgd2lkdGg6IGV4cHJlc3Npb24odGhpcy5wYXJlbnROb2RlLm9mZnNldFdpZHRoKydweCcpO2hlaWdodDogZXhwcmVzc2lvbih0aGlzLnBhcmVudE5vZGUub2Zmc2V0SGVpZ2h0KydweCcpO30qL1xcclxcbi51aS1qcWdyaWQtZG5kIHRyIHRkIHtib3JkZXItcmlnaHQtd2lkdGg6IDFweDsgYm9yZGVyLXJpZ2h0LWNvbG9yOiBpbmhlcml0OyBib3JkZXItcmlnaHQtc3R5bGU6IHNvbGlkOyBoZWlnaHQ6MjBweH1cXHJcXG4vKiBSVEwgU3VwcG9ydCAqL1xcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1jYXB0aW9uLXJ0bCB7dGV4dC1hbGlnbjogcmlnaHQ7fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1oYm94LXJ0bCB7ZmxvYXQ6IHJpZ2h0OyBwYWRkaW5nLWxlZnQ6IDIwcHg7fVxcclxcbi51aS1qcWdyaWQgLnVpLWpxZ3JpZC1yZXNpemUtbHRyIHtmbG9hdDogcmlnaHQ7bWFyZ2luOiAtMnB4IC0ycHggLTJweCAwO31cXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtcmVzaXplLXJ0bCB7ZmxvYXQ6IGxlZnQ7bWFyZ2luOiAtMnB4IDAgLTFweCAtM3B4O31cXHJcXG4udWktanFncmlkIC51aS1zb3J0LXJ0bCB7bGVmdDowO31cXHJcXG4udWktanFncmlkIC50cmVlLXdyYXAtbHRyIHtmbG9hdDogbGVmdDt9XFxyXFxuLnVpLWpxZ3JpZCAudHJlZS13cmFwLXJ0bCB7ZmxvYXQ6IHJpZ2h0O31cXHJcXG4udWktanFncmlkIC51aS1lbGxpcHNpcyB7LW1vei10ZXh0LW92ZXJmbG93OmVsbGlwc2lzO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7fVxcclxcblxcclxcbi8qIFRvb2xiYXIgU2VhcmNoIE1lbnUgKi9cXHJcXG4udWktc2VhcmNoLW1lbnUgeyBwb3NpdGlvbjogYWJzb2x1dGU7IHBhZGRpbmc6IDJweCA1cHg7fVxcclxcbi51aS1qcWdyaWQgLnVpLXNlYXJjaC10YWJsZSB7IHBhZGRpbmc6IDA7IGJvcmRlcjogMCBub25lOyBoZWlnaHQ6MjBweDsgd2lkdGg6MTAwJTt9XFxyXFxuLnVpLWpxZ3JpZCAudWktc2VhcmNoLXRhYmxlIC51aS1zZWFyY2gtb3BlciB7IHdpZHRoOjIwcHg7IH1cXHJcXG5hLmctbWVudS1pdGVtLCBhLnNvcHRjbGFzcywgYS5jbGVhcnNlYXJjaGNsYXNzIHsgY3Vyc29yOiBwb2ludGVyOyB9XFxyXFxuLnVpLWpxZ3JpZCAudWktc2VhcmNoLXRhYmxlIC51aS1zZWFyY2gtaW5wdXQ+aW5wdXQsXFxyXFxuLnVpLWpxZ3JpZCAudWktc2VhcmNoLXRhYmxlIC51aS1zZWFyY2gtaW5wdXQ+c2VsZWN0XFxyXFxue1xcclxcbiAgICBkaXNwbGF5OiBibG9jaztcXHJcXG4gICAgLW1vei1ib3gtc2l6aW5nOiBib3JkZXItYm94O1xcclxcbiAgICAtd2Via2l0LWJveC1zaXppbmc6IGJvcmRlci1ib3g7XFxyXFxuICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XFxyXFxufSBcXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtdmlldyBpbnB1dCxcXHJcXG4udWktanFncmlkIC51aS1qcWdyaWQtdmlldyBzZWxlY3QsXFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXZpZXcgdGV4dGFyZWEsXFxyXFxuLnVpLWpxZ3JpZCAudWktanFncmlkLXZpZXcgYnV0dG9uIHtcXHJcXG4gICAgZm9udC1zaXplOiAxMXB4XFxyXFxufVxcclxcblwiXSxcInNvdXJjZVJvb3RcIjpcIlwifV0pO1xuLy8gRXhwb3J0c1xuZXhwb3J0IGRlZmF1bHQgX19fQ1NTX0xPQURFUl9FWFBPUlRfX187XG4iLCJcInVzZSBzdHJpY3RcIjtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodXJsLCBvcHRpb25zKSB7XG4gIGlmICghb3B0aW9ucykge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICAgIG9wdGlvbnMgPSB7fTtcbiAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZXJzY29yZS1kYW5nbGUsIG5vLXBhcmFtLXJlYXNzaWduXG5cblxuICB1cmwgPSB1cmwgJiYgdXJsLl9fZXNNb2R1bGUgPyB1cmwuZGVmYXVsdCA6IHVybDtcblxuICBpZiAodHlwZW9mIHVybCAhPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gdXJsO1xuICB9IC8vIElmIHVybCBpcyBhbHJlYWR5IHdyYXBwZWQgaW4gcXVvdGVzLCByZW1vdmUgdGhlbVxuXG5cbiAgaWYgKC9eWydcIl0uKlsnXCJdJC8udGVzdCh1cmwpKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgdXJsID0gdXJsLnNsaWNlKDEsIC0xKTtcbiAgfVxuXG4gIGlmIChvcHRpb25zLmhhc2gpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICB1cmwgKz0gb3B0aW9ucy5oYXNoO1xuICB9IC8vIFNob3VsZCB1cmwgYmUgd3JhcHBlZD9cbiAgLy8gU2VlIGh0dHBzOi8vZHJhZnRzLmNzc3dnLm9yZy9jc3MtdmFsdWVzLTMvI3VybHNcblxuXG4gIGlmICgvW1wiJygpIFxcdFxcbl0vLnRlc3QodXJsKSB8fCBvcHRpb25zLm5lZWRRdW90ZXMpIHtcbiAgICByZXR1cm4gXCJcXFwiXCIuY29uY2F0KHVybC5yZXBsYWNlKC9cIi9nLCAnXFxcXFwiJykucmVwbGFjZSgvXFxuL2csICdcXFxcbicpLCBcIlxcXCJcIik7XG4gIH1cblxuICByZXR1cm4gdXJsO1xufTsiLCJ2YXIgYXBpID0gcmVxdWlyZShcIiEuLi8uLi9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiKTtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi4vLi4vY3NzLWxvYWRlci9kaXN0L2Nqcy5qcyEuL3VpLmpxZ3JpZC5jc3NcIik7XG5cbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50Ll9fZXNNb2R1bGUgPyBjb250ZW50LmRlZmF1bHQgOiBjb250ZW50O1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcbiAgICAgICAgICAgIH1cblxudmFyIG9wdGlvbnMgPSB7fTtcblxub3B0aW9ucy5pbnNlcnQgPSBcImhlYWRcIjtcbm9wdGlvbnMuc2luZ2xldG9uID0gZmFsc2U7XG5cbnZhciB1cGRhdGUgPSBhcGkoY29udGVudCwgb3B0aW9ucyk7XG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IGNvbnRlbnQubG9jYWxzIHx8IHt9OyIsIi8vQGFkZFxyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGpRdWVyeSkge1xyXG4vL0BhZGRcclxuOyhmdW5jdGlvbigkKXtcclxuLyoqXHJcbiAqIGpxR3JpZCBFbmdsaXNoIFRyYW5zbGF0aW9uXHJcbiAqIFRvbnkgVG9tb3YgdG9ueUB0cmlyYW5kLmNvbVxyXG4gKiBodHRwOi8vdHJpcmFuZC5jb20vYmxvZy9cclxuICogRHVhbCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGFuZCBHUEwgbGljZW5zZXM6XHJcbiAqIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXHJcbiAqIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwuaHRtbFxyXG4qKi9cclxuJC5qZ3JpZCA9ICQuamdyaWQgfHwge307XHJcbiQuZXh0ZW5kKCQuamdyaWQse1xyXG5cdGRlZmF1bHRzIDoge1xyXG5cdFx0cmVjb3JkdGV4dDogXCJWaWV3IHswfSAtIHsxfSBvZiB7Mn1cIixcclxuXHRcdGVtcHR5cmVjb3JkczogXCJObyByZWNvcmRzIHRvIHZpZXdcIixcclxuXHRcdGxvYWR0ZXh0OiBcIkxvYWRpbmcuLi5cIixcclxuXHRcdHBndGV4dCA6IFwiUGFnZSB7MH0gb2YgezF9XCJcclxuXHR9LFxyXG5cdHNlYXJjaCA6IHtcclxuXHRcdGNhcHRpb246IFwiU2VhcmNoLi4uXCIsXHJcblx0XHRGaW5kOiBcIkZpbmRcIixcclxuXHRcdFJlc2V0OiBcIlJlc2V0XCIsXHJcblx0XHRvZGF0YTogW3sgb3BlcjonZXEnLCB0ZXh0OidlcXVhbCd9LHsgb3BlcjonbmUnLCB0ZXh0Oidub3QgZXF1YWwnfSx7IG9wZXI6J2x0JywgdGV4dDonbGVzcyd9LHsgb3BlcjonbGUnLCB0ZXh0OidsZXNzIG9yIGVxdWFsJ30seyBvcGVyOidndCcsIHRleHQ6J2dyZWF0ZXInfSx7IG9wZXI6J2dlJywgdGV4dDonZ3JlYXRlciBvciBlcXVhbCd9LHsgb3BlcjonYncnLCB0ZXh0OidiZWdpbnMgd2l0aCd9LHsgb3BlcjonYm4nLCB0ZXh0Oidkb2VzIG5vdCBiZWdpbiB3aXRoJ30seyBvcGVyOidpbicsIHRleHQ6J2lzIGluJ30seyBvcGVyOiduaScsIHRleHQ6J2lzIG5vdCBpbid9LHsgb3BlcjonZXcnLCB0ZXh0OidlbmRzIHdpdGgnfSx7IG9wZXI6J2VuJywgdGV4dDonZG9lcyBub3QgZW5kIHdpdGgnfSx7IG9wZXI6J2NuJywgdGV4dDonY29udGFpbnMnfSx7IG9wZXI6J25jJywgdGV4dDonZG9lcyBub3QgY29udGFpbid9LHsgb3BlcjonbnUnLCB0ZXh0OidpcyBudWxsJ30seyBvcGVyOidubicsIHRleHQ6J2lzIG5vdCBudWxsJ31dLFxyXG5cdFx0Z3JvdXBPcHM6IFt7IG9wOiBcIkFORFwiLCB0ZXh0OiBcImFsbFwiIH0seyBvcDogXCJPUlwiLCAgdGV4dDogXCJhbnlcIiB9XSxcclxuXHRcdG9wZXJhbmRUaXRsZSA6IFwiQ2xpY2sgdG8gc2VsZWN0IHNlYXJjaCBvcGVyYXRpb24uXCIsXHJcblx0XHRyZXNldFRpdGxlIDogXCJSZXNldCBTZWFyY2ggVmFsdWVcIlxyXG5cdH0sXHJcblx0ZWRpdCA6IHtcclxuXHRcdGFkZENhcHRpb246IFwiQWRkIFJlY29yZFwiLFxyXG5cdFx0ZWRpdENhcHRpb246IFwiRWRpdCBSZWNvcmRcIixcclxuXHRcdGJTdWJtaXQ6IFwiU3VibWl0XCIsXHJcblx0XHRiQ2FuY2VsOiBcIkNhbmNlbFwiLFxyXG5cdFx0YkNsb3NlOiBcIkNsb3NlXCIsXHJcblx0XHRzYXZlRGF0YTogXCJEYXRhIGhhcyBiZWVuIGNoYW5nZWQhIFNhdmUgY2hhbmdlcz9cIixcclxuXHRcdGJZZXMgOiBcIlllc1wiLFxyXG5cdFx0Yk5vIDogXCJOb1wiLFxyXG5cdFx0YkV4aXQgOiBcIkNhbmNlbFwiLFxyXG5cdFx0bXNnOiB7XHJcblx0XHRcdHJlcXVpcmVkOlwiRmllbGQgaXMgcmVxdWlyZWRcIixcclxuXHRcdFx0bnVtYmVyOlwiUGxlYXNlLCBlbnRlciB2YWxpZCBudW1iZXJcIixcclxuXHRcdFx0bWluVmFsdWU6XCJ2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byBcIixcclxuXHRcdFx0bWF4VmFsdWU6XCJ2YWx1ZSBtdXN0IGJlIGxlc3MgdGhhbiBvciBlcXVhbCB0b1wiLFxyXG5cdFx0XHRlbWFpbDogXCJpcyBub3QgYSB2YWxpZCBlLW1haWxcIixcclxuXHRcdFx0aW50ZWdlcjogXCJQbGVhc2UsIGVudGVyIHZhbGlkIGludGVnZXIgdmFsdWVcIixcclxuXHRcdFx0ZGF0ZTogXCJQbGVhc2UsIGVudGVyIHZhbGlkIGRhdGUgdmFsdWVcIixcclxuXHRcdFx0dXJsOiBcImlzIG5vdCBhIHZhbGlkIFVSTC4gUHJlZml4IHJlcXVpcmVkICgnaHR0cDovLycgb3IgJ2h0dHBzOi8vJylcIixcclxuXHRcdFx0bm9kZWZpbmVkIDogXCIgaXMgbm90IGRlZmluZWQhXCIsXHJcblx0XHRcdG5vdmFsdWUgOiBcIiByZXR1cm4gdmFsdWUgaXMgcmVxdWlyZWQhXCIsXHJcblx0XHRcdGN1c3RvbWFycmF5IDogXCJDdXN0b20gZnVuY3Rpb24gc2hvdWxkIHJldHVybiBhcnJheSFcIixcclxuXHRcdFx0Y3VzdG9tZmNoZWNrIDogXCJDdXN0b20gZnVuY3Rpb24gc2hvdWxkIGJlIHByZXNlbnQgaW4gY2FzZSBvZiBjdXN0b20gY2hlY2tpbmchXCJcclxuXHJcblx0XHR9XHJcblx0fSxcclxuXHR2aWV3IDoge1xyXG5cdFx0Y2FwdGlvbjogXCJWaWV3IFJlY29yZFwiLFxyXG5cdFx0YkNsb3NlOiBcIkNsb3NlXCJcclxuXHR9LFxyXG5cdGRlbCA6IHtcclxuXHRcdGNhcHRpb246IFwiRGVsZXRlXCIsXHJcblx0XHRtc2c6IFwiRGVsZXRlIHNlbGVjdGVkIHJlY29yZChzKT9cIixcclxuXHRcdGJTdWJtaXQ6IFwiRGVsZXRlXCIsXHJcblx0XHRiQ2FuY2VsOiBcIkNhbmNlbFwiXHJcblx0fSxcclxuXHRuYXYgOiB7XHJcblx0XHRlZGl0dGV4dDogXCJcIixcclxuXHRcdGVkaXR0aXRsZTogXCJFZGl0IHNlbGVjdGVkIHJvd1wiLFxyXG5cdFx0YWRkdGV4dDpcIlwiLFxyXG5cdFx0YWRkdGl0bGU6IFwiQWRkIG5ldyByb3dcIixcclxuXHRcdGRlbHRleHQ6IFwiXCIsXHJcblx0XHRkZWx0aXRsZTogXCJEZWxldGUgc2VsZWN0ZWQgcm93XCIsXHJcblx0XHRzZWFyY2h0ZXh0OiBcIlwiLFxyXG5cdFx0c2VhcmNodGl0bGU6IFwiRmluZCByZWNvcmRzXCIsXHJcblx0XHRyZWZyZXNodGV4dDogXCJcIixcclxuXHRcdHJlZnJlc2h0aXRsZTogXCJSZWxvYWQgR3JpZFwiLFxyXG5cdFx0YWxlcnRjYXA6IFwiV2FybmluZ1wiLFxyXG5cdFx0YWxlcnR0ZXh0OiBcIlBsZWFzZSwgc2VsZWN0IHJvd1wiLFxyXG5cdFx0dmlld3RleHQ6IFwiXCIsXHJcblx0XHR2aWV3dGl0bGU6IFwiVmlldyBzZWxlY3RlZCByb3dcIlxyXG5cdH0sXHJcblx0Y29sIDoge1xyXG5cdFx0Y2FwdGlvbjogXCJTZWxlY3QgY29sdW1uc1wiLFxyXG5cdFx0YlN1Ym1pdDogXCJPa1wiLFxyXG5cdFx0YkNhbmNlbDogXCJDYW5jZWxcIlxyXG5cdH0sXHJcblx0ZXJyb3JzIDoge1xyXG5cdFx0ZXJyY2FwIDogXCJFcnJvclwiLFxyXG5cdFx0bm91cmwgOiBcIk5vIHVybCBpcyBzZXRcIixcclxuXHRcdG5vcmVjb3JkczogXCJObyByZWNvcmRzIHRvIHByb2Nlc3NcIixcclxuXHRcdG1vZGVsIDogXCJMZW5ndGggb2YgY29sTmFtZXMgPD4gY29sTW9kZWwhXCJcclxuXHR9LFxyXG5cdGZvcm1hdHRlciA6IHtcclxuXHRcdGludGVnZXIgOiB7dGhvdXNhbmRzU2VwYXJhdG9yOiBcIixcIiwgZGVmYXVsdFZhbHVlOiAnMCd9LFxyXG5cdFx0bnVtYmVyIDoge2RlY2ltYWxTZXBhcmF0b3I6XCIuXCIsIHRob3VzYW5kc1NlcGFyYXRvcjogXCIsXCIsIGRlY2ltYWxQbGFjZXM6IDIsIGRlZmF1bHRWYWx1ZTogJzAuMDAnfSxcclxuXHRcdGN1cnJlbmN5IDoge2RlY2ltYWxTZXBhcmF0b3I6XCIuXCIsIHRob3VzYW5kc1NlcGFyYXRvcjogXCIsXCIsIGRlY2ltYWxQbGFjZXM6IDIsIHByZWZpeDogXCJcIiwgc3VmZml4OlwiXCIsIGRlZmF1bHRWYWx1ZTogJzAuMDAnfSxcclxuXHRcdGRhdGUgOiB7XHJcblx0XHRcdGRheU5hbWVzOiAgIFtcclxuXHRcdFx0XHRcIlN1blwiLCBcIk1vblwiLCBcIlR1ZVwiLCBcIldlZFwiLCBcIlRoclwiLCBcIkZyaVwiLCBcIlNhdFwiLFxyXG5cdFx0XHRcdFwiU3VuZGF5XCIsIFwiTW9uZGF5XCIsIFwiVHVlc2RheVwiLCBcIldlZG5lc2RheVwiLCBcIlRodXJzZGF5XCIsIFwiRnJpZGF5XCIsIFwiU2F0dXJkYXlcIlxyXG5cdFx0XHRdLFxyXG5cdFx0XHRtb250aE5hbWVzOiBbXHJcblx0XHRcdFx0XCJKYW5cIiwgXCJGZWJcIiwgXCJNYXJcIiwgXCJBcHJcIiwgXCJNYXlcIiwgXCJKdW5cIiwgXCJKdWxcIiwgXCJBdWdcIiwgXCJTZXBcIiwgXCJPY3RcIiwgXCJOb3ZcIiwgXCJEZWNcIixcclxuXHRcdFx0XHRcIkphbnVhcnlcIiwgXCJGZWJydWFyeVwiLCBcIk1hcmNoXCIsIFwiQXByaWxcIiwgXCJNYXlcIiwgXCJKdW5lXCIsIFwiSnVseVwiLCBcIkF1Z3VzdFwiLCBcIlNlcHRlbWJlclwiLCBcIk9jdG9iZXJcIiwgXCJOb3ZlbWJlclwiLCBcIkRlY2VtYmVyXCJcclxuXHRcdFx0XSxcclxuXHRcdFx0QW1QbSA6IFtcImFtXCIsXCJwbVwiLFwiQU1cIixcIlBNXCJdLFxyXG5cdFx0XHRTOiBmdW5jdGlvbiAoaikge3JldHVybiBqIDwgMTEgfHwgaiA+IDEzID8gWydzdCcsICduZCcsICdyZCcsICd0aCddW01hdGgubWluKChqIC0gMSkgJSAxMCwgMyldIDogJ3RoJzt9LFxyXG5cdFx0XHRzcmNmb3JtYXQ6ICdZLW0tZCcsXHJcblx0XHRcdG5ld2Zvcm1hdDogJ24vai9ZJyxcclxuXHRcdFx0cGFyc2VSZSA6IC9bIyVcXFxcXFwvOl87LixcXHRcXHMtXS8sXHJcblx0XHRcdG1hc2tzIDoge1xyXG5cdFx0XHRcdC8vIHNlZSBodHRwOi8vcGhwLm5ldC9tYW51YWwvZW4vZnVuY3Rpb24uZGF0ZS5waHAgZm9yIFBIUCBmb3JtYXQgdXNlZCBpbiBqcUdyaWRcclxuXHRcdFx0XHQvLyBhbmQgc2VlIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkvRGF0ZXBpY2tlci9mb3JtYXREYXRlXHJcblx0XHRcdFx0Ly8gYW5kIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvZ2xvYmFsaXplI2RhdGVzIGZvciBhbHRlcm5hdGl2ZSBmb3JtYXRzIHVzZWQgZnJlcXVlbnRseVxyXG5cdFx0XHRcdC8vIG9uZSBjYW4gZmluZCBvbiBodHRwczovL2dpdGh1Yi5jb20vanF1ZXJ5L2dsb2JhbGl6ZS90cmVlL21hc3Rlci9saWIvY3VsdHVyZXMgbWFueVxyXG5cdFx0XHRcdC8vIGluZm9ybWF0aW9uIGFib3V0IGRhdGUsIHRpbWUsIG51bWJlcnMgYW5kIGN1cnJlbmN5IGZvcm1hdHMgdXNlZCBpbiBkaWZmZXJlbnQgY291bnRyaWVzXHJcblx0XHRcdFx0Ly8gb25lIHNob3VsZCBqdXN0IGNvbnZlcnQgdGhlIGluZm9ybWF0aW9uIGluIFBIUCBmb3JtYXRcclxuXHRcdFx0XHRJU084NjAxTG9uZzpcIlktbS1kIEg6aTpzXCIsXHJcblx0XHRcdFx0SVNPODYwMVNob3J0OlwiWS1tLWRcIixcclxuXHRcdFx0XHQvLyBzaG9ydCBkYXRlOlxyXG5cdFx0XHRcdC8vICAgIG4gLSBOdW1lcmljIHJlcHJlc2VudGF0aW9uIG9mIGEgbW9udGgsIHdpdGhvdXQgbGVhZGluZyB6ZXJvc1xyXG5cdFx0XHRcdC8vICAgIGogLSBEYXkgb2YgdGhlIG1vbnRoIHdpdGhvdXQgbGVhZGluZyB6ZXJvc1xyXG5cdFx0XHRcdC8vICAgIFkgLSBBIGZ1bGwgbnVtZXJpYyByZXByZXNlbnRhdGlvbiBvZiBhIHllYXIsIDQgZGlnaXRzXHJcblx0XHRcdFx0Ly8gZXhhbXBsZTogMy8xLzIwMTIgd2hpY2ggbWVhbnMgMSBNYXJjaCAyMDEyXHJcblx0XHRcdFx0U2hvcnREYXRlOiBcIm4vai9ZXCIsIC8vIGluIGpRdWVyeSBVSSBEYXRlcGlja2VyOiBcIk0vZC95eXl5XCJcclxuXHRcdFx0XHQvLyBsb25nIGRhdGU6XHJcblx0XHRcdFx0Ly8gICAgbCAtIEEgZnVsbCB0ZXh0dWFsIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBkYXkgb2YgdGhlIHdlZWtcclxuXHRcdFx0XHQvLyAgICBGIC0gQSBmdWxsIHRleHR1YWwgcmVwcmVzZW50YXRpb24gb2YgYSBtb250aFxyXG5cdFx0XHRcdC8vICAgIGQgLSBEYXkgb2YgdGhlIG1vbnRoLCAyIGRpZ2l0cyB3aXRoIGxlYWRpbmcgemVyb3NcclxuXHRcdFx0XHQvLyAgICBZIC0gQSBmdWxsIG51bWVyaWMgcmVwcmVzZW50YXRpb24gb2YgYSB5ZWFyLCA0IGRpZ2l0c1xyXG5cdFx0XHRcdExvbmdEYXRlOiBcImwsIEYgZCwgWVwiLCAvLyBpbiBqUXVlcnkgVUkgRGF0ZXBpY2tlcjogXCJkZGRkLCBNTU1NIGRkLCB5eXl5XCJcclxuXHRcdFx0XHQvLyBsb25nIGRhdGUgd2l0aCBsb25nIHRpbWU6XHJcblx0XHRcdFx0Ly8gICAgbCAtIEEgZnVsbCB0ZXh0dWFsIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBkYXkgb2YgdGhlIHdlZWtcclxuXHRcdFx0XHQvLyAgICBGIC0gQSBmdWxsIHRleHR1YWwgcmVwcmVzZW50YXRpb24gb2YgYSBtb250aFxyXG5cdFx0XHRcdC8vICAgIGQgLSBEYXkgb2YgdGhlIG1vbnRoLCAyIGRpZ2l0cyB3aXRoIGxlYWRpbmcgemVyb3NcclxuXHRcdFx0XHQvLyAgICBZIC0gQSBmdWxsIG51bWVyaWMgcmVwcmVzZW50YXRpb24gb2YgYSB5ZWFyLCA0IGRpZ2l0c1xyXG5cdFx0XHRcdC8vICAgIGcgLSAxMi1ob3VyIGZvcm1hdCBvZiBhbiBob3VyIHdpdGhvdXQgbGVhZGluZyB6ZXJvc1xyXG5cdFx0XHRcdC8vICAgIGkgLSBNaW51dGVzIHdpdGggbGVhZGluZyB6ZXJvc1xyXG5cdFx0XHRcdC8vICAgIHMgLSBTZWNvbmRzLCB3aXRoIGxlYWRpbmcgemVyb3NcclxuXHRcdFx0XHQvLyAgICBBIC0gVXBwZXJjYXNlIEFudGUgbWVyaWRpZW0gYW5kIFBvc3QgbWVyaWRpZW0gKEFNIG9yIFBNKVxyXG5cdFx0XHRcdEZ1bGxEYXRlVGltZTogXCJsLCBGIGQsIFkgZzppOnMgQVwiLCAvLyBpbiBqUXVlcnkgVUkgRGF0ZXBpY2tlcjogXCJkZGRkLCBNTU1NIGRkLCB5eXl5IGg6bW06c3MgdHRcIlxyXG5cdFx0XHRcdC8vIG1vbnRoIGRheTpcclxuXHRcdFx0XHQvLyAgICBGIC0gQSBmdWxsIHRleHR1YWwgcmVwcmVzZW50YXRpb24gb2YgYSBtb250aFxyXG5cdFx0XHRcdC8vICAgIGQgLSBEYXkgb2YgdGhlIG1vbnRoLCAyIGRpZ2l0cyB3aXRoIGxlYWRpbmcgemVyb3NcclxuXHRcdFx0XHRNb250aERheTogXCJGIGRcIiwgLy8gaW4galF1ZXJ5IFVJIERhdGVwaWNrZXI6IFwiTU1NTSBkZFwiXHJcblx0XHRcdFx0Ly8gc2hvcnQgdGltZSAod2l0aG91dCBzZWNvbmRzKVxyXG5cdFx0XHRcdC8vICAgIGcgLSAxMi1ob3VyIGZvcm1hdCBvZiBhbiBob3VyIHdpdGhvdXQgbGVhZGluZyB6ZXJvc1xyXG5cdFx0XHRcdC8vICAgIGkgLSBNaW51dGVzIHdpdGggbGVhZGluZyB6ZXJvc1xyXG5cdFx0XHRcdC8vICAgIEEgLSBVcHBlcmNhc2UgQW50ZSBtZXJpZGllbSBhbmQgUG9zdCBtZXJpZGllbSAoQU0gb3IgUE0pXHJcblx0XHRcdFx0U2hvcnRUaW1lOiBcImc6aSBBXCIsIC8vIGluIGpRdWVyeSBVSSBEYXRlcGlja2VyOiBcImg6bW0gdHRcIlxyXG5cdFx0XHRcdC8vIGxvbmcgdGltZSAod2l0aCBzZWNvbmRzKVxyXG5cdFx0XHRcdC8vICAgIGcgLSAxMi1ob3VyIGZvcm1hdCBvZiBhbiBob3VyIHdpdGhvdXQgbGVhZGluZyB6ZXJvc1xyXG5cdFx0XHRcdC8vICAgIGkgLSBNaW51dGVzIHdpdGggbGVhZGluZyB6ZXJvc1xyXG5cdFx0XHRcdC8vICAgIHMgLSBTZWNvbmRzLCB3aXRoIGxlYWRpbmcgemVyb3NcclxuXHRcdFx0XHQvLyAgICBBIC0gVXBwZXJjYXNlIEFudGUgbWVyaWRpZW0gYW5kIFBvc3QgbWVyaWRpZW0gKEFNIG9yIFBNKVxyXG5cdFx0XHRcdExvbmdUaW1lOiBcImc6aTpzIEFcIiwgLy8gaW4galF1ZXJ5IFVJIERhdGVwaWNrZXI6IFwiaDptbTpzcyB0dFwiXHJcblx0XHRcdFx0U29ydGFibGVEYXRlVGltZTogXCJZLW0tZFxcXFxUSDppOnNcIixcclxuXHRcdFx0XHRVbml2ZXJzYWxTb3J0YWJsZURhdGVUaW1lOiBcIlktbS1kIEg6aTpzT1wiLFxyXG5cdFx0XHRcdC8vIG1vbnRoIHdpdGggeWVhclxyXG5cdFx0XHRcdC8vICAgIFkgLSBBIGZ1bGwgbnVtZXJpYyByZXByZXNlbnRhdGlvbiBvZiBhIHllYXIsIDQgZGlnaXRzXHJcblx0XHRcdFx0Ly8gICAgRiAtIEEgZnVsbCB0ZXh0dWFsIHJlcHJlc2VudGF0aW9uIG9mIGEgbW9udGhcclxuXHRcdFx0XHRZZWFyTW9udGg6IFwiRiwgWVwiIC8vIGluIGpRdWVyeSBVSSBEYXRlcGlja2VyOiBcIk1NTU0sIHl5eXlcIlxyXG5cdFx0XHR9LFxyXG5cdFx0XHRyZWZvcm1hdEFmdGVyRWRpdCA6IGZhbHNlXHJcblx0XHR9LFxyXG5cdFx0YmFzZUxpbmtVcmw6ICcnLFxyXG5cdFx0c2hvd0FjdGlvbjogJycsXHJcblx0XHR0YXJnZXQ6ICcnLFxyXG5cdFx0Y2hlY2tib3ggOiB7ZGlzYWJsZWQ6dHJ1ZX0sXHJcblx0XHRpZE5hbWUgOiAnaWQnXHJcblx0fVxyXG59KTtcclxufSkoalF1ZXJ5KTtcclxuLy9AYWRkXHJcbn07XHJcbi8vQGFkZFxyXG4iLCIvLyA9PUNsb3N1cmVDb21waWxlcj09XHJcbi8vIEBjb21waWxhdGlvbl9sZXZlbCBTSU1QTEVfT1BUSU1JWkFUSU9OU1xyXG5cclxuLyoqXHJcbiAqIEBsaWNlbnNlIGpxR3JpZCAgNC42LjAgLSBqUXVlcnkgR3JpZFxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMDgsIFRvbnkgVG9tb3YsIHRvbnlAdHJpcmFuZC5jb21cclxuICogRHVhbCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGFuZCBHUEwgbGljZW5zZXNcclxuICogaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuICogaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2dwbC0yLjAuaHRtbFxyXG4gKiBEYXRlOiAyMDE0LTAyLTIwXHJcbiAqL1xyXG4vL2pzSGludCBvcHRpb25zXHJcbi8qanNoaW50IGV2aWw6dHJ1ZSwgZXFlcWVxOmZhbHNlLCBlcW51bGw6dHJ1ZSwgZGV2ZWw6dHJ1ZSAqL1xyXG4vKmdsb2JhbCBqUXVlcnkgKi9cclxuLy9AYWRkXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oalF1ZXJ5KSB7XHJcbi8vQGFkZFxyXG4oZnVuY3Rpb24gKCQpIHtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcbiQuamdyaWQgPSAkLmpncmlkIHx8IHt9O1xyXG4kLmV4dGVuZCgkLmpncmlkLHtcclxuXHR2ZXJzaW9uIDogXCI0LjYuMFwiLFxyXG5cdGh0bWxEZWNvZGUgOiBmdW5jdGlvbih2YWx1ZSl7XHJcblx0XHRpZih2YWx1ZSAmJiAodmFsdWU9PT0nJm5ic3A7JyB8fCB2YWx1ZT09PScmIzE2MDsnIHx8ICh2YWx1ZS5sZW5ndGg9PT0xICYmIHZhbHVlLmNoYXJDb2RlQXQoMCk9PT0xNjApKSkgeyByZXR1cm4gXCJcIjt9XHJcblx0XHRyZXR1cm4gIXZhbHVlID8gdmFsdWUgOiBTdHJpbmcodmFsdWUpLnJlcGxhY2UoLyZndDsvZywgXCI+XCIpLnJlcGxhY2UoLyZsdDsvZywgXCI8XCIpLnJlcGxhY2UoLyZxdW90Oy9nLCAnXCInKS5yZXBsYWNlKC8mYW1wOy9nLCBcIiZcIik7XHJcblx0fSxcclxuXHRodG1sRW5jb2RlIDogZnVuY3Rpb24gKHZhbHVlKXtcclxuXHRcdHJldHVybiAhdmFsdWUgPyB2YWx1ZSA6IFN0cmluZyh2YWx1ZSkucmVwbGFjZSgvJi9nLCBcIiZhbXA7XCIpLnJlcGxhY2UoL1xcXCIvZywgXCImcXVvdDtcIikucmVwbGFjZSgvPC9nLCBcIiZsdDtcIikucmVwbGFjZSgvPi9nLCBcIiZndDtcIik7XHJcblx0fSxcclxuXHRmb3JtYXQgOiBmdW5jdGlvbihmb3JtYXQpeyAvL2pxZ2Zvcm1hdFxyXG5cdFx0dmFyIGFyZ3MgPSAkLm1ha2VBcnJheShhcmd1bWVudHMpLnNsaWNlKDEpO1xyXG5cdFx0aWYoZm9ybWF0PT1udWxsKSB7IGZvcm1hdCA9IFwiXCI7IH1cclxuXHRcdHJldHVybiBmb3JtYXQucmVwbGFjZSgvXFx7KFxcZCspXFx9L2csIGZ1bmN0aW9uKG0sIGkpe1xyXG5cdFx0XHRyZXR1cm4gYXJnc1tpXTtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0bXNpZSA6IG5hdmlnYXRvci5hcHBOYW1lID09PSAnTWljcm9zb2Z0IEludGVybmV0IEV4cGxvcmVyJyxcclxuXHRtc2lldmVyIDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIHJ2ID0gLTE7XHJcblx0XHR2YXIgdWEgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xyXG5cdFx0dmFyIHJlICA9IG5ldyBSZWdFeHAoXCJNU0lFIChbMC05XXsxLH1bXFwuMC05XXswLH0pXCIpO1xyXG5cdFx0aWYgKHJlLmV4ZWModWEpICE9IG51bGwpIHtcclxuXHRcdFx0cnYgPSBwYXJzZUZsb2F0KCBSZWdFeHAuJDEgKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBydjtcclxuXHR9LFxyXG5cdGdldENlbGxJbmRleCA6IGZ1bmN0aW9uIChjZWxsKSB7XHJcblx0XHR2YXIgYyA9ICQoY2VsbCk7XHJcblx0XHRpZiAoYy5pcygndHInKSkgeyByZXR1cm4gLTE7IH1cclxuXHRcdGMgPSAoIWMuaXMoJ3RkJykgJiYgIWMuaXMoJ3RoJykgPyBjLmNsb3Nlc3QoXCJ0ZCx0aFwiKSA6IGMpWzBdO1xyXG5cdFx0aWYgKCQuamdyaWQubXNpZSkgeyByZXR1cm4gJC5pbkFycmF5KGMsIGMucGFyZW50Tm9kZS5jZWxscyk7IH1cclxuXHRcdHJldHVybiBjLmNlbGxJbmRleDtcclxuXHR9LFxyXG5cdHN0cmlwSHRtbCA6IGZ1bmN0aW9uKHYpIHtcclxuXHRcdHYgPSBTdHJpbmcodik7XHJcblx0XHR2YXIgcmVnZXhwID0gLzwoXCJbXlwiXSpcInwnW14nXSonfFteJ1wiPl0pKj4vZ2k7XHJcblx0XHRpZiAodikge1xyXG5cdFx0XHR2ID0gdi5yZXBsYWNlKHJlZ2V4cCxcIlwiKTtcclxuXHRcdFx0cmV0dXJuICh2ICYmIHYgIT09ICcmbmJzcDsnICYmIHYgIT09ICcmIzE2MDsnKSA/IHYucmVwbGFjZSgvXFxcIi9nLFwiJ1wiKSA6IFwiXCI7XHJcblx0XHR9XHJcblx0XHRcdHJldHVybiB2O1xyXG5cdH0sXHJcblx0c3RyaXBQcmVmIDogZnVuY3Rpb24gKHByZWYsIGlkKSB7XHJcblx0XHR2YXIgb2JqID0gJC50eXBlKCBwcmVmICk7XHJcblx0XHRpZiggb2JqID09PSBcInN0cmluZ1wiIHx8IG9iaiA9PT0gXCJudW1iZXJcIikge1xyXG5cdFx0XHRwcmVmID0gIFN0cmluZyhwcmVmKTtcclxuXHRcdFx0aWQgPSBwcmVmICE9PSBcIlwiID8gU3RyaW5nKGlkKS5yZXBsYWNlKFN0cmluZyhwcmVmKSwgXCJcIikgOiBpZDtcclxuXHRcdH1cclxuXHRcdHJldHVybiBpZDtcclxuXHR9LFxyXG5cdHBhcnNlIDogZnVuY3Rpb24oanNvblN0cmluZykge1xyXG5cdFx0dmFyIGpzID0ganNvblN0cmluZztcclxuXHRcdGlmIChqcy5zdWJzdHIoMCw5KSA9PT0gXCJ3aGlsZSgxKTtcIikgeyBqcyA9IGpzLnN1YnN0cig5KTsgfVxyXG5cdFx0aWYgKGpzLnN1YnN0cigwLDIpID09PSBcIi8qXCIpIHsganMgPSBqcy5zdWJzdHIoMixqcy5sZW5ndGgtNCk7IH1cclxuXHRcdGlmKCFqcykgeyBqcyA9IFwie31cIjsgfVxyXG5cdFx0cmV0dXJuICgkLmpncmlkLnVzZUpTT049PT10cnVlICYmIHR5cGVvZiBKU09OID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgSlNPTi5wYXJzZSA9PT0gJ2Z1bmN0aW9uJykgP1xyXG5cdFx0XHRKU09OLnBhcnNlKGpzKSA6XHJcblx0XHRcdGV2YWwoJygnICsganMgKyAnKScpO1xyXG5cdH0sXHJcblx0cGFyc2VEYXRlIDogZnVuY3Rpb24oZm9ybWF0LCBkYXRlLCBuZXdmb3JtYXQsIG9wdHMpIHtcclxuXHRcdHZhclx0dG9rZW4gPSAvXFxcXC58W2REamxOU3d6V0ZtTW50TG9ZeWFBQmdHaEhpc3VlSU9QVFpjclVdL2csXHJcblx0XHR0aW1lem9uZSA9IC9cXGIoPzpbUE1DRUFdW1NEUF1UfCg/OlBhY2lmaWN8TW91bnRhaW58Q2VudHJhbHxFYXN0ZXJufEF0bGFudGljKSAoPzpTdGFuZGFyZHxEYXlsaWdodHxQcmV2YWlsaW5nKSBUaW1lfCg/OkdNVHxVVEMpKD86Wy0rXVxcZHs0fSk/KVxcYi9nLFxyXG5cdFx0dGltZXpvbmVDbGlwID0gL1teLStcXGRBLVpdL2csXHJcblx0XHRtc0RhdGVSZWdFeHAgPSBuZXcgUmVnRXhwKFwiXlxcL0RhdGVcXFxcKCgoWy0rXSk/WzAtOV0rKSgoWy0rXSkoWzAtOV17Mn0pKFswLTldezJ9KSk/XFxcXClcXC8kXCIpLFxyXG5cdFx0bXNNYXRjaCA9ICgodHlwZW9mIGRhdGUgPT09ICdzdHJpbmcnKSA/IGRhdGUubWF0Y2gobXNEYXRlUmVnRXhwKTogbnVsbCksXHJcblx0XHRwYWQgPSBmdW5jdGlvbiAodmFsdWUsIGxlbmd0aCkge1xyXG5cdFx0XHR2YWx1ZSA9IFN0cmluZyh2YWx1ZSk7XHJcblx0XHRcdGxlbmd0aCA9IHBhcnNlSW50KGxlbmd0aCwxMCkgfHwgMjtcclxuXHRcdFx0d2hpbGUgKHZhbHVlLmxlbmd0aCA8IGxlbmd0aCkgIHsgdmFsdWUgPSAnMCcgKyB2YWx1ZTsgfVxyXG5cdFx0XHRyZXR1cm4gdmFsdWU7XHJcblx0XHR9LFxyXG5cdFx0dHMgPSB7bSA6IDEsIGQgOiAxLCB5IDogMTk3MCwgaCA6IDAsIGkgOiAwLCBzIDogMCwgdTowfSxcclxuXHRcdHRpbWVzdGFtcD0wLCBkTSwgayxobCxcclxuXHRcdGgxMnRvMjQgPSBmdW5jdGlvbihhbXBtLCBoKXtcclxuXHRcdFx0aWYgKGFtcG0gPT09IDApeyBpZiAoaCA9PT0gMTIpIHsgaCA9IDA7fSB9XHJcblx0XHRcdGVsc2UgeyBpZiAoaCAhPT0gMTIpIHsgaCArPSAxMjsgfSB9XHJcblx0XHRcdHJldHVybiBoO1xyXG5cdFx0fTtcclxuXHRcdGlmKG9wdHMgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRvcHRzID0gJC5qZ3JpZC5mb3JtYXR0ZXIuZGF0ZTtcclxuXHRcdH1cclxuXHRcdC8vIG9sZCBsYW5nIGZpbGVzXHJcblx0XHRpZihvcHRzLnBhcnNlUmUgPT09IHVuZGVmaW5lZCApIHtcclxuXHRcdFx0b3B0cy5wYXJzZVJlID0gL1sjJVxcXFxcXC86XzsuLFxcdFxccy1dLztcclxuXHRcdH1cclxuXHRcdGlmKCBvcHRzLm1hc2tzLmhhc093blByb3BlcnR5KGZvcm1hdCkgKSB7IGZvcm1hdCA9IG9wdHMubWFza3NbZm9ybWF0XTsgfVxyXG5cdFx0aWYoZGF0ZSAmJiBkYXRlICE9IG51bGwpIHtcclxuXHRcdFx0aWYoICFpc05hTiggZGF0ZSAtIDAgKSAmJiBTdHJpbmcoZm9ybWF0KS50b0xvd2VyQ2FzZSgpID09PSBcInVcIikge1xyXG5cdFx0XHRcdC8vVW5peCB0aW1lc3RhbXBcclxuXHRcdFx0XHR0aW1lc3RhbXAgPSBuZXcgRGF0ZSggcGFyc2VGbG9hdChkYXRlKSoxMDAwICk7XHJcblx0XHRcdH0gZWxzZSBpZihkYXRlLmNvbnN0cnVjdG9yID09PSBEYXRlKSB7XHJcblx0XHRcdFx0dGltZXN0YW1wID0gZGF0ZTtcclxuXHRcdFx0XHQvLyBNaWNyb3NvZnQgZGF0ZSBmb3JtYXQgc3VwcG9ydFxyXG5cdFx0XHR9IGVsc2UgaWYoIG1zTWF0Y2ggIT09IG51bGwgKSB7XHJcblx0XHRcdFx0dGltZXN0YW1wID0gbmV3IERhdGUocGFyc2VJbnQobXNNYXRjaFsxXSwgMTApKTtcclxuXHRcdFx0XHRpZiAobXNNYXRjaFszXSkge1xyXG5cdFx0XHRcdFx0dmFyIG9mZnNldCA9IE51bWJlcihtc01hdGNoWzVdKSAqIDYwICsgTnVtYmVyKG1zTWF0Y2hbNl0pO1xyXG5cdFx0XHRcdFx0b2Zmc2V0ICo9ICgobXNNYXRjaFs0XSA9PT0gJy0nKSA/IDEgOiAtMSk7XHJcblx0XHRcdFx0XHRvZmZzZXQgLT0gdGltZXN0YW1wLmdldFRpbWV6b25lT2Zmc2V0KCk7XHJcblx0XHRcdFx0XHR0aW1lc3RhbXAuc2V0VGltZShOdW1iZXIoTnVtYmVyKHRpbWVzdGFtcCkgKyAob2Zmc2V0ICogNjAgKiAxMDAwKSkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR2YXIgb2Zmc2V0ID0gMDtcclxuXHRcdFx0XHQvL1N1cHBvcnQgSVNPODYwMUxvbmcgdGhhdCBoYXZlIFogYXQgdGhlIGVuZCB0byBpbmRpY2F0ZSBVVEMgdGltZXpvbmVcclxuXHRcdFx0XHRpZihvcHRzLnNyY2Zvcm1hdCA9PT0gJ0lTTzg2MDFMb25nJyAmJiBkYXRlLmNoYXJBdChkYXRlLmxlbmd0aCAtIDEpID09PSAnWicpIHtcclxuXHRcdFx0XHRcdG9mZnNldCAtPSAobmV3IERhdGUoKSkuZ2V0VGltZXpvbmVPZmZzZXQoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZGF0ZSA9IFN0cmluZyhkYXRlKS5yZXBsYWNlKC9cXFQvZyxcIiNcIikucmVwbGFjZSgvXFx0LyxcIiVcIikuc3BsaXQob3B0cy5wYXJzZVJlKTtcclxuXHRcdFx0XHRmb3JtYXQgPSBmb3JtYXQucmVwbGFjZSgvXFxUL2csXCIjXCIpLnJlcGxhY2UoL1xcdC8sXCIlXCIpLnNwbGl0KG9wdHMucGFyc2VSZSk7XHJcblx0XHRcdFx0Ly8gcGFyc2luZyBmb3IgbW9udGggbmFtZXNcclxuXHRcdFx0XHRmb3Ioaz0wLGhsPWZvcm1hdC5sZW5ndGg7azxobDtrKyspe1xyXG5cdFx0XHRcdFx0aWYoZm9ybWF0W2tdID09PSAnTScpIHtcclxuXHRcdFx0XHRcdFx0ZE0gPSAkLmluQXJyYXkoZGF0ZVtrXSxvcHRzLm1vbnRoTmFtZXMpO1xyXG5cdFx0XHRcdFx0XHRpZihkTSAhPT0gLTEgJiYgZE0gPCAxMil7ZGF0ZVtrXSA9IGRNKzE7IHRzLm0gPSBkYXRlW2tdO31cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKGZvcm1hdFtrXSA9PT0gJ0YnKSB7XHJcblx0XHRcdFx0XHRcdGRNID0gJC5pbkFycmF5KGRhdGVba10sb3B0cy5tb250aE5hbWVzLDEyKTtcclxuXHRcdFx0XHRcdFx0aWYoZE0gIT09IC0xICYmIGRNID4gMTEpe2RhdGVba10gPSBkTSsxLTEyOyB0cy5tID0gZGF0ZVtrXTt9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZihmb3JtYXRba10gPT09ICdhJykge1xyXG5cdFx0XHRcdFx0XHRkTSA9ICQuaW5BcnJheShkYXRlW2tdLG9wdHMuQW1QbSk7XHJcblx0XHRcdFx0XHRcdGlmKGRNICE9PSAtMSAmJiBkTSA8IDIgJiYgZGF0ZVtrXSA9PT0gb3B0cy5BbVBtW2RNXSl7XHJcblx0XHRcdFx0XHRcdFx0ZGF0ZVtrXSA9IGRNO1xyXG5cdFx0XHRcdFx0XHRcdHRzLmggPSBoMTJ0bzI0KGRhdGVba10sIHRzLmgpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZihmb3JtYXRba10gPT09ICdBJykge1xyXG5cdFx0XHRcdFx0XHRkTSA9ICQuaW5BcnJheShkYXRlW2tdLG9wdHMuQW1QbSk7XHJcblx0XHRcdFx0XHRcdGlmKGRNICE9PSAtMSAmJiBkTSA+IDEgJiYgZGF0ZVtrXSA9PT0gb3B0cy5BbVBtW2RNXSl7XHJcblx0XHRcdFx0XHRcdFx0ZGF0ZVtrXSA9IGRNLTI7XHJcblx0XHRcdFx0XHRcdFx0dHMuaCA9IGgxMnRvMjQoZGF0ZVtrXSwgdHMuaCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmIChmb3JtYXRba10gPT09ICdnJykge1xyXG5cdFx0XHRcdFx0XHR0cy5oID0gcGFyc2VJbnQoZGF0ZVtrXSwgMTApO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYoZGF0ZVtrXSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdHRzW2Zvcm1hdFtrXS50b0xvd2VyQ2FzZSgpXSA9IHBhcnNlSW50KGRhdGVba10sMTApO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZih0cy5mKSB7dHMubSA9IHRzLmY7fVxyXG5cdFx0XHRcdGlmKCB0cy5tID09PSAwICYmIHRzLnkgPT09IDAgJiYgdHMuZCA9PT0gMCkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIFwiJiMxNjA7XCIgO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0cy5tID0gcGFyc2VJbnQodHMubSwxMCktMTtcclxuXHRcdFx0XHR2YXIgdHkgPSB0cy55O1xyXG5cdFx0XHRcdGlmICh0eSA+PSA3MCAmJiB0eSA8PSA5OSkge3RzLnkgPSAxOTAwK3RzLnk7fVxyXG5cdFx0XHRcdGVsc2UgaWYgKHR5ID49MCAmJiB0eSA8PTY5KSB7dHMueT0gMjAwMCt0cy55O31cclxuXHRcdFx0XHR0aW1lc3RhbXAgPSBuZXcgRGF0ZSh0cy55LCB0cy5tLCB0cy5kLCB0cy5oLCB0cy5pLCB0cy5zLCB0cy51KTtcclxuXHRcdFx0XHQvL0FwcGx5IG9mZnNldCB0byBzaG93IGRhdGUgYXMgbG9jYWwgdGltZS5cclxuXHRcdFx0XHRpZihvZmZzZXQgPiAwKSB7XHJcblx0XHRcdFx0XHR0aW1lc3RhbXAuc2V0VGltZShOdW1iZXIoTnVtYmVyKHRpbWVzdGFtcCkgKyAob2Zmc2V0ICogNjAgKiAxMDAwKSkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGltZXN0YW1wID0gbmV3IERhdGUodHMueSwgdHMubSwgdHMuZCwgdHMuaCwgdHMuaSwgdHMucywgdHMudSk7XHJcblx0XHR9XHJcblx0XHRpZiggbmV3Zm9ybWF0ID09PSB1bmRlZmluZWQgKSB7XHJcblx0XHRcdHJldHVybiB0aW1lc3RhbXA7XHJcblx0XHR9XHJcblx0XHRpZiggb3B0cy5tYXNrcy5oYXNPd25Qcm9wZXJ0eShuZXdmb3JtYXQpICkgIHtcclxuXHRcdFx0bmV3Zm9ybWF0ID0gb3B0cy5tYXNrc1tuZXdmb3JtYXRdO1xyXG5cdFx0fSBlbHNlIGlmICggIW5ld2Zvcm1hdCApIHtcclxuXHRcdFx0bmV3Zm9ybWF0ID0gJ1ktbS1kJztcclxuXHRcdH1cclxuXHRcdHZhclxyXG5cdFx0XHRHID0gdGltZXN0YW1wLmdldEhvdXJzKCksXHJcblx0XHRcdGkgPSB0aW1lc3RhbXAuZ2V0TWludXRlcygpLFxyXG5cdFx0XHRqID0gdGltZXN0YW1wLmdldERhdGUoKSxcclxuXHRcdFx0biA9IHRpbWVzdGFtcC5nZXRNb250aCgpICsgMSxcclxuXHRcdFx0byA9IHRpbWVzdGFtcC5nZXRUaW1lem9uZU9mZnNldCgpLFxyXG5cdFx0XHRzID0gdGltZXN0YW1wLmdldFNlY29uZHMoKSxcclxuXHRcdFx0dSA9IHRpbWVzdGFtcC5nZXRNaWxsaXNlY29uZHMoKSxcclxuXHRcdFx0dyA9IHRpbWVzdGFtcC5nZXREYXkoKSxcclxuXHRcdFx0WSA9IHRpbWVzdGFtcC5nZXRGdWxsWWVhcigpLFxyXG5cdFx0XHROID0gKHcgKyA2KSAlIDcgKyAxLFxyXG5cdFx0XHR6ID0gKG5ldyBEYXRlKFksIG4gLSAxLCBqKSAtIG5ldyBEYXRlKFksIDAsIDEpKSAvIDg2NDAwMDAwLFxyXG5cdFx0XHRmbGFncyA9IHtcclxuXHRcdFx0XHQvLyBEYXlcclxuXHRcdFx0XHRkOiBwYWQoaiksXHJcblx0XHRcdFx0RDogb3B0cy5kYXlOYW1lc1t3XSxcclxuXHRcdFx0XHRqOiBqLFxyXG5cdFx0XHRcdGw6IG9wdHMuZGF5TmFtZXNbdyArIDddLFxyXG5cdFx0XHRcdE46IE4sXHJcblx0XHRcdFx0Uzogb3B0cy5TKGopLFxyXG5cdFx0XHRcdC8vaiA8IDExIHx8IGogPiAxMyA/IFsnc3QnLCAnbmQnLCAncmQnLCAndGgnXVtNYXRoLm1pbigoaiAtIDEpICUgMTAsIDMpXSA6ICd0aCcsXHJcblx0XHRcdFx0dzogdyxcclxuXHRcdFx0XHR6OiB6LFxyXG5cdFx0XHRcdC8vIFdlZWtcclxuXHRcdFx0XHRXOiBOIDwgNSA/IE1hdGguZmxvb3IoKHogKyBOIC0gMSkgLyA3KSArIDEgOiBNYXRoLmZsb29yKCh6ICsgTiAtIDEpIC8gNykgfHwgKChuZXcgRGF0ZShZIC0gMSwgMCwgMSkuZ2V0RGF5KCkgKyA2KSAlIDcgPCA0ID8gNTMgOiA1MiksXHJcblx0XHRcdFx0Ly8gTW9udGhcclxuXHRcdFx0XHRGOiBvcHRzLm1vbnRoTmFtZXNbbiAtIDEgKyAxMl0sXHJcblx0XHRcdFx0bTogcGFkKG4pLFxyXG5cdFx0XHRcdE06IG9wdHMubW9udGhOYW1lc1tuIC0gMV0sXHJcblx0XHRcdFx0bjogbixcclxuXHRcdFx0XHR0OiAnPycsXHJcblx0XHRcdFx0Ly8gWWVhclxyXG5cdFx0XHRcdEw6ICc/JyxcclxuXHRcdFx0XHRvOiAnPycsXHJcblx0XHRcdFx0WTogWSxcclxuXHRcdFx0XHR5OiBTdHJpbmcoWSkuc3Vic3RyaW5nKDIpLFxyXG5cdFx0XHRcdC8vIFRpbWVcclxuXHRcdFx0XHRhOiBHIDwgMTIgPyBvcHRzLkFtUG1bMF0gOiBvcHRzLkFtUG1bMV0sXHJcblx0XHRcdFx0QTogRyA8IDEyID8gb3B0cy5BbVBtWzJdIDogb3B0cy5BbVBtWzNdLFxyXG5cdFx0XHRcdEI6ICc/JyxcclxuXHRcdFx0XHRnOiBHICUgMTIgfHwgMTIsXHJcblx0XHRcdFx0RzogRyxcclxuXHRcdFx0XHRoOiBwYWQoRyAlIDEyIHx8IDEyKSxcclxuXHRcdFx0XHRIOiBwYWQoRyksXHJcblx0XHRcdFx0aTogcGFkKGkpLFxyXG5cdFx0XHRcdHM6IHBhZChzKSxcclxuXHRcdFx0XHR1OiB1LFxyXG5cdFx0XHRcdC8vIFRpbWV6b25lXHJcblx0XHRcdFx0ZTogJz8nLFxyXG5cdFx0XHRcdEk6ICc/JyxcclxuXHRcdFx0XHRPOiAobyA+IDAgPyBcIi1cIiA6IFwiK1wiKSArIHBhZChNYXRoLmZsb29yKE1hdGguYWJzKG8pIC8gNjApICogMTAwICsgTWF0aC5hYnMobykgJSA2MCwgNCksXHJcblx0XHRcdFx0UDogJz8nLFxyXG5cdFx0XHRcdFQ6IChTdHJpbmcodGltZXN0YW1wKS5tYXRjaCh0aW1lem9uZSkgfHwgW1wiXCJdKS5wb3AoKS5yZXBsYWNlKHRpbWV6b25lQ2xpcCwgXCJcIiksXHJcblx0XHRcdFx0WjogJz8nLFxyXG5cdFx0XHRcdC8vIEZ1bGwgRGF0ZS9UaW1lXHJcblx0XHRcdFx0YzogJz8nLFxyXG5cdFx0XHRcdHI6ICc/JyxcclxuXHRcdFx0XHRVOiBNYXRoLmZsb29yKHRpbWVzdGFtcCAvIDEwMDApXHJcblx0XHRcdH07XHJcblx0XHRyZXR1cm4gbmV3Zm9ybWF0LnJlcGxhY2UodG9rZW4sIGZ1bmN0aW9uICgkMCkge1xyXG5cdFx0XHRyZXR1cm4gZmxhZ3MuaGFzT3duUHJvcGVydHkoJDApID8gZmxhZ3NbJDBdIDogJDAuc3Vic3RyaW5nKDEpO1xyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRqcUlEIDogZnVuY3Rpb24oc2lkKXtcclxuXHRcdHJldHVybiBTdHJpbmcoc2lkKS5yZXBsYWNlKC9bIVwiIyQlJicoKSorLC5cXC86OyA8PT4/QFxcW1xcXFxcXF1cXF5ge3x9fl0vZyxcIlxcXFwkJlwiKTtcclxuXHR9LFxyXG5cdGd1aWQgOiAxLFxyXG5cdHVpZFByZWY6ICdqcWcnLFxyXG5cdHJhbmRJZCA6IGZ1bmN0aW9uKCBwcmVmaXggKVx0e1xyXG5cdFx0cmV0dXJuIChwcmVmaXggfHwgJC5qZ3JpZC51aWRQcmVmKSArICgkLmpncmlkLmd1aWQrKyk7XHJcblx0fSxcclxuXHRnZXRBY2Nlc3NvciA6IGZ1bmN0aW9uKG9iaiwgZXhwcikge1xyXG5cdFx0dmFyIHJldCxwLHBybSA9IFtdLCBpO1xyXG5cdFx0aWYoIHR5cGVvZiBleHByID09PSAnZnVuY3Rpb24nKSB7IHJldHVybiBleHByKG9iaik7IH1cclxuXHRcdHJldCA9IG9ialtleHByXTtcclxuXHRcdGlmKHJldD09PXVuZGVmaW5lZCkge1xyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGlmICggdHlwZW9mIGV4cHIgPT09ICdzdHJpbmcnICkge1xyXG5cdFx0XHRcdFx0cHJtID0gZXhwci5zcGxpdCgnLicpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpID0gcHJtLmxlbmd0aDtcclxuXHRcdFx0XHRpZiggaSApIHtcclxuXHRcdFx0XHRcdHJldCA9IG9iajtcclxuXHRcdFx0XHRcdHdoaWxlIChyZXQgJiYgaS0tKSB7XHJcblx0XHRcdFx0XHRcdHAgPSBwcm0uc2hpZnQoKTtcclxuXHRcdFx0XHRcdFx0cmV0ID0gcmV0W3BdO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBjYXRjaCAoZSkge31cclxuXHRcdH1cclxuXHRcdHJldHVybiByZXQ7XHJcblx0fSxcclxuXHRnZXRYbWxEYXRhOiBmdW5jdGlvbiAob2JqLCBleHByLCByZXR1cm5PYmopIHtcclxuXHRcdHZhciByZXQsIG0gPSB0eXBlb2YgZXhwciA9PT0gJ3N0cmluZycgPyBleHByLm1hdGNoKC9eKC4qKVxcWyhcXHcrKVxcXSQvKSA6IG51bGw7XHJcblx0XHRpZiAodHlwZW9mIGV4cHIgPT09ICdmdW5jdGlvbicpIHsgcmV0dXJuIGV4cHIob2JqKTsgfVxyXG5cdFx0aWYgKG0gJiYgbVsyXSkge1xyXG5cdFx0XHQvLyBtWzJdIGlzIHRoZSBhdHRyaWJ1dGUgc2VsZWN0b3JcclxuXHRcdFx0Ly8gbVsxXSBpcyBhbiBvcHRpb25hbCBlbGVtZW50IHNlbGVjdG9yXHJcblx0XHRcdC8vIGV4YW1wbGVzOiBcIltpZF1cIiwgXCJyb3dzW3BhZ2VdXCJcclxuXHRcdFx0cmV0dXJuIG1bMV0gPyAkKG1bMV0sIG9iaikuYXR0cihtWzJdKSA6ICQob2JqKS5hdHRyKG1bMl0pO1xyXG5cdFx0fVxyXG5cdFx0XHRyZXQgPSAkKGV4cHIsIG9iaik7XHJcblx0XHRcdGlmIChyZXR1cm5PYmopIHsgcmV0dXJuIHJldDsgfVxyXG5cdFx0XHQvLyQoZXhwciwgb2JqKS5maWx0ZXIoJzpsYXN0Jyk7IC8vIHdlIHVzZSAnOmxhc3QnIHRvIGJlIG1vcmUgY29tcGF0aWJsZSB3aXRoIG9sZCB2ZXJzaW9uIG9mIGpxR3JpZFxyXG5cdFx0XHRyZXR1cm4gcmV0Lmxlbmd0aCA+IDAgPyAkKHJldCkudGV4dCgpIDogdW5kZWZpbmVkO1xyXG5cdH0sXHJcblx0Y2VsbFdpZHRoIDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyICR0ZXN0RGl2ID0gJChcIjxkaXYgY2xhc3M9J3VpLWpxZ3JpZCcgc3R5bGU9J2xlZnQ6MTAwMDBweCc+PHRhYmxlIGNsYXNzPSd1aS1qcWdyaWQtYnRhYmxlJyBzdHlsZT0nd2lkdGg6NXB4Oyc+PHRyIGNsYXNzPSdqcWdyb3cnPjx0ZCBzdHlsZT0nd2lkdGg6NXB4O2Rpc3BsYXk6YmxvY2s7Jz48L3RkPjwvdHI+PC90YWJsZT48L2Rpdj5cIiksXHJcblx0XHR0ZXN0Q2VsbCA9ICR0ZXN0RGl2LmFwcGVuZFRvKFwiYm9keVwiKVxyXG5cdFx0XHQuZmluZChcInRkXCIpXHJcblx0XHRcdC53aWR0aCgpO1xyXG5cdFx0JHRlc3REaXYucmVtb3ZlKCk7XHJcblx0XHRyZXR1cm4gTWF0aC5hYnModGVzdENlbGwtNSkgPiAwLjE7XHJcblx0fSxcclxuXHRjZWxsX3dpZHRoIDogdHJ1ZSxcclxuXHRhamF4T3B0aW9uczoge30sXHJcblx0ZnJvbSA6IGZ1bmN0aW9uKHNvdXJjZSl7XHJcblx0XHQvLyBPcmlnaW5hbCBBdXRob3IgSHVnbyBCb25hY2NpXHJcblx0XHQvLyBMaWNlbnNlIE1JVCBodHRwOi8vamxpbnEuY29kZXBsZXguY29tL2xpY2Vuc2VcclxuXHRcdHZhciBRdWVyeU9iamVjdD1mdW5jdGlvbihkLHEpe1xyXG5cdFx0aWYodHlwZW9mIGQ9PT1cInN0cmluZ1wiKXtcclxuXHRcdFx0ZD0kLmRhdGEoZCk7XHJcblx0XHR9XHJcblx0XHR2YXIgc2VsZj10aGlzLFxyXG5cdFx0X2RhdGE9ZCxcclxuXHRcdF91c2VjYXNlPXRydWUsXHJcblx0XHRfdHJpbT1mYWxzZSxcclxuXHRcdF9xdWVyeT1xLFxyXG5cdFx0X3N0cmlwTnVtID0gL1tcXCQsJV0vZyxcclxuXHRcdF9sYXN0Q29tbWFuZD1udWxsLFxyXG5cdFx0X2xhc3RGaWVsZD1udWxsLFxyXG5cdFx0X29yRGVwdGg9MCxcclxuXHRcdF9uZWdhdGU9ZmFsc2UsXHJcblx0XHRfcXVldWVkT3BlcmF0b3I9XCJcIixcclxuXHRcdF9zb3J0aW5nPVtdLFxyXG5cdFx0X3VzZVByb3BlcnRpZXM9dHJ1ZTtcclxuXHRcdGlmKHR5cGVvZiBkPT09XCJvYmplY3RcIiYmZC5wdXNoKSB7XHJcblx0XHRcdGlmKGQubGVuZ3RoPjApe1xyXG5cdFx0XHRcdGlmKHR5cGVvZiBkWzBdIT09XCJvYmplY3RcIil7XHJcblx0XHRcdFx0XHRfdXNlUHJvcGVydGllcz1mYWxzZTtcclxuXHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdF91c2VQcm9wZXJ0aWVzPXRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0dGhyb3cgXCJkYXRhIHByb3ZpZGVzIGlzIG5vdCBhbiBhcnJheVwiO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5faGFzRGF0YT1mdW5jdGlvbigpe1xyXG5cdFx0XHRyZXR1cm4gX2RhdGE9PT1udWxsP2ZhbHNlOl9kYXRhLmxlbmd0aD09PTA/ZmFsc2U6dHJ1ZTtcclxuXHRcdH07XHJcblx0XHR0aGlzLl9nZXRTdHI9ZnVuY3Rpb24ocyl7XHJcblx0XHRcdHZhciBwaHJhc2U9W107XHJcblx0XHRcdGlmKF90cmltKXtcclxuXHRcdFx0XHRwaHJhc2UucHVzaChcImpRdWVyeS50cmltKFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRwaHJhc2UucHVzaChcIlN0cmluZyhcIitzK1wiKVwiKTtcclxuXHRcdFx0aWYoX3RyaW0pe1xyXG5cdFx0XHRcdHBocmFzZS5wdXNoKFwiKVwiKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZighX3VzZWNhc2Upe1xyXG5cdFx0XHRcdHBocmFzZS5wdXNoKFwiLnRvTG93ZXJDYXNlKClcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHBocmFzZS5qb2luKFwiXCIpO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuX3N0ckNvbXA9ZnVuY3Rpb24odmFsKXtcclxuXHRcdFx0aWYodHlwZW9mIHZhbD09PVwic3RyaW5nXCIpe1xyXG5cdFx0XHRcdHJldHVyblwiLnRvU3RyaW5nKClcIjtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm5cIlwiO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuX2dyb3VwPWZ1bmN0aW9uKGYsdSl7XHJcblx0XHRcdHJldHVybih7ZmllbGQ6Zi50b1N0cmluZygpLHVuaXF1ZTp1LGl0ZW1zOltdfSk7XHJcblx0XHR9O1xyXG5cdFx0dGhpcy5fdG9TdHI9ZnVuY3Rpb24ocGhyYXNlKXtcclxuXHRcdFx0aWYoX3RyaW0pe1xyXG5cdFx0XHRcdHBocmFzZT0kLnRyaW0ocGhyYXNlKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRwaHJhc2U9cGhyYXNlLnRvU3RyaW5nKCkucmVwbGFjZSgvXFxcXC9nLCdcXFxcXFxcXCcpLnJlcGxhY2UoL1xcXCIvZywnXFxcXFwiJyk7XHJcblx0XHRcdHJldHVybiBfdXNlY2FzZSA/IHBocmFzZSA6IHBocmFzZS50b0xvd2VyQ2FzZSgpO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuX2Z1bmNMb29wPWZ1bmN0aW9uKGZ1bmMpe1xyXG5cdFx0XHR2YXIgcmVzdWx0cz1bXTtcclxuXHRcdFx0JC5lYWNoKF9kYXRhLGZ1bmN0aW9uKGksdil7XHJcblx0XHRcdFx0cmVzdWx0cy5wdXNoKGZ1bmModikpO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0cmV0dXJuIHJlc3VsdHM7XHJcblx0XHR9O1xyXG5cdFx0dGhpcy5fYXBwZW5kPWZ1bmN0aW9uKHMpe1xyXG5cdFx0XHR2YXIgaTtcclxuXHRcdFx0aWYoX3F1ZXJ5PT09bnVsbCl7XHJcblx0XHRcdFx0X3F1ZXJ5PVwiXCI7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0X3F1ZXJ5Kz1fcXVldWVkT3BlcmF0b3IgPT09IFwiXCIgPyBcIiAmJiBcIiA6X3F1ZXVlZE9wZXJhdG9yO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZvciAoaT0wO2k8X29yRGVwdGg7aSsrKXtcclxuXHRcdFx0XHRfcXVlcnkrPVwiKFwiO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKF9uZWdhdGUpe1xyXG5cdFx0XHRcdF9xdWVyeSs9XCIhXCI7XHJcblx0XHRcdH1cclxuXHRcdFx0X3F1ZXJ5Kz1cIihcIitzK1wiKVwiO1xyXG5cdFx0XHRfbmVnYXRlPWZhbHNlO1xyXG5cdFx0XHRfcXVldWVkT3BlcmF0b3I9XCJcIjtcclxuXHRcdFx0X29yRGVwdGg9MDtcclxuXHRcdH07XHJcblx0XHR0aGlzLl9zZXRDb21tYW5kPWZ1bmN0aW9uKGYsYyl7XHJcblx0XHRcdF9sYXN0Q29tbWFuZD1mO1xyXG5cdFx0XHRfbGFzdEZpZWxkPWM7XHJcblx0XHR9O1xyXG5cdFx0dGhpcy5fcmVzZXROZWdhdGU9ZnVuY3Rpb24oKXtcclxuXHRcdFx0X25lZ2F0ZT1mYWxzZTtcclxuXHRcdH07XHJcblx0XHR0aGlzLl9yZXBlYXRDb21tYW5kPWZ1bmN0aW9uKGYsdil7XHJcblx0XHRcdGlmKF9sYXN0Q29tbWFuZD09PW51bGwpe1xyXG5cdFx0XHRcdHJldHVybiBzZWxmO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKGYhPT1udWxsJiZ2IT09bnVsbCl7XHJcblx0XHRcdFx0cmV0dXJuIF9sYXN0Q29tbWFuZChmLHYpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKF9sYXN0RmllbGQ9PT1udWxsKXtcclxuXHRcdFx0XHRyZXR1cm4gX2xhc3RDb21tYW5kKGYpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKCFfdXNlUHJvcGVydGllcyl7XHJcblx0XHRcdFx0cmV0dXJuIF9sYXN0Q29tbWFuZChmKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gX2xhc3RDb21tYW5kKF9sYXN0RmllbGQsZik7XHJcblx0XHR9O1xyXG5cdFx0dGhpcy5fZXF1YWxzPWZ1bmN0aW9uKGEsYil7XHJcblx0XHRcdHJldHVybihzZWxmLl9jb21wYXJlKGEsYiwxKT09PTApO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuX2NvbXBhcmU9ZnVuY3Rpb24oYSxiLGQpe1xyXG5cdFx0XHR2YXIgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xyXG5cdFx0XHRpZiggZCA9PT0gdW5kZWZpbmVkKSB7IGQgPSAxOyB9XHJcblx0XHRcdGlmKGE9PT11bmRlZmluZWQpIHsgYSA9IG51bGw7IH1cclxuXHRcdFx0aWYoYj09PXVuZGVmaW5lZCkgeyBiID0gbnVsbDsgfVxyXG5cdFx0XHRpZihhPT09bnVsbCAmJiBiPT09bnVsbCl7XHJcblx0XHRcdFx0cmV0dXJuIDA7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoYT09PW51bGwmJmIhPT1udWxsKXtcclxuXHRcdFx0XHRyZXR1cm4gMTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZihhIT09bnVsbCYmYj09PW51bGwpe1xyXG5cdFx0XHRcdHJldHVybiAtMTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAodG9TdHJpbmcuY2FsbChhKSA9PT0gJ1tvYmplY3QgRGF0ZV0nICYmIHRvU3RyaW5nLmNhbGwoYikgPT09ICdbb2JqZWN0IERhdGVdJykge1xyXG5cdFx0XHRcdGlmIChhIDwgYikgeyByZXR1cm4gLWQ7IH1cclxuXHRcdFx0XHRpZiAoYSA+IGIpIHsgcmV0dXJuIGQ7IH1cclxuXHRcdFx0XHRyZXR1cm4gMDtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZighX3VzZWNhc2UgJiYgdHlwZW9mIGEgIT09IFwibnVtYmVyXCIgJiYgdHlwZW9mIGIgIT09IFwibnVtYmVyXCIgKSB7XHJcblx0XHRcdFx0YT1TdHJpbmcoYSk7XHJcblx0XHRcdFx0Yj1TdHJpbmcoYik7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoYTxiKXtyZXR1cm4gLWQ7fVxyXG5cdFx0XHRpZihhPmIpe3JldHVybiBkO31cclxuXHRcdFx0cmV0dXJuIDA7XHJcblx0XHR9O1xyXG5cdFx0dGhpcy5fcGVyZm9ybVNvcnQ9ZnVuY3Rpb24oKXtcclxuXHRcdFx0aWYoX3NvcnRpbmcubGVuZ3RoPT09MCl7cmV0dXJuO31cclxuXHRcdFx0X2RhdGE9c2VsZi5fZG9Tb3J0KF9kYXRhLDApO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuX2RvU29ydD1mdW5jdGlvbihkLHEpe1xyXG5cdFx0XHR2YXIgYnk9X3NvcnRpbmdbcV0uYnksXHJcblx0XHRcdGRpcj1fc29ydGluZ1txXS5kaXIsXHJcblx0XHRcdHR5cGUgPSBfc29ydGluZ1txXS50eXBlLFxyXG5cdFx0XHRkZm10ID0gX3NvcnRpbmdbcV0uZGF0ZWZtdCxcclxuXHRcdFx0c2Z1bmMgPSBfc29ydGluZ1txXS5zZnVuYztcclxuXHRcdFx0aWYocT09PV9zb3J0aW5nLmxlbmd0aC0xKXtcclxuXHRcdFx0XHRyZXR1cm4gc2VsZi5fZ2V0T3JkZXIoZCwgYnksIGRpciwgdHlwZSwgZGZtdCwgc2Z1bmMpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHErKztcclxuXHRcdFx0dmFyIHZhbHVlcz1zZWxmLl9nZXRHcm91cChkLGJ5LGRpcix0eXBlLGRmbXQpLCByZXN1bHRzPVtdLCBpLCBqLCBzb3J0ZWQ7XHJcblx0XHRcdGZvcihpPTA7aTx2YWx1ZXMubGVuZ3RoO2krKyl7XHJcblx0XHRcdFx0c29ydGVkPXNlbGYuX2RvU29ydCh2YWx1ZXNbaV0uaXRlbXMscSk7XHJcblx0XHRcdFx0Zm9yKGo9MDtqPHNvcnRlZC5sZW5ndGg7aisrKXtcclxuXHRcdFx0XHRcdHJlc3VsdHMucHVzaChzb3J0ZWRbal0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gcmVzdWx0cztcclxuXHRcdH07XHJcblx0XHR0aGlzLl9nZXRPcmRlcj1mdW5jdGlvbihkYXRhLGJ5LGRpcix0eXBlLCBkZm10LCBzZnVuYyl7XHJcblx0XHRcdHZhciBzb3J0RGF0YT1bXSxfc29ydERhdGE9W10sIG5ld0RpciA9IGRpcj09PVwiYVwiID8gMSA6IC0xLCBpLGFiLGosXHJcblx0XHRcdGZpbmRTb3J0S2V5O1xyXG5cclxuXHRcdFx0aWYodHlwZSA9PT0gdW5kZWZpbmVkICkgeyB0eXBlID0gXCJ0ZXh0XCI7IH1cclxuXHRcdFx0aWYgKHR5cGUgPT09ICdmbG9hdCcgfHwgdHlwZT09PSAnbnVtYmVyJyB8fCB0eXBlPT09ICdjdXJyZW5jeScgfHwgdHlwZT09PSAnbnVtZXJpYycpIHtcclxuXHRcdFx0XHRmaW5kU29ydEtleSA9IGZ1bmN0aW9uKCRjZWxsKSB7XHJcblx0XHRcdFx0XHR2YXIga2V5ID0gcGFyc2VGbG9hdCggU3RyaW5nKCRjZWxsKS5yZXBsYWNlKF9zdHJpcE51bSwgJycpKTtcclxuXHRcdFx0XHRcdHJldHVybiBpc05hTihrZXkpID8gMC4wMCA6IGtleTtcclxuXHRcdFx0XHR9O1xyXG5cdFx0XHR9IGVsc2UgaWYgKHR5cGU9PT0naW50JyB8fCB0eXBlPT09J2ludGVnZXInKSB7XHJcblx0XHRcdFx0ZmluZFNvcnRLZXkgPSBmdW5jdGlvbigkY2VsbCkge1xyXG5cdFx0XHRcdFx0cmV0dXJuICRjZWxsID8gcGFyc2VGbG9hdChTdHJpbmcoJGNlbGwpLnJlcGxhY2UoX3N0cmlwTnVtLCAnJykpIDogMDtcclxuXHRcdFx0XHR9O1xyXG5cdFx0XHR9IGVsc2UgaWYodHlwZSA9PT0gJ2RhdGUnIHx8IHR5cGUgPT09ICdkYXRldGltZScpIHtcclxuXHRcdFx0XHRmaW5kU29ydEtleSA9IGZ1bmN0aW9uKCRjZWxsKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gJC5qZ3JpZC5wYXJzZURhdGUoZGZtdCwkY2VsbCkuZ2V0VGltZSgpO1xyXG5cdFx0XHRcdH07XHJcblx0XHRcdH0gZWxzZSBpZigkLmlzRnVuY3Rpb24odHlwZSkpIHtcclxuXHRcdFx0XHRmaW5kU29ydEtleSA9IHR5cGU7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0ZmluZFNvcnRLZXkgPSBmdW5jdGlvbigkY2VsbCkge1xyXG5cdFx0XHRcdFx0JGNlbGwgPSAkY2VsbCA/ICQudHJpbShTdHJpbmcoJGNlbGwpKSA6IFwiXCI7XHJcblx0XHRcdFx0XHRyZXR1cm4gX3VzZWNhc2UgPyAkY2VsbCA6ICRjZWxsLnRvTG93ZXJDYXNlKCk7XHJcblx0XHRcdFx0fTtcclxuXHRcdFx0fVxyXG5cdFx0XHQkLmVhY2goZGF0YSxmdW5jdGlvbihpLHYpe1xyXG5cdFx0XHRcdGFiID0gYnkhPT1cIlwiID8gJC5qZ3JpZC5nZXRBY2Nlc3Nvcih2LGJ5KSA6IHY7XHJcblx0XHRcdFx0aWYoYWIgPT09IHVuZGVmaW5lZCkgeyBhYiA9IFwiXCI7IH1cclxuXHRcdFx0XHRhYiA9IGZpbmRTb3J0S2V5KGFiLCB2KTtcclxuXHRcdFx0XHRfc29ydERhdGEucHVzaCh7ICd2U29ydCc6IGFiLCdpbmRleCc6aX0pO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0aWYoJC5pc0Z1bmN0aW9uKHNmdW5jKSkge1xyXG5cdFx0XHRcdF9zb3J0RGF0YS5zb3J0KGZ1bmN0aW9uKGEsYil7XHJcblx0XHRcdFx0XHRhID0gYS52U29ydDtcclxuXHRcdFx0XHRcdGIgPSBiLnZTb3J0O1xyXG5cdFx0XHRcdFx0cmV0dXJuIHNmdW5jLmNhbGwodGhpcyxhLGIsbmV3RGlyKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRfc29ydERhdGEuc29ydChmdW5jdGlvbihhLGIpe1xyXG5cdFx0XHRcdFx0YSA9IGEudlNvcnQ7XHJcblx0XHRcdFx0XHRiID0gYi52U29ydDtcclxuXHRcdFx0XHRcdHJldHVybiBzZWxmLl9jb21wYXJlKGEsYixuZXdEaXIpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGo9MDtcclxuXHRcdFx0dmFyIG5yZWM9IGRhdGEubGVuZ3RoO1xyXG5cdFx0XHQvLyBvdmVyaGVhZCwgYnV0IHdlIGRvIG5vdCBjaGFuZ2UgdGhlIG9yaWdpbmFsIGRhdGEuXHJcblx0XHRcdHdoaWxlKGo8bnJlYykge1xyXG5cdFx0XHRcdGkgPSBfc29ydERhdGFbal0uaW5kZXg7XHJcblx0XHRcdFx0c29ydERhdGEucHVzaChkYXRhW2ldKTtcclxuXHRcdFx0XHRqKys7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHNvcnREYXRhO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuX2dldEdyb3VwPWZ1bmN0aW9uKGRhdGEsYnksZGlyLHR5cGUsIGRmbXQpe1xyXG5cdFx0XHR2YXIgcmVzdWx0cz1bXSxcclxuXHRcdFx0Z3JvdXA9bnVsbCxcclxuXHRcdFx0bGFzdD1udWxsLCB2YWw7XHJcblx0XHRcdCQuZWFjaChzZWxmLl9nZXRPcmRlcihkYXRhLGJ5LGRpcix0eXBlLCBkZm10KSxmdW5jdGlvbihpLHYpe1xyXG5cdFx0XHRcdHZhbCA9ICQuamdyaWQuZ2V0QWNjZXNzb3IodiwgYnkpO1xyXG5cdFx0XHRcdGlmKHZhbCA9PSBudWxsKSB7IHZhbCA9IFwiXCI7IH1cclxuXHRcdFx0XHRpZighc2VsZi5fZXF1YWxzKGxhc3QsdmFsKSl7XHJcblx0XHRcdFx0XHRsYXN0PXZhbDtcclxuXHRcdFx0XHRcdGlmKGdyb3VwICE9PSBudWxsKXtcclxuXHRcdFx0XHRcdFx0cmVzdWx0cy5wdXNoKGdyb3VwKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGdyb3VwPXNlbGYuX2dyb3VwKGJ5LHZhbCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGdyb3VwLml0ZW1zLnB1c2godik7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRpZihncm91cCAhPT0gbnVsbCl7XHJcblx0XHRcdFx0cmVzdWx0cy5wdXNoKGdyb3VwKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gcmVzdWx0cztcclxuXHRcdH07XHJcblx0XHR0aGlzLmlnbm9yZUNhc2U9ZnVuY3Rpb24oKXtcclxuXHRcdFx0X3VzZWNhc2U9ZmFsc2U7XHJcblx0XHRcdHJldHVybiBzZWxmO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMudXNlQ2FzZT1mdW5jdGlvbigpe1xyXG5cdFx0XHRfdXNlY2FzZT10cnVlO1xyXG5cdFx0XHRyZXR1cm4gc2VsZjtcclxuXHRcdH07XHJcblx0XHR0aGlzLnRyaW09ZnVuY3Rpb24oKXtcclxuXHRcdFx0X3RyaW09dHJ1ZTtcclxuXHRcdFx0cmV0dXJuIHNlbGY7XHJcblx0XHR9O1xyXG5cdFx0dGhpcy5ub1RyaW09ZnVuY3Rpb24oKXtcclxuXHRcdFx0X3RyaW09ZmFsc2U7XHJcblx0XHRcdHJldHVybiBzZWxmO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuZXhlY3V0ZT1mdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgbWF0Y2g9X3F1ZXJ5LCByZXN1bHRzPVtdO1xyXG5cdFx0XHRpZihtYXRjaCA9PT0gbnVsbCl7XHJcblx0XHRcdFx0cmV0dXJuIHNlbGY7XHJcblx0XHRcdH1cclxuXHRcdFx0JC5lYWNoKF9kYXRhLGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0aWYoZXZhbChtYXRjaCkpe3Jlc3VsdHMucHVzaCh0aGlzKTt9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRfZGF0YT1yZXN1bHRzO1xyXG5cdFx0XHRyZXR1cm4gc2VsZjtcclxuXHRcdH07XHJcblx0XHR0aGlzLmRhdGE9ZnVuY3Rpb24oKXtcclxuXHRcdFx0cmV0dXJuIF9kYXRhO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuc2VsZWN0PWZ1bmN0aW9uKGYpe1xyXG5cdFx0XHRzZWxmLl9wZXJmb3JtU29ydCgpO1xyXG5cdFx0XHRpZighc2VsZi5faGFzRGF0YSgpKXsgcmV0dXJuW107IH1cclxuXHRcdFx0c2VsZi5leGVjdXRlKCk7XHJcblx0XHRcdGlmKCQuaXNGdW5jdGlvbihmKSl7XHJcblx0XHRcdFx0dmFyIHJlc3VsdHM9W107XHJcblx0XHRcdFx0JC5lYWNoKF9kYXRhLGZ1bmN0aW9uKGksdil7XHJcblx0XHRcdFx0XHRyZXN1bHRzLnB1c2goZih2KSk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIF9kYXRhO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuaGFzTWF0Y2g9ZnVuY3Rpb24oKXtcclxuXHRcdFx0aWYoIXNlbGYuX2hhc0RhdGEoKSkgeyByZXR1cm4gZmFsc2U7IH1cclxuXHRcdFx0c2VsZi5leGVjdXRlKCk7XHJcblx0XHRcdHJldHVybiBfZGF0YS5sZW5ndGg+MDtcclxuXHRcdH07XHJcblx0XHR0aGlzLmFuZE5vdD1mdW5jdGlvbihmLHYseCl7XHJcblx0XHRcdF9uZWdhdGU9IV9uZWdhdGU7XHJcblx0XHRcdHJldHVybiBzZWxmLmFuZChmLHYseCk7XHJcblx0XHR9O1xyXG5cdFx0dGhpcy5vck5vdD1mdW5jdGlvbihmLHYseCl7XHJcblx0XHRcdF9uZWdhdGU9IV9uZWdhdGU7XHJcblx0XHRcdHJldHVybiBzZWxmLm9yKGYsdix4KTtcclxuXHRcdH07XHJcblx0XHR0aGlzLm5vdD1mdW5jdGlvbihmLHYseCl7XHJcblx0XHRcdHJldHVybiBzZWxmLmFuZE5vdChmLHYseCk7XHJcblx0XHR9O1xyXG5cdFx0dGhpcy5hbmQ9ZnVuY3Rpb24oZix2LHgpe1xyXG5cdFx0XHRfcXVldWVkT3BlcmF0b3I9XCIgJiYgXCI7XHJcblx0XHRcdGlmKGY9PT11bmRlZmluZWQpe1xyXG5cdFx0XHRcdHJldHVybiBzZWxmO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBzZWxmLl9yZXBlYXRDb21tYW5kKGYsdix4KTtcclxuXHRcdH07XHJcblx0XHR0aGlzLm9yPWZ1bmN0aW9uKGYsdix4KXtcclxuXHRcdFx0X3F1ZXVlZE9wZXJhdG9yPVwiIHx8IFwiO1xyXG5cdFx0XHRpZihmPT09dW5kZWZpbmVkKSB7IHJldHVybiBzZWxmOyB9XHJcblx0XHRcdHJldHVybiBzZWxmLl9yZXBlYXRDb21tYW5kKGYsdix4KTtcclxuXHRcdH07XHJcblx0XHR0aGlzLm9yQmVnaW49ZnVuY3Rpb24oKXtcclxuXHRcdFx0X29yRGVwdGgrKztcclxuXHRcdFx0cmV0dXJuIHNlbGY7XHJcblx0XHR9O1xyXG5cdFx0dGhpcy5vckVuZD1mdW5jdGlvbigpe1xyXG5cdFx0XHRpZiAoX3F1ZXJ5ICE9PSBudWxsKXtcclxuXHRcdFx0XHRfcXVlcnkrPVwiKVwiO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBzZWxmO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuaXNOb3Q9ZnVuY3Rpb24oZil7XHJcblx0XHRcdF9uZWdhdGU9IV9uZWdhdGU7XHJcblx0XHRcdHJldHVybiBzZWxmLmlzKGYpO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuaXM9ZnVuY3Rpb24oZil7XHJcblx0XHRcdHNlbGYuX2FwcGVuZCgndGhpcy4nK2YpO1xyXG5cdFx0XHRzZWxmLl9yZXNldE5lZ2F0ZSgpO1xyXG5cdFx0XHRyZXR1cm4gc2VsZjtcclxuXHRcdH07XHJcblx0XHR0aGlzLl9jb21wYXJlVmFsdWVzPWZ1bmN0aW9uKGZ1bmMsZix2LGhvdyx0KXtcclxuXHRcdFx0dmFyIGZsZDtcclxuXHRcdFx0aWYoX3VzZVByb3BlcnRpZXMpe1xyXG5cdFx0XHRcdGZsZD0nalF1ZXJ5LmpncmlkLmdldEFjY2Vzc29yKHRoaXMsXFwnJytmKydcXCcpJztcclxuXHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0ZmxkPSd0aGlzJztcclxuXHRcdFx0fVxyXG5cdFx0XHRpZih2PT09dW5kZWZpbmVkKSB7IHYgPSBudWxsOyB9XHJcblx0XHRcdC8vdmFyIHZhbD12PT09bnVsbD9mOnYsXHJcblx0XHRcdHZhciB2YWwgPXYsXHJcblx0XHRcdHN3c3QgPSB0LnN0eXBlID09PSB1bmRlZmluZWQgPyBcInRleHRcIiA6IHQuc3R5cGU7XHJcblx0XHRcdGlmKHYgIT09IG51bGwpIHtcclxuXHRcdFx0c3dpdGNoKHN3c3QpIHtcclxuXHRcdFx0XHRjYXNlICdpbnQnOlxyXG5cdFx0XHRcdGNhc2UgJ2ludGVnZXInOlxyXG5cdFx0XHRcdFx0dmFsID0gKGlzTmFOKE51bWJlcih2YWwpKSB8fCB2YWw9PT1cIlwiKSA/ICcwJyA6IHZhbDsgLy8gVG8gYmUgZml4ZWQgd2l0aCBtb3JlIGludGVsaWdlbnQgY29kZVxyXG5cdFx0XHRcdFx0ZmxkID0gJ3BhcnNlSW50KCcrZmxkKycsMTApJztcclxuXHRcdFx0XHRcdHZhbCA9ICdwYXJzZUludCgnK3ZhbCsnLDEwKSc7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlICdmbG9hdCc6XHJcblx0XHRcdFx0Y2FzZSAnbnVtYmVyJzpcclxuXHRcdFx0XHRjYXNlICdudW1lcmljJzpcclxuXHRcdFx0XHRcdHZhbCA9IFN0cmluZyh2YWwpLnJlcGxhY2UoX3N0cmlwTnVtLCAnJyk7XHJcblx0XHRcdFx0XHR2YWwgPSAoaXNOYU4oTnVtYmVyKHZhbCkpIHx8IHZhbD09PVwiXCIpID8gJzAnIDogdmFsOyAvLyBUbyBiZSBmaXhlZCB3aXRoIG1vcmUgaW50ZWxpZ2VudCBjb2RlXHJcblx0XHRcdFx0XHRmbGQgPSAncGFyc2VGbG9hdCgnK2ZsZCsnKSc7XHJcblx0XHRcdFx0XHR2YWwgPSAncGFyc2VGbG9hdCgnK3ZhbCsnKSc7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlICdkYXRlJzpcclxuXHRcdFx0XHRjYXNlICdkYXRldGltZSc6XHJcblx0XHRcdFx0XHR2YWwgPSBTdHJpbmcoJC5qZ3JpZC5wYXJzZURhdGUodC5uZXdmbXQgfHwgJ1ktbS1kJyx2YWwpLmdldFRpbWUoKSk7XHJcblx0XHRcdFx0XHRmbGQgPSAnalF1ZXJ5LmpncmlkLnBhcnNlRGF0ZShcIicrdC5zcmNmbXQrJ1wiLCcrZmxkKycpLmdldFRpbWUoKSc7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRkZWZhdWx0IDpcclxuXHRcdFx0XHRcdGZsZD1zZWxmLl9nZXRTdHIoZmxkKTtcclxuXHRcdFx0XHRcdHZhbD1zZWxmLl9nZXRTdHIoJ1wiJytzZWxmLl90b1N0cih2YWwpKydcIicpO1xyXG5cdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0c2VsZi5fYXBwZW5kKGZsZCsnICcraG93KycgJyt2YWwpO1xyXG5cdFx0XHRzZWxmLl9zZXRDb21tYW5kKGZ1bmMsZik7XHJcblx0XHRcdHNlbGYuX3Jlc2V0TmVnYXRlKCk7XHJcblx0XHRcdHJldHVybiBzZWxmO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuZXF1YWxzPWZ1bmN0aW9uKGYsdix0KXtcclxuXHRcdFx0cmV0dXJuIHNlbGYuX2NvbXBhcmVWYWx1ZXMoc2VsZi5lcXVhbHMsZix2LFwiPT1cIix0KTtcclxuXHRcdH07XHJcblx0XHR0aGlzLm5vdEVxdWFscz1mdW5jdGlvbihmLHYsdCl7XHJcblx0XHRcdHJldHVybiBzZWxmLl9jb21wYXJlVmFsdWVzKHNlbGYuZXF1YWxzLGYsdixcIiE9PVwiLHQpO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuaXNOdWxsID0gZnVuY3Rpb24oZix2LHQpe1xyXG5cdFx0XHRyZXR1cm4gc2VsZi5fY29tcGFyZVZhbHVlcyhzZWxmLmVxdWFscyxmLG51bGwsXCI9PT1cIix0KTtcclxuXHRcdH07XHJcblx0XHR0aGlzLmdyZWF0ZXI9ZnVuY3Rpb24oZix2LHQpe1xyXG5cdFx0XHRyZXR1cm4gc2VsZi5fY29tcGFyZVZhbHVlcyhzZWxmLmdyZWF0ZXIsZix2LFwiPlwiLHQpO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMubGVzcz1mdW5jdGlvbihmLHYsdCl7XHJcblx0XHRcdHJldHVybiBzZWxmLl9jb21wYXJlVmFsdWVzKHNlbGYubGVzcyxmLHYsXCI8XCIsdCk7XHJcblx0XHR9O1xyXG5cdFx0dGhpcy5ncmVhdGVyT3JFcXVhbHM9ZnVuY3Rpb24oZix2LHQpe1xyXG5cdFx0XHRyZXR1cm4gc2VsZi5fY29tcGFyZVZhbHVlcyhzZWxmLmdyZWF0ZXJPckVxdWFscyxmLHYsXCI+PVwiLHQpO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMubGVzc09yRXF1YWxzPWZ1bmN0aW9uKGYsdix0KXtcclxuXHRcdFx0cmV0dXJuIHNlbGYuX2NvbXBhcmVWYWx1ZXMoc2VsZi5sZXNzT3JFcXVhbHMsZix2LFwiPD1cIix0KTtcclxuXHRcdH07XHJcblx0XHR0aGlzLnN0YXJ0c1dpdGg9ZnVuY3Rpb24oZix2KXtcclxuXHRcdFx0dmFyIHZhbCA9ICh2PT1udWxsKSA/IGY6IHYsXHJcblx0XHRcdGxlbmd0aD1fdHJpbSA/ICQudHJpbSh2YWwudG9TdHJpbmcoKSkubGVuZ3RoIDogdmFsLnRvU3RyaW5nKCkubGVuZ3RoO1xyXG5cdFx0XHRpZihfdXNlUHJvcGVydGllcyl7XHJcblx0XHRcdFx0c2VsZi5fYXBwZW5kKHNlbGYuX2dldFN0cignalF1ZXJ5LmpncmlkLmdldEFjY2Vzc29yKHRoaXMsXFwnJytmKydcXCcpJykrJy5zdWJzdHIoMCwnK2xlbmd0aCsnKSA9PSAnK3NlbGYuX2dldFN0cignXCInK3NlbGYuX3RvU3RyKHYpKydcIicpKTtcclxuXHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0aWYgKHYhPW51bGwpIHsgbGVuZ3RoPV90cmltPyQudHJpbSh2LnRvU3RyaW5nKCkpLmxlbmd0aDp2LnRvU3RyaW5nKCkubGVuZ3RoOyB9XHJcblx0XHRcdFx0c2VsZi5fYXBwZW5kKHNlbGYuX2dldFN0cigndGhpcycpKycuc3Vic3RyKDAsJytsZW5ndGgrJykgPT0gJytzZWxmLl9nZXRTdHIoJ1wiJytzZWxmLl90b1N0cihmKSsnXCInKSk7XHJcblx0XHRcdH1cclxuXHRcdFx0c2VsZi5fc2V0Q29tbWFuZChzZWxmLnN0YXJ0c1dpdGgsZik7XHJcblx0XHRcdHNlbGYuX3Jlc2V0TmVnYXRlKCk7XHJcblx0XHRcdHJldHVybiBzZWxmO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuZW5kc1dpdGg9ZnVuY3Rpb24oZix2KXtcclxuXHRcdFx0dmFyIHZhbCA9ICh2PT1udWxsKSA/IGY6IHYsXHJcblx0XHRcdGxlbmd0aD1fdHJpbSA/ICQudHJpbSh2YWwudG9TdHJpbmcoKSkubGVuZ3RoOnZhbC50b1N0cmluZygpLmxlbmd0aDtcclxuXHRcdFx0aWYoX3VzZVByb3BlcnRpZXMpe1xyXG5cdFx0XHRcdHNlbGYuX2FwcGVuZChzZWxmLl9nZXRTdHIoJ2pRdWVyeS5qZ3JpZC5nZXRBY2Nlc3Nvcih0aGlzLFxcJycrZisnXFwnKScpKycuc3Vic3RyKCcrc2VsZi5fZ2V0U3RyKCdqUXVlcnkuamdyaWQuZ2V0QWNjZXNzb3IodGhpcyxcXCcnK2YrJ1xcJyknKSsnLmxlbmd0aC0nK2xlbmd0aCsnLCcrbGVuZ3RoKycpID09IFwiJytzZWxmLl90b1N0cih2KSsnXCInKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRzZWxmLl9hcHBlbmQoc2VsZi5fZ2V0U3RyKCd0aGlzJykrJy5zdWJzdHIoJytzZWxmLl9nZXRTdHIoJ3RoaXMnKSsnLmxlbmd0aC1cIicrc2VsZi5fdG9TdHIoZikrJ1wiLmxlbmd0aCxcIicrc2VsZi5fdG9TdHIoZikrJ1wiLmxlbmd0aCkgPT0gXCInK3NlbGYuX3RvU3RyKGYpKydcIicpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHNlbGYuX3NldENvbW1hbmQoc2VsZi5lbmRzV2l0aCxmKTtzZWxmLl9yZXNldE5lZ2F0ZSgpO1xyXG5cdFx0XHRyZXR1cm4gc2VsZjtcclxuXHRcdH07XHJcblx0XHR0aGlzLmNvbnRhaW5zPWZ1bmN0aW9uKGYsdil7XHJcblx0XHRcdGlmKF91c2VQcm9wZXJ0aWVzKXtcclxuXHRcdFx0XHRzZWxmLl9hcHBlbmQoc2VsZi5fZ2V0U3RyKCdqUXVlcnkuamdyaWQuZ2V0QWNjZXNzb3IodGhpcyxcXCcnK2YrJ1xcJyknKSsnLmluZGV4T2YoXCInK3NlbGYuX3RvU3RyKHYpKydcIiwwKSA+IC0xJyk7XHJcblx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdHNlbGYuX2FwcGVuZChzZWxmLl9nZXRTdHIoJ3RoaXMnKSsnLmluZGV4T2YoXCInK3NlbGYuX3RvU3RyKGYpKydcIiwwKSA+IC0xJyk7XHJcblx0XHRcdH1cclxuXHRcdFx0c2VsZi5fc2V0Q29tbWFuZChzZWxmLmNvbnRhaW5zLGYpO1xyXG5cdFx0XHRzZWxmLl9yZXNldE5lZ2F0ZSgpO1xyXG5cdFx0XHRyZXR1cm4gc2VsZjtcclxuXHRcdH07XHJcblx0XHR0aGlzLmdyb3VwQnk9ZnVuY3Rpb24oYnksZGlyLHR5cGUsIGRhdGVmbXQpe1xyXG5cdFx0XHRpZighc2VsZi5faGFzRGF0YSgpKXtcclxuXHRcdFx0XHRyZXR1cm4gbnVsbDtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gc2VsZi5fZ2V0R3JvdXAoX2RhdGEsYnksZGlyLHR5cGUsIGRhdGVmbXQpO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMub3JkZXJCeT1mdW5jdGlvbihieSxkaXIsc3R5cGUsIGRmbXQsIHNmdW5jKXtcclxuXHRcdFx0ZGlyID0gZGlyID09IG51bGwgPyBcImFcIiA6JC50cmltKGRpci50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkpO1xyXG5cdFx0XHRpZihzdHlwZSA9PSBudWxsKSB7IHN0eXBlID0gXCJ0ZXh0XCI7IH1cclxuXHRcdFx0aWYoZGZtdCA9PSBudWxsKSB7IGRmbXQgPSBcIlktbS1kXCI7IH1cclxuXHRcdFx0aWYoc2Z1bmMgPT0gbnVsbCkgeyBzZnVuYyA9IGZhbHNlOyB9XHJcblx0XHRcdGlmKGRpcj09PVwiZGVzY1wifHxkaXI9PT1cImRlc2NlbmRpbmdcIil7ZGlyPVwiZFwiO31cclxuXHRcdFx0aWYoZGlyPT09XCJhc2NcInx8ZGlyPT09XCJhc2NlbmRpbmdcIil7ZGlyPVwiYVwiO31cclxuXHRcdFx0X3NvcnRpbmcucHVzaCh7Ynk6YnksZGlyOmRpcix0eXBlOnN0eXBlLCBkYXRlZm10OiBkZm10LCBzZnVuYzogc2Z1bmN9KTtcclxuXHRcdFx0cmV0dXJuIHNlbGY7XHJcblx0XHR9O1xyXG5cdFx0cmV0dXJuIHNlbGY7XHJcblx0XHR9O1xyXG5cdHJldHVybiBuZXcgUXVlcnlPYmplY3Qoc291cmNlLG51bGwpO1xyXG5cdH0sXHJcblx0Z2V0TWV0aG9kOiBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldEFjY2Vzc29yKCQuZm4uanFHcmlkLCBuYW1lKTtcclxuXHR9LFxyXG5cdGV4dGVuZCA6IGZ1bmN0aW9uKG1ldGhvZHMpIHtcclxuXHRcdCQuZXh0ZW5kKCQuZm4uanFHcmlkLG1ldGhvZHMpO1xyXG5cdFx0aWYgKCF0aGlzLm5vX2xlZ2FjeV9hcGkpIHtcclxuXHRcdFx0JC5mbi5leHRlbmQobWV0aG9kcyk7XHJcblx0XHR9XHJcblx0fVxyXG59KTtcclxuXHJcbiQuZm4uanFHcmlkID0gZnVuY3Rpb24oIHBpbiApIHtcclxuXHRpZiAodHlwZW9mIHBpbiA9PT0gJ3N0cmluZycpIHtcclxuXHRcdHZhciBmbiA9ICQuamdyaWQuZ2V0TWV0aG9kKHBpbik7XHJcblx0XHRpZiAoIWZuKSB7XHJcblx0XHRcdHRocm93IChcImpxR3JpZCAtIE5vIHN1Y2ggbWV0aG9kOiBcIiArIHBpbik7XHJcblx0XHR9XHJcblx0XHR2YXIgYXJncyA9ICQubWFrZUFycmF5KGFyZ3VtZW50cykuc2xpY2UoMSk7XHJcblx0XHRyZXR1cm4gZm4uYXBwbHkodGhpcyxhcmdzKTtcclxuXHR9XHJcblx0cmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7XHJcblx0XHRpZih0aGlzLmdyaWQpIHtyZXR1cm47fVxyXG5cclxuXHRcdHZhciBwID0gJC5leHRlbmQodHJ1ZSx7XHJcblx0XHRcdHVybDogXCJcIixcclxuXHRcdFx0aGVpZ2h0OiAxNTAsXHJcblx0XHRcdHBhZ2U6IDEsXHJcblx0XHRcdHJvd051bTogMjAsXHJcblx0XHRcdHJvd1RvdGFsIDogbnVsbCxcclxuXHRcdFx0cmVjb3JkczogMCxcclxuXHRcdFx0cGFnZXI6IFwiXCIsXHJcblx0XHRcdHBnYnV0dG9uczogdHJ1ZSxcclxuXHRcdFx0cGdpbnB1dDogdHJ1ZSxcclxuXHRcdFx0Y29sTW9kZWw6IFtdLFxyXG5cdFx0XHRyb3dMaXN0OiBbXSxcclxuXHRcdFx0Y29sTmFtZXM6IFtdLFxyXG5cdFx0XHRzb3J0b3JkZXI6IFwiYXNjXCIsXHJcblx0XHRcdHNvcnRuYW1lOiBcIlwiLFxyXG5cdFx0XHRkYXRhdHlwZTogXCJ4bWxcIixcclxuXHRcdFx0bXR5cGU6IFwiR0VUXCIsXHJcblx0XHRcdGFsdFJvd3M6IGZhbHNlLFxyXG5cdFx0XHRzZWxhcnJyb3c6IFtdLFxyXG5cdFx0XHRzYXZlZFJvdzogW10sXHJcblx0XHRcdHNocmlua1RvRml0OiB0cnVlLFxyXG5cdFx0XHR4bWxSZWFkZXI6IHt9LFxyXG5cdFx0XHRqc29uUmVhZGVyOiB7fSxcclxuXHRcdFx0c3ViR3JpZDogZmFsc2UsXHJcblx0XHRcdHN1YkdyaWRNb2RlbCA6W10sXHJcblx0XHRcdHJlY2NvdW50OiAwLFxyXG5cdFx0XHRsYXN0cGFnZTogMCxcclxuXHRcdFx0bGFzdHNvcnQ6IDAsXHJcblx0XHRcdHNlbHJvdzogbnVsbCxcclxuXHRcdFx0YmVmb3JlU2VsZWN0Um93OiBudWxsLFxyXG5cdFx0XHRvblNlbGVjdFJvdzogbnVsbCxcclxuXHRcdFx0b25Tb3J0Q29sOiBudWxsLFxyXG5cdFx0XHRvbmRibENsaWNrUm93OiBudWxsLFxyXG5cdFx0XHRvblJpZ2h0Q2xpY2tSb3c6IG51bGwsXHJcblx0XHRcdG9uUGFnaW5nOiBudWxsLFxyXG5cdFx0XHRvblNlbGVjdEFsbDogbnVsbCxcclxuXHRcdFx0b25Jbml0R3JpZCA6IG51bGwsXHJcblx0XHRcdGxvYWRDb21wbGV0ZTogbnVsbCxcclxuXHRcdFx0Z3JpZENvbXBsZXRlOiBudWxsLFxyXG5cdFx0XHRsb2FkRXJyb3I6IG51bGwsXHJcblx0XHRcdGxvYWRCZWZvcmVTZW5kOiBudWxsLFxyXG5cdFx0XHRhZnRlckluc2VydFJvdzogbnVsbCxcclxuXHRcdFx0YmVmb3JlUmVxdWVzdDogbnVsbCxcclxuXHRcdFx0YmVmb3JlUHJvY2Vzc2luZyA6IG51bGwsXHJcblx0XHRcdG9uSGVhZGVyQ2xpY2s6IG51bGwsXHJcblx0XHRcdHZpZXdyZWNvcmRzOiBmYWxzZSxcclxuXHRcdFx0bG9hZG9uY2U6IGZhbHNlLFxyXG5cdFx0XHRtdWx0aXNlbGVjdDogZmFsc2UsXHJcblx0XHRcdG11bHRpa2V5OiBmYWxzZSxcclxuXHRcdFx0ZWRpdHVybDogbnVsbCxcclxuXHRcdFx0c2VhcmNoOiBmYWxzZSxcclxuXHRcdFx0Y2FwdGlvbjogXCJcIixcclxuXHRcdFx0aGlkZWdyaWQ6IHRydWUsXHJcblx0XHRcdGhpZGRlbmdyaWQ6IGZhbHNlLFxyXG5cdFx0XHRwb3N0RGF0YToge30sXHJcblx0XHRcdHVzZXJEYXRhOiB7fSxcclxuXHRcdFx0dHJlZUdyaWQgOiBmYWxzZSxcclxuXHRcdFx0dHJlZUdyaWRNb2RlbCA6ICduZXN0ZWQnLFxyXG5cdFx0XHR0cmVlUmVhZGVyIDoge30sXHJcblx0XHRcdHRyZWVBTm9kZSA6IC0xLFxyXG5cdFx0XHRFeHBhbmRDb2x1bW46IG51bGwsXHJcblx0XHRcdHRyZWVfcm9vdF9sZXZlbCA6IDAsXHJcblx0XHRcdHBybU5hbWVzOiB7cGFnZTpcInBhZ2VcIixyb3dzOlwicm93c1wiLCBzb3J0OiBcInNpZHhcIixvcmRlcjogXCJzb3JkXCIsIHNlYXJjaDpcIl9zZWFyY2hcIiwgbmQ6XCJuZFwiLCBpZDpcImlkXCIsb3BlcjpcIm9wZXJcIixlZGl0b3BlcjpcImVkaXRcIixhZGRvcGVyOlwiYWRkXCIsZGVsb3BlcjpcImRlbFwiLCBzdWJncmlkaWQ6XCJpZFwiLCBucGFnZTogbnVsbCwgdG90YWxyb3dzOlwidG90YWxyb3dzXCJ9LFxyXG5cdFx0XHRmb3JjZUZpdCA6IGZhbHNlLFxyXG5cdFx0XHRncmlkc3RhdGUgOiBcInZpc2libGVcIixcclxuXHRcdFx0Y2VsbEVkaXQ6IGZhbHNlLFxyXG5cdFx0XHRjZWxsc3VibWl0OiBcInJlbW90ZVwiLFxyXG5cdFx0XHRudjowLFxyXG5cdFx0XHRsb2FkdWk6IFwiZW5hYmxlXCIsXHJcblx0XHRcdHRvb2xiYXI6IFtmYWxzZSxcIlwiXSxcclxuXHRcdFx0c2Nyb2xsOiBmYWxzZSxcclxuXHRcdFx0bXVsdGlib3hvbmx5IDogZmFsc2UsXHJcblx0XHRcdGRlc2VsZWN0QWZ0ZXJTb3J0IDogdHJ1ZSxcclxuXHRcdFx0c2Nyb2xscm93cyA6IGZhbHNlLFxyXG5cdFx0XHRhdXRvd2lkdGg6IGZhbHNlLFxyXG5cdFx0XHRzY3JvbGxPZmZzZXQgOjE4LFxyXG5cdFx0XHRjZWxsTGF5b3V0OiA1LFxyXG5cdFx0XHRzdWJHcmlkV2lkdGg6IDIwLFxyXG5cdFx0XHRtdWx0aXNlbGVjdFdpZHRoOiAyMCxcclxuXHRcdFx0Z3JpZHZpZXc6IGZhbHNlLFxyXG5cdFx0XHRyb3dudW1XaWR0aDogMjUsXHJcblx0XHRcdHJvd251bWJlcnMgOiBmYWxzZSxcclxuXHRcdFx0cGFnZXJwb3M6ICdjZW50ZXInLFxyXG5cdFx0XHRyZWNvcmRwb3M6ICdyaWdodCcsXHJcblx0XHRcdGZvb3RlcnJvdyA6IGZhbHNlLFxyXG5cdFx0XHR1c2VyRGF0YU9uRm9vdGVyIDogZmFsc2UsXHJcblx0XHRcdGhvdmVycm93cyA6IHRydWUsXHJcblx0XHRcdGFsdGNsYXNzIDogJ3VpLXByaW9yaXR5LXNlY29uZGFyeScsXHJcblx0XHRcdHZpZXdzb3J0Y29scyA6IFtmYWxzZSwndmVydGljYWwnLHRydWVdLFxyXG5cdFx0XHRyZXNpemVjbGFzcyA6ICcnLFxyXG5cdFx0XHRhdXRvZW5jb2RlIDogZmFsc2UsXHJcblx0XHRcdHJlbWFwQ29sdW1ucyA6IFtdLFxyXG5cdFx0XHRhamF4R3JpZE9wdGlvbnMgOnt9LFxyXG5cdFx0XHRkaXJlY3Rpb24gOiBcImx0clwiLFxyXG5cdFx0XHR0b3BwYWdlcjogZmFsc2UsXHJcblx0XHRcdGhlYWRlcnRpdGxlczogZmFsc2UsXHJcblx0XHRcdHNjcm9sbFRpbWVvdXQ6IDQwLFxyXG5cdFx0XHRkYXRhIDogW10sXHJcblx0XHRcdF9pbmRleCA6IHt9LFxyXG5cdFx0XHRncm91cGluZyA6IGZhbHNlLFxyXG5cdFx0XHRncm91cGluZ1ZpZXcgOiB7Z3JvdXBGaWVsZDpbXSxncm91cE9yZGVyOltdLCBncm91cFRleHQ6W10sZ3JvdXBDb2x1bW5TaG93OltdLGdyb3VwU3VtbWFyeTpbXSwgc2hvd1N1bW1hcnlPbkhpZGU6IGZhbHNlLCBzb3J0aXRlbXM6W10sIHNvcnRuYW1lczpbXSwgc3VtbWFyeTpbXSxzdW1tYXJ5dmFsOltdLCBwbHVzaWNvbjogJ3VpLWljb24tY2lyY2xlc21hbGwtcGx1cycsIG1pbnVzaWNvbjogJ3VpLWljb24tY2lyY2xlc21hbGwtbWludXMnLCBkaXNwbGF5RmllbGQ6IFtdLCBncm91cFN1bW1hcnlQb3M6W10sIGZvcm1hdERpc3BsYXlGaWVsZCA6IFtdLCBfbG9jZ3IgOiBmYWxzZX0sXHJcblx0XHRcdGlnbm9yZUNhc2UgOiBmYWxzZSxcclxuXHRcdFx0Y21UZW1wbGF0ZSA6IHt9LFxyXG5cdFx0XHRpZFByZWZpeCA6IFwiXCIsXHJcblx0XHRcdG11bHRpU29ydCA6ICBmYWxzZVxyXG5cdFx0fSwgJC5qZ3JpZC5kZWZhdWx0cywgcGluIHx8IHt9KTtcclxuXHRcdHZhciB0cz0gdGhpcywgZ3JpZD17XHJcblx0XHRcdGhlYWRlcnM6W10sXHJcblx0XHRcdGNvbHM6W10sXHJcblx0XHRcdGZvb3RlcnM6IFtdLFxyXG5cdFx0XHRkcmFnU3RhcnQ6IGZ1bmN0aW9uKGkseCx5KSB7XHJcblx0XHRcdFx0dmFyIGdyaWRMZWZ0UG9zID0gJCh0aGlzLmJEaXYpLm9mZnNldCgpLmxlZnQ7XHJcblx0XHRcdFx0dGhpcy5yZXNpemluZyA9IHsgaWR4OiBpLCBzdGFydFg6IHguY2xpZW50WCwgc09MIDogeC5jbGllbnRYIC0gZ3JpZExlZnRQb3MgfTtcclxuXHRcdFx0XHR0aGlzLmhEaXYuc3R5bGUuY3Vyc29yID0gXCJjb2wtcmVzaXplXCI7XHJcblx0XHRcdFx0dGhpcy5jdXJHYm94ID0gJChcIiNyc19tXCIrJC5qZ3JpZC5qcUlEKHAuaWQpLFwiI2dib3hfXCIrJC5qZ3JpZC5qcUlEKHAuaWQpKTtcclxuXHRcdFx0XHR0aGlzLmN1ckdib3guY3NzKHtkaXNwbGF5OlwiYmxvY2tcIixsZWZ0OnguY2xpZW50WC1ncmlkTGVmdFBvcyx0b3A6eVsxXSxoZWlnaHQ6eVsyXX0pO1xyXG5cdFx0XHRcdCQodHMpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkUmVzaXplU3RhcnRcIiwgW3gsIGldKTtcclxuXHRcdFx0XHRpZigkLmlzRnVuY3Rpb24ocC5yZXNpemVTdGFydCkpIHsgcC5yZXNpemVTdGFydC5jYWxsKHRzLHgsaSk7IH1cclxuXHRcdFx0XHRkb2N1bWVudC5vbnNlbGVjdHN0YXJ0PWZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO307XHJcblx0XHRcdH0sXHJcblx0XHRcdGRyYWdNb3ZlOiBmdW5jdGlvbih4KSB7XHJcblx0XHRcdFx0aWYodGhpcy5yZXNpemluZykge1xyXG5cdFx0XHRcdFx0dmFyIGRpZmYgPSB4LmNsaWVudFgtdGhpcy5yZXNpemluZy5zdGFydFgsXHJcblx0XHRcdFx0XHRoID0gdGhpcy5oZWFkZXJzW3RoaXMucmVzaXppbmcuaWR4XSxcclxuXHRcdFx0XHRcdG5ld1dpZHRoID0gcC5kaXJlY3Rpb24gPT09IFwibHRyXCIgPyBoLndpZHRoICsgZGlmZiA6IGgud2lkdGggLSBkaWZmLCBobiwgblduO1xyXG5cdFx0XHRcdFx0aWYobmV3V2lkdGggPiAzMykge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmN1ckdib3guY3NzKHtsZWZ0OnRoaXMucmVzaXppbmcuc09MK2RpZmZ9KTtcclxuXHRcdFx0XHRcdFx0aWYocC5mb3JjZUZpdD09PXRydWUgKXtcclxuXHRcdFx0XHRcdFx0XHRobiA9IHRoaXMuaGVhZGVyc1t0aGlzLnJlc2l6aW5nLmlkeCtwLm52XTtcclxuXHRcdFx0XHRcdFx0XHRuV24gPSBwLmRpcmVjdGlvbiA9PT0gXCJsdHJcIiA/IGhuLndpZHRoIC0gZGlmZiA6IGhuLndpZHRoICsgZGlmZjtcclxuXHRcdFx0XHRcdFx0XHRpZihuV24gPjMzKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRoLm5ld1dpZHRoID0gbmV3V2lkdGg7XHJcblx0XHRcdFx0XHRcdFx0XHRobi5uZXdXaWR0aCA9IG5XbjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5uZXdXaWR0aCA9IHAuZGlyZWN0aW9uID09PSBcImx0clwiID8gcC50Ymx3aWR0aCtkaWZmIDogcC50Ymx3aWR0aC1kaWZmO1xyXG5cdFx0XHRcdFx0XHRcdGgubmV3V2lkdGggPSBuZXdXaWR0aDtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdFx0ZHJhZ0VuZDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0dGhpcy5oRGl2LnN0eWxlLmN1cnNvciA9IFwiZGVmYXVsdFwiO1xyXG5cdFx0XHRcdGlmKHRoaXMucmVzaXppbmcpIHtcclxuXHRcdFx0XHRcdHZhciBpZHggPSB0aGlzLnJlc2l6aW5nLmlkeCxcclxuXHRcdFx0XHRcdG53ID0gdGhpcy5oZWFkZXJzW2lkeF0ubmV3V2lkdGggfHwgdGhpcy5oZWFkZXJzW2lkeF0ud2lkdGg7XHJcblx0XHRcdFx0XHRudyA9IHBhcnNlSW50KG53LDEwKTtcclxuXHRcdFx0XHRcdHRoaXMucmVzaXppbmcgPSBmYWxzZTtcclxuXHRcdFx0XHRcdCQoXCIjcnNfbVwiKyQuamdyaWQuanFJRChwLmlkKSkuY3NzKFwiZGlzcGxheVwiLFwibm9uZVwiKTtcclxuXHRcdFx0XHRcdHAuY29sTW9kZWxbaWR4XS53aWR0aCA9IG53O1xyXG5cdFx0XHRcdFx0dGhpcy5oZWFkZXJzW2lkeF0ud2lkdGggPSBudztcclxuXHRcdFx0XHRcdHRoaXMuaGVhZGVyc1tpZHhdLmVsLnN0eWxlLndpZHRoID0gbncgKyBcInB4XCI7XHJcblx0XHRcdFx0XHR0aGlzLmNvbHNbaWR4XS5zdHlsZS53aWR0aCA9IG53K1wicHhcIjtcclxuXHRcdFx0XHRcdGlmKHRoaXMuZm9vdGVycy5sZW5ndGg+MCkge3RoaXMuZm9vdGVyc1tpZHhdLnN0eWxlLndpZHRoID0gbncrXCJweFwiO31cclxuXHRcdFx0XHRcdGlmKHAuZm9yY2VGaXQ9PT10cnVlKXtcclxuXHRcdFx0XHRcdFx0bncgPSB0aGlzLmhlYWRlcnNbaWR4K3AubnZdLm5ld1dpZHRoIHx8IHRoaXMuaGVhZGVyc1tpZHgrcC5udl0ud2lkdGg7XHJcblx0XHRcdFx0XHRcdHRoaXMuaGVhZGVyc1tpZHgrcC5udl0ud2lkdGggPSBudztcclxuXHRcdFx0XHRcdFx0dGhpcy5oZWFkZXJzW2lkeCtwLm52XS5lbC5zdHlsZS53aWR0aCA9IG53ICsgXCJweFwiO1xyXG5cdFx0XHRcdFx0XHR0aGlzLmNvbHNbaWR4K3AubnZdLnN0eWxlLndpZHRoID0gbncrXCJweFwiO1xyXG5cdFx0XHRcdFx0XHRpZih0aGlzLmZvb3RlcnMubGVuZ3RoPjApIHt0aGlzLmZvb3RlcnNbaWR4K3AubnZdLnN0eWxlLndpZHRoID0gbncrXCJweFwiO31cclxuXHRcdFx0XHRcdFx0cC5jb2xNb2RlbFtpZHgrcC5udl0ud2lkdGggPSBudztcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHAudGJsd2lkdGggPSB0aGlzLm5ld1dpZHRoIHx8IHAudGJsd2lkdGg7XHJcblx0XHRcdFx0XHRcdCQoJ3RhYmxlOmZpcnN0Jyx0aGlzLmJEaXYpLmNzcyhcIndpZHRoXCIscC50Ymx3aWR0aCtcInB4XCIpO1xyXG5cdFx0XHRcdFx0XHQkKCd0YWJsZTpmaXJzdCcsdGhpcy5oRGl2KS5jc3MoXCJ3aWR0aFwiLHAudGJsd2lkdGgrXCJweFwiKTtcclxuXHRcdFx0XHRcdFx0dGhpcy5oRGl2LnNjcm9sbExlZnQgPSB0aGlzLmJEaXYuc2Nyb2xsTGVmdDtcclxuXHRcdFx0XHRcdFx0aWYocC5mb290ZXJyb3cpIHtcclxuXHRcdFx0XHRcdFx0XHQkKCd0YWJsZTpmaXJzdCcsdGhpcy5zRGl2KS5jc3MoXCJ3aWR0aFwiLHAudGJsd2lkdGgrXCJweFwiKTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnNEaXYuc2Nyb2xsTGVmdCA9IHRoaXMuYkRpdi5zY3JvbGxMZWZ0O1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQkKHRzKS50cmlnZ2VySGFuZGxlcihcImpxR3JpZFJlc2l6ZVN0b3BcIiwgW253LCBpZHhdKTtcclxuXHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbihwLnJlc2l6ZVN0b3ApKSB7IHAucmVzaXplU3RvcC5jYWxsKHRzLG53LGlkeCk7IH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dGhpcy5jdXJHYm94ID0gbnVsbDtcclxuXHRcdFx0XHRkb2N1bWVudC5vbnNlbGVjdHN0YXJ0PWZ1bmN0aW9uKCl7cmV0dXJuIHRydWU7fTtcclxuXHRcdFx0fSxcclxuXHRcdFx0cG9wdWxhdGVWaXNpYmxlOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZiAoZ3JpZC50aW1lcikgeyBjbGVhclRpbWVvdXQoZ3JpZC50aW1lcik7IH1cclxuXHRcdFx0XHRncmlkLnRpbWVyID0gbnVsbDtcclxuXHRcdFx0XHR2YXIgZGggPSAkKGdyaWQuYkRpdikuaGVpZ2h0KCk7XHJcblx0XHRcdFx0aWYgKCFkaCkgeyByZXR1cm47IH1cclxuXHRcdFx0XHR2YXIgdGFibGUgPSAkKFwidGFibGU6Zmlyc3RcIiwgZ3JpZC5iRGl2KTtcclxuXHRcdFx0XHR2YXIgcm93cywgcmg7XHJcblx0XHRcdFx0aWYodGFibGVbMF0ucm93cy5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdHJvd3MgPSB0YWJsZVswXS5yb3dzWzFdO1xyXG5cdFx0XHRcdFx0XHRyaCA9IHJvd3MgPyAkKHJvd3MpLm91dGVySGVpZ2h0KCkgfHwgZ3JpZC5wcmV2Um93SGVpZ2h0IDogZ3JpZC5wcmV2Um93SGVpZ2h0O1xyXG5cdFx0XHRcdFx0fSBjYXRjaCAocHYpIHtcclxuXHRcdFx0XHRcdFx0cmggPSBncmlkLnByZXZSb3dIZWlnaHQ7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmICghcmgpIHsgcmV0dXJuOyB9XHJcblx0XHRcdFx0Z3JpZC5wcmV2Um93SGVpZ2h0ID0gcmg7XHJcblx0XHRcdFx0dmFyIHJuID0gcC5yb3dOdW07XHJcblx0XHRcdFx0dmFyIHNjcm9sbFRvcCA9IGdyaWQuc2Nyb2xsVG9wID0gZ3JpZC5iRGl2LnNjcm9sbFRvcDtcclxuXHRcdFx0XHR2YXIgdHRvcCA9IE1hdGgucm91bmQodGFibGUucG9zaXRpb24oKS50b3ApIC0gc2Nyb2xsVG9wO1xyXG5cdFx0XHRcdHZhciB0Ym90ID0gdHRvcCArIHRhYmxlLmhlaWdodCgpO1xyXG5cdFx0XHRcdHZhciBkaXYgPSByaCAqIHJuO1xyXG5cdFx0XHRcdHZhciBwYWdlLCBucGFnZSwgZW1wdHk7XHJcblx0XHRcdFx0aWYgKCB0Ym90IDwgZGggJiYgdHRvcCA8PSAwICYmXHJcblx0XHRcdFx0XHQocC5sYXN0cGFnZT09PXVuZGVmaW5lZHx8cGFyc2VJbnQoKHRib3QgKyBzY3JvbGxUb3AgKyBkaXYgLSAxKSAvIGRpdiwxMCkgPD0gcC5sYXN0cGFnZSkpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0bnBhZ2UgPSBwYXJzZUludCgoZGggLSB0Ym90ICsgZGl2IC0gMSkgLyBkaXYsMTApO1xyXG5cdFx0XHRcdFx0aWYgKHRib3QgPj0gMCB8fCBucGFnZSA8IDIgfHwgcC5zY3JvbGwgPT09IHRydWUpIHtcclxuXHRcdFx0XHRcdFx0cGFnZSA9IE1hdGgucm91bmQoKHRib3QgKyBzY3JvbGxUb3ApIC8gZGl2KSArIDE7XHJcblx0XHRcdFx0XHRcdHR0b3AgPSAtMTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHR0b3AgPSAxO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAodHRvcCA+IDApIHtcclxuXHRcdFx0XHRcdHBhZ2UgPSBwYXJzZUludChzY3JvbGxUb3AgLyBkaXYsMTApICsgMTtcclxuXHRcdFx0XHRcdG5wYWdlID0gcGFyc2VJbnQoKHNjcm9sbFRvcCArIGRoKSAvIGRpdiwxMCkgKyAyIC0gcGFnZTtcclxuXHRcdFx0XHRcdGVtcHR5ID0gdHJ1ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKG5wYWdlKSB7XHJcblx0XHRcdFx0XHRpZiAocC5sYXN0cGFnZSAmJiAocGFnZSA+IHAubGFzdHBhZ2UgfHwgcC5sYXN0cGFnZT09PTEgfHwgKHBhZ2UgPT09IHAucGFnZSAmJiBwYWdlPT09cC5sYXN0cGFnZSkpICkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAoZ3JpZC5oRGl2LmxvYWRpbmcpIHtcclxuXHRcdFx0XHRcdFx0Z3JpZC50aW1lciA9IHNldFRpbWVvdXQoZ3JpZC5wb3B1bGF0ZVZpc2libGUsIHAuc2Nyb2xsVGltZW91dCk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRwLnBhZ2UgPSBwYWdlO1xyXG5cdFx0XHRcdFx0XHRpZiAoZW1wdHkpIHtcclxuXHRcdFx0XHRcdFx0XHRncmlkLnNlbGVjdGlvblByZXNlcnZlcih0YWJsZVswXSk7XHJcblx0XHRcdFx0XHRcdFx0Z3JpZC5lbXB0eVJvd3MuY2FsbCh0YWJsZVswXSwgZmFsc2UsIGZhbHNlKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRncmlkLnBvcHVsYXRlKG5wYWdlKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdHNjcm9sbEdyaWQ6IGZ1bmN0aW9uKCBlICkge1xyXG5cdFx0XHRcdGlmKHAuc2Nyb2xsKSB7XHJcblx0XHRcdFx0XHR2YXIgc2Nyb2xsVG9wID0gZ3JpZC5iRGl2LnNjcm9sbFRvcDtcclxuXHRcdFx0XHRcdGlmKGdyaWQuc2Nyb2xsVG9wID09PSB1bmRlZmluZWQpIHsgZ3JpZC5zY3JvbGxUb3AgPSAwOyB9XHJcblx0XHRcdFx0XHRpZiAoc2Nyb2xsVG9wICE9PSBncmlkLnNjcm9sbFRvcCkge1xyXG5cdFx0XHRcdFx0XHRncmlkLnNjcm9sbFRvcCA9IHNjcm9sbFRvcDtcclxuXHRcdFx0XHRcdFx0aWYgKGdyaWQudGltZXIpIHsgY2xlYXJUaW1lb3V0KGdyaWQudGltZXIpOyB9XHJcblx0XHRcdFx0XHRcdGdyaWQudGltZXIgPSBzZXRUaW1lb3V0KGdyaWQucG9wdWxhdGVWaXNpYmxlLCBwLnNjcm9sbFRpbWVvdXQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRncmlkLmhEaXYuc2Nyb2xsTGVmdCA9IGdyaWQuYkRpdi5zY3JvbGxMZWZ0O1xyXG5cdFx0XHRcdGlmKHAuZm9vdGVycm93KSB7XHJcblx0XHRcdFx0XHRncmlkLnNEaXYuc2Nyb2xsTGVmdCA9IGdyaWQuYkRpdi5zY3JvbGxMZWZ0O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiggZSApIHsgZS5zdG9wUHJvcGFnYXRpb24oKTsgfVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRzZWxlY3Rpb25QcmVzZXJ2ZXIgOiBmdW5jdGlvbih0cykge1xyXG5cdFx0XHRcdHZhciBwID0gdHMucCxcclxuXHRcdFx0XHRzciA9IHAuc2Vscm93LCBzcmEgPSBwLnNlbGFycnJvdyA/ICQubWFrZUFycmF5KHAuc2VsYXJycm93KSA6IG51bGwsXHJcblx0XHRcdFx0bGVmdCA9IHRzLmdyaWQuYkRpdi5zY3JvbGxMZWZ0LFxyXG5cdFx0XHRcdHJlc3RvcmVTZWxlY3Rpb24gPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBpO1xyXG5cdFx0XHRcdFx0cC5zZWxyb3cgPSBudWxsO1xyXG5cdFx0XHRcdFx0cC5zZWxhcnJyb3cgPSBbXTtcclxuXHRcdFx0XHRcdGlmKHAubXVsdGlzZWxlY3QgJiYgc3JhICYmIHNyYS5sZW5ndGg+MCkge1xyXG5cdFx0XHRcdFx0XHRmb3IoaT0wO2k8c3JhLmxlbmd0aDtpKyspe1xyXG5cdFx0XHRcdFx0XHRcdGlmIChzcmFbaV0gIT09IHNyKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRzKS5qcUdyaWQoXCJzZXRTZWxlY3Rpb25cIixzcmFbaV0sZmFsc2UsIG51bGwpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYgKHNyKSB7XHJcblx0XHRcdFx0XHRcdCQodHMpLmpxR3JpZChcInNldFNlbGVjdGlvblwiLHNyLGZhbHNlLG51bGwpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dHMuZ3JpZC5iRGl2LnNjcm9sbExlZnQgPSBsZWZ0O1xyXG5cdFx0XHRcdFx0JCh0cykudW5iaW5kKCcuc2VsZWN0aW9uUHJlc2VydmVyJywgcmVzdG9yZVNlbGVjdGlvbik7XHJcblx0XHRcdFx0fTtcclxuXHRcdFx0XHQkKHRzKS5iaW5kKCdqcUdyaWRHcmlkQ29tcGxldGUuc2VsZWN0aW9uUHJlc2VydmVyJywgcmVzdG9yZVNlbGVjdGlvbik7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRpZih0aGlzLnRhZ05hbWUudG9VcHBlckNhc2UoKSAhPT0gJ1RBQkxFJykge1xyXG5cdFx0XHRhbGVydChcIkVsZW1lbnQgaXMgbm90IGEgdGFibGVcIik7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGlmKGRvY3VtZW50LmRvY3VtZW50TW9kZSAhPT0gdW5kZWZpbmVkICkgeyAvLyBJRSBvbmx5XHJcblx0XHRcdGlmKGRvY3VtZW50LmRvY3VtZW50TW9kZSA8PSA1KSB7XHJcblx0XHRcdFx0YWxlcnQoXCJHcmlkIGNhbiBub3QgYmUgdXNlZCBpbiB0aGlzICgncXVpcmtzJykgbW9kZSFcIik7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHQkKHRoaXMpLmVtcHR5KCkuYXR0cihcInRhYmluZGV4XCIsXCIwXCIpO1xyXG5cdFx0dGhpcy5wID0gcCA7XHJcblx0XHR0aGlzLnAudXNlUHJvcCA9ICEhJC5mbi5wcm9wO1xyXG5cdFx0dmFyIGksIGRpcjtcclxuXHRcdGlmKHRoaXMucC5jb2xOYW1lcy5sZW5ndGggPT09IDApIHtcclxuXHRcdFx0Zm9yIChpPTA7aTx0aGlzLnAuY29sTW9kZWwubGVuZ3RoO2krKyl7XHJcblx0XHRcdFx0dGhpcy5wLmNvbE5hbWVzW2ldID0gdGhpcy5wLmNvbE1vZGVsW2ldLmxhYmVsIHx8IHRoaXMucC5jb2xNb2RlbFtpXS5uYW1lO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiggdGhpcy5wLmNvbE5hbWVzLmxlbmd0aCAhPT0gdGhpcy5wLmNvbE1vZGVsLmxlbmd0aCApIHtcclxuXHRcdFx0YWxlcnQoJC5qZ3JpZC5lcnJvcnMubW9kZWwpO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHR2YXIgZ3YgPSAkKFwiPGRpdiBjbGFzcz0ndWktanFncmlkLXZpZXcnPjwvZGl2PlwiKSxcclxuXHRcdGlzTVNJRSA9ICQuamdyaWQubXNpZTtcclxuXHRcdHRzLnAuZGlyZWN0aW9uID0gJC50cmltKHRzLnAuZGlyZWN0aW9uLnRvTG93ZXJDYXNlKCkpO1xyXG5cdFx0aWYoJC5pbkFycmF5KHRzLnAuZGlyZWN0aW9uLFtcImx0clwiLFwicnRsXCJdKSA9PT0gLTEpIHsgdHMucC5kaXJlY3Rpb24gPSBcImx0clwiOyB9XHJcblx0XHRkaXIgPSB0cy5wLmRpcmVjdGlvbjtcclxuXHJcblx0XHQkKGd2KS5pbnNlcnRCZWZvcmUodGhpcyk7XHJcblx0XHQkKHRoaXMpLnJlbW92ZUNsYXNzKFwic2Nyb2xsXCIpLmFwcGVuZFRvKGd2KTtcclxuXHRcdHZhciBlZyA9ICQoXCI8ZGl2IGNsYXNzPSd1aS1qcWdyaWQgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwnPjwvZGl2PlwiKTtcclxuXHRcdCQoZWcpLmF0dHIoe1wiaWRcIiA6IFwiZ2JveF9cIit0aGlzLmlkLFwiZGlyXCI6ZGlyfSkuaW5zZXJ0QmVmb3JlKGd2KTtcclxuXHRcdCQoZ3YpLmF0dHIoXCJpZFwiLFwiZ3ZpZXdfXCIrdGhpcy5pZCkuYXBwZW5kVG8oZWcpO1xyXG5cdFx0JChcIjxkaXYgY2xhc3M9J3VpLXdpZGdldC1vdmVybGF5IGpxZ3JpZC1vdmVybGF5JyBpZD0nbHVpX1wiK3RoaXMuaWQrXCInPjwvZGl2PlwiKS5pbnNlcnRCZWZvcmUoZ3YpO1xyXG5cdFx0JChcIjxkaXYgY2xhc3M9J2xvYWRpbmcgdWktc3RhdGUtZGVmYXVsdCB1aS1zdGF0ZS1hY3RpdmUnIGlkPSdsb2FkX1wiK3RoaXMuaWQrXCInPlwiK3RoaXMucC5sb2FkdGV4dCtcIjwvZGl2PlwiKS5pbnNlcnRCZWZvcmUoZ3YpO1xyXG5cdFx0JCh0aGlzKS5hdHRyKHtjZWxsc3BhY2luZzpcIjBcIixjZWxscGFkZGluZzpcIjBcIixib3JkZXI6XCIwXCIsXCJyb2xlXCI6XCJncmlkXCIsXCJhcmlhLW11bHRpc2VsZWN0YWJsZVwiOiEhdGhpcy5wLm11bHRpc2VsZWN0LFwiYXJpYS1sYWJlbGxlZGJ5XCI6XCJnYm94X1wiK3RoaXMuaWR9KTtcclxuXHRcdHZhciBzb3J0a2V5cyA9IFtcInNoaWZ0S2V5XCIsXCJhbHRLZXlcIixcImN0cmxLZXlcIl0sXHJcblx0XHRpbnROdW0gPSBmdW5jdGlvbih2YWwsZGVmdmFsKSB7XHJcblx0XHRcdHZhbCA9IHBhcnNlSW50KHZhbCwxMCk7XHJcblx0XHRcdGlmIChpc05hTih2YWwpKSB7IHJldHVybiBkZWZ2YWwgfHwgMDt9XHJcblx0XHRcdHJldHVybiB2YWw7XHJcblx0XHR9LFxyXG5cdFx0Zm9ybWF0Q29sID0gZnVuY3Rpb24gKHBvcywgcm93SW5kLCB0diwgcmF3T2JqZWN0LCByb3dJZCwgcmRhdGEpe1xyXG5cdFx0XHR2YXIgY20gPSB0cy5wLmNvbE1vZGVsW3Bvc10sXHJcblx0XHRcdHJhbCA9IGNtLmFsaWduLCByZXN1bHQ9XCJzdHlsZT1cXFwiXCIsIGNsYXMgPSBjbS5jbGFzc2VzLCBubSA9IGNtLm5hbWUsIGNlbHAsIGFjcD1bXTtcclxuXHRcdFx0aWYocmFsKSB7IHJlc3VsdCArPSBcInRleHQtYWxpZ246XCIrcmFsK1wiO1wiOyB9XHJcblx0XHRcdGlmKGNtLmhpZGRlbj09PXRydWUpIHsgcmVzdWx0ICs9IFwiZGlzcGxheTpub25lO1wiOyB9XHJcblx0XHRcdGlmKHJvd0luZD09PTApIHtcclxuXHRcdFx0XHRyZXN1bHQgKz0gXCJ3aWR0aDogXCIrZ3JpZC5oZWFkZXJzW3Bvc10ud2lkdGgrXCJweDtcIjtcclxuXHRcdFx0fSBlbHNlIGlmIChjbS5jZWxsYXR0ciAmJiAkLmlzRnVuY3Rpb24oY20uY2VsbGF0dHIpKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Y2VscCA9IGNtLmNlbGxhdHRyLmNhbGwodHMsIHJvd0lkLCB0diwgcmF3T2JqZWN0LCBjbSwgcmRhdGEpO1xyXG5cdFx0XHRcdGlmKGNlbHAgJiYgdHlwZW9mIGNlbHAgPT09IFwic3RyaW5nXCIpIHtcclxuXHRcdFx0XHRcdGNlbHAgPSBjZWxwLnJlcGxhY2UoL3N0eWxlL2ksJ3N0eWxlJykucmVwbGFjZSgvdGl0bGUvaSwndGl0bGUnKTtcclxuXHRcdFx0XHRcdGlmKGNlbHAuaW5kZXhPZigndGl0bGUnKSA+IC0xKSB7IGNtLnRpdGxlPWZhbHNlO31cclxuXHRcdFx0XHRcdGlmKGNlbHAuaW5kZXhPZignY2xhc3MnKSA+IC0xKSB7IGNsYXMgPSB1bmRlZmluZWQ7fVxyXG5cdFx0XHRcdFx0YWNwID0gY2VscC5yZXBsYWNlKCctc3R5bGUnLCctc3RpJykuc3BsaXQoL3N0eWxlLyk7XHJcblx0XHRcdFx0XHRpZihhY3AubGVuZ3RoID09PSAyICkge1xyXG5cdFx0XHRcdFx0XHRhY3BbMV0gPSAgJC50cmltKGFjcFsxXS5yZXBsYWNlKCctc3RpJywnLXN0eWxlJykucmVwbGFjZShcIj1cIixcIlwiKSk7XHJcblx0XHRcdFx0XHRcdGlmKGFjcFsxXS5pbmRleE9mKFwiJ1wiKSA9PT0gMCB8fCBhY3BbMV0uaW5kZXhPZignXCInKSA9PT0gMCkge1xyXG5cdFx0XHRcdFx0XHRcdGFjcFsxXSA9IGFjcFsxXS5zdWJzdHJpbmcoMSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0cmVzdWx0ICs9IGFjcFsxXS5yZXBsYWNlKC8nL2dpLCdcIicpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0cmVzdWx0ICs9IFwiXFxcIlwiO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRpZighYWNwLmxlbmd0aCkgeyBhY3BbMF0gPSBcIlwiOyByZXN1bHQgKz0gXCJcXFwiXCI7fVxyXG5cdFx0XHRyZXN1bHQgKz0gKGNsYXMgIT09IHVuZGVmaW5lZCA/IChcIiBjbGFzcz1cXFwiXCIrY2xhcytcIlxcXCJcIikgOlwiXCIpICsgKChjbS50aXRsZSAmJiB0dikgPyAoXCIgdGl0bGU9XFxcIlwiKyQuamdyaWQuc3RyaXBIdG1sKHR2KStcIlxcXCJcIikgOlwiXCIpO1xyXG5cdFx0XHRyZXN1bHQgKz0gXCIgYXJpYS1kZXNjcmliZWRieT1cXFwiXCIrdHMucC5pZCtcIl9cIitubStcIlxcXCJcIjtcclxuXHRcdFx0cmV0dXJuIHJlc3VsdCArIGFjcFswXTtcclxuXHRcdH0sXHJcblx0XHRjZWxsVmFsID0gIGZ1bmN0aW9uICh2YWwpIHtcclxuXHRcdFx0cmV0dXJuIHZhbCA9PSBudWxsIHx8IHZhbCA9PT0gXCJcIiA/IFwiJiMxNjA7XCIgOiAodHMucC5hdXRvZW5jb2RlID8gJC5qZ3JpZC5odG1sRW5jb2RlKHZhbCkgOiBTdHJpbmcodmFsKSk7XHJcblx0XHR9LFxyXG5cdFx0Zm9ybWF0dGVyID0gZnVuY3Rpb24gKHJvd0lkLCBjZWxsdmFsICwgY29scG9zLCByd2RhdCwgX2FjdCl7XHJcblx0XHRcdHZhciBjbSA9IHRzLnAuY29sTW9kZWxbY29scG9zXSx2O1xyXG5cdFx0XHRpZihjbS5mb3JtYXR0ZXIgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdHJvd0lkID0gU3RyaW5nKHRzLnAuaWRQcmVmaXgpICE9PSBcIlwiID8gJC5qZ3JpZC5zdHJpcFByZWYodHMucC5pZFByZWZpeCwgcm93SWQpIDogcm93SWQ7XHJcblx0XHRcdFx0dmFyIG9wdHM9IHtyb3dJZDogcm93SWQsIGNvbE1vZGVsOmNtLCBnaWQ6dHMucC5pZCwgcG9zOmNvbHBvcyB9O1xyXG5cdFx0XHRcdGlmKCQuaXNGdW5jdGlvbiggY20uZm9ybWF0dGVyICkgKSB7XHJcblx0XHRcdFx0XHR2ID0gY20uZm9ybWF0dGVyLmNhbGwodHMsY2VsbHZhbCxvcHRzLHJ3ZGF0LF9hY3QpO1xyXG5cdFx0XHRcdH0gZWxzZSBpZigkLmZtYXR0ZXIpe1xyXG5cdFx0XHRcdFx0diA9ICQuZm4uZm1hdHRlci5jYWxsKHRzLGNtLmZvcm1hdHRlcixjZWxsdmFsLG9wdHMscndkYXQsX2FjdCk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHYgPSBjZWxsVmFsKGNlbGx2YWwpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR2ID0gY2VsbFZhbChjZWxsdmFsKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gdjtcclxuXHRcdH0sXHJcblx0XHRhZGRDZWxsID0gZnVuY3Rpb24ocm93SWQsY2VsbCxwb3MsaXJvdywgc3J2ciwgcmRhdGEpIHtcclxuXHRcdFx0dmFyIHYscHJwO1xyXG5cdFx0XHR2ID0gZm9ybWF0dGVyKHJvd0lkLGNlbGwscG9zLHNydnIsJ2FkZCcpO1xyXG5cdFx0XHRwcnAgPSBmb3JtYXRDb2woIHBvcyxpcm93LCB2LCBzcnZyLCByb3dJZCwgcmRhdGEpO1xyXG5cdFx0XHRyZXR1cm4gXCI8dGQgcm9sZT1cXFwiZ3JpZGNlbGxcXFwiIFwiK3BycCtcIj5cIit2K1wiPC90ZD5cIjtcclxuXHRcdH0sXHJcblx0XHRhZGRNdWx0aSA9IGZ1bmN0aW9uKHJvd2lkLHBvcyxpcm93LGNoZWNrZWQpe1xyXG5cdFx0XHR2YXJcdHYgPSBcIjxpbnB1dCByb2xlPVxcXCJjaGVja2JveFxcXCIgdHlwZT1cXFwiY2hlY2tib3hcXFwiXCIrXCIgaWQ9XFxcImpxZ19cIit0cy5wLmlkK1wiX1wiK3Jvd2lkK1wiXFxcIiBjbGFzcz1cXFwiY2JveFxcXCIgbmFtZT1cXFwianFnX1wiK3RzLnAuaWQrXCJfXCIrcm93aWQrXCJcXFwiXCIgKyAoY2hlY2tlZCA/IFwiY2hlY2tlZD1cXFwiY2hlY2tlZFxcXCJcIiA6IFwiXCIpK1wiLz5cIixcclxuXHRcdFx0cHJwID0gZm9ybWF0Q29sKCBwb3MsaXJvdywnJyxudWxsLCByb3dpZCwgdHJ1ZSk7XHJcblx0XHRcdHJldHVybiBcIjx0ZCByb2xlPVxcXCJncmlkY2VsbFxcXCIgXCIrcHJwK1wiPlwiK3YrXCI8L3RkPlwiO1xyXG5cdFx0fSxcclxuXHRcdGFkZFJvd051bSA9IGZ1bmN0aW9uIChwb3MsaXJvdyxwRyxyTikge1xyXG5cdFx0XHR2YXIgdiA9ICAocGFyc2VJbnQocEcsMTApLTEpKnBhcnNlSW50KHJOLDEwKSsxK2lyb3csXHJcblx0XHRcdHBycCA9IGZvcm1hdENvbCggcG9zLGlyb3csdiwgbnVsbCwgaXJvdywgdHJ1ZSk7XHJcblx0XHRcdHJldHVybiBcIjx0ZCByb2xlPVxcXCJncmlkY2VsbFxcXCIgY2xhc3M9XFxcInVpLXN0YXRlLWRlZmF1bHQganFncmlkLXJvd251bVxcXCIgXCIrcHJwK1wiPlwiK3YrXCI8L3RkPlwiO1xyXG5cdFx0fSxcclxuXHRcdHJlYWRlciA9IGZ1bmN0aW9uIChkYXRhdHlwZSkge1xyXG5cdFx0XHR2YXIgZmllbGQsIGY9W10sIGo9MCwgaTtcclxuXHRcdFx0Zm9yKGkgPTA7IGk8dHMucC5jb2xNb2RlbC5sZW5ndGg7IGkrKyl7XHJcblx0XHRcdFx0ZmllbGQgPSB0cy5wLmNvbE1vZGVsW2ldO1xyXG5cdFx0XHRcdGlmIChmaWVsZC5uYW1lICE9PSAnY2InICYmIGZpZWxkLm5hbWUgIT09J3N1YmdyaWQnICYmIGZpZWxkLm5hbWUgIT09J3JuJykge1xyXG5cdFx0XHRcdFx0ZltqXT0gZGF0YXR5cGUgPT09IFwibG9jYWxcIiA/XHJcblx0XHRcdFx0XHRmaWVsZC5uYW1lIDpcclxuXHRcdFx0XHRcdCggKGRhdGF0eXBlPT09XCJ4bWxcIiB8fCBkYXRhdHlwZSA9PT0gXCJ4bWxzdHJpbmdcIikgPyBmaWVsZC54bWxtYXAgfHwgZmllbGQubmFtZSA6IGZpZWxkLmpzb25tYXAgfHwgZmllbGQubmFtZSApO1xyXG5cdFx0XHRcdFx0aWYodHMucC5rZXlJbmRleCAhPT0gZmFsc2UgJiYgZmllbGQua2V5PT09dHJ1ZSApIHtcclxuXHRcdFx0XHRcdFx0dHMucC5rZXlOYW1lID0gZltqXTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGorKztcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIGY7XHJcblx0XHR9LFxyXG5cdFx0b3JkZXJlZENvbHMgPSBmdW5jdGlvbiAob2Zmc2V0KSB7XHJcblx0XHRcdHZhciBvcmRlciA9IHRzLnAucmVtYXBDb2x1bW5zO1xyXG5cdFx0XHRpZiAoIW9yZGVyIHx8ICFvcmRlci5sZW5ndGgpIHtcclxuXHRcdFx0XHRvcmRlciA9ICQubWFwKHRzLnAuY29sTW9kZWwsIGZ1bmN0aW9uKHYsaSkgeyByZXR1cm4gaTsgfSk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKG9mZnNldCkge1xyXG5cdFx0XHRcdG9yZGVyID0gJC5tYXAob3JkZXIsIGZ1bmN0aW9uKHYpIHsgcmV0dXJuIHY8b2Zmc2V0P251bGw6di1vZmZzZXQ7IH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBvcmRlcjtcclxuXHRcdH0sXHJcblx0XHRlbXB0eVJvd3MgPSBmdW5jdGlvbiAoc2Nyb2xsLCBsb2NkYXRhKSB7XHJcblx0XHRcdHZhciBmaXJzdHJvdztcclxuXHRcdFx0aWYgKHRoaXMucC5kZWVwZW1wdHkpIHtcclxuXHRcdFx0XHQkKHRoaXMucm93cykuc2xpY2UoMSkucmVtb3ZlKCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Zmlyc3Ryb3cgPSB0aGlzLnJvd3MubGVuZ3RoID4gMCA/IHRoaXMucm93c1swXSA6IG51bGw7XHJcblx0XHRcdFx0JCh0aGlzLmZpcnN0Q2hpbGQpLmVtcHR5KCkuYXBwZW5kKGZpcnN0cm93KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoc2Nyb2xsICYmIHRoaXMucC5zY3JvbGwpIHtcclxuXHRcdFx0XHQkKHRoaXMuZ3JpZC5iRGl2LmZpcnN0Q2hpbGQpLmNzcyh7aGVpZ2h0OiBcImF1dG9cIn0pO1xyXG5cdFx0XHRcdCQodGhpcy5ncmlkLmJEaXYuZmlyc3RDaGlsZC5maXJzdENoaWxkKS5jc3Moe2hlaWdodDogMCwgZGlzcGxheTogXCJub25lXCJ9KTtcclxuXHRcdFx0XHRpZiAodGhpcy5ncmlkLmJEaXYuc2Nyb2xsVG9wICE9PSAwKSB7XHJcblx0XHRcdFx0XHR0aGlzLmdyaWQuYkRpdi5zY3JvbGxUb3AgPSAwO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRpZihsb2NkYXRhID09PSB0cnVlICYmIHRoaXMucC50cmVlR3JpZCkge1xyXG5cdFx0XHRcdHRoaXMucC5kYXRhID0gW107IHRoaXMucC5faW5kZXggPSB7fTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdHJlZnJlc2hJbmRleCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgZGF0YWxlbiA9IHRzLnAuZGF0YS5sZW5ndGgsIGlkbmFtZSwgaSwgdmFsLFxyXG5cdFx0XHRuaSA9IHRzLnAucm93bnVtYmVycz09PXRydWUgPyAxIDowLFxyXG5cdFx0XHRnaSA9IHRzLnAubXVsdGlzZWxlY3QgPT09dHJ1ZSA/IDEgOjAsXHJcblx0XHRcdHNpID0gdHMucC5zdWJHcmlkPT09dHJ1ZSA/IDEgOjA7XHJcblxyXG5cdFx0XHRpZih0cy5wLmtleUluZGV4ID09PSBmYWxzZSB8fCB0cy5wLmxvYWRvbmNlID09PSB0cnVlKSB7XHJcblx0XHRcdFx0aWRuYW1lID0gdHMucC5sb2NhbFJlYWRlci5pZDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpZG5hbWUgPSB0cy5wLmNvbE1vZGVsW3RzLnAua2V5SW5kZXgrZ2krc2krbmldLm5hbWU7XHJcblx0XHRcdH1cclxuXHRcdFx0Zm9yKGkgPTA7aSA8IGRhdGFsZW47IGkrKykge1xyXG5cdFx0XHRcdHZhbCA9ICQuamdyaWQuZ2V0QWNjZXNzb3IodHMucC5kYXRhW2ldLGlkbmFtZSk7XHJcblx0XHRcdFx0aWYgKHZhbCA9PT0gdW5kZWZpbmVkKSB7IHZhbD1TdHJpbmcoaSsxKTsgfVxyXG5cdFx0XHRcdHRzLnAuX2luZGV4W3ZhbF0gPSBpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0Y29uc3RydWN0VHIgPSBmdW5jdGlvbihpZCwgaGlkZSwgYWx0Q2xhc3MsIHJkLCBjdXIsIHNlbGVjdGVkKSB7XHJcblx0XHRcdHZhciB0YWJpbmRleCA9ICctMScsIHJlc3RBdHRyID0gJycsIGF0dHJOYW1lLCBzdHlsZSA9IGhpZGUgPyAnZGlzcGxheTpub25lOycgOiAnJyxcclxuXHRcdFx0XHRjbGFzc2VzID0gJ3VpLXdpZGdldC1jb250ZW50IGpxZ3JvdyB1aS1yb3ctJyArIHRzLnAuZGlyZWN0aW9uICsgKGFsdENsYXNzID8gJyAnICsgYWx0Q2xhc3MgOiAnJykgKyAoc2VsZWN0ZWQgPyAnIHVpLXN0YXRlLWhpZ2hsaWdodCcgOiAnJyksXHJcblx0XHRcdFx0cm93QXR0ck9iaiA9ICQodHMpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkUm93QXR0clwiLCBbcmQsIGN1ciwgaWRdKTtcclxuXHRcdFx0XHRpZiggdHlwZW9mIHJvd0F0dHJPYmogIT09IFwib2JqZWN0XCIgKSB7XHJcblx0XHRcdFx0XHRyb3dBdHRyT2JqID0gICAkLmlzRnVuY3Rpb24odHMucC5yb3dhdHRyKSA/IHRzLnAucm93YXR0ci5jYWxsKHRzLCByZCwgY3VyLCBpZCkgOnt9O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0aWYoISQuaXNFbXB0eU9iamVjdCggcm93QXR0ck9iaiApKSB7XHJcblx0XHRcdFx0aWYgKHJvd0F0dHJPYmouaGFzT3duUHJvcGVydHkoXCJpZFwiKSkge1xyXG5cdFx0XHRcdFx0aWQgPSByb3dBdHRyT2JqLmlkO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHJvd0F0dHJPYmouaWQ7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmIChyb3dBdHRyT2JqLmhhc093blByb3BlcnR5KFwidGFiaW5kZXhcIikpIHtcclxuXHRcdFx0XHRcdHRhYmluZGV4ID0gcm93QXR0ck9iai50YWJpbmRleDtcclxuXHRcdFx0XHRcdGRlbGV0ZSByb3dBdHRyT2JqLnRhYmluZGV4O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAocm93QXR0ck9iai5oYXNPd25Qcm9wZXJ0eShcInN0eWxlXCIpKSB7XHJcblx0XHRcdFx0XHRzdHlsZSArPSByb3dBdHRyT2JqLnN0eWxlO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHJvd0F0dHJPYmouc3R5bGU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmIChyb3dBdHRyT2JqLmhhc093blByb3BlcnR5KFwiY2xhc3NcIikpIHtcclxuXHRcdFx0XHRcdGNsYXNzZXMgKz0gJyAnICsgcm93QXR0ck9ialsnY2xhc3MnXTtcclxuXHRcdFx0XHRcdGRlbGV0ZSByb3dBdHRyT2JqWydjbGFzcyddO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvLyBkb3QndCBhbGxvdyB0byBjaGFuZ2Ugcm9sZSBhdHRyaWJ1dGVcclxuXHRcdFx0XHR0cnkgeyBkZWxldGUgcm93QXR0ck9iai5yb2xlOyB9IGNhdGNoKHJhKXt9XHJcblx0XHRcdFx0Zm9yIChhdHRyTmFtZSBpbiByb3dBdHRyT2JqKSB7XHJcblx0XHRcdFx0XHRpZiAocm93QXR0ck9iai5oYXNPd25Qcm9wZXJ0eShhdHRyTmFtZSkpIHtcclxuXHRcdFx0XHRcdFx0cmVzdEF0dHIgKz0gJyAnICsgYXR0ck5hbWUgKyAnPScgKyByb3dBdHRyT2JqW2F0dHJOYW1lXTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuICc8dHIgcm9sZT1cInJvd1wiIGlkPVwiJyArIGlkICsgJ1wiIHRhYmluZGV4PVwiJyArIHRhYmluZGV4ICsgJ1wiIGNsYXNzPVwiJyArIGNsYXNzZXMgKyAnXCInICtcclxuXHRcdFx0XHQoc3R5bGUgPT09ICcnID8gJycgOiAnIHN0eWxlPVwiJyArIHN0eWxlICsgJ1wiJykgKyByZXN0QXR0ciArICc+JztcclxuXHRcdH0sXHJcblx0XHRhZGRYbWxEYXRhID0gZnVuY3Rpb24gKHhtbCx0LCByY250LCBtb3JlLCBhZGp1c3QpIHtcclxuXHRcdFx0dmFyIHN0YXJ0UmVxID0gbmV3IERhdGUoKSxcclxuXHRcdFx0bG9jZGF0YSA9ICh0cy5wLmRhdGF0eXBlICE9PSBcImxvY2FsXCIgJiYgdHMucC5sb2Fkb25jZSkgfHwgdHMucC5kYXRhdHlwZSA9PT0gXCJ4bWxzdHJpbmdcIixcclxuXHRcdFx0eG1saWQgPSBcIl9pZF9cIiwgeG1sUmQgPSB0cy5wLnhtbFJlYWRlcixcclxuXHRcdFx0ZnJkID0gdHMucC5kYXRhdHlwZSA9PT0gXCJsb2NhbFwiID8gXCJsb2NhbFwiIDogXCJ4bWxcIjtcclxuXHRcdFx0aWYobG9jZGF0YSkge1xyXG5cdFx0XHRcdHRzLnAuZGF0YSA9IFtdO1xyXG5cdFx0XHRcdHRzLnAuX2luZGV4ID0ge307XHJcblx0XHRcdFx0dHMucC5sb2NhbFJlYWRlci5pZCA9IHhtbGlkO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRzLnAucmVjY291bnQgPSAwO1xyXG5cdFx0XHRpZigkLmlzWE1MRG9jKHhtbCkpIHtcclxuXHRcdFx0XHRpZih0cy5wLnRyZWVBTm9kZT09PS0xICYmICF0cy5wLnNjcm9sbCkge1xyXG5cdFx0XHRcdFx0ZW1wdHlSb3dzLmNhbGwodHMsIGZhbHNlLCB0cnVlKTtcclxuXHRcdFx0XHRcdHJjbnQ9MTtcclxuXHRcdFx0XHR9IGVsc2UgeyByY250ID0gcmNudCA+IDEgPyByY250IDoxOyB9XHJcblx0XHRcdH0gZWxzZSB7IHJldHVybjsgfVxyXG5cdFx0XHR2YXIgc2VsZj0gJCh0cyksIGksZnBvcyxpcj0wLHYsZ2k9dHMucC5tdWx0aXNlbGVjdD09PXRydWU/MTowLHNpPTAsYWRkU3ViR3JpZENlbGwsbmk9dHMucC5yb3dudW1iZXJzPT09dHJ1ZT8xOjAsaWRuLCBnZXRJZCxmPVtdLEYscmQgPXt9LCB4bWxyLHJpZCwgcm93RGF0YT1bXSwgY249KHRzLnAuYWx0Um93cyA9PT0gdHJ1ZSkgPyB0cy5wLmFsdGNsYXNzOlwiXCIsY24xO1xyXG5cdFx0XHRpZih0cy5wLnN1YkdyaWQ9PT10cnVlKSB7XHJcblx0XHRcdFx0c2kgPSAxO1xyXG5cdFx0XHRcdGFkZFN1YkdyaWRDZWxsID0gJC5qZ3JpZC5nZXRNZXRob2QoXCJhZGRTdWJHcmlkQ2VsbFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZigheG1sUmQucmVwZWF0aXRlbXMpIHtmID0gcmVhZGVyKGZyZCk7fVxyXG5cdFx0XHRpZiggdHMucC5rZXlJbmRleD09PWZhbHNlKSB7XHJcblx0XHRcdFx0aWRuID0gJC5pc0Z1bmN0aW9uKCB4bWxSZC5pZCApID8gIHhtbFJkLmlkLmNhbGwodHMsIHhtbCkgOiB4bWxSZC5pZDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpZG4gPSB0cy5wLmtleUluZGV4O1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKGYubGVuZ3RoPjAgJiYgIWlzTmFOKGlkbikpIHtcclxuXHRcdFx0XHRpZG49dHMucC5rZXlOYW1lO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKCBTdHJpbmcoaWRuKS5pbmRleE9mKFwiW1wiKSA9PT0gLTEgKSB7XHJcblx0XHRcdFx0aWYgKGYubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRnZXRJZCA9IGZ1bmN0aW9uKCB0cm93LCBrKSB7cmV0dXJuICQoaWRuLHRyb3cpLnRleHQoKSB8fCBrO307XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGdldElkID0gZnVuY3Rpb24oIHRyb3csIGspIHtyZXR1cm4gJCh4bWxSZC5jZWxsLHRyb3cpLmVxKGlkbikudGV4dCgpIHx8IGs7fTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0Z2V0SWQgPSBmdW5jdGlvbiggdHJvdywgaykge3JldHVybiB0cm93LmdldEF0dHJpYnV0ZShpZG4ucmVwbGFjZSgvW1xcW1xcXV0vZyxcIlwiKSkgfHwgazt9O1xyXG5cdFx0XHR9XHJcblx0XHRcdHRzLnAudXNlckRhdGEgPSB7fTtcclxuXHRcdFx0dHMucC5wYWdlID0gaW50TnVtKCQuamdyaWQuZ2V0WG1sRGF0YSh4bWwsIHhtbFJkLnBhZ2UpLCB0cy5wLnBhZ2UpO1xyXG5cdFx0XHR0cy5wLmxhc3RwYWdlID0gaW50TnVtKCQuamdyaWQuZ2V0WG1sRGF0YSh4bWwsIHhtbFJkLnRvdGFsKSwgMSk7XHJcblx0XHRcdHRzLnAucmVjb3JkcyA9IGludE51bSgkLmpncmlkLmdldFhtbERhdGEoeG1sLCB4bWxSZC5yZWNvcmRzKSk7XHJcblx0XHRcdGlmKCQuaXNGdW5jdGlvbih4bWxSZC51c2VyZGF0YSkpIHtcclxuXHRcdFx0XHR0cy5wLnVzZXJEYXRhID0geG1sUmQudXNlcmRhdGEuY2FsbCh0cywgeG1sKSB8fCB7fTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQkLmpncmlkLmdldFhtbERhdGEoeG1sLCB4bWxSZC51c2VyZGF0YSwgdHJ1ZSkuZWFjaChmdW5jdGlvbigpIHt0cy5wLnVzZXJEYXRhW3RoaXMuZ2V0QXR0cmlidXRlKFwibmFtZVwiKV09ICQodGhpcykudGV4dCgpO30pO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciBneG1sID0gJC5qZ3JpZC5nZXRYbWxEYXRhKCB4bWwsIHhtbFJkLnJvb3QsIHRydWUpO1xyXG5cdFx0XHRneG1sID0gJC5qZ3JpZC5nZXRYbWxEYXRhKCBneG1sLCB4bWxSZC5yb3csIHRydWUpO1xyXG5cdFx0XHRpZiAoIWd4bWwpIHsgZ3htbCA9IFtdOyB9XHJcblx0XHRcdHZhciBnbCA9IGd4bWwubGVuZ3RoLCBqPTAsIGdycGRhdGE9W10sIHJuID0gcGFyc2VJbnQodHMucC5yb3dOdW0sMTApLCBicj10cy5wLnNjcm9sbD8kLmpncmlkLnJhbmRJZCgpOjEsIGFsdHI7XHJcblx0XHRcdGlmIChnbCA+IDAgJiYgIHRzLnAucGFnZSA8PSAwKSB7IHRzLnAucGFnZSA9IDE7IH1cclxuXHRcdFx0aWYoZ3htbCAmJiBnbCl7XHJcblx0XHRcdGlmIChhZGp1c3QpIHsgcm4gKj0gYWRqdXN0KzE7IH1cclxuXHRcdFx0dmFyIGFmdGVySW5zUm93ID0gJC5pc0Z1bmN0aW9uKHRzLnAuYWZ0ZXJJbnNlcnRSb3cpLCBoaWRlcm93PWZhbHNlLCBncm91cGluZ1ByZXBhcmU7XHJcblx0XHRcdGlmKHRzLnAuZ3JvdXBpbmcpICB7XHJcblx0XHRcdFx0aGlkZXJvdyA9IHRzLnAuZ3JvdXBpbmdWaWV3Lmdyb3VwQ29sbGFwc2UgPT09IHRydWU7XHJcblx0XHRcdFx0Z3JvdXBpbmdQcmVwYXJlID0gJC5qZ3JpZC5nZXRNZXRob2QoXCJncm91cGluZ1ByZXBhcmVcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0d2hpbGUgKGo8Z2wpIHtcclxuXHRcdFx0XHR4bWxyID0gZ3htbFtqXTtcclxuXHRcdFx0XHRyaWQgPSBnZXRJZCh4bWxyLGJyK2opO1xyXG5cdFx0XHRcdHJpZCAgPSB0cy5wLmlkUHJlZml4ICsgcmlkO1xyXG5cdFx0XHRcdGFsdHIgPSByY250ID09PSAwID8gMCA6IHJjbnQrMTtcclxuXHRcdFx0XHRjbjEgPSAoYWx0citqKSUyID09PSAxID8gY24gOiAnJztcclxuXHRcdFx0XHR2YXIgaVN0YXJ0VHJUYWcgPSByb3dEYXRhLmxlbmd0aDtcclxuXHRcdFx0XHRyb3dEYXRhLnB1c2goXCJcIik7XHJcblx0XHRcdFx0aWYoIG5pICkge1xyXG5cdFx0XHRcdFx0cm93RGF0YS5wdXNoKCBhZGRSb3dOdW0oMCxqLHRzLnAucGFnZSx0cy5wLnJvd051bSkgKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoIGdpICkge1xyXG5cdFx0XHRcdFx0cm93RGF0YS5wdXNoKCBhZGRNdWx0aShyaWQsbmksaiwgZmFsc2UpICk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKCBzaSApIHtcclxuXHRcdFx0XHRcdHJvd0RhdGEucHVzaCggYWRkU3ViR3JpZENlbGwuY2FsbChzZWxmLGdpK25pLGorcmNudCkgKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoeG1sUmQucmVwZWF0aXRlbXMpe1xyXG5cdFx0XHRcdFx0aWYgKCFGKSB7IEY9b3JkZXJlZENvbHMoZ2krc2krbmkpOyB9XHJcblx0XHRcdFx0XHR2YXIgY2VsbHMgPSAkLmpncmlkLmdldFhtbERhdGEoIHhtbHIsIHhtbFJkLmNlbGwsIHRydWUpO1xyXG5cdFx0XHRcdFx0JC5lYWNoKEYsIGZ1bmN0aW9uIChrKSB7XHJcblx0XHRcdFx0XHRcdHZhciBjZWxsID0gY2VsbHNbdGhpc107XHJcblx0XHRcdFx0XHRcdGlmICghY2VsbCkgeyByZXR1cm4gZmFsc2U7IH1cclxuXHRcdFx0XHRcdFx0diA9IGNlbGwudGV4dENvbnRlbnQgfHwgY2VsbC50ZXh0O1xyXG5cdFx0XHRcdFx0XHRyZFt0cy5wLmNvbE1vZGVsW2srZ2krc2krbmldLm5hbWVdID0gdjtcclxuXHRcdFx0XHRcdFx0cm93RGF0YS5wdXNoKCBhZGRDZWxsKHJpZCx2LGsrZ2krc2krbmksaityY250LHhtbHIsIHJkKSApO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGZvcihpID0gMDsgaSA8IGYubGVuZ3RoO2krKykge1xyXG5cdFx0XHRcdFx0XHR2ID0gJC5qZ3JpZC5nZXRYbWxEYXRhKCB4bWxyLCBmW2ldKTtcclxuXHRcdFx0XHRcdFx0cmRbdHMucC5jb2xNb2RlbFtpK2dpK3NpK25pXS5uYW1lXSA9IHY7XHJcblx0XHRcdFx0XHRcdHJvd0RhdGEucHVzaCggYWRkQ2VsbChyaWQsIHYsIGkrZ2krc2krbmksIGorcmNudCwgeG1sciwgcmQpICk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJvd0RhdGFbaVN0YXJ0VHJUYWddID0gY29uc3RydWN0VHIocmlkLCBoaWRlcm93LCBjbjEsIHJkLCB4bWxyLCBmYWxzZSk7XHJcblx0XHRcdFx0cm93RGF0YS5wdXNoKFwiPC90cj5cIik7XHJcblx0XHRcdFx0aWYodHMucC5ncm91cGluZykge1xyXG5cdFx0XHRcdFx0Z3JwZGF0YS5wdXNoKCByb3dEYXRhICk7XHJcblx0XHRcdFx0XHRpZighdHMucC5ncm91cGluZ1ZpZXcuX2xvY2dyKSB7XHJcblx0XHRcdFx0XHRcdGdyb3VwaW5nUHJlcGFyZS5jYWxsKHNlbGYsIHJkLCBqICk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyb3dEYXRhID0gW107XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKGxvY2RhdGEgfHwgdHMucC50cmVlR3JpZCA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdFx0cmRbeG1saWRdID0gJC5qZ3JpZC5zdHJpcFByZWYodHMucC5pZFByZWZpeCwgcmlkKTtcclxuXHRcdFx0XHRcdHRzLnAuZGF0YS5wdXNoKHJkKTtcclxuXHRcdFx0XHRcdHRzLnAuX2luZGV4W3JkW3htbGlkXV0gPSB0cy5wLmRhdGEubGVuZ3RoLTE7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKHRzLnAuZ3JpZHZpZXcgPT09IGZhbHNlICkge1xyXG5cdFx0XHRcdFx0JChcInRib2R5OmZpcnN0XCIsdCkuYXBwZW5kKHJvd0RhdGEuam9pbignJykpO1xyXG5cdFx0XHRcdFx0c2VsZi50cmlnZ2VySGFuZGxlcihcImpxR3JpZEFmdGVySW5zZXJ0Um93XCIsIFtyaWQsIHJkLCB4bWxyXSk7XHJcblx0XHRcdFx0XHRpZihhZnRlckluc1Jvdykge3RzLnAuYWZ0ZXJJbnNlcnRSb3cuY2FsbCh0cyxyaWQscmQseG1scik7fVxyXG5cdFx0XHRcdFx0cm93RGF0YT1bXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmQ9e307XHJcblx0XHRcdFx0aXIrKztcclxuXHRcdFx0XHRqKys7XHJcblx0XHRcdFx0aWYoaXI9PT1ybikge2JyZWFrO31cclxuXHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHRzLnAuZ3JpZHZpZXcgPT09IHRydWUpIHtcclxuXHRcdFx0XHRmcG9zID0gdHMucC50cmVlQU5vZGUgPiAtMSA/IHRzLnAudHJlZUFOb2RlOiAwO1xyXG5cdFx0XHRcdGlmKHRzLnAuZ3JvdXBpbmcpIHtcclxuXHRcdFx0XHRcdGlmKCFsb2NkYXRhKSB7XHJcblx0XHRcdFx0XHRcdHNlbGYuanFHcmlkKCdncm91cGluZ1JlbmRlcicsZ3JwZGF0YSx0cy5wLmNvbE1vZGVsLmxlbmd0aCwgdHMucC5wYWdlLCBybik7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRncnBkYXRhID0gbnVsbDtcclxuXHRcdFx0XHR9IGVsc2UgaWYodHMucC50cmVlR3JpZCA9PT0gdHJ1ZSAmJiBmcG9zID4gMCkge1xyXG5cdFx0XHRcdFx0JCh0cy5yb3dzW2Zwb3NdKS5hZnRlcihyb3dEYXRhLmpvaW4oJycpKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JChcInRib2R5OmZpcnN0XCIsdCkuYXBwZW5kKHJvd0RhdGEuam9pbignJykpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRpZih0cy5wLnN1YkdyaWQgPT09IHRydWUgKSB7XHJcblx0XHRcdFx0dHJ5IHtzZWxmLmpxR3JpZChcImFkZFN1YkdyaWRcIixnaStuaSk7fSBjYXRjaCAoXyl7fVxyXG5cdFx0XHR9XHJcblx0XHRcdHRzLnAudG90YWx0aW1lID0gbmV3IERhdGUoKSAtIHN0YXJ0UmVxO1xyXG5cdFx0XHRpZihpcj4wKSB7IGlmKHRzLnAucmVjb3Jkcz09PTApIHsgdHMucC5yZWNvcmRzPWdsO30gfVxyXG5cdFx0XHRyb3dEYXRhID1udWxsO1xyXG5cdFx0XHRpZiggdHMucC50cmVlR3JpZCA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdHRyeSB7c2VsZi5qcUdyaWQoXCJzZXRUcmVlTm9kZVwiLCBmcG9zKzEsIGlyK2Zwb3MrMSk7fSBjYXRjaCAoZSkge31cclxuXHRcdFx0fVxyXG5cdFx0XHRpZighdHMucC50cmVlR3JpZCAmJiAhdHMucC5zY3JvbGwpIHt0cy5ncmlkLmJEaXYuc2Nyb2xsVG9wID0gMDt9XHJcblx0XHRcdHRzLnAucmVjY291bnQ9aXI7XHJcblx0XHRcdHRzLnAudHJlZUFOb2RlID0gLTE7XHJcblx0XHRcdGlmKHRzLnAudXNlckRhdGFPbkZvb3RlcikgeyBzZWxmLmpxR3JpZChcImZvb3RlckRhdGFcIixcInNldFwiLHRzLnAudXNlckRhdGEsdHJ1ZSk7IH1cclxuXHRcdFx0aWYobG9jZGF0YSkge1xyXG5cdFx0XHRcdHRzLnAucmVjb3JkcyA9IGdsO1xyXG5cdFx0XHRcdHRzLnAubGFzdHBhZ2UgPSBNYXRoLmNlaWwoZ2wvIHJuKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoIW1vcmUpIHsgdHMudXBkYXRlcGFnZXIoZmFsc2UsdHJ1ZSk7IH1cclxuXHRcdFx0aWYobG9jZGF0YSkge1xyXG5cdFx0XHRcdHdoaWxlIChpcjxnbCkge1xyXG5cdFx0XHRcdFx0eG1sciA9IGd4bWxbaXJdO1xyXG5cdFx0XHRcdFx0cmlkID0gZ2V0SWQoeG1scixpciticik7XHJcblx0XHRcdFx0XHRyaWQgID0gdHMucC5pZFByZWZpeCArIHJpZDtcclxuXHRcdFx0XHRcdGlmKHhtbFJkLnJlcGVhdGl0ZW1zKXtcclxuXHRcdFx0XHRcdFx0aWYgKCFGKSB7IEY9b3JkZXJlZENvbHMoZ2krc2krbmkpOyB9XHJcblx0XHRcdFx0XHRcdHZhciBjZWxsczIgPSAkLmpncmlkLmdldFhtbERhdGEoIHhtbHIsIHhtbFJkLmNlbGwsIHRydWUpO1xyXG5cdFx0XHRcdFx0XHQkLmVhY2goRiwgZnVuY3Rpb24gKGspIHtcclxuXHRcdFx0XHRcdFx0XHR2YXIgY2VsbCA9IGNlbGxzMlt0aGlzXTtcclxuXHRcdFx0XHRcdFx0XHRpZiAoIWNlbGwpIHsgcmV0dXJuIGZhbHNlOyB9XHJcblx0XHRcdFx0XHRcdFx0diA9IGNlbGwudGV4dENvbnRlbnQgfHwgY2VsbC50ZXh0O1xyXG5cdFx0XHRcdFx0XHRcdHJkW3RzLnAuY29sTW9kZWxbaytnaStzaStuaV0ubmFtZV0gPSB2O1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdGZvcihpID0gMDsgaSA8IGYubGVuZ3RoO2krKykge1xyXG5cdFx0XHRcdFx0XHRcdHYgPSAkLmpncmlkLmdldFhtbERhdGEoIHhtbHIsIGZbaV0pO1xyXG5cdFx0XHRcdFx0XHRcdHJkW3RzLnAuY29sTW9kZWxbaStnaStzaStuaV0ubmFtZV0gPSB2O1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZFt4bWxpZF0gPSAkLmpncmlkLnN0cmlwUHJlZih0cy5wLmlkUHJlZml4LCByaWQpO1xyXG5cdFx0XHRcdFx0aWYodHMucC5ncm91cGluZykge1xyXG5cdFx0XHRcdFx0XHRncm91cGluZ1ByZXBhcmUuY2FsbChzZWxmLCByZCwgaXIgKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHRzLnAuZGF0YS5wdXNoKHJkKTtcclxuXHRcdFx0XHRcdHRzLnAuX2luZGV4W3JkW3htbGlkXV0gPSB0cy5wLmRhdGEubGVuZ3RoLTE7XHJcblx0XHRcdFx0XHRyZCA9IHt9O1xyXG5cdFx0XHRcdFx0aXIrKztcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYodHMucC5ncm91cGluZykge1xyXG5cdFx0XHRcdFx0dHMucC5ncm91cGluZ1ZpZXcuX2xvY2dyID0gdHJ1ZTtcclxuXHRcdFx0XHRcdHNlbGYuanFHcmlkKCdncm91cGluZ1JlbmRlcicsIGdycGRhdGEsIHRzLnAuY29sTW9kZWwubGVuZ3RoLCB0cy5wLnBhZ2UsIHJuKTtcclxuXHRcdFx0XHRcdGdycGRhdGEgPSBudWxsO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdGFkZEpTT05EYXRhID0gZnVuY3Rpb24oZGF0YSx0LCByY250LCBtb3JlLCBhZGp1c3QpIHtcclxuXHRcdFx0dmFyIHN0YXJ0UmVxID0gbmV3IERhdGUoKTtcclxuXHRcdFx0aWYoZGF0YSkge1xyXG5cdFx0XHRcdGlmKHRzLnAudHJlZUFOb2RlID09PSAtMSAmJiAhdHMucC5zY3JvbGwpIHtcclxuXHRcdFx0XHRcdGVtcHR5Um93cy5jYWxsKHRzLCBmYWxzZSwgdHJ1ZSk7XHJcblx0XHRcdFx0XHRyY250PTE7XHJcblx0XHRcdFx0fSBlbHNlIHsgcmNudCA9IHJjbnQgPiAxID8gcmNudCA6MTsgfVxyXG5cdFx0XHR9IGVsc2UgeyByZXR1cm47IH1cclxuXHJcblx0XHRcdHZhciBkUmVhZGVyLCBsb2NpZCA9IFwiX2lkX1wiLCBmcmQsXHJcblx0XHRcdGxvY2RhdGEgPSAodHMucC5kYXRhdHlwZSAhPT0gXCJsb2NhbFwiICYmIHRzLnAubG9hZG9uY2UpIHx8IHRzLnAuZGF0YXR5cGUgPT09IFwianNvbnN0cmluZ1wiO1xyXG5cdFx0XHRpZihsb2NkYXRhKSB7IHRzLnAuZGF0YSA9IFtdOyB0cy5wLl9pbmRleCA9IHt9OyB0cy5wLmxvY2FsUmVhZGVyLmlkID0gbG9jaWQ7fVxyXG5cdFx0XHR0cy5wLnJlY2NvdW50ID0gMDtcclxuXHRcdFx0aWYodHMucC5kYXRhdHlwZSA9PT0gXCJsb2NhbFwiKSB7XHJcblx0XHRcdFx0ZFJlYWRlciA9ICB0cy5wLmxvY2FsUmVhZGVyO1xyXG5cdFx0XHRcdGZyZD0gJ2xvY2FsJztcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRkUmVhZGVyID0gIHRzLnAuanNvblJlYWRlcjtcclxuXHRcdFx0XHRmcmQ9J2pzb24nO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciBzZWxmID0gJCh0cyksIGlyPTAsdixpLGosZj1bXSxjdXIsZ2k9dHMucC5tdWx0aXNlbGVjdD8xOjAsc2k9dHMucC5zdWJHcmlkPT09dHJ1ZT8xOjAsYWRkU3ViR3JpZENlbGwsbmk9dHMucC5yb3dudW1iZXJzPT09dHJ1ZT8xOjAsYXJyYXlSZWFkZXI9b3JkZXJlZENvbHMoZ2krc2krbmkpLG9iamVjdFJlYWRlcj1yZWFkZXIoZnJkKSxyb3dSZWFkZXIsbGVuLGRyb3dzLGlkbixyZD17fSwgZnBvcywgaWRyLHJvd0RhdGE9W10sY249KHRzLnAuYWx0Um93cyA9PT0gdHJ1ZSkgPyB0cy5wLmFsdGNsYXNzOlwiXCIsY24xO1xyXG5cdFx0XHR0cy5wLnBhZ2UgPSBpbnROdW0oJC5qZ3JpZC5nZXRBY2Nlc3NvcihkYXRhLGRSZWFkZXIucGFnZSksIHRzLnAucGFnZSk7XHJcblx0XHRcdHRzLnAubGFzdHBhZ2UgPSBpbnROdW0oJC5qZ3JpZC5nZXRBY2Nlc3NvcihkYXRhLGRSZWFkZXIudG90YWwpLCAxKTtcclxuXHRcdFx0dHMucC5yZWNvcmRzID0gaW50TnVtKCQuamdyaWQuZ2V0QWNjZXNzb3IoZGF0YSxkUmVhZGVyLnJlY29yZHMpKTtcclxuXHRcdFx0dHMucC51c2VyRGF0YSA9ICQuamdyaWQuZ2V0QWNjZXNzb3IoZGF0YSxkUmVhZGVyLnVzZXJkYXRhKSB8fCB7fTtcclxuXHRcdFx0aWYoc2kpIHtcclxuXHRcdFx0XHRhZGRTdWJHcmlkQ2VsbCA9ICQuamdyaWQuZ2V0TWV0aG9kKFwiYWRkU3ViR3JpZENlbGxcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoIHRzLnAua2V5SW5kZXg9PT1mYWxzZSApIHtcclxuXHRcdFx0XHRpZG4gPSAkLmlzRnVuY3Rpb24oZFJlYWRlci5pZCkgPyBkUmVhZGVyLmlkLmNhbGwodHMsIGRhdGEpIDogZFJlYWRlci5pZDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpZG4gPSB0cy5wLmtleUluZGV4O1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKCFkUmVhZGVyLnJlcGVhdGl0ZW1zKSB7XHJcblx0XHRcdFx0ZiA9IG9iamVjdFJlYWRlcjtcclxuXHRcdFx0XHRpZihmLmxlbmd0aD4wICYmICFpc05hTihpZG4pKSB7XHJcblx0XHRcdFx0XHRpZG49dHMucC5rZXlOYW1lO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRkcm93cyA9ICQuamdyaWQuZ2V0QWNjZXNzb3IoZGF0YSxkUmVhZGVyLnJvb3QpO1xyXG5cdFx0XHRpZiAoZHJvd3MgPT0gbnVsbCAmJiAkLmlzQXJyYXkoZGF0YSkpIHsgZHJvd3MgPSBkYXRhOyB9XHJcblx0XHRcdGlmICghZHJvd3MpIHsgZHJvd3MgPSBbXTsgfVxyXG5cdFx0XHRsZW4gPSBkcm93cy5sZW5ndGg7IGk9MDtcclxuXHRcdFx0aWYgKGxlbiA+IDAgJiYgdHMucC5wYWdlIDw9IDApIHsgdHMucC5wYWdlID0gMTsgfVxyXG5cdFx0XHR2YXIgcm4gPSBwYXJzZUludCh0cy5wLnJvd051bSwxMCksYnI9dHMucC5zY3JvbGw/JC5qZ3JpZC5yYW5kSWQoKToxLCBhbHRyLCBzZWxlY3RlZD1mYWxzZSwgc2VscjtcclxuXHRcdFx0aWYgKGFkanVzdCkgeyBybiAqPSBhZGp1c3QrMTsgfVxyXG5cdFx0XHRpZih0cy5wLmRhdGF0eXBlID09PSBcImxvY2FsXCIgJiYgIXRzLnAuZGVzZWxlY3RBZnRlclNvcnQpIHtcclxuXHRcdFx0XHRzZWxlY3RlZCA9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIGFmdGVySW5zUm93ID0gJC5pc0Z1bmN0aW9uKHRzLnAuYWZ0ZXJJbnNlcnRSb3cpLCBncnBkYXRhPVtdLGhpZGVyb3c9ZmFsc2UsIGdyb3VwaW5nUHJlcGFyZTtcclxuXHRcdFx0aWYodHMucC5ncm91cGluZykgIHtcclxuXHRcdFx0XHRoaWRlcm93ID0gdHMucC5ncm91cGluZ1ZpZXcuZ3JvdXBDb2xsYXBzZSA9PT0gdHJ1ZTtcclxuXHRcdFx0XHRncm91cGluZ1ByZXBhcmUgPSAkLmpncmlkLmdldE1ldGhvZChcImdyb3VwaW5nUHJlcGFyZVwiKTtcclxuXHRcdFx0fVxyXG5cdFx0XHR3aGlsZSAoaTxsZW4pIHtcclxuXHRcdFx0XHRjdXIgPSBkcm93c1tpXTtcclxuXHRcdFx0XHRpZHIgPSAkLmpncmlkLmdldEFjY2Vzc29yKGN1cixpZG4pO1xyXG5cdFx0XHRcdGlmKGlkciA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRpZiAodHlwZW9mIGlkbiA9PT0gXCJudW1iZXJcIiAmJiB0cy5wLmNvbE1vZGVsW2lkbitnaStzaStuaV0gIT0gbnVsbCkge1xyXG5cdFx0XHRcdFx0XHQvLyByZXJlYWQgaWQgYnkgbmFtZVxyXG5cdFx0XHRcdFx0XHRpZHIgPSAkLmpncmlkLmdldEFjY2Vzc29yKGN1cix0cy5wLmNvbE1vZGVsW2lkbitnaStzaStuaV0ubmFtZSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZihpZHIgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0XHRpZHIgPSBicitpO1xyXG5cdFx0XHRcdFx0XHRpZihmLmxlbmd0aD09PTApe1xyXG5cdFx0XHRcdFx0XHRcdGlmKGRSZWFkZXIuY2VsbCl7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgY2N1ciA9ICQuamdyaWQuZ2V0QWNjZXNzb3IoY3VyLGRSZWFkZXIuY2VsbCkgfHwgY3VyO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWRyID0gY2N1ciAhPSBudWxsICYmIGNjdXJbaWRuXSAhPT0gdW5kZWZpbmVkID8gY2N1cltpZG5dIDogaWRyO1xyXG5cdFx0XHRcdFx0XHRcdFx0Y2N1cj1udWxsO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZHIgID0gdHMucC5pZFByZWZpeCArIGlkcjtcclxuXHRcdFx0XHRhbHRyID0gcmNudCA9PT0gMSA/IDAgOiByY250O1xyXG5cdFx0XHRcdGNuMSA9IChhbHRyK2kpJTIgPT09IDEgPyBjbiA6ICcnO1xyXG5cdFx0XHRcdGlmKCBzZWxlY3RlZCkge1xyXG5cdFx0XHRcdFx0aWYoIHRzLnAubXVsdGlzZWxlY3QpIHtcclxuXHRcdFx0XHRcdFx0c2VsciA9ICgkLmluQXJyYXkoaWRyLCB0cy5wLnNlbGFycnJvdykgIT09IC0xKTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHNlbHIgPSAoaWRyID09PSB0cy5wLnNlbHJvdyk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHZhciBpU3RhcnRUclRhZyA9IHJvd0RhdGEubGVuZ3RoO1xyXG5cdFx0XHRcdHJvd0RhdGEucHVzaChcIlwiKTtcclxuXHRcdFx0XHRpZiggbmkgKSB7XHJcblx0XHRcdFx0XHRyb3dEYXRhLnB1c2goIGFkZFJvd051bSgwLGksdHMucC5wYWdlLHRzLnAucm93TnVtKSApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiggZ2kgKXtcclxuXHRcdFx0XHRcdHJvd0RhdGEucHVzaCggYWRkTXVsdGkoaWRyLG5pLGksc2VscikgKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoIHNpICkge1xyXG5cdFx0XHRcdFx0cm93RGF0YS5wdXNoKCBhZGRTdWJHcmlkQ2VsbC5jYWxsKHNlbGYsZ2krbmksaStyY250KSApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyb3dSZWFkZXI9b2JqZWN0UmVhZGVyO1xyXG5cdFx0XHRcdGlmIChkUmVhZGVyLnJlcGVhdGl0ZW1zKSB7XHJcblx0XHRcdFx0XHRpZihkUmVhZGVyLmNlbGwpIHtjdXIgPSAkLmpncmlkLmdldEFjY2Vzc29yKGN1cixkUmVhZGVyLmNlbGwpIHx8IGN1cjt9XHJcblx0XHRcdFx0XHRpZiAoJC5pc0FycmF5KGN1cikpIHsgcm93UmVhZGVyPWFycmF5UmVhZGVyOyB9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGZvciAoaj0wO2o8cm93UmVhZGVyLmxlbmd0aDtqKyspIHtcclxuXHRcdFx0XHRcdHYgPSAkLmpncmlkLmdldEFjY2Vzc29yKGN1cixyb3dSZWFkZXJbal0pO1xyXG5cdFx0XHRcdFx0cmRbdHMucC5jb2xNb2RlbFtqK2dpK3NpK25pXS5uYW1lXSA9IHY7XHJcblx0XHRcdFx0XHRyb3dEYXRhLnB1c2goIGFkZENlbGwoaWRyLHYsaitnaStzaStuaSxpK3JjbnQsY3VyLCByZCkgKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cm93RGF0YVtpU3RhcnRUclRhZ10gPSBjb25zdHJ1Y3RUcihpZHIsIGhpZGVyb3csIGNuMSwgcmQsIGN1ciwgc2Vscik7XHJcblx0XHRcdFx0cm93RGF0YS5wdXNoKCBcIjwvdHI+XCIgKTtcclxuXHRcdFx0XHRpZih0cy5wLmdyb3VwaW5nKSB7XHJcblx0XHRcdFx0XHRncnBkYXRhLnB1c2goIHJvd0RhdGEgKTtcclxuXHRcdFx0XHRcdGlmKCF0cy5wLmdyb3VwaW5nVmlldy5fbG9jZ3IpIHtcclxuXHRcdFx0XHRcdFx0Z3JvdXBpbmdQcmVwYXJlLmNhbGwoc2VsZiwgcmQsIGkpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0cm93RGF0YSA9IFtdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihsb2NkYXRhIHx8IHRzLnAudHJlZUdyaWQ9PT10cnVlKSB7XHJcblx0XHRcdFx0XHRyZFtsb2NpZF0gPSAkLmpncmlkLnN0cmlwUHJlZih0cy5wLmlkUHJlZml4LCBpZHIpO1xyXG5cdFx0XHRcdFx0dHMucC5kYXRhLnB1c2gocmQpO1xyXG5cdFx0XHRcdFx0dHMucC5faW5kZXhbcmRbbG9jaWRdXSA9IHRzLnAuZGF0YS5sZW5ndGgtMTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYodHMucC5ncmlkdmlldyA9PT0gZmFsc2UgKSB7XHJcblx0XHRcdFx0XHQkKFwiI1wiKyQuamdyaWQuanFJRCh0cy5wLmlkKStcIiB0Ym9keTpmaXJzdFwiKS5hcHBlbmQocm93RGF0YS5qb2luKCcnKSk7XHJcblx0XHRcdFx0XHRzZWxmLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWZ0ZXJJbnNlcnRSb3dcIiwgW2lkciwgcmQsIGN1cl0pO1xyXG5cdFx0XHRcdFx0aWYoYWZ0ZXJJbnNSb3cpIHt0cy5wLmFmdGVySW5zZXJ0Um93LmNhbGwodHMsaWRyLHJkLGN1cik7fVxyXG5cdFx0XHRcdFx0cm93RGF0YT1bXTsvL2FyaT0wO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZD17fTtcclxuXHRcdFx0XHRpcisrO1xyXG5cdFx0XHRcdGkrKztcclxuXHRcdFx0XHRpZihpcj09PXJuKSB7IGJyZWFrOyB9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYodHMucC5ncmlkdmlldyA9PT0gdHJ1ZSApIHtcclxuXHRcdFx0XHRmcG9zID0gdHMucC50cmVlQU5vZGUgPiAtMSA/IHRzLnAudHJlZUFOb2RlOiAwO1xyXG5cdFx0XHRcdGlmKHRzLnAuZ3JvdXBpbmcpIHtcclxuXHRcdFx0XHRcdGlmKCFsb2NkYXRhKSB7XHJcblx0XHRcdFx0XHRcdHNlbGYuanFHcmlkKCdncm91cGluZ1JlbmRlcicsIGdycGRhdGEsIHRzLnAuY29sTW9kZWwubGVuZ3RoLCB0cy5wLnBhZ2UsIHJuKTtcclxuXHRcdFx0XHRcdFx0Z3JwZGF0YSA9IG51bGw7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBlbHNlIGlmKHRzLnAudHJlZUdyaWQgPT09IHRydWUgJiYgZnBvcyA+IDApIHtcclxuXHRcdFx0XHRcdCQodHMucm93c1tmcG9zXSkuYWZ0ZXIocm93RGF0YS5qb2luKCcnKSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCQoXCIjXCIrJC5qZ3JpZC5qcUlEKHRzLnAuaWQpK1wiIHRib2R5OmZpcnN0XCIpLmFwcGVuZChyb3dEYXRhLmpvaW4oJycpKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYodHMucC5zdWJHcmlkID09PSB0cnVlICkge1xyXG5cdFx0XHRcdHRyeSB7IHNlbGYuanFHcmlkKFwiYWRkU3ViR3JpZFwiLGdpK25pKTt9IGNhdGNoIChfKXt9XHJcblx0XHRcdH1cclxuXHRcdFx0dHMucC50b3RhbHRpbWUgPSBuZXcgRGF0ZSgpIC0gc3RhcnRSZXE7XHJcblx0XHRcdGlmKGlyPjApIHtcclxuXHRcdFx0XHRpZih0cy5wLnJlY29yZHM9PT0wKSB7IHRzLnAucmVjb3Jkcz1sZW47IH1cclxuXHRcdFx0fVxyXG5cdFx0XHRyb3dEYXRhID0gbnVsbDtcclxuXHRcdFx0aWYoIHRzLnAudHJlZUdyaWQgPT09IHRydWUpIHtcclxuXHRcdFx0XHR0cnkge3NlbGYuanFHcmlkKFwic2V0VHJlZU5vZGVcIiwgZnBvcysxLCBpcitmcG9zKzEpO30gY2F0Y2ggKGUpIHt9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoIXRzLnAudHJlZUdyaWQgJiYgIXRzLnAuc2Nyb2xsKSB7dHMuZ3JpZC5iRGl2LnNjcm9sbFRvcCA9IDA7fVxyXG5cdFx0XHR0cy5wLnJlY2NvdW50PWlyO1xyXG5cdFx0XHR0cy5wLnRyZWVBTm9kZSA9IC0xO1xyXG5cdFx0XHRpZih0cy5wLnVzZXJEYXRhT25Gb290ZXIpIHsgc2VsZi5qcUdyaWQoXCJmb290ZXJEYXRhXCIsXCJzZXRcIix0cy5wLnVzZXJEYXRhLHRydWUpOyB9XHJcblx0XHRcdGlmKGxvY2RhdGEpIHtcclxuXHRcdFx0XHR0cy5wLnJlY29yZHMgPSBsZW47XHJcblx0XHRcdFx0dHMucC5sYXN0cGFnZSA9IE1hdGguY2VpbChsZW4vIHJuKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoIW1vcmUpIHsgdHMudXBkYXRlcGFnZXIoZmFsc2UsdHJ1ZSk7IH1cclxuXHRcdFx0aWYobG9jZGF0YSkge1xyXG5cdFx0XHRcdHdoaWxlIChpcjxsZW4gJiYgZHJvd3NbaXJdKSB7XHJcblx0XHRcdFx0XHRjdXIgPSBkcm93c1tpcl07XHJcblx0XHRcdFx0XHRpZHIgPSAkLmpncmlkLmdldEFjY2Vzc29yKGN1cixpZG4pO1xyXG5cdFx0XHRcdFx0aWYoaWRyID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdFx0aWYgKHR5cGVvZiBpZG4gPT09IFwibnVtYmVyXCIgJiYgdHMucC5jb2xNb2RlbFtpZG4rZ2krc2krbmldICE9IG51bGwpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyByZXJlYWQgaWQgYnkgbmFtZVxyXG5cdFx0XHRcdFx0XHRcdGlkciA9ICQuamdyaWQuZ2V0QWNjZXNzb3IoY3VyLHRzLnAuY29sTW9kZWxbaWRuK2dpK3NpK25pXS5uYW1lKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZihpZHIgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0XHRcdGlkciA9IGJyK2lyO1xyXG5cdFx0XHRcdFx0XHRcdGlmKGYubGVuZ3RoPT09MCl7XHJcblx0XHRcdFx0XHRcdFx0XHRpZihkUmVhZGVyLmNlbGwpe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgY2N1cjIgPSAkLmpncmlkLmdldEFjY2Vzc29yKGN1cixkUmVhZGVyLmNlbGwpIHx8IGN1cjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWRyID0gY2N1cjIgIT0gbnVsbCAmJiBjY3VyMltpZG5dICE9PSB1bmRlZmluZWQgPyBjY3VyMltpZG5dIDogaWRyO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjY3VyMj1udWxsO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYoY3VyKSB7XHJcblx0XHRcdFx0XHRcdGlkciAgPSB0cy5wLmlkUHJlZml4ICsgaWRyO1xyXG5cdFx0XHRcdFx0XHRyb3dSZWFkZXI9b2JqZWN0UmVhZGVyO1xyXG5cdFx0XHRcdFx0XHRpZiAoZFJlYWRlci5yZXBlYXRpdGVtcykge1xyXG5cdFx0XHRcdFx0XHRcdGlmKGRSZWFkZXIuY2VsbCkge2N1ciA9ICQuamdyaWQuZ2V0QWNjZXNzb3IoY3VyLGRSZWFkZXIuY2VsbCkgfHwgY3VyO31cclxuXHRcdFx0XHRcdFx0XHRpZiAoJC5pc0FycmF5KGN1cikpIHsgcm93UmVhZGVyPWFycmF5UmVhZGVyOyB9XHJcblx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdGZvciAoaj0wO2o8cm93UmVhZGVyLmxlbmd0aDtqKyspIHtcclxuXHRcdFx0XHRcdFx0XHRyZFt0cy5wLmNvbE1vZGVsW2orZ2krc2krbmldLm5hbWVdID0gJC5qZ3JpZC5nZXRBY2Nlc3NvcihjdXIscm93UmVhZGVyW2pdKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRyZFtsb2NpZF0gPSAkLmpncmlkLnN0cmlwUHJlZih0cy5wLmlkUHJlZml4LCBpZHIpO1xyXG5cdFx0XHRcdFx0XHRpZih0cy5wLmdyb3VwaW5nKSB7XHJcblx0XHRcdFx0XHRcdFx0Z3JvdXBpbmdQcmVwYXJlLmNhbGwoc2VsZiwgcmQsIGlyICk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0dHMucC5kYXRhLnB1c2gocmQpO1xyXG5cdFx0XHRcdFx0XHR0cy5wLl9pbmRleFtyZFtsb2NpZF1dID0gdHMucC5kYXRhLmxlbmd0aC0xO1xyXG5cdFx0XHRcdFx0XHRyZCA9IHt9O1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aXIrKztcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYodHMucC5ncm91cGluZykge1xyXG5cdFx0XHRcdFx0dHMucC5ncm91cGluZ1ZpZXcuX2xvY2dyID0gdHJ1ZTtcclxuXHRcdFx0XHRcdHNlbGYuanFHcmlkKCdncm91cGluZ1JlbmRlcicsIGdycGRhdGEsIHRzLnAuY29sTW9kZWwubGVuZ3RoLCB0cy5wLnBhZ2UsIHJuKTtcclxuXHRcdFx0XHRcdGdycGRhdGEgPSBudWxsO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdGFkZExvY2FsRGF0YSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgc3QgPSB0cy5wLm11bHRpU29ydCA/IFtdIDogXCJcIiwgc3RvPVtdLCBmbmRzb3J0PWZhbHNlLCBjbXR5cGVzPXt9LCBncnR5cGVzPVtdLCBncmluZGV4ZXM9W10sIHNyY2Zvcm1hdCwgc29ydHR5cGUsIG5ld2Zvcm1hdDtcclxuXHRcdFx0aWYoISQuaXNBcnJheSh0cy5wLmRhdGEpKSB7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciBncnB2aWV3ID0gdHMucC5ncm91cGluZyA/IHRzLnAuZ3JvdXBpbmdWaWV3IDogZmFsc2UsIGxlbmdycCwgZ2luO1xyXG5cdFx0XHQkLmVhY2godHMucC5jb2xNb2RlbCxmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHNvcnR0eXBlID0gdGhpcy5zb3J0dHlwZSB8fCBcInRleHRcIjtcclxuXHRcdFx0XHRpZihzb3J0dHlwZSA9PT0gXCJkYXRlXCIgfHwgc29ydHR5cGUgPT09IFwiZGF0ZXRpbWVcIikge1xyXG5cdFx0XHRcdFx0aWYodGhpcy5mb3JtYXR0ZXIgJiYgdHlwZW9mIHRoaXMuZm9ybWF0dGVyID09PSAnc3RyaW5nJyAmJiB0aGlzLmZvcm1hdHRlciA9PT0gJ2RhdGUnKSB7XHJcblx0XHRcdFx0XHRcdGlmKHRoaXMuZm9ybWF0b3B0aW9ucyAmJiB0aGlzLmZvcm1hdG9wdGlvbnMuc3JjZm9ybWF0KSB7XHJcblx0XHRcdFx0XHRcdFx0c3JjZm9ybWF0ID0gdGhpcy5mb3JtYXRvcHRpb25zLnNyY2Zvcm1hdDtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRzcmNmb3JtYXQgPSAkLmpncmlkLmZvcm1hdHRlci5kYXRlLnNyY2Zvcm1hdDtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZih0aGlzLmZvcm1hdG9wdGlvbnMgJiYgdGhpcy5mb3JtYXRvcHRpb25zLm5ld2Zvcm1hdCkge1xyXG5cdFx0XHRcdFx0XHRcdG5ld2Zvcm1hdCA9IHRoaXMuZm9ybWF0b3B0aW9ucy5uZXdmb3JtYXQ7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0bmV3Zm9ybWF0ID0gJC5qZ3JpZC5mb3JtYXR0ZXIuZGF0ZS5uZXdmb3JtYXQ7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHNyY2Zvcm1hdCA9IG5ld2Zvcm1hdCA9IHRoaXMuZGF0ZWZtdCB8fCBcIlktbS1kXCI7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRjbXR5cGVzW3RoaXMubmFtZV0gPSB7XCJzdHlwZVwiOiBzb3J0dHlwZSwgXCJzcmNmbXRcIjogc3JjZm9ybWF0LFwibmV3Zm10XCI6bmV3Zm9ybWF0LCBcInNmdW5jXCI6IHRoaXMuc29ydGZ1bmMgfHwgbnVsbH07XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGNtdHlwZXNbdGhpcy5uYW1lXSA9IHtcInN0eXBlXCI6IHNvcnR0eXBlLCBcInNyY2ZtdFwiOicnLFwibmV3Zm10XCI6JycsIFwic2Z1bmNcIjogdGhpcy5zb3J0ZnVuYyB8fCBudWxsfTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYodHMucC5ncm91cGluZyApIHtcclxuXHRcdFx0XHRcdGZvcihnaW4gPTAsIGxlbmdycCA9IGdycHZpZXcuZ3JvdXBGaWVsZC5sZW5ndGg7IGdpbjwgbGVuZ3JwOyBnaW4rKykge1xyXG5cdFx0XHRcdFx0XHRpZiggdGhpcy5uYW1lID09PSBncnB2aWV3Lmdyb3VwRmllbGRbZ2luXSkge1xyXG5cdFx0XHRcdFx0XHRcdHZhciBncmluZGV4ID0gdGhpcy5uYW1lO1xyXG5cdFx0XHRcdFx0XHRcdGlmICh0aGlzLmluZGV4KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRncmluZGV4ID0gdGhpcy5pbmRleDtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0Z3J0eXBlc1tnaW5dID0gY210eXBlc1tncmluZGV4XTtcclxuXHRcdFx0XHRcdFx0XHRncmluZGV4ZXNbZ2luXT0gZ3JpbmRleDtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZih0cy5wLm11bHRpU29ydCkge1xyXG5cdFx0XHRcdFx0aWYodGhpcy5sc28pIHtcclxuXHRcdFx0XHRcdFx0c3QucHVzaCh0aGlzLm5hbWUpO1xyXG5cdFx0XHRcdFx0XHR2YXIgdG1wbHNvPSB0aGlzLmxzby5zcGxpdChcIi1cIik7XHJcblx0XHRcdFx0XHRcdHN0by5wdXNoKCB0bXBsc29bdG1wbHNvLmxlbmd0aC0xXSApO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRpZighZm5kc29ydCAmJiAodGhpcy5pbmRleCA9PT0gdHMucC5zb3J0bmFtZSB8fCB0aGlzLm5hbWUgPT09IHRzLnAuc29ydG5hbWUpKXtcclxuXHRcdFx0XHRcdFx0c3QgPSB0aGlzLm5hbWU7IC8vID8/P1xyXG5cdFx0XHRcdFx0XHRmbmRzb3J0ID0gdHJ1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRpZih0cy5wLnRyZWVHcmlkKSB7XHJcblx0XHRcdFx0JCh0cykuanFHcmlkKFwiU29ydFRyZWVcIiwgc3QsIHRzLnAuc29ydG9yZGVyLCBjbXR5cGVzW3N0XS5zdHlwZSB8fCAndGV4dCcsIGNtdHlwZXNbc3RdLnNyY2ZtdCB8fCAnJyk7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciBjb21wYXJlRm5NYXAgPSB7XHJcblx0XHRcdFx0J2VxJzpmdW5jdGlvbihxdWVyeU9iaikge3JldHVybiBxdWVyeU9iai5lcXVhbHM7fSxcclxuXHRcdFx0XHQnbmUnOmZ1bmN0aW9uKHF1ZXJ5T2JqKSB7cmV0dXJuIHF1ZXJ5T2JqLm5vdEVxdWFsczt9LFxyXG5cdFx0XHRcdCdsdCc6ZnVuY3Rpb24ocXVlcnlPYmopIHtyZXR1cm4gcXVlcnlPYmoubGVzczt9LFxyXG5cdFx0XHRcdCdsZSc6ZnVuY3Rpb24ocXVlcnlPYmopIHtyZXR1cm4gcXVlcnlPYmoubGVzc09yRXF1YWxzO30sXHJcblx0XHRcdFx0J2d0JzpmdW5jdGlvbihxdWVyeU9iaikge3JldHVybiBxdWVyeU9iai5ncmVhdGVyO30sXHJcblx0XHRcdFx0J2dlJzpmdW5jdGlvbihxdWVyeU9iaikge3JldHVybiBxdWVyeU9iai5ncmVhdGVyT3JFcXVhbHM7fSxcclxuXHRcdFx0XHQnY24nOmZ1bmN0aW9uKHF1ZXJ5T2JqKSB7cmV0dXJuIHF1ZXJ5T2JqLmNvbnRhaW5zO30sXHJcblx0XHRcdFx0J25jJzpmdW5jdGlvbihxdWVyeU9iaixvcCkge3JldHVybiBvcCA9PT0gXCJPUlwiID8gcXVlcnlPYmoub3JOb3QoKS5jb250YWlucyA6IHF1ZXJ5T2JqLmFuZE5vdCgpLmNvbnRhaW5zO30sXHJcblx0XHRcdFx0J2J3JzpmdW5jdGlvbihxdWVyeU9iaikge3JldHVybiBxdWVyeU9iai5zdGFydHNXaXRoO30sXHJcblx0XHRcdFx0J2JuJzpmdW5jdGlvbihxdWVyeU9iaixvcCkge3JldHVybiBvcCA9PT0gXCJPUlwiID8gcXVlcnlPYmoub3JOb3QoKS5zdGFydHNXaXRoIDogcXVlcnlPYmouYW5kTm90KCkuc3RhcnRzV2l0aDt9LFxyXG5cdFx0XHRcdCdlbic6ZnVuY3Rpb24ocXVlcnlPYmosb3ApIHtyZXR1cm4gb3AgPT09IFwiT1JcIiA/IHF1ZXJ5T2JqLm9yTm90KCkuZW5kc1dpdGggOiBxdWVyeU9iai5hbmROb3QoKS5lbmRzV2l0aDt9LFxyXG5cdFx0XHRcdCdldyc6ZnVuY3Rpb24ocXVlcnlPYmopIHtyZXR1cm4gcXVlcnlPYmouZW5kc1dpdGg7fSxcclxuXHRcdFx0XHQnbmknOmZ1bmN0aW9uKHF1ZXJ5T2JqLG9wKSB7cmV0dXJuIG9wID09PSBcIk9SXCIgPyBxdWVyeU9iai5vck5vdCgpLmVxdWFscyA6IHF1ZXJ5T2JqLmFuZE5vdCgpLmVxdWFsczt9LFxyXG5cdFx0XHRcdCdpbic6ZnVuY3Rpb24ocXVlcnlPYmopIHtyZXR1cm4gcXVlcnlPYmouZXF1YWxzO30sXHJcblx0XHRcdFx0J251JzpmdW5jdGlvbihxdWVyeU9iaikge3JldHVybiBxdWVyeU9iai5pc051bGw7fSxcclxuXHRcdFx0XHQnbm4nOmZ1bmN0aW9uKHF1ZXJ5T2JqLG9wKSB7cmV0dXJuIG9wID09PSBcIk9SXCIgPyBxdWVyeU9iai5vck5vdCgpLmlzTnVsbCA6IHF1ZXJ5T2JqLmFuZE5vdCgpLmlzTnVsbDt9XHJcblxyXG5cdFx0XHR9LFxyXG5cdFx0XHRxdWVyeSA9ICQuamdyaWQuZnJvbSh0cy5wLmRhdGEpO1xyXG5cdFx0XHRpZiAodHMucC5pZ25vcmVDYXNlKSB7IHF1ZXJ5ID0gcXVlcnkuaWdub3JlQ2FzZSgpOyB9XHJcblx0XHRcdGZ1bmN0aW9uIHRvakxpbnEgKCBncm91cCApIHtcclxuXHRcdFx0XHR2YXIgcyA9IDAsIGluZGV4LCBnb3IsIHJvciwgb3ByLCBydWxlO1xyXG5cdFx0XHRcdGlmIChncm91cC5ncm91cHMgIT0gbnVsbCkge1xyXG5cdFx0XHRcdFx0Z29yID0gZ3JvdXAuZ3JvdXBzLmxlbmd0aCAmJiBncm91cC5ncm91cE9wLnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKSA9PT0gXCJPUlwiO1xyXG5cdFx0XHRcdFx0aWYgKGdvcikge1xyXG5cdFx0XHRcdFx0XHRxdWVyeS5vckJlZ2luKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBncm91cC5ncm91cHMubGVuZ3RoOyBpbmRleCsrKSB7XHJcblx0XHRcdFx0XHRcdGlmIChzID4gMCAmJiBnb3IpIHtcclxuXHRcdFx0XHRcdFx0XHRxdWVyeS5vcigpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0dG9qTGlucShncm91cC5ncm91cHNbaW5kZXhdKTtcclxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge2FsZXJ0KGUpO31cclxuXHRcdFx0XHRcdFx0cysrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYgKGdvcikge1xyXG5cdFx0XHRcdFx0XHRxdWVyeS5vckVuZCgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoZ3JvdXAucnVsZXMgIT0gbnVsbCkge1xyXG5cdFx0XHRcdFx0Ly9pZihzPjApIHtcclxuXHRcdFx0XHRcdC8vXHR2YXIgcmVzdWx0ID0gcXVlcnkuc2VsZWN0KCk7XHJcblx0XHRcdFx0XHQvL1x0cXVlcnkgPSAkLmpncmlkLmZyb20oIHJlc3VsdCk7XHJcblx0XHRcdFx0XHQvL1x0aWYgKHRzLnAuaWdub3JlQ2FzZSkgeyBxdWVyeSA9IHF1ZXJ5Lmlnbm9yZUNhc2UoKTsgfVxyXG5cdFx0XHRcdFx0Ly99XHJcblx0XHRcdFx0XHR0cnl7XHJcblx0XHRcdFx0XHRcdHJvciA9IGdyb3VwLnJ1bGVzLmxlbmd0aCAmJiBncm91cC5ncm91cE9wLnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKSA9PT0gXCJPUlwiO1xyXG5cdFx0XHRcdFx0XHRpZiAocm9yKSB7XHJcblx0XHRcdFx0XHRcdFx0cXVlcnkub3JCZWdpbigpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGZvciAoaW5kZXggPSAwOyBpbmRleCA8IGdyb3VwLnJ1bGVzLmxlbmd0aDsgaW5kZXgrKykge1xyXG5cdFx0XHRcdFx0XHRcdHJ1bGUgPSBncm91cC5ydWxlc1tpbmRleF07XHJcblx0XHRcdFx0XHRcdFx0b3ByID0gZ3JvdXAuZ3JvdXBPcC50b1N0cmluZygpLnRvVXBwZXJDYXNlKCk7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGNvbXBhcmVGbk1hcFtydWxlLm9wXSAmJiBydWxlLmZpZWxkICkge1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYocyA+IDAgJiYgb3ByICYmIG9wciA9PT0gXCJPUlwiKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHF1ZXJ5ID0gcXVlcnkub3IoKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdHF1ZXJ5ID0gY29tcGFyZUZuTWFwW3J1bGUub3BdKHF1ZXJ5LCBvcHIpKHJ1bGUuZmllbGQsIHJ1bGUuZGF0YSwgY210eXBlc1tydWxlLmZpZWxkXSk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdHMrKztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZiAocm9yKSB7XHJcblx0XHRcdFx0XHRcdFx0cXVlcnkub3JFbmQoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBjYXRjaCAoZykge2FsZXJ0KGcpO31cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmICh0cy5wLnNlYXJjaCA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdHZhciBzcnVsZXMgPSB0cy5wLnBvc3REYXRhLmZpbHRlcnM7XHJcblx0XHRcdFx0aWYoc3J1bGVzKSB7XHJcblx0XHRcdFx0XHRpZih0eXBlb2Ygc3J1bGVzID09PSBcInN0cmluZ1wiKSB7IHNydWxlcyA9ICQuamdyaWQucGFyc2Uoc3J1bGVzKTt9XHJcblx0XHRcdFx0XHR0b2pMaW5xKCBzcnVsZXMgKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0cXVlcnkgPSBjb21wYXJlRm5NYXBbdHMucC5wb3N0RGF0YS5zZWFyY2hPcGVyXShxdWVyeSkodHMucC5wb3N0RGF0YS5zZWFyY2hGaWVsZCwgdHMucC5wb3N0RGF0YS5zZWFyY2hTdHJpbmcsY210eXBlc1t0cy5wLnBvc3REYXRhLnNlYXJjaEZpZWxkXSk7XHJcblx0XHRcdFx0XHR9IGNhdGNoIChzZSl7fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRpZih0cy5wLmdyb3VwaW5nKSB7XHJcblx0XHRcdFx0Zm9yKGdpbj0wOyBnaW48bGVuZ3JwO2dpbisrKSB7XHJcblx0XHRcdFx0XHRxdWVyeS5vcmRlckJ5KGdyaW5kZXhlc1tnaW5dLGdycHZpZXcuZ3JvdXBPcmRlcltnaW5dLGdydHlwZXNbZ2luXS5zdHlwZSwgZ3J0eXBlc1tnaW5dLnNyY2ZtdCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHRzLnAubXVsdGlTb3J0KSB7XHJcblx0XHRcdFx0JC5lYWNoKHN0LGZ1bmN0aW9uKGkpe1xyXG5cdFx0XHRcdFx0cXVlcnkub3JkZXJCeSh0aGlzLCBzdG9baV0sIGNtdHlwZXNbdGhpc10uc3R5cGUsIGNtdHlwZXNbdGhpc10uc3JjZm10LCBjbXR5cGVzW3RoaXNdLnNmdW5jKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpZiAoc3QgJiYgdHMucC5zb3J0b3JkZXIgJiYgZm5kc29ydCkge1xyXG5cdFx0XHRcdFx0aWYodHMucC5zb3J0b3JkZXIudG9VcHBlckNhc2UoKSA9PT0gXCJERVNDXCIpIHtcclxuXHRcdFx0XHRcdFx0cXVlcnkub3JkZXJCeSh0cy5wLnNvcnRuYW1lLCBcImRcIiwgY210eXBlc1tzdF0uc3R5cGUsIGNtdHlwZXNbc3RdLnNyY2ZtdCwgY210eXBlc1tzdF0uc2Z1bmMpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0cXVlcnkub3JkZXJCeSh0cy5wLnNvcnRuYW1lLCBcImFcIiwgY210eXBlc1tzdF0uc3R5cGUsIGNtdHlwZXNbc3RdLnNyY2ZtdCwgY210eXBlc1tzdF0uc2Z1bmMpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgcXVlcnlSZXN1bHRzID0gcXVlcnkuc2VsZWN0KCksXHJcblx0XHRcdHJlY29yZHNwZXJwYWdlID0gcGFyc2VJbnQodHMucC5yb3dOdW0sMTApLFxyXG5cdFx0XHR0b3RhbCA9IHF1ZXJ5UmVzdWx0cy5sZW5ndGgsXHJcblx0XHRcdHBhZ2UgPSBwYXJzZUludCh0cy5wLnBhZ2UsMTApLFxyXG5cdFx0XHR0b3RhbHBhZ2VzID0gTWF0aC5jZWlsKHRvdGFsIC8gcmVjb3Jkc3BlcnBhZ2UpLFxyXG5cdFx0XHRyZXRyZXN1bHQgPSB7fTtcclxuXHRcdFx0aWYoKHRzLnAuc2VhcmNoIHx8IHRzLnAucmVzZXRzZWFyY2gpICYmIHRzLnAuZ3JvdXBpbmcgJiYgdHMucC5ncm91cGluZ1ZpZXcuX2xvY2dyKSB7XHJcblx0XHRcdFx0dHMucC5ncm91cGluZ1ZpZXcuZ3JvdXBzID1bXTtcclxuXHRcdFx0XHR2YXIgaiwgZ3JQcmVwYXJlID0gJC5qZ3JpZC5nZXRNZXRob2QoXCJncm91cGluZ1ByZXBhcmVcIiksIGtleSwgdWRjO1xyXG5cdFx0XHRcdGlmKHRzLnAuZm9vdGVycm93ICYmIHRzLnAudXNlckRhdGFPbkZvb3Rlcikge1xyXG5cdFx0XHRcdFx0Zm9yIChrZXkgaW4gdHMucC51c2VyRGF0YSkge1xyXG5cdFx0XHRcdFx0XHRpZih0cy5wLnVzZXJEYXRhLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuXHRcdFx0XHRcdFx0XHR0cy5wLnVzZXJEYXRhW2tleV0gPSAwO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR1ZGMgPSB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRmb3Ioaj0wOyBqPHRvdGFsOyBqKyspIHtcclxuXHRcdFx0XHRcdGlmKHVkYykge1xyXG5cdFx0XHRcdFx0XHRmb3Ioa2V5IGluIHRzLnAudXNlckRhdGEpe1xyXG5cdFx0XHRcdFx0XHRcdHRzLnAudXNlckRhdGFba2V5XSArPSBwYXJzZUZsb2F0KHF1ZXJ5UmVzdWx0c1tqXVtrZXldIHx8IDApO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRnclByZXBhcmUuY2FsbCgkKHRzKSxxdWVyeVJlc3VsdHNbal0saiwgcmVjb3Jkc3BlcnBhZ2UgKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0cXVlcnlSZXN1bHRzID0gcXVlcnlSZXN1bHRzLnNsaWNlKCAocGFnZS0xKSpyZWNvcmRzcGVycGFnZSAsIHBhZ2UqcmVjb3Jkc3BlcnBhZ2UgKTtcclxuXHRcdFx0cXVlcnkgPSBudWxsO1xyXG5cdFx0XHRjbXR5cGVzID0gbnVsbDtcclxuXHRcdFx0cmV0cmVzdWx0W3RzLnAubG9jYWxSZWFkZXIudG90YWxdID0gdG90YWxwYWdlcztcclxuXHRcdFx0cmV0cmVzdWx0W3RzLnAubG9jYWxSZWFkZXIucGFnZV0gPSBwYWdlO1xyXG5cdFx0XHRyZXRyZXN1bHRbdHMucC5sb2NhbFJlYWRlci5yZWNvcmRzXSA9IHRvdGFsO1xyXG5cdFx0XHRyZXRyZXN1bHRbdHMucC5sb2NhbFJlYWRlci5yb290XSA9IHF1ZXJ5UmVzdWx0cztcclxuXHRcdFx0cmV0cmVzdWx0W3RzLnAubG9jYWxSZWFkZXIudXNlcmRhdGFdID0gdHMucC51c2VyRGF0YTtcclxuXHRcdFx0cXVlcnlSZXN1bHRzID0gbnVsbDtcclxuXHRcdFx0cmV0dXJuICByZXRyZXN1bHQ7XHJcblx0XHR9LFxyXG5cdFx0dXBkYXRlcGFnZXIgPSBmdW5jdGlvbihybiwgZG5kKSB7XHJcblx0XHRcdHZhciBjcCwgbGFzdCwgYmFzZSwgZnJvbSx0byx0b3QsZm10LCBwZ2JveGVzID0gXCJcIiwgc3BwZyxcclxuXHRcdFx0dHNwZyA9IHRzLnAucGFnZXIgPyBcIl9cIiskLmpncmlkLmpxSUQodHMucC5wYWdlci5zdWJzdHIoMSkpIDogXCJcIixcclxuXHRcdFx0dHNwZ190ID0gdHMucC50b3BwYWdlciA/IFwiX1wiK3RzLnAudG9wcGFnZXIuc3Vic3RyKDEpIDogXCJcIjtcclxuXHRcdFx0YmFzZSA9IHBhcnNlSW50KHRzLnAucGFnZSwxMCktMTtcclxuXHRcdFx0aWYoYmFzZSA8IDApIHsgYmFzZSA9IDA7IH1cclxuXHRcdFx0YmFzZSA9IGJhc2UqcGFyc2VJbnQodHMucC5yb3dOdW0sMTApO1xyXG5cdFx0XHR0byA9IGJhc2UgKyB0cy5wLnJlY2NvdW50O1xyXG5cdFx0XHRpZiAodHMucC5zY3JvbGwpIHtcclxuXHRcdFx0XHR2YXIgcm93cyA9ICQoXCJ0Ym9keTpmaXJzdCA+IHRyOmd0KDApXCIsIHRzLmdyaWQuYkRpdik7XHJcblx0XHRcdFx0YmFzZSA9IHRvIC0gcm93cy5sZW5ndGg7XHJcblx0XHRcdFx0dHMucC5yZWNjb3VudCA9IHJvd3MubGVuZ3RoO1xyXG5cdFx0XHRcdHZhciByaCA9IHJvd3Mub3V0ZXJIZWlnaHQoKSB8fCB0cy5ncmlkLnByZXZSb3dIZWlnaHQ7XHJcblx0XHRcdFx0aWYgKHJoKSB7XHJcblx0XHRcdFx0XHR2YXIgdG9wID0gYmFzZSAqIHJoO1xyXG5cdFx0XHRcdFx0dmFyIGhlaWdodCA9IHBhcnNlSW50KHRzLnAucmVjb3JkcywxMCkgKiByaDtcclxuXHRcdFx0XHRcdCQoXCI+ZGl2OmZpcnN0XCIsdHMuZ3JpZC5iRGl2KS5jc3Moe2hlaWdodCA6IGhlaWdodH0pLmNoaWxkcmVuKFwiZGl2OmZpcnN0XCIpLmNzcyh7aGVpZ2h0OnRvcCxkaXNwbGF5OnRvcD9cIlwiOlwibm9uZVwifSk7XHJcblx0XHRcdFx0XHRpZiAodHMuZ3JpZC5iRGl2LnNjcm9sbFRvcCA9PSAwICYmIHRzLnAucGFnZSA+IDEpIHtcclxuXHRcdFx0XHRcdFx0dHMuZ3JpZC5iRGl2LnNjcm9sbFRvcCA9IHRzLnAucm93TnVtICogKHRzLnAucGFnZSAtIDEpICogcmg7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHRzLmdyaWQuYkRpdi5zY3JvbGxMZWZ0ID0gdHMuZ3JpZC5oRGl2LnNjcm9sbExlZnQ7XHJcblx0XHRcdH1cclxuXHRcdFx0cGdib3hlcyA9IHRzLnAucGFnZXIgfHwgXCJcIjtcclxuXHRcdFx0cGdib3hlcyArPSB0cy5wLnRvcHBhZ2VyID8gIChwZ2JveGVzID8gXCIsXCIgKyB0cy5wLnRvcHBhZ2VyIDogdHMucC50b3BwYWdlcikgOiBcIlwiO1xyXG5cdFx0XHRpZihwZ2JveGVzKSB7XHJcblx0XHRcdFx0Zm10ID0gJC5qZ3JpZC5mb3JtYXR0ZXIuaW50ZWdlciB8fCB7fTtcclxuXHRcdFx0XHRjcCA9IGludE51bSh0cy5wLnBhZ2UpO1xyXG5cdFx0XHRcdGxhc3QgPSBpbnROdW0odHMucC5sYXN0cGFnZSk7XHJcblx0XHRcdFx0JChcIi5zZWxib3hcIixwZ2JveGVzKVsgdGhpcy5wLnVzZVByb3AgPyAncHJvcCcgOiAnYXR0cicgXShcImRpc2FibGVkXCIsZmFsc2UpO1xyXG5cdFx0XHRcdGlmKHRzLnAucGdpbnB1dD09PXRydWUpIHtcclxuXHRcdFx0XHRcdCQoJy51aS1wZy1pbnB1dCcscGdib3hlcykudmFsKHRzLnAucGFnZSk7XHJcblx0XHRcdFx0XHRzcHBnID0gdHMucC50b3BwYWdlciA/ICcjc3BfMScrdHNwZytcIiwjc3BfMVwiK3RzcGdfdCA6ICcjc3BfMScrdHNwZztcclxuXHRcdFx0XHRcdCQoc3BwZykuaHRtbCgkLmZtYXR0ZXIgPyAkLmZtYXR0ZXIudXRpbC5OdW1iZXJGb3JtYXQodHMucC5sYXN0cGFnZSxmbXQpOnRzLnAubGFzdHBhZ2UpO1xyXG5cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKHRzLnAudmlld3JlY29yZHMpe1xyXG5cdFx0XHRcdFx0aWYodHMucC5yZWNjb3VudCA9PT0gMCkge1xyXG5cdFx0XHRcdFx0XHQkKFwiLnVpLXBhZ2luZy1pbmZvXCIscGdib3hlcykuaHRtbCh0cy5wLmVtcHR5cmVjb3Jkcyk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRmcm9tID0gYmFzZSsxO1xyXG5cdFx0XHRcdFx0XHR0b3Q9dHMucC5yZWNvcmRzO1xyXG5cdFx0XHRcdFx0XHRpZigkLmZtYXR0ZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRmcm9tID0gJC5mbWF0dGVyLnV0aWwuTnVtYmVyRm9ybWF0KGZyb20sZm10KTtcclxuXHRcdFx0XHRcdFx0XHR0byA9ICQuZm1hdHRlci51dGlsLk51bWJlckZvcm1hdCh0byxmbXQpO1xyXG5cdFx0XHRcdFx0XHRcdHRvdCA9ICQuZm1hdHRlci51dGlsLk51bWJlckZvcm1hdCh0b3QsZm10KTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHQkKFwiLnVpLXBhZ2luZy1pbmZvXCIscGdib3hlcykuaHRtbCgkLmpncmlkLmZvcm1hdCh0cy5wLnJlY29yZHRleHQsZnJvbSx0byx0b3QpKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYodHMucC5wZ2J1dHRvbnM9PT10cnVlKSB7XHJcblx0XHRcdFx0XHRpZihjcDw9MCkge2NwID0gbGFzdCA9IDA7fVxyXG5cdFx0XHRcdFx0aWYoY3A9PT0xIHx8IGNwID09PSAwKSB7XHJcblx0XHRcdFx0XHRcdCQoXCIjZmlyc3RcIit0c3BnK1wiLCAjcHJldlwiK3RzcGcpLmFkZENsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpLnJlbW92ZUNsYXNzKCd1aS1zdGF0ZS1ob3ZlcicpO1xyXG5cdFx0XHRcdFx0XHRpZih0cy5wLnRvcHBhZ2VyKSB7ICQoXCIjZmlyc3RfdFwiK3RzcGdfdCtcIiwgI3ByZXZfdFwiK3RzcGdfdCkuYWRkQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJykucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7IH1cclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdCQoXCIjZmlyc3RcIit0c3BnK1wiLCAjcHJldlwiK3RzcGcpLnJlbW92ZUNsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpO1xyXG5cdFx0XHRcdFx0XHRpZih0cy5wLnRvcHBhZ2VyKSB7ICQoXCIjZmlyc3RfdFwiK3RzcGdfdCtcIiwgI3ByZXZfdFwiK3RzcGdfdCkucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7IH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKGNwPT09bGFzdCB8fCBjcCA9PT0gMCkge1xyXG5cdFx0XHRcdFx0XHQkKFwiI25leHRcIit0c3BnK1wiLCAjbGFzdFwiK3RzcGcpLmFkZENsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpLnJlbW92ZUNsYXNzKCd1aS1zdGF0ZS1ob3ZlcicpO1xyXG5cdFx0XHRcdFx0XHRpZih0cy5wLnRvcHBhZ2VyKSB7ICQoXCIjbmV4dF90XCIrdHNwZ190K1wiLCAjbGFzdF90XCIrdHNwZ190KS5hZGRDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKS5yZW1vdmVDbGFzcygndWktc3RhdGUtaG92ZXInKTsgfVxyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0JChcIiNuZXh0XCIrdHNwZytcIiwgI2xhc3RcIit0c3BnKS5yZW1vdmVDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0XHRcdFx0aWYodHMucC50b3BwYWdlcikgeyAkKFwiI25leHRfdFwiK3RzcGdfdCtcIiwgI2xhc3RfdFwiK3RzcGdfdCkucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7IH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYocm49PT10cnVlICYmIHRzLnAucm93bnVtYmVycyA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdCQoXCI+dGQuanFncmlkLXJvd251bVwiLHRzLnJvd3MpLmVhY2goZnVuY3Rpb24oaSl7XHJcblx0XHRcdFx0XHQkKHRoaXMpLmh0bWwoYmFzZSsxK2kpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKGRuZCAmJiB0cy5wLmpxZ2RuZCkgeyAkKHRzKS5qcUdyaWQoJ2dyaWREbkQnLCd1cGRhdGVEbkQnKTt9XHJcblx0XHRcdCQodHMpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkR3JpZENvbXBsZXRlXCIpO1xyXG5cdFx0XHRpZigkLmlzRnVuY3Rpb24odHMucC5ncmlkQ29tcGxldGUpKSB7dHMucC5ncmlkQ29tcGxldGUuY2FsbCh0cyk7fVxyXG5cdFx0XHQkKHRzKS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEFmdGVyR3JpZENvbXBsZXRlXCIpO1xyXG5cdFx0fSxcclxuXHRcdGJlZ2luUmVxID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdHRzLmdyaWQuaERpdi5sb2FkaW5nID0gdHJ1ZTtcclxuXHRcdFx0aWYodHMucC5oaWRkZW5ncmlkKSB7IHJldHVybjt9XHJcblx0XHRcdHN3aXRjaCh0cy5wLmxvYWR1aSkge1xyXG5cdFx0XHRcdGNhc2UgXCJkaXNhYmxlXCI6XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlIFwiZW5hYmxlXCI6XHJcblx0XHRcdFx0XHQkKFwiI2xvYWRfXCIrJC5qZ3JpZC5qcUlEKHRzLnAuaWQpKS5zaG93KCk7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlIFwiYmxvY2tcIjpcclxuXHRcdFx0XHRcdCQoXCIjbHVpX1wiKyQuamdyaWQuanFJRCh0cy5wLmlkKSkuc2hvdygpO1xyXG5cdFx0XHRcdFx0JChcIiNsb2FkX1wiKyQuamdyaWQuanFJRCh0cy5wLmlkKSkuc2hvdygpO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRlbmRSZXEgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0dHMuZ3JpZC5oRGl2LmxvYWRpbmcgPSBmYWxzZTtcclxuXHRcdFx0c3dpdGNoKHRzLnAubG9hZHVpKSB7XHJcblx0XHRcdFx0Y2FzZSBcImRpc2FibGVcIjpcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJlbmFibGVcIjpcclxuXHRcdFx0XHRcdCQoXCIjbG9hZF9cIiskLmpncmlkLmpxSUQodHMucC5pZCkpLmhpZGUoKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJibG9ja1wiOlxyXG5cdFx0XHRcdFx0JChcIiNsdWlfXCIrJC5qZ3JpZC5qcUlEKHRzLnAuaWQpKS5oaWRlKCk7XHJcblx0XHRcdFx0XHQkKFwiI2xvYWRfXCIrJC5qZ3JpZC5qcUlEKHRzLnAuaWQpKS5oaWRlKCk7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdHBvcHVsYXRlID0gZnVuY3Rpb24gKG5wYWdlKSB7XHJcblx0XHRcdGlmKCF0cy5ncmlkLmhEaXYubG9hZGluZykge1xyXG5cdFx0XHRcdHZhciBwdmlzID0gdHMucC5zY3JvbGwgJiYgbnBhZ2UgPT09IGZhbHNlLFxyXG5cdFx0XHRcdHBybSA9IHt9LCBkdCwgZHN0ciwgcE49dHMucC5wcm1OYW1lcztcclxuXHRcdFx0XHRpZih0cy5wLnBhZ2UgPD0wKSB7IHRzLnAucGFnZSA9IE1hdGgubWluKDEsdHMucC5sYXN0cGFnZSk7IH1cclxuXHRcdFx0XHRpZihwTi5zZWFyY2ggIT09IG51bGwpIHtwcm1bcE4uc2VhcmNoXSA9IHRzLnAuc2VhcmNoO30gaWYocE4ubmQgIT09IG51bGwpIHtwcm1bcE4ubmRdID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7fVxyXG5cdFx0XHRcdGlmKHBOLnJvd3MgIT09IG51bGwpIHtwcm1bcE4ucm93c109IHRzLnAucm93TnVtO30gaWYocE4ucGFnZSAhPT0gbnVsbCkge3BybVtwTi5wYWdlXT0gdHMucC5wYWdlO31cclxuXHRcdFx0XHRpZihwTi5zb3J0ICE9PSBudWxsKSB7cHJtW3BOLnNvcnRdPSB0cy5wLnNvcnRuYW1lO30gaWYocE4ub3JkZXIgIT09IG51bGwpIHtwcm1bcE4ub3JkZXJdPSB0cy5wLnNvcnRvcmRlcjt9XHJcblx0XHRcdFx0aWYodHMucC5yb3dUb3RhbCAhPT0gbnVsbCAmJiBwTi50b3RhbHJvd3MgIT09IG51bGwpIHsgcHJtW3BOLnRvdGFscm93c109IHRzLnAucm93VG90YWw7IH1cclxuXHRcdFx0XHR2YXIgbGNmID0gJC5pc0Z1bmN0aW9uKHRzLnAubG9hZENvbXBsZXRlKSwgbGMgPSBsY2YgPyB0cy5wLmxvYWRDb21wbGV0ZSA6IG51bGw7XHJcblx0XHRcdFx0dmFyIGFkanVzdCA9IDA7XHJcblx0XHRcdFx0bnBhZ2UgPSBucGFnZSB8fCAxO1xyXG5cdFx0XHRcdGlmIChucGFnZSA+IDEpIHtcclxuXHRcdFx0XHRcdGlmKHBOLm5wYWdlICE9PSBudWxsKSB7XHJcblx0XHRcdFx0XHRcdHBybVtwTi5ucGFnZV0gPSBucGFnZTtcclxuXHRcdFx0XHRcdFx0YWRqdXN0ID0gbnBhZ2UgLSAxO1xyXG5cdFx0XHRcdFx0XHRucGFnZSA9IDE7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRsYyA9IGZ1bmN0aW9uKHJlcSkge1xyXG5cdFx0XHRcdFx0XHRcdHRzLnAucGFnZSsrO1xyXG5cdFx0XHRcdFx0XHRcdHRzLmdyaWQuaERpdi5sb2FkaW5nID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGxjZikge1xyXG5cdFx0XHRcdFx0XHRcdFx0dHMucC5sb2FkQ29tcGxldGUuY2FsbCh0cyxyZXEpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRwb3B1bGF0ZShucGFnZS0xKTtcclxuXHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGVsc2UgaWYgKHBOLm5wYWdlICE9PSBudWxsKSB7XHJcblx0XHRcdFx0XHRkZWxldGUgdHMucC5wb3N0RGF0YVtwTi5ucGFnZV07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKHRzLnAuZ3JvdXBpbmcpIHtcclxuXHRcdFx0XHRcdCQodHMpLmpxR3JpZCgnZ3JvdXBpbmdTZXR1cCcpO1xyXG5cdFx0XHRcdFx0dmFyIGdycCA9IHRzLnAuZ3JvdXBpbmdWaWV3LCBnaSwgZ3M9XCJcIjtcclxuXHRcdFx0XHRcdGZvcihnaT0wO2dpPGdycC5ncm91cEZpZWxkLmxlbmd0aDtnaSsrKSB7XHJcblx0XHRcdFx0XHRcdHZhciBpbmRleCA9IGdycC5ncm91cEZpZWxkW2dpXTtcclxuXHRcdFx0XHRcdFx0JC5lYWNoKHRzLnAuY29sTW9kZWwsIGZ1bmN0aW9uKGNtSW5kZXgsIGNtVmFsdWUpIHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoY21WYWx1ZS5uYW1lID09PSBpbmRleCAmJiBjbVZhbHVlLmluZGV4KXtcclxuXHRcdFx0XHRcdFx0XHRcdGluZGV4ID0gY21WYWx1ZS5pbmRleDtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0gKTtcclxuXHRcdFx0XHRcdFx0Z3MgKz0gaW5kZXggK1wiIFwiK2dycC5ncm91cE9yZGVyW2dpXStcIiwgXCI7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRwcm1bcE4uc29ydF0gPSBncyArIHBybVtwTi5zb3J0XTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JC5leHRlbmQodHMucC5wb3N0RGF0YSxwcm0pO1xyXG5cdFx0XHRcdHZhciByY250ID0gIXRzLnAuc2Nyb2xsID8gMSA6IHRzLnJvd3MubGVuZ3RoLTE7XHJcblx0XHRcdFx0dmFyIGJmciA9ICQodHMpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQmVmb3JlUmVxdWVzdFwiKTtcclxuXHRcdFx0XHRpZiAoYmZyID09PSBmYWxzZSB8fCBiZnIgPT09ICdzdG9wJykgeyByZXR1cm47IH1cclxuXHRcdFx0XHRpZiAoJC5pc0Z1bmN0aW9uKHRzLnAuZGF0YXR5cGUpKSB7IHRzLnAuZGF0YXR5cGUuY2FsbCh0cyx0cy5wLnBvc3REYXRhLFwibG9hZF9cIit0cy5wLmlkLCByY250LCBucGFnZSwgYWRqdXN0KTsgcmV0dXJuO31cclxuXHRcdFx0XHRpZiAoJC5pc0Z1bmN0aW9uKHRzLnAuYmVmb3JlUmVxdWVzdCkpIHtcclxuXHRcdFx0XHRcdGJmciA9IHRzLnAuYmVmb3JlUmVxdWVzdC5jYWxsKHRzKTtcclxuXHRcdFx0XHRcdGlmKGJmciA9PT0gdW5kZWZpbmVkKSB7IGJmciA9IHRydWU7IH1cclxuXHRcdFx0XHRcdGlmICggYmZyID09PSBmYWxzZSApIHsgcmV0dXJuOyB9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGR0ID0gdHMucC5kYXRhdHlwZS50b0xvd2VyQ2FzZSgpO1xyXG5cdFx0XHRcdHN3aXRjaChkdClcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0Y2FzZSBcImpzb25cIjpcclxuXHRcdFx0XHRjYXNlIFwianNvbnBcIjpcclxuXHRcdFx0XHRjYXNlIFwieG1sXCI6XHJcblx0XHRcdFx0Y2FzZSBcInNjcmlwdFwiOlxyXG5cdFx0XHRcdFx0JC5hamF4KCQuZXh0ZW5kKHtcclxuXHRcdFx0XHRcdFx0dXJsOnRzLnAudXJsLFxyXG5cdFx0XHRcdFx0XHR0eXBlOnRzLnAubXR5cGUsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiBkdCAsXHJcblx0XHRcdFx0XHRcdGRhdGE6ICQuaXNGdW5jdGlvbih0cy5wLnNlcmlhbGl6ZUdyaWREYXRhKT8gdHMucC5zZXJpYWxpemVHcmlkRGF0YS5jYWxsKHRzLHRzLnAucG9zdERhdGEpIDogdHMucC5wb3N0RGF0YSxcclxuXHRcdFx0XHRcdFx0c3VjY2VzczpmdW5jdGlvbihkYXRhLHN0LCB4aHIpIHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoJC5pc0Z1bmN0aW9uKHRzLnAuYmVmb3JlUHJvY2Vzc2luZykpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGlmICh0cy5wLmJlZm9yZVByb2Nlc3NpbmcuY2FsbCh0cywgZGF0YSwgc3QsIHhocikgPT09IGZhbHNlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGVuZFJlcSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdGlmKGR0ID09PSBcInhtbFwiKSB7IGFkZFhtbERhdGEoZGF0YSx0cy5ncmlkLmJEaXYscmNudCxucGFnZT4xLGFkanVzdCk7IH1cclxuXHRcdFx0XHRcdFx0XHRlbHNlIHsgYWRkSlNPTkRhdGEoZGF0YSx0cy5ncmlkLmJEaXYscmNudCxucGFnZT4xLGFkanVzdCk7IH1cclxuXHRcdFx0XHRcdFx0XHQkKHRzKS50cmlnZ2VySGFuZGxlcihcImpxR3JpZExvYWRDb21wbGV0ZVwiLCBbZGF0YV0pO1xyXG5cdFx0XHRcdFx0XHRcdGlmKGxjKSB7IGxjLmNhbGwodHMsZGF0YSk7IH1cclxuXHRcdFx0XHRcdFx0XHQkKHRzKS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEFmdGVyTG9hZENvbXBsZXRlXCIsIFtkYXRhXSk7XHJcblx0XHRcdFx0XHRcdFx0aWYgKHB2aXMpIHsgdHMuZ3JpZC5wb3B1bGF0ZVZpc2libGUoKTsgfVxyXG5cdFx0XHRcdFx0XHRcdGlmKCB0cy5wLmxvYWRvbmNlIHx8IHRzLnAudHJlZUdyaWQpIHt0cy5wLmRhdGF0eXBlID0gXCJsb2NhbFwiO31cclxuXHRcdFx0XHRcdFx0XHRkYXRhPW51bGw7XHJcblx0XHRcdFx0XHRcdFx0aWYgKG5wYWdlID09PSAxKSB7IGVuZFJlcSgpOyB9XHJcblx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdGVycm9yOmZ1bmN0aW9uKHhocixzdCxlcnIpe1xyXG5cdFx0XHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbih0cy5wLmxvYWRFcnJvcikpIHsgdHMucC5sb2FkRXJyb3IuY2FsbCh0cyx4aHIsc3QsZXJyKTsgfVxyXG5cdFx0XHRcdFx0XHRcdGlmIChucGFnZSA9PT0gMSkgeyBlbmRSZXEoKTsgfVxyXG5cdFx0XHRcdFx0XHRcdHhocj1udWxsO1xyXG5cdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRiZWZvcmVTZW5kOiBmdW5jdGlvbih4aHIsIHNldHRpbmdzICl7XHJcblx0XHRcdFx0XHRcdFx0dmFyIGdvdG9yZXEgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbih0cy5wLmxvYWRCZWZvcmVTZW5kKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0Z290b3JlcSA9IHRzLnAubG9hZEJlZm9yZVNlbmQuY2FsbCh0cyx4aHIsIHNldHRpbmdzKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0aWYoZ290b3JlcSA9PT0gdW5kZWZpbmVkKSB7IGdvdG9yZXEgPSB0cnVlOyB9XHJcblx0XHRcdFx0XHRcdFx0aWYoZ290b3JlcSA9PT0gZmFsc2UpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRiZWdpblJlcSgpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0sJC5qZ3JpZC5hamF4T3B0aW9ucywgdHMucC5hamF4R3JpZE9wdGlvbnMpKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlIFwieG1sc3RyaW5nXCI6XHJcblx0XHRcdFx0XHRiZWdpblJlcSgpO1xyXG5cdFx0XHRcdFx0ZHN0ciA9IHR5cGVvZiB0cy5wLmRhdGFzdHIgIT09ICdzdHJpbmcnID8gdHMucC5kYXRhc3RyIDogJC5wYXJzZVhNTCh0cy5wLmRhdGFzdHIpO1xyXG5cdFx0XHRcdFx0YWRkWG1sRGF0YShkc3RyLHRzLmdyaWQuYkRpdik7XHJcblx0XHRcdFx0XHQkKHRzKS50cmlnZ2VySGFuZGxlcihcImpxR3JpZExvYWRDb21wbGV0ZVwiLCBbZHN0cl0pO1xyXG5cdFx0XHRcdFx0aWYobGNmKSB7dHMucC5sb2FkQ29tcGxldGUuY2FsbCh0cyxkc3RyKTt9XHJcblx0XHRcdFx0XHQkKHRzKS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEFmdGVyTG9hZENvbXBsZXRlXCIsIFtkc3RyXSk7XHJcblx0XHRcdFx0XHR0cy5wLmRhdGF0eXBlID0gXCJsb2NhbFwiO1xyXG5cdFx0XHRcdFx0dHMucC5kYXRhc3RyID0gbnVsbDtcclxuXHRcdFx0XHRcdGVuZFJlcSgpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJqc29uc3RyaW5nXCI6XHJcblx0XHRcdFx0XHRiZWdpblJlcSgpO1xyXG5cdFx0XHRcdFx0aWYodHlwZW9mIHRzLnAuZGF0YXN0ciA9PT0gJ3N0cmluZycpIHsgZHN0ciA9ICQuamdyaWQucGFyc2UodHMucC5kYXRhc3RyKTsgfVxyXG5cdFx0XHRcdFx0ZWxzZSB7IGRzdHIgPSB0cy5wLmRhdGFzdHI7IH1cclxuXHRcdFx0XHRcdGFkZEpTT05EYXRhKGRzdHIsdHMuZ3JpZC5iRGl2KTtcclxuXHRcdFx0XHRcdCQodHMpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkTG9hZENvbXBsZXRlXCIsIFtkc3RyXSk7XHJcblx0XHRcdFx0XHRpZihsY2YpIHt0cy5wLmxvYWRDb21wbGV0ZS5jYWxsKHRzLGRzdHIpO31cclxuXHRcdFx0XHRcdCQodHMpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWZ0ZXJMb2FkQ29tcGxldGVcIiwgW2RzdHJdKTtcclxuXHRcdFx0XHRcdHRzLnAuZGF0YXR5cGUgPSBcImxvY2FsXCI7XHJcblx0XHRcdFx0XHR0cy5wLmRhdGFzdHIgPSBudWxsO1xyXG5cdFx0XHRcdFx0ZW5kUmVxKCk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcImxvY2FsXCI6XHJcblx0XHRcdFx0Y2FzZSBcImNsaWVudHNpZGVcIjpcclxuXHRcdFx0XHRcdGJlZ2luUmVxKCk7XHJcblx0XHRcdFx0XHR0cy5wLmRhdGF0eXBlID0gXCJsb2NhbFwiO1xyXG5cdFx0XHRcdFx0dmFyIHJlcSA9IGFkZExvY2FsRGF0YSgpO1xyXG5cdFx0XHRcdFx0YWRkSlNPTkRhdGEocmVxLHRzLmdyaWQuYkRpdixyY250LG5wYWdlPjEsYWRqdXN0KTtcclxuXHRcdFx0XHRcdCQodHMpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkTG9hZENvbXBsZXRlXCIsIFtyZXFdKTtcclxuXHRcdFx0XHRcdGlmKGxjKSB7IGxjLmNhbGwodHMscmVxKTsgfVxyXG5cdFx0XHRcdFx0JCh0cykudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRBZnRlckxvYWRDb21wbGV0ZVwiLCBbcmVxXSk7XHJcblx0XHRcdFx0XHRpZiAocHZpcykgeyB0cy5ncmlkLnBvcHVsYXRlVmlzaWJsZSgpOyB9XHJcblx0XHRcdFx0XHRlbmRSZXEoKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRzZXRIZWFkQ2hlY2tCb3ggPSBmdW5jdGlvbiAoIGNoZWNrZWQgKSB7XHJcblx0XHRcdCQoJyNjYl8nKyQuamdyaWQuanFJRCh0cy5wLmlkKSx0cy5ncmlkLmhEaXYpW3RzLnAudXNlUHJvcCA/ICdwcm9wJzogJ2F0dHInXShcImNoZWNrZWRcIiwgY2hlY2tlZCk7XHJcblx0XHRcdHZhciBmaWQgPSB0cy5wLmZyb3plbkNvbHVtbnMgPyB0cy5wLmlkK1wiX2Zyb3plblwiIDogXCJcIjtcclxuXHRcdFx0aWYoZmlkKSB7XHJcblx0XHRcdFx0JCgnI2NiXycrJC5qZ3JpZC5qcUlEKHRzLnAuaWQpLHRzLmdyaWQuZmhEaXYpW3RzLnAudXNlUHJvcCA/ICdwcm9wJzogJ2F0dHInXShcImNoZWNrZWRcIiwgY2hlY2tlZCk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRzZXRQYWdlciA9IGZ1bmN0aW9uIChwZ2lkLCB0cCl7XHJcblx0XHRcdC8vIFRCRCAtIGNvbnNpZGVyIGVzY2FwaW5nIHBnaWQgd2l0aCBwZ2lkID0gJC5qZ3JpZC5qcUlEKHBnaWQpO1xyXG5cdFx0XHR2YXIgc2VwID0gXCI8dGQgY2xhc3M9J3VpLXBnLWJ1dHRvbiB1aS1zdGF0ZS1kaXNhYmxlZCcgc3R5bGU9J3dpZHRoOjRweDsnPjxzcGFuIGNsYXNzPSd1aS1zZXBhcmF0b3InPjwvc3Bhbj48L3RkPlwiLFxyXG5cdFx0XHRwZ2lucCA9IFwiXCIsXHJcblx0XHRcdHBnbD1cIjx0YWJsZSBjZWxsc3BhY2luZz0nMCcgY2VsbHBhZGRpbmc9JzAnIGJvcmRlcj0nMCcgc3R5bGU9J3RhYmxlLWxheW91dDphdXRvOycgY2xhc3M9J3VpLXBnLXRhYmxlJz48dGJvZHk+PHRyPlwiLFxyXG5cdFx0XHRzdHI9XCJcIiwgcGdjbnQsIGxmdCwgY2VudCwgcmd0LCB0d2QsIHRkdywgaSxcclxuXHRcdFx0Y2xlYXJWYWxzID0gZnVuY3Rpb24ob25wYWdpbmcpe1xyXG5cdFx0XHRcdHZhciByZXQ7XHJcblx0XHRcdFx0aWYgKCQuaXNGdW5jdGlvbih0cy5wLm9uUGFnaW5nKSApIHsgcmV0ID0gdHMucC5vblBhZ2luZy5jYWxsKHRzLG9ucGFnaW5nKTsgfVxyXG5cdFx0XHRcdGlmKHJldD09PSdzdG9wJykge3JldHVybiBmYWxzZTt9XHJcblx0XHRcdFx0dHMucC5zZWxyb3cgPSBudWxsO1xyXG5cdFx0XHRcdGlmKHRzLnAubXVsdGlzZWxlY3QpIHt0cy5wLnNlbGFycnJvdyA9W107IHNldEhlYWRDaGVja0JveCggZmFsc2UgKTt9XHJcblx0XHRcdFx0dHMucC5zYXZlZFJvdyA9IFtdO1xyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9O1xyXG5cdFx0XHRwZ2lkID0gcGdpZC5zdWJzdHIoMSk7XHJcblx0XHRcdHRwICs9IFwiX1wiICsgcGdpZDtcclxuXHRcdFx0cGdjbnQgPSBcInBnX1wiK3BnaWQ7XHJcblx0XHRcdGxmdCA9IHBnaWQrXCJfbGVmdFwiOyBjZW50ID0gcGdpZCtcIl9jZW50ZXJcIjsgcmd0ID0gcGdpZCtcIl9yaWdodFwiO1xyXG5cdFx0XHQkKFwiI1wiKyQuamdyaWQuanFJRChwZ2lkKSApXHJcblx0XHRcdC5hcHBlbmQoXCI8ZGl2IGlkPSdcIitwZ2NudCtcIicgY2xhc3M9J3VpLXBhZ2VyLWNvbnRyb2wnIHJvbGU9J2dyb3VwJz48dGFibGUgY2VsbHNwYWNpbmc9JzAnIGNlbGxwYWRkaW5nPScwJyBib3JkZXI9JzAnIGNsYXNzPSd1aS1wZy10YWJsZScgc3R5bGU9J3dpZHRoOjEwMCU7dGFibGUtbGF5b3V0OmZpeGVkO2hlaWdodDoxMDAlOycgcm9sZT0ncm93Jz48dGJvZHk+PHRyPjx0ZCBpZD0nXCIrbGZ0K1wiJyBhbGlnbj0nbGVmdCc+PC90ZD48dGQgaWQ9J1wiK2NlbnQrXCInIGFsaWduPSdjZW50ZXInIHN0eWxlPSd3aGl0ZS1zcGFjZTpwcmU7Jz48L3RkPjx0ZCBpZD0nXCIrcmd0K1wiJyBhbGlnbj0ncmlnaHQnPjwvdGQ+PC90cj48L3Rib2R5PjwvdGFibGU+PC9kaXY+XCIpXHJcblx0XHRcdC5hdHRyKFwiZGlyXCIsXCJsdHJcIik7IC8vZXhwbGljaXQgc2V0dGluZ1xyXG5cdFx0XHRpZih0cy5wLnJvd0xpc3QubGVuZ3RoID4wKXtcclxuXHRcdFx0XHRzdHIgPSBcIjx0ZCBkaXI9J1wiK2RpcitcIic+XCI7XHJcblx0XHRcdFx0c3RyICs9XCI8c2VsZWN0IGNsYXNzPSd1aS1wZy1zZWxib3gnIHJvbGU9J2xpc3Rib3gnPlwiO1xyXG5cdFx0XHRcdGZvcihpPTA7aTx0cy5wLnJvd0xpc3QubGVuZ3RoO2krKyl7XHJcblx0XHRcdFx0XHRzdHIgKz1cIjxvcHRpb24gcm9sZT1cXFwib3B0aW9uXFxcIiB2YWx1ZT1cXFwiXCIrdHMucC5yb3dMaXN0W2ldK1wiXFxcIlwiKygodHMucC5yb3dOdW0gPT09IHRzLnAucm93TGlzdFtpXSk/XCIgc2VsZWN0ZWQ9XFxcInNlbGVjdGVkXFxcIlwiOlwiXCIpK1wiPlwiK3RzLnAucm93TGlzdFtpXStcIjwvb3B0aW9uPlwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRzdHIgKz1cIjwvc2VsZWN0PjwvdGQ+XCI7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoZGlyPT09XCJydGxcIikgeyBwZ2wgKz0gc3RyOyB9XHJcblx0XHRcdGlmKHRzLnAucGdpbnB1dD09PXRydWUpIHsgcGdpbnA9IFwiPHRkIGRpcj0nXCIrZGlyK1wiJz5cIiskLmpncmlkLmZvcm1hdCh0cy5wLnBndGV4dCB8fCBcIlwiLFwiPGlucHV0IGNsYXNzPSd1aS1wZy1pbnB1dCcgdHlwZT0ndGV4dCcgc2l6ZT0nMicgbWF4bGVuZ3RoPSc3JyB2YWx1ZT0nMCcgcm9sZT0ndGV4dGJveCcvPlwiLFwiPHNwYW4gaWQ9J3NwXzFfXCIrJC5qZ3JpZC5qcUlEKHBnaWQpK1wiJz48L3NwYW4+XCIpK1wiPC90ZD5cIjt9XHJcblx0XHRcdGlmKHRzLnAucGdidXR0b25zPT09dHJ1ZSkge1xyXG5cdFx0XHRcdHZhciBwbz1bXCJmaXJzdFwiK3RwLFwicHJldlwiK3RwLCBcIm5leHRcIit0cCxcImxhc3RcIit0cF07IGlmKGRpcj09PVwicnRsXCIpIHsgcG8ucmV2ZXJzZSgpOyB9XHJcblx0XHRcdFx0cGdsICs9IFwiPHRkIGlkPSdcIitwb1swXStcIicgY2xhc3M9J3VpLXBnLWJ1dHRvbiB1aS1jb3JuZXItYWxsJz48c3BhbiBjbGFzcz0ndWktaWNvbiB1aS1pY29uLXNlZWstZmlyc3QnPjwvc3Bhbj48L3RkPlwiO1xyXG5cdFx0XHRcdHBnbCArPSBcIjx0ZCBpZD0nXCIrcG9bMV0rXCInIGNsYXNzPSd1aS1wZy1idXR0b24gdWktY29ybmVyLWFsbCc+PHNwYW4gY2xhc3M9J3VpLWljb24gdWktaWNvbi1zZWVrLXByZXYnPjwvc3Bhbj48L3RkPlwiO1xyXG5cdFx0XHRcdHBnbCArPSBwZ2lucCAhPT0gXCJcIiA/IHNlcCtwZ2lucCtzZXA6XCJcIjtcclxuXHRcdFx0XHRwZ2wgKz0gXCI8dGQgaWQ9J1wiK3BvWzJdK1wiJyBjbGFzcz0ndWktcGctYnV0dG9uIHVpLWNvcm5lci1hbGwnPjxzcGFuIGNsYXNzPSd1aS1pY29uIHVpLWljb24tc2Vlay1uZXh0Jz48L3NwYW4+PC90ZD5cIjtcclxuXHRcdFx0XHRwZ2wgKz0gXCI8dGQgaWQ9J1wiK3BvWzNdK1wiJyBjbGFzcz0ndWktcGctYnV0dG9uIHVpLWNvcm5lci1hbGwnPjxzcGFuIGNsYXNzPSd1aS1pY29uIHVpLWljb24tc2Vlay1lbmQnPjwvc3Bhbj48L3RkPlwiO1xyXG5cdFx0XHR9IGVsc2UgaWYgKHBnaW5wICE9PSBcIlwiKSB7IHBnbCArPSBwZ2lucDsgfVxyXG5cdFx0XHRpZihkaXI9PT1cImx0clwiKSB7IHBnbCArPSBzdHI7IH1cclxuXHRcdFx0cGdsICs9IFwiPC90cj48L3Rib2R5PjwvdGFibGU+XCI7XHJcblx0XHRcdGlmKHRzLnAudmlld3JlY29yZHM9PT10cnVlKSB7JChcInRkI1wiK3BnaWQrXCJfXCIrdHMucC5yZWNvcmRwb3MsXCIjXCIrcGdjbnQpLmFwcGVuZChcIjxkaXYgZGlyPSdcIitkaXIrXCInIHN0eWxlPSd0ZXh0LWFsaWduOlwiK3RzLnAucmVjb3JkcG9zK1wiJyBjbGFzcz0ndWktcGFnaW5nLWluZm8nPjwvZGl2PlwiKTt9XHJcblx0XHRcdCQoXCJ0ZCNcIitwZ2lkK1wiX1wiK3RzLnAucGFnZXJwb3MsXCIjXCIrcGdjbnQpLmFwcGVuZChwZ2wpO1xyXG5cdFx0XHR0ZHcgPSAkKFwiLnVpLWpxZ3JpZFwiKS5jc3MoXCJmb250LXNpemVcIikgfHwgXCIxMXB4XCI7XHJcblx0XHRcdCQoZG9jdW1lbnQuYm9keSkuYXBwZW5kKFwiPGRpdiBpZD0ndGVzdHBnJyBjbGFzcz0ndWktanFncmlkIHVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCcgc3R5bGU9J2ZvbnQtc2l6ZTpcIit0ZHcrXCI7dmlzaWJpbGl0eTpoaWRkZW47JyA+PC9kaXY+XCIpO1xyXG5cdFx0XHR0d2QgPSAkKHBnbCkuY2xvbmUoKS5hcHBlbmRUbyhcIiN0ZXN0cGdcIikud2lkdGgoKTtcclxuXHRcdFx0JChcIiN0ZXN0cGdcIikucmVtb3ZlKCk7XHJcblx0XHRcdGlmKHR3ZCA+IDApIHtcclxuXHRcdFx0XHRpZihwZ2lucCAhPT0gXCJcIikgeyB0d2QgKz0gNTA7IH0gLy9zaG91bGQgYmUgcGFyYW1cclxuXHRcdFx0XHQkKFwidGQjXCIrcGdpZCtcIl9cIit0cy5wLnBhZ2VycG9zLFwiI1wiK3BnY250KS53aWR0aCh0d2QpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRzLnAuX252dGQgPSBbXTtcclxuXHRcdFx0dHMucC5fbnZ0ZFswXSA9IHR3ZCA/IE1hdGguZmxvb3IoKHRzLnAud2lkdGggLSB0d2QpLzIpIDogTWF0aC5mbG9vcih0cy5wLndpZHRoLzMpO1xyXG5cdFx0XHR0cy5wLl9udnRkWzFdID0gMDtcclxuXHRcdFx0cGdsPW51bGw7XHJcblx0XHRcdCQoJy51aS1wZy1zZWxib3gnLFwiI1wiK3BnY250KS5iaW5kKCdjaGFuZ2UnLGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGlmKCFjbGVhclZhbHMoJ3JlY29yZHMnKSkgeyByZXR1cm4gZmFsc2U7IH1cclxuXHRcdFx0XHR0cy5wLnBhZ2UgPSBNYXRoLnJvdW5kKHRzLnAucm93TnVtKih0cy5wLnBhZ2UtMSkvdGhpcy52YWx1ZS0wLjUpKzE7XHJcblx0XHRcdFx0dHMucC5yb3dOdW0gPSB0aGlzLnZhbHVlO1xyXG5cdFx0XHRcdGlmKHRzLnAucGFnZXIpIHsgJCgnLnVpLXBnLXNlbGJveCcsdHMucC5wYWdlcikudmFsKHRoaXMudmFsdWUpOyB9XHJcblx0XHRcdFx0aWYodHMucC50b3BwYWdlcikgeyAkKCcudWktcGctc2VsYm94Jyx0cy5wLnRvcHBhZ2VyKS52YWwodGhpcy52YWx1ZSk7IH1cclxuXHRcdFx0XHRwb3B1bGF0ZSgpO1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdGlmKHRzLnAucGdidXR0b25zPT09dHJ1ZSkge1xyXG5cdFx0XHQkKFwiLnVpLXBnLWJ1dHRvblwiLFwiI1wiK3BnY250KS5ob3ZlcihmdW5jdGlvbigpe1xyXG5cdFx0XHRcdGlmKCQodGhpcykuaGFzQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJykpIHtcclxuXHRcdFx0XHRcdHRoaXMuc3R5bGUuY3Vyc29yPSdkZWZhdWx0JztcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JCh0aGlzKS5hZGRDbGFzcygndWktc3RhdGUtaG92ZXInKTtcclxuXHRcdFx0XHRcdHRoaXMuc3R5bGUuY3Vyc29yPSdwb2ludGVyJztcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0aWYoISQodGhpcykuaGFzQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJykpIHtcclxuXHRcdFx0XHRcdCQodGhpcykucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7XHJcblx0XHRcdFx0XHR0aGlzLnN0eWxlLmN1cnNvcj0gXCJkZWZhdWx0XCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0JChcIiNmaXJzdFwiKyQuamdyaWQuanFJRCh0cCkrXCIsICNwcmV2XCIrJC5qZ3JpZC5qcUlEKHRwKStcIiwgI25leHRcIiskLmpncmlkLmpxSUQodHApK1wiLCAjbGFzdFwiKyQuamdyaWQuanFJRCh0cCkpLmNsaWNrKCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZiAoJCh0aGlzKS5oYXNDbGFzcyhcInVpLXN0YXRlLWRpc2FibGVkXCIpKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHZhciBjcCA9IGludE51bSh0cy5wLnBhZ2UsMSksXHJcblx0XHRcdFx0bGFzdCA9IGludE51bSh0cy5wLmxhc3RwYWdlLDEpLCBzZWxjbGljayA9IGZhbHNlLFxyXG5cdFx0XHRcdGZwPXRydWUsIHBwPXRydWUsIG5wPXRydWUsbHA9dHJ1ZTtcclxuXHRcdFx0XHRpZihsYXN0ID09PTAgfHwgbGFzdD09PTEpIHtmcD1mYWxzZTtwcD1mYWxzZTtucD1mYWxzZTtscD1mYWxzZTsgfVxyXG5cdFx0XHRcdGVsc2UgaWYoIGxhc3Q+MSAmJiBjcCA+PTEpIHtcclxuXHRcdFx0XHRcdGlmKCBjcCA9PT0gMSkgeyBmcD1mYWxzZTsgcHA9ZmFsc2U7IH1cclxuXHRcdFx0XHRcdC8vZWxzZSBpZiggY3A+MSAmJiBjcCA8bGFzdCl7IH1cclxuXHRcdFx0XHRcdGVsc2UgaWYoIGNwPT09bGFzdCl7IG5wPWZhbHNlO2xwPWZhbHNlOyB9XHJcblx0XHRcdFx0fSBlbHNlIGlmKCBsYXN0PjEgJiYgY3A9PT0wICkgeyBucD1mYWxzZTtscD1mYWxzZTsgY3A9bGFzdC0xO31cclxuXHRcdFx0XHRpZighY2xlYXJWYWxzKHRoaXMuaWQpKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cdFx0XHRcdGlmKCB0aGlzLmlkID09PSAnZmlyc3QnK3RwICYmIGZwICkgeyB0cy5wLnBhZ2U9MTsgc2VsY2xpY2s9dHJ1ZTt9XHJcblx0XHRcdFx0aWYoIHRoaXMuaWQgPT09ICdwcmV2Jyt0cCAmJiBwcCkgeyB0cy5wLnBhZ2U9KGNwLTEpOyBzZWxjbGljaz10cnVlO31cclxuXHRcdFx0XHRpZiggdGhpcy5pZCA9PT0gJ25leHQnK3RwICYmIG5wKSB7IHRzLnAucGFnZT0oY3ArMSk7IHNlbGNsaWNrPXRydWU7fVxyXG5cdFx0XHRcdGlmKCB0aGlzLmlkID09PSAnbGFzdCcrdHAgJiYgbHApIHsgdHMucC5wYWdlPWxhc3Q7IHNlbGNsaWNrPXRydWU7fVxyXG5cdFx0XHRcdGlmKHNlbGNsaWNrKSB7XHJcblx0XHRcdFx0XHRwb3B1bGF0ZSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHRzLnAucGdpbnB1dD09PXRydWUpIHtcclxuXHRcdFx0JCgnaW5wdXQudWktcGctaW5wdXQnLFwiI1wiK3BnY250KS5rZXlwcmVzcyggZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdHZhciBrZXkgPSBlLmNoYXJDb2RlIHx8IGUua2V5Q29kZSB8fCAwO1xyXG5cdFx0XHRcdGlmKGtleSA9PT0gMTMpIHtcclxuXHRcdFx0XHRcdGlmKCFjbGVhclZhbHMoJ3VzZXInKSkgeyByZXR1cm4gZmFsc2U7IH1cclxuXHRcdFx0XHRcdCQodGhpcykudmFsKCBpbnROdW0oICQodGhpcykudmFsKCksIDEpKTtcclxuXHRcdFx0XHRcdHRzLnAucGFnZSA9ICgkKHRoaXMpLnZhbCgpPjApID8gJCh0aGlzKS52YWwoKTp0cy5wLnBhZ2U7XHJcblx0XHRcdFx0XHRwb3B1bGF0ZSgpO1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRtdWx0aVNvcnQgPSBmdW5jdGlvbihpQ29sLCBvYmogKSB7XHJcblx0XHRcdHZhciBzcGxhcywgc29ydD1cIlwiLCBjbSA9IHRzLnAuY29sTW9kZWwsIGZzPWZhbHNlLCBscyxcclxuXHRcdFx0XHRcdHNlbFRoID0gdHMucC5mcm96ZW5Db2x1bW5zID8gIG9iaiA6IHRzLmdyaWQuaGVhZGVyc1tpQ29sXS5lbCwgc289XCJcIjtcclxuXHRcdFx0JChcInNwYW4udWktZ3JpZC1pY28tc29ydFwiLHNlbFRoKS5hZGRDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0JChzZWxUaCkuYXR0cihcImFyaWEtc2VsZWN0ZWRcIixcImZhbHNlXCIpO1xyXG5cclxuXHRcdFx0aWYoY21baUNvbF0ubHNvKSB7XHJcblx0XHRcdFx0aWYoY21baUNvbF0ubHNvPT09XCJhc2NcIikge1xyXG5cdFx0XHRcdFx0Y21baUNvbF0ubHNvICs9IFwiLWRlc2NcIjtcclxuXHRcdFx0XHRcdHNvID0gXCJkZXNjXCI7XHJcblx0XHRcdFx0fSBlbHNlIGlmKGNtW2lDb2xdLmxzbz09PVwiZGVzY1wiKSB7XHJcblx0XHRcdFx0XHRjbVtpQ29sXS5sc28gKz0gXCItYXNjXCI7XHJcblx0XHRcdFx0XHRzbyA9IFwiYXNjXCI7XHJcblx0XHRcdFx0fSBlbHNlIGlmKGNtW2lDb2xdLmxzbz09PVwiYXNjLWRlc2NcIiB8fCBjbVtpQ29sXS5sc289PT1cImRlc2MtYXNjXCIpIHtcclxuXHRcdFx0XHRcdGNtW2lDb2xdLmxzbz1cIlwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRjbVtpQ29sXS5sc28gPSBzbyA9IGNtW2lDb2xdLmZpcnN0c29ydG9yZGVyIHx8ICdhc2MnO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKCBzbyApIHtcclxuXHRcdFx0XHQkKFwic3Bhbi5zLWljb1wiLHNlbFRoKS5zaG93KCk7XHJcblx0XHRcdFx0JChcInNwYW4udWktaWNvbi1cIitzbyxzZWxUaCkucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0XHRcdFx0JChzZWxUaCkuYXR0cihcImFyaWEtc2VsZWN0ZWRcIixcInRydWVcIik7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0aWYoIXRzLnAudmlld3NvcnRjb2xzWzBdKSB7XHJcblx0XHRcdFx0XHQkKFwic3Bhbi5zLWljb1wiLHNlbFRoKS5oaWRlKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHRzLnAuc29ydG9yZGVyID0gXCJcIjtcclxuXHRcdFx0JC5lYWNoKGNtLCBmdW5jdGlvbihpKXtcclxuXHRcdFx0XHRpZih0aGlzLmxzbykge1xyXG5cdFx0XHRcdFx0aWYoaT4wICYmIGZzKSB7XHJcblx0XHRcdFx0XHRcdHNvcnQgKz0gXCIsIFwiO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0c3BsYXMgPSB0aGlzLmxzby5zcGxpdChcIi1cIik7XHJcblx0XHRcdFx0XHRzb3J0ICs9IGNtW2ldLmluZGV4IHx8IGNtW2ldLm5hbWU7XHJcblx0XHRcdFx0XHRzb3J0ICs9IFwiIFwiK3NwbGFzW3NwbGFzLmxlbmd0aC0xXTtcclxuXHRcdFx0XHRcdGZzID0gdHJ1ZTtcclxuXHRcdFx0XHRcdHRzLnAuc29ydG9yZGVyID0gc3BsYXNbc3BsYXMubGVuZ3RoLTFdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdGxzID0gc29ydC5sYXN0SW5kZXhPZih0cy5wLnNvcnRvcmRlcik7XHJcblx0XHRcdHNvcnQgPSBzb3J0LnN1YnN0cmluZygwLCBscyk7XHJcblx0XHRcdHRzLnAuc29ydG5hbWUgPSBzb3J0O1xyXG5cdFx0fSxcclxuXHRcdHNvcnREYXRhID0gZnVuY3Rpb24gKGluZGV4LCBpZHhjb2wscmVsb2FkLHNvciwgb2JqKXtcclxuXHRcdFx0aWYoIXRzLnAuY29sTW9kZWxbaWR4Y29sXS5zb3J0YWJsZSkgeyByZXR1cm47IH1cclxuXHRcdFx0aWYodHMucC5zYXZlZFJvdy5sZW5ndGggPiAwKSB7cmV0dXJuO31cclxuXHRcdFx0aWYoIXJlbG9hZCkge1xyXG5cdFx0XHRcdGlmKCB0cy5wLmxhc3Rzb3J0ID09PSBpZHhjb2wgKSB7XHJcblx0XHRcdFx0XHRpZiggdHMucC5zb3J0b3JkZXIgPT09ICdhc2MnKSB7XHJcblx0XHRcdFx0XHRcdHRzLnAuc29ydG9yZGVyID0gJ2Rlc2MnO1xyXG5cdFx0XHRcdFx0fSBlbHNlIGlmKHRzLnAuc29ydG9yZGVyID09PSAnZGVzYycpIHsgdHMucC5zb3J0b3JkZXIgPSAnYXNjJzt9XHJcblx0XHRcdFx0fSBlbHNlIHsgdHMucC5zb3J0b3JkZXIgPSB0cy5wLmNvbE1vZGVsW2lkeGNvbF0uZmlyc3Rzb3J0b3JkZXIgfHwgJ2FzYyc7IH1cclxuXHRcdFx0XHR0cy5wLnBhZ2UgPSAxO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHRzLnAubXVsdGlTb3J0KSB7XHJcblx0XHRcdFx0bXVsdGlTb3J0KCBpZHhjb2wsIG9iaik7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0aWYoc29yKSB7XHJcblx0XHRcdFx0XHRpZih0cy5wLmxhc3Rzb3J0ID09PSBpZHhjb2wgJiYgdHMucC5zb3J0b3JkZXIgPT09IHNvciAmJiAhcmVsb2FkKSB7IHJldHVybjsgfVxyXG5cdFx0XHRcdFx0dHMucC5zb3J0b3JkZXIgPSBzb3I7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHZhciBwcmV2aW91c1NlbGVjdGVkVGggPSB0cy5ncmlkLmhlYWRlcnNbdHMucC5sYXN0c29ydF0uZWwsIG5ld1NlbGVjdGVkVGggPSB0cy5wLmZyb3plbkNvbHVtbnMgPyAgb2JqIDogdHMuZ3JpZC5oZWFkZXJzW2lkeGNvbF0uZWw7XHJcblxyXG5cdFx0XHRcdCQoXCJzcGFuLnVpLWdyaWQtaWNvLXNvcnRcIixwcmV2aW91c1NlbGVjdGVkVGgpLmFkZENsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpO1xyXG5cdFx0XHRcdCQocHJldmlvdXNTZWxlY3RlZFRoKS5hdHRyKFwiYXJpYS1zZWxlY3RlZFwiLFwiZmFsc2VcIik7XHJcblx0XHRcdFx0aWYodHMucC5mcm96ZW5Db2x1bW5zKSB7XHJcblx0XHRcdFx0XHR0cy5ncmlkLmZoRGl2LmZpbmQoXCJzcGFuLnVpLWdyaWQtaWNvLXNvcnRcIikuYWRkQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0XHRcdFx0XHR0cy5ncmlkLmZoRGl2LmZpbmQoXCJ0aFwiKS5hdHRyKFwiYXJpYS1zZWxlY3RlZFwiLFwiZmFsc2VcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCQoXCJzcGFuLnVpLWljb24tXCIrdHMucC5zb3J0b3JkZXIsbmV3U2VsZWN0ZWRUaCkucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0XHRcdFx0JChuZXdTZWxlY3RlZFRoKS5hdHRyKFwiYXJpYS1zZWxlY3RlZFwiLFwidHJ1ZVwiKTtcclxuXHRcdFx0XHRpZighdHMucC52aWV3c29ydGNvbHNbMF0pIHtcclxuXHRcdFx0XHRcdGlmKHRzLnAubGFzdHNvcnQgIT09IGlkeGNvbCkge1xyXG5cdFx0XHRcdFx0XHRpZih0cy5wLmZyb3plbkNvbHVtbnMpe1xyXG5cdFx0XHRcdFx0XHRcdHRzLmdyaWQuZmhEaXYuZmluZChcInNwYW4ucy1pY29cIikuaGlkZSgpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdCQoXCJzcGFuLnMtaWNvXCIscHJldmlvdXNTZWxlY3RlZFRoKS5oaWRlKCk7XHJcblx0XHRcdFx0XHRcdCQoXCJzcGFuLnMtaWNvXCIsbmV3U2VsZWN0ZWRUaCkuc2hvdygpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpbmRleCA9IGluZGV4LnN1YnN0cmluZyg1ICsgdHMucC5pZC5sZW5ndGggKyAxKTsgLy8gYmFkIHRvIGJlIGNoYW5nZWQhPyFcclxuXHRcdFx0XHR0cy5wLnNvcnRuYW1lID0gdHMucC5jb2xNb2RlbFtpZHhjb2xdLmluZGV4IHx8IGluZGV4O1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICgkKHRzKS50cmlnZ2VySGFuZGxlcihcImpxR3JpZFNvcnRDb2xcIiwgW3RzLnAuc29ydG5hbWUsIGlkeGNvbCwgdHMucC5zb3J0b3JkZXJdKSA9PT0gJ3N0b3AnKSB7XHJcblx0XHRcdFx0dHMucC5sYXN0c29ydCA9IGlkeGNvbDtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoJC5pc0Z1bmN0aW9uKHRzLnAub25Tb3J0Q29sKSkge2lmICh0cy5wLm9uU29ydENvbC5jYWxsKHRzLCB0cy5wLnNvcnRuYW1lLCBpZHhjb2wsIHRzLnAuc29ydG9yZGVyKT09PSdzdG9wJykge3RzLnAubGFzdHNvcnQgPSBpZHhjb2w7IHJldHVybjt9fVxyXG5cdFx0XHRpZih0cy5wLmRhdGF0eXBlID09PSBcImxvY2FsXCIpIHtcclxuXHRcdFx0XHRpZih0cy5wLmRlc2VsZWN0QWZ0ZXJTb3J0KSB7JCh0cykuanFHcmlkKFwicmVzZXRTZWxlY3Rpb25cIik7fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRzLnAuc2Vscm93ID0gbnVsbDtcclxuXHRcdFx0XHRpZih0cy5wLm11bHRpc2VsZWN0KXtzZXRIZWFkQ2hlY2tCb3goIGZhbHNlICk7fVxyXG5cdFx0XHRcdHRzLnAuc2VsYXJycm93ID1bXTtcclxuXHRcdFx0XHR0cy5wLnNhdmVkUm93ID1bXTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZih0cy5wLnNjcm9sbCkge1xyXG5cdFx0XHRcdHZhciBzc2Nyb2xsID0gdHMuZ3JpZC5iRGl2LnNjcm9sbExlZnQ7XHJcblx0XHRcdFx0ZW1wdHlSb3dzLmNhbGwodHMsIHRydWUsIGZhbHNlKTtcclxuXHRcdFx0XHR0cy5ncmlkLmhEaXYuc2Nyb2xsTGVmdCA9IHNzY3JvbGw7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYodHMucC5zdWJHcmlkICYmIHRzLnAuZGF0YXR5cGUgPT09ICdsb2NhbCcpIHtcclxuXHRcdFx0XHQkKFwidGQuc2dleHBhbmRlZFwiLFwiI1wiKyQuamdyaWQuanFJRCh0cy5wLmlkKSkuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0JCh0aGlzKS50cmlnZ2VyKFwiY2xpY2tcIik7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0cG9wdWxhdGUoKTtcclxuXHRcdFx0dHMucC5sYXN0c29ydCA9IGlkeGNvbDtcclxuXHRcdFx0aWYodHMucC5zb3J0bmFtZSAhPT0gaW5kZXggJiYgaWR4Y29sKSB7dHMucC5sYXN0c29ydCA9IGlkeGNvbDt9XHJcblx0XHR9LFxyXG5cdFx0c2V0Q29sV2lkdGggPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHZhciBpbml0d2lkdGggPSAwLCBicmQ9JC5qZ3JpZC5jZWxsX3dpZHRoPyAwOiBpbnROdW0odHMucC5jZWxsTGF5b3V0LDApLCB2Yz0wLCBsdmMsIHNjdz1pbnROdW0odHMucC5zY3JvbGxPZmZzZXQsMCksY3csaHM9ZmFsc2UsYXcsZ3c9MCxjcjtcclxuXHRcdFx0JC5lYWNoKHRzLnAuY29sTW9kZWwsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGlmKHRoaXMuaGlkZGVuID09PSB1bmRlZmluZWQpIHt0aGlzLmhpZGRlbj1mYWxzZTt9XHJcblx0XHRcdFx0aWYodHMucC5ncm91cGluZyAmJiB0cy5wLmF1dG93aWR0aCkge1xyXG5cdFx0XHRcdFx0dmFyIGluZCA9ICQuaW5BcnJheSh0aGlzLm5hbWUsIHRzLnAuZ3JvdXBpbmdWaWV3Lmdyb3VwRmllbGQpO1xyXG5cdFx0XHRcdFx0aWYoaW5kID49IDAgJiYgdHMucC5ncm91cGluZ1ZpZXcuZ3JvdXBDb2x1bW5TaG93Lmxlbmd0aCA+IGluZCkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmhpZGRlbiA9ICF0cy5wLmdyb3VwaW5nVmlldy5ncm91cENvbHVtblNob3dbaW5kXTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dGhpcy53aWR0aE9yZyA9IGN3ID0gaW50TnVtKHRoaXMud2lkdGgsMCk7XHJcblx0XHRcdFx0aWYodGhpcy5oaWRkZW49PT1mYWxzZSl7XHJcblx0XHRcdFx0XHRpbml0d2lkdGggKz0gY3crYnJkO1xyXG5cdFx0XHRcdFx0aWYodGhpcy5maXhlZCkge1xyXG5cdFx0XHRcdFx0XHRndyArPSBjdyticmQ7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHR2YysrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdGlmKGlzTmFOKHRzLnAud2lkdGgpKSB7XHJcblx0XHRcdFx0dHMucC53aWR0aCAgPSBpbml0d2lkdGggKyAoKHRzLnAuc2hyaW5rVG9GaXQgPT09ZmFsc2UgJiYgIWlzTmFOKHRzLnAuaGVpZ2h0KSkgPyBzY3cgOiAwKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRncmlkLndpZHRoID0gdHMucC53aWR0aDtcclxuXHRcdFx0dHMucC50Ymx3aWR0aCA9IGluaXR3aWR0aDtcclxuXHRcdFx0aWYodHMucC5zaHJpbmtUb0ZpdCA9PT1mYWxzZSAmJiB0cy5wLmZvcmNlRml0ID09PSB0cnVlKSB7dHMucC5mb3JjZUZpdD1mYWxzZTt9XHJcblx0XHRcdGlmKHRzLnAuc2hyaW5rVG9GaXQ9PT10cnVlICYmIHZjID4gMCkge1xyXG5cdFx0XHRcdGF3ID0gZ3JpZC53aWR0aC1icmQqdmMtZ3c7XHJcblx0XHRcdFx0aWYoIWlzTmFOKHRzLnAuaGVpZ2h0KSkge1xyXG5cdFx0XHRcdFx0YXcgLT0gc2N3O1xyXG5cdFx0XHRcdFx0aHMgPSB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpbml0d2lkdGggPTA7XHJcblx0XHRcdFx0JC5lYWNoKHRzLnAuY29sTW9kZWwsIGZ1bmN0aW9uKGkpIHtcclxuXHRcdFx0XHRcdGlmKHRoaXMuaGlkZGVuID09PSBmYWxzZSAmJiAhdGhpcy5maXhlZCl7XHJcblx0XHRcdFx0XHRcdGN3ID0gTWF0aC5yb3VuZChhdyp0aGlzLndpZHRoLyh0cy5wLnRibHdpZHRoLWJyZCp2Yy1ndykpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLndpZHRoID1jdztcclxuXHRcdFx0XHRcdFx0aW5pdHdpZHRoICs9IGN3O1xyXG5cdFx0XHRcdFx0XHRsdmMgPSBpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdGNyID0wO1xyXG5cdFx0XHRcdGlmIChocykge1xyXG5cdFx0XHRcdFx0aWYoZ3JpZC53aWR0aC1ndy0oaW5pdHdpZHRoK2JyZCp2YykgIT09IHNjdyl7XHJcblx0XHRcdFx0XHRcdGNyID0gZ3JpZC53aWR0aC1ndy0oaW5pdHdpZHRoK2JyZCp2Yyktc2N3O1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSBpZighaHMgJiYgTWF0aC5hYnMoZ3JpZC53aWR0aC1ndy0oaW5pdHdpZHRoK2JyZCp2YykpICE9PSAxKSB7XHJcblx0XHRcdFx0XHRjciA9IGdyaWQud2lkdGgtZ3ctKGluaXR3aWR0aCticmQqdmMpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0cy5wLmNvbE1vZGVsW2x2Y10ud2lkdGggKz0gY3I7XHJcblx0XHRcdFx0dHMucC50Ymx3aWR0aCA9IGluaXR3aWR0aCtjciticmQqdmMrZ3c7XHJcblx0XHRcdFx0aWYodHMucC50Ymx3aWR0aCA+IHRzLnAud2lkdGgpIHtcclxuXHRcdFx0XHRcdHRzLnAuY29sTW9kZWxbbHZjXS53aWR0aCAtPSAodHMucC50Ymx3aWR0aCAtIHBhcnNlSW50KHRzLnAud2lkdGgsMTApKTtcclxuXHRcdFx0XHRcdHRzLnAudGJsd2lkdGggPSB0cy5wLndpZHRoO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdG5leHRWaXNpYmxlPSBmdW5jdGlvbihpQ29sKSB7XHJcblx0XHRcdHZhciByZXQgPSBpQ29sLCBqPWlDb2wsIGk7XHJcblx0XHRcdGZvciAoaSA9IGlDb2wrMTtpPHRzLnAuY29sTW9kZWwubGVuZ3RoO2krKyl7XHJcblx0XHRcdFx0aWYodHMucC5jb2xNb2RlbFtpXS5oaWRkZW4gIT09IHRydWUgKSB7XHJcblx0XHRcdFx0XHRqPWk7IGJyZWFrO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gai1yZXQ7XHJcblx0XHR9LFxyXG5cdFx0Z2V0T2Zmc2V0ID0gZnVuY3Rpb24gKGlDb2wpIHtcclxuXHRcdFx0dmFyICR0aCA9ICQodHMuZ3JpZC5oZWFkZXJzW2lDb2xdLmVsKSwgcmV0ID0gWyR0aC5wb3NpdGlvbigpLmxlZnQgKyAkdGgub3V0ZXJXaWR0aCgpXTtcclxuXHRcdFx0aWYodHMucC5kaXJlY3Rpb249PT1cInJ0bFwiKSB7IHJldFswXSA9IHRzLnAud2lkdGggLSByZXRbMF07IH1cclxuXHRcdFx0cmV0WzBdIC09IHRzLmdyaWQuYkRpdi5zY3JvbGxMZWZ0O1xyXG5cdFx0XHRyZXQucHVzaCgkKHRzLmdyaWQuaERpdikucG9zaXRpb24oKS50b3ApO1xyXG5cdFx0XHRyZXQucHVzaCgkKHRzLmdyaWQuYkRpdikub2Zmc2V0KCkudG9wIC0gJCh0cy5ncmlkLmhEaXYpLm9mZnNldCgpLnRvcCArICQodHMuZ3JpZC5iRGl2KS5oZWlnaHQoKSk7XHJcblx0XHRcdHJldHVybiByZXQ7XHJcblx0XHR9LFxyXG5cdFx0Z2V0Q29sdW1uSGVhZGVySW5kZXggPSBmdW5jdGlvbiAodGgpIHtcclxuXHRcdFx0dmFyIGksIGhlYWRlcnMgPSB0cy5ncmlkLmhlYWRlcnMsIGNpID0gJC5qZ3JpZC5nZXRDZWxsSW5kZXgodGgpO1xyXG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgaGVhZGVycy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdGlmICh0aCA9PT0gaGVhZGVyc1tpXS5lbCkge1xyXG5cdFx0XHRcdFx0Y2kgPSBpO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBjaTtcclxuXHRcdH07XHJcblx0XHR0aGlzLnAuaWQgPSB0aGlzLmlkO1xyXG5cdFx0aWYgKCQuaW5BcnJheSh0cy5wLm11bHRpa2V5LHNvcnRrZXlzKSA9PT0gLTEgKSB7dHMucC5tdWx0aWtleSA9IGZhbHNlO31cclxuXHRcdHRzLnAua2V5SW5kZXg9ZmFsc2U7XHJcblx0XHR0cy5wLmtleU5hbWU9ZmFsc2U7XHJcblx0XHRmb3IgKGk9MDsgaTx0cy5wLmNvbE1vZGVsLmxlbmd0aDtpKyspIHtcclxuXHRcdFx0dHMucC5jb2xNb2RlbFtpXSA9ICQuZXh0ZW5kKHRydWUsIHt9LCB0cy5wLmNtVGVtcGxhdGUsIHRzLnAuY29sTW9kZWxbaV0udGVtcGxhdGUgfHwge30sIHRzLnAuY29sTW9kZWxbaV0pO1xyXG5cdFx0XHRpZiAodHMucC5rZXlJbmRleCA9PT0gZmFsc2UgJiYgdHMucC5jb2xNb2RlbFtpXS5rZXk9PT10cnVlKSB7XHJcblx0XHRcdFx0dHMucC5rZXlJbmRleCA9IGk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHRzLnAuc29ydG9yZGVyID0gdHMucC5zb3J0b3JkZXIudG9Mb3dlckNhc2UoKTtcclxuXHRcdCQuamdyaWQuY2VsbF93aWR0aCA9ICQuamdyaWQuY2VsbFdpZHRoKCk7XHJcblx0XHRpZih0cy5wLmdyb3VwaW5nPT09dHJ1ZSkge1xyXG5cdFx0XHR0cy5wLnNjcm9sbCA9IGZhbHNlO1xyXG5cdFx0XHR0cy5wLnJvd251bWJlcnMgPSBmYWxzZTtcclxuXHRcdFx0Ly90cy5wLnN1YkdyaWQgPSBmYWxzZTsgZXhwaXJlbWVudGFsXHJcblx0XHRcdHRzLnAudHJlZUdyaWQgPSBmYWxzZTtcclxuXHRcdFx0dHMucC5ncmlkdmlldyA9IHRydWU7XHJcblx0XHR9XHJcblx0XHRpZih0aGlzLnAudHJlZUdyaWQgPT09IHRydWUpIHtcclxuXHRcdFx0dHJ5IHsgJCh0aGlzKS5qcUdyaWQoXCJzZXRUcmVlR3JpZFwiKTt9IGNhdGNoIChfKSB7fVxyXG5cdFx0XHRpZih0cy5wLmRhdGF0eXBlICE9PSBcImxvY2FsXCIpIHsgdHMucC5sb2NhbFJlYWRlciA9IHtpZDogXCJfaWRfXCJ9O1x0fVxyXG5cdFx0fVxyXG5cdFx0aWYodGhpcy5wLnN1YkdyaWQpIHtcclxuXHRcdFx0dHJ5IHsgJCh0cykuanFHcmlkKFwic2V0U3ViR3JpZFwiKTt9IGNhdGNoIChzKXt9XHJcblx0XHR9XHJcblx0XHRpZih0aGlzLnAubXVsdGlzZWxlY3QpIHtcclxuXHRcdFx0dGhpcy5wLmNvbE5hbWVzLnVuc2hpZnQoXCI8aW5wdXQgcm9sZT0nY2hlY2tib3gnIGlkPSdjYl9cIit0aGlzLnAuaWQrXCInIGNsYXNzPSdjYm94JyB0eXBlPSdjaGVja2JveCcvPlwiKTtcclxuXHRcdFx0dGhpcy5wLmNvbE1vZGVsLnVuc2hpZnQoe25hbWU6J2NiJyx3aWR0aDokLmpncmlkLmNlbGxfd2lkdGggPyB0cy5wLm11bHRpc2VsZWN0V2lkdGgrdHMucC5jZWxsTGF5b3V0IDogdHMucC5tdWx0aXNlbGVjdFdpZHRoLHNvcnRhYmxlOmZhbHNlLHJlc2l6YWJsZTpmYWxzZSxoaWRlZGxnOnRydWUsc2VhcmNoOmZhbHNlLGFsaWduOidjZW50ZXInLGZpeGVkOnRydWV9KTtcclxuXHRcdH1cclxuXHRcdGlmKHRoaXMucC5yb3dudW1iZXJzKSB7XHJcblx0XHRcdHRoaXMucC5jb2xOYW1lcy51bnNoaWZ0KFwiXCIpO1xyXG5cdFx0XHR0aGlzLnAuY29sTW9kZWwudW5zaGlmdCh7bmFtZToncm4nLHdpZHRoOnRzLnAucm93bnVtV2lkdGgsc29ydGFibGU6ZmFsc2UscmVzaXphYmxlOmZhbHNlLGhpZGVkbGc6dHJ1ZSxzZWFyY2g6ZmFsc2UsYWxpZ246J2NlbnRlcicsZml4ZWQ6dHJ1ZX0pO1xyXG5cdFx0fVxyXG5cdFx0dHMucC54bWxSZWFkZXIgPSAkLmV4dGVuZCh0cnVlLHtcclxuXHRcdFx0cm9vdDogXCJyb3dzXCIsXHJcblx0XHRcdHJvdzogXCJyb3dcIixcclxuXHRcdFx0cGFnZTogXCJyb3dzPnBhZ2VcIixcclxuXHRcdFx0dG90YWw6IFwicm93cz50b3RhbFwiLFxyXG5cdFx0XHRyZWNvcmRzIDogXCJyb3dzPnJlY29yZHNcIixcclxuXHRcdFx0cmVwZWF0aXRlbXM6IHRydWUsXHJcblx0XHRcdGNlbGw6IFwiY2VsbFwiLFxyXG5cdFx0XHRpZDogXCJbaWRdXCIsXHJcblx0XHRcdHVzZXJkYXRhOiBcInVzZXJkYXRhXCIsXHJcblx0XHRcdHN1YmdyaWQ6IHtyb290Olwicm93c1wiLCByb3c6IFwicm93XCIsIHJlcGVhdGl0ZW1zOiB0cnVlLCBjZWxsOlwiY2VsbFwifVxyXG5cdFx0fSwgdHMucC54bWxSZWFkZXIpO1xyXG5cdFx0dHMucC5qc29uUmVhZGVyID0gJC5leHRlbmQodHJ1ZSx7XHJcblx0XHRcdHJvb3Q6IFwicm93c1wiLFxyXG5cdFx0XHRwYWdlOiBcInBhZ2VcIixcclxuXHRcdFx0dG90YWw6IFwidG90YWxcIixcclxuXHRcdFx0cmVjb3JkczogXCJyZWNvcmRzXCIsXHJcblx0XHRcdHJlcGVhdGl0ZW1zOiB0cnVlLFxyXG5cdFx0XHRjZWxsOiBcImNlbGxcIixcclxuXHRcdFx0aWQ6IFwiaWRcIixcclxuXHRcdFx0dXNlcmRhdGE6IFwidXNlcmRhdGFcIixcclxuXHRcdFx0c3ViZ3JpZDoge3Jvb3Q6XCJyb3dzXCIsIHJlcGVhdGl0ZW1zOiB0cnVlLCBjZWxsOlwiY2VsbFwifVxyXG5cdFx0fSx0cy5wLmpzb25SZWFkZXIpO1xyXG5cdFx0dHMucC5sb2NhbFJlYWRlciA9ICQuZXh0ZW5kKHRydWUse1xyXG5cdFx0XHRyb290OiBcInJvd3NcIixcclxuXHRcdFx0cGFnZTogXCJwYWdlXCIsXHJcblx0XHRcdHRvdGFsOiBcInRvdGFsXCIsXHJcblx0XHRcdHJlY29yZHM6IFwicmVjb3Jkc1wiLFxyXG5cdFx0XHRyZXBlYXRpdGVtczogZmFsc2UsXHJcblx0XHRcdGNlbGw6IFwiY2VsbFwiLFxyXG5cdFx0XHRpZDogXCJpZFwiLFxyXG5cdFx0XHR1c2VyZGF0YTogXCJ1c2VyZGF0YVwiLFxyXG5cdFx0XHRzdWJncmlkOiB7cm9vdDpcInJvd3NcIiwgcmVwZWF0aXRlbXM6IHRydWUsIGNlbGw6XCJjZWxsXCJ9XHJcblx0XHR9LHRzLnAubG9jYWxSZWFkZXIpO1xyXG5cdFx0aWYodHMucC5zY3JvbGwpe1xyXG5cdFx0XHR0cy5wLnBnYnV0dG9ucyA9IGZhbHNlOyB0cy5wLnBnaW5wdXQ9ZmFsc2U7IHRzLnAucm93TGlzdD1bXTtcclxuXHRcdH1cclxuXHRcdGlmKHRzLnAuZGF0YS5sZW5ndGgpIHsgcmVmcmVzaEluZGV4KCk7IH1cclxuXHRcdHZhciB0aGVhZCA9IFwiPHRoZWFkPjx0ciBjbGFzcz0ndWktanFncmlkLWxhYmVscycgcm9sZT0ncm93aGVhZGVyJz5cIixcclxuXHRcdHRkYywgaWRuLCB3LCByZXMsIHNvcnQsXHJcblx0XHR0ZCwgcHRyLCB0Ym9keSwgaW1ncyxpYWM9XCJcIixpZGM9XCJcIixzb3J0YXJyPVtdLCBzb3J0b3JkPVtdLCBzb3RtcD1bXTtcclxuXHRcdGlmKHRzLnAuc2hyaW5rVG9GaXQ9PT10cnVlICYmIHRzLnAuZm9yY2VGaXQ9PT10cnVlKSB7XHJcblx0XHRcdGZvciAoaT10cy5wLmNvbE1vZGVsLmxlbmd0aC0xO2k+PTA7aS0tKXtcclxuXHRcdFx0XHRpZighdHMucC5jb2xNb2RlbFtpXS5oaWRkZW4pIHtcclxuXHRcdFx0XHRcdHRzLnAuY29sTW9kZWxbaV0ucmVzaXphYmxlPWZhbHNlO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZih0cy5wLnZpZXdzb3J0Y29sc1sxXSA9PT0gJ2hvcml6b250YWwnKSB7aWFjPVwiIHVpLWktYXNjXCI7aWRjPVwiIHVpLWktZGVzY1wiO31cclxuXHRcdHRkYyA9IGlzTVNJRSA/ICBcImNsYXNzPSd1aS10aC1kaXYtaWUnXCIgOlwiXCI7XHJcblx0XHRpbWdzID0gXCI8c3BhbiBjbGFzcz0ncy1pY28nIHN0eWxlPSdkaXNwbGF5Om5vbmUnPjxzcGFuIHNvcnQ9J2FzYycgY2xhc3M9J3VpLWdyaWQtaWNvLXNvcnQgdWktaWNvbi1hc2NcIitpYWMrXCIgdWktc3RhdGUtZGlzYWJsZWQgdWktaWNvbiB1aS1pY29uLXRyaWFuZ2xlLTEtbiB1aS1zb3J0LVwiK2RpcitcIic+PC9zcGFuPlwiO1xyXG5cdFx0aW1ncyArPSBcIjxzcGFuIHNvcnQ9J2Rlc2MnIGNsYXNzPSd1aS1ncmlkLWljby1zb3J0IHVpLWljb24tZGVzY1wiK2lkYytcIiB1aS1zdGF0ZS1kaXNhYmxlZCB1aS1pY29uIHVpLWljb24tdHJpYW5nbGUtMS1zIHVpLXNvcnQtXCIrZGlyK1wiJz48L3NwYW4+PC9zcGFuPlwiO1xyXG5cdFx0aWYodHMucC5tdWx0aVNvcnQpIHtcclxuXHRcdFx0c29ydGFyciA9IHRzLnAuc29ydG5hbWUuc3BsaXQoXCIsXCIpO1xyXG5cdFx0XHRmb3IgKGk9MDsgaTxzb3J0YXJyLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0c290bXAgPSAkLnRyaW0oc29ydGFycltpXSkuc3BsaXQoXCIgXCIpO1xyXG5cdFx0XHRcdHNvcnRhcnJbaV0gPSAkLnRyaW0oc290bXBbMF0pO1xyXG5cdFx0XHRcdHNvcnRvcmRbaV0gPSBzb3RtcFsxXSA/ICQudHJpbShzb3RtcFsxXSkgOiB0cy5wLnNvcnRvcmRlciB8fCBcImFzY1wiO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRmb3IoaT0wO2k8dGhpcy5wLmNvbE5hbWVzLmxlbmd0aDtpKyspe1xyXG5cdFx0XHR2YXIgdG9vbHRpcCA9IHRzLnAuaGVhZGVydGl0bGVzID8gKFwiIHRpdGxlPVxcXCJcIiskLmpncmlkLnN0cmlwSHRtbCh0cy5wLmNvbE5hbWVzW2ldKStcIlxcXCJcIikgOlwiXCI7XHJcblx0XHRcdHRoZWFkICs9IFwiPHRoIGlkPSdcIit0cy5wLmlkK1wiX1wiK3RzLnAuY29sTW9kZWxbaV0ubmFtZStcIicgcm9sZT0nY29sdW1uaGVhZGVyJyBjbGFzcz0ndWktc3RhdGUtZGVmYXVsdCB1aS10aC1jb2x1bW4gdWktdGgtXCIrZGlyK1wiJ1wiKyB0b29sdGlwK1wiPlwiO1xyXG5cdFx0XHRpZG4gPSB0cy5wLmNvbE1vZGVsW2ldLmluZGV4IHx8IHRzLnAuY29sTW9kZWxbaV0ubmFtZTtcclxuXHRcdFx0dGhlYWQgKz0gXCI8ZGl2IGlkPSdqcWdoX1wiK3RzLnAuaWQrXCJfXCIrdHMucC5jb2xNb2RlbFtpXS5uYW1lK1wiJyBcIit0ZGMrXCI+XCIrdHMucC5jb2xOYW1lc1tpXTtcclxuXHRcdFx0aWYoIXRzLnAuY29sTW9kZWxbaV0ud2lkdGgpICB7IHRzLnAuY29sTW9kZWxbaV0ud2lkdGggPSAxNTA7IH1cclxuXHRcdFx0ZWxzZSB7IHRzLnAuY29sTW9kZWxbaV0ud2lkdGggPSBwYXJzZUludCh0cy5wLmNvbE1vZGVsW2ldLndpZHRoLDEwKTsgfVxyXG5cdFx0XHRpZih0eXBlb2YgdHMucC5jb2xNb2RlbFtpXS50aXRsZSAhPT0gXCJib29sZWFuXCIpIHsgdHMucC5jb2xNb2RlbFtpXS50aXRsZSA9IHRydWU7IH1cclxuXHRcdFx0dHMucC5jb2xNb2RlbFtpXS5sc28gPSBcIlwiO1xyXG5cdFx0XHRpZiAoaWRuID09PSB0cy5wLnNvcnRuYW1lKSB7XHJcblx0XHRcdFx0dHMucC5sYXN0c29ydCA9IGk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYodHMucC5tdWx0aVNvcnQpIHtcclxuXHRcdFx0XHRzb3RtcCA9ICQuaW5BcnJheShpZG4sc29ydGFycik7XHJcblx0XHRcdFx0aWYoIHNvdG1wICE9PSAtMSApIHtcclxuXHRcdFx0XHRcdHRzLnAuY29sTW9kZWxbaV0ubHNvID0gc29ydG9yZFtzb3RtcF07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHRoZWFkICs9IGltZ3MrXCI8L2Rpdj48L3RoPlwiO1xyXG5cdFx0fVxyXG5cdFx0dGhlYWQgKz0gXCI8L3RyPjwvdGhlYWQ+XCI7XHJcblx0XHRpbWdzID0gbnVsbDtcclxuXHRcdCQodGhpcykuYXBwZW5kKHRoZWFkKTtcclxuXHRcdCQoXCJ0aGVhZCB0cjpmaXJzdCB0aFwiLHRoaXMpLmhvdmVyKGZ1bmN0aW9uKCl7JCh0aGlzKS5hZGRDbGFzcygndWktc3RhdGUtaG92ZXInKTt9LGZ1bmN0aW9uKCl7JCh0aGlzKS5yZW1vdmVDbGFzcygndWktc3RhdGUtaG92ZXInKTt9KTtcclxuXHRcdGlmKHRoaXMucC5tdWx0aXNlbGVjdCkge1xyXG5cdFx0XHR2YXIgZW1wPVtdLCBjaGs7XHJcblx0XHRcdCQoJyNjYl8nKyQuamdyaWQuanFJRCh0cy5wLmlkKSx0aGlzKS5iaW5kKCdjbGljaycsZnVuY3Rpb24oKXtcclxuXHRcdFx0XHR0cy5wLnNlbGFycnJvdyA9IFtdO1xyXG5cdFx0XHRcdHZhciBmcm96ID0gdHMucC5mcm96ZW5Db2x1bW5zID09PSB0cnVlID8gdHMucC5pZCArIFwiX2Zyb3plblwiIDogXCJcIjtcclxuXHRcdFx0XHRpZiAodGhpcy5jaGVja2VkKSB7XHJcblx0XHRcdFx0XHQkKHRzLnJvd3MpLmVhY2goZnVuY3Rpb24oaSkge1xyXG5cdFx0XHRcdFx0XHRpZiAoaT4wKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYoISQodGhpcykuaGFzQ2xhc3MoXCJ1aS1zdWJncmlkXCIpICYmICEkKHRoaXMpLmhhc0NsYXNzKFwianFncm91cFwiKSAmJiAhJCh0aGlzKS5oYXNDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKSl7XHJcblx0XHRcdFx0XHRcdFx0XHQkKFwiI2pxZ19cIiskLmpncmlkLmpxSUQodHMucC5pZCkrXCJfXCIrJC5qZ3JpZC5qcUlEKHRoaXMuaWQpIClbdHMucC51c2VQcm9wID8gJ3Byb3AnOiAnYXR0ciddKFwiY2hlY2tlZFwiLHRydWUpO1xyXG5cdFx0XHRcdFx0XHRcdFx0JCh0aGlzKS5hZGRDbGFzcyhcInVpLXN0YXRlLWhpZ2hsaWdodFwiKS5hdHRyKFwiYXJpYS1zZWxlY3RlZFwiLFwidHJ1ZVwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdHRzLnAuc2VsYXJycm93LnB1c2godGhpcy5pZCk7XHJcblx0XHRcdFx0XHRcdFx0XHR0cy5wLnNlbHJvdyA9IHRoaXMuaWQ7XHJcblx0XHRcdFx0XHRcdFx0XHRpZihmcm96KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQoXCIjanFnX1wiKyQuamdyaWQuanFJRCh0cy5wLmlkKStcIl9cIiskLmpncmlkLmpxSUQodGhpcy5pZCksIHRzLmdyaWQuZmJEaXYgKVt0cy5wLnVzZVByb3AgPyAncHJvcCc6ICdhdHRyJ10oXCJjaGVja2VkXCIsdHJ1ZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQoXCIjXCIrJC5qZ3JpZC5qcUlEKHRoaXMuaWQpLCB0cy5ncmlkLmZiRGl2KS5hZGRDbGFzcyhcInVpLXN0YXRlLWhpZ2hsaWdodFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Y2hrPXRydWU7XHJcblx0XHRcdFx0XHRlbXA9W107XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0JCh0cy5yb3dzKS5lYWNoKGZ1bmN0aW9uKGkpIHtcclxuXHRcdFx0XHRcdFx0aWYoaT4wKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYoISQodGhpcykuaGFzQ2xhc3MoXCJ1aS1zdWJncmlkXCIpICYmICEkKHRoaXMpLmhhc0NsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpKXtcclxuXHRcdFx0XHRcdFx0XHRcdCQoXCIjanFnX1wiKyQuamdyaWQuanFJRCh0cy5wLmlkKStcIl9cIiskLmpncmlkLmpxSUQodGhpcy5pZCkgKVt0cy5wLnVzZVByb3AgPyAncHJvcCc6ICdhdHRyJ10oXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuXHRcdFx0XHRcdFx0XHRcdCQodGhpcykucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1oaWdobGlnaHRcIikuYXR0cihcImFyaWEtc2VsZWN0ZWRcIixcImZhbHNlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZW1wLnB1c2godGhpcy5pZCk7XHJcblx0XHRcdFx0XHRcdFx0XHRpZihmcm96KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQoXCIjanFnX1wiKyQuamdyaWQuanFJRCh0cy5wLmlkKStcIl9cIiskLmpncmlkLmpxSUQodGhpcy5pZCksIHRzLmdyaWQuZmJEaXYgKVt0cy5wLnVzZVByb3AgPyAncHJvcCc6ICdhdHRyJ10oXCJjaGVja2VkXCIsZmFsc2UpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkKFwiI1wiKyQuamdyaWQuanFJRCh0aGlzLmlkKSwgdHMuZ3JpZC5mYkRpdikucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1oaWdobGlnaHRcIik7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdHRzLnAuc2Vscm93ID0gbnVsbDtcclxuXHRcdFx0XHRcdGNoaz1mYWxzZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JCh0cykudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRTZWxlY3RBbGxcIiwgW2NoayA/IHRzLnAuc2VsYXJycm93IDogZW1wLCBjaGtdKTtcclxuXHRcdFx0XHRpZigkLmlzRnVuY3Rpb24odHMucC5vblNlbGVjdEFsbCkpIHt0cy5wLm9uU2VsZWN0QWxsLmNhbGwodHMsIGNoayA/IHRzLnAuc2VsYXJycm93IDogZW1wLGNoayk7fVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHJcblx0XHRpZih0cy5wLmF1dG93aWR0aD09PXRydWUpIHtcclxuXHRcdFx0dmFyIHB3ID0gJChlZykuaW5uZXJXaWR0aCgpO1xyXG5cdFx0XHR0cy5wLndpZHRoID0gcHcgPiAwPyAgcHc6ICdudyc7XHJcblx0XHR9XHJcblx0XHRzZXRDb2xXaWR0aCgpO1xyXG5cdFx0JChlZykuY3NzKFwid2lkdGhcIixncmlkLndpZHRoK1wicHhcIikuYXBwZW5kKFwiPGRpdiBjbGFzcz0ndWktanFncmlkLXJlc2l6ZS1tYXJrJyBpZD0ncnNfbVwiK3RzLnAuaWQrXCInPiYjMTYwOzwvZGl2PlwiKTtcclxuXHRcdCQoZ3YpLmNzcyhcIndpZHRoXCIsZ3JpZC53aWR0aCtcInB4XCIpO1xyXG5cdFx0dGhlYWQgPSAkKFwidGhlYWQ6Zmlyc3RcIix0cykuZ2V0KDApO1xyXG5cdFx0dmFyXHR0Zm9vdCA9IFwiXCI7XHJcblx0XHRpZih0cy5wLmZvb3RlcnJvdykgeyB0Zm9vdCArPSBcIjx0YWJsZSByb2xlPSdncmlkJyBzdHlsZT0nd2lkdGg6XCIrdHMucC50Ymx3aWR0aCtcInB4JyBjbGFzcz0ndWktanFncmlkLWZ0YWJsZScgY2VsbHNwYWNpbmc9JzAnIGNlbGxwYWRkaW5nPScwJyBib3JkZXI9JzAnPjx0Ym9keT48dHIgcm9sZT0ncm93JyBjbGFzcz0ndWktd2lkZ2V0LWNvbnRlbnQgZm9vdHJvdyBmb290cm93LVwiK2RpcitcIic+XCI7IH1cclxuXHRcdHZhciB0aHIgPSAkKFwidHI6Zmlyc3RcIix0aGVhZCksXHJcblx0XHRmaXJzdHIgPSBcIjx0ciBjbGFzcz0nanFnZmlyc3Ryb3cnIHJvbGU9J3Jvdycgc3R5bGU9J2hlaWdodDphdXRvJz5cIjtcclxuXHRcdHRzLnAuZGlzYWJsZUNsaWNrPWZhbHNlO1xyXG5cdFx0JChcInRoXCIsdGhyKS5lYWNoKGZ1bmN0aW9uICggaiApIHtcclxuXHRcdFx0dyA9IHRzLnAuY29sTW9kZWxbal0ud2lkdGg7XHJcblx0XHRcdGlmKHRzLnAuY29sTW9kZWxbal0ucmVzaXphYmxlID09PSB1bmRlZmluZWQpIHt0cy5wLmNvbE1vZGVsW2pdLnJlc2l6YWJsZSA9IHRydWU7fVxyXG5cdFx0XHRpZih0cy5wLmNvbE1vZGVsW2pdLnJlc2l6YWJsZSl7XHJcblx0XHRcdFx0cmVzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XHJcblx0XHRcdFx0JChyZXMpLmh0bWwoXCImIzE2MDtcIikuYWRkQ2xhc3MoJ3VpLWpxZ3JpZC1yZXNpemUgdWktanFncmlkLXJlc2l6ZS0nK2RpcilcclxuXHRcdFx0XHQuY3NzKFwiY3Vyc29yXCIsXCJjb2wtcmVzaXplXCIpO1xyXG5cdFx0XHRcdCQodGhpcykuYWRkQ2xhc3ModHMucC5yZXNpemVjbGFzcyk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cmVzID0gXCJcIjtcclxuXHRcdFx0fVxyXG5cdFx0XHQkKHRoaXMpLmNzcyhcIndpZHRoXCIsdytcInB4XCIpLnByZXBlbmQocmVzKTtcclxuXHRcdFx0cmVzID0gbnVsbDtcclxuXHRcdFx0dmFyIGhkY29sID0gXCJcIjtcclxuXHRcdFx0aWYoIHRzLnAuY29sTW9kZWxbal0uaGlkZGVuICkge1xyXG5cdFx0XHRcdCQodGhpcykuY3NzKFwiZGlzcGxheVwiLFwibm9uZVwiKTtcclxuXHRcdFx0XHRoZGNvbCA9IFwiZGlzcGxheTpub25lO1wiO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZpcnN0ciArPSBcIjx0ZCByb2xlPSdncmlkY2VsbCcgc3R5bGU9J2hlaWdodDowcHg7d2lkdGg6XCIrdytcInB4O1wiK2hkY29sK1wiJz48L3RkPlwiO1xyXG5cdFx0XHRncmlkLmhlYWRlcnNbal0gPSB7IHdpZHRoOiB3LCBlbDogdGhpcyB9O1xyXG5cdFx0XHRzb3J0ID0gdHMucC5jb2xNb2RlbFtqXS5zb3J0YWJsZTtcclxuXHRcdFx0aWYoIHR5cGVvZiBzb3J0ICE9PSAnYm9vbGVhbicpIHt0cy5wLmNvbE1vZGVsW2pdLnNvcnRhYmxlID0gIHRydWU7IHNvcnQ9dHJ1ZTt9XHJcblx0XHRcdHZhciBubSA9IHRzLnAuY29sTW9kZWxbal0ubmFtZTtcclxuXHRcdFx0aWYoICEobm0gPT09ICdjYicgfHwgbm09PT0nc3ViZ3JpZCcgfHwgbm09PT0ncm4nKSApIHtcclxuXHRcdFx0XHRpZih0cy5wLnZpZXdzb3J0Y29sc1syXSl7XHJcblx0XHRcdFx0XHQkKFwiPmRpdlwiLHRoaXMpLmFkZENsYXNzKCd1aS1qcWdyaWQtc29ydGFibGUnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoc29ydCkge1xyXG5cdFx0XHRcdGlmKHRzLnAubXVsdGlTb3J0KSB7XHJcblx0XHRcdFx0XHRpZih0cy5wLnZpZXdzb3J0Y29sc1swXSkge1xyXG5cdFx0XHRcdFx0XHQkKFwiZGl2IHNwYW4ucy1pY29cIix0aGlzKS5zaG93KCk7XHJcblx0XHRcdFx0XHRcdGlmKHRzLnAuY29sTW9kZWxbal0ubHNvKXtcclxuXHRcdFx0XHRcdFx0XHQkKFwiZGl2IHNwYW4udWktaWNvbi1cIit0cy5wLmNvbE1vZGVsW2pdLmxzbyx0aGlzKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWRpc2FibGVkXCIpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYoIHRzLnAuY29sTW9kZWxbal0ubHNvKSB7XHJcblx0XHRcdFx0XHRcdCQoXCJkaXYgc3Bhbi5zLWljb1wiLHRoaXMpLnNob3coKTtcclxuXHRcdFx0XHRcdFx0JChcImRpdiBzcGFuLnVpLWljb24tXCIrdHMucC5jb2xNb2RlbFtqXS5sc28sdGhpcykucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1kaXNhYmxlZFwiKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0aWYodHMucC52aWV3c29ydGNvbHNbMF0pIHskKFwiZGl2IHNwYW4ucy1pY29cIix0aGlzKS5zaG93KCk7IGlmKGo9PT10cy5wLmxhc3Rzb3J0KXsgJChcImRpdiBzcGFuLnVpLWljb24tXCIrdHMucC5zb3J0b3JkZXIsdGhpcykucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1kaXNhYmxlZFwiKTt9fVxyXG5cdFx0XHRcdFx0ZWxzZSBpZiggaiA9PT0gdHMucC5sYXN0c29ydCkgeyQoXCJkaXYgc3Bhbi5zLWljb1wiLHRoaXMpLnNob3coKTskKFwiZGl2IHNwYW4udWktaWNvbi1cIit0cy5wLnNvcnRvcmRlcix0aGlzKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWRpc2FibGVkXCIpO31cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYodHMucC5mb290ZXJyb3cpIHsgdGZvb3QgKz0gXCI8dGQgcm9sZT0nZ3JpZGNlbGwnIFwiK2Zvcm1hdENvbChqLDAsJycsIG51bGwsICcnLCBmYWxzZSkrXCI+JiMxNjA7PC90ZD5cIjsgfVxyXG5cdFx0fSkubW91c2Vkb3duKGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0aWYgKCQoZS50YXJnZXQpLmNsb3Nlc3QoXCJ0aD5zcGFuLnVpLWpxZ3JpZC1yZXNpemVcIikubGVuZ3RoICE9PSAxKSB7IHJldHVybjsgfVxyXG5cdFx0XHR2YXIgY2kgPSBnZXRDb2x1bW5IZWFkZXJJbmRleCh0aGlzKTtcclxuXHRcdFx0aWYodHMucC5mb3JjZUZpdD09PXRydWUpIHt0cy5wLm52PSBuZXh0VmlzaWJsZShjaSk7fVxyXG5cdFx0XHRncmlkLmRyYWdTdGFydChjaSwgZSwgZ2V0T2Zmc2V0KGNpKSk7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH0pLmNsaWNrKGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0aWYgKHRzLnAuZGlzYWJsZUNsaWNrKSB7XHJcblx0XHRcdFx0dHMucC5kaXNhYmxlQ2xpY2sgPSBmYWxzZTtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIHMgPSBcInRoPmRpdi51aS1qcWdyaWQtc29ydGFibGVcIixyLGQ7XHJcblx0XHRcdGlmICghdHMucC52aWV3c29ydGNvbHNbMl0pIHsgcyA9IFwidGg+ZGl2PnNwYW4+c3Bhbi51aS1ncmlkLWljby1zb3J0XCI7IH1cclxuXHRcdFx0dmFyIHQgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KHMpO1xyXG5cdFx0XHRpZiAodC5sZW5ndGggIT09IDEpIHsgcmV0dXJuOyB9XHJcblx0XHRcdHZhciBjaTtcclxuXHRcdFx0aWYodHMucC5mcm96ZW5Db2x1bW5zKSB7XHJcblx0XHRcdFx0dmFyIHRpZCA9ICAkKHRoaXMpWzBdLmlkLnN1YnN0cmluZyggdHMucC5pZC5sZW5ndGggKyAxICk7XHJcblx0XHRcdFx0JCh0cy5wLmNvbE1vZGVsKS5lYWNoKGZ1bmN0aW9uKGkpe1xyXG5cdFx0XHRcdFx0aWYgKHRoaXMubmFtZSA9PT0gdGlkKSB7XHJcblx0XHRcdFx0XHRcdGNpID0gaTtyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Y2kgPSBnZXRDb2x1bW5IZWFkZXJJbmRleCh0aGlzKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoIXRzLnAudmlld3NvcnRjb2xzWzJdKSB7IHI9dHJ1ZTtkPXQuYXR0cihcInNvcnRcIik7IH1cclxuXHRcdFx0aWYoY2kgIT0gbnVsbCl7XHJcblx0XHRcdFx0c29ydERhdGEoICQoJ2RpdicsdGhpcylbMF0uaWQsIGNpLCByLCBkLCB0aGlzKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9KTtcclxuXHRcdGlmICh0cy5wLnNvcnRhYmxlICYmICQuZm4uc29ydGFibGUpIHtcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHQkKHRzKS5qcUdyaWQoXCJzb3J0YWJsZUNvbHVtbnNcIiwgdGhyKTtcclxuXHRcdFx0fSBjYXRjaCAoZSl7fVxyXG5cdFx0fVxyXG5cdFx0aWYodHMucC5mb290ZXJyb3cpIHsgdGZvb3QgKz0gXCI8L3RyPjwvdGJvZHk+PC90YWJsZT5cIjsgfVxyXG5cdFx0Zmlyc3RyICs9IFwiPC90cj5cIjtcclxuXHRcdHRib2R5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRib2R5XCIpO1xyXG5cdFx0dGhpcy5hcHBlbmRDaGlsZCh0Ym9keSk7XHJcblx0XHQkKHRoaXMpLmFkZENsYXNzKCd1aS1qcWdyaWQtYnRhYmxlJykuYXBwZW5kKGZpcnN0cik7XHJcblx0XHRmaXJzdHIgPSBudWxsO1xyXG5cdFx0dmFyIGhUYWJsZSA9ICQoXCI8dGFibGUgY2xhc3M9J3VpLWpxZ3JpZC1odGFibGUnIHN0eWxlPSd3aWR0aDpcIit0cy5wLnRibHdpZHRoK1wicHgnIHJvbGU9J2dyaWQnIGFyaWEtbGFiZWxsZWRieT0nZ2JveF9cIit0aGlzLmlkK1wiJyBjZWxsc3BhY2luZz0nMCcgY2VsbHBhZGRpbmc9JzAnIGJvcmRlcj0nMCc+PC90YWJsZT5cIikuYXBwZW5kKHRoZWFkKSxcclxuXHRcdGhnID0gKHRzLnAuY2FwdGlvbiAmJiB0cy5wLmhpZGRlbmdyaWQ9PT10cnVlKSA/IHRydWUgOiBmYWxzZSxcclxuXHRcdGhiID0gJChcIjxkaXYgY2xhc3M9J3VpLWpxZ3JpZC1oYm94XCIgKyAoZGlyPT09XCJydGxcIiA/IFwiLXJ0bFwiIDogXCJcIiApK1wiJz48L2Rpdj5cIik7XHJcblx0XHR0aGVhZCA9IG51bGw7XHJcblx0XHRncmlkLmhEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG5cdFx0JChncmlkLmhEaXYpXHJcblx0XHRcdC5jc3MoeyB3aWR0aDogZ3JpZC53aWR0aCtcInB4XCJ9KVxyXG5cdFx0XHQuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1kZWZhdWx0IHVpLWpxZ3JpZC1oZGl2XCIpXHJcblx0XHRcdC5hcHBlbmQoaGIpO1xyXG5cdFx0JChoYikuYXBwZW5kKGhUYWJsZSk7XHJcblx0XHRoVGFibGUgPSBudWxsO1xyXG5cdFx0aWYoaGcpIHsgJChncmlkLmhEaXYpLmhpZGUoKTsgfVxyXG5cdFx0aWYodHMucC5wYWdlcil7XHJcblx0XHRcdC8vIFRCRCAtLSBlc2NhcGUgdHMucC5wYWdlciBoZXJlP1xyXG5cdFx0XHRpZih0eXBlb2YgdHMucC5wYWdlciA9PT0gXCJzdHJpbmdcIikge2lmKHRzLnAucGFnZXIuc3Vic3RyKDAsMSkgIT09IFwiI1wiKSB7IHRzLnAucGFnZXIgPSBcIiNcIit0cy5wLnBhZ2VyO30gfVxyXG5cdFx0XHRlbHNlIHsgdHMucC5wYWdlciA9IFwiI1wiKyAkKHRzLnAucGFnZXIpLmF0dHIoXCJpZFwiKTt9XHJcblx0XHRcdCQodHMucC5wYWdlcikuY3NzKHt3aWR0aDogZ3JpZC53aWR0aCtcInB4XCJ9KS5hZGRDbGFzcygndWktc3RhdGUtZGVmYXVsdCB1aS1qcWdyaWQtcGFnZXIgdWktY29ybmVyLWJvdHRvbScpLmFwcGVuZFRvKGVnKTtcclxuXHRcdFx0aWYoaGcpIHskKHRzLnAucGFnZXIpLmhpZGUoKTt9XHJcblx0XHRcdHNldFBhZ2VyKHRzLnAucGFnZXIsJycpO1xyXG5cdFx0fVxyXG5cdFx0aWYoIHRzLnAuY2VsbEVkaXQgPT09IGZhbHNlICYmIHRzLnAuaG92ZXJyb3dzID09PSB0cnVlKSB7XHJcblx0XHQkKHRzKS5iaW5kKCdtb3VzZW92ZXInLGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0cHRyID0gJChlLnRhcmdldCkuY2xvc2VzdChcInRyLmpxZ3Jvd1wiKTtcclxuXHRcdFx0aWYoJChwdHIpLmF0dHIoXCJjbGFzc1wiKSAhPT0gXCJ1aS1zdWJncmlkXCIpIHtcclxuXHRcdFx0XHQkKHB0cikuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1ob3ZlclwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSkuYmluZCgnbW91c2VvdXQnLGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0cHRyID0gJChlLnRhcmdldCkuY2xvc2VzdChcInRyLmpxZ3Jvd1wiKTtcclxuXHRcdFx0JChwdHIpLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtaG92ZXJcIik7XHJcblx0XHR9KTtcclxuXHRcdH1cclxuXHRcdHZhciByaSxjaSwgdGRIdG1sO1xyXG5cdFx0JCh0cykuYmVmb3JlKGdyaWQuaERpdikuY2xpY2soZnVuY3Rpb24oZSkge1xyXG5cdFx0XHR0ZCA9IGUudGFyZ2V0O1xyXG5cdFx0XHRwdHIgPSAkKHRkLHRzLnJvd3MpLmNsb3Nlc3QoXCJ0ci5qcWdyb3dcIik7XHJcblx0XHRcdGlmKCQocHRyKS5sZW5ndGggPT09IDAgfHwgcHRyWzBdLmNsYXNzTmFtZS5pbmRleE9mKCAndWktc3RhdGUtZGlzYWJsZWQnICkgPiAtMSB8fCAoJCh0ZCx0cykuY2xvc2VzdChcInRhYmxlLnVpLWpxZ3JpZC1idGFibGVcIikuYXR0cignaWQnKSB8fCAnJykucmVwbGFjZShcIl9mcm96ZW5cIixcIlwiKSAhPT0gdHMuaWQgKSB7XHJcblx0XHRcdFx0cmV0dXJuIHRoaXM7XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIHNjYiA9ICQodGQpLmhhc0NsYXNzKFwiY2JveFwiKSxcclxuXHRcdFx0Y1NlbCA9ICQodHMpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQmVmb3JlU2VsZWN0Um93XCIsIFtwdHJbMF0uaWQsIGVdKTtcclxuXHRcdFx0Y1NlbCA9IChjU2VsID09PSBmYWxzZSB8fCBjU2VsID09PSAnc3RvcCcpID8gZmFsc2UgOiB0cnVlO1xyXG5cdFx0XHRpZihjU2VsICYmICQuaXNGdW5jdGlvbih0cy5wLmJlZm9yZVNlbGVjdFJvdykpIHsgY1NlbCA9IHRzLnAuYmVmb3JlU2VsZWN0Um93LmNhbGwodHMscHRyWzBdLmlkLCBlKTsgfVxyXG5cdFx0XHRpZiAodGQudGFnTmFtZSA9PT0gJ0EnIHx8ICgodGQudGFnTmFtZSA9PT0gJ0lOUFVUJyB8fCB0ZC50YWdOYW1lID09PSAnVEVYVEFSRUEnIHx8IHRkLnRhZ05hbWUgPT09ICdPUFRJT04nIHx8IHRkLnRhZ05hbWUgPT09ICdTRUxFQ1QnICkgJiYgIXNjYikgKSB7IHJldHVybjsgfVxyXG5cdFx0XHRpZihjU2VsID09PSB0cnVlKSB7XHJcblx0XHRcdFx0cmkgPSBwdHJbMF0uaWQ7XHJcblx0XHRcdFx0Y2kgPSAkLmpncmlkLmdldENlbGxJbmRleCh0ZCk7XHJcblx0XHRcdFx0dGRIdG1sID0gJCh0ZCkuY2xvc2VzdChcInRkLHRoXCIpLmh0bWwoKTtcclxuXHRcdFx0XHQkKHRzKS50cmlnZ2VySGFuZGxlcihcImpxR3JpZENlbGxTZWxlY3RcIiwgW3JpLGNpLHRkSHRtbCxlXSk7XHJcblx0XHRcdFx0aWYoJC5pc0Z1bmN0aW9uKHRzLnAub25DZWxsU2VsZWN0KSkge1xyXG5cdFx0XHRcdFx0dHMucC5vbkNlbGxTZWxlY3QuY2FsbCh0cyxyaSxjaSx0ZEh0bWwsZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKHRzLnAuY2VsbEVkaXQgPT09IHRydWUpIHtcclxuXHRcdFx0XHRcdGlmKHRzLnAubXVsdGlzZWxlY3QgJiYgc2NiKXtcclxuXHRcdFx0XHRcdFx0JCh0cykuanFHcmlkKFwic2V0U2VsZWN0aW9uXCIsIHJpICx0cnVlLGUpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0cmkgPSBwdHJbMF0ucm93SW5kZXg7XHJcblx0XHRcdFx0XHRcdHRyeSB7JCh0cykuanFHcmlkKFwiZWRpdENlbGxcIixyaSxjaSx0cnVlKTt9IGNhdGNoIChfKSB7fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSBpZiAoICF0cy5wLm11bHRpa2V5ICkge1xyXG5cdFx0XHRcdFx0aWYodHMucC5tdWx0aXNlbGVjdCAmJiB0cy5wLm11bHRpYm94b25seSkge1xyXG5cdFx0XHRcdFx0XHRpZihzY2IpeyQodHMpLmpxR3JpZChcInNldFNlbGVjdGlvblwiLHJpLHRydWUsZSk7fVxyXG5cdFx0XHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHR2YXIgZnJ6ID0gdHMucC5mcm96ZW5Db2x1bW5zID8gdHMucC5pZCtcIl9mcm96ZW5cIiA6IFwiXCI7XHJcblx0XHRcdFx0XHRcdFx0JCh0cy5wLnNlbGFycnJvdykuZWFjaChmdW5jdGlvbihpLG4pe1xyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIHRyaWQgPSAkKHRzKS5qcUdyaWQoJ2dldEdyaWRSb3dCeUlkJyxuKTtcclxuXHRcdFx0XHRcdFx0XHRcdCQoIHRyaWQgKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWhpZ2hsaWdodFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdCQoXCIjanFnX1wiKyQuamdyaWQuanFJRCh0cy5wLmlkKStcIl9cIiskLmpncmlkLmpxSUQobikpW3RzLnAudXNlUHJvcCA/ICdwcm9wJzogJ2F0dHInXShcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoZnJ6KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQoXCIjXCIrJC5qZ3JpZC5qcUlEKG4pLCBcIiNcIiskLmpncmlkLmpxSUQoZnJ6KSkucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1oaWdobGlnaHRcIik7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQoXCIjanFnX1wiKyQuamdyaWQuanFJRCh0cy5wLmlkKStcIl9cIiskLmpncmlkLmpxSUQobiksIFwiI1wiKyQuamdyaWQuanFJRChmcnopKVt0cy5wLnVzZVByb3AgPyAncHJvcCc6ICdhdHRyJ10oXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHR0cy5wLnNlbGFycnJvdyA9IFtdO1xyXG5cdFx0XHRcdFx0XHRcdCQodHMpLmpxR3JpZChcInNldFNlbGVjdGlvblwiLHJpLHRydWUsZSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdCQodHMpLmpxR3JpZChcInNldFNlbGVjdGlvblwiLHJpLHRydWUsZSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGlmKGVbdHMucC5tdWx0aWtleV0pIHtcclxuXHRcdFx0XHRcdFx0JCh0cykuanFHcmlkKFwic2V0U2VsZWN0aW9uXCIscmksdHJ1ZSxlKTtcclxuXHRcdFx0XHRcdH0gZWxzZSBpZih0cy5wLm11bHRpc2VsZWN0ICYmIHNjYikge1xyXG5cdFx0XHRcdFx0XHRzY2IgPSAkKFwiI2pxZ19cIiskLmpncmlkLmpxSUQodHMucC5pZCkrXCJfXCIrcmkpLmlzKFwiOmNoZWNrZWRcIik7XHJcblx0XHRcdFx0XHRcdCQoXCIjanFnX1wiKyQuamdyaWQuanFJRCh0cy5wLmlkKStcIl9cIityaSlbdHMucC51c2VQcm9wID8gJ3Byb3AnIDogJ2F0dHInXShcImNoZWNrZWRcIiwgc2NiKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pLmJpbmQoJ3JlbG9hZEdyaWQnLCBmdW5jdGlvbihlLG9wdHMpIHtcclxuXHRcdFx0aWYodHMucC50cmVlR3JpZCA9PT10cnVlKSB7XHR0cy5wLmRhdGF0eXBlID0gdHMucC50cmVlZGF0YXR5cGU7fVxyXG5cdFx0XHRpZiAob3B0cyAmJiBvcHRzLmN1cnJlbnQpIHtcclxuXHRcdFx0XHR0cy5ncmlkLnNlbGVjdGlvblByZXNlcnZlcih0cyk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYodHMucC5kYXRhdHlwZT09PVwibG9jYWxcIil7ICQodHMpLmpxR3JpZChcInJlc2V0U2VsZWN0aW9uXCIpOyAgaWYodHMucC5kYXRhLmxlbmd0aCkgeyByZWZyZXNoSW5kZXgoKTt9IH1cclxuXHRcdFx0ZWxzZSBpZighdHMucC50cmVlR3JpZCkge1xyXG5cdFx0XHRcdHRzLnAuc2Vscm93PW51bGw7XHJcblx0XHRcdFx0aWYodHMucC5tdWx0aXNlbGVjdCkge3RzLnAuc2VsYXJycm93ID1bXTtzZXRIZWFkQ2hlY2tCb3goZmFsc2UpO31cclxuXHRcdFx0XHR0cy5wLnNhdmVkUm93ID0gW107XHJcblx0XHRcdH1cclxuXHRcdFx0aWYodHMucC5zY3JvbGwpIHtlbXB0eVJvd3MuY2FsbCh0cywgdHJ1ZSwgZmFsc2UpO31cclxuXHRcdFx0aWYgKG9wdHMgJiYgb3B0cy5wYWdlKSB7XHJcblx0XHRcdFx0dmFyIHBhZ2UgPSBvcHRzLnBhZ2U7XHJcblx0XHRcdFx0aWYgKHBhZ2UgPiB0cy5wLmxhc3RwYWdlKSB7IHBhZ2UgPSB0cy5wLmxhc3RwYWdlOyB9XHJcblx0XHRcdFx0aWYgKHBhZ2UgPCAxKSB7IHBhZ2UgPSAxOyB9XHJcblx0XHRcdFx0dHMucC5wYWdlID0gcGFnZTtcclxuXHRcdFx0XHRpZiAodHMuZ3JpZC5wcmV2Um93SGVpZ2h0KSB7XHJcblx0XHRcdFx0XHR0cy5ncmlkLmJEaXYuc2Nyb2xsVG9wID0gKHBhZ2UgLSAxKSAqIHRzLmdyaWQucHJldlJvd0hlaWdodCAqIHRzLnAucm93TnVtO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR0cy5ncmlkLmJEaXYuc2Nyb2xsVG9wID0gMDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHRzLmdyaWQucHJldlJvd0hlaWdodCAmJiB0cy5wLnNjcm9sbCkge1xyXG5cdFx0XHRcdGRlbGV0ZSB0cy5wLmxhc3RwYWdlO1xyXG5cdFx0XHRcdHRzLmdyaWQucG9wdWxhdGVWaXNpYmxlKCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dHMuZ3JpZC5wb3B1bGF0ZSgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHRzLnAuX2lubGluZW5hdj09PXRydWUpIHskKHRzKS5qcUdyaWQoJ3Nob3dBZGRFZGl0QnV0dG9ucycpO31cclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fSlcclxuXHRcdC5kYmxjbGljayhmdW5jdGlvbihlKSB7XHJcblx0XHRcdHRkID0gZS50YXJnZXQ7XHJcblx0XHRcdHB0ciA9ICQodGQsdHMucm93cykuY2xvc2VzdChcInRyLmpxZ3Jvd1wiKTtcclxuXHRcdFx0aWYoJChwdHIpLmxlbmd0aCA9PT0gMCApe3JldHVybjt9XHJcblx0XHRcdHJpID0gcHRyWzBdLnJvd0luZGV4O1xyXG5cdFx0XHRjaSA9ICQuamdyaWQuZ2V0Q2VsbEluZGV4KHRkKTtcclxuXHRcdFx0JCh0cykudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWREYmxDbGlja1Jvd1wiLCBbJChwdHIpLmF0dHIoXCJpZFwiKSxyaSxjaSxlXSk7XHJcblx0XHRcdGlmICgkLmlzRnVuY3Rpb24odHMucC5vbmRibENsaWNrUm93KSkgeyB0cy5wLm9uZGJsQ2xpY2tSb3cuY2FsbCh0cywkKHB0cikuYXR0cihcImlkXCIpLHJpLGNpLCBlKTsgfVxyXG5cdFx0fSlcclxuXHRcdC5iaW5kKCdjb250ZXh0bWVudScsIGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0dGQgPSBlLnRhcmdldDtcclxuXHRcdFx0cHRyID0gJCh0ZCx0cy5yb3dzKS5jbG9zZXN0KFwidHIuanFncm93XCIpO1xyXG5cdFx0XHRpZigkKHB0cikubGVuZ3RoID09PSAwICl7cmV0dXJuO31cclxuXHRcdFx0aWYoIXRzLnAubXVsdGlzZWxlY3QpIHtcdCQodHMpLmpxR3JpZChcInNldFNlbGVjdGlvblwiLHB0clswXS5pZCx0cnVlLGUpO1x0fVxyXG5cdFx0XHRyaSA9IHB0clswXS5yb3dJbmRleDtcclxuXHRcdFx0Y2kgPSAkLmpncmlkLmdldENlbGxJbmRleCh0ZCk7XHJcblx0XHRcdCQodHMpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkUmlnaHRDbGlja1Jvd1wiLCBbJChwdHIpLmF0dHIoXCJpZFwiKSxyaSxjaSxlXSk7XHJcblx0XHRcdGlmICgkLmlzRnVuY3Rpb24odHMucC5vblJpZ2h0Q2xpY2tSb3cpKSB7IHRzLnAub25SaWdodENsaWNrUm93LmNhbGwodHMsJChwdHIpLmF0dHIoXCJpZFwiKSxyaSxjaSwgZSk7IH1cclxuXHRcdH0pO1xyXG5cdFx0Z3JpZC5iRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuXHRcdGlmKGlzTVNJRSkgeyBpZihTdHJpbmcodHMucC5oZWlnaHQpLnRvTG93ZXJDYXNlKCkgPT09IFwiYXV0b1wiKSB7IHRzLnAuaGVpZ2h0ID0gXCIxMDAlXCI7IH0gfVxyXG5cdFx0JChncmlkLmJEaXYpXHJcblx0XHRcdC5hcHBlbmQoJCgnPGRpdiBzdHlsZT1cInBvc2l0aW9uOnJlbGF0aXZlOycrKGlzTVNJRSAmJiAkLmpncmlkLm1zaWV2ZXIoKSA8IDggPyBcImhlaWdodDowLjAxJTtcIiA6IFwiXCIpKydcIj48L2Rpdj4nKS5hcHBlbmQoJzxkaXY+PC9kaXY+JykuYXBwZW5kKHRoaXMpKVxyXG5cdFx0XHQuYWRkQ2xhc3MoXCJ1aS1qcWdyaWQtYmRpdlwiKVxyXG5cdFx0XHQuY3NzKHsgaGVpZ2h0OiB0cy5wLmhlaWdodCsoaXNOYU4odHMucC5oZWlnaHQpP1wiXCI6XCJweFwiKSwgd2lkdGg6IChncmlkLndpZHRoKStcInB4XCJ9KVxyXG5cdFx0XHQuc2Nyb2xsKGdyaWQuc2Nyb2xsR3JpZCk7XHJcblx0XHQkKFwidGFibGU6Zmlyc3RcIixncmlkLmJEaXYpLmNzcyh7d2lkdGg6dHMucC50Ymx3aWR0aCtcInB4XCJ9KTtcclxuXHRcdGlmKCAhJC5zdXBwb3J0LnRib2R5ICkgeyAvL0lFXHJcblx0XHRcdGlmKCAkKFwidGJvZHlcIix0aGlzKS5sZW5ndGggPT09IDIgKSB7ICQoXCJ0Ym9keTpndCgwKVwiLHRoaXMpLnJlbW92ZSgpO31cclxuXHRcdH1cclxuXHRcdGlmKHRzLnAubXVsdGlrZXkpe1xyXG5cdFx0XHRpZiggJC5qZ3JpZC5tc2llKSB7XHJcblx0XHRcdFx0JChncmlkLmJEaXYpLmJpbmQoXCJzZWxlY3RzdGFydFwiLGZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO30pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQoZ3JpZC5iRGl2KS5iaW5kKFwibW91c2Vkb3duXCIsZnVuY3Rpb24oKXtyZXR1cm4gZmFsc2U7fSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmKGhnKSB7JChncmlkLmJEaXYpLmhpZGUoKTt9XHJcblx0XHRncmlkLmNEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG5cdFx0dmFyIGFyZiA9IHRzLnAuaGlkZWdyaWQ9PT10cnVlID8gJChcIjxhIHJvbGU9J2xpbmsnIGNsYXNzPSd1aS1qcWdyaWQtdGl0bGViYXItY2xvc2UgdWktY29ybmVyLWFsbCBIZWFkZXJCdXR0b24nIC8+XCIpLmhvdmVyKFxyXG5cdFx0XHRmdW5jdGlvbigpeyBhcmYuYWRkQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7fSxcclxuXHRcdFx0ZnVuY3Rpb24oKSB7YXJmLnJlbW92ZUNsYXNzKCd1aS1zdGF0ZS1ob3ZlcicpO30pXHJcblx0XHQuYXBwZW5kKFwiPHNwYW4gY2xhc3M9J3VpLWljb24gdWktaWNvbi1jaXJjbGUtdHJpYW5nbGUtbic+PC9zcGFuPlwiKS5jc3MoKGRpcj09PVwicnRsXCI/XCJsZWZ0XCI6XCJyaWdodFwiKSxcIjBweFwiKSA6IFwiXCI7XHJcblx0XHQkKGdyaWQuY0RpdikuYXBwZW5kKGFyZikuYXBwZW5kKFwiPHNwYW4gY2xhc3M9J3VpLWpxZ3JpZC10aXRsZSc+XCIrdHMucC5jYXB0aW9uK1wiPC9zcGFuPlwiKVxyXG5cdFx0LmFkZENsYXNzKFwidWktanFncmlkLXRpdGxlYmFyIHVpLWpxZ3JpZC1jYXB0aW9uXCIrKGRpcj09PVwicnRsXCIgPyBcIi1ydGxcIiA6XCJcIiApK1wiIHVpLXdpZGdldC1oZWFkZXIgdWktY29ybmVyLXRvcCB1aS1oZWxwZXItY2xlYXJmaXhcIik7XHJcblx0XHQkKGdyaWQuY0RpdikuaW5zZXJ0QmVmb3JlKGdyaWQuaERpdik7XHJcblx0XHRpZiggdHMucC50b29sYmFyWzBdICkge1xyXG5cdFx0XHRncmlkLnVEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG5cdFx0XHRpZih0cy5wLnRvb2xiYXJbMV0gPT09IFwidG9wXCIpIHskKGdyaWQudURpdikuaW5zZXJ0QmVmb3JlKGdyaWQuaERpdik7fVxyXG5cdFx0XHRlbHNlIGlmICh0cy5wLnRvb2xiYXJbMV09PT1cImJvdHRvbVwiICkgeyQoZ3JpZC51RGl2KS5pbnNlcnRBZnRlcihncmlkLmhEaXYpO31cclxuXHRcdFx0aWYodHMucC50b29sYmFyWzFdPT09XCJib3RoXCIpIHtcclxuXHRcdFx0XHRncmlkLnViRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuXHRcdFx0XHQkKGdyaWQudURpdikuYWRkQ2xhc3MoXCJ1aS11c2VyZGF0YSB1aS1zdGF0ZS1kZWZhdWx0XCIpLmF0dHIoXCJpZFwiLFwidF9cIit0aGlzLmlkKS5pbnNlcnRCZWZvcmUoZ3JpZC5oRGl2KTtcclxuXHRcdFx0XHQkKGdyaWQudWJEaXYpLmFkZENsYXNzKFwidWktdXNlcmRhdGEgdWktc3RhdGUtZGVmYXVsdFwiKS5hdHRyKFwiaWRcIixcInRiX1wiK3RoaXMuaWQpLmluc2VydEFmdGVyKGdyaWQuaERpdik7XHJcblx0XHRcdFx0aWYoaGcpICB7JChncmlkLnViRGl2KS5oaWRlKCk7fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQoZ3JpZC51RGl2KS53aWR0aChncmlkLndpZHRoKS5hZGRDbGFzcyhcInVpLXVzZXJkYXRhIHVpLXN0YXRlLWRlZmF1bHRcIikuYXR0cihcImlkXCIsXCJ0X1wiK3RoaXMuaWQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKGhnKSB7JChncmlkLnVEaXYpLmhpZGUoKTt9XHJcblx0XHR9XHJcblx0XHRpZih0cy5wLnRvcHBhZ2VyKSB7XHJcblx0XHRcdHRzLnAudG9wcGFnZXIgPSAkLmpncmlkLmpxSUQodHMucC5pZCkrXCJfdG9wcGFnZXJcIjtcclxuXHRcdFx0Z3JpZC50b3BEaXYgPSAkKFwiPGRpdiBpZD0nXCIrdHMucC50b3BwYWdlcitcIic+PC9kaXY+XCIpWzBdO1xyXG5cdFx0XHR0cy5wLnRvcHBhZ2VyID0gXCIjXCIrdHMucC50b3BwYWdlcjtcclxuXHRcdFx0JChncmlkLnRvcERpdikuYWRkQ2xhc3MoJ3VpLXN0YXRlLWRlZmF1bHQgdWktanFncmlkLXRvcHBhZ2VyJykud2lkdGgoZ3JpZC53aWR0aCkuaW5zZXJ0QmVmb3JlKGdyaWQuaERpdik7XHJcblx0XHRcdHNldFBhZ2VyKHRzLnAudG9wcGFnZXIsJ190Jyk7XHJcblx0XHR9XHJcblx0XHRpZih0cy5wLmZvb3RlcnJvdykge1xyXG5cdFx0XHRncmlkLnNEaXYgPSAkKFwiPGRpdiBjbGFzcz0ndWktanFncmlkLXNkaXYnPjwvZGl2PlwiKVswXTtcclxuXHRcdFx0aGIgPSAkKFwiPGRpdiBjbGFzcz0ndWktanFncmlkLWhib3hcIisoZGlyPT09XCJydGxcIj9cIi1ydGxcIjpcIlwiKStcIic+PC9kaXY+XCIpO1xyXG5cdFx0XHQkKGdyaWQuc0RpdikuYXBwZW5kKGhiKS53aWR0aChncmlkLndpZHRoKS5pbnNlcnRBZnRlcihncmlkLmhEaXYpO1xyXG5cdFx0XHQkKGhiKS5hcHBlbmQodGZvb3QpO1xyXG5cdFx0XHRncmlkLmZvb3RlcnMgPSAkKFwiLnVpLWpxZ3JpZC1mdGFibGVcIixncmlkLnNEaXYpWzBdLnJvd3NbMF0uY2VsbHM7XHJcblx0XHRcdGlmKHRzLnAucm93bnVtYmVycykgeyBncmlkLmZvb3RlcnNbMF0uY2xhc3NOYW1lID0gJ3VpLXN0YXRlLWRlZmF1bHQganFncmlkLXJvd251bSc7IH1cclxuXHRcdFx0aWYoaGcpIHskKGdyaWQuc0RpdikuaGlkZSgpO31cclxuXHRcdH1cclxuXHRcdGhiID0gbnVsbDtcclxuXHRcdGlmKHRzLnAuY2FwdGlvbikge1xyXG5cdFx0XHR2YXIgdGR0ID0gdHMucC5kYXRhdHlwZTtcclxuXHRcdFx0aWYodHMucC5oaWRlZ3JpZD09PXRydWUpIHtcclxuXHRcdFx0XHQkKFwiLnVpLWpxZ3JpZC10aXRsZWJhci1jbG9zZVwiLGdyaWQuY0RpdikuY2xpY2soIGZ1bmN0aW9uKGUpe1xyXG5cdFx0XHRcdFx0dmFyIG9uSGRDbCA9ICQuaXNGdW5jdGlvbih0cy5wLm9uSGVhZGVyQ2xpY2spLFxyXG5cdFx0XHRcdFx0ZWxlbXMgPSBcIi51aS1qcWdyaWQtYmRpdiwgLnVpLWpxZ3JpZC1oZGl2LCAudWktanFncmlkLXBhZ2VyLCAudWktanFncmlkLXNkaXZcIixcclxuXHRcdFx0XHRcdGNvdW50ZXIsIHNlbGYgPSB0aGlzO1xyXG5cdFx0XHRcdFx0aWYodHMucC50b29sYmFyWzBdPT09dHJ1ZSkge1xyXG5cdFx0XHRcdFx0XHRpZiggdHMucC50b29sYmFyWzFdPT09J2JvdGgnKSB7XHJcblx0XHRcdFx0XHRcdFx0ZWxlbXMgKz0gJywgIycgKyAkKGdyaWQudWJEaXYpLmF0dHIoJ2lkJyk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0ZWxlbXMgKz0gJywgIycgKyAkKGdyaWQudURpdikuYXR0cignaWQnKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGNvdW50ZXIgPSAkKGVsZW1zLFwiI2d2aWV3X1wiKyQuamdyaWQuanFJRCh0cy5wLmlkKSkubGVuZ3RoO1xyXG5cclxuXHRcdFx0XHRcdGlmKHRzLnAuZ3JpZHN0YXRlID09PSAndmlzaWJsZScpIHtcclxuXHRcdFx0XHRcdFx0JChlbGVtcyxcIiNnYm94X1wiKyQuamdyaWQuanFJRCh0cy5wLmlkKSkuc2xpZGVVcChcImZhc3RcIiwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0Y291bnRlci0tO1xyXG5cdFx0XHRcdFx0XHRcdGlmIChjb3VudGVyID09PSAwKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKFwic3BhblwiLHNlbGYpLnJlbW92ZUNsYXNzKFwidWktaWNvbi1jaXJjbGUtdHJpYW5nbGUtblwiKS5hZGRDbGFzcyhcInVpLWljb24tY2lyY2xlLXRyaWFuZ2xlLXNcIik7XHJcblx0XHRcdFx0XHRcdFx0XHR0cy5wLmdyaWRzdGF0ZSA9ICdoaWRkZW4nO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoJChcIiNnYm94X1wiKyQuamdyaWQuanFJRCh0cy5wLmlkKSkuaGFzQ2xhc3MoXCJ1aS1yZXNpemFibGVcIikpIHsgJChcIi51aS1yZXNpemFibGUtaGFuZGxlXCIsXCIjZ2JveF9cIiskLmpncmlkLmpxSUQodHMucC5pZCkpLmhpZGUoKTsgfVxyXG5cdFx0XHRcdFx0XHRcdFx0JCh0cykudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRIZWFkZXJDbGlja1wiLCBbdHMucC5ncmlkc3RhdGUsZV0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYob25IZENsKSB7aWYoIWhnKSB7dHMucC5vbkhlYWRlckNsaWNrLmNhbGwodHMsdHMucC5ncmlkc3RhdGUsZSk7fX1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fSBlbHNlIGlmKHRzLnAuZ3JpZHN0YXRlID09PSAnaGlkZGVuJyl7XHJcblx0XHRcdFx0XHRcdCQoZWxlbXMsXCIjZ2JveF9cIiskLmpncmlkLmpxSUQodHMucC5pZCkpLnNsaWRlRG93bihcImZhc3RcIiwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0Y291bnRlci0tO1xyXG5cdFx0XHRcdFx0XHRcdGlmIChjb3VudGVyID09PSAwKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKFwic3BhblwiLHNlbGYpLnJlbW92ZUNsYXNzKFwidWktaWNvbi1jaXJjbGUtdHJpYW5nbGUtc1wiKS5hZGRDbGFzcyhcInVpLWljb24tY2lyY2xlLXRyaWFuZ2xlLW5cIik7XHJcblx0XHRcdFx0XHRcdFx0XHRpZihoZykge3RzLnAuZGF0YXR5cGUgPSB0ZHQ7cG9wdWxhdGUoKTtoZz1mYWxzZTt9XHJcblx0XHRcdFx0XHRcdFx0XHR0cy5wLmdyaWRzdGF0ZSA9ICd2aXNpYmxlJztcclxuXHRcdFx0XHRcdFx0XHRcdGlmKCQoXCIjZ2JveF9cIiskLmpncmlkLmpxSUQodHMucC5pZCkpLmhhc0NsYXNzKFwidWktcmVzaXphYmxlXCIpKSB7ICQoXCIudWktcmVzaXphYmxlLWhhbmRsZVwiLFwiI2dib3hfXCIrJC5qZ3JpZC5qcUlEKHRzLnAuaWQpKS5zaG93KCk7IH1cclxuXHRcdFx0XHRcdFx0XHRcdCQodHMpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkSGVhZGVyQ2xpY2tcIiwgW3RzLnAuZ3JpZHN0YXRlLGVdKTtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKG9uSGRDbCkge2lmKCFoZykge3RzLnAub25IZWFkZXJDbGljay5jYWxsKHRzLHRzLnAuZ3JpZHN0YXRlLGUpO319XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRpZihoZykge3RzLnAuZGF0YXR5cGU9XCJsb2NhbFwiOyAkKFwiLnVpLWpxZ3JpZC10aXRsZWJhci1jbG9zZVwiLGdyaWQuY0RpdikudHJpZ2dlcihcImNsaWNrXCIpO31cclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHskKGdyaWQuY0RpdikuaGlkZSgpO31cclxuXHRcdCQoZ3JpZC5oRGl2KS5hZnRlcihncmlkLmJEaXYpXHJcblx0XHQubW91c2Vtb3ZlKGZ1bmN0aW9uIChlKSB7XHJcblx0XHRcdGlmKGdyaWQucmVzaXppbmcpe2dyaWQuZHJhZ01vdmUoZSk7cmV0dXJuIGZhbHNlO31cclxuXHRcdH0pO1xyXG5cdFx0JChcIi51aS1qcWdyaWQtbGFiZWxzXCIsZ3JpZC5oRGl2KS5iaW5kKFwic2VsZWN0c3RhcnRcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gZmFsc2U7IH0pO1xyXG5cdFx0JChkb2N1bWVudCkuYmluZCggXCJtb3VzZXVwLmpxR3JpZFwiICsgdHMucC5pZCwgZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRpZihncmlkLnJlc2l6aW5nKSB7XHRncmlkLmRyYWdFbmQoKTsgcmV0dXJuIGZhbHNlO31cclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9KTtcclxuXHRcdHRzLmZvcm1hdENvbCA9IGZvcm1hdENvbDtcclxuXHRcdHRzLnNvcnREYXRhID0gc29ydERhdGE7XHJcblx0XHR0cy51cGRhdGVwYWdlciA9IHVwZGF0ZXBhZ2VyO1xyXG5cdFx0dHMucmVmcmVzaEluZGV4ID0gcmVmcmVzaEluZGV4O1xyXG5cdFx0dHMuc2V0SGVhZENoZWNrQm94ID0gc2V0SGVhZENoZWNrQm94O1xyXG5cdFx0dHMuY29uc3RydWN0VHIgPSBjb25zdHJ1Y3RUcjtcclxuXHRcdHRzLmZvcm1hdHRlciA9IGZ1bmN0aW9uICggcm93SWQsIGNlbGx2YWwgLCBjb2xwb3MsIHJ3ZGF0LCBhY3Qpe3JldHVybiBmb3JtYXR0ZXIocm93SWQsIGNlbGx2YWwgLCBjb2xwb3MsIHJ3ZGF0LCBhY3QpO307XHJcblx0XHQkLmV4dGVuZChncmlkLHtwb3B1bGF0ZSA6IHBvcHVsYXRlLCBlbXB0eVJvd3M6IGVtcHR5Um93cywgYmVnaW5SZXE6IGJlZ2luUmVxLCBlbmRSZXE6IGVuZFJlcX0pO1xyXG5cdFx0dGhpcy5ncmlkID0gZ3JpZDtcclxuXHRcdHRzLmFkZFhtbERhdGEgPSBmdW5jdGlvbihkKSB7YWRkWG1sRGF0YShkLHRzLmdyaWQuYkRpdik7fTtcclxuXHRcdHRzLmFkZEpTT05EYXRhID0gZnVuY3Rpb24oZCkge2FkZEpTT05EYXRhKGQsdHMuZ3JpZC5iRGl2KTt9O1xyXG5cdFx0dGhpcy5ncmlkLmNvbHMgPSB0aGlzLnJvd3NbMF0uY2VsbHM7XHJcblx0XHQkKHRzKS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEluaXRHcmlkXCIpO1xyXG5cdFx0aWYgKCQuaXNGdW5jdGlvbiggdHMucC5vbkluaXRHcmlkICkpIHsgdHMucC5vbkluaXRHcmlkLmNhbGwodHMpOyB9XHJcblxyXG5cdFx0cG9wdWxhdGUoKTt0cy5wLmhpZGRlbmdyaWQ9ZmFsc2U7XHJcblx0fSk7XHJcbn07XHJcbiQuamdyaWQuZXh0ZW5kKHtcclxuXHRnZXRHcmlkUGFyYW0gOiBmdW5jdGlvbihwTmFtZSkge1xyXG5cdFx0dmFyICR0ID0gdGhpc1swXTtcclxuXHRcdGlmICghJHQgfHwgISR0LmdyaWQpIHtyZXR1cm47fVxyXG5cdFx0aWYgKCFwTmFtZSkgeyByZXR1cm4gJHQucDsgfVxyXG5cdFx0cmV0dXJuICR0LnBbcE5hbWVdICE9PSB1bmRlZmluZWQgPyAkdC5wW3BOYW1lXSA6IG51bGw7XHJcblx0fSxcclxuXHRzZXRHcmlkUGFyYW0gOiBmdW5jdGlvbiAobmV3UGFyYW1zKXtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0aWYgKHRoaXMuZ3JpZCAmJiB0eXBlb2YgbmV3UGFyYW1zID09PSAnb2JqZWN0JykgeyQuZXh0ZW5kKHRydWUsdGhpcy5wLG5ld1BhcmFtcyk7fVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRnZXRHcmlkUm93QnlJZDogZnVuY3Rpb24gKCByb3dpZCApIHtcclxuXHRcdHZhciByb3c7XHJcblx0XHR0aGlzLmVhY2goIGZ1bmN0aW9uKCl7XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0Ly9yb3cgPSB0aGlzLnJvd3MubmFtZWRJdGVtKCByb3dpZCApO1xyXG5cdFx0XHRcdHZhciBpID0gdGhpcy5yb3dzLmxlbmd0aDtcclxuXHRcdFx0XHR3aGlsZShpLS0pIHtcclxuXHRcdFx0XHRcdGlmKCByb3dpZC50b1N0cmluZygpID09PSB0aGlzLnJvd3NbaV0uaWQpIHtcclxuXHRcdFx0XHRcdFx0cm93ID0gdGhpcy5yb3dzW2ldO1xyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gY2F0Y2ggKCBlICkge1xyXG5cdFx0XHRcdHJvdyA9ICQodGhpcy5ncmlkLmJEaXYpLmZpbmQoIFwiI1wiICsgJC5qZ3JpZC5qcUlEKCByb3dpZCApKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRyZXR1cm4gcm93O1xyXG5cdH0sXHJcblx0Z2V0RGF0YUlEcyA6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHZhciBpZHM9W10sIGk9MCwgbGVuLCBqPTA7XHJcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0bGVuID0gdGhpcy5yb3dzLmxlbmd0aDtcclxuXHRcdFx0aWYobGVuICYmIGxlbj4wKXtcclxuXHRcdFx0XHR3aGlsZShpPGxlbikge1xyXG5cdFx0XHRcdFx0aWYoJCh0aGlzLnJvd3NbaV0pLmhhc0NsYXNzKCdqcWdyb3cnKSkge1xyXG5cdFx0XHRcdFx0XHRpZHNbal0gPSB0aGlzLnJvd3NbaV0uaWQ7XHJcblx0XHRcdFx0XHRcdGorKztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGkrKztcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0cmV0dXJuIGlkcztcclxuXHR9LFxyXG5cdHNldFNlbGVjdGlvbiA6IGZ1bmN0aW9uKHNlbGVjdGlvbixvbnNyLCBlKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdHZhciAkdCA9IHRoaXMsIHN0YXQscHQsIG5lciwgaWEsIHRwc3IsIGZpZDtcclxuXHRcdFx0aWYoc2VsZWN0aW9uID09PSB1bmRlZmluZWQpIHsgcmV0dXJuOyB9XHJcblx0XHRcdG9uc3IgPSBvbnNyID09PSBmYWxzZSA/IGZhbHNlIDogdHJ1ZTtcclxuXHRcdFx0cHQ9JCgkdCkuanFHcmlkKCdnZXRHcmlkUm93QnlJZCcsIHNlbGVjdGlvbik7XHJcblx0XHRcdGlmKCFwdCB8fCAhcHQuY2xhc3NOYW1lIHx8IHB0LmNsYXNzTmFtZS5pbmRleE9mKCAndWktc3RhdGUtZGlzYWJsZWQnICkgPiAtMSApIHsgcmV0dXJuOyB9XHJcblx0XHRcdGZ1bmN0aW9uIHNjckdyaWQoaVIpe1xyXG5cdFx0XHRcdHZhciBjaCA9ICQoJHQuZ3JpZC5iRGl2KVswXS5jbGllbnRIZWlnaHQsXHJcblx0XHRcdFx0c3QgPSAkKCR0LmdyaWQuYkRpdilbMF0uc2Nyb2xsVG9wLFxyXG5cdFx0XHRcdHJwb3MgPSAkKCR0LnJvd3NbaVJdKS5wb3NpdGlvbigpLnRvcCxcclxuXHRcdFx0XHRyaCA9ICR0LnJvd3NbaVJdLmNsaWVudEhlaWdodDtcclxuXHRcdFx0XHRpZihycG9zK3JoID49IGNoK3N0KSB7ICQoJHQuZ3JpZC5iRGl2KVswXS5zY3JvbGxUb3AgPSBycG9zLShjaCtzdCkrcmgrc3Q7IH1cclxuXHRcdFx0XHRlbHNlIGlmKHJwb3MgPCBjaCtzdCkge1xyXG5cdFx0XHRcdFx0aWYocnBvcyA8IHN0KSB7XHJcblx0XHRcdFx0XHRcdCQoJHQuZ3JpZC5iRGl2KVswXS5zY3JvbGxUb3AgPSBycG9zO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRpZigkdC5wLnNjcm9sbHJvd3M9PT10cnVlKSB7XHJcblx0XHRcdFx0bmVyID0gJCgkdCkuanFHcmlkKCdnZXRHcmlkUm93QnlJZCcsc2VsZWN0aW9uKS5yb3dJbmRleDtcclxuXHRcdFx0XHRpZihuZXIgPj0wICl7XHJcblx0XHRcdFx0XHRzY3JHcmlkKG5lcik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKCR0LnAuZnJvemVuQ29sdW1ucyA9PT0gdHJ1ZSApIHtcclxuXHRcdFx0XHRmaWQgPSAkdC5wLmlkK1wiX2Zyb3plblwiO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKCEkdC5wLm11bHRpc2VsZWN0KSB7XHJcblx0XHRcdFx0aWYocHQuY2xhc3NOYW1lICE9PSBcInVpLXN1YmdyaWRcIikge1xyXG5cdFx0XHRcdFx0aWYoICR0LnAuc2Vscm93ICE9PSBwdC5pZCkge1xyXG5cdFx0XHRcdFx0XHQkKCAkKCR0KS5qcUdyaWQoJ2dldEdyaWRSb3dCeUlkJywgJHQucC5zZWxyb3cpICkucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1oaWdobGlnaHRcIikuYXR0cih7XCJhcmlhLXNlbGVjdGVkXCI6XCJmYWxzZVwiLCBcInRhYmluZGV4XCIgOiBcIi0xXCJ9KTtcclxuXHRcdFx0XHRcdFx0JChwdCkuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1oaWdobGlnaHRcIikuYXR0cih7XCJhcmlhLXNlbGVjdGVkXCI6XCJ0cnVlXCIsIFwidGFiaW5kZXhcIiA6IFwiMFwifSk7Ly8uZm9jdXMoKTtcclxuXHRcdFx0XHRcdFx0aWYoZmlkKSB7XHJcblx0XHRcdFx0XHRcdFx0JChcIiNcIiskLmpncmlkLmpxSUQoJHQucC5zZWxyb3cpLCBcIiNcIiskLmpncmlkLmpxSUQoZmlkKSkucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1oaWdobGlnaHRcIik7XHJcblx0XHRcdFx0XHRcdFx0JChcIiNcIiskLmpncmlkLmpxSUQoc2VsZWN0aW9uKSwgXCIjXCIrJC5qZ3JpZC5qcUlEKGZpZCkpLmFkZENsYXNzKFwidWktc3RhdGUtaGlnaGxpZ2h0XCIpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHN0YXQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0c3RhdCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0JHQucC5zZWxyb3cgPSBwdC5pZDtcclxuXHRcdFx0XHRcdGlmKCBvbnNyICkge1xyXG5cdFx0XHRcdFx0XHQkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZFNlbGVjdFJvd1wiLCBbcHQuaWQsIHN0YXQsIGVdKTtcclxuXHRcdFx0XHRcdFx0aWYoICR0LnAub25TZWxlY3RSb3cpIHsgJHQucC5vblNlbGVjdFJvdy5jYWxsKCR0LCBwdC5pZCwgc3RhdCwgZSk7IH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly91bnNlbGVjdCBzZWxlY3RhbGwgY2hlY2tib3ggd2hlbiBkZXNlbGVjdGluZyBhIHNwZWNpZmljIHJvd1xyXG5cdFx0XHRcdCR0LnNldEhlYWRDaGVja0JveCggZmFsc2UgKTtcclxuXHRcdFx0XHQkdC5wLnNlbHJvdyA9IHB0LmlkO1xyXG5cdFx0XHRcdGlhID0gJC5pbkFycmF5KCR0LnAuc2Vscm93LCR0LnAuc2VsYXJycm93KTtcclxuXHRcdFx0XHRpZiAoICBpYSA9PT0gLTEgKXtcclxuXHRcdFx0XHRcdGlmKHB0LmNsYXNzTmFtZSAhPT0gXCJ1aS1zdWJncmlkXCIpIHsgJChwdCkuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1oaWdobGlnaHRcIikuYXR0cihcImFyaWEtc2VsZWN0ZWRcIixcInRydWVcIik7fVxyXG5cdFx0XHRcdFx0c3RhdCA9IHRydWU7XHJcblx0XHRcdFx0XHQkdC5wLnNlbGFycnJvdy5wdXNoKCR0LnAuc2Vscm93KTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0aWYocHQuY2xhc3NOYW1lICE9PSBcInVpLXN1YmdyaWRcIikgeyAkKHB0KS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWhpZ2hsaWdodFwiKS5hdHRyKFwiYXJpYS1zZWxlY3RlZFwiLFwiZmFsc2VcIik7fVxyXG5cdFx0XHRcdFx0c3RhdCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0JHQucC5zZWxhcnJyb3cuc3BsaWNlKGlhLDEpO1xyXG5cdFx0XHRcdFx0dHBzciA9ICR0LnAuc2VsYXJycm93WzBdO1xyXG5cdFx0XHRcdFx0JHQucC5zZWxyb3cgPSAodHBzciA9PT0gdW5kZWZpbmVkKSA/IG51bGwgOiB0cHNyO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQkKFwiI2pxZ19cIiskLmpncmlkLmpxSUQoJHQucC5pZCkrXCJfXCIrJC5qZ3JpZC5qcUlEKHB0LmlkKSlbJHQucC51c2VQcm9wID8gJ3Byb3AnOiAnYXR0ciddKFwiY2hlY2tlZFwiLHN0YXQpO1xyXG5cdFx0XHRcdGlmKGZpZCkge1xyXG5cdFx0XHRcdFx0aWYoaWEgPT09IC0xKSB7XHJcblx0XHRcdFx0XHRcdCQoXCIjXCIrJC5qZ3JpZC5qcUlEKHNlbGVjdGlvbiksIFwiI1wiKyQuamdyaWQuanFJRChmaWQpKS5hZGRDbGFzcyhcInVpLXN0YXRlLWhpZ2hsaWdodFwiKTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdCQoXCIjXCIrJC5qZ3JpZC5qcUlEKHNlbGVjdGlvbiksIFwiI1wiKyQuamdyaWQuanFJRChmaWQpKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWhpZ2hsaWdodFwiKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdCQoXCIjanFnX1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKStcIl9cIiskLmpncmlkLmpxSUQoc2VsZWN0aW9uKSwgXCIjXCIrJC5qZ3JpZC5qcUlEKGZpZCkpWyR0LnAudXNlUHJvcCA/ICdwcm9wJzogJ2F0dHInXShcImNoZWNrZWRcIixzdGF0KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoIG9uc3IgKSB7XHJcblx0XHRcdFx0XHQkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZFNlbGVjdFJvd1wiLCBbcHQuaWQsIHN0YXQsIGVdKTtcclxuXHRcdFx0XHRcdGlmKCAkdC5wLm9uU2VsZWN0Um93KSB7ICR0LnAub25TZWxlY3RSb3cuY2FsbCgkdCwgcHQuaWQgLCBzdGF0LCBlKTsgfVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRyZXNldFNlbGVjdGlvbiA6IGZ1bmN0aW9uKCByb3dpZCApe1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgdCA9IHRoaXMsIHNyLCBmaWQ7XHJcblx0XHRcdGlmKCB0LnAuZnJvemVuQ29sdW1ucyA9PT0gdHJ1ZSApIHtcclxuXHRcdFx0XHRmaWQgPSB0LnAuaWQrXCJfZnJvemVuXCI7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYocm93aWQgIT09IHVuZGVmaW5lZCApIHtcclxuXHRcdFx0XHRzciA9IHJvd2lkID09PSB0LnAuc2Vscm93ID8gdC5wLnNlbHJvdyA6IHJvd2lkO1xyXG5cdFx0XHRcdCQoXCIjXCIrJC5qZ3JpZC5qcUlEKHQucC5pZCkrXCIgdGJvZHk6Zmlyc3QgdHIjXCIrJC5qZ3JpZC5qcUlEKHNyKSkucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1oaWdobGlnaHRcIikuYXR0cihcImFyaWEtc2VsZWN0ZWRcIixcImZhbHNlXCIpO1xyXG5cdFx0XHRcdGlmIChmaWQpIHsgJChcIiNcIiskLmpncmlkLmpxSUQoc3IpLCBcIiNcIiskLmpncmlkLmpxSUQoZmlkKSkucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1oaWdobGlnaHRcIik7IH1cclxuXHRcdFx0XHRpZih0LnAubXVsdGlzZWxlY3QpIHtcclxuXHRcdFx0XHRcdCQoXCIjanFnX1wiKyQuamdyaWQuanFJRCh0LnAuaWQpK1wiX1wiKyQuamdyaWQuanFJRChzciksIFwiI1wiKyQuamdyaWQuanFJRCh0LnAuaWQpKVt0LnAudXNlUHJvcCA/ICdwcm9wJzogJ2F0dHInXShcImNoZWNrZWRcIixmYWxzZSk7XHJcblx0XHRcdFx0XHRpZihmaWQpIHsgJChcIiNqcWdfXCIrJC5qZ3JpZC5qcUlEKHQucC5pZCkrXCJfXCIrJC5qZ3JpZC5qcUlEKHNyKSwgXCIjXCIrJC5qZ3JpZC5qcUlEKGZpZCkpW3QucC51c2VQcm9wID8gJ3Byb3AnOiAnYXR0ciddKFwiY2hlY2tlZFwiLGZhbHNlKTsgfVxyXG5cdFx0XHRcdFx0dC5zZXRIZWFkQ2hlY2tCb3goIGZhbHNlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0c3IgPSBudWxsO1xyXG5cdFx0XHR9IGVsc2UgaWYoIXQucC5tdWx0aXNlbGVjdCkge1xyXG5cdFx0XHRcdGlmKHQucC5zZWxyb3cpIHtcclxuXHRcdFx0XHRcdCQoXCIjXCIrJC5qZ3JpZC5qcUlEKHQucC5pZCkrXCIgdGJvZHk6Zmlyc3QgdHIjXCIrJC5qZ3JpZC5qcUlEKHQucC5zZWxyb3cpKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWhpZ2hsaWdodFwiKS5hdHRyKFwiYXJpYS1zZWxlY3RlZFwiLFwiZmFsc2VcIik7XHJcblx0XHRcdFx0XHRpZihmaWQpIHsgJChcIiNcIiskLmpncmlkLmpxSUQodC5wLnNlbHJvdyksIFwiI1wiKyQuamdyaWQuanFJRChmaWQpKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWhpZ2hsaWdodFwiKTsgfVxyXG5cdFx0XHRcdFx0dC5wLnNlbHJvdyA9IG51bGw7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQodC5wLnNlbGFycnJvdykuZWFjaChmdW5jdGlvbihpLG4pe1xyXG5cdFx0XHRcdFx0JCggJCh0KS5qcUdyaWQoJ2dldEdyaWRSb3dCeUlkJyxuKSApLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtaGlnaGxpZ2h0XCIpLmF0dHIoXCJhcmlhLXNlbGVjdGVkXCIsXCJmYWxzZVwiKTtcclxuXHRcdFx0XHRcdCQoXCIjanFnX1wiKyQuamdyaWQuanFJRCh0LnAuaWQpK1wiX1wiKyQuamdyaWQuanFJRChuKSlbdC5wLnVzZVByb3AgPyAncHJvcCc6ICdhdHRyJ10oXCJjaGVja2VkXCIsZmFsc2UpO1xyXG5cdFx0XHRcdFx0aWYoZmlkKSB7XHJcblx0XHRcdFx0XHRcdCQoXCIjXCIrJC5qZ3JpZC5qcUlEKG4pLCBcIiNcIiskLmpncmlkLmpxSUQoZmlkKSkucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1oaWdobGlnaHRcIik7XHJcblx0XHRcdFx0XHRcdCQoXCIjanFnX1wiKyQuamdyaWQuanFJRCh0LnAuaWQpK1wiX1wiKyQuamdyaWQuanFJRChuKSwgXCIjXCIrJC5qZ3JpZC5qcUlEKGZpZCkpW3QucC51c2VQcm9wID8gJ3Byb3AnOiAnYXR0ciddKFwiY2hlY2tlZFwiLGZhbHNlKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHR0LnNldEhlYWRDaGVja0JveCggZmFsc2UgKTtcclxuXHRcdFx0XHR0LnAuc2VsYXJycm93ID0gW107XHJcblx0XHRcdFx0dC5wLnNlbHJvdyA9IG51bGw7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYodC5wLmNlbGxFZGl0ID09PSB0cnVlKSB7XHJcblx0XHRcdFx0aWYocGFyc2VJbnQodC5wLmlDb2wsMTApPj0wICAmJiBwYXJzZUludCh0LnAuaVJvdywxMCk+PTApIHtcclxuXHRcdFx0XHRcdCQoXCJ0ZDplcShcIit0LnAuaUNvbCtcIilcIix0LnJvd3NbdC5wLmlSb3ddKS5yZW1vdmVDbGFzcyhcImVkaXQtY2VsbCB1aS1zdGF0ZS1oaWdobGlnaHRcIik7XHJcblx0XHRcdFx0XHQkKHQucm93c1t0LnAuaVJvd10pLnJlbW92ZUNsYXNzKFwic2VsZWN0ZWQtcm93IHVpLXN0YXRlLWhvdmVyXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHR0LnAuc2F2ZWRSb3cgPSBbXTtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0Z2V0Um93RGF0YSA6IGZ1bmN0aW9uKCByb3dpZCApIHtcclxuXHRcdHZhciByZXMgPSB7fSwgcmVzYWxsLCBnZXRhbGw9ZmFsc2UsIGxlbiwgaj0wO1xyXG5cdFx0dGhpcy5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdHZhciAkdCA9IHRoaXMsbm0saW5kO1xyXG5cdFx0XHRpZihyb3dpZCA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0Z2V0YWxsID0gdHJ1ZTtcclxuXHRcdFx0XHRyZXNhbGwgPSBbXTtcclxuXHRcdFx0XHRsZW4gPSAkdC5yb3dzLmxlbmd0aDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpbmQgPSAkKCR0KS5qcUdyaWQoJ2dldEdyaWRSb3dCeUlkJywgcm93aWQpO1xyXG5cdFx0XHRcdGlmKCFpbmQpIHsgcmV0dXJuIHJlczsgfVxyXG5cdFx0XHRcdGxlbiA9IDI7XHJcblx0XHRcdH1cclxuXHRcdFx0d2hpbGUoajxsZW4pe1xyXG5cdFx0XHRcdGlmKGdldGFsbCkgeyBpbmQgPSAkdC5yb3dzW2pdOyB9XHJcblx0XHRcdFx0aWYoICQoaW5kKS5oYXNDbGFzcygnanFncm93JykgKSB7XHJcblx0XHRcdFx0XHQkKCd0ZFtyb2xlPVwiZ3JpZGNlbGxcIl0nLGluZCkuZWFjaCggZnVuY3Rpb24oaSkge1xyXG5cdFx0XHRcdFx0XHRubSA9ICR0LnAuY29sTW9kZWxbaV0ubmFtZTtcclxuXHRcdFx0XHRcdFx0aWYgKCBubSAhPT0gJ2NiJyAmJiBubSAhPT0gJ3N1YmdyaWQnICYmIG5tICE9PSAncm4nKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYoJHQucC50cmVlR3JpZD09PXRydWUgJiYgbm0gPT09ICR0LnAuRXhwYW5kQ29sdW1uKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRyZXNbbm1dID0gJC5qZ3JpZC5odG1sRGVjb2RlKCQoXCJzcGFuOmZpcnN0XCIsdGhpcykuaHRtbCgpKTtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0cmVzW25tXSA9ICQudW5mb3JtYXQuY2FsbCgkdCx0aGlzLHtyb3dJZDppbmQuaWQsIGNvbE1vZGVsOiR0LnAuY29sTW9kZWxbaV19LGkpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSl7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHJlc1tubV0gPSAkLmpncmlkLmh0bWxEZWNvZGUoJCh0aGlzKS5odG1sKCkpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpZihnZXRhbGwpIHsgcmVzYWxsLnB1c2gocmVzKTsgcmVzPXt9OyB9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGorKztcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRyZXR1cm4gcmVzYWxsIHx8IHJlcztcclxuXHR9LFxyXG5cdGRlbFJvd0RhdGEgOiBmdW5jdGlvbihyb3dpZCkge1xyXG5cdFx0dmFyIHN1Y2Nlc3MgPSBmYWxzZSwgcm93SW5kLCBpYTtcclxuXHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyICR0ID0gdGhpcztcclxuXHRcdFx0cm93SW5kID0gJCgkdCkuanFHcmlkKCdnZXRHcmlkUm93QnlJZCcsIHJvd2lkKTtcclxuXHRcdFx0aWYoIXJvd0luZCkge3JldHVybiBmYWxzZTt9XHJcblx0XHRcdFx0JChyb3dJbmQpLnJlbW92ZSgpO1xyXG5cdFx0XHRcdCR0LnAucmVjb3Jkcy0tO1xyXG5cdFx0XHRcdCR0LnAucmVjY291bnQtLTtcclxuXHRcdFx0XHQkdC51cGRhdGVwYWdlcih0cnVlLGZhbHNlKTtcclxuXHRcdFx0XHRzdWNjZXNzPXRydWU7XHJcblx0XHRcdFx0aWYoJHQucC5tdWx0aXNlbGVjdCkge1xyXG5cdFx0XHRcdFx0aWEgPSAkLmluQXJyYXkocm93aWQsJHQucC5zZWxhcnJyb3cpO1xyXG5cdFx0XHRcdFx0aWYoaWEgIT09IC0xKSB7ICR0LnAuc2VsYXJycm93LnNwbGljZShpYSwxKTt9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmICgkdC5wLm11bHRpc2VsZWN0ICYmICR0LnAuc2VsYXJycm93Lmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdCR0LnAuc2Vscm93ID0gJHQucC5zZWxhcnJyb3dbJHQucC5zZWxhcnJyb3cubGVuZ3RoLTFdO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQkdC5wLnNlbHJvdyA9IG51bGw7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRpZigkdC5wLmRhdGF0eXBlID09PSAnbG9jYWwnKSB7XHJcblx0XHRcdFx0dmFyIGlkID0gJC5qZ3JpZC5zdHJpcFByZWYoJHQucC5pZFByZWZpeCwgcm93aWQpLFxyXG5cdFx0XHRcdHBvcyA9ICR0LnAuX2luZGV4W2lkXTtcclxuXHRcdFx0XHRpZihwb3MgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0JHQucC5kYXRhLnNwbGljZShwb3MsMSk7XHJcblx0XHRcdFx0XHQkdC5yZWZyZXNoSW5kZXgoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoICR0LnAuYWx0Um93cyA9PT0gdHJ1ZSAmJiBzdWNjZXNzICkge1xyXG5cdFx0XHRcdHZhciBjbiA9ICR0LnAuYWx0Y2xhc3M7XHJcblx0XHRcdFx0JCgkdC5yb3dzKS5lYWNoKGZ1bmN0aW9uKGkpe1xyXG5cdFx0XHRcdFx0aWYoaSAlIDIgPT09IDEpIHsgJCh0aGlzKS5hZGRDbGFzcyhjbik7IH1cclxuXHRcdFx0XHRcdGVsc2UgeyAkKHRoaXMpLnJlbW92ZUNsYXNzKGNuKTsgfVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdHJldHVybiBzdWNjZXNzO1xyXG5cdH0sXHJcblx0c2V0Um93RGF0YSA6IGZ1bmN0aW9uKHJvd2lkLCBkYXRhLCBjc3NwKSB7XHJcblx0XHR2YXIgbm0sIHN1Y2Nlc3M9dHJ1ZSwgdGl0bGU7XHJcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0aWYoIXRoaXMuZ3JpZCkge3JldHVybiBmYWxzZTt9XHJcblx0XHRcdHZhciB0ID0gdGhpcywgdmwsIGluZCwgY3AgPSB0eXBlb2YgY3NzcCwgbGNkYXRhPXt9O1xyXG5cdFx0XHRpbmQgPSAkKHRoaXMpLmpxR3JpZCgnZ2V0R3JpZFJvd0J5SWQnLCByb3dpZCk7XHJcblx0XHRcdGlmKCFpbmQpIHsgcmV0dXJuIGZhbHNlOyB9XHJcblx0XHRcdGlmKCBkYXRhICkge1xyXG5cdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHQkKHRoaXMucC5jb2xNb2RlbCkuZWFjaChmdW5jdGlvbihpKXtcclxuXHRcdFx0XHRcdFx0bm0gPSB0aGlzLm5hbWU7XHJcblx0XHRcdFx0XHRcdHZhciBkdmFsID0kLmpncmlkLmdldEFjY2Vzc29yKGRhdGEsbm0pO1xyXG5cdFx0XHRcdFx0XHRpZiggZHZhbCAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdFx0bGNkYXRhW25tXSA9IHRoaXMuZm9ybWF0dGVyICYmIHR5cGVvZiB0aGlzLmZvcm1hdHRlciA9PT0gJ3N0cmluZycgJiYgdGhpcy5mb3JtYXR0ZXIgPT09ICdkYXRlJyA/ICQudW5mb3JtYXQuZGF0ZS5jYWxsKHQsZHZhbCx0aGlzKSA6IGR2YWw7XHJcblx0XHRcdFx0XHRcdFx0dmwgPSB0LmZvcm1hdHRlciggcm93aWQsIGR2YWwsIGksIGRhdGEsICdlZGl0Jyk7XHJcblx0XHRcdFx0XHRcdFx0dGl0bGUgPSB0aGlzLnRpdGxlID8ge1widGl0bGVcIjokLmpncmlkLnN0cmlwSHRtbCh2bCl9IDoge307XHJcblx0XHRcdFx0XHRcdFx0aWYodC5wLnRyZWVHcmlkPT09dHJ1ZSAmJiBubSA9PT0gdC5wLkV4cGFuZENvbHVtbikge1xyXG5cdFx0XHRcdFx0XHRcdFx0JChcInRkW3JvbGU9J2dyaWRjZWxsJ106ZXEoXCIraStcIikgPiBzcGFuOmZpcnN0XCIsaW5kKS5odG1sKHZsKS5hdHRyKHRpdGxlKTtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0JChcInRkW3JvbGU9J2dyaWRjZWxsJ106ZXEoXCIraStcIilcIixpbmQpLmh0bWwodmwpLmF0dHIodGl0bGUpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpZih0LnAuZGF0YXR5cGUgPT09ICdsb2NhbCcpIHtcclxuXHRcdFx0XHRcdFx0dmFyIGlkID0gJC5qZ3JpZC5zdHJpcFByZWYodC5wLmlkUHJlZml4LCByb3dpZCksXHJcblx0XHRcdFx0XHRcdHBvcyA9IHQucC5faW5kZXhbaWRdLCBrZXk7XHJcblx0XHRcdFx0XHRcdGlmKHQucC50cmVlR3JpZCkge1xyXG5cdFx0XHRcdFx0XHRcdGZvcihrZXkgaW4gdC5wLnRyZWVSZWFkZXIpe1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYodC5wLnRyZWVSZWFkZXIuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgbGNkYXRhW3QucC50cmVlUmVhZGVyW2tleV1dO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZihwb3MgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0XHRcdHQucC5kYXRhW3Bvc10gPSAkLmV4dGVuZCh0cnVlLCB0LnAuZGF0YVtwb3NdLCBsY2RhdGEpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGxjZGF0YSA9IG51bGw7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRcdFx0c3VjY2VzcyA9IGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRpZihzdWNjZXNzKSB7XHJcblx0XHRcdFx0aWYoY3AgPT09ICdzdHJpbmcnKSB7JChpbmQpLmFkZENsYXNzKGNzc3ApO30gZWxzZSBpZihjc3NwICE9PSBudWxsICYmIGNwID09PSAnb2JqZWN0JykgeyQoaW5kKS5jc3MoY3NzcCk7fVxyXG5cdFx0XHRcdCQodCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRBZnRlckdyaWRDb21wbGV0ZVwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRyZXR1cm4gc3VjY2VzcztcclxuXHR9LFxyXG5cdGFkZFJvd0RhdGEgOiBmdW5jdGlvbihyb3dpZCxyZGF0YSxwb3Msc3JjKSB7XHJcblx0XHRpZighcG9zKSB7cG9zID0gXCJsYXN0XCI7fVxyXG5cdFx0dmFyIHN1Y2Nlc3MgPSBmYWxzZSwgbm0sIHJvdywgZ2ksIHNpLCBuaSxzaW5kLCBpLCB2LCBwcnA9XCJcIiwgYXJhZGQsIGNubSwgY24sIGRhdGEsIGNtLCBpZDtcclxuXHRcdGlmKHJkYXRhKSB7XHJcblx0XHRcdGlmKCQuaXNBcnJheShyZGF0YSkpIHtcclxuXHRcdFx0XHRhcmFkZD10cnVlO1xyXG5cdFx0XHRcdHBvcyA9IFwibGFzdFwiO1xyXG5cdFx0XHRcdGNubSA9IHJvd2lkO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHJkYXRhID0gW3JkYXRhXTtcclxuXHRcdFx0XHRhcmFkZCA9IGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR2YXIgdCA9IHRoaXMsIGRhdGFsZW4gPSByZGF0YS5sZW5ndGg7XHJcblx0XHRcdFx0bmkgPSB0LnAucm93bnVtYmVycz09PXRydWUgPyAxIDowO1xyXG5cdFx0XHRcdGdpID0gdC5wLm11bHRpc2VsZWN0ID09PXRydWUgPyAxIDowO1xyXG5cdFx0XHRcdHNpID0gdC5wLnN1YkdyaWQ9PT10cnVlID8gMSA6MDtcclxuXHRcdFx0XHRpZighYXJhZGQpIHtcclxuXHRcdFx0XHRcdGlmKHJvd2lkICE9PSB1bmRlZmluZWQpIHsgcm93aWQgPSBTdHJpbmcocm93aWQpO31cclxuXHRcdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRyb3dpZCA9ICQuamdyaWQucmFuZElkKCk7XHJcblx0XHRcdFx0XHRcdGlmKHQucC5rZXlJbmRleCAhPT0gZmFsc2UpIHtcclxuXHRcdFx0XHRcdFx0XHRjbm0gPSB0LnAuY29sTW9kZWxbdC5wLmtleUluZGV4K2dpK3NpK25pXS5uYW1lO1xyXG5cdFx0XHRcdFx0XHRcdGlmKHJkYXRhWzBdW2NubV0gIT09IHVuZGVmaW5lZCkgeyByb3dpZCA9IHJkYXRhWzBdW2NubV07IH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRjbiA9IHQucC5hbHRjbGFzcztcclxuXHRcdFx0XHR2YXIgayA9IDAsIGNuYSA9XCJcIiwgbGNkYXRhID0ge30sXHJcblx0XHRcdFx0YWlyID0gJC5pc0Z1bmN0aW9uKHQucC5hZnRlckluc2VydFJvdykgPyB0cnVlIDogZmFsc2U7XHJcblx0XHRcdFx0d2hpbGUoayA8IGRhdGFsZW4pIHtcclxuXHRcdFx0XHRcdGRhdGEgPSByZGF0YVtrXTtcclxuXHRcdFx0XHRcdHJvdz1bXTtcclxuXHRcdFx0XHRcdGlmKGFyYWRkKSB7XHJcblx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0cm93aWQgPSBkYXRhW2NubV07XHJcblx0XHRcdFx0XHRcdFx0aWYocm93aWQ9PT11bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHJvd2lkID0gJC5qZ3JpZC5yYW5kSWQoKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0Y2F0Y2ggKGUpIHtyb3dpZCA9ICQuamdyaWQucmFuZElkKCk7fVxyXG5cdFx0XHRcdFx0XHRjbmEgPSB0LnAuYWx0Um93cyA9PT0gdHJ1ZSA/ICAodC5yb3dzLmxlbmd0aC0xKSUyID09PSAwID8gY24gOiBcIlwiIDogXCJcIjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlkID0gcm93aWQ7XHJcblx0XHRcdFx0XHRyb3dpZCAgPSB0LnAuaWRQcmVmaXggKyByb3dpZDtcclxuXHRcdFx0XHRcdGlmKG5pKXtcclxuXHRcdFx0XHRcdFx0cHJwID0gdC5mb3JtYXRDb2woMCwxLCcnLG51bGwscm93aWQsIHRydWUpO1xyXG5cdFx0XHRcdFx0XHRyb3dbcm93Lmxlbmd0aF0gPSBcIjx0ZCByb2xlPVxcXCJncmlkY2VsbFxcXCIgY2xhc3M9XFxcInVpLXN0YXRlLWRlZmF1bHQganFncmlkLXJvd251bVxcXCIgXCIrcHJwK1wiPjA8L3RkPlwiO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYoZ2kpIHtcclxuXHRcdFx0XHRcdFx0diA9IFwiPGlucHV0IHJvbGU9XFxcImNoZWNrYm94XFxcIiB0eXBlPVxcXCJjaGVja2JveFxcXCJcIitcIiBpZD1cXFwianFnX1wiK3QucC5pZCtcIl9cIityb3dpZCtcIlxcXCIgY2xhc3M9XFxcImNib3hcXFwiLz5cIjtcclxuXHRcdFx0XHRcdFx0cHJwID0gdC5mb3JtYXRDb2wobmksMSwnJywgbnVsbCwgcm93aWQsIHRydWUpO1xyXG5cdFx0XHRcdFx0XHRyb3dbcm93Lmxlbmd0aF0gPSBcIjx0ZCByb2xlPVxcXCJncmlkY2VsbFxcXCIgXCIrcHJwK1wiPlwiK3YrXCI8L3RkPlwiO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYoc2kpIHtcclxuXHRcdFx0XHRcdFx0cm93W3Jvdy5sZW5ndGhdID0gJCh0KS5qcUdyaWQoXCJhZGRTdWJHcmlkQ2VsbFwiLGdpK25pLDEpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Zm9yKGkgPSBnaStzaStuaTsgaSA8IHQucC5jb2xNb2RlbC5sZW5ndGg7aSsrKXtcclxuXHRcdFx0XHRcdFx0Y20gPSB0LnAuY29sTW9kZWxbaV07XHJcblx0XHRcdFx0XHRcdG5tID0gY20ubmFtZTtcclxuXHRcdFx0XHRcdFx0bGNkYXRhW25tXSA9IGRhdGFbbm1dO1xyXG5cdFx0XHRcdFx0XHR2ID0gdC5mb3JtYXR0ZXIoIHJvd2lkLCAkLmpncmlkLmdldEFjY2Vzc29yKGRhdGEsbm0pLCBpLCBkYXRhICk7XHJcblx0XHRcdFx0XHRcdHBycCA9IHQuZm9ybWF0Q29sKGksMSx2LCBkYXRhLCByb3dpZCwgbGNkYXRhKTtcclxuXHRcdFx0XHRcdFx0cm93W3Jvdy5sZW5ndGhdID0gXCI8dGQgcm9sZT1cXFwiZ3JpZGNlbGxcXFwiIFwiK3BycCtcIj5cIit2K1wiPC90ZD5cIjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJvdy51bnNoaWZ0KCB0LmNvbnN0cnVjdFRyKHJvd2lkLCBmYWxzZSwgY25hLCBsY2RhdGEsIGRhdGEsIGZhbHNlICkgKTtcclxuXHRcdFx0XHRcdHJvd1tyb3cubGVuZ3RoXSA9IFwiPC90cj5cIjtcclxuXHRcdFx0XHRcdGlmKHQucm93cy5sZW5ndGggPT09IDApe1xyXG5cdFx0XHRcdFx0XHQkKFwidGFibGU6Zmlyc3RcIix0LmdyaWQuYkRpdikuYXBwZW5kKHJvdy5qb2luKCcnKSk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRzd2l0Y2ggKHBvcykge1xyXG5cdFx0XHRcdFx0XHRcdGNhc2UgJ2xhc3QnOlxyXG5cdFx0XHRcdFx0XHRcdFx0JCh0LnJvd3NbdC5yb3dzLmxlbmd0aC0xXSkuYWZ0ZXIocm93LmpvaW4oJycpKTtcclxuXHRcdFx0XHRcdFx0XHRcdHNpbmQgPSB0LnJvd3MubGVuZ3RoLTE7XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRjYXNlICdmaXJzdCc6XHJcblx0XHRcdFx0XHRcdFx0XHQkKHQucm93c1swXSkuYWZ0ZXIocm93LmpvaW4oJycpKTtcclxuXHRcdFx0XHRcdFx0XHRcdHNpbmQgPSAxO1xyXG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0Y2FzZSAnYWZ0ZXInOlxyXG5cdFx0XHRcdFx0XHRcdFx0c2luZCA9ICQodCkuanFHcmlkKCdnZXRHcmlkUm93QnlJZCcsIHNyYyk7XHJcblx0XHRcdFx0XHRcdFx0XHRpZiAoc2luZCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZigkKHQucm93c1tzaW5kLnJvd0luZGV4KzFdKS5oYXNDbGFzcyhcInVpLXN1YmdyaWRcIikpIHsgJCh0LnJvd3Nbc2luZC5yb3dJbmRleCsxXSkuYWZ0ZXIocm93KTsgfVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRlbHNlIHsgJChzaW5kKS5hZnRlcihyb3cuam9pbignJykpOyB9XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNpbmQ9c2luZC5yb3dJbmRleCArIDE7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRjYXNlICdiZWZvcmUnOlxyXG5cdFx0XHRcdFx0XHRcdFx0c2luZCA9ICQodCkuanFHcmlkKCdnZXRHcmlkUm93QnlJZCcsIHNyYyk7XHJcblx0XHRcdFx0XHRcdFx0XHRpZihzaW5kKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQoc2luZCkuYmVmb3JlKHJvdy5qb2luKCcnKSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNpbmQ9c2luZC5yb3dJbmRleCAtIDE7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYodC5wLnN1YkdyaWQ9PT10cnVlKSB7XHJcblx0XHRcdFx0XHRcdCQodCkuanFHcmlkKFwiYWRkU3ViR3JpZFwiLGdpK25pLCBzaW5kKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHQucC5yZWNvcmRzKys7XHJcblx0XHRcdFx0XHR0LnAucmVjY291bnQrKztcclxuXHRcdFx0XHRcdCQodCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRBZnRlckluc2VydFJvd1wiLCBbcm93aWQsZGF0YSxkYXRhXSk7XHJcblx0XHRcdFx0XHRpZihhaXIpIHsgdC5wLmFmdGVySW5zZXJ0Um93LmNhbGwodCxyb3dpZCxkYXRhLGRhdGEpOyB9XHJcblx0XHRcdFx0XHRrKys7XHJcblx0XHRcdFx0XHRpZih0LnAuZGF0YXR5cGUgPT09ICdsb2NhbCcpIHtcclxuXHRcdFx0XHRcdFx0bGNkYXRhW3QucC5sb2NhbFJlYWRlci5pZF0gPSBpZDtcclxuXHRcdFx0XHRcdFx0dC5wLl9pbmRleFtpZF0gPSB0LnAuZGF0YS5sZW5ndGg7XHJcblx0XHRcdFx0XHRcdHQucC5kYXRhLnB1c2gobGNkYXRhKTtcclxuXHRcdFx0XHRcdFx0bGNkYXRhID0ge307XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKCB0LnAuYWx0Um93cyA9PT0gdHJ1ZSAmJiAhYXJhZGQpIHtcclxuXHRcdFx0XHRcdGlmIChwb3MgPT09IFwibGFzdFwiKSB7XHJcblx0XHRcdFx0XHRcdGlmICgodC5yb3dzLmxlbmd0aC0xKSUyID09PSAxKSAgeyQodC5yb3dzW3Qucm93cy5sZW5ndGgtMV0pLmFkZENsYXNzKGNuKTt9XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQkKHQucm93cykuZWFjaChmdW5jdGlvbihpKXtcclxuXHRcdFx0XHRcdFx0XHRpZihpICUgMiA9PT0xKSB7ICQodGhpcykuYWRkQ2xhc3MoY24pOyB9XHJcblx0XHRcdFx0XHRcdFx0ZWxzZSB7ICQodGhpcykucmVtb3ZlQ2xhc3MoY24pOyB9XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0LnVwZGF0ZXBhZ2VyKHRydWUsdHJ1ZSk7XHJcblx0XHRcdFx0c3VjY2VzcyA9IHRydWU7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHN1Y2Nlc3M7XHJcblx0fSxcclxuXHRmb290ZXJEYXRhIDogZnVuY3Rpb24oYWN0aW9uLGRhdGEsIGZvcm1hdCkge1xyXG5cdFx0dmFyIG5tLCBzdWNjZXNzPWZhbHNlLCByZXM9e30sIHRpdGxlO1xyXG5cdFx0ZnVuY3Rpb24gaXNFbXB0eShvYmopIHtcclxuXHRcdFx0dmFyIGk7XHJcblx0XHRcdGZvcihpIGluIG9iaikge1xyXG5cdFx0XHRcdGlmIChvYmouaGFzT3duUHJvcGVydHkoaSkpIHsgcmV0dXJuIGZhbHNlOyB9XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9XHJcblx0XHRpZihhY3Rpb24gPT0gdW5kZWZpbmVkKSB7IGFjdGlvbiA9IFwiZ2V0XCI7IH1cclxuXHRcdGlmKHR5cGVvZiBmb3JtYXQgIT09IFwiYm9vbGVhblwiKSB7IGZvcm1hdCAgPSB0cnVlOyB9XHJcblx0XHRhY3Rpb24gPSBhY3Rpb24udG9Mb3dlckNhc2UoKTtcclxuXHRcdHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgdCA9IHRoaXMsIHZsO1xyXG5cdFx0XHRpZighdC5ncmlkIHx8ICF0LnAuZm9vdGVycm93KSB7cmV0dXJuIGZhbHNlO31cclxuXHRcdFx0aWYoYWN0aW9uID09PSBcInNldFwiKSB7IGlmKGlzRW1wdHkoZGF0YSkpIHsgcmV0dXJuIGZhbHNlOyB9IH1cclxuXHRcdFx0c3VjY2Vzcz10cnVlO1xyXG5cdFx0XHQkKHRoaXMucC5jb2xNb2RlbCkuZWFjaChmdW5jdGlvbihpKXtcclxuXHRcdFx0XHRubSA9IHRoaXMubmFtZTtcclxuXHRcdFx0XHRpZihhY3Rpb24gPT09IFwic2V0XCIpIHtcclxuXHRcdFx0XHRcdGlmKCBkYXRhW25tXSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdHZsID0gZm9ybWF0ID8gdC5mb3JtYXR0ZXIoIFwiXCIsIGRhdGFbbm1dLCBpLCBkYXRhLCAnZWRpdCcpIDogZGF0YVtubV07XHJcblx0XHRcdFx0XHRcdHRpdGxlID0gdGhpcy50aXRsZSA/IHtcInRpdGxlXCI6JC5qZ3JpZC5zdHJpcEh0bWwodmwpfSA6IHt9O1xyXG5cdFx0XHRcdFx0XHQkKFwidHIuZm9vdHJvdyB0ZDplcShcIitpK1wiKVwiLHQuZ3JpZC5zRGl2KS5odG1sKHZsKS5hdHRyKHRpdGxlKTtcclxuXHRcdFx0XHRcdFx0c3VjY2VzcyA9IHRydWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBlbHNlIGlmKGFjdGlvbiA9PT0gXCJnZXRcIikge1xyXG5cdFx0XHRcdFx0cmVzW25tXSA9ICQoXCJ0ci5mb290cm93IHRkOmVxKFwiK2krXCIpXCIsdC5ncmlkLnNEaXYpLmh0bWwoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblx0XHRyZXR1cm4gYWN0aW9uID09PSBcImdldFwiID8gcmVzIDogc3VjY2VzcztcclxuXHR9LFxyXG5cdHNob3dIaWRlQ29sIDogZnVuY3Rpb24oY29sbmFtZSxzaG93KSB7XHJcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzLCBmbmRoPWZhbHNlLCBicmQ9JC5qZ3JpZC5jZWxsX3dpZHRoID8gMDogJHQucC5jZWxsTGF5b3V0LCBjdztcclxuXHRcdFx0aWYgKCEkdC5ncmlkICkge3JldHVybjt9XHJcblx0XHRcdGlmKCB0eXBlb2YgY29sbmFtZSA9PT0gJ3N0cmluZycpIHtjb2xuYW1lPVtjb2xuYW1lXTt9XHJcblx0XHRcdHNob3cgPSBzaG93ICE9PSBcIm5vbmVcIiA/IFwiXCIgOiBcIm5vbmVcIjtcclxuXHRcdFx0dmFyIHN3ID0gc2hvdyA9PT0gXCJcIiA/IHRydWUgOmZhbHNlLFxyXG5cdFx0XHRnaCA9ICR0LnAuZ3JvdXBIZWFkZXIgJiYgKHR5cGVvZiAkdC5wLmdyb3VwSGVhZGVyID09PSAnb2JqZWN0JyB8fCAkLmlzRnVuY3Rpb24oJHQucC5ncm91cEhlYWRlcikgKTtcclxuXHRcdFx0aWYoZ2gpIHsgJCgkdCkuanFHcmlkKCdkZXN0cm95R3JvdXBIZWFkZXInLCBmYWxzZSk7IH1cclxuXHRcdFx0JCh0aGlzLnAuY29sTW9kZWwpLmVhY2goZnVuY3Rpb24oaSkge1xyXG5cdFx0XHRcdGlmICgkLmluQXJyYXkodGhpcy5uYW1lLGNvbG5hbWUpICE9PSAtMSAmJiB0aGlzLmhpZGRlbiA9PT0gc3cpIHtcclxuXHRcdFx0XHRcdGlmKCR0LnAuZnJvemVuQ29sdW1ucyA9PT0gdHJ1ZSAmJiB0aGlzLmZyb3plbiA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdCQoXCJ0cltyb2xlPXJvd2hlYWRlcl1cIiwkdC5ncmlkLmhEaXYpLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdFx0JCh0aGlzLmNlbGxzW2ldKS5jc3MoXCJkaXNwbGF5XCIsIHNob3cpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHQkKCR0LnJvd3MpLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdFx0aWYgKCEkKHRoaXMpLmhhc0NsYXNzKFwianFncm91cFwiKSkge1xyXG5cdFx0XHRcdFx0XHRcdCQodGhpcy5jZWxsc1tpXSkuY3NzKFwiZGlzcGxheVwiLCBzaG93KTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRpZigkdC5wLmZvb3RlcnJvdykgeyAkKFwidHIuZm9vdHJvdyB0ZDplcShcIitpK1wiKVwiLCAkdC5ncmlkLnNEaXYpLmNzcyhcImRpc3BsYXlcIiwgc2hvdyk7IH1cclxuXHRcdFx0XHRcdGN3ID0gIHBhcnNlSW50KHRoaXMud2lkdGgsMTApO1xyXG5cdFx0XHRcdFx0aWYoc2hvdyA9PT0gXCJub25lXCIpIHtcclxuXHRcdFx0XHRcdFx0JHQucC50Ymx3aWR0aCAtPSBjdyticmQ7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQkdC5wLnRibHdpZHRoICs9IGN3K2JyZDtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHRoaXMuaGlkZGVuID0gIXN3O1xyXG5cdFx0XHRcdFx0Zm5kaD10cnVlO1xyXG5cdFx0XHRcdFx0JCgkdCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRTaG93SGlkZUNvbFwiLCBbc3csdGhpcy5uYW1lLGldKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRpZihmbmRoPT09dHJ1ZSkge1xyXG5cdFx0XHRcdGlmKCR0LnAuc2hyaW5rVG9GaXQgPT09IHRydWUgJiYgIWlzTmFOKCR0LnAuaGVpZ2h0KSkgeyAkdC5wLnRibHdpZHRoICs9IHBhcnNlSW50KCR0LnAuc2Nyb2xsT2Zmc2V0LDEwKTt9XHJcblx0XHRcdFx0JCgkdCkuanFHcmlkKFwic2V0R3JpZFdpZHRoXCIsJHQucC5zaHJpbmtUb0ZpdCA9PT0gdHJ1ZSA/ICR0LnAudGJsd2lkdGggOiAkdC5wLndpZHRoICk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoIGdoICkgIHtcclxuXHRcdFx0XHQkKCR0KS5qcUdyaWQoJ3NldEdyb3VwSGVhZGVycycsJHQucC5ncm91cEhlYWRlcik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0aGlkZUNvbCA6IGZ1bmN0aW9uIChjb2xuYW1lKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7JCh0aGlzKS5qcUdyaWQoXCJzaG93SGlkZUNvbFwiLGNvbG5hbWUsXCJub25lXCIpO30pO1xyXG5cdH0sXHJcblx0c2hvd0NvbCA6IGZ1bmN0aW9uKGNvbG5hbWUpIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXskKHRoaXMpLmpxR3JpZChcInNob3dIaWRlQ29sXCIsY29sbmFtZSxcIlwiKTt9KTtcclxuXHR9LFxyXG5cdHJlbWFwQ29sdW1ucyA6IGZ1bmN0aW9uKHBlcm11dGF0aW9uLCB1cGRhdGVDZWxscywga2VlcEhlYWRlcilcclxuXHR7XHJcblx0XHRmdW5jdGlvbiByZXNvcnRBcnJheShhKSB7XHJcblx0XHRcdHZhciBhYztcclxuXHRcdFx0aWYgKGEubGVuZ3RoKSB7XHJcblx0XHRcdFx0YWMgPSAkLm1ha2VBcnJheShhKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRhYyA9ICQuZXh0ZW5kKHt9LCBhKTtcclxuXHRcdFx0fVxyXG5cdFx0XHQkLmVhY2gocGVybXV0YXRpb24sIGZ1bmN0aW9uKGkpIHtcclxuXHRcdFx0XHRhW2ldID0gYWNbdGhpc107XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdFx0dmFyIHRzID0gdGhpcy5nZXQoMCk7XHJcblx0XHRmdW5jdGlvbiByZXNvcnRSb3dzKHBhcmVudCwgY2xvYmopIHtcclxuXHRcdFx0JChcIj50clwiKyhjbG9ianx8XCJcIiksIHBhcmVudCkuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR2YXIgcm93ID0gdGhpcztcclxuXHRcdFx0XHR2YXIgZWxlbXMgPSAkLm1ha2VBcnJheShyb3cuY2VsbHMpO1xyXG5cdFx0XHRcdCQuZWFjaChwZXJtdXRhdGlvbiwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgZSA9IGVsZW1zW3RoaXNdO1xyXG5cdFx0XHRcdFx0aWYgKGUpIHtcclxuXHRcdFx0XHRcdFx0cm93LmFwcGVuZENoaWxkKGUpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHRcdHJlc29ydEFycmF5KHRzLnAuY29sTW9kZWwpO1xyXG5cdFx0cmVzb3J0QXJyYXkodHMucC5jb2xOYW1lcyk7XHJcblx0XHRyZXNvcnRBcnJheSh0cy5ncmlkLmhlYWRlcnMpO1xyXG5cdFx0cmVzb3J0Um93cygkKFwidGhlYWQ6Zmlyc3RcIiwgdHMuZ3JpZC5oRGl2KSwga2VlcEhlYWRlciAmJiBcIjpub3QoLnVpLWpxZ3JpZC1sYWJlbHMpXCIpO1xyXG5cdFx0aWYgKHVwZGF0ZUNlbGxzKSB7XHJcblx0XHRcdHJlc29ydFJvd3MoJChcIiNcIiskLmpncmlkLmpxSUQodHMucC5pZCkrXCIgdGJvZHk6Zmlyc3RcIiksIFwiLmpxZ2ZpcnN0cm93LCB0ci5qcWdyb3csIHRyLmpxZm9vdFwiKTtcclxuXHRcdH1cclxuXHRcdGlmICh0cy5wLmZvb3RlcnJvdykge1xyXG5cdFx0XHRyZXNvcnRSb3dzKCQoXCJ0Ym9keTpmaXJzdFwiLCB0cy5ncmlkLnNEaXYpKTtcclxuXHRcdH1cclxuXHRcdGlmICh0cy5wLnJlbWFwQ29sdW1ucykge1xyXG5cdFx0XHRpZiAoIXRzLnAucmVtYXBDb2x1bW5zLmxlbmd0aCl7XHJcblx0XHRcdFx0dHMucC5yZW1hcENvbHVtbnMgPSAkLm1ha2VBcnJheShwZXJtdXRhdGlvbik7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cmVzb3J0QXJyYXkodHMucC5yZW1hcENvbHVtbnMpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHR0cy5wLmxhc3Rzb3J0ID0gJC5pbkFycmF5KHRzLnAubGFzdHNvcnQsIHBlcm11dGF0aW9uKTtcclxuXHRcdGlmKHRzLnAudHJlZUdyaWQpIHsgdHMucC5leHBDb2xJbmQgPSAkLmluQXJyYXkodHMucC5leHBDb2xJbmQsIHBlcm11dGF0aW9uKTsgfVxyXG5cdFx0JCh0cykudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRSZW1hcENvbHVtbnNcIiwgW3Blcm11dGF0aW9uLCB1cGRhdGVDZWxscywga2VlcEhlYWRlcl0pO1xyXG5cdH0sXHJcblx0c2V0R3JpZFdpZHRoIDogZnVuY3Rpb24obndpZHRoLCBzaHJpbmspIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0aWYgKCF0aGlzLmdyaWQgKSB7cmV0dXJuO31cclxuXHRcdFx0dmFyICR0ID0gdGhpcywgY3csXHJcblx0XHRcdGluaXR3aWR0aCA9IDAsIGJyZD0kLmpncmlkLmNlbGxfd2lkdGggPyAwOiAkdC5wLmNlbGxMYXlvdXQsIGx2YywgdmM9MCwgaHM9ZmFsc2UsIHNjdz0kdC5wLnNjcm9sbE9mZnNldCwgYXcsIGd3PTAsIGNyO1xyXG5cdFx0XHRpZih0eXBlb2Ygc2hyaW5rICE9PSAnYm9vbGVhbicpIHtcclxuXHRcdFx0XHRzaHJpbms9JHQucC5zaHJpbmtUb0ZpdDtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZihpc05hTihud2lkdGgpKSB7cmV0dXJuO31cclxuXHRcdFx0bndpZHRoID0gcGFyc2VJbnQobndpZHRoLDEwKTtcclxuXHRcdFx0JHQuZ3JpZC53aWR0aCA9ICR0LnAud2lkdGggPSBud2lkdGg7XHJcblx0XHRcdCQoXCIjZ2JveF9cIiskLmpncmlkLmpxSUQoJHQucC5pZCkpLmNzcyhcIndpZHRoXCIsbndpZHRoK1wicHhcIik7XHJcblx0XHRcdCQoXCIjZ3ZpZXdfXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpKS5jc3MoXCJ3aWR0aFwiLG53aWR0aCtcInB4XCIpO1xyXG5cdFx0XHQkKCR0LmdyaWQuYkRpdikuY3NzKFwid2lkdGhcIixud2lkdGgrXCJweFwiKTtcclxuXHRcdFx0JCgkdC5ncmlkLmhEaXYpLmNzcyhcIndpZHRoXCIsbndpZHRoK1wicHhcIik7XHJcblx0XHRcdGlmKCR0LnAucGFnZXIgKSB7JCgkdC5wLnBhZ2VyKS5jc3MoXCJ3aWR0aFwiLG53aWR0aCtcInB4XCIpO31cclxuXHRcdFx0aWYoJHQucC50b3BwYWdlciApIHskKCR0LnAudG9wcGFnZXIpLmNzcyhcIndpZHRoXCIsbndpZHRoK1wicHhcIik7fVxyXG5cdFx0XHRpZigkdC5wLnRvb2xiYXJbMF0gPT09IHRydWUpe1xyXG5cdFx0XHRcdCQoJHQuZ3JpZC51RGl2KS5jc3MoXCJ3aWR0aFwiLG53aWR0aCtcInB4XCIpO1xyXG5cdFx0XHRcdGlmKCR0LnAudG9vbGJhclsxXT09PVwiYm90aFwiKSB7JCgkdC5ncmlkLnViRGl2KS5jc3MoXCJ3aWR0aFwiLG53aWR0aCtcInB4XCIpO31cclxuXHRcdFx0fVxyXG5cdFx0XHRpZigkdC5wLmZvb3RlcnJvdykgeyAkKCR0LmdyaWQuc0RpdikuY3NzKFwid2lkdGhcIixud2lkdGgrXCJweFwiKTsgfVxyXG5cdFx0XHRpZihzaHJpbmsgPT09ZmFsc2UgJiYgJHQucC5mb3JjZUZpdCA9PT0gdHJ1ZSkgeyR0LnAuZm9yY2VGaXQ9ZmFsc2U7fVxyXG5cdFx0XHRpZihzaHJpbms9PT10cnVlKSB7XHJcblx0XHRcdFx0JC5lYWNoKCR0LnAuY29sTW9kZWwsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0aWYodGhpcy5oaWRkZW49PT1mYWxzZSl7XHJcblx0XHRcdFx0XHRcdGN3ID0gdGhpcy53aWR0aE9yZztcclxuXHRcdFx0XHRcdFx0aW5pdHdpZHRoICs9IGN3K2JyZDtcclxuXHRcdFx0XHRcdFx0aWYodGhpcy5maXhlZCkge1xyXG5cdFx0XHRcdFx0XHRcdGd3ICs9IGN3K2JyZDtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHR2YysrO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aWYodmMgID09PSAwKSB7IHJldHVybjsgfVxyXG5cdFx0XHRcdCR0LnAudGJsd2lkdGggPSBpbml0d2lkdGg7XHJcblx0XHRcdFx0YXcgPSBud2lkdGgtYnJkKnZjLWd3O1xyXG5cdFx0XHRcdGlmKCFpc05hTigkdC5wLmhlaWdodCkpIHtcclxuXHRcdFx0XHRcdGlmKCQoJHQuZ3JpZC5iRGl2KVswXS5jbGllbnRIZWlnaHQgPCAkKCR0LmdyaWQuYkRpdilbMF0uc2Nyb2xsSGVpZ2h0IHx8ICR0LnJvd3MubGVuZ3RoID09PSAxKXtcclxuXHRcdFx0XHRcdFx0aHMgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRhdyAtPSBzY3c7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGluaXR3aWR0aCA9MDtcclxuXHRcdFx0XHR2YXIgY2xlID0gJHQuZ3JpZC5jb2xzLmxlbmd0aCA+MDtcclxuXHRcdFx0XHQkLmVhY2goJHQucC5jb2xNb2RlbCwgZnVuY3Rpb24oaSkge1xyXG5cdFx0XHRcdFx0aWYodGhpcy5oaWRkZW4gPT09IGZhbHNlICYmICF0aGlzLmZpeGVkKXtcclxuXHRcdFx0XHRcdFx0Y3cgPSB0aGlzLndpZHRoT3JnO1xyXG5cdFx0XHRcdFx0XHRjdyA9IE1hdGgucm91bmQoYXcqY3cvKCR0LnAudGJsd2lkdGgtYnJkKnZjLWd3KSk7XHJcblx0XHRcdFx0XHRcdGlmIChjdyA8IDApIHsgcmV0dXJuOyB9XHJcblx0XHRcdFx0XHRcdHRoaXMud2lkdGggPWN3O1xyXG5cdFx0XHRcdFx0XHRpbml0d2lkdGggKz0gY3c7XHJcblx0XHRcdFx0XHRcdCR0LmdyaWQuaGVhZGVyc1tpXS53aWR0aD1jdztcclxuXHRcdFx0XHRcdFx0JHQuZ3JpZC5oZWFkZXJzW2ldLmVsLnN0eWxlLndpZHRoPWN3K1wicHhcIjtcclxuXHRcdFx0XHRcdFx0aWYoJHQucC5mb290ZXJyb3cpIHsgJHQuZ3JpZC5mb290ZXJzW2ldLnN0eWxlLndpZHRoID0gY3crXCJweFwiOyB9XHJcblx0XHRcdFx0XHRcdGlmKGNsZSkgeyAkdC5ncmlkLmNvbHNbaV0uc3R5bGUud2lkdGggPSBjdytcInB4XCI7IH1cclxuXHRcdFx0XHRcdFx0bHZjID0gaTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0aWYgKCFsdmMpIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0XHRcdGNyID0wO1xyXG5cdFx0XHRcdGlmIChocykge1xyXG5cdFx0XHRcdFx0aWYobndpZHRoLWd3LShpbml0d2lkdGgrYnJkKnZjKSAhPT0gc2N3KXtcclxuXHRcdFx0XHRcdFx0Y3IgPSBud2lkdGgtZ3ctKGluaXR3aWR0aCticmQqdmMpLXNjdztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGVsc2UgaWYoIE1hdGguYWJzKG53aWR0aC1ndy0oaW5pdHdpZHRoK2JyZCp2YykpICE9PSAxKSB7XHJcblx0XHRcdFx0XHRjciA9IG53aWR0aC1ndy0oaW5pdHdpZHRoK2JyZCp2Yyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCR0LnAuY29sTW9kZWxbbHZjXS53aWR0aCArPSBjcjtcclxuXHRcdFx0XHQkdC5wLnRibHdpZHRoID0gaW5pdHdpZHRoK2NyK2JyZCp2YytndztcclxuXHRcdFx0XHRpZigkdC5wLnRibHdpZHRoID4gbndpZHRoKSB7XHJcblx0XHRcdFx0XHR2YXIgZGVsdGEgPSAkdC5wLnRibHdpZHRoIC0gcGFyc2VJbnQobndpZHRoLDEwKTtcclxuXHRcdFx0XHRcdCR0LnAudGJsd2lkdGggPSBud2lkdGg7XHJcblx0XHRcdFx0XHRjdyA9ICR0LnAuY29sTW9kZWxbbHZjXS53aWR0aCA9ICR0LnAuY29sTW9kZWxbbHZjXS53aWR0aC1kZWx0YTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0Y3c9ICR0LnAuY29sTW9kZWxbbHZjXS53aWR0aDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JHQuZ3JpZC5oZWFkZXJzW2x2Y10ud2lkdGggPSBjdztcclxuXHRcdFx0XHQkdC5ncmlkLmhlYWRlcnNbbHZjXS5lbC5zdHlsZS53aWR0aD1jdytcInB4XCI7XHJcblx0XHRcdFx0aWYoY2xlKSB7ICR0LmdyaWQuY29sc1tsdmNdLnN0eWxlLndpZHRoID0gY3crXCJweFwiOyB9XHJcblx0XHRcdFx0aWYoJHQucC5mb290ZXJyb3cpIHtcclxuXHRcdFx0XHRcdCR0LmdyaWQuZm9vdGVyc1tsdmNdLnN0eWxlLndpZHRoID0gY3crXCJweFwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRpZigkdC5wLnRibHdpZHRoKSB7XHJcblx0XHRcdFx0JCgndGFibGU6Zmlyc3QnLCR0LmdyaWQuYkRpdikuY3NzKFwid2lkdGhcIiwkdC5wLnRibHdpZHRoK1wicHhcIik7XHJcblx0XHRcdFx0JCgndGFibGU6Zmlyc3QnLCR0LmdyaWQuaERpdikuY3NzKFwid2lkdGhcIiwkdC5wLnRibHdpZHRoK1wicHhcIik7XHJcblx0XHRcdFx0JHQuZ3JpZC5oRGl2LnNjcm9sbExlZnQgPSAkdC5ncmlkLmJEaXYuc2Nyb2xsTGVmdDtcclxuXHRcdFx0XHRpZigkdC5wLmZvb3RlcnJvdykge1xyXG5cdFx0XHRcdFx0JCgndGFibGU6Zmlyc3QnLCR0LmdyaWQuc0RpdikuY3NzKFwid2lkdGhcIiwkdC5wLnRibHdpZHRoK1wicHhcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdHNldEdyaWRIZWlnaHQgOiBmdW5jdGlvbiAobmgpIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCl7XHJcblx0XHRcdHZhciAkdCA9IHRoaXM7XHJcblx0XHRcdGlmKCEkdC5ncmlkKSB7cmV0dXJuO31cclxuXHRcdFx0dmFyIGJEaXYgPSAkKCR0LmdyaWQuYkRpdik7XHJcblx0XHRcdGJEaXYuY3NzKHtoZWlnaHQ6IG5oKyhpc05hTihuaCk/XCJcIjpcInB4XCIpfSk7XHJcblx0XHRcdGlmKCR0LnAuZnJvemVuQ29sdW1ucyA9PT0gdHJ1ZSl7XHJcblx0XHRcdFx0Ly9mb2xsb3cgdGhlIG9yaWdpbmFsIHNldCBoZWlnaHQgdG8gdXNlIDE2LCBiZXR0ZXIgc2Nyb2xsYmFyIHdpZHRoIGRldGVjdGlvblxyXG5cdFx0XHRcdCQoJyMnKyQuamdyaWQuanFJRCgkdC5wLmlkKStcIl9mcm96ZW5cIikucGFyZW50KCkuaGVpZ2h0KGJEaXYuaGVpZ2h0KCkgLSAxNik7XHJcblx0XHRcdH1cclxuXHRcdFx0JHQucC5oZWlnaHQgPSBuaDtcclxuXHRcdFx0aWYgKCR0LnAuc2Nyb2xsKSB7ICR0LmdyaWQucG9wdWxhdGVWaXNpYmxlKCk7IH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0c2V0Q2FwdGlvbiA6IGZ1bmN0aW9uIChuZXdjYXApe1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR0aGlzLnAuY2FwdGlvbj1uZXdjYXA7XHJcblx0XHRcdCQoXCJzcGFuLnVpLWpxZ3JpZC10aXRsZSwgc3Bhbi51aS1qcWdyaWQtdGl0bGUtcnRsXCIsdGhpcy5ncmlkLmNEaXYpLmh0bWwobmV3Y2FwKTtcclxuXHRcdFx0JCh0aGlzLmdyaWQuY0Rpdikuc2hvdygpO1xyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRzZXRMYWJlbCA6IGZ1bmN0aW9uKGNvbG5hbWUsIG5EYXRhLCBwcm9wLCBhdHRycCApe1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzLCBwb3M9LTE7XHJcblx0XHRcdGlmKCEkdC5ncmlkKSB7cmV0dXJuO31cclxuXHRcdFx0aWYoY29sbmFtZSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0JCgkdC5wLmNvbE1vZGVsKS5lYWNoKGZ1bmN0aW9uKGkpe1xyXG5cdFx0XHRcdFx0aWYgKHRoaXMubmFtZSA9PT0gY29sbmFtZSkge1xyXG5cdFx0XHRcdFx0XHRwb3MgPSBpO3JldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBlbHNlIHsgcmV0dXJuOyB9XHJcblx0XHRcdGlmKHBvcz49MCkge1xyXG5cdFx0XHRcdHZhciB0aGVjb2wgPSAkKFwidHIudWktanFncmlkLWxhYmVscyB0aDplcShcIitwb3MrXCIpXCIsJHQuZ3JpZC5oRGl2KTtcclxuXHRcdFx0XHRpZiAobkRhdGEpe1xyXG5cdFx0XHRcdFx0dmFyIGljbyA9ICQoXCIucy1pY29cIix0aGVjb2wpO1xyXG5cdFx0XHRcdFx0JChcIltpZF49anFnaF9dXCIsdGhlY29sKS5lbXB0eSgpLmh0bWwobkRhdGEpLmFwcGVuZChpY28pO1xyXG5cdFx0XHRcdFx0JHQucC5jb2xOYW1lc1twb3NdID0gbkRhdGE7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmIChwcm9wKSB7XHJcblx0XHRcdFx0XHRpZih0eXBlb2YgcHJvcCA9PT0gJ3N0cmluZycpIHskKHRoZWNvbCkuYWRkQ2xhc3MocHJvcCk7fSBlbHNlIHskKHRoZWNvbCkuY3NzKHByb3ApO31cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYodHlwZW9mIGF0dHJwID09PSAnb2JqZWN0JykgeyQodGhlY29sKS5hdHRyKGF0dHJwKTt9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0c2V0Q2VsbCA6IGZ1bmN0aW9uKHJvd2lkLGNvbG5hbWUsbkRhdGEsY3NzcCxhdHRycCwgZm9yY2V1cGQpIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyICR0ID0gdGhpcywgcG9zID0tMSx2LCB0aXRsZTtcclxuXHRcdFx0aWYoISR0LmdyaWQpIHtyZXR1cm47fVxyXG5cdFx0XHRpZihpc05hTihjb2xuYW1lKSkge1xyXG5cdFx0XHRcdCQoJHQucC5jb2xNb2RlbCkuZWFjaChmdW5jdGlvbihpKXtcclxuXHRcdFx0XHRcdGlmICh0aGlzLm5hbWUgPT09IGNvbG5hbWUpIHtcclxuXHRcdFx0XHRcdFx0cG9zID0gaTtyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gZWxzZSB7cG9zID0gcGFyc2VJbnQoY29sbmFtZSwxMCk7fVxyXG5cdFx0XHRpZihwb3M+PTApIHtcclxuXHRcdFx0XHR2YXIgaW5kID0gJCgkdCkuanFHcmlkKCdnZXRHcmlkUm93QnlJZCcsIHJvd2lkKTtcclxuXHRcdFx0XHRpZiAoaW5kKXtcclxuXHRcdFx0XHRcdHZhciB0Y2VsbCA9ICQoXCJ0ZDplcShcIitwb3MrXCIpXCIsaW5kKTtcclxuXHRcdFx0XHRcdGlmKG5EYXRhICE9PSBcIlwiIHx8IGZvcmNldXBkID09PSB0cnVlKSB7XHJcblx0XHRcdFx0XHRcdHYgPSAkdC5mb3JtYXR0ZXIocm93aWQsIG5EYXRhLCBwb3MsaW5kLCdlZGl0Jyk7XHJcblx0XHRcdFx0XHRcdHRpdGxlID0gJHQucC5jb2xNb2RlbFtwb3NdLnRpdGxlID8ge1widGl0bGVcIjokLmpncmlkLnN0cmlwSHRtbCh2KX0gOiB7fTtcclxuXHRcdFx0XHRcdFx0aWYoJHQucC50cmVlR3JpZCAmJiAkKFwiLnRyZWUtd3JhcFwiLCQodGNlbGwpKS5sZW5ndGg+MCkge1xyXG5cdFx0XHRcdFx0XHRcdCQoXCJzcGFuXCIsJCh0Y2VsbCkpLmh0bWwodikuYXR0cih0aXRsZSk7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0JCh0Y2VsbCkuaHRtbCh2KS5hdHRyKHRpdGxlKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZigkdC5wLmRhdGF0eXBlID09PSBcImxvY2FsXCIpIHtcclxuXHRcdFx0XHRcdFx0XHR2YXIgY20gPSAkdC5wLmNvbE1vZGVsW3Bvc10sIGluZGV4O1xyXG5cdFx0XHRcdFx0XHRcdG5EYXRhID0gY20uZm9ybWF0dGVyICYmIHR5cGVvZiBjbS5mb3JtYXR0ZXIgPT09ICdzdHJpbmcnICYmIGNtLmZvcm1hdHRlciA9PT0gJ2RhdGUnID8gJC51bmZvcm1hdC5kYXRlLmNhbGwoJHQsbkRhdGEsY20pIDogbkRhdGE7XHJcblx0XHRcdFx0XHRcdFx0aW5kZXggPSAkdC5wLl9pbmRleFskLmpncmlkLnN0cmlwUHJlZigkdC5wLmlkUHJlZml4LCByb3dpZCldO1xyXG5cdFx0XHRcdFx0XHRcdGlmKGluZGV4ICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdCR0LnAuZGF0YVtpbmRleF1bY20ubmFtZV0gPSBuRGF0YTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKHR5cGVvZiBjc3NwID09PSAnc3RyaW5nJyl7XHJcblx0XHRcdFx0XHRcdCQodGNlbGwpLmFkZENsYXNzKGNzc3ApO1xyXG5cdFx0XHRcdFx0fSBlbHNlIGlmKGNzc3ApIHtcclxuXHRcdFx0XHRcdFx0JCh0Y2VsbCkuY3NzKGNzc3ApO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYodHlwZW9mIGF0dHJwID09PSAnb2JqZWN0JykgeyQodGNlbGwpLmF0dHIoYXR0cnApO31cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0Z2V0Q2VsbCA6IGZ1bmN0aW9uKHJvd2lkLGNvbCkge1xyXG5cdFx0dmFyIHJldCA9IGZhbHNlO1xyXG5cdFx0dGhpcy5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdHZhciAkdD10aGlzLCBwb3M9LTE7XHJcblx0XHRcdGlmKCEkdC5ncmlkKSB7cmV0dXJuO31cclxuXHRcdFx0aWYoaXNOYU4oY29sKSkge1xyXG5cdFx0XHRcdCQoJHQucC5jb2xNb2RlbCkuZWFjaChmdW5jdGlvbihpKXtcclxuXHRcdFx0XHRcdGlmICh0aGlzLm5hbWUgPT09IGNvbCkge1xyXG5cdFx0XHRcdFx0XHRwb3MgPSBpO3JldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBlbHNlIHtwb3MgPSBwYXJzZUludChjb2wsMTApO31cclxuXHRcdFx0aWYocG9zPj0wKSB7XHJcblx0XHRcdFx0dmFyIGluZCA9ICQoJHQpLmpxR3JpZCgnZ2V0R3JpZFJvd0J5SWQnLCByb3dpZCk7XHJcblx0XHRcdFx0aWYoaW5kKSB7XHJcblx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRyZXQgPSAkLnVuZm9ybWF0LmNhbGwoJHQsJChcInRkOmVxKFwiK3BvcytcIilcIixpbmQpLHtyb3dJZDppbmQuaWQsIGNvbE1vZGVsOiR0LnAuY29sTW9kZWxbcG9zXX0scG9zKTtcclxuXHRcdFx0XHRcdH0gY2F0Y2ggKGUpe1xyXG5cdFx0XHRcdFx0XHRyZXQgPSAkLmpncmlkLmh0bWxEZWNvZGUoJChcInRkOmVxKFwiK3BvcytcIilcIixpbmQpLmh0bWwoKSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdHJldHVybiByZXQ7XHJcblx0fSxcclxuXHRnZXRDb2wgOiBmdW5jdGlvbiAoY29sLCBvYmosIG1hdGhvcHIpIHtcclxuXHRcdHZhciByZXQgPSBbXSwgdmFsLCBzdW09MCwgbWluLCBtYXgsIHY7XHJcblx0XHRvYmogPSB0eXBlb2Ygb2JqICE9PSAnYm9vbGVhbicgPyBmYWxzZSA6IG9iajtcclxuXHRcdGlmKG1hdGhvcHIgPT09IHVuZGVmaW5lZCkgeyBtYXRob3ByID0gZmFsc2U7IH1cclxuXHRcdHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQ9dGhpcywgcG9zPS0xO1xyXG5cdFx0XHRpZighJHQuZ3JpZCkge3JldHVybjt9XHJcblx0XHRcdGlmKGlzTmFOKGNvbCkpIHtcclxuXHRcdFx0XHQkKCR0LnAuY29sTW9kZWwpLmVhY2goZnVuY3Rpb24oaSl7XHJcblx0XHRcdFx0XHRpZiAodGhpcy5uYW1lID09PSBjb2wpIHtcclxuXHRcdFx0XHRcdFx0cG9zID0gaTtyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gZWxzZSB7cG9zID0gcGFyc2VJbnQoY29sLDEwKTt9XHJcblx0XHRcdGlmKHBvcz49MCkge1xyXG5cdFx0XHRcdHZhciBsbiA9ICR0LnJvd3MubGVuZ3RoLCBpID0wLCBkbGVuPTA7XHJcblx0XHRcdFx0aWYgKGxuICYmIGxuPjApe1xyXG5cdFx0XHRcdFx0d2hpbGUoaTxsbil7XHJcblx0XHRcdFx0XHRcdGlmKCQoJHQucm93c1tpXSkuaGFzQ2xhc3MoJ2pxZ3JvdycpKSB7XHJcblx0XHRcdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0XHRcdHZhbCA9ICQudW5mb3JtYXQuY2FsbCgkdCwkKCR0LnJvd3NbaV0uY2VsbHNbcG9zXSkse3Jvd0lkOiR0LnJvd3NbaV0uaWQsIGNvbE1vZGVsOiR0LnAuY29sTW9kZWxbcG9zXX0scG9zKTtcclxuXHRcdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR2YWwgPSAkLmpncmlkLmh0bWxEZWNvZGUoJHQucm93c1tpXS5jZWxsc1twb3NdLmlubmVySFRNTCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdGlmKG1hdGhvcHIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHYgPSBwYXJzZUZsb2F0KHZhbCk7XHJcblx0XHRcdFx0XHRcdFx0XHRpZighaXNOYU4odikpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c3VtICs9IHY7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChtYXggPT09IHVuZGVmaW5lZCkge21heCA9IG1pbiA9IHY7fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRtaW4gPSBNYXRoLm1pbihtaW4sIHYpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRtYXggPSBNYXRoLm1heChtYXgsIHYpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkbGVuKys7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdGVsc2UgaWYob2JqKSB7IHJldC5wdXNoKCB7aWQ6JHQucm93c1tpXS5pZCx2YWx1ZTp2YWx9ICk7IH1cclxuXHRcdFx0XHRcdFx0XHRlbHNlIHsgcmV0LnB1c2goIHZhbCApOyB9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aSsrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYobWF0aG9wcikge1xyXG5cdFx0XHRcdFx0XHRzd2l0Y2gobWF0aG9wci50b0xvd2VyQ2FzZSgpKXtcclxuXHRcdFx0XHRcdFx0XHRjYXNlICdzdW0nOiByZXQgPXN1bTsgYnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0Y2FzZSAnYXZnJzogcmV0ID0gc3VtL2RsZW47IGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdGNhc2UgJ2NvdW50JzogcmV0ID0gKGxuLTEpOyBicmVhaztcclxuXHRcdFx0XHRcdFx0XHRjYXNlICdtaW4nOiByZXQgPSBtaW47IGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdGNhc2UgJ21heCc6IHJldCA9IG1heDsgYnJlYWs7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0cmV0dXJuIHJldDtcclxuXHR9LFxyXG5cdGNsZWFyR3JpZERhdGEgOiBmdW5jdGlvbihjbGVhcmZvb3Rlcikge1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzO1xyXG5cdFx0XHRpZighJHQuZ3JpZCkge3JldHVybjt9XHJcblx0XHRcdGlmKHR5cGVvZiBjbGVhcmZvb3RlciAhPT0gJ2Jvb2xlYW4nKSB7IGNsZWFyZm9vdGVyID0gZmFsc2U7IH1cclxuXHRcdFx0aWYoJHQucC5kZWVwZW1wdHkpIHskKFwiI1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKStcIiB0Ym9keTpmaXJzdCB0cjpndCgwKVwiKS5yZW1vdmUoKTt9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdHZhciB0cmYgPSAkKFwiI1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKStcIiB0Ym9keTpmaXJzdCB0cjpmaXJzdFwiKVswXTtcclxuXHRcdFx0XHQkKFwiI1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKStcIiB0Ym9keTpmaXJzdFwiKS5lbXB0eSgpLmFwcGVuZCh0cmYpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKCR0LnAuZm9vdGVycm93ICYmIGNsZWFyZm9vdGVyKSB7ICQoXCIudWktanFncmlkLWZ0YWJsZSB0ZFwiLCR0LmdyaWQuc0RpdikuaHRtbChcIiYjMTYwO1wiKTsgfVxyXG5cdFx0XHQkdC5wLnNlbHJvdyA9IG51bGw7ICR0LnAuc2VsYXJycm93PSBbXTsgJHQucC5zYXZlZFJvdyA9IFtdO1xyXG5cdFx0XHQkdC5wLnJlY29yZHMgPSAwOyR0LnAucGFnZT0xOyR0LnAubGFzdHBhZ2U9MDskdC5wLnJlY2NvdW50PTA7XHJcblx0XHRcdCR0LnAuZGF0YSA9IFtdOyAkdC5wLl9pbmRleCA9IHt9O1xyXG5cdFx0XHQkdC51cGRhdGVwYWdlcih0cnVlLGZhbHNlKTtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0Z2V0SW5kIDogZnVuY3Rpb24ocm93aWQscmMpe1xyXG5cdFx0dmFyIHJldCA9ZmFsc2Uscnc7XHJcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0cncgPSAkKHRoaXMpLmpxR3JpZCgnZ2V0R3JpZFJvd0J5SWQnLCByb3dpZCk7XHJcblx0XHRcdGlmKHJ3KSB7XHJcblx0XHRcdFx0cmV0ID0gcmM9PT10cnVlID8gcnc6IHJ3LnJvd0luZGV4O1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdHJldHVybiByZXQ7XHJcblx0fSxcclxuXHRiaW5kS2V5cyA6IGZ1bmN0aW9uKCBzZXR0aW5ncyApe1xyXG5cdFx0dmFyIG8gPSAkLmV4dGVuZCh7XHJcblx0XHRcdG9uRW50ZXI6IG51bGwsXHJcblx0XHRcdG9uU3BhY2U6IG51bGwsXHJcblx0XHRcdG9uTGVmdEtleTogbnVsbCxcclxuXHRcdFx0b25SaWdodEtleTogbnVsbCxcclxuXHRcdFx0c2Nyb2xsaW5nUm93cyA6IHRydWVcclxuXHRcdH0sc2V0dGluZ3MgfHwge30pO1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzO1xyXG5cdFx0XHRpZiggISQoJ2JvZHknKS5pcygnW3JvbGVdJykgKXskKCdib2R5JykuYXR0cigncm9sZScsJ2FwcGxpY2F0aW9uJyk7fVxyXG5cdFx0XHQkdC5wLnNjcm9sbHJvd3MgPSBvLnNjcm9sbGluZ1Jvd3M7XHJcblx0XHRcdCQoJHQpLmtleWRvd24oZnVuY3Rpb24oZXZlbnQpe1xyXG5cdFx0XHRcdHZhciB0YXJnZXQgPSAkKCR0KS5maW5kKCd0clt0YWJpbmRleD0wXScpWzBdLCBpZCwgciwgbWluZCxcclxuXHRcdFx0XHRleHBhbmRlZCA9ICR0LnAudHJlZVJlYWRlci5leHBhbmRlZF9maWVsZDtcclxuXHRcdFx0XHQvL2NoZWNrIGZvciBhcnJvdyBrZXlzXHJcblx0XHRcdFx0aWYodGFyZ2V0KSB7XHJcblx0XHRcdFx0XHRtaW5kID0gJHQucC5faW5kZXhbJC5qZ3JpZC5zdHJpcFByZWYoJHQucC5pZFByZWZpeCwgdGFyZ2V0LmlkKV07XHJcblx0XHRcdFx0XHRpZihldmVudC5rZXlDb2RlID09PSAzNyB8fCBldmVudC5rZXlDb2RlID09PSAzOCB8fCBldmVudC5rZXlDb2RlID09PSAzOSB8fCBldmVudC5rZXlDb2RlID09PSA0MCl7XHJcblx0XHRcdFx0XHRcdC8vIHVwIGtleVxyXG5cdFx0XHRcdFx0XHRpZihldmVudC5rZXlDb2RlID09PSAzOCApe1xyXG5cdFx0XHRcdFx0XHRcdHIgPSB0YXJnZXQucHJldmlvdXNTaWJsaW5nO1xyXG5cdFx0XHRcdFx0XHRcdGlkID0gXCJcIjtcclxuXHRcdFx0XHRcdFx0XHRpZihyKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRpZigkKHIpLmlzKFwiOmhpZGRlblwiKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR3aGlsZShyKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0ciA9IHIucHJldmlvdXNTaWJsaW5nO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCEkKHIpLmlzKFwiOmhpZGRlblwiKSAmJiAkKHIpLmhhc0NsYXNzKCdqcWdyb3cnKSkge2lkID0gci5pZDticmVhazt9XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlkID0gci5pZDtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKCdzZXRTZWxlY3Rpb24nLCBpZCwgdHJ1ZSwgZXZlbnQpO1xyXG5cdFx0XHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0Ly9pZiBrZXkgaXMgZG93biBhcnJvd1xyXG5cdFx0XHRcdFx0XHRpZihldmVudC5rZXlDb2RlID09PSA0MCl7XHJcblx0XHRcdFx0XHRcdFx0ciA9IHRhcmdldC5uZXh0U2libGluZztcclxuXHRcdFx0XHRcdFx0XHRpZCA9XCJcIjtcclxuXHRcdFx0XHRcdFx0XHRpZihyKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRpZigkKHIpLmlzKFwiOmhpZGRlblwiKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR3aGlsZShyKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0ciA9IHIubmV4dFNpYmxpbmc7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoISQocikuaXMoXCI6aGlkZGVuXCIpICYmICQocikuaGFzQ2xhc3MoJ2pxZ3JvdycpICkge2lkID0gci5pZDticmVhazt9XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlkID0gci5pZDtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKCdzZXRTZWxlY3Rpb24nLCBpZCwgdHJ1ZSwgZXZlbnQpO1xyXG5cdFx0XHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0Ly8gbGVmdFxyXG5cdFx0XHRcdFx0XHRpZihldmVudC5rZXlDb2RlID09PSAzNyApe1xyXG5cdFx0XHRcdFx0XHRcdGlmKCR0LnAudHJlZUdyaWQgJiYgJHQucC5kYXRhW21pbmRdW2V4cGFuZGVkXSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCh0YXJnZXQpLmZpbmQoXCJkaXYudHJlZWNsaWNrXCIpLnRyaWdnZXIoJ2NsaWNrJyk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkS2V5TGVmdFwiLCBbJHQucC5zZWxyb3ddKTtcclxuXHRcdFx0XHRcdFx0XHRpZigkLmlzRnVuY3Rpb24oby5vbkxlZnRLZXkpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRvLm9uTGVmdEtleS5jYWxsKCR0LCAkdC5wLnNlbHJvdyk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdC8vIHJpZ2h0XHJcblx0XHRcdFx0XHRcdGlmKGV2ZW50LmtleUNvZGUgPT09IDM5ICl7XHJcblx0XHRcdFx0XHRcdFx0aWYoJHQucC50cmVlR3JpZCAmJiAhJHQucC5kYXRhW21pbmRdW2V4cGFuZGVkXSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCh0YXJnZXQpLmZpbmQoXCJkaXYudHJlZWNsaWNrXCIpLnRyaWdnZXIoJ2NsaWNrJyk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkS2V5UmlnaHRcIiwgWyR0LnAuc2Vscm93XSk7XHJcblx0XHRcdFx0XHRcdFx0aWYoJC5pc0Z1bmN0aW9uKG8ub25SaWdodEtleSkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdG8ub25SaWdodEtleS5jYWxsKCR0LCAkdC5wLnNlbHJvdyk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQvL2NoZWNrIGlmIGVudGVyIHdhcyBwcmVzc2VkIG9uIGEgZ3JpZCBvciB0cmVlZ3JpZCBub2RlXHJcblx0XHRcdFx0XHRlbHNlIGlmKCBldmVudC5rZXlDb2RlID09PSAxMyApe1xyXG5cdFx0XHRcdFx0XHQkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEtleUVudGVyXCIsIFskdC5wLnNlbHJvd10pO1xyXG5cdFx0XHRcdFx0XHRpZigkLmlzRnVuY3Rpb24oby5vbkVudGVyKSkge1xyXG5cdFx0XHRcdFx0XHRcdG8ub25FbnRlci5jYWxsKCR0LCAkdC5wLnNlbHJvdyk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0gZWxzZSBpZihldmVudC5rZXlDb2RlID09PSAzMikge1xyXG5cdFx0XHRcdFx0XHQkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEtleVNwYWNlXCIsIFskdC5wLnNlbHJvd10pO1xyXG5cdFx0XHRcdFx0XHRpZigkLmlzRnVuY3Rpb24oby5vblNwYWNlKSkge1xyXG5cdFx0XHRcdFx0XHRcdG8ub25TcGFjZS5jYWxsKCR0LCAkdC5wLnNlbHJvdyk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblx0fSxcclxuXHR1bmJpbmRLZXlzIDogZnVuY3Rpb24oKXtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0JCh0aGlzKS51bmJpbmQoJ2tleWRvd24nKTtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0Z2V0TG9jYWxSb3cgOiBmdW5jdGlvbiAocm93aWQpIHtcclxuXHRcdHZhciByZXQgPSBmYWxzZSwgaW5kO1xyXG5cdFx0dGhpcy5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdGlmKHJvd2lkICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRpbmQgPSB0aGlzLnAuX2luZGV4WyQuamdyaWQuc3RyaXBQcmVmKHRoaXMucC5pZFByZWZpeCwgcm93aWQpXTtcclxuXHRcdFx0XHRpZihpbmQgPj0gMCApIHtcclxuXHRcdFx0XHRcdHJldCA9IHRoaXMucC5kYXRhW2luZF07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdHJldHVybiByZXQ7XHJcblx0fVxyXG59KTtcclxufSkoalF1ZXJ5KTtcclxuLypqc2hpbnQgZXFlcWVxOmZhbHNlICovXHJcbi8qZ2xvYmFsIGpRdWVyeSAqL1xyXG4oZnVuY3Rpb24oJCl7XHJcbi8qKlxyXG4gKiBqcUdyaWQgZXh0ZW5zaW9uIGZvciBjdXN0b20gbWV0aG9kc1xyXG4gKiBUb255IFRvbW92IHRvbnlAdHJpcmFuZC5jb21cclxuICogaHR0cDovL3RyaXJhbmQuY29tL2Jsb2cvXHJcbiAqXHJcbiAqIFdpbGRyYWlkIHdpbGRyYWlkQG1haWwucnVcclxuICogT2xlZyBLaXJpbGp1ayBvbGVnLmtpcmlsanVrQG9rLXNvZnQtZ21iaC5jb21cclxuICogRHVhbCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGFuZCBHUEwgbGljZW5zZXM6XHJcbiAqIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXHJcbiAqIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMi4wLmh0bWxcclxuKiovXHJcblwidXNlIHN0cmljdFwiO1xyXG4kLmpncmlkLmV4dGVuZCh7XHJcblx0Z2V0Q29sUHJvcCA6IGZ1bmN0aW9uKGNvbG5hbWUpe1xyXG5cdFx0dmFyIHJldCA9e30sICR0ID0gdGhpc1swXTtcclxuXHRcdGlmICggISR0LmdyaWQgKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cdFx0dmFyIGNNID0gJHQucC5jb2xNb2RlbCwgaTtcclxuXHRcdGZvciAoIGk9MDtpPGNNLmxlbmd0aDtpKysgKSB7XHJcblx0XHRcdGlmICggY01baV0ubmFtZSA9PT0gY29sbmFtZSApIHtcclxuXHRcdFx0XHRyZXQgPSBjTVtpXTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHJldDtcclxuXHR9LFxyXG5cdHNldENvbFByb3AgOiBmdW5jdGlvbihjb2xuYW1lLCBvYmope1xyXG5cdFx0Ly9kbyBub3Qgc2V0IHdpZHRoIHdpbGwgbm90IHdvcmtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0aWYgKCB0aGlzLmdyaWQgKSB7XHJcblx0XHRcdFx0aWYgKCBvYmogKSB7XHJcblx0XHRcdFx0XHR2YXIgY00gPSB0aGlzLnAuY29sTW9kZWwsIGk7XHJcblx0XHRcdFx0XHRmb3IgKCBpPTA7aTxjTS5sZW5ndGg7aSsrICkge1xyXG5cdFx0XHRcdFx0XHRpZiAoIGNNW2ldLm5hbWUgPT09IGNvbG5hbWUgKSB7XHJcblx0XHRcdFx0XHRcdFx0JC5leHRlbmQodHJ1ZSwgdGhpcy5wLmNvbE1vZGVsW2ldLG9iaik7XHJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0c29ydEdyaWQgOiBmdW5jdGlvbihjb2xuYW1lLHJlbG9hZCwgc29yKXtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyICR0PXRoaXMsaWR4PS0xLGksIHNvYmo9ZmFsc2U7XHJcblx0XHRcdGlmICggISR0LmdyaWQgKSB7IHJldHVybjt9XHJcblx0XHRcdGlmICggIWNvbG5hbWUgKSB7IGNvbG5hbWUgPSAkdC5wLnNvcnRuYW1lOyB9XHJcblx0XHRcdGZvciAoIGk9MDtpPCR0LnAuY29sTW9kZWwubGVuZ3RoO2krKyApIHtcclxuXHRcdFx0XHRpZiAoICR0LnAuY29sTW9kZWxbaV0uaW5kZXggPT09IGNvbG5hbWUgfHwgJHQucC5jb2xNb2RlbFtpXS5uYW1lID09PSBjb2xuYW1lICkge1xyXG5cdFx0XHRcdFx0aWR4ID0gaTtcclxuXHRcdFx0XHRcdGlmKCR0LnAuZnJvemVuQ29sdW1ucyA9PT0gdHJ1ZSAmJiAkdC5wLmNvbE1vZGVsW2ldLmZyb3plbiA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdFx0XHRzb2JqID0gJHQuZ3JpZC5maERpdi5maW5kKFwiI1wiICsgJHQucC5pZCArIFwiX1wiICsgY29sbmFtZSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKCBpZHggIT09IC0xICl7XHJcblx0XHRcdFx0dmFyIHNvcnQgPSAkdC5wLmNvbE1vZGVsW2lkeF0uc29ydGFibGU7XHJcblx0XHRcdFx0aWYoIXNvYmopIHtcclxuXHRcdFx0XHRcdHNvYmogPSAkdC5ncmlkLmhlYWRlcnNbaWR4XS5lbDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKCB0eXBlb2Ygc29ydCAhPT0gJ2Jvb2xlYW4nICkgeyBzb3J0ID0gIHRydWU7IH1cclxuXHRcdFx0XHRpZiAoIHR5cGVvZiByZWxvYWQgIT09J2Jvb2xlYW4nICkgeyByZWxvYWQgPSBmYWxzZTsgfVxyXG5cdFx0XHRcdGlmICggc29ydCApIHsgJHQuc29ydERhdGEoXCJqcWdoX1wiKyR0LnAuaWQrXCJfXCIgKyBjb2xuYW1lLCBpZHgsIHJlbG9hZCwgc29yLCBzb2JqKTsgfVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdGNsZWFyQmVmb3JlVW5sb2FkIDogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgZ3JpZCA9IHRoaXMuZ3JpZDtcclxuXHRcdFx0aWYgKCQuaXNGdW5jdGlvbihncmlkLmVtcHR5Um93cykpIHtcclxuXHRcdFx0XHRncmlkLmVtcHR5Um93cy5jYWxsKHRoaXMsIHRydWUsIHRydWUpOyAvLyB0aGlzIHdvcmsgcXVpY2sgZW5vdWdoIGFuZCByZWR1Y2UgdGhlIHNpemUgb2YgbWVtb3J5IGxlYWtzIGlmIHdlIGhhdmUgc29tZW9uZVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQkKGRvY3VtZW50KS51bmJpbmQoXCJtb3VzZXVwLmpxR3JpZFwiICsgdGhpcy5wLmlkICk7XHJcblx0XHRcdCQoZ3JpZC5oRGl2KS51bmJpbmQoXCJtb3VzZW1vdmVcIik7IC8vIFRPRE8gYWRkIG5hbWVzcGFjZVxyXG5cdFx0XHQkKHRoaXMpLnVuYmluZCgpO1xyXG5cclxuXHRcdFx0Z3JpZC5kcmFnRW5kID0gbnVsbDtcclxuXHRcdFx0Z3JpZC5kcmFnTW92ZSA9IG51bGw7XHJcblx0XHRcdGdyaWQuZHJhZ1N0YXJ0ID0gbnVsbDtcclxuXHRcdFx0Z3JpZC5lbXB0eVJvd3MgPSBudWxsO1xyXG5cdFx0XHRncmlkLnBvcHVsYXRlID0gbnVsbDtcclxuXHRcdFx0Z3JpZC5wb3B1bGF0ZVZpc2libGUgPSBudWxsO1xyXG5cdFx0XHRncmlkLnNjcm9sbEdyaWQgPSBudWxsO1xyXG5cdFx0XHRncmlkLnNlbGVjdGlvblByZXNlcnZlciA9IG51bGw7XHJcblxyXG5cdFx0XHRncmlkLmJEaXYgPSBudWxsO1xyXG5cdFx0XHRncmlkLmNEaXYgPSBudWxsO1xyXG5cdFx0XHRncmlkLmhEaXYgPSBudWxsO1xyXG5cdFx0XHRncmlkLmNvbHMgPSBudWxsO1xyXG5cdFx0XHR2YXIgaSwgbCA9IGdyaWQuaGVhZGVycy5sZW5ndGg7XHJcblx0XHRcdGZvciAoaSA9IDA7IGkgPCBsOyBpKyspIHtcclxuXHRcdFx0XHRncmlkLmhlYWRlcnNbaV0uZWwgPSBudWxsO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aGlzLmZvcm1hdENvbCA9IG51bGw7XHJcblx0XHRcdHRoaXMuc29ydERhdGEgPSBudWxsO1xyXG5cdFx0XHR0aGlzLnVwZGF0ZXBhZ2VyID0gbnVsbDtcclxuXHRcdFx0dGhpcy5yZWZyZXNoSW5kZXggPSBudWxsO1xyXG5cdFx0XHR0aGlzLnNldEhlYWRDaGVja0JveCA9IG51bGw7XHJcblx0XHRcdHRoaXMuY29uc3RydWN0VHIgPSBudWxsO1xyXG5cdFx0XHR0aGlzLmZvcm1hdHRlciA9IG51bGw7XHJcblx0XHRcdHRoaXMuYWRkWG1sRGF0YSA9IG51bGw7XHJcblx0XHRcdHRoaXMuYWRkSlNPTkRhdGEgPSBudWxsO1xyXG5cdFx0XHR0aGlzLmdyaWQgPSBudWxsO1xyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRHcmlkRGVzdHJveSA6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0aWYgKCB0aGlzLmdyaWQgKSB7XHJcblx0XHRcdFx0aWYgKCB0aGlzLnAucGFnZXIgKSB7IC8vIGlmIG5vdCBwYXJ0IG9mIGdyaWRcclxuXHRcdFx0XHRcdCQodGhpcy5wLnBhZ2VyKS5yZW1vdmUoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdCQodGhpcykuanFHcmlkKCdjbGVhckJlZm9yZVVubG9hZCcpO1xyXG5cdFx0XHRcdFx0JChcIiNnYm94X1wiKyQuamdyaWQuanFJRCh0aGlzLmlkKSkucmVtb3ZlKCk7XHJcblx0XHRcdFx0fSBjYXRjaCAoXykge31cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRHcmlkVW5sb2FkIDogZnVuY3Rpb24oKXtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0aWYgKCAhdGhpcy5ncmlkICkge3JldHVybjt9XHJcblx0XHRcdHZhciBkZWZncmlkID0ge2lkOiAkKHRoaXMpLmF0dHIoJ2lkJyksY2w6ICQodGhpcykuYXR0cignY2xhc3MnKX07XHJcblx0XHRcdGlmICh0aGlzLnAucGFnZXIpIHtcclxuXHRcdFx0XHQkKHRoaXMucC5wYWdlcikuZW1wdHkoKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWRlZmF1bHQgdWktanFncmlkLXBhZ2VyIHVpLWNvcm5lci1ib3R0b21cIik7XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIG5ld3RhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGFibGUnKTtcclxuXHRcdFx0JChuZXd0YWJsZSkuYXR0cih7aWQ6ZGVmZ3JpZC5pZH0pO1xyXG5cdFx0XHRuZXd0YWJsZS5jbGFzc05hbWUgPSBkZWZncmlkLmNsO1xyXG5cdFx0XHR2YXIgZ2lkID0gJC5qZ3JpZC5qcUlEKHRoaXMuaWQpO1xyXG5cdFx0XHQkKG5ld3RhYmxlKS5yZW1vdmVDbGFzcyhcInVpLWpxZ3JpZC1idGFibGVcIik7XHJcblx0XHRcdGlmKCAkKHRoaXMucC5wYWdlcikucGFyZW50cyhcIiNnYm94X1wiK2dpZCkubGVuZ3RoID09PSAxICkge1xyXG5cdFx0XHRcdCQobmV3dGFibGUpLmluc2VydEJlZm9yZShcIiNnYm94X1wiK2dpZCkuc2hvdygpO1xyXG5cdFx0XHRcdCQodGhpcy5wLnBhZ2VyKS5pbnNlcnRCZWZvcmUoXCIjZ2JveF9cIitnaWQpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQobmV3dGFibGUpLmluc2VydEJlZm9yZShcIiNnYm94X1wiK2dpZCkuc2hvdygpO1xyXG5cdFx0XHR9XHJcblx0XHRcdCQodGhpcykuanFHcmlkKCdjbGVhckJlZm9yZVVubG9hZCcpO1xyXG5cdFx0XHQkKFwiI2dib3hfXCIrZ2lkKS5yZW1vdmUoKTtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0c2V0R3JpZFN0YXRlIDogZnVuY3Rpb24oc3RhdGUpIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0aWYgKCAhdGhpcy5ncmlkICkge3JldHVybjt9XHJcblx0XHRcdHZhciAkdCA9IHRoaXM7XHJcblx0XHRcdGlmKHN0YXRlID09PSAnaGlkZGVuJyl7XHJcblx0XHRcdFx0JChcIi51aS1qcWdyaWQtYmRpdiwgLnVpLWpxZ3JpZC1oZGl2XCIsXCIjZ3ZpZXdfXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpKS5zbGlkZVVwKFwiZmFzdFwiKTtcclxuXHRcdFx0XHRpZigkdC5wLnBhZ2VyKSB7JCgkdC5wLnBhZ2VyKS5zbGlkZVVwKFwiZmFzdFwiKTt9XHJcblx0XHRcdFx0aWYoJHQucC50b3BwYWdlcikgeyQoJHQucC50b3BwYWdlcikuc2xpZGVVcChcImZhc3RcIik7fVxyXG5cdFx0XHRcdGlmKCR0LnAudG9vbGJhclswXT09PXRydWUpIHtcclxuXHRcdFx0XHRcdGlmKCAkdC5wLnRvb2xiYXJbMV0gPT09ICdib3RoJykge1xyXG5cdFx0XHRcdFx0XHQkKCR0LmdyaWQudWJEaXYpLnNsaWRlVXAoXCJmYXN0XCIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0JCgkdC5ncmlkLnVEaXYpLnNsaWRlVXAoXCJmYXN0XCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZigkdC5wLmZvb3RlcnJvdykgeyAkKFwiLnVpLWpxZ3JpZC1zZGl2XCIsXCIjZ2JveF9cIiskLmpncmlkLmpxSUQoJHQucC5pZCkpLnNsaWRlVXAoXCJmYXN0XCIpOyB9XHJcblx0XHRcdFx0JChcIi51aS1qcWdyaWQtdGl0bGViYXItY2xvc2Ugc3BhblwiLCR0LmdyaWQuY0RpdikucmVtb3ZlQ2xhc3MoXCJ1aS1pY29uLWNpcmNsZS10cmlhbmdsZS1uXCIpLmFkZENsYXNzKFwidWktaWNvbi1jaXJjbGUtdHJpYW5nbGUtc1wiKTtcclxuXHRcdFx0XHQkdC5wLmdyaWRzdGF0ZSA9ICdoaWRkZW4nO1xyXG5cdFx0XHR9IGVsc2UgaWYoc3RhdGUgPT09ICd2aXNpYmxlJykge1xyXG5cdFx0XHRcdCQoXCIudWktanFncmlkLWhkaXYsIC51aS1qcWdyaWQtYmRpdlwiLFwiI2d2aWV3X1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKSkuc2xpZGVEb3duKFwiZmFzdFwiKTtcclxuXHRcdFx0XHRpZigkdC5wLnBhZ2VyKSB7JCgkdC5wLnBhZ2VyKS5zbGlkZURvd24oXCJmYXN0XCIpO31cclxuXHRcdFx0XHRpZigkdC5wLnRvcHBhZ2VyKSB7JCgkdC5wLnRvcHBhZ2VyKS5zbGlkZURvd24oXCJmYXN0XCIpO31cclxuXHRcdFx0XHRpZigkdC5wLnRvb2xiYXJbMF09PT10cnVlKSB7XHJcblx0XHRcdFx0XHRpZiggJHQucC50b29sYmFyWzFdID09PSAnYm90aCcpIHtcclxuXHRcdFx0XHRcdFx0JCgkdC5ncmlkLnViRGl2KS5zbGlkZURvd24oXCJmYXN0XCIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0JCgkdC5ncmlkLnVEaXYpLnNsaWRlRG93bihcImZhc3RcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKCR0LnAuZm9vdGVycm93KSB7ICQoXCIudWktanFncmlkLXNkaXZcIixcIiNnYm94X1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKSkuc2xpZGVEb3duKFwiZmFzdFwiKTsgfVxyXG5cdFx0XHRcdCQoXCIudWktanFncmlkLXRpdGxlYmFyLWNsb3NlIHNwYW5cIiwkdC5ncmlkLmNEaXYpLnJlbW92ZUNsYXNzKFwidWktaWNvbi1jaXJjbGUtdHJpYW5nbGUtc1wiKS5hZGRDbGFzcyhcInVpLWljb24tY2lyY2xlLXRyaWFuZ2xlLW5cIik7XHJcblx0XHRcdFx0JHQucC5ncmlkc3RhdGUgPSAndmlzaWJsZSc7XHJcblx0XHRcdH1cclxuXHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdGZpbHRlclRvb2xiYXIgOiBmdW5jdGlvbihwKXtcclxuXHRcdHAgPSAkLmV4dGVuZCh7XHJcblx0XHRcdGF1dG9zZWFyY2g6IHRydWUsXHJcblx0XHRcdHNlYXJjaE9uRW50ZXIgOiB0cnVlLFxyXG5cdFx0XHRiZWZvcmVTZWFyY2g6IG51bGwsXHJcblx0XHRcdGFmdGVyU2VhcmNoOiBudWxsLFxyXG5cdFx0XHRiZWZvcmVDbGVhcjogbnVsbCxcclxuXHRcdFx0YWZ0ZXJDbGVhcjogbnVsbCxcclxuXHRcdFx0c2VhcmNodXJsIDogJycsXHJcblx0XHRcdHN0cmluZ1Jlc3VsdDogZmFsc2UsXHJcblx0XHRcdGdyb3VwT3A6ICdBTkQnLFxyXG5cdFx0XHRkZWZhdWx0U2VhcmNoIDogXCJid1wiLFxyXG5cdFx0XHRzZWFyY2hPcGVyYXRvcnMgOiBmYWxzZSxcclxuXHRcdFx0cmVzZXRJY29uIDogXCJ4XCIsXHJcblx0XHRcdG9wZXJhbmRzIDogeyBcImVxXCIgOlwiPT1cIiwgXCJuZVwiOlwiIVwiLFwibHRcIjpcIjxcIixcImxlXCI6XCI8PVwiLFwiZ3RcIjpcIj5cIixcImdlXCI6XCI+PVwiLFwiYndcIjpcIl5cIixcImJuXCI6XCIhXlwiLFwiaW5cIjpcIj1cIixcIm5pXCI6XCIhPVwiLFwiZXdcIjpcInxcIixcImVuXCI6XCIhQFwiLFwiY25cIjpcIn5cIixcIm5jXCI6XCIhflwiLFwibnVcIjpcIiNcIixcIm5uXCI6XCIhI1wifVxyXG5cdFx0fSwgJC5qZ3JpZC5zZWFyY2ggLCBwICB8fCB7fSk7XHJcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdHZhciAkdCA9IHRoaXM7XHJcblx0XHRcdGlmKHRoaXMuZnRvb2xiYXIpIHsgcmV0dXJuOyB9XHJcblx0XHRcdHZhciB0cmlnZ2VyVG9vbGJhciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHZhciBzZGF0YT17fSwgaj0wLCB2LCBubSwgc29wdD17fSxzbztcclxuXHRcdFx0XHQkLmVhY2goJHQucC5jb2xNb2RlbCxmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0dmFyICRlbGVtID0gJChcIiNnc19cIiskLmpncmlkLmpxSUQodGhpcy5uYW1lKSwgKHRoaXMuZnJvemVuPT09dHJ1ZSAmJiAkdC5wLmZyb3plbkNvbHVtbnMgPT09IHRydWUpID8gICR0LmdyaWQuZmhEaXYgOiAkdC5ncmlkLmhEaXYpO1xyXG5cdFx0XHRcdFx0bm0gPSB0aGlzLmluZGV4IHx8IHRoaXMubmFtZTtcclxuXHRcdFx0XHRcdGlmKHAuc2VhcmNoT3BlcmF0b3JzICkge1xyXG5cdFx0XHRcdFx0XHRzbyA9ICRlbGVtLnBhcmVudCgpLnByZXYoKS5jaGlsZHJlbihcImFcIikuYXR0cihcInNvcGVyXCIpIHx8IHAuZGVmYXVsdFNlYXJjaDtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHNvICA9ICh0aGlzLnNlYXJjaG9wdGlvbnMgJiYgdGhpcy5zZWFyY2hvcHRpb25zLnNvcHQpID8gdGhpcy5zZWFyY2hvcHRpb25zLnNvcHRbMF0gOiB0aGlzLnN0eXBlPT09J3NlbGVjdCc/ICAnZXEnIDogcC5kZWZhdWx0U2VhcmNoO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0diA9IHRoaXMuc3R5cGUgPT09IFwiY3VzdG9tXCIgJiYgJC5pc0Z1bmN0aW9uKHRoaXMuc2VhcmNob3B0aW9ucy5jdXN0b21fdmFsdWUpICYmICRlbGVtLmxlbmd0aCA+IDAgJiYgJGVsZW1bMF0ubm9kZU5hbWUudG9VcHBlckNhc2UoKSA9PT0gXCJTUEFOXCIgP1xyXG5cdFx0XHRcdFx0XHR0aGlzLnNlYXJjaG9wdGlvbnMuY3VzdG9tX3ZhbHVlLmNhbGwoJHQsICRlbGVtLmNoaWxkcmVuKFwiLmN1c3RvbWVsZW1lbnQ6Zmlyc3RcIiksIFwiZ2V0XCIpIDpcclxuXHRcdFx0XHRcdFx0JGVsZW0udmFsKCk7XHJcblx0XHRcdFx0XHRpZih2IHx8IHNvPT09XCJudVwiIHx8IHNvPT09XCJublwiKSB7XHJcblx0XHRcdFx0XHRcdHNkYXRhW25tXSA9IHY7XHJcblx0XHRcdFx0XHRcdHNvcHRbbm1dID0gc287XHJcblx0XHRcdFx0XHRcdGorKztcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0ZGVsZXRlICR0LnAucG9zdERhdGFbbm1dO1xyXG5cdFx0XHRcdFx0XHR9IGNhdGNoICh6KSB7fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdHZhciBzZCA9ICBqPjAgPyB0cnVlIDogZmFsc2U7XHJcblx0XHRcdFx0aWYocC5zdHJpbmdSZXN1bHQgPT09IHRydWUgfHwgJHQucC5kYXRhdHlwZSA9PT0gXCJsb2NhbFwiKSB7XHJcblx0XHRcdFx0XHR2YXIgcnVsZUdyb3VwID0gXCJ7XFxcImdyb3VwT3BcXFwiOlxcXCJcIiArIHAuZ3JvdXBPcCArIFwiXFxcIixcXFwicnVsZXNcXFwiOltcIjtcclxuXHRcdFx0XHRcdHZhciBnaT0wO1xyXG5cdFx0XHRcdFx0JC5lYWNoKHNkYXRhLGZ1bmN0aW9uKGksbil7XHJcblx0XHRcdFx0XHRcdGlmIChnaSA+IDApIHtydWxlR3JvdXAgKz0gXCIsXCI7fVxyXG5cdFx0XHRcdFx0XHRydWxlR3JvdXAgKz0gXCJ7XFxcImZpZWxkXFxcIjpcXFwiXCIgKyBpICsgXCJcXFwiLFwiO1xyXG5cdFx0XHRcdFx0XHRydWxlR3JvdXAgKz0gXCJcXFwib3BcXFwiOlxcXCJcIiArIHNvcHRbaV0gKyBcIlxcXCIsXCI7XHJcblx0XHRcdFx0XHRcdG4rPVwiXCI7XHJcblx0XHRcdFx0XHRcdHJ1bGVHcm91cCArPSBcIlxcXCJkYXRhXFxcIjpcXFwiXCIgKyBuLnJlcGxhY2UoL1xcXFwvZywnXFxcXFxcXFwnKS5yZXBsYWNlKC9cXFwiL2csJ1xcXFxcIicpICsgXCJcXFwifVwiO1xyXG5cdFx0XHRcdFx0XHRnaSsrO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRydWxlR3JvdXAgKz0gXCJdfVwiO1xyXG5cdFx0XHRcdFx0JC5leHRlbmQoJHQucC5wb3N0RGF0YSx7ZmlsdGVyczpydWxlR3JvdXB9KTtcclxuXHRcdFx0XHRcdCQuZWFjaChbJ3NlYXJjaEZpZWxkJywgJ3NlYXJjaFN0cmluZycsICdzZWFyY2hPcGVyJ10sIGZ1bmN0aW9uKGksIG4pe1xyXG5cdFx0XHRcdFx0XHRpZigkdC5wLnBvc3REYXRhLmhhc093blByb3BlcnR5KG4pKSB7IGRlbGV0ZSAkdC5wLnBvc3REYXRhW25dO31cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQkLmV4dGVuZCgkdC5wLnBvc3REYXRhLHNkYXRhKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIHNhdmV1cmw7XHJcblx0XHRcdFx0aWYoJHQucC5zZWFyY2h1cmwpIHtcclxuXHRcdFx0XHRcdHNhdmV1cmwgPSAkdC5wLnVybDtcclxuXHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcInNldEdyaWRQYXJhbVwiLHt1cmw6JHQucC5zZWFyY2h1cmx9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIGJzciA9ICQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkVG9vbGJhckJlZm9yZVNlYXJjaFwiKSA9PT0gJ3N0b3AnID8gdHJ1ZSA6IGZhbHNlO1xyXG5cdFx0XHRcdGlmKCFic3IgJiYgJC5pc0Z1bmN0aW9uKHAuYmVmb3JlU2VhcmNoKSl7YnNyID0gcC5iZWZvcmVTZWFyY2guY2FsbCgkdCk7fVxyXG5cdFx0XHRcdGlmKCFic3IpIHsgJCgkdCkuanFHcmlkKFwic2V0R3JpZFBhcmFtXCIse3NlYXJjaDpzZH0pLnRyaWdnZXIoXCJyZWxvYWRHcmlkXCIsW3twYWdlOjF9XSk7IH1cclxuXHRcdFx0XHRpZihzYXZldXJsKSB7JCgkdCkuanFHcmlkKFwic2V0R3JpZFBhcmFtXCIse3VybDpzYXZldXJsfSk7fVxyXG5cdFx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkVG9vbGJhckFmdGVyU2VhcmNoXCIpO1xyXG5cdFx0XHRcdGlmKCQuaXNGdW5jdGlvbihwLmFmdGVyU2VhcmNoKSl7cC5hZnRlclNlYXJjaC5jYWxsKCR0KTt9XHJcblx0XHRcdH0sXHJcblx0XHRcdGNsZWFyVG9vbGJhciA9IGZ1bmN0aW9uKHRyaWdnZXIpe1xyXG5cdFx0XHRcdHZhciBzZGF0YT17fSwgaj0wLCBubTtcclxuXHRcdFx0XHR0cmlnZ2VyID0gKHR5cGVvZiB0cmlnZ2VyICE9PSAnYm9vbGVhbicpID8gdHJ1ZSA6IHRyaWdnZXI7XHJcblx0XHRcdFx0JC5lYWNoKCR0LnAuY29sTW9kZWwsZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdHZhciB2LCAkZWxlbSA9ICQoXCIjZ3NfXCIrJC5qZ3JpZC5qcUlEKHRoaXMubmFtZSksKHRoaXMuZnJvemVuPT09dHJ1ZSAmJiAkdC5wLmZyb3plbkNvbHVtbnMgPT09IHRydWUpID8gICR0LmdyaWQuZmhEaXYgOiAkdC5ncmlkLmhEaXYpO1xyXG5cdFx0XHRcdFx0aWYodGhpcy5zZWFyY2hvcHRpb25zICYmIHRoaXMuc2VhcmNob3B0aW9ucy5kZWZhdWx0VmFsdWUgIT09IHVuZGVmaW5lZCkgeyB2ID0gdGhpcy5zZWFyY2hvcHRpb25zLmRlZmF1bHRWYWx1ZTsgfVxyXG5cdFx0XHRcdFx0bm0gPSB0aGlzLmluZGV4IHx8IHRoaXMubmFtZTtcclxuXHRcdFx0XHRcdHN3aXRjaCAodGhpcy5zdHlwZSkge1xyXG5cdFx0XHRcdFx0XHRjYXNlICdzZWxlY3QnIDpcclxuXHRcdFx0XHRcdFx0XHQkZWxlbS5maW5kKFwib3B0aW9uXCIpLmVhY2goZnVuY3Rpb24gKGkpe1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoaT09PTApIHsgdGhpcy5zZWxlY3RlZCA9IHRydWU7IH1cclxuXHRcdFx0XHRcdFx0XHRcdGlmICgkKHRoaXMpLnZhbCgpID09PSB2KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuc2VsZWN0ZWQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0aWYgKCB2ICE9PSB1bmRlZmluZWQgKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBwb3N0IHRoZSBrZXkgYW5kIG5vdCB0aGUgdGV4dFxyXG5cdFx0XHRcdFx0XHRcdFx0c2RhdGFbbm1dID0gdjtcclxuXHRcdFx0XHRcdFx0XHRcdGorKztcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlICR0LnAucG9zdERhdGFbbm1dO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBjYXRjaChlKSB7fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0Y2FzZSAndGV4dCc6XHJcblx0XHRcdFx0XHRcdFx0JGVsZW0udmFsKHYgfHwgXCJcIik7XHJcblx0XHRcdFx0XHRcdFx0aWYodiAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRzZGF0YVtubV0gPSB2O1xyXG5cdFx0XHRcdFx0XHRcdFx0aisrO1xyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgJHQucC5wb3N0RGF0YVtubV07XHJcblx0XHRcdFx0XHRcdFx0XHR9IGNhdGNoICh5KXt9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRjYXNlICdjdXN0b20nOlxyXG5cdFx0XHRcdFx0XHRcdGlmICgkLmlzRnVuY3Rpb24odGhpcy5zZWFyY2hvcHRpb25zLmN1c3RvbV92YWx1ZSkgJiYgJGVsZW0ubGVuZ3RoID4gMCAmJiAkZWxlbVswXS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpID09PSBcIlNQQU5cIikge1xyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5zZWFyY2hvcHRpb25zLmN1c3RvbV92YWx1ZS5jYWxsKCR0LCAkZWxlbS5jaGlsZHJlbihcIi5jdXN0b21lbGVtZW50OmZpcnN0XCIpLCBcInNldFwiLCB2IHx8IFwiXCIpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHR2YXIgc2QgPSAgaj4wID8gdHJ1ZSA6IGZhbHNlO1xyXG5cdFx0XHRcdCR0LnAucmVzZXRzZWFyY2ggPSAgdHJ1ZTtcclxuXHRcdFx0XHRpZihwLnN0cmluZ1Jlc3VsdCA9PT0gdHJ1ZSB8fCAkdC5wLmRhdGF0eXBlID09PSBcImxvY2FsXCIpIHtcclxuXHRcdFx0XHRcdHZhciBydWxlR3JvdXAgPSBcIntcXFwiZ3JvdXBPcFxcXCI6XFxcIlwiICsgcC5ncm91cE9wICsgXCJcXFwiLFxcXCJydWxlc1xcXCI6W1wiO1xyXG5cdFx0XHRcdFx0dmFyIGdpPTA7XHJcblx0XHRcdFx0XHQkLmVhY2goc2RhdGEsZnVuY3Rpb24oaSxuKXtcclxuXHRcdFx0XHRcdFx0aWYgKGdpID4gMCkge3J1bGVHcm91cCArPSBcIixcIjt9XHJcblx0XHRcdFx0XHRcdHJ1bGVHcm91cCArPSBcIntcXFwiZmllbGRcXFwiOlxcXCJcIiArIGkgKyBcIlxcXCIsXCI7XHJcblx0XHRcdFx0XHRcdHJ1bGVHcm91cCArPSBcIlxcXCJvcFxcXCI6XFxcIlwiICsgXCJlcVwiICsgXCJcXFwiLFwiO1xyXG5cdFx0XHRcdFx0XHRuKz1cIlwiO1xyXG5cdFx0XHRcdFx0XHRydWxlR3JvdXAgKz0gXCJcXFwiZGF0YVxcXCI6XFxcIlwiICsgbi5yZXBsYWNlKC9cXFxcL2csJ1xcXFxcXFxcJykucmVwbGFjZSgvXFxcIi9nLCdcXFxcXCInKSArIFwiXFxcIn1cIjtcclxuXHRcdFx0XHRcdFx0Z2krKztcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0cnVsZUdyb3VwICs9IFwiXX1cIjtcclxuXHRcdFx0XHRcdCQuZXh0ZW5kKCR0LnAucG9zdERhdGEse2ZpbHRlcnM6cnVsZUdyb3VwfSk7XHJcblx0XHRcdFx0XHQkLmVhY2goWydzZWFyY2hGaWVsZCcsICdzZWFyY2hTdHJpbmcnLCAnc2VhcmNoT3BlciddLCBmdW5jdGlvbihpLCBuKXtcclxuXHRcdFx0XHRcdFx0aWYoJHQucC5wb3N0RGF0YS5oYXNPd25Qcm9wZXJ0eShuKSkgeyBkZWxldGUgJHQucC5wb3N0RGF0YVtuXTt9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JC5leHRlbmQoJHQucC5wb3N0RGF0YSxzZGF0YSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHZhciBzYXZldXJsO1xyXG5cdFx0XHRcdGlmKCR0LnAuc2VhcmNodXJsKSB7XHJcblx0XHRcdFx0XHRzYXZldXJsID0gJHQucC51cmw7XHJcblx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJzZXRHcmlkUGFyYW1cIix7dXJsOiR0LnAuc2VhcmNodXJsfSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHZhciBiY3YgPSAkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZFRvb2xiYXJCZWZvcmVDbGVhclwiKSA9PT0gJ3N0b3AnID8gdHJ1ZSA6IGZhbHNlO1xyXG5cdFx0XHRcdGlmKCFiY3YgJiYgJC5pc0Z1bmN0aW9uKHAuYmVmb3JlQ2xlYXIpKXtiY3YgPSBwLmJlZm9yZUNsZWFyLmNhbGwoJHQpO31cclxuXHRcdFx0XHRpZighYmN2KSB7XHJcblx0XHRcdFx0XHRpZih0cmlnZ2VyKSB7XHJcblx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcInNldEdyaWRQYXJhbVwiLHtzZWFyY2g6c2R9KS50cmlnZ2VyKFwicmVsb2FkR3JpZFwiLFt7cGFnZToxfV0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihzYXZldXJsKSB7JCgkdCkuanFHcmlkKFwic2V0R3JpZFBhcmFtXCIse3VybDpzYXZldXJsfSk7fVxyXG5cdFx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkVG9vbGJhckFmdGVyQ2xlYXJcIik7XHJcblx0XHRcdFx0aWYoJC5pc0Z1bmN0aW9uKHAuYWZ0ZXJDbGVhcikpe3AuYWZ0ZXJDbGVhcigpO31cclxuXHRcdFx0fSxcclxuXHRcdFx0dG9nZ2xlVG9vbGJhciA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0dmFyIHRyb3cgPSAkKFwidHIudWktc2VhcmNoLXRvb2xiYXJcIiwkdC5ncmlkLmhEaXYpLFxyXG5cdFx0XHRcdHRyb3cyID0gJHQucC5mcm96ZW5Db2x1bW5zID09PSB0cnVlID8gICQoXCJ0ci51aS1zZWFyY2gtdG9vbGJhclwiLCR0LmdyaWQuZmhEaXYpIDogZmFsc2U7XHJcblx0XHRcdFx0aWYodHJvdy5jc3MoXCJkaXNwbGF5XCIpID09PSAnbm9uZScpIHtcclxuXHRcdFx0XHRcdHRyb3cuc2hvdygpO1xyXG5cdFx0XHRcdFx0aWYodHJvdzIpIHtcclxuXHRcdFx0XHRcdFx0dHJvdzIuc2hvdygpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR0cm93LmhpZGUoKTtcclxuXHRcdFx0XHRcdGlmKHRyb3cyKSB7XHJcblx0XHRcdFx0XHRcdHRyb3cyLmhpZGUoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdGJ1aWxkUnVsZU1lbnUgPSBmdW5jdGlvbiggZWxlbSwgbGVmdCwgdG9wICl7XHJcblx0XHRcdFx0JChcIiNzb3B0X21lbnVcIikucmVtb3ZlKCk7XHJcblxyXG5cdFx0XHRcdGxlZnQ9cGFyc2VJbnQobGVmdCwxMCk7XHJcblx0XHRcdFx0dG9wPXBhcnNlSW50KHRvcCwxMCkgKyAxODtcclxuXHJcblx0XHRcdFx0dmFyIGZzID0gICQoJy51aS1qcWdyaWQtdmlldycpLmNzcygnZm9udC1zaXplJykgfHwgJzExcHgnO1xyXG5cdFx0XHRcdHZhciBzdHIgPSAnPHVsIGlkPVwic29wdF9tZW51XCIgY2xhc3M9XCJ1aS1zZWFyY2gtbWVudVwiIHJvbGU9XCJtZW51XCIgdGFiaW5kZXg9XCIwXCIgc3R5bGU9XCJmb250LXNpemU6JytmcysnO2xlZnQ6JytsZWZ0KydweDt0b3A6Jyt0b3ArJ3B4O1wiPicsXHJcblx0XHRcdFx0c2VsZWN0ZWQgPSAkKGVsZW0pLmF0dHIoXCJzb3BlclwiKSwgc2VsY2xhc3MsXHJcblx0XHRcdFx0YW9wcnMgPSBbXSwgaW5hO1xyXG5cdFx0XHRcdHZhciBpPTAsIG5tID0kKGVsZW0pLmF0dHIoXCJjb2xuYW1lXCIpLGxlbiA9ICR0LnAuY29sTW9kZWwubGVuZ3RoO1xyXG5cdFx0XHRcdHdoaWxlKGk8bGVuKSB7XHJcblx0XHRcdFx0XHRpZigkdC5wLmNvbE1vZGVsW2ldLm5hbWUgPT09IG5tKSB7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aSsrO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR2YXIgY20gPSAkdC5wLmNvbE1vZGVsW2ldLCBvcHRpb25zID0gJC5leHRlbmQoe30sIGNtLnNlYXJjaG9wdGlvbnMpO1xyXG5cdFx0XHRcdGlmKCFvcHRpb25zLnNvcHQpIHtcclxuXHRcdFx0XHRcdG9wdGlvbnMuc29wdCA9IFtdO1xyXG5cdFx0XHRcdFx0b3B0aW9ucy5zb3B0WzBdPSBjbS5zdHlwZT09PSdzZWxlY3QnID8gICdlcScgOiBwLmRlZmF1bHRTZWFyY2g7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCQuZWFjaChwLm9kYXRhLCBmdW5jdGlvbigpIHsgYW9wcnMucHVzaCh0aGlzLm9wZXIpOyB9KTtcclxuXHRcdFx0XHRmb3IgKCBpID0gMCA7IGkgPCBvcHRpb25zLnNvcHQubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRcdGluYSA9ICQuaW5BcnJheShvcHRpb25zLnNvcHRbaV0sYW9wcnMpO1xyXG5cdFx0XHRcdFx0aWYoaW5hICE9PSAtMSkge1xyXG5cdFx0XHRcdFx0XHRzZWxjbGFzcyA9IHNlbGVjdGVkID09PSBwLm9kYXRhW2luYV0ub3BlciA/IFwidWktc3RhdGUtaGlnaGxpZ2h0XCIgOiBcIlwiO1xyXG5cdFx0XHRcdFx0XHRzdHIgKz0gJzxsaSBjbGFzcz1cInVpLW1lbnUtaXRlbSAnK3NlbGNsYXNzKydcIiByb2xlPVwicHJlc2VudGF0aW9uXCI+PGEgY2xhc3M9XCJ1aS1jb3JuZXItYWxsIGctbWVudS1pdGVtXCIgdGFiaW5kZXg9XCIwXCIgcm9sZT1cIm1lbnVpdGVtXCIgdmFsdWU9XCInK3Aub2RhdGFbaW5hXS5vcGVyKydcIiBvcGVyPVwiJytwLm9wZXJhbmRzW3Aub2RhdGFbaW5hXS5vcGVyXSsnXCI+PHRhYmxlIGNlbGxzcGFjaW5nPVwiMFwiIGNlbGxwYWRkaW5nPVwiMFwiIGJvcmRlcj1cIjBcIj48dHI+PHRkIHdpZHRoPVwiMjVweFwiPicrcC5vcGVyYW5kc1twLm9kYXRhW2luYV0ub3Blcl0rJzwvdGQ+PHRkPicrIHAub2RhdGFbaW5hXS50ZXh0Kyc8L3RkPjwvdHI+PC90YWJsZT48L2E+PC9saT4nO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRzdHIgKz0gXCI8L3VsPlwiO1xyXG5cdFx0XHRcdCQoJ2JvZHknKS5hcHBlbmQoc3RyKTtcclxuXHRcdFx0XHQkKFwiI3NvcHRfbWVudVwiKS5hZGRDbGFzcyhcInVpLW1lbnUgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGxcIik7XHJcblx0XHRcdFx0JChcIiNzb3B0X21lbnUgPiBsaSA+IGFcIikuaG92ZXIoXHJcblx0XHRcdFx0XHRmdW5jdGlvbigpeyAkKHRoaXMpLmFkZENsYXNzKFwidWktc3RhdGUtaG92ZXJcIik7IH0sXHJcblx0XHRcdFx0XHRmdW5jdGlvbigpeyAkKHRoaXMpLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtaG92ZXJcIik7IH1cclxuXHRcdFx0XHQpLmNsaWNrKGZ1bmN0aW9uKCBlICl7XHJcblx0XHRcdFx0XHR2YXIgdiA9ICQodGhpcykuYXR0cihcInZhbHVlXCIpLFxyXG5cdFx0XHRcdFx0b3BlciA9ICQodGhpcykuYXR0cihcIm9wZXJcIik7XHJcblx0XHRcdFx0XHQkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZFRvb2xiYXJTZWxlY3RPcGVyXCIsIFt2LCBvcGVyLCBlbGVtXSk7XHJcblx0XHRcdFx0XHQkKFwiI3NvcHRfbWVudVwiKS5oaWRlKCk7XHJcblx0XHRcdFx0XHQkKGVsZW0pLnRleHQob3BlcikuYXR0cihcInNvcGVyXCIsdik7XHJcblx0XHRcdFx0XHRpZihwLmF1dG9zZWFyY2g9PT10cnVlKXtcclxuXHRcdFx0XHRcdFx0dmFyIGlucGVsbSA9ICQoZWxlbSkucGFyZW50KCkubmV4dCgpLmNoaWxkcmVuKClbMF07XHJcblx0XHRcdFx0XHRcdGlmKCAkKGlucGVsbSkudmFsKCkgfHwgdj09PVwibnVcIiB8fCB2ID09PVwibm5cIikge1xyXG5cdFx0XHRcdFx0XHRcdHRyaWdnZXJUb29sYmFyKCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fTtcclxuXHRcdFx0Ly8gY3JlYXRlIHRoZSByb3dcclxuXHRcdFx0dmFyIHRyID0gJChcIjx0ciBjbGFzcz0ndWktc2VhcmNoLXRvb2xiYXInIHJvbGU9J3Jvd2hlYWRlcic+PC90cj5cIik7XHJcblx0XHRcdHZhciB0aW1lb3V0SG5kO1xyXG5cdFx0XHQkLmVhY2goJHQucC5jb2xNb2RlbCxmdW5jdGlvbihjaSl7XHJcblx0XHRcdFx0dmFyIGNtPXRoaXMsIHNvcHRpb25zLCBzdXJsLCBzZWxmLCBzZWxlY3QgPSBcIlwiLCBzb3Q9XCI9XCIsIHNvLCBpLFxyXG5cdFx0XHRcdHRoID0gJChcIjx0aCByb2xlPSdjb2x1bW5oZWFkZXInIGNsYXNzPSd1aS1zdGF0ZS1kZWZhdWx0IHVpLXRoLWNvbHVtbiB1aS10aC1cIiskdC5wLmRpcmVjdGlvbitcIic+PC90aD5cIiksXHJcblx0XHRcdFx0dGhkID0gJChcIjxkaXYgc3R5bGU9J3Bvc2l0aW9uOnJlbGF0aXZlO2hlaWdodDoxMDAlO3BhZGRpbmctcmlnaHQ6MC4zZW07cGFkZGluZy1sZWZ0OjAuM2VtOyc+PC9kaXY+XCIpLFxyXG5cdFx0XHRcdHN0YmwgPSAkKFwiPHRhYmxlIGNsYXNzPSd1aS1zZWFyY2gtdGFibGUnIGNlbGxzcGFjaW5nPScwJz48dHI+PHRkIGNsYXNzPSd1aS1zZWFyY2gtb3Blcic+PC90ZD48dGQgY2xhc3M9J3VpLXNlYXJjaC1pbnB1dCc+PC90ZD48dGQgY2xhc3M9J3VpLXNlYXJjaC1jbGVhcic+PC90ZD48L3RyPjwvdGFibGU+XCIpO1xyXG5cdFx0XHRcdGlmKHRoaXMuaGlkZGVuPT09dHJ1ZSkgeyAkKHRoKS5jc3MoXCJkaXNwbGF5XCIsXCJub25lXCIpO31cclxuXHRcdFx0XHR0aGlzLnNlYXJjaCA9IHRoaXMuc2VhcmNoID09PSBmYWxzZSA/IGZhbHNlIDogdHJ1ZTtcclxuXHRcdFx0XHRpZih0aGlzLnN0eXBlID09PSB1bmRlZmluZWQpIHt0aGlzLnN0eXBlPSd0ZXh0Jzt9XHJcblx0XHRcdFx0c29wdGlvbnMgPSAkLmV4dGVuZCh7fSx0aGlzLnNlYXJjaG9wdGlvbnMgfHwge30pO1xyXG5cdFx0XHRcdGlmKHRoaXMuc2VhcmNoKXtcclxuXHRcdFx0XHRcdGlmKHAuc2VhcmNoT3BlcmF0b3JzKSB7XHJcblx0XHRcdFx0XHRcdHNvICA9IChzb3B0aW9ucy5zb3B0KSA/IHNvcHRpb25zLnNvcHRbMF0gOiBjbS5zdHlwZT09PSdzZWxlY3QnID8gICdlcScgOiBwLmRlZmF1bHRTZWFyY2g7XHJcblx0XHRcdFx0XHRcdGZvcihpID0gMDtpPHAub2RhdGEubGVuZ3RoO2krKykge1xyXG5cdFx0XHRcdFx0XHRcdGlmKHAub2RhdGFbaV0ub3BlciA9PT0gc28pIHtcclxuXHRcdFx0XHRcdFx0XHRcdHNvdCA9IHAub3BlcmFuZHNbc29dIHx8IFwiXCI7XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0dmFyIHN0ID0gc29wdGlvbnMuc2VhcmNodGl0bGUgIT0gbnVsbCA/IHNvcHRpb25zLnNlYXJjaHRpdGxlIDogcC5vcGVyYW5kVGl0bGU7XHJcblx0XHRcdFx0XHRcdHNlbGVjdCA9IFwiPGEgdGl0bGU9J1wiK3N0K1wiJyBzdHlsZT0ncGFkZGluZy1yaWdodDogMC41ZW07JyBzb3Blcj0nXCIrc28rXCInIGNsYXNzPSdzb3B0Y2xhc3MnIGNvbG5hbWU9J1wiK3RoaXMubmFtZStcIic+XCIrc290K1wiPC9hPlwiO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0JChcInRkOmVxKDApXCIsc3RibCkuYXR0cihcImNvbGluZGV4XCIsY2kpLmFwcGVuZChzZWxlY3QpO1xyXG5cdFx0XHRcdFx0aWYoc29wdGlvbnMuY2xlYXJTZWFyY2ggPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0XHRzb3B0aW9ucy5jbGVhclNlYXJjaCA9IHRydWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZihzb3B0aW9ucy5jbGVhclNlYXJjaCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgY3N2ID0gcC5yZXNldFRpdGxlIHx8ICdDbGVhciBTZWFyY2ggVmFsdWUnO1xyXG5cdFx0XHRcdFx0XHQkKFwidGQ6ZXEoMilcIixzdGJsKS5hcHBlbmQoXCI8YSB0aXRsZT0nXCIrY3N2K1wiJyBzdHlsZT0ncGFkZGluZy1yaWdodDogMC4zZW07cGFkZGluZy1sZWZ0OiAwLjNlbTsnIGNsYXNzPSdjbGVhcnNlYXJjaGNsYXNzJz5cIitwLnJlc2V0SWNvbitcIjwvYT5cIik7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQkKFwidGQ6ZXEoMilcIiwgc3RibCkuaGlkZSgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0c3dpdGNoICh0aGlzLnN0eXBlKVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0Y2FzZSBcInNlbGVjdFwiOlxyXG5cdFx0XHRcdFx0XHRzdXJsID0gdGhpcy5zdXJsIHx8IHNvcHRpb25zLmRhdGFVcmw7XHJcblx0XHRcdFx0XHRcdGlmKHN1cmwpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBkYXRhIHJldHVybmVkIHNob3VsZCBoYXZlIGFscmVhZHkgY29uc3RydWN0ZWQgaHRtbCBzZWxlY3RcclxuXHRcdFx0XHRcdFx0XHQvLyBwcmltaXRpdmUgalF1ZXJ5IGxvYWRcclxuXHRcdFx0XHRcdFx0XHRzZWxmID0gdGhkO1xyXG5cdFx0XHRcdFx0XHRcdCQoc2VsZikuYXBwZW5kKHN0YmwpO1xyXG5cdFx0XHRcdFx0XHRcdCQuYWpheCgkLmV4dGVuZCh7XHJcblx0XHRcdFx0XHRcdFx0XHR1cmw6IHN1cmwsXHJcblx0XHRcdFx0XHRcdFx0XHRkYXRhVHlwZTogXCJodG1sXCIsXHJcblx0XHRcdFx0XHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYoc29wdGlvbnMuYnVpbGRTZWxlY3QgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBkID0gc29wdGlvbnMuYnVpbGRTZWxlY3QocmVzKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoZCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0JChcInRkOmVxKDEpXCIsc3RibCkuYXBwZW5kKGQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQkKFwidGQ6ZXEoMSlcIixzdGJsKS5hcHBlbmQocmVzKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZihzb3B0aW9ucy5kZWZhdWx0VmFsdWUgIT09IHVuZGVmaW5lZCkgeyAkKFwic2VsZWN0XCIsc2VsZikudmFsKHNvcHRpb25zLmRlZmF1bHRWYWx1ZSk7IH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0JChcInNlbGVjdFwiLHNlbGYpLmF0dHIoe25hbWU6Y20uaW5kZXggfHwgY20ubmFtZSwgaWQ6IFwiZ3NfXCIrY20ubmFtZX0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZihzb3B0aW9ucy5hdHRyKSB7JChcInNlbGVjdFwiLHNlbGYpLmF0dHIoc29wdGlvbnMuYXR0cik7fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHQkKFwic2VsZWN0XCIsc2VsZikuY3NzKHt3aWR0aDogXCIxMDAlXCJ9KTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gcHJlc2VydmUgYXV0b3NlcmNoXHJcblx0XHRcdFx0XHRcdFx0XHRcdCQuamdyaWQuYmluZEV2LmNhbGwoJHQsICQoXCJzZWxlY3RcIixzZWxmKVswXSwgc29wdGlvbnMpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZihwLmF1dG9zZWFyY2g9PT10cnVlKXtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQkKFwic2VsZWN0XCIsc2VsZikuY2hhbmdlKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0cmlnZ2VyVG9vbGJhcigpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdHJlcz1udWxsO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH0sICQuamdyaWQuYWpheE9wdGlvbnMsICR0LnAuYWpheFNlbGVjdE9wdGlvbnMgfHwge30gKSk7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0dmFyIG9Tdiwgc2VwLCBkZWxpbTtcclxuXHRcdFx0XHRcdFx0XHRpZihjbS5zZWFyY2hvcHRpb25zKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRvU3YgPSBjbS5zZWFyY2hvcHRpb25zLnZhbHVlID09PSB1bmRlZmluZWQgPyBcIlwiIDogY20uc2VhcmNob3B0aW9ucy52YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdHNlcCA9IGNtLnNlYXJjaG9wdGlvbnMuc2VwYXJhdG9yID09PSB1bmRlZmluZWQgPyBcIjpcIiA6IGNtLnNlYXJjaG9wdGlvbnMuc2VwYXJhdG9yO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGVsaW0gPSBjbS5zZWFyY2hvcHRpb25zLmRlbGltaXRlciA9PT0gdW5kZWZpbmVkID8gXCI7XCIgOiBjbS5zZWFyY2hvcHRpb25zLmRlbGltaXRlcjtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYoY20uZWRpdG9wdGlvbnMpIHtcclxuXHRcdFx0XHRcdFx0XHRcdG9TdiA9IGNtLmVkaXRvcHRpb25zLnZhbHVlID09PSB1bmRlZmluZWQgPyBcIlwiIDogY20uZWRpdG9wdGlvbnMudmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRzZXAgPSBjbS5lZGl0b3B0aW9ucy5zZXBhcmF0b3IgPT09IHVuZGVmaW5lZCA/IFwiOlwiIDogY20uZWRpdG9wdGlvbnMuc2VwYXJhdG9yO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGVsaW0gPSBjbS5lZGl0b3B0aW9ucy5kZWxpbWl0ZXIgPT09IHVuZGVmaW5lZCA/IFwiO1wiIDogY20uZWRpdG9wdGlvbnMuZGVsaW1pdGVyO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRpZiAob1N2KSB7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzZWxlY3RcIik7XHJcblx0XHRcdFx0XHRcdFx0XHRlbGVtLnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XHJcblx0XHRcdFx0XHRcdFx0XHQkKGVsZW0pLmF0dHIoe25hbWU6Y20uaW5kZXggfHwgY20ubmFtZSwgaWQ6IFwiZ3NfXCIrY20ubmFtZX0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIHN2LCBvdiwga2V5LCBrO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYodHlwZW9mIG9TdiA9PT0gXCJzdHJpbmdcIikge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRzbyA9IG9Tdi5zcGxpdChkZWxpbSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGZvcihrPTA7IGs8c28ubGVuZ3RoO2srKyl7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0c3YgPSBzb1trXS5zcGxpdChzZXApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdG92ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRvdi52YWx1ZSA9IHN2WzBdOyBvdi5pbm5lckhUTUwgPSBzdlsxXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRlbGVtLmFwcGVuZENoaWxkKG92KTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmKHR5cGVvZiBvU3YgPT09IFwib2JqZWN0XCIgKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGZvciAoa2V5IGluIG9Tdikge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmKG9Tdi5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRvdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRvdi52YWx1ZSA9IGtleTsgb3YuaW5uZXJIVE1MID0gb1N2W2tleV07XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbGVtLmFwcGVuZENoaWxkKG92KTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdGlmKHNvcHRpb25zLmRlZmF1bHRWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7ICQoZWxlbSkudmFsKHNvcHRpb25zLmRlZmF1bHRWYWx1ZSk7IH1cclxuXHRcdFx0XHRcdFx0XHRcdGlmKHNvcHRpb25zLmF0dHIpIHskKGVsZW0pLmF0dHIoc29wdGlvbnMuYXR0cik7fVxyXG5cdFx0XHRcdFx0XHRcdFx0JCh0aGQpLmFwcGVuZChzdGJsKTtcclxuXHRcdFx0XHRcdFx0XHRcdCQuamdyaWQuYmluZEV2LmNhbGwoJHQsIGVsZW0gLCBzb3B0aW9ucyk7XHJcblx0XHRcdFx0XHRcdFx0XHQkKFwidGQ6ZXEoMSlcIixzdGJsKS5hcHBlbmQoIGVsZW0gKTtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKHAuYXV0b3NlYXJjaD09PXRydWUpe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkKGVsZW0pLmNoYW5nZShmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyaWdnZXJUb29sYmFyKCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFwidGV4dFwiOlxyXG5cdFx0XHRcdFx0XHR2YXIgZGYgPSBzb3B0aW9ucy5kZWZhdWx0VmFsdWUgIT09IHVuZGVmaW5lZCA/IHNvcHRpb25zLmRlZmF1bHRWYWx1ZTogXCJcIjtcclxuXHJcblx0XHRcdFx0XHRcdCQoXCJ0ZDplcSgxKVwiLHN0YmwpLmFwcGVuZChcIjxpbnB1dCB0eXBlPSd0ZXh0JyBzdHlsZT0nd2lkdGg6MTAwJTtwYWRkaW5nOjBweDsnIG5hbWU9J1wiKyhjbS5pbmRleCB8fCBjbS5uYW1lKStcIicgaWQ9J2dzX1wiK2NtLm5hbWUrXCInIHZhbHVlPSdcIitkZitcIicvPlwiKTtcclxuXHRcdFx0XHRcdFx0JCh0aGQpLmFwcGVuZChzdGJsKTtcclxuXHJcblx0XHRcdFx0XHRcdGlmKHNvcHRpb25zLmF0dHIpIHskKFwiaW5wdXRcIix0aGQpLmF0dHIoc29wdGlvbnMuYXR0cik7fVxyXG5cdFx0XHRcdFx0XHQkLmpncmlkLmJpbmRFdi5jYWxsKCR0LCAkKFwiaW5wdXRcIix0aGQpWzBdLCBzb3B0aW9ucyk7XHJcblx0XHRcdFx0XHRcdGlmKHAuYXV0b3NlYXJjaD09PXRydWUpe1xyXG5cdFx0XHRcdFx0XHRcdGlmKHAuc2VhcmNoT25FbnRlcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0JChcImlucHV0XCIsdGhkKS5rZXlwcmVzcyhmdW5jdGlvbihlKXtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGtleSA9IGUuY2hhckNvZGUgfHwgZS5rZXlDb2RlIHx8IDA7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKGtleSA9PT0gMTMpe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyaWdnZXJUb29sYmFyKCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQoXCJpbnB1dFwiLHRoZCkua2V5ZG93bihmdW5jdGlvbihlKXtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGtleSA9IGUud2hpY2g7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHN3aXRjaCAoa2V5KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSAxMzpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDkgOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgMTY6XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSAzNzpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDM4OlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgMzk6XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSA0MDpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDI3OlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZGVmYXVsdCA6XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZih0aW1lb3V0SG5kKSB7IGNsZWFyVGltZW91dCh0aW1lb3V0SG5kKTsgfVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dGltZW91dEhuZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXt0cmlnZ2VyVG9vbGJhcigpO30sNTAwKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSBcImN1c3RvbVwiOlxyXG5cdFx0XHRcdFx0XHQkKFwidGQ6ZXEoMSlcIixzdGJsKS5hcHBlbmQoXCI8c3BhbiBzdHlsZT0nd2lkdGg6OTUlO3BhZGRpbmc6MHB4OycgbmFtZT0nXCIrKGNtLmluZGV4IHx8IGNtLm5hbWUpK1wiJyBpZD0nZ3NfXCIrY20ubmFtZStcIicvPlwiKTtcclxuXHRcdFx0XHRcdFx0JCh0aGQpLmFwcGVuZChzdGJsKTtcclxuXHRcdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0XHRpZigkLmlzRnVuY3Rpb24oc29wdGlvbnMuY3VzdG9tX2VsZW1lbnQpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgY2VsbSA9IHNvcHRpb25zLmN1c3RvbV9lbGVtZW50LmNhbGwoJHQsc29wdGlvbnMuZGVmYXVsdFZhbHVlICE9PSB1bmRlZmluZWQgPyBzb3B0aW9ucy5kZWZhdWx0VmFsdWU6IFwiXCIsc29wdGlvbnMpO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoY2VsbSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjZWxtID0gJChjZWxtKS5hZGRDbGFzcyhcImN1c3RvbWVsZW1lbnRcIik7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQodGhkKS5maW5kKFwiPnNwYW5cIikuYXBwZW5kKGNlbG0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dGhyb3cgXCJlMlwiO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0aHJvdyBcImUxXCI7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGUgPT09IFwiZTFcIikgeyAkLmpncmlkLmluZm9fZGlhbG9nKCQuamdyaWQuZXJyb3JzLmVycmNhcCxcImZ1bmN0aW9uICdjdXN0b21fZWxlbWVudCcgXCIrJC5qZ3JpZC5lZGl0Lm1zZy5ub2RlZmluZWQsJC5qZ3JpZC5lZGl0LmJDbG9zZSk7fVxyXG5cdFx0XHRcdFx0XHRcdGlmIChlID09PSBcImUyXCIpIHsgJC5qZ3JpZC5pbmZvX2RpYWxvZygkLmpncmlkLmVycm9ycy5lcnJjYXAsXCJmdW5jdGlvbiAnY3VzdG9tX2VsZW1lbnQnIFwiKyQuamdyaWQuZWRpdC5tc2cubm92YWx1ZSwkLmpncmlkLmVkaXQuYkNsb3NlKTt9XHJcblx0XHRcdFx0XHRcdFx0ZWxzZSB7ICQuamdyaWQuaW5mb19kaWFsb2coJC5qZ3JpZC5lcnJvcnMuZXJyY2FwLHR5cGVvZiBlPT09XCJzdHJpbmdcIj9lOmUubWVzc2FnZSwkLmpncmlkLmVkaXQuYkNsb3NlKTsgfVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQkKHRoKS5hcHBlbmQodGhkKTtcclxuXHRcdFx0XHQkKHRyKS5hcHBlbmQodGgpO1xyXG5cdFx0XHRcdGlmKCFwLnNlYXJjaE9wZXJhdG9ycykge1xyXG5cdFx0XHRcdFx0JChcInRkOmVxKDApXCIsc3RibCkuaGlkZSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdCQoXCJ0YWJsZSB0aGVhZFwiLCR0LmdyaWQuaERpdikuYXBwZW5kKHRyKTtcclxuXHRcdFx0aWYocC5zZWFyY2hPcGVyYXRvcnMpIHtcclxuXHRcdFx0XHQkKFwiLnNvcHRjbGFzc1wiLHRyKS5jbGljayhmdW5jdGlvbihlKXtcclxuXHRcdFx0XHRcdHZhciBvZmZzZXQgPSAkKHRoaXMpLm9mZnNldCgpLFxyXG5cdFx0XHRcdFx0bGVmdCA9ICggb2Zmc2V0LmxlZnQgKSxcclxuXHRcdFx0XHRcdHRvcCA9ICggb2Zmc2V0LnRvcCk7XHJcblx0XHRcdFx0XHRidWlsZFJ1bGVNZW51KHRoaXMsIGxlZnQsIHRvcCApO1xyXG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHQkKFwiYm9keVwiKS5vbignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuXHRcdFx0XHRcdGlmKGUudGFyZ2V0LmNsYXNzTmFtZSAhPT0gXCJzb3B0Y2xhc3NcIikge1xyXG5cdFx0XHRcdFx0XHQkKFwiI3NvcHRfbWVudVwiKS5oaWRlKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0JChcIi5jbGVhcnNlYXJjaGNsYXNzXCIsdHIpLmNsaWNrKGZ1bmN0aW9uKGUpe1xyXG5cdFx0XHRcdHZhciBwdHIgPSAkKHRoaXMpLnBhcmVudHMoXCJ0cjpmaXJzdFwiKSxcclxuXHRcdFx0XHRjb2xpID0gcGFyc2VJbnQoJChcInRkLnVpLXNlYXJjaC1vcGVyXCIsIHB0cikuYXR0cignY29saW5kZXgnKSwxMCksXHJcblx0XHRcdFx0c3ZhbCAgPSAkLmV4dGVuZCh7fSwkdC5wLmNvbE1vZGVsW2NvbGldLnNlYXJjaG9wdGlvbnMgfHwge30pLFxyXG5cdFx0XHRcdGR2YWwgPSBzdmFsLmRlZmF1bHRWYWx1ZSA/IHN2YWwuZGVmYXVsdFZhbHVlIDogXCJcIjtcclxuXHRcdFx0XHRpZigkdC5wLmNvbE1vZGVsW2NvbGldLnN0eXBlID09PSBcInNlbGVjdFwiKSB7XHJcblx0XHRcdFx0XHRpZihkdmFsKSB7XHJcblx0XHRcdFx0XHRcdCQoXCJ0ZC51aS1zZWFyY2gtaW5wdXQgc2VsZWN0XCIsIHB0cikudmFsKCBkdmFsICk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQkKFwidGQudWktc2VhcmNoLWlucHV0IHNlbGVjdFwiLCBwdHIpWzBdLnNlbGVjdGVkSW5kZXggPSAwO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQkKFwidGQudWktc2VhcmNoLWlucHV0IGlucHV0XCIsIHB0cikudmFsKCBkdmFsICk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC8vIFRvRG8gY3VzdG9tIHNlYXJjaCB0eXBlXHJcblx0XHRcdFx0aWYocC5hdXRvc2VhcmNoPT09dHJ1ZSl7XHJcblx0XHRcdFx0XHR0cmlnZ2VyVG9vbGJhcigpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdH0pO1xyXG5cdFx0XHR0aGlzLmZ0b29sYmFyID0gdHJ1ZTtcclxuXHRcdFx0dGhpcy50cmlnZ2VyVG9vbGJhciA9IHRyaWdnZXJUb29sYmFyO1xyXG5cdFx0XHR0aGlzLmNsZWFyVG9vbGJhciA9IGNsZWFyVG9vbGJhcjtcclxuXHRcdFx0dGhpcy50b2dnbGVUb29sYmFyID0gdG9nZ2xlVG9vbGJhcjtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0ZGVzdHJveUZpbHRlclRvb2xiYXI6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRpZiAoIXRoaXMuZnRvb2xiYXIpIHtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy50cmlnZ2VyVG9vbGJhciA9IG51bGw7XHJcblx0XHRcdHRoaXMuY2xlYXJUb29sYmFyID0gbnVsbDtcclxuXHRcdFx0dGhpcy50b2dnbGVUb29sYmFyID0gbnVsbDtcclxuXHRcdFx0dGhpcy5mdG9vbGJhciA9IGZhbHNlO1xyXG5cdFx0XHQkKHRoaXMuZ3JpZC5oRGl2KS5maW5kKFwidGFibGUgdGhlYWQgdHIudWktc2VhcmNoLXRvb2xiYXJcIikucmVtb3ZlKCk7XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdGRlc3Ryb3lHcm91cEhlYWRlciA6IGZ1bmN0aW9uKG51bGxIZWFkZXIpXHJcblx0e1xyXG5cdFx0aWYobnVsbEhlYWRlciA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdG51bGxIZWFkZXIgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpXHJcblx0XHR7XHJcblx0XHRcdHZhciAkdCA9IHRoaXMsICR0ciwgaSwgbCwgaGVhZGVycywgJHRoLCAkcmVzaXppbmcsIGdyaWQgPSAkdC5ncmlkLFxyXG5cdFx0XHR0aGVhZCA9ICQoXCJ0YWJsZS51aS1qcWdyaWQtaHRhYmxlIHRoZWFkXCIsIGdyaWQuaERpdiksIGNtID0gJHQucC5jb2xNb2RlbCwgaGM7XHJcblx0XHRcdGlmKCFncmlkKSB7IHJldHVybjsgfVxyXG5cclxuXHRcdFx0JCh0aGlzKS51bmJpbmQoJy5zZXRHcm91cEhlYWRlcnMnKTtcclxuXHRcdFx0JHRyID0gJChcIjx0cj5cIiwge3JvbGU6IFwicm93aGVhZGVyXCJ9KS5hZGRDbGFzcyhcInVpLWpxZ3JpZC1sYWJlbHNcIik7XHJcblx0XHRcdGhlYWRlcnMgPSBncmlkLmhlYWRlcnM7XHJcblx0XHRcdGZvciAoaSA9IDAsIGwgPSBoZWFkZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG5cdFx0XHRcdGhjID0gY21baV0uaGlkZGVuID8gXCJub25lXCIgOiBcIlwiO1xyXG5cdFx0XHRcdCR0aCA9ICQoaGVhZGVyc1tpXS5lbClcclxuXHRcdFx0XHRcdC53aWR0aChoZWFkZXJzW2ldLndpZHRoKVxyXG5cdFx0XHRcdFx0LmNzcygnZGlzcGxheScsaGMpO1xyXG5cdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHQkdGgucmVtb3ZlQXR0cihcInJvd1NwYW5cIik7XHJcblx0XHRcdFx0fSBjYXRjaCAocnMpIHtcclxuXHRcdFx0XHRcdC8vSUUgNi83XHJcblx0XHRcdFx0XHQkdGguYXR0cihcInJvd1NwYW5cIiwxKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JHRyLmFwcGVuZCgkdGgpO1xyXG5cdFx0XHRcdCRyZXNpemluZyA9ICR0aC5jaGlsZHJlbihcInNwYW4udWktanFncmlkLXJlc2l6ZVwiKTtcclxuXHRcdFx0XHRpZiAoJHJlc2l6aW5nLmxlbmd0aD4wKSB7Ly8gcmVzaXphYmxlIGNvbHVtblxyXG5cdFx0XHRcdFx0JHJlc2l6aW5nWzBdLnN0eWxlLmhlaWdodCA9IFwiXCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCR0aC5jaGlsZHJlbihcImRpdlwiKVswXS5zdHlsZS50b3AgPSBcIlwiO1xyXG5cdFx0XHR9XHJcblx0XHRcdCQodGhlYWQpLmNoaWxkcmVuKCd0ci51aS1qcWdyaWQtbGFiZWxzJykucmVtb3ZlKCk7XHJcblx0XHRcdCQodGhlYWQpLnByZXBlbmQoJHRyKTtcclxuXHJcblx0XHRcdGlmKG51bGxIZWFkZXIgPT09IHRydWUpIHtcclxuXHRcdFx0XHQkKCR0KS5qcUdyaWQoJ3NldEdyaWRQYXJhbScseyAnZ3JvdXBIZWFkZXInOiBudWxsfSk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0c2V0R3JvdXBIZWFkZXJzIDogZnVuY3Rpb24gKCBvICkge1xyXG5cdFx0byA9ICQuZXh0ZW5kKHtcclxuXHRcdFx0dXNlQ29sU3BhblN0eWxlIDogIGZhbHNlLFxyXG5cdFx0XHRncm91cEhlYWRlcnM6IFtdXHJcblx0XHR9LG8gIHx8IHt9KTtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dGhpcy5wLmdyb3VwSGVhZGVyID0gbztcclxuXHRcdFx0dmFyIHRzID0gdGhpcyxcclxuXHRcdFx0aSwgY21pLCBza2lwID0gMCwgJHRyLCAkY29sSGVhZGVyLCB0aCwgJHRoLCB0aFN0eWxlLFxyXG5cdFx0XHRpQ29sLFxyXG5cdFx0XHRjZ2hpLFxyXG5cdFx0XHQvL3N0YXJ0Q29sdW1uTmFtZSxcclxuXHRcdFx0bnVtYmVyT2ZDb2x1bW5zLFxyXG5cdFx0XHR0aXRsZVRleHQsXHJcblx0XHRcdGNWaXNpYmxlQ29sdW1ucyxcclxuXHRcdFx0Y29sTW9kZWwgPSB0cy5wLmNvbE1vZGVsLFxyXG5cdFx0XHRjbWwgPSBjb2xNb2RlbC5sZW5ndGgsXHJcblx0XHRcdHRocyA9IHRzLmdyaWQuaGVhZGVycyxcclxuXHRcdFx0JGh0YWJsZSA9ICQoXCJ0YWJsZS51aS1qcWdyaWQtaHRhYmxlXCIsIHRzLmdyaWQuaERpdiksXHJcblx0XHRcdCR0ckxhYmVscyA9ICRodGFibGUuY2hpbGRyZW4oXCJ0aGVhZFwiKS5jaGlsZHJlbihcInRyLnVpLWpxZ3JpZC1sYWJlbHM6bGFzdFwiKS5hZGRDbGFzcyhcImpxZy1zZWNvbmQtcm93LWhlYWRlclwiKSxcclxuXHRcdFx0JHRoZWFkID0gJGh0YWJsZS5jaGlsZHJlbihcInRoZWFkXCIpLFxyXG5cdFx0XHQkdGhlYWRJblRhYmxlLFxyXG5cdFx0XHQkZmlyc3RIZWFkZXJSb3cgPSAkaHRhYmxlLmZpbmQoXCIuanFnLWZpcnN0LXJvdy1oZWFkZXJcIik7XHJcblx0XHRcdGlmKCRmaXJzdEhlYWRlclJvd1swXSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0JGZpcnN0SGVhZGVyUm93ID0gJCgnPHRyPicsIHtyb2xlOiBcInJvd1wiLCBcImFyaWEtaGlkZGVuXCI6IFwidHJ1ZVwifSkuYWRkQ2xhc3MoXCJqcWctZmlyc3Qtcm93LWhlYWRlclwiKS5jc3MoXCJoZWlnaHRcIiwgXCJhdXRvXCIpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCRmaXJzdEhlYWRlclJvdy5lbXB0eSgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciAkZmlyc3RSb3csXHJcblx0XHRcdGluQ29sdW1uSGVhZGVyID0gZnVuY3Rpb24gKHRleHQsIGNvbHVtbkhlYWRlcnMpIHtcclxuXHRcdFx0XHR2YXIgbGVuZ3RoID0gY29sdW1uSGVhZGVycy5sZW5ndGgsIGk7XHJcblx0XHRcdFx0Zm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0XHRpZiAoY29sdW1uSGVhZGVyc1tpXS5zdGFydENvbHVtbk5hbWUgPT09IHRleHQpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiAtMTtcclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdCQodHMpLnByZXBlbmQoJHRoZWFkKTtcclxuXHRcdFx0JHRyID0gJCgnPHRyPicsIHtyb2xlOiBcInJvd2hlYWRlclwifSkuYWRkQ2xhc3MoXCJ1aS1qcWdyaWQtbGFiZWxzIGpxZy10aGlyZC1yb3ctaGVhZGVyXCIpO1xyXG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgY21sOyBpKyspIHtcclxuXHRcdFx0XHR0aCA9IHRoc1tpXS5lbDtcclxuXHRcdFx0XHQkdGggPSAkKHRoKTtcclxuXHRcdFx0XHRjbWkgPSBjb2xNb2RlbFtpXTtcclxuXHRcdFx0XHQvLyBidWlsZCB0aGUgbmV4dCBjZWxsIGZvciB0aGUgZmlyc3QgaGVhZGVyIHJvd1xyXG5cdFx0XHRcdHRoU3R5bGUgPSB7IGhlaWdodDogJzBweCcsIHdpZHRoOiB0aHNbaV0ud2lkdGggKyAncHgnLCBkaXNwbGF5OiAoY21pLmhpZGRlbiA/ICdub25lJyA6ICcnKX07XHJcblx0XHRcdFx0JChcIjx0aD5cIiwge3JvbGU6ICdncmlkY2VsbCd9KS5jc3ModGhTdHlsZSkuYWRkQ2xhc3MoXCJ1aS1maXJzdC10aC1cIit0cy5wLmRpcmVjdGlvbikuYXBwZW5kVG8oJGZpcnN0SGVhZGVyUm93KTtcclxuXHJcblx0XHRcdFx0dGguc3R5bGUud2lkdGggPSBcIlwiOyAvLyByZW1vdmUgdW5uZWVkZWQgc3R5bGVcclxuXHRcdFx0XHRpQ29sID0gaW5Db2x1bW5IZWFkZXIoY21pLm5hbWUsIG8uZ3JvdXBIZWFkZXJzKTtcclxuXHRcdFx0XHRpZiAoaUNvbCA+PSAwKSB7XHJcblx0XHRcdFx0XHRjZ2hpID0gby5ncm91cEhlYWRlcnNbaUNvbF07XHJcblx0XHRcdFx0XHRudW1iZXJPZkNvbHVtbnMgPSBjZ2hpLm51bWJlck9mQ29sdW1ucztcclxuXHRcdFx0XHRcdHRpdGxlVGV4dCA9IGNnaGkudGl0bGVUZXh0O1xyXG5cclxuXHRcdFx0XHRcdC8vIGNhY2x1bGF0ZSB0aGUgbnVtYmVyIG9mIHZpc2libGUgY29sdW1ucyBmcm9tIHRoZSBuZXh0IG51bWJlck9mQ29sdW1ucyBjb2x1bW5zXHJcblx0XHRcdFx0XHRmb3IgKGNWaXNpYmxlQ29sdW1ucyA9IDAsIGlDb2wgPSAwOyBpQ29sIDwgbnVtYmVyT2ZDb2x1bW5zICYmIChpICsgaUNvbCA8IGNtbCk7IGlDb2wrKykge1xyXG5cdFx0XHRcdFx0XHRpZiAoIWNvbE1vZGVsW2kgKyBpQ29sXS5oaWRkZW4pIHtcclxuXHRcdFx0XHRcdFx0XHRjVmlzaWJsZUNvbHVtbnMrKztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdC8vIFRoZSBuZXh0IG51bWJlck9mQ29sdW1ucyBoZWFkZXJzIHdpbGwgYmUgbW92ZWQgaW4gdGhlIG5leHQgcm93XHJcblx0XHRcdFx0XHQvLyBpbiB0aGUgY3VycmVudCByb3cgd2lsbCBiZSBwbGFjZWQgdGhlIG5ldyBjb2x1bW4gaGVhZGVyIHdpdGggdGhlIHRpdGxlVGV4dC5cclxuXHRcdFx0XHRcdC8vIFRoZSB0ZXh0IHdpbGwgYmUgb3ZlciB0aGUgY1Zpc2libGVDb2x1bW5zIGNvbHVtbnNcclxuXHRcdFx0XHRcdCRjb2xIZWFkZXIgPSAkKCc8dGg+JykuYXR0cih7cm9sZTogXCJjb2x1bW5oZWFkZXJcIn0pXHJcblx0XHRcdFx0XHRcdC5hZGRDbGFzcyhcInVpLXN0YXRlLWRlZmF1bHQgdWktdGgtY29sdW1uLWhlYWRlciB1aS10aC1cIit0cy5wLmRpcmVjdGlvbilcclxuXHRcdFx0XHRcdFx0LmNzcyh7J2hlaWdodCc6JzIycHgnLCAnYm9yZGVyLXRvcCc6ICcwIG5vbmUnfSlcclxuXHRcdFx0XHRcdFx0Lmh0bWwodGl0bGVUZXh0KTtcclxuXHRcdFx0XHRcdGlmKGNWaXNpYmxlQ29sdW1ucyA+IDApIHtcclxuXHRcdFx0XHRcdFx0JGNvbEhlYWRlci5hdHRyKFwiY29sc3BhblwiLCBTdHJpbmcoY1Zpc2libGVDb2x1bW5zKSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAodHMucC5oZWFkZXJ0aXRsZXMpIHtcclxuXHRcdFx0XHRcdFx0JGNvbEhlYWRlci5hdHRyKFwidGl0bGVcIiwgJGNvbEhlYWRlci50ZXh0KCkpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Ly8gaGlkZSBpZiBub3QgYSB2aXNpYmxlIGNvbHNcclxuXHRcdFx0XHRcdGlmKCBjVmlzaWJsZUNvbHVtbnMgPT09IDApIHtcclxuXHRcdFx0XHRcdFx0JGNvbEhlYWRlci5oaWRlKCk7XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0JHRoLmJlZm9yZSgkY29sSGVhZGVyKTsgLy8gaW5zZXJ0IG5ldyBjb2x1bW4gaGVhZGVyIGJlZm9yZSB0aGUgY3VycmVudFxyXG5cdFx0XHRcdFx0JHRyLmFwcGVuZCh0aCk7ICAgICAgICAgLy8gbW92ZSB0aGUgY3VycmVudCBoZWFkZXIgaW4gdGhlIG5leHQgcm93XHJcblxyXG5cdFx0XHRcdFx0Ly8gc2V0IHRoZSBjb3VtdGVyIG9mIGhlYWRlcnMgd2hpY2ggd2lsbCBiZSBtb3ZlZCBpbiB0aGUgbmV4dCByb3dcclxuXHRcdFx0XHRcdHNraXAgPSBudW1iZXJPZkNvbHVtbnMgLSAxO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRpZiAoc2tpcCA9PT0gMCkge1xyXG5cdFx0XHRcdFx0XHRpZiAoby51c2VDb2xTcGFuU3R5bGUpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBleHBhbmQgdGhlIGhlYWRlciBoZWlnaHQgdG8gdHdvIHJvd3NcclxuXHRcdFx0XHRcdFx0XHQkdGguYXR0cihcInJvd3NwYW5cIiwgXCIyXCIpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdCQoJzx0aD4nLCB7cm9sZTogXCJjb2x1bW5oZWFkZXJcIn0pXHJcblx0XHRcdFx0XHRcdFx0XHQuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1kZWZhdWx0IHVpLXRoLWNvbHVtbi1oZWFkZXIgdWktdGgtXCIrdHMucC5kaXJlY3Rpb24pXHJcblx0XHRcdFx0XHRcdFx0XHQuY3NzKHtcImRpc3BsYXlcIjogY21pLmhpZGRlbiA/ICdub25lJyA6ICcnLCAnYm9yZGVyLXRvcCc6ICcwIG5vbmUnfSlcclxuXHRcdFx0XHRcdFx0XHRcdC5pbnNlcnRCZWZvcmUoJHRoKTtcclxuXHRcdFx0XHRcdFx0XHQkdHIuYXBwZW5kKHRoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0Ly8gbW92ZSB0aGUgaGVhZGVyIHRvIHRoZSBuZXh0IHJvd1xyXG5cdFx0XHRcdFx0XHQvLyR0aC5jc3Moe1wicGFkZGluZy10b3BcIjogXCIycHhcIiwgaGVpZ2h0OiBcIjE5cHhcIn0pO1xyXG5cdFx0XHRcdFx0XHQkdHIuYXBwZW5kKHRoKTtcclxuXHRcdFx0XHRcdFx0c2tpcC0tO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHQkdGhlYWRJblRhYmxlID0gJCh0cykuY2hpbGRyZW4oXCJ0aGVhZFwiKTtcclxuXHRcdFx0JHRoZWFkSW5UYWJsZS5wcmVwZW5kKCRmaXJzdEhlYWRlclJvdyk7XHJcblx0XHRcdCR0ci5pbnNlcnRBZnRlcigkdHJMYWJlbHMpO1xyXG5cdFx0XHQkaHRhYmxlLmFwcGVuZCgkdGhlYWRJblRhYmxlKTtcclxuXHJcblx0XHRcdGlmIChvLnVzZUNvbFNwYW5TdHlsZSkge1xyXG5cdFx0XHRcdC8vIEluY3JlYXNlIHRoZSBoZWlnaHQgb2YgcmVzaXppbmcgc3BhbiBvZiB2aXNpYmxlIGhlYWRlcnNcclxuXHRcdFx0XHQkaHRhYmxlLmZpbmQoXCJzcGFuLnVpLWpxZ3JpZC1yZXNpemVcIikuZWFjaChmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0XHR2YXIgJHBhcmVudCA9ICQodGhpcykucGFyZW50KCk7XHJcblx0XHRcdFx0XHRpZiAoJHBhcmVudC5pcyhcIjp2aXNpYmxlXCIpKSB7XHJcblx0XHRcdFx0XHRcdHRoaXMuc3R5bGUuY3NzVGV4dCA9ICdoZWlnaHQ6ICcgKyAkcGFyZW50LmhlaWdodCgpICsgJ3B4ICFpbXBvcnRhbnQ7IGN1cnNvcjogY29sLXJlc2l6ZTsnO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHQvLyBTZXQgcG9zaXRpb24gb2YgdGhlIHNvcnRhYmxlIGRpdiAodGhlIG1haW4gbGFibGUpXHJcblx0XHRcdFx0Ly8gd2l0aCB0aGUgY29sdW1uIGhlYWRlciB0ZXh0IHRvIHRoZSBtaWRkbGUgb2YgdGhlIGNlbGwuXHJcblx0XHRcdFx0Ly8gT25lIHNob3VsZCBub3QgZG8gdGhpcyBmb3IgaGlkZGVuIGhlYWRlcnMuXHJcblx0XHRcdFx0JGh0YWJsZS5maW5kKFwiZGl2LnVpLWpxZ3JpZC1zb3J0YWJsZVwiKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRcdHZhciAkdHMgPSAkKHRoaXMpLCAkcGFyZW50ID0gJHRzLnBhcmVudCgpO1xyXG5cdFx0XHRcdFx0aWYgKCRwYXJlbnQuaXMoXCI6dmlzaWJsZVwiKSAmJiAkcGFyZW50LmlzKFwiOmhhcyhzcGFuLnVpLWpxZ3JpZC1yZXNpemUpXCIpKSB7XHJcblx0XHRcdFx0XHRcdCR0cy5jc3MoJ3RvcCcsICgkcGFyZW50LmhlaWdodCgpIC0gJHRzLm91dGVySGVpZ2h0KCkpIC8gMiArICdweCcpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQkZmlyc3RSb3cgPSAkdGhlYWRJblRhYmxlLmZpbmQoXCJ0ci5qcWctZmlyc3Qtcm93LWhlYWRlclwiKTtcclxuXHRcdFx0JCh0cykuYmluZCgnanFHcmlkUmVzaXplU3RvcC5zZXRHcm91cEhlYWRlcnMnLCBmdW5jdGlvbiAoZSwgbncsIGlkeCkge1xyXG5cdFx0XHRcdCRmaXJzdFJvdy5maW5kKCd0aCcpLmVxKGlkeCkud2lkdGgobncpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0c2V0RnJvemVuQ29sdW1ucyA6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmICggIXRoaXMuZ3JpZCApIHtyZXR1cm47fVxyXG5cdFx0XHR2YXIgJHQgPSB0aGlzLCBjbSA9ICR0LnAuY29sTW9kZWwsaT0wLCBsZW4gPSBjbS5sZW5ndGgsIG1heGZyb3plbiA9IC0xLCBmcm96ZW49IGZhbHNlO1xyXG5cdFx0XHQvLyBUT0RPIHRyZWVHcmlkIGFuZCBncm91cGluZyAgU3VwcG9ydFxyXG5cdFx0XHRpZigkdC5wLnN1YkdyaWQgPT09IHRydWUgfHwgJHQucC50cmVlR3JpZCA9PT0gdHJ1ZSB8fCAkdC5wLmNlbGxFZGl0ID09PSB0cnVlIHx8ICR0LnAuc29ydGFibGUgfHwgJHQucC5zY3JvbGwgKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKCR0LnAucm93bnVtYmVycykgeyBpKys7IH1cclxuXHRcdFx0aWYoJHQucC5tdWx0aXNlbGVjdCkgeyBpKys7IH1cclxuXHJcblx0XHRcdC8vIGdldCB0aGUgbWF4IGluZGV4IG9mIGZyb3plbiBjb2xcclxuXHRcdFx0d2hpbGUoaTxsZW4pXHJcblx0XHRcdHtcclxuXHRcdFx0XHQvLyBmcm9tIGxlZnQsIG5vIGJyZWFraW5nIGZyb3plblxyXG5cdFx0XHRcdGlmKGNtW2ldLmZyb3plbiA9PT0gdHJ1ZSlcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRmcm96ZW4gPSB0cnVlO1xyXG5cdFx0XHRcdFx0bWF4ZnJvemVuID0gaTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGkrKztcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiggbWF4ZnJvemVuPj0wICYmIGZyb3plbikge1xyXG5cdFx0XHRcdHZhciB0b3AgPSAkdC5wLmNhcHRpb24gPyAkKCR0LmdyaWQuY0Rpdikub3V0ZXJIZWlnaHQoKSA6IDAsXHJcblx0XHRcdFx0aHRoID0gJChcIi51aS1qcWdyaWQtaHRhYmxlXCIsXCIjZ3ZpZXdfXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpKS5oZWlnaHQoKTtcclxuXHRcdFx0XHQvL2hlYWRlcnNcclxuXHRcdFx0XHRpZigkdC5wLnRvcHBhZ2VyKSB7XHJcblx0XHRcdFx0XHR0b3AgPSB0b3AgKyAkKCR0LmdyaWQudG9wRGl2KS5vdXRlckhlaWdodCgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZigkdC5wLnRvb2xiYXJbMF0gPT09IHRydWUpIHtcclxuXHRcdFx0XHRcdGlmKCR0LnAudG9vbGJhclsxXSAhPT0gXCJib3R0b21cIikge1xyXG5cdFx0XHRcdFx0XHR0b3AgPSB0b3AgKyAkKCR0LmdyaWQudURpdikub3V0ZXJIZWlnaHQoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JHQuZ3JpZC5maERpdiA9ICQoJzxkaXYgc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjBweDt0b3A6Jyt0b3ArJ3B4O2hlaWdodDonK2h0aCsncHg7XCIgY2xhc3M9XCJmcm96ZW4tZGl2IHVpLXN0YXRlLWRlZmF1bHQgdWktanFncmlkLWhkaXZcIj48L2Rpdj4nKTtcclxuXHRcdFx0XHQkdC5ncmlkLmZiRGl2ID0gJCgnPGRpdiBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6MHB4O3RvcDonKyhwYXJzZUludCh0b3AsMTApK3BhcnNlSW50KGh0aCwxMCkgKyAxKSsncHg7b3ZlcmZsb3cteTpoaWRkZW5cIiBjbGFzcz1cImZyb3plbi1iZGl2IHVpLWpxZ3JpZC1iZGl2XCI+PC9kaXY+Jyk7XHJcblx0XHRcdFx0JChcIiNndmlld19cIiskLmpncmlkLmpxSUQoJHQucC5pZCkpLmFwcGVuZCgkdC5ncmlkLmZoRGl2KTtcclxuXHRcdFx0XHR2YXIgaHRibCA9ICQoXCIudWktanFncmlkLWh0YWJsZVwiLFwiI2d2aWV3X1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKSkuY2xvbmUodHJ1ZSk7XHJcblx0XHRcdFx0Ly8gZ3JvdXBoZWFkZXIgc3VwcG9ydCAtIG9ubHkgaWYgdXNlQ29sU3BhbnN0eWxlIGlzIGZhbHNlXHJcblx0XHRcdFx0aWYoJHQucC5ncm91cEhlYWRlcikge1xyXG5cdFx0XHRcdFx0JChcInRyLmpxZy1maXJzdC1yb3ctaGVhZGVyLCB0ci5qcWctdGhpcmQtcm93LWhlYWRlclwiLCBodGJsKS5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRcdCQoXCJ0aDpndChcIittYXhmcm96ZW4rXCIpXCIsdGhpcykucmVtb3ZlKCk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdHZhciBzd2FwZnJveiA9IC0xLCBmZGVsID0gLTEsIGNzLCBycztcclxuXHRcdFx0XHRcdCQoXCJ0ci5qcWctc2Vjb25kLXJvdy1oZWFkZXIgdGhcIiwgaHRibCkuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0XHRjcz0gcGFyc2VJbnQoJCh0aGlzKS5hdHRyKFwiY29sc3BhblwiKSwxMCk7XHJcblx0XHRcdFx0XHRcdHJzPSBwYXJzZUludCgkKHRoaXMpLmF0dHIoXCJyb3dzcGFuXCIpLDEwKTtcclxuXHRcdFx0XHRcdFx0aWYocnMpIHtcclxuXHRcdFx0XHRcdFx0XHRzd2FwZnJveisrO1xyXG5cdFx0XHRcdFx0XHRcdGZkZWwrKztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZihjcykge1xyXG5cdFx0XHRcdFx0XHRcdHN3YXBmcm96ID0gc3dhcGZyb3orY3M7XHJcblx0XHRcdFx0XHRcdFx0ZmRlbCsrO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmKHN3YXBmcm96ID09PSBtYXhmcm96ZW4pIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aWYoc3dhcGZyb3ogIT09IG1heGZyb3plbikge1xyXG5cdFx0XHRcdFx0XHRmZGVsID0gbWF4ZnJvemVuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0JChcInRyLmpxZy1zZWNvbmQtcm93LWhlYWRlclwiLCBodGJsKS5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRcdCQoXCJ0aDpndChcIitmZGVsK1wiKVwiLHRoaXMpLnJlbW92ZSgpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCQoXCJ0clwiLGh0YmwpLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdFx0JChcInRoOmd0KFwiK21heGZyb3plbitcIilcIix0aGlzKS5yZW1vdmUoKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQkKGh0YmwpLndpZHRoKDEpO1xyXG5cdFx0XHRcdC8vIHJlc2l6aW5nIHN0dWZmXHJcblx0XHRcdFx0JCgkdC5ncmlkLmZoRGl2KS5hcHBlbmQoaHRibClcclxuXHRcdFx0XHQubW91c2Vtb3ZlKGZ1bmN0aW9uIChlKSB7XHJcblx0XHRcdFx0XHRpZigkdC5ncmlkLnJlc2l6aW5nKXsgJHQuZ3JpZC5kcmFnTW92ZShlKTtyZXR1cm4gZmFsc2U7IH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHQkKCR0KS5iaW5kKCdqcUdyaWRSZXNpemVTdG9wLnNldEZyb3plbkNvbHVtbnMnLCBmdW5jdGlvbiAoZSwgdywgaW5kZXgpIHtcclxuXHRcdFx0XHRcdHZhciByaHRoID0gJChcIi51aS1qcWdyaWQtaHRhYmxlXCIsJHQuZ3JpZC5maERpdik7XHJcblx0XHRcdFx0XHQkKFwidGg6ZXEoXCIraW5kZXgrXCIpXCIscmh0aCkud2lkdGgoIHcgKTtcclxuXHRcdFx0XHRcdHZhciBidGQgPSAkKFwiLnVpLWpxZ3JpZC1idGFibGVcIiwkdC5ncmlkLmZiRGl2KTtcclxuXHRcdFx0XHRcdCQoXCJ0cjpmaXJzdCB0ZDplcShcIitpbmRleCtcIilcIixidGQpLndpZHRoKCB3ICk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0Ly8gc29ydGluZyBzdHVmZlxyXG5cdFx0XHRcdCQoJHQpLmJpbmQoJ2pxR3JpZFNvcnRDb2wuc2V0RnJvemVuQ29sdW1ucycsIGZ1bmN0aW9uIChlLCBpbmRleCwgaWR4Y29sKSB7XHJcblxyXG5cdFx0XHRcdFx0dmFyIHByZXZpb3VzU2VsZWN0ZWRUaCA9ICQoXCJ0ci51aS1qcWdyaWQtbGFiZWxzOmxhc3QgdGg6ZXEoXCIrJHQucC5sYXN0c29ydCtcIilcIiwkdC5ncmlkLmZoRGl2KSwgbmV3U2VsZWN0ZWRUaCA9ICQoXCJ0ci51aS1qcWdyaWQtbGFiZWxzOmxhc3QgdGg6ZXEoXCIraWR4Y29sK1wiKVwiLCR0LmdyaWQuZmhEaXYpO1xyXG5cclxuXHRcdFx0XHRcdCQoXCJzcGFuLnVpLWdyaWQtaWNvLXNvcnRcIixwcmV2aW91c1NlbGVjdGVkVGgpLmFkZENsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpO1xyXG5cdFx0XHRcdFx0JChwcmV2aW91c1NlbGVjdGVkVGgpLmF0dHIoXCJhcmlhLXNlbGVjdGVkXCIsXCJmYWxzZVwiKTtcclxuXHRcdFx0XHRcdCQoXCJzcGFuLnVpLWljb24tXCIrJHQucC5zb3J0b3JkZXIsbmV3U2VsZWN0ZWRUaCkucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0XHRcdFx0XHQkKG5ld1NlbGVjdGVkVGgpLmF0dHIoXCJhcmlhLXNlbGVjdGVkXCIsXCJ0cnVlXCIpO1xyXG5cdFx0XHRcdFx0aWYoISR0LnAudmlld3NvcnRjb2xzWzBdKSB7XHJcblx0XHRcdFx0XHRcdGlmKCR0LnAubGFzdHNvcnQgIT09IGlkeGNvbCkge1xyXG5cdFx0XHRcdFx0XHRcdCQoXCJzcGFuLnMtaWNvXCIscHJldmlvdXNTZWxlY3RlZFRoKS5oaWRlKCk7XHJcblx0XHRcdFx0XHRcdFx0JChcInNwYW4ucy1pY29cIixuZXdTZWxlY3RlZFRoKS5zaG93KCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0Ly8gZGF0YSBzdHVmZlxyXG5cdFx0XHRcdC8vVE9ETyBzdXBwb3J0IGZvciBzZXRSb3dEYXRhXHJcblx0XHRcdFx0JChcIiNndmlld19cIiskLmpncmlkLmpxSUQoJHQucC5pZCkpLmFwcGVuZCgkdC5ncmlkLmZiRGl2KTtcclxuXHRcdFx0XHQkKCR0LmdyaWQuYkRpdikuc2Nyb2xsKGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRcdCQoJHQuZ3JpZC5mYkRpdikuc2Nyb2xsVG9wKCQodGhpcykuc2Nyb2xsVG9wKCkpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdGlmKCR0LnAuaG92ZXJyb3dzID09PSB0cnVlKSB7XHJcblx0XHRcdFx0XHQkKFwiI1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKSkudW5iaW5kKCdtb3VzZW92ZXInKS51bmJpbmQoJ21vdXNlb3V0Jyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCQoJHQpLmJpbmQoJ2pxR3JpZEFmdGVyR3JpZENvbXBsZXRlLnNldEZyb3plbkNvbHVtbnMnLCBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0XHQkKFwiI1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKStcIl9mcm96ZW5cIikucmVtb3ZlKCk7XHJcblx0XHRcdFx0XHQkKCR0LmdyaWQuZmJEaXYpLmhlaWdodCgkKCR0LmdyaWQuYkRpdikuaGVpZ2h0KCktMTYpO1xyXG5cdFx0XHRcdFx0dmFyIGJ0YmwgPSAkKFwiI1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKSkuY2xvbmUodHJ1ZSk7XHJcblx0XHRcdFx0XHQkKFwidHJbcm9sZT1yb3ddXCIsYnRibCkuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0XHQkKFwidGRbcm9sZT1ncmlkY2VsbF06Z3QoXCIrbWF4ZnJvemVuK1wiKVwiLHRoaXMpLnJlbW92ZSgpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRcdFx0JChidGJsKS53aWR0aCgxKS5hdHRyKFwiaWRcIiwkdC5wLmlkK1wiX2Zyb3plblwiKTtcclxuXHRcdFx0XHRcdCQoJHQuZ3JpZC5mYkRpdikuYXBwZW5kKGJ0YmwpO1xyXG5cdFx0XHRcdFx0aWYoJHQucC5ob3ZlcnJvd3MgPT09IHRydWUpIHtcclxuXHRcdFx0XHRcdFx0JChcInRyLmpxZ3Jvd1wiLCBidGJsKS5ob3ZlcihcclxuXHRcdFx0XHRcdFx0XHRmdW5jdGlvbigpeyAkKHRoaXMpLmFkZENsYXNzKFwidWktc3RhdGUtaG92ZXJcIik7ICQoXCIjXCIrJC5qZ3JpZC5qcUlEKHRoaXMuaWQpLCBcIiNcIiskLmpncmlkLmpxSUQoJHQucC5pZCkpLmFkZENsYXNzKFwidWktc3RhdGUtaG92ZXJcIik7IH0sXHJcblx0XHRcdFx0XHRcdFx0ZnVuY3Rpb24oKXsgJCh0aGlzKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWhvdmVyXCIpOyAkKFwiI1wiKyQuamdyaWQuanFJRCh0aGlzLmlkKSwgXCIjXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWhvdmVyXCIpOyB9XHJcblx0XHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0XHRcdCQoXCJ0ci5qcWdyb3dcIiwgXCIjXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpKS5ob3ZlcihcclxuXHRcdFx0XHRcdFx0XHRmdW5jdGlvbigpeyAkKHRoaXMpLmFkZENsYXNzKFwidWktc3RhdGUtaG92ZXJcIik7ICQoXCIjXCIrJC5qZ3JpZC5qcUlEKHRoaXMuaWQpLCBcIiNcIiskLmpncmlkLmpxSUQoJHQucC5pZCkrXCJfZnJvemVuXCIpLmFkZENsYXNzKFwidWktc3RhdGUtaG92ZXJcIik7fSxcclxuXHRcdFx0XHRcdFx0XHRmdW5jdGlvbigpeyAkKHRoaXMpLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtaG92ZXJcIik7ICQoXCIjXCIrJC5qZ3JpZC5qcUlEKHRoaXMuaWQpLCBcIiNcIiskLmpncmlkLmpxSUQoJHQucC5pZCkrXCJfZnJvemVuXCIpLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtaG92ZXJcIik7IH1cclxuXHRcdFx0XHRcdFx0KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGJ0Ymw9bnVsbDtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRpZighJHQuZ3JpZC5oRGl2LmxvYWRpbmcpIHtcclxuXHRcdFx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWZ0ZXJHcmlkQ29tcGxldGVcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCR0LnAuZnJvemVuQ29sdW1ucyA9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0ZGVzdHJveUZyb3plbkNvbHVtbnMgOiAgZnVuY3Rpb24oKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZiAoICF0aGlzLmdyaWQgKSB7cmV0dXJuO31cclxuXHRcdFx0aWYodGhpcy5wLmZyb3plbkNvbHVtbnMgPT09IHRydWUpIHtcclxuXHRcdFx0XHR2YXIgJHQgPSB0aGlzO1xyXG5cdFx0XHRcdCQoJHQuZ3JpZC5maERpdikucmVtb3ZlKCk7XHJcblx0XHRcdFx0JCgkdC5ncmlkLmZiRGl2KS5yZW1vdmUoKTtcclxuXHRcdFx0XHQkdC5ncmlkLmZoRGl2ID0gbnVsbDsgJHQuZ3JpZC5mYkRpdj1udWxsO1xyXG5cdFx0XHRcdCQodGhpcykudW5iaW5kKCcuc2V0RnJvemVuQ29sdW1ucycpO1xyXG5cdFx0XHRcdGlmKCR0LnAuaG92ZXJyb3dzID09PSB0cnVlKSB7XHJcblx0XHRcdFx0XHR2YXIgcHRyO1xyXG5cdFx0XHRcdFx0JChcIiNcIiskLmpncmlkLmpxSUQoJHQucC5pZCkpLmJpbmQoJ21vdXNlb3ZlcicsZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdFx0XHRwdHIgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KFwidHIuanFncm93XCIpO1xyXG5cdFx0XHRcdFx0XHRpZigkKHB0cikuYXR0cihcImNsYXNzXCIpICE9PSBcInVpLXN1YmdyaWRcIikge1xyXG5cdFx0XHRcdFx0XHQkKHB0cikuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1ob3ZlclwiKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pLmJpbmQoJ21vdXNlb3V0JyxmdW5jdGlvbihlKSB7XHJcblx0XHRcdFx0XHRcdHB0ciA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoXCJ0ci5qcWdyb3dcIik7XHJcblx0XHRcdFx0XHRcdCQocHRyKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWhvdmVyXCIpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHRoaXMucC5mcm96ZW5Db2x1bW5zID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufSk7XHJcbn0pKGpRdWVyeSk7XHJcbi8qXHJcbiAqIGpxTW9kYWwgLSBNaW5pbWFsaXN0IE1vZGFsaW5nIHdpdGggalF1ZXJ5XHJcbiAqICAgKGh0dHA6Ly9kZXYuaWNlYnVyZy5uZXQvanF1ZXJ5L2pxbW9kYWwvKVxyXG4gKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMDcsMjAwOCBCcmljZSBCdXJnZXNzIDxiaGJAaWNlYnVyZy5uZXQ+XHJcbiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBhbmQgR1BMIGxpY2Vuc2VzOlxyXG4gKiAgIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXHJcbiAqICAgaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2dwbC5odG1sXHJcbiAqXHJcbiAqICRWZXJzaW9uOiAwNy8wNi8yMDA4ICtyMTNcclxuICovXHJcbihmdW5jdGlvbigkKSB7XHJcbiQuZm4uanFtPWZ1bmN0aW9uKG8pe1xyXG52YXIgcD17XHJcbm92ZXJsYXk6IDUwLFxyXG5jbG9zZW92ZXJsYXkgOiB0cnVlLFxyXG5vdmVybGF5Q2xhc3M6ICdqcW1PdmVybGF5JyxcclxuY2xvc2VDbGFzczogJ2pxbUNsb3NlJyxcclxudHJpZ2dlcjogJy5qcU1vZGFsJyxcclxuYWpheDogRixcclxuYWpheFRleHQ6ICcnLFxyXG50YXJnZXQ6IEYsXHJcbm1vZGFsOiBGLFxyXG50b1RvcDogRixcclxub25TaG93OiBGLFxyXG5vbkhpZGU6IEYsXHJcbm9uTG9hZDogRlxyXG59O1xyXG5yZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7aWYodGhpcy5fanFtKXJldHVybiBIW3RoaXMuX2pxbV0uYz0kLmV4dGVuZCh7fSxIW3RoaXMuX2pxbV0uYyxvKTtzKys7dGhpcy5fanFtPXM7XHJcbkhbc109e2M6JC5leHRlbmQocCwkLmpxbS5wYXJhbXMsbyksYTpGLHc6JCh0aGlzKS5hZGRDbGFzcygnanFtSUQnK3MpLHM6c307XHJcbmlmKHAudHJpZ2dlcikkKHRoaXMpLmpxbUFkZFRyaWdnZXIocC50cmlnZ2VyKTtcclxufSk7fTtcclxuXHJcbiQuZm4uanFtQWRkQ2xvc2U9ZnVuY3Rpb24oZSl7cmV0dXJuIGhzKHRoaXMsZSwnanFtSGlkZScpO307XHJcbiQuZm4uanFtQWRkVHJpZ2dlcj1mdW5jdGlvbihlKXtyZXR1cm4gaHModGhpcyxlLCdqcW1TaG93Jyk7fTtcclxuJC5mbi5qcW1TaG93PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXskLmpxbS5vcGVuKHRoaXMuX2pxbSx0KTt9KTt9O1xyXG4kLmZuLmpxbUhpZGU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpeyQuanFtLmNsb3NlKHRoaXMuX2pxbSx0KX0pO307XHJcblxyXG4kLmpxbSA9IHtcclxuaGFzaDp7fSxcclxub3BlbjpmdW5jdGlvbihzLHQpe3ZhciBoPUhbc10sYz1oLmMsY2M9Jy4nK2MuY2xvc2VDbGFzcyx6PShwYXJzZUludChoLncuY3NzKCd6LWluZGV4JykpKTt6PSh6PjApP3o6MzAwMDt2YXIgbz0kKCc8ZGl2PjwvZGl2PicpLmNzcyh7aGVpZ2h0OicxMDAlJyx3aWR0aDonMTAwJScscG9zaXRpb246J2ZpeGVkJyxsZWZ0OjAsdG9wOjAsJ3otaW5kZXgnOnotMSxvcGFjaXR5OmMub3ZlcmxheS8xMDB9KTtpZihoLmEpcmV0dXJuIEY7aC50PXQ7aC5hPXRydWU7aC53LmNzcygnei1pbmRleCcseik7XHJcbiBpZihjLm1vZGFsKSB7aWYoIUFbMF0pc2V0VGltZW91dChmdW5jdGlvbigpe0woJ2JpbmQnKTt9LDEpO0EucHVzaChzKTt9XHJcbiBlbHNlIGlmKGMub3ZlcmxheSA+IDApIHtpZihjLmNsb3Nlb3ZlcmxheSkgaC53LmpxbUFkZENsb3NlKG8pO31cclxuIGVsc2Ugbz1GO1xyXG5cclxuIGgubz0obyk/by5hZGRDbGFzcyhjLm92ZXJsYXlDbGFzcykucHJlcGVuZFRvKCdib2R5Jyk6RjtcclxuXHJcbiBpZihjLmFqYXgpIHt2YXIgcj1jLnRhcmdldHx8aC53LHU9Yy5hamF4O3I9KHR5cGVvZiByID09ICdzdHJpbmcnKT8kKHIsaC53KTokKHIpO3U9KHUuc3Vic3RyKDAsMSkgPT0gJ0AnKT8kKHQpLmF0dHIodS5zdWJzdHJpbmcoMSkpOnU7XHJcbiAgci5odG1sKGMuYWpheFRleHQpLmxvYWQodSxmdW5jdGlvbigpe2lmKGMub25Mb2FkKWMub25Mb2FkLmNhbGwodGhpcyxoKTtpZihjYyloLncuanFtQWRkQ2xvc2UoJChjYyxoLncpKTtlKGgpO30pO31cclxuIGVsc2UgaWYoY2MpaC53LmpxbUFkZENsb3NlKCQoY2MsaC53KSk7XHJcblxyXG4gaWYoYy50b1RvcCYmaC5vKWgudy5iZWZvcmUoJzxzcGFuIGlkPVwianFtUCcraC53WzBdLl9qcW0rJ1wiPjwvc3Bhbj4nKS5pbnNlcnRBZnRlcihoLm8pO1xyXG4gKGMub25TaG93KT9jLm9uU2hvdyhoKTpoLncuc2hvdygpO2UoaCk7cmV0dXJuIEY7XHJcbn0sXHJcbmNsb3NlOmZ1bmN0aW9uKHMpe3ZhciBoPUhbc107aWYoIWguYSlyZXR1cm4gRjtoLmE9RjtcclxuIGlmKEFbMF0pe0EucG9wKCk7aWYoIUFbMF0pTCgndW5iaW5kJyk7fVxyXG4gaWYoaC5jLnRvVG9wJiZoLm8pJCgnI2pxbVAnK2gud1swXS5fanFtKS5hZnRlcihoLncpLnJlbW92ZSgpO1xyXG4gaWYoaC5jLm9uSGlkZSloLmMub25IaWRlKGgpO2Vsc2V7aC53LmhpZGUoKTtpZihoLm8paC5vLnJlbW92ZSgpO30gcmV0dXJuIEY7XHJcbn0sXHJcbnBhcmFtczp7fX07XHJcbnZhciBzPTAsSD0kLmpxbS5oYXNoLEE9W10sRj1mYWxzZSxcclxuZT1mdW5jdGlvbihoKXtmKGgpO30sXHJcbmY9ZnVuY3Rpb24oaCl7dHJ5eyQoJzppbnB1dDp2aXNpYmxlJyxoLncpWzBdLmZvY3VzKCk7fWNhdGNoKF8pe319LFxyXG5MPWZ1bmN0aW9uKHQpeyQoZG9jdW1lbnQpW3RdKFwia2V5cHJlc3NcIixtKVt0XShcImtleWRvd25cIixtKVt0XShcIm1vdXNlZG93blwiLG0pO30sXHJcbm09ZnVuY3Rpb24oZSl7dmFyIGg9SFtBW0EubGVuZ3RoLTFdXSxyPSghJChlLnRhcmdldCkucGFyZW50cygnLmpxbUlEJytoLnMpWzBdKTtpZihyKXskKCcuanFtSUQnK2gucykuZWFjaChmdW5jdGlvbigpe3ZhciAkc2VsZj0kKHRoaXMpLG9mZnNldD0kc2VsZi5vZmZzZXQoKTtpZihvZmZzZXQudG9wPD1lLnBhZ2VZICYmIGUucGFnZVk8PW9mZnNldC50b3ArJHNlbGYuaGVpZ2h0KCkgJiYgb2Zmc2V0LmxlZnQ8PWUucGFnZVggJiYgZS5wYWdlWDw9b2Zmc2V0LmxlZnQrJHNlbGYud2lkdGgoKSl7cj1mYWxzZTtyZXR1cm4gZmFsc2U7fX0pO2YoaCk7fXJldHVybiAhcjt9LFxyXG5ocz1mdW5jdGlvbih3LHQsYyl7cmV0dXJuIHcuZWFjaChmdW5jdGlvbigpe3ZhciBzPXRoaXMuX2pxbTskKHQpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiBpZighdGhpc1tjXSl7dGhpc1tjXT1bXTskKHRoaXMpLmNsaWNrKGZ1bmN0aW9uKCl7Zm9yKHZhciBpIGluIHtqcW1TaG93OjEsanFtSGlkZToxfSlmb3IodmFyIHMgaW4gdGhpc1tpXSlpZihIW3RoaXNbaV1bc11dKUhbdGhpc1tpXVtzXV0ud1tpXSh0aGlzKTtyZXR1cm4gRjt9KTt9dGhpc1tjXS5wdXNoKHMpO30pO30pO307XHJcbn0pKGpRdWVyeSk7LypcclxuICoganFEblIgLSBNaW5pbWFsaXN0aWMgRHJhZyduJ1Jlc2l6ZSBmb3IgalF1ZXJ5LlxyXG4gKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMDcgQnJpY2UgQnVyZ2VzcyA8YmhiQGljZWJ1cmcubmV0PiwgaHR0cDovL3d3dy5pY2VidXJnLm5ldFxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2U6XHJcbiAqIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXHJcbiAqXHJcbiAqICRWZXJzaW9uOiAyMDA3LjA4LjE5ICtyMlxyXG4gKi9cclxuXHJcbihmdW5jdGlvbigkKXtcclxuJC5mbi5qcURyYWc9ZnVuY3Rpb24oaCl7cmV0dXJuIGkodGhpcyxoLCdkJyk7fTtcclxuJC5mbi5qcVJlc2l6ZT1mdW5jdGlvbihoLGFyKXtyZXR1cm4gaSh0aGlzLGgsJ3InLGFyKTt9O1xyXG4kLmpxRG5SPXtcclxuXHRkbnI6e30sXHJcblx0ZTowLFxyXG5cdGRyYWc6ZnVuY3Rpb24odil7XHJcblx0XHRpZihNLmsgPT0gJ2QnKXtFLmNzcyh7bGVmdDpNLlgrdi5wYWdlWC1NLnBYLHRvcDpNLlkrdi5wYWdlWS1NLnBZfSk7fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdEUuY3NzKHt3aWR0aDpNYXRoLm1heCh2LnBhZ2VYLU0ucFgrTS5XLDApLGhlaWdodDpNYXRoLm1heCh2LnBhZ2VZLU0ucFkrTS5ILDApfSk7XHJcblx0XHRcdGlmKE0xKXtFMS5jc3Moe3dpZHRoOk1hdGgubWF4KHYucGFnZVgtTTEucFgrTTEuVywwKSxoZWlnaHQ6TWF0aC5tYXgodi5wYWdlWS1NMS5wWStNMS5ILDApfSk7fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH0sXHJcblx0c3RvcDpmdW5jdGlvbigpe1xyXG5cdFx0Ly9FLmNzcygnb3BhY2l0eScsTS5vKTtcclxuXHRcdCQoZG9jdW1lbnQpLnVuYmluZCgnbW91c2Vtb3ZlJyxKLmRyYWcpLnVuYmluZCgnbW91c2V1cCcsSi5zdG9wKTtcclxuXHR9XHJcbn07XHJcbnZhciBKPSQuanFEblIsTT1KLmRucixFPUouZSxFMSxNMSxcclxuaT1mdW5jdGlvbihlLGgsayxhUil7XHJcblx0cmV0dXJuIGUuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0aD0oaCk/JChoLGUpOmU7XHJcblx0XHRoLmJpbmQoJ21vdXNlZG93bicse2U6ZSxrOmt9LGZ1bmN0aW9uKHYpe1xyXG5cdFx0XHR2YXIgZD12LmRhdGEscD17fTtFPWQuZTtFMSA9IGFSID8gJChhUikgOiBmYWxzZTtcclxuXHRcdFx0Ly8gYXR0ZW1wdCB1dGlsaXphdGlvbiBvZiBkaW1lbnNpb25zIHBsdWdpbiB0byBmaXggSUUgaXNzdWVzXHJcblx0XHRcdGlmKEUuY3NzKCdwb3NpdGlvbicpICE9ICdyZWxhdGl2ZScpe3RyeXtFLnBvc2l0aW9uKHApO31jYXRjaChlKXt9fVxyXG5cdFx0XHRNPXtcclxuXHRcdFx0XHRYOnAubGVmdHx8ZignbGVmdCcpfHwwLFxyXG5cdFx0XHRcdFk6cC50b3B8fGYoJ3RvcCcpfHwwLFxyXG5cdFx0XHRcdFc6Zignd2lkdGgnKXx8RVswXS5zY3JvbGxXaWR0aHx8MCxcclxuXHRcdFx0XHRIOmYoJ2hlaWdodCcpfHxFWzBdLnNjcm9sbEhlaWdodHx8MCxcclxuXHRcdFx0XHRwWDp2LnBhZ2VYLFxyXG5cdFx0XHRcdHBZOnYucGFnZVksXHJcblx0XHRcdFx0azpkLmtcclxuXHRcdFx0XHQvL286RS5jc3MoJ29wYWNpdHknKVxyXG5cdFx0XHR9O1xyXG5cdFx0XHQvLyBhbHNvIHJlc2l6ZVxyXG5cdFx0XHRpZihFMSAmJiBkLmsgIT0gJ2QnKXtcclxuXHRcdFx0XHRNMT17XHJcblx0XHRcdFx0XHRYOnAubGVmdHx8ZjEoJ2xlZnQnKXx8MCxcclxuXHRcdFx0XHRcdFk6cC50b3B8fGYxKCd0b3AnKXx8MCxcclxuXHRcdFx0XHRcdFc6RTFbMF0ub2Zmc2V0V2lkdGh8fGYxKCd3aWR0aCcpfHwwLFxyXG5cdFx0XHRcdFx0SDpFMVswXS5vZmZzZXRIZWlnaHR8fGYxKCdoZWlnaHQnKXx8MCxcclxuXHRcdFx0XHRcdHBYOnYucGFnZVgsXHJcblx0XHRcdFx0XHRwWTp2LnBhZ2VZLFxyXG5cdFx0XHRcdFx0azpkLmtcclxuXHRcdFx0XHR9O1xyXG5cdFx0XHR9IGVsc2Uge00xID0gZmFsc2U7fVxyXG5cdFx0XHQvL0UuY3NzKHtvcGFjaXR5OjAuOH0pO1xyXG5cdFx0XHRpZigkKFwiaW5wdXQuaGFzRGF0ZXBpY2tlclwiLEVbMF0pWzBdKSB7XHJcblx0XHRcdHRyeSB7JChcImlucHV0Lmhhc0RhdGVwaWNrZXJcIixFWzBdKS5kYXRlcGlja2VyKCdoaWRlJyk7fWNhdGNoIChkcGUpe31cclxuXHRcdFx0fVxyXG5cdFx0XHQkKGRvY3VtZW50KS5tb3VzZW1vdmUoJC5qcURuUi5kcmFnKS5tb3VzZXVwKCQuanFEblIuc3RvcCk7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH0pO1xyXG5cdH0pO1xyXG59LFxyXG5mPWZ1bmN0aW9uKGspe3JldHVybiBwYXJzZUludChFLmNzcyhrKSwxMCl8fGZhbHNlO30sXHJcbmYxPWZ1bmN0aW9uKGspe3JldHVybiBwYXJzZUludChFMS5jc3MoayksMTApfHxmYWxzZTt9O1xyXG59KShqUXVlcnkpOy8qXHJcblx0VGhlIGJlbG93IHdvcmsgaXMgbGljZW5zZWQgdW5kZXIgQ3JlYXRpdmUgQ29tbW9ucyBHTlUgTEdQTCBMaWNlbnNlLlxyXG5cclxuXHRPcmlnaW5hbCB3b3JrOlxyXG5cclxuXHRMaWNlbnNlOiAgICAgaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvTEdQTC8yLjEvXHJcblx0QXV0aG9yOiAgICAgIFN0ZWZhbiBHb2Vzc25lci8yMDA2XHJcblx0V2ViOiAgICAgICAgIGh0dHA6Ly9nb2Vzc25lci5uZXQvXHJcblxyXG5cdE1vZGlmaWNhdGlvbnMgbWFkZTpcclxuXHJcblx0VmVyc2lvbjogICAgIDAuOS1wNVxyXG5cdERlc2NyaXB0aW9uOiBSZXN0cnVjdHVyZWQgY29kZSwgSlNMaW50IHZhbGlkYXRlZCAobm8gc3RyaWN0IHdoaXRlc3BhY2VzKSxcclxuXHQgICAgICAgICAgICAgYWRkZWQgaGFuZGxpbmcgb2YgZW1wdHkgYXJyYXlzLCBlbXB0eSBzdHJpbmdzLCBhbmQgaW50L2Zsb2F0cyB2YWx1ZXMuXHJcblx0QXV0aG9yOiAgICAgIE1pY2hhZWwgU2Now7hsZXIvMjAwOC0wMS0yOVxyXG5cdFdlYjogICAgICAgICBodHRwOi8vbWljaGFlbC5oaW5uZXJ1cC5uZXQvYmxvZy8yMDA4LzAxLzI2L2NvbnZlcnRpbmctanNvbi10by14bWwtYW5kLXhtbC10by1qc29uL1xyXG5cclxuXHREZXNjcmlwdGlvbjoganNvbjJ4bWwgYWRkZWQgc3VwcG9ydCB0byBjb252ZXJ0IGZ1bmN0aW9ucyBhcyBDREFUQVxyXG5cdCAgICAgICAgICAgICBzbyBpdCB3aWxsIGJlIGVhc3kgdG8gd3JpdGUgY2hhcmFjdGVycyB0aGF0IGNhdXNlIHNvbWUgcHJvYmxlbXMgd2hlbiBjb252ZXJ0XHJcblx0QXV0aG9yOiAgICAgIFRvbnkgVG9tb3ZcclxuKi9cclxuXHJcbi8qZ2xvYmFsIGFsZXJ0ICovXHJcbnZhciB4bWxKc29uQ2xhc3MgPSB7XHJcblx0Ly8gUGFyYW0gXCJ4bWxcIjogRWxlbWVudCBvciBkb2N1bWVudCBET00gbm9kZS5cclxuXHQvLyBQYXJhbSBcInRhYlwiOiBUYWIgb3IgaW5kZW50IHN0cmluZyBmb3IgcHJldHR5IG91dHB1dCBmb3JtYXR0aW5nIG9taXQgb3IgdXNlIGVtcHR5IHN0cmluZyBcIlwiIHRvIHN1cHJlc3MuXHJcblx0Ly8gUmV0dXJuczogICAgIEpTT04gc3RyaW5nXHJcblx0eG1sMmpzb246IGZ1bmN0aW9uKHhtbCwgdGFiKSB7XHJcblx0XHRpZiAoeG1sLm5vZGVUeXBlID09PSA5KSB7XHJcblx0XHRcdC8vIGRvY3VtZW50IG5vZGVcclxuXHRcdFx0eG1sID0geG1sLmRvY3VtZW50RWxlbWVudDtcclxuXHRcdH1cclxuXHRcdHZhciBud3MgPSB0aGlzLnJlbW92ZVdoaXRlKHhtbCk7XHJcblx0XHR2YXIgb2JqID0gdGhpcy50b09iaihud3MpO1xyXG5cdFx0dmFyIGpzb24gPSB0aGlzLnRvSnNvbihvYmosIHhtbC5ub2RlTmFtZSwgXCJcXHRcIik7XHJcblx0XHRyZXR1cm4gXCJ7XFxuXCIgKyB0YWIgKyAodGFiID8ganNvbi5yZXBsYWNlKC9cXHQvZywgdGFiKSA6IGpzb24ucmVwbGFjZSgvXFx0fFxcbi9nLCBcIlwiKSkgKyBcIlxcbn1cIjtcclxuXHR9LFxyXG5cclxuXHQvLyBQYXJhbSBcIm9cIjogICBKYXZhU2NyaXB0IG9iamVjdFxyXG5cdC8vIFBhcmFtIFwidGFiXCI6IHRhYiBvciBpbmRlbnQgc3RyaW5nIGZvciBwcmV0dHkgb3V0cHV0IGZvcm1hdHRpbmcgb21pdCBvciB1c2UgZW1wdHkgc3RyaW5nIFwiXCIgdG8gc3VwcmVzcy5cclxuXHQvLyBSZXR1cm5zOiAgICAgWE1MIHN0cmluZ1xyXG5cdGpzb24yeG1sOiBmdW5jdGlvbihvLCB0YWIpIHtcclxuXHRcdHZhciB0b1htbCA9IGZ1bmN0aW9uKHYsIG5hbWUsIGluZCkge1xyXG5cdFx0XHR2YXIgeG1sID0gXCJcIjtcclxuXHRcdFx0dmFyIGksIG47XHJcblx0XHRcdGlmICh2IGluc3RhbmNlb2YgQXJyYXkpIHtcclxuXHRcdFx0XHRpZiAodi5sZW5ndGggPT09IDApIHtcclxuXHRcdFx0XHRcdHhtbCArPSBpbmQgKyBcIjxcIituYW1lK1wiPl9fRU1QVFlfQVJSQVlfPC9cIituYW1lK1wiPlxcblwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdGZvciAoaSA9IDAsIG4gPSB2Lmxlbmd0aDsgaSA8IG47IGkgKz0gMSkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc1htbCA9IGluZCArIHRvWG1sKHZbaV0sIG5hbWUsIGluZCtcIlxcdFwiKSArIFwiXFxuXCI7XHJcblx0XHRcdFx0XHRcdHhtbCArPSBzWG1sO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIGlmICh0eXBlb2YodikgPT09IFwib2JqZWN0XCIpIHtcclxuXHRcdFx0XHR2YXIgaGFzQ2hpbGQgPSBmYWxzZTtcclxuXHRcdFx0XHR4bWwgKz0gaW5kICsgXCI8XCIgKyBuYW1lO1xyXG5cdFx0XHRcdHZhciBtO1xyXG5cdFx0XHRcdGZvciAobSBpbiB2KSBpZiAodi5oYXNPd25Qcm9wZXJ0eShtKSkge1xyXG5cdFx0XHRcdFx0aWYgKG0uY2hhckF0KDApID09PSBcIkBcIikge1xyXG5cdFx0XHRcdFx0XHR4bWwgKz0gXCIgXCIgKyBtLnN1YnN0cigxKSArIFwiPVxcXCJcIiArIHZbbV0udG9TdHJpbmcoKSArIFwiXFxcIlwiO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHRcdGhhc0NoaWxkID0gdHJ1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0eG1sICs9IGhhc0NoaWxkID8gXCI+XCIgOiBcIi8+XCI7XHJcblx0XHRcdFx0aWYgKGhhc0NoaWxkKSB7XHJcblx0XHRcdFx0XHRmb3IgKG0gaW4gdikgaWYgKHYuaGFzT3duUHJvcGVydHkobSkpIHtcclxuXHRcdFx0XHRcdFx0aWYgKG0gPT09IFwiI3RleHRcIikge1xyXG5cdFx0XHRcdFx0XHRcdHhtbCArPSB2W21dO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGVsc2UgaWYgKG0gPT09IFwiI2NkYXRhXCIpIHtcclxuXHRcdFx0XHRcdFx0XHR4bWwgKz0gXCI8IVtDREFUQVtcIiArIHZbbV0gKyBcIl1dPlwiO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGVsc2UgaWYgKG0uY2hhckF0KDApICE9PSBcIkBcIikge1xyXG5cdFx0XHRcdFx0XHRcdHhtbCArPSB0b1htbCh2W21dLCBtLCBpbmQrXCJcXHRcIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHhtbCArPSAoeG1sLmNoYXJBdCh4bWwubGVuZ3RoIC0gMSkgPT09IFwiXFxuXCIgPyBpbmQgOiBcIlwiKSArIFwiPC9cIiArIG5hbWUgKyBcIj5cIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAodHlwZW9mKHYpID09PSBcImZ1bmN0aW9uXCIpIHtcclxuXHRcdFx0XHR4bWwgKz0gaW5kICsgXCI8XCIgKyBuYW1lICsgXCI+XCIgKyBcIjwhW0NEQVRBW1wiICsgdiArIFwiXV0+XCIgKyBcIjwvXCIgKyBuYW1lICsgXCI+XCI7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0aWYgKHYgPT09IHVuZGVmaW5lZCApIHsgdiA9IFwiXCI7IH1cclxuXHRcdFx0XHRpZiAodi50b1N0cmluZygpID09PSBcIlxcXCJcXFwiXCIgfHwgdi50b1N0cmluZygpLmxlbmd0aCA9PT0gMCkge1xyXG5cdFx0XHRcdFx0eG1sICs9IGluZCArIFwiPFwiICsgbmFtZSArIFwiPl9fRU1QVFlfU1RSSU5HXzwvXCIgKyBuYW1lICsgXCI+XCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0eG1sICs9IGluZCArIFwiPFwiICsgbmFtZSArIFwiPlwiICsgdi50b1N0cmluZygpICsgXCI8L1wiICsgbmFtZSArIFwiPlwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4geG1sO1xyXG5cdFx0fTtcclxuXHRcdHZhciB4bWwgPSBcIlwiO1xyXG5cdFx0dmFyIG07XHJcblx0XHRmb3IgKG0gaW4gbykgaWYgKG8uaGFzT3duUHJvcGVydHkobSkpIHtcclxuXHRcdFx0eG1sICs9IHRvWG1sKG9bbV0sIG0sIFwiXCIpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRhYiA/IHhtbC5yZXBsYWNlKC9cXHQvZywgdGFiKSA6IHhtbC5yZXBsYWNlKC9cXHR8XFxuL2csIFwiXCIpO1xyXG5cdH0sXHJcblx0Ly8gSW50ZXJuYWwgbWV0aG9kc1xyXG5cdHRvT2JqOiBmdW5jdGlvbih4bWwpIHtcclxuXHRcdHZhciBvID0ge307XHJcblx0XHR2YXIgRnVuY1Rlc3QgPSAvZnVuY3Rpb24vaTtcclxuXHRcdGlmICh4bWwubm9kZVR5cGUgPT09IDEpIHtcclxuXHRcdFx0Ly8gZWxlbWVudCBub2RlIC4uXHJcblx0XHRcdGlmICh4bWwuYXR0cmlidXRlcy5sZW5ndGgpIHtcclxuXHRcdFx0XHQvLyBlbGVtZW50IHdpdGggYXR0cmlidXRlcyAuLlxyXG5cdFx0XHRcdHZhciBpO1xyXG5cdFx0XHRcdGZvciAoaSA9IDA7IGkgPCB4bWwuYXR0cmlidXRlcy5sZW5ndGg7IGkgKz0gMSkge1xyXG5cdFx0XHRcdFx0b1tcIkBcIiArIHhtbC5hdHRyaWJ1dGVzW2ldLm5vZGVOYW1lXSA9ICh4bWwuYXR0cmlidXRlc1tpXS5ub2RlVmFsdWUgfHwgXCJcIikudG9TdHJpbmcoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHhtbC5maXJzdENoaWxkKSB7XHJcblx0XHRcdFx0Ly8gZWxlbWVudCBoYXMgY2hpbGQgbm9kZXMgLi5cclxuXHRcdFx0XHR2YXIgdGV4dENoaWxkID0gMCwgY2RhdGFDaGlsZCA9IDAsIGhhc0VsZW1lbnRDaGlsZCA9IGZhbHNlO1xyXG5cdFx0XHRcdHZhciBuO1xyXG5cdFx0XHRcdGZvciAobiA9IHhtbC5maXJzdENoaWxkOyBuOyBuID0gbi5uZXh0U2libGluZykge1xyXG5cdFx0XHRcdFx0aWYgKG4ubm9kZVR5cGUgPT09IDEpIHtcclxuXHRcdFx0XHRcdFx0aGFzRWxlbWVudENoaWxkID0gdHJ1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGVsc2UgaWYgKG4ubm9kZVR5cGUgPT09IDMgJiYgbi5ub2RlVmFsdWUubWF0Y2goL1teIFxcZlxcblxcclxcdFxcdl0vKSkge1xyXG5cdFx0XHRcdFx0XHQvLyBub24td2hpdGVzcGFjZSB0ZXh0XHJcblx0XHRcdFx0XHRcdHRleHRDaGlsZCArPSAxO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZWxzZSBpZiAobi5ub2RlVHlwZSA9PT0gNCkge1xyXG5cdFx0XHRcdFx0XHQvLyBjZGF0YSBzZWN0aW9uIG5vZGVcclxuXHRcdFx0XHRcdFx0Y2RhdGFDaGlsZCArPSAxO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoaGFzRWxlbWVudENoaWxkKSB7XHJcblx0XHRcdFx0XHRpZiAodGV4dENoaWxkIDwgMiAmJiBjZGF0YUNoaWxkIDwgMikge1xyXG5cdFx0XHRcdFx0XHQvLyBzdHJ1Y3R1cmVkIGVsZW1lbnQgd2l0aCBldnRsLiBhIHNpbmdsZSB0ZXh0IG9yL2FuZCBjZGF0YSBub2RlIC4uXHJcblx0XHRcdFx0XHRcdHRoaXMucmVtb3ZlV2hpdGUoeG1sKTtcclxuXHRcdFx0XHRcdFx0Zm9yIChuID0geG1sLmZpcnN0Q2hpbGQ7IG47IG4gPSBuLm5leHRTaWJsaW5nKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKG4ubm9kZVR5cGUgPT09IDMpIHtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIHRleHQgbm9kZVxyXG5cdFx0XHRcdFx0XHRcdFx0b1tcIiN0ZXh0XCJdID0gdGhpcy5lc2NhcGUobi5ub2RlVmFsdWUpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRlbHNlIGlmIChuLm5vZGVUeXBlID09PSA0KSB7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBjZGF0YSBub2RlXHJcblx0XHRcdFx0XHRcdFx0XHRpZiAoRnVuY1Rlc3QudGVzdChuLm5vZGVWYWx1ZSkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0b1tuLm5vZGVOYW1lXSA9IFtvW24ubm9kZU5hbWVdLCBuLm5vZGVWYWx1ZV07XHJcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRvW1wiI2NkYXRhXCJdID0gdGhpcy5lc2NhcGUobi5ub2RlVmFsdWUpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRlbHNlIGlmIChvW24ubm9kZU5hbWVdKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBtdWx0aXBsZSBvY2N1cmVuY2Ugb2YgZWxlbWVudCAuLlxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKG9bbi5ub2RlTmFtZV0gaW5zdGFuY2VvZiBBcnJheSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRvW24ubm9kZU5hbWVdW29bbi5ub2RlTmFtZV0ubGVuZ3RoXSA9IHRoaXMudG9PYmoobik7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0b1tuLm5vZGVOYW1lXSA9IFtvW24ubm9kZU5hbWVdLCB0aGlzLnRvT2JqKG4pXTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBmaXJzdCBvY2N1cmVuY2Ugb2YgZWxlbWVudCAuLlxyXG5cdFx0XHRcdFx0XHRcdFx0b1tuLm5vZGVOYW1lXSA9IHRoaXMudG9PYmoobik7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdFx0Ly8gbWl4ZWQgY29udGVudFxyXG5cdFx0XHRcdFx0XHRpZiAoIXhtbC5hdHRyaWJ1dGVzLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRcdG8gPSB0aGlzLmVzY2FwZSh0aGlzLmlubmVyWG1sKHhtbCkpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdG9bXCIjdGV4dFwiXSA9IHRoaXMuZXNjYXBlKHRoaXMuaW5uZXJYbWwoeG1sKSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSBpZiAodGV4dENoaWxkKSB7XHJcblx0XHRcdFx0XHQvLyBwdXJlIHRleHRcclxuXHRcdFx0XHRcdGlmICgheG1sLmF0dHJpYnV0ZXMubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdG8gPSB0aGlzLmVzY2FwZSh0aGlzLmlubmVyWG1sKHhtbCkpO1xyXG5cdFx0XHRcdFx0XHRpZiAobyA9PT0gXCJfX0VNUFRZX0FSUkFZX1wiKSB7XHJcblx0XHRcdFx0XHRcdFx0byA9IFwiW11cIjtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChvID09PSBcIl9fRU1QVFlfU1RSSU5HX1wiKSB7XHJcblx0XHRcdFx0XHRcdFx0byA9IFwiXCI7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRvW1wiI3RleHRcIl0gPSB0aGlzLmVzY2FwZSh0aGlzLmlubmVyWG1sKHhtbCkpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIGlmIChjZGF0YUNoaWxkKSB7XHJcblx0XHRcdFx0XHQvLyBjZGF0YVxyXG5cdFx0XHRcdFx0aWYgKGNkYXRhQ2hpbGQgPiAxKSB7XHJcblx0XHRcdFx0XHRcdG8gPSB0aGlzLmVzY2FwZSh0aGlzLmlubmVyWG1sKHhtbCkpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHRcdGZvciAobiA9IHhtbC5maXJzdENoaWxkOyBuOyBuID0gbi5uZXh0U2libGluZykge1xyXG5cdFx0XHRcdFx0XHRcdGlmKEZ1bmNUZXN0LnRlc3QoeG1sLmZpcnN0Q2hpbGQubm9kZVZhbHVlKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0byA9IHhtbC5maXJzdENoaWxkLm5vZGVWYWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRvW1wiI2NkYXRhXCJdID0gdGhpcy5lc2NhcGUobi5ub2RlVmFsdWUpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoIXhtbC5hdHRyaWJ1dGVzLmxlbmd0aCAmJiAheG1sLmZpcnN0Q2hpbGQpIHtcclxuXHRcdFx0XHRvID0gbnVsbDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZiAoeG1sLm5vZGVUeXBlID09PSA5KSB7XHJcblx0XHRcdC8vIGRvY3VtZW50Lm5vZGVcclxuXHRcdFx0byA9IHRoaXMudG9PYmooeG1sLmRvY3VtZW50RWxlbWVudCk7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0YWxlcnQoXCJ1bmhhbmRsZWQgbm9kZSB0eXBlOiBcIiArIHhtbC5ub2RlVHlwZSk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gbztcclxuXHR9LFxyXG5cdHRvSnNvbjogZnVuY3Rpb24obywgbmFtZSwgaW5kLCB3ZWxsZm9ybSkge1xyXG5cdFx0aWYod2VsbGZvcm0gPT09IHVuZGVmaW5lZCkgd2VsbGZvcm0gPSB0cnVlO1xyXG5cdFx0dmFyIGpzb24gPSBuYW1lID8gKFwiXFxcIlwiICsgbmFtZSArIFwiXFxcIlwiKSA6IFwiXCIsIHRhYiA9IFwiXFx0XCIsIG5ld2xpbmUgPSBcIlxcblwiO1xyXG5cdFx0aWYoIXdlbGxmb3JtKSB7XHJcblx0XHRcdHRhYj0gXCJcIjsgbmV3bGluZT0gXCJcIjtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAobyA9PT0gXCJbXVwiKSB7XHJcblx0XHRcdGpzb24gKz0gKG5hbWUgPyBcIjpbXVwiIDogXCJbXVwiKTtcclxuXHRcdH1cclxuXHRcdGVsc2UgaWYgKG8gaW5zdGFuY2VvZiBBcnJheSkge1xyXG5cdFx0XHR2YXIgbiwgaSwgYXI9W107XHJcblx0XHRcdGZvciAoaSA9IDAsIG4gPSBvLmxlbmd0aDsgaSA8IG47IGkgKz0gMSkge1xyXG5cdFx0XHRcdGFyW2ldID0gdGhpcy50b0pzb24ob1tpXSwgXCJcIiwgaW5kICsgdGFiLCB3ZWxsZm9ybSk7XHJcblx0XHRcdH1cclxuXHRcdFx0anNvbiArPSAobmFtZSA/IFwiOltcIiA6IFwiW1wiKSArIChhci5sZW5ndGggPiAxID8gKG5ld2xpbmUgKyBpbmQgKyB0YWIgKyBhci5qb2luKFwiLFwiK25ld2xpbmUgKyBpbmQgKyB0YWIpICsgbmV3bGluZSArIGluZCkgOiBhci5qb2luKFwiXCIpKSArIFwiXVwiO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZiAobyA9PT0gbnVsbCkge1xyXG5cdFx0XHRqc29uICs9IChuYW1lICYmIFwiOlwiKSArIFwibnVsbFwiO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZiAodHlwZW9mKG8pID09PSBcIm9iamVjdFwiKSB7XHJcblx0XHRcdHZhciBhcnIgPSBbXSwgbTtcclxuXHRcdFx0Zm9yIChtIGluIG8pIHtcclxuXHRcdFx0XHRpZiAoby5oYXNPd25Qcm9wZXJ0eShtKSkge1xyXG5cdFx0XHRcdFx0YXJyW2Fyci5sZW5ndGhdID0gdGhpcy50b0pzb24ob1ttXSwgbSwgaW5kICsgdGFiLCB3ZWxsZm9ybSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFx0anNvbiArPSAobmFtZSA/IFwiOntcIiA6IFwie1wiKSArIChhcnIubGVuZ3RoID4gMSA/IChuZXdsaW5lICsgaW5kICsgdGFiICsgYXJyLmpvaW4oXCIsXCIrbmV3bGluZSArIGluZCArIHRhYikgKyBuZXdsaW5lICsgaW5kKSA6IGFyci5qb2luKFwiXCIpKSArIFwifVwiO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZiAodHlwZW9mKG8pID09PSBcInN0cmluZ1wiKSB7XHJcblx0XHRcdC8qXHJcblx0XHRcdHZhciBvYmpSZWdFeHAgID0gLyheLT9cXGQrXFwuP1xcZCokKS87XHJcblx0XHRcdHZhciBGdW5jVGVzdCA9IC9mdW5jdGlvbi9pO1xyXG5cdFx0XHR2YXIgb3MgPSBvLnRvU3RyaW5nKCk7XHJcblx0XHRcdGlmIChvYmpSZWdFeHAudGVzdChvcykgfHwgRnVuY1Rlc3QudGVzdChvcykgfHwgb3M9PT1cImZhbHNlXCIgfHwgb3M9PT1cInRydWVcIikge1xyXG5cdFx0XHRcdC8vIGludCBvciBmbG9hdFxyXG5cdFx0XHRcdGpzb24gKz0gKG5hbWUgJiYgXCI6XCIpICArIFwiXFxcIlwiICtvcyArIFwiXFxcIlwiO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHQqL1xyXG5cdFx0XHRcdGpzb24gKz0gKG5hbWUgJiYgXCI6XCIpICsgXCJcXFwiXCIgKyBvLnJlcGxhY2UoL1xcXFwvZywnXFxcXFxcXFwnKS5yZXBsYWNlKC9cXFwiL2csJ1xcXFxcIicpICsgXCJcXFwiXCI7XHJcblx0XHRcdC8vfVxyXG5cdFx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0anNvbiArPSAobmFtZSAmJiBcIjpcIikgKyAgby50b1N0cmluZygpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGpzb247XHJcblx0fSxcclxuXHRpbm5lclhtbDogZnVuY3Rpb24obm9kZSkge1xyXG5cdFx0dmFyIHMgPSBcIlwiO1xyXG5cdFx0aWYgKFwiaW5uZXJIVE1MXCIgaW4gbm9kZSkge1xyXG5cdFx0XHRzID0gbm9kZS5pbm5lckhUTUw7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0dmFyIGFzWG1sID0gZnVuY3Rpb24obikge1xyXG5cdFx0XHRcdHZhciBzID0gXCJcIiwgaTtcclxuXHRcdFx0XHRpZiAobi5ub2RlVHlwZSA9PT0gMSkge1xyXG5cdFx0XHRcdFx0cyArPSBcIjxcIiArIG4ubm9kZU5hbWU7XHJcblx0XHRcdFx0XHRmb3IgKGkgPSAwOyBpIDwgbi5hdHRyaWJ1dGVzLmxlbmd0aDsgaSArPSAxKSB7XHJcblx0XHRcdFx0XHRcdHMgKz0gXCIgXCIgKyBuLmF0dHJpYnV0ZXNbaV0ubm9kZU5hbWUgKyBcIj1cXFwiXCIgKyAobi5hdHRyaWJ1dGVzW2ldLm5vZGVWYWx1ZSB8fCBcIlwiKS50b1N0cmluZygpICsgXCJcXFwiXCI7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAobi5maXJzdENoaWxkKSB7XHJcblx0XHRcdFx0XHRcdHMgKz0gXCI+XCI7XHJcblx0XHRcdFx0XHRcdGZvciAodmFyIGMgPSBuLmZpcnN0Q2hpbGQ7IGM7IGMgPSBjLm5leHRTaWJsaW5nKSB7XHJcblx0XHRcdFx0XHRcdFx0cyArPSBhc1htbChjKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRzICs9IFwiPC9cIiArIG4ubm9kZU5hbWUgKyBcIj5cIjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRzICs9IFwiLz5cIjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSBpZiAobi5ub2RlVHlwZSA9PT0gMykge1xyXG5cdFx0XHRcdFx0cyArPSBuLm5vZGVWYWx1ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSBpZiAobi5ub2RlVHlwZSA9PT0gNCkge1xyXG5cdFx0XHRcdFx0cyArPSBcIjwhW0NEQVRBW1wiICsgbi5ub2RlVmFsdWUgKyBcIl1dPlwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gcztcclxuXHRcdFx0fTtcclxuXHRcdFx0Zm9yICh2YXIgYyA9IG5vZGUuZmlyc3RDaGlsZDsgYzsgYyA9IGMubmV4dFNpYmxpbmcpIHtcclxuXHRcdFx0XHRzICs9IGFzWG1sKGMpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gcztcclxuXHR9LFxyXG5cdGVzY2FwZTogZnVuY3Rpb24odHh0KSB7XHJcblx0XHRyZXR1cm4gdHh0LnJlcGxhY2UoL1tcXFxcXS9nLCBcIlxcXFxcXFxcXCIpLnJlcGxhY2UoL1tcXFwiXS9nLCAnXFxcXFwiJykucmVwbGFjZSgvW1xcbl0vZywgJ1xcXFxuJykucmVwbGFjZSgvW1xccl0vZywgJ1xcXFxyJyk7XHJcblx0fSxcclxuXHRyZW1vdmVXaGl0ZTogZnVuY3Rpb24oZSkge1xyXG5cdFx0ZS5ub3JtYWxpemUoKTtcclxuXHRcdHZhciBuO1xyXG5cdFx0Zm9yIChuID0gZS5maXJzdENoaWxkOyBuOyApIHtcclxuXHRcdFx0aWYgKG4ubm9kZVR5cGUgPT09IDMpIHtcclxuXHRcdFx0XHQvLyB0ZXh0IG5vZGVcclxuXHRcdFx0XHRpZiAoIW4ubm9kZVZhbHVlLm1hdGNoKC9bXiBcXGZcXG5cXHJcXHRcXHZdLykpIHtcclxuXHRcdFx0XHRcdC8vIHB1cmUgd2hpdGVzcGFjZSB0ZXh0IG5vZGVcclxuXHRcdFx0XHRcdHZhciBueHQgPSBuLm5leHRTaWJsaW5nO1xyXG5cdFx0XHRcdFx0ZS5yZW1vdmVDaGlsZChuKTtcclxuXHRcdFx0XHRcdG4gPSBueHQ7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0biA9IG4ubmV4dFNpYmxpbmc7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKG4ubm9kZVR5cGUgPT09IDEpIHtcclxuXHRcdFx0XHQvLyBlbGVtZW50IG5vZGVcclxuXHRcdFx0XHR0aGlzLnJlbW92ZVdoaXRlKG4pO1xyXG5cdFx0XHRcdG4gPSBuLm5leHRTaWJsaW5nO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdC8vIGFueSBvdGhlciBub2RlXHJcblx0XHRcdFx0biA9IG4ubmV4dFNpYmxpbmc7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBlO1xyXG5cdH1cclxufTsvKlxyXG4qKlxyXG4gKiBmb3JtYXR0ZXIgZm9yIHZhbHVlcyBidXQgbW9zdCBvZiB0aGUgdmFsdWVzIGlmIGZvciBqcUdyaWRcclxuICogU29tZSBvZiB0aGlzIHdhcyBpbnNwaXJlZCBhbmQgYmFzZWQgb24gaG93IFlVSSBkb2VzIHRoZSB0YWJsZSBkYXRhZ3JpZCBidXQgaW4galF1ZXJ5IGZhc2hpb25cclxuICogd2UgYXJlIHRyeWluZyB0byBrZWVwIGl0IGFzIGxpZ2h0IGFzIHBvc3NpYmxlXHJcbiAqIEpvc2h1YSBCdXJuZXR0IGpvc2hAOWNpLmNvbVxyXG4gKiBodHRwOi8vd3d3LmdyZWVuYmlsbC5jb21cclxuICpcclxuICogQ2hhbmdlcyBmcm9tIFRvbnkgVG9tb3YgdG9ueUB0cmlyYW5kLmNvbVxyXG4gKiBEdWFsIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgYW5kIEdQTCBsaWNlbnNlczpcclxuICogaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuICogaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2dwbC0yLjAuaHRtbFxyXG4gKlxyXG4qKi9cclxuLypqc2hpbnQgZXFlcWVxOmZhbHNlICovXHJcbi8qZ2xvYmFsIGpRdWVyeSAqL1xyXG5cclxuKGZ1bmN0aW9uKCQpIHtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblx0JC5mbWF0dGVyID0ge307XHJcblx0Ly9vcHRzIGNhbiBiZSBpZDpyb3cgaWQgZm9yIHRoZSByb3csIHJvd2RhdGE6dGhlIGRhdGEgZm9yIHRoZSByb3csIGNvbG1vZGVsOnRoZSBjb2x1bW4gbW9kZWwgZm9yIHRoaXMgY29sdW1uXHJcblx0Ly9leGFtcGxlIHtpZDoxMjM0LH1cclxuXHQkLmV4dGVuZCgkLmZtYXR0ZXIse1xyXG5cdFx0aXNCb29sZWFuIDogZnVuY3Rpb24obykge1xyXG5cdFx0XHRyZXR1cm4gdHlwZW9mIG8gPT09ICdib29sZWFuJztcclxuXHRcdH0sXHJcblx0XHRpc09iamVjdCA6IGZ1bmN0aW9uKG8pIHtcclxuXHRcdFx0cmV0dXJuIChvICYmICh0eXBlb2YgbyA9PT0gJ29iamVjdCcgfHwgJC5pc0Z1bmN0aW9uKG8pKSkgfHwgZmFsc2U7XHJcblx0XHR9LFxyXG5cdFx0aXNTdHJpbmcgOiBmdW5jdGlvbihvKSB7XHJcblx0XHRcdHJldHVybiB0eXBlb2YgbyA9PT0gJ3N0cmluZyc7XHJcblx0XHR9LFxyXG5cdFx0aXNOdW1iZXIgOiBmdW5jdGlvbihvKSB7XHJcblx0XHRcdHJldHVybiB0eXBlb2YgbyA9PT0gJ251bWJlcicgJiYgaXNGaW5pdGUobyk7XHJcblx0XHR9LFxyXG5cdFx0aXNWYWx1ZSA6IGZ1bmN0aW9uIChvKSB7XHJcblx0XHRcdHJldHVybiAodGhpcy5pc09iamVjdChvKSB8fCB0aGlzLmlzU3RyaW5nKG8pIHx8IHRoaXMuaXNOdW1iZXIobykgfHwgdGhpcy5pc0Jvb2xlYW4obykpO1xyXG5cdFx0fSxcclxuXHRcdGlzRW1wdHkgOiBmdW5jdGlvbihvKSB7XHJcblx0XHRcdGlmKCF0aGlzLmlzU3RyaW5nKG8pICYmIHRoaXMuaXNWYWx1ZShvKSkge1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoIXRoaXMuaXNWYWx1ZShvKSl7XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH1cclxuXHRcdFx0byA9ICQudHJpbShvKS5yZXBsYWNlKC9cXCZuYnNwXFw7L2lnLCcnKS5yZXBsYWNlKC9cXCYjMTYwXFw7L2lnLCcnKTtcclxuXHRcdFx0cmV0dXJuIG89PT1cIlwiO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdCQuZm4uZm1hdHRlciA9IGZ1bmN0aW9uKGZvcm1hdFR5cGUsIGNlbGx2YWwsIG9wdHMsIHJ3ZCwgYWN0KSB7XHJcblx0XHQvLyBidWlsZCBtYWluIG9wdGlvbnMgYmVmb3JlIGVsZW1lbnQgaXRlcmF0aW9uXHJcblx0XHR2YXIgdj1jZWxsdmFsO1xyXG5cdFx0b3B0cyA9ICQuZXh0ZW5kKHt9LCAkLmpncmlkLmZvcm1hdHRlciwgb3B0cyk7XHJcblxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0diA9ICQuZm4uZm1hdHRlcltmb3JtYXRUeXBlXS5jYWxsKHRoaXMsIGNlbGx2YWwsIG9wdHMsIHJ3ZCwgYWN0KTtcclxuXHRcdH0gY2F0Y2goZmUpe31cclxuXHRcdHJldHVybiB2O1xyXG5cdH07XHJcblx0JC5mbWF0dGVyLnV0aWwgPSB7XHJcblx0XHQvLyBUYWtlbiBmcm9tIFlBSE9PIHV0aWxzXHJcblx0XHROdW1iZXJGb3JtYXQgOiBmdW5jdGlvbihuRGF0YSxvcHRzKSB7XHJcblx0XHRcdGlmKCEkLmZtYXR0ZXIuaXNOdW1iZXIobkRhdGEpKSB7XHJcblx0XHRcdFx0bkRhdGEgKj0gMTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZigkLmZtYXR0ZXIuaXNOdW1iZXIobkRhdGEpKSB7XHJcblx0XHRcdFx0dmFyIGJOZWdhdGl2ZSA9IChuRGF0YSA8IDApO1xyXG5cdFx0XHRcdHZhciBzT3V0cHV0ID0gU3RyaW5nKG5EYXRhKTtcclxuXHRcdFx0XHR2YXIgc0RlY2ltYWxTZXBhcmF0b3IgPSBvcHRzLmRlY2ltYWxTZXBhcmF0b3IgfHwgXCIuXCI7XHJcblx0XHRcdFx0dmFyIG5Eb3RJbmRleDtcclxuXHRcdFx0XHRpZigkLmZtYXR0ZXIuaXNOdW1iZXIob3B0cy5kZWNpbWFsUGxhY2VzKSkge1xyXG5cdFx0XHRcdFx0Ly8gUm91bmQgdG8gdGhlIGNvcnJlY3QgZGVjaW1hbCBwbGFjZVxyXG5cdFx0XHRcdFx0dmFyIG5EZWNpbWFsUGxhY2VzID0gb3B0cy5kZWNpbWFsUGxhY2VzO1xyXG5cdFx0XHRcdFx0dmFyIG5EZWNpbWFsID0gTWF0aC5wb3coMTAsIG5EZWNpbWFsUGxhY2VzKTtcclxuXHRcdFx0XHRcdHNPdXRwdXQgPSBTdHJpbmcoTWF0aC5yb3VuZChuRGF0YSpuRGVjaW1hbCkvbkRlY2ltYWwpO1xyXG5cdFx0XHRcdFx0bkRvdEluZGV4ID0gc091dHB1dC5sYXN0SW5kZXhPZihcIi5cIik7XHJcblx0XHRcdFx0XHRpZihuRGVjaW1hbFBsYWNlcyA+IDApIHtcclxuXHRcdFx0XHRcdC8vIEFkZCB0aGUgZGVjaW1hbCBzZXBhcmF0b3JcclxuXHRcdFx0XHRcdFx0aWYobkRvdEluZGV4IDwgMCkge1xyXG5cdFx0XHRcdFx0XHRcdHNPdXRwdXQgKz0gc0RlY2ltYWxTZXBhcmF0b3I7XHJcblx0XHRcdFx0XHRcdFx0bkRvdEluZGV4ID0gc091dHB1dC5sZW5ndGgtMTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHQvLyBSZXBsYWNlIHRoZSBcIi5cIlxyXG5cdFx0XHRcdFx0XHRlbHNlIGlmKHNEZWNpbWFsU2VwYXJhdG9yICE9PSBcIi5cIil7XHJcblx0XHRcdFx0XHRcdFx0c091dHB1dCA9IHNPdXRwdXQucmVwbGFjZShcIi5cIixzRGVjaW1hbFNlcGFyYXRvcik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdC8vIEFkZCBtaXNzaW5nIHplcm9zXHJcblx0XHRcdFx0XHRcdHdoaWxlKChzT3V0cHV0Lmxlbmd0aCAtIDEgLSBuRG90SW5kZXgpIDwgbkRlY2ltYWxQbGFjZXMpIHtcclxuXHRcdFx0XHRcdFx0XHRzT3V0cHV0ICs9IFwiMFwiO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKG9wdHMudGhvdXNhbmRzU2VwYXJhdG9yKSB7XHJcblx0XHRcdFx0XHR2YXIgc1Rob3VzYW5kc1NlcGFyYXRvciA9IG9wdHMudGhvdXNhbmRzU2VwYXJhdG9yO1xyXG5cdFx0XHRcdFx0bkRvdEluZGV4ID0gc091dHB1dC5sYXN0SW5kZXhPZihzRGVjaW1hbFNlcGFyYXRvcik7XHJcblx0XHRcdFx0XHRuRG90SW5kZXggPSAobkRvdEluZGV4ID4gLTEpID8gbkRvdEluZGV4IDogc091dHB1dC5sZW5ndGg7XHJcblx0XHRcdFx0XHR2YXIgc05ld091dHB1dCA9IHNPdXRwdXQuc3Vic3RyaW5nKG5Eb3RJbmRleCk7XHJcblx0XHRcdFx0XHR2YXIgbkNvdW50ID0gLTEsIGk7XHJcblx0XHRcdFx0XHRmb3IgKGk9bkRvdEluZGV4OyBpPjA7IGktLSkge1xyXG5cdFx0XHRcdFx0XHRuQ291bnQrKztcclxuXHRcdFx0XHRcdFx0aWYgKChuQ291bnQlMyA9PT0gMCkgJiYgKGkgIT09IG5Eb3RJbmRleCkgJiYgKCFiTmVnYXRpdmUgfHwgKGkgPiAxKSkpIHtcclxuXHRcdFx0XHRcdFx0XHRzTmV3T3V0cHV0ID0gc1Rob3VzYW5kc1NlcGFyYXRvciArIHNOZXdPdXRwdXQ7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0c05ld091dHB1dCA9IHNPdXRwdXQuY2hhckF0KGktMSkgKyBzTmV3T3V0cHV0O1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0c091dHB1dCA9IHNOZXdPdXRwdXQ7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC8vIFByZXBlbmQgcHJlZml4XHJcblx0XHRcdFx0c091dHB1dCA9IChvcHRzLnByZWZpeCkgPyBvcHRzLnByZWZpeCArIHNPdXRwdXQgOiBzT3V0cHV0O1xyXG5cdFx0XHRcdC8vIEFwcGVuZCBzdWZmaXhcclxuXHRcdFx0XHRzT3V0cHV0ID0gKG9wdHMuc3VmZml4KSA/IHNPdXRwdXQgKyBvcHRzLnN1ZmZpeCA6IHNPdXRwdXQ7XHJcblx0XHRcdFx0cmV0dXJuIHNPdXRwdXQ7XHJcblxyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBuRGF0YTtcclxuXHRcdH1cclxuXHR9O1xyXG5cdCQuZm4uZm1hdHRlci5kZWZhdWx0Rm9ybWF0ID0gZnVuY3Rpb24oY2VsbHZhbCwgb3B0cykge1xyXG5cdFx0cmV0dXJuICgkLmZtYXR0ZXIuaXNWYWx1ZShjZWxsdmFsKSAmJiBjZWxsdmFsIT09XCJcIiApID8gIGNlbGx2YWwgOiBvcHRzLmRlZmF1bHRWYWx1ZSB8fCBcIiYjMTYwO1wiO1xyXG5cdH07XHJcblx0JC5mbi5mbWF0dGVyLmVtYWlsID0gZnVuY3Rpb24oY2VsbHZhbCwgb3B0cykge1xyXG5cdFx0aWYoISQuZm1hdHRlci5pc0VtcHR5KGNlbGx2YWwpKSB7XHJcblx0XHRcdHJldHVybiBcIjxhIGhyZWY9XFxcIm1haWx0bzpcIiArIGNlbGx2YWwgKyBcIlxcXCI+XCIgKyBjZWxsdmFsICsgXCI8L2E+XCI7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gJC5mbi5mbWF0dGVyLmRlZmF1bHRGb3JtYXQoY2VsbHZhbCxvcHRzICk7XHJcblx0fTtcclxuXHQkLmZuLmZtYXR0ZXIuY2hlY2tib3ggPWZ1bmN0aW9uKGN2YWwsIG9wdHMpIHtcclxuXHRcdHZhciBvcCA9ICQuZXh0ZW5kKHt9LG9wdHMuY2hlY2tib3gpLCBkcztcclxuXHRcdGlmKG9wdHMuY29sTW9kZWwgIT09IHVuZGVmaW5lZCAmJiBvcHRzLmNvbE1vZGVsLmZvcm1hdG9wdGlvbnMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRvcCA9ICQuZXh0ZW5kKHt9LG9wLG9wdHMuY29sTW9kZWwuZm9ybWF0b3B0aW9ucyk7XHJcblx0XHR9XHJcblx0XHRpZihvcC5kaXNhYmxlZD09PXRydWUpIHtkcyA9IFwiZGlzYWJsZWQ9XFxcImRpc2FibGVkXFxcIlwiO30gZWxzZSB7ZHM9XCJcIjt9XHJcblx0XHRpZigkLmZtYXR0ZXIuaXNFbXB0eShjdmFsKSB8fCBjdmFsID09PSB1bmRlZmluZWQgKSB7Y3ZhbCA9ICQuZm4uZm1hdHRlci5kZWZhdWx0Rm9ybWF0KGN2YWwsb3ApO31cclxuXHRcdGN2YWw9U3RyaW5nKGN2YWwpO1xyXG5cdFx0Y3ZhbD0oY3ZhbCtcIlwiKS50b0xvd2VyQ2FzZSgpO1xyXG5cdFx0dmFyIGJjaGsgPSBjdmFsLnNlYXJjaCgvKGZhbHNlfGZ8MHxub3xufG9mZnx1bmRlZmluZWQpL2kpPDAgPyBcIiBjaGVja2VkPSdjaGVja2VkJyBcIiA6IFwiXCI7XHJcblx0XHRyZXR1cm4gXCI8aW5wdXQgdHlwZT1cXFwiY2hlY2tib3hcXFwiIFwiICsgYmNoayAgKyBcIiB2YWx1ZT1cXFwiXCIrIGN2YWwrXCJcXFwiIG9mZnZhbD1cXFwibm9cXFwiIFwiK2RzKyBcIi8+XCI7XHJcblx0fTtcclxuXHQkLmZuLmZtYXR0ZXIubGluayA9IGZ1bmN0aW9uKGNlbGx2YWwsIG9wdHMpIHtcclxuXHRcdHZhciBvcCA9IHt0YXJnZXQ6b3B0cy50YXJnZXR9O1xyXG5cdFx0dmFyIHRhcmdldCA9IFwiXCI7XHJcblx0XHRpZihvcHRzLmNvbE1vZGVsICE9PSB1bmRlZmluZWQgJiYgb3B0cy5jb2xNb2RlbC5mb3JtYXRvcHRpb25zICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0b3AgPSAkLmV4dGVuZCh7fSxvcCxvcHRzLmNvbE1vZGVsLmZvcm1hdG9wdGlvbnMpO1xyXG5cdFx0fVxyXG5cdFx0aWYob3AudGFyZ2V0KSB7dGFyZ2V0ID0gJ3RhcmdldD0nICsgb3AudGFyZ2V0O31cclxuXHRcdGlmKCEkLmZtYXR0ZXIuaXNFbXB0eShjZWxsdmFsKSkge1xyXG5cdFx0XHRyZXR1cm4gXCI8YSBcIit0YXJnZXQrXCIgaHJlZj1cXFwiXCIgKyBjZWxsdmFsICsgXCJcXFwiPlwiICsgY2VsbHZhbCArIFwiPC9hPlwiO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuICQuZm4uZm1hdHRlci5kZWZhdWx0Rm9ybWF0KGNlbGx2YWwsb3B0cyk7XHJcblx0fTtcclxuXHQkLmZuLmZtYXR0ZXIuc2hvd2xpbmsgPSBmdW5jdGlvbihjZWxsdmFsLCBvcHRzKSB7XHJcblx0XHR2YXIgb3AgPSB7YmFzZUxpbmtVcmw6IG9wdHMuYmFzZUxpbmtVcmwsc2hvd0FjdGlvbjpvcHRzLnNob3dBY3Rpb24sIGFkZFBhcmFtOiBvcHRzLmFkZFBhcmFtIHx8IFwiXCIsIHRhcmdldDogb3B0cy50YXJnZXQsIGlkTmFtZTogb3B0cy5pZE5hbWV9LFxyXG5cdFx0dGFyZ2V0ID0gXCJcIiwgaWRVcmw7XHJcblx0XHRpZihvcHRzLmNvbE1vZGVsICE9PSB1bmRlZmluZWQgJiYgb3B0cy5jb2xNb2RlbC5mb3JtYXRvcHRpb25zICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0b3AgPSAkLmV4dGVuZCh7fSxvcCxvcHRzLmNvbE1vZGVsLmZvcm1hdG9wdGlvbnMpO1xyXG5cdFx0fVxyXG5cdFx0aWYob3AudGFyZ2V0KSB7dGFyZ2V0ID0gJ3RhcmdldD0nICsgb3AudGFyZ2V0O31cclxuXHRcdGlkVXJsID0gb3AuYmFzZUxpbmtVcmwrb3Auc2hvd0FjdGlvbiArICc/Jysgb3AuaWROYW1lKyc9JytvcHRzLnJvd0lkK29wLmFkZFBhcmFtO1xyXG5cdFx0aWYoJC5mbWF0dGVyLmlzU3RyaW5nKGNlbGx2YWwpIHx8ICQuZm1hdHRlci5pc051bWJlcihjZWxsdmFsKSkge1x0Ly9hZGQgdGhpcyBvbmUgZXZlbiBpZiBpdHMgYmxhbmsgc3RyaW5nXHJcblx0XHRcdHJldHVybiBcIjxhIFwiK3RhcmdldCtcIiBocmVmPVxcXCJcIiArIGlkVXJsICsgXCJcXFwiPlwiICsgY2VsbHZhbCArIFwiPC9hPlwiO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuICQuZm4uZm1hdHRlci5kZWZhdWx0Rm9ybWF0KGNlbGx2YWwsb3B0cyk7XHJcblx0fTtcclxuXHQkLmZuLmZtYXR0ZXIuaW50ZWdlciA9IGZ1bmN0aW9uKGNlbGx2YWwsIG9wdHMpIHtcclxuXHRcdHZhciBvcCA9ICQuZXh0ZW5kKHt9LG9wdHMuaW50ZWdlcik7XHJcblx0XHRpZihvcHRzLmNvbE1vZGVsICE9PSB1bmRlZmluZWQgJiYgb3B0cy5jb2xNb2RlbC5mb3JtYXRvcHRpb25zICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0b3AgPSAkLmV4dGVuZCh7fSxvcCxvcHRzLmNvbE1vZGVsLmZvcm1hdG9wdGlvbnMpO1xyXG5cdFx0fVxyXG5cdFx0aWYoJC5mbWF0dGVyLmlzRW1wdHkoY2VsbHZhbCkpIHtcclxuXHRcdFx0cmV0dXJuIG9wLmRlZmF1bHRWYWx1ZTtcclxuXHRcdH1cclxuXHRcdHJldHVybiAkLmZtYXR0ZXIudXRpbC5OdW1iZXJGb3JtYXQoY2VsbHZhbCxvcCk7XHJcblx0fTtcclxuXHQkLmZuLmZtYXR0ZXIubnVtYmVyID0gZnVuY3Rpb24gKGNlbGx2YWwsIG9wdHMpIHtcclxuXHRcdHZhciBvcCA9ICQuZXh0ZW5kKHt9LG9wdHMubnVtYmVyKTtcclxuXHRcdGlmKG9wdHMuY29sTW9kZWwgIT09IHVuZGVmaW5lZCAmJiBvcHRzLmNvbE1vZGVsLmZvcm1hdG9wdGlvbnMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRvcCA9ICQuZXh0ZW5kKHt9LG9wLG9wdHMuY29sTW9kZWwuZm9ybWF0b3B0aW9ucyk7XHJcblx0XHR9XHJcblx0XHRpZigkLmZtYXR0ZXIuaXNFbXB0eShjZWxsdmFsKSkge1xyXG5cdFx0XHRyZXR1cm4gb3AuZGVmYXVsdFZhbHVlO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuICQuZm1hdHRlci51dGlsLk51bWJlckZvcm1hdChjZWxsdmFsLG9wKTtcclxuXHR9O1xyXG5cdCQuZm4uZm1hdHRlci5jdXJyZW5jeSA9IGZ1bmN0aW9uIChjZWxsdmFsLCBvcHRzKSB7XHJcblx0XHR2YXIgb3AgPSAkLmV4dGVuZCh7fSxvcHRzLmN1cnJlbmN5KTtcclxuXHRcdGlmKG9wdHMuY29sTW9kZWwgIT09IHVuZGVmaW5lZCAmJiBvcHRzLmNvbE1vZGVsLmZvcm1hdG9wdGlvbnMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRvcCA9ICQuZXh0ZW5kKHt9LG9wLG9wdHMuY29sTW9kZWwuZm9ybWF0b3B0aW9ucyk7XHJcblx0XHR9XHJcblx0XHRpZigkLmZtYXR0ZXIuaXNFbXB0eShjZWxsdmFsKSkge1xyXG5cdFx0XHRyZXR1cm4gb3AuZGVmYXVsdFZhbHVlO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuICQuZm1hdHRlci51dGlsLk51bWJlckZvcm1hdChjZWxsdmFsLG9wKTtcclxuXHR9O1xyXG5cdCQuZm4uZm1hdHRlci5kYXRlID0gZnVuY3Rpb24gKGNlbGx2YWwsIG9wdHMsIHJ3ZCwgYWN0KSB7XHJcblx0XHR2YXIgb3AgPSAkLmV4dGVuZCh7fSxvcHRzLmRhdGUpO1xyXG5cdFx0aWYob3B0cy5jb2xNb2RlbCAhPT0gdW5kZWZpbmVkICYmIG9wdHMuY29sTW9kZWwuZm9ybWF0b3B0aW9ucyAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdG9wID0gJC5leHRlbmQoe30sb3Asb3B0cy5jb2xNb2RlbC5mb3JtYXRvcHRpb25zKTtcclxuXHRcdH1cclxuXHRcdGlmKCFvcC5yZWZvcm1hdEFmdGVyRWRpdCAmJiBhY3QgPT09ICdlZGl0Jyl7XHJcblx0XHRcdHJldHVybiAkLmZuLmZtYXR0ZXIuZGVmYXVsdEZvcm1hdChjZWxsdmFsLCBvcHRzKTtcclxuXHRcdH1cclxuXHRcdGlmKCEkLmZtYXR0ZXIuaXNFbXB0eShjZWxsdmFsKSkge1xyXG5cdFx0XHRyZXR1cm4gJC5qZ3JpZC5wYXJzZURhdGUob3Auc3JjZm9ybWF0LGNlbGx2YWwsb3AubmV3Zm9ybWF0LG9wKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiAkLmZuLmZtYXR0ZXIuZGVmYXVsdEZvcm1hdChjZWxsdmFsLCBvcHRzKTtcclxuXHR9O1xyXG5cdCQuZm4uZm1hdHRlci5zZWxlY3QgPSBmdW5jdGlvbiAoY2VsbHZhbCxvcHRzKSB7XHJcblx0XHQvLyBqcUdyaWQgc3BlY2lmaWNcclxuXHRcdGNlbGx2YWwgPSBTdHJpbmcoY2VsbHZhbCk7XHJcblx0XHR2YXIgb1NlbGVjdCA9IGZhbHNlLCByZXQ9W10sIHNlcCwgZGVsaW07XHJcblx0XHRpZihvcHRzLmNvbE1vZGVsLmZvcm1hdG9wdGlvbnMgIT09IHVuZGVmaW5lZCl7XHJcblx0XHRcdG9TZWxlY3Q9IG9wdHMuY29sTW9kZWwuZm9ybWF0b3B0aW9ucy52YWx1ZTtcclxuXHRcdFx0c2VwID0gb3B0cy5jb2xNb2RlbC5mb3JtYXRvcHRpb25zLnNlcGFyYXRvciA9PT0gdW5kZWZpbmVkID8gXCI6XCIgOiBvcHRzLmNvbE1vZGVsLmZvcm1hdG9wdGlvbnMuc2VwYXJhdG9yO1xyXG5cdFx0XHRkZWxpbSA9IG9wdHMuY29sTW9kZWwuZm9ybWF0b3B0aW9ucy5kZWxpbWl0ZXIgPT09IHVuZGVmaW5lZCA/IFwiO1wiIDogb3B0cy5jb2xNb2RlbC5mb3JtYXRvcHRpb25zLmRlbGltaXRlcjtcclxuXHRcdH0gZWxzZSBpZihvcHRzLmNvbE1vZGVsLmVkaXRvcHRpb25zICE9PSB1bmRlZmluZWQpe1xyXG5cdFx0XHRvU2VsZWN0PSBvcHRzLmNvbE1vZGVsLmVkaXRvcHRpb25zLnZhbHVlO1xyXG5cdFx0XHRzZXAgPSBvcHRzLmNvbE1vZGVsLmVkaXRvcHRpb25zLnNlcGFyYXRvciA9PT0gdW5kZWZpbmVkID8gXCI6XCIgOiBvcHRzLmNvbE1vZGVsLmVkaXRvcHRpb25zLnNlcGFyYXRvcjtcclxuXHRcdFx0ZGVsaW0gPSBvcHRzLmNvbE1vZGVsLmVkaXRvcHRpb25zLmRlbGltaXRlciA9PT0gdW5kZWZpbmVkID8gXCI7XCIgOiBvcHRzLmNvbE1vZGVsLmVkaXRvcHRpb25zLmRlbGltaXRlcjtcclxuXHRcdH1cclxuXHRcdGlmIChvU2VsZWN0KSB7XHJcblx0XHRcdHZhclx0bXNsID0gIG9wdHMuY29sTW9kZWwuZWRpdG9wdGlvbnMubXVsdGlwbGUgPT09IHRydWUgPyB0cnVlIDogZmFsc2UsXHJcblx0XHRcdHNjZWxsID0gW10sIHN2O1xyXG5cdFx0XHRpZihtc2wpIHtzY2VsbCA9IGNlbGx2YWwuc3BsaXQoXCIsXCIpO3NjZWxsID0gJC5tYXAoc2NlbGwsZnVuY3Rpb24obil7cmV0dXJuICQudHJpbShuKTt9KTt9XHJcblx0XHRcdGlmICgkLmZtYXR0ZXIuaXNTdHJpbmcob1NlbGVjdCkpIHtcclxuXHRcdFx0XHQvLyBteWJlIGhlcmUgd2UgY2FuIHVzZSBzb21lIGNhY2hpbmcgd2l0aCBjYXJlID8/Pz9cclxuXHRcdFx0XHR2YXIgc28gPSBvU2VsZWN0LnNwbGl0KGRlbGltKSwgaj0wLCBpO1xyXG5cdFx0XHRcdGZvcihpPTA7IGk8c28ubGVuZ3RoO2krKyl7XHJcblx0XHRcdFx0XHRzdiA9IHNvW2ldLnNwbGl0KHNlcCk7XHJcblx0XHRcdFx0XHRpZihzdi5sZW5ndGggPiAyICkge1xyXG5cdFx0XHRcdFx0XHRzdlsxXSA9ICQubWFwKHN2LGZ1bmN0aW9uKG4saSl7aWYoaT4wKSB7cmV0dXJuIG47fX0pLmpvaW4oc2VwKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKG1zbCkge1xyXG5cdFx0XHRcdFx0XHRpZigkLmluQXJyYXkoc3ZbMF0sc2NlbGwpPi0xKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0W2pdID0gc3ZbMV07XHJcblx0XHRcdFx0XHRcdFx0aisrO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYoJC50cmltKHN2WzBdKSA9PT0gJC50cmltKGNlbGx2YWwpKSB7XHJcblx0XHRcdFx0XHRcdHJldFswXSA9IHN2WzFdO1xyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSBpZigkLmZtYXR0ZXIuaXNPYmplY3Qob1NlbGVjdCkpIHtcclxuXHRcdFx0XHQvLyB0aGlzIGlzIHF1aWNrZXJcclxuXHRcdFx0XHRpZihtc2wpIHtcclxuXHRcdFx0XHRcdHJldCA9ICQubWFwKHNjZWxsLCBmdW5jdGlvbihuKXtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIG9TZWxlY3Rbbl07XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0cmV0WzBdID0gb1NlbGVjdFtjZWxsdmFsXSB8fCBcIlwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0Y2VsbHZhbCA9IHJldC5qb2luKFwiLCBcIik7XHJcblx0XHRyZXR1cm4gIGNlbGx2YWwgPT09IFwiXCIgPyAkLmZuLmZtYXR0ZXIuZGVmYXVsdEZvcm1hdChjZWxsdmFsLG9wdHMpIDogY2VsbHZhbDtcclxuXHR9O1xyXG5cdCQuZm4uZm1hdHRlci5yb3dhY3Rpb25zID0gZnVuY3Rpb24oYWN0KSB7XHJcblx0XHR2YXIgJHRyID0gJCh0aGlzKS5jbG9zZXN0KFwidHIuanFncm93XCIpLFxyXG5cdFx0XHRyaWQgPSAkdHIuYXR0cihcImlkXCIpLFxyXG5cdFx0XHQkaWQgPSAkKHRoaXMpLmNsb3Nlc3QoXCJ0YWJsZS51aS1qcWdyaWQtYnRhYmxlXCIpLmF0dHIoJ2lkJykucmVwbGFjZSgvX2Zyb3plbihbXl9dKikkLywnJDEnKSxcclxuXHRcdFx0JGdyaWQgPSAkKFwiI1wiKyRpZCksXHJcblx0XHRcdCR0ID0gJGdyaWRbMF0sXHJcblx0XHRcdHAgPSAkdC5wLFxyXG5cdFx0XHRjbSA9IHAuY29sTW9kZWxbJC5qZ3JpZC5nZXRDZWxsSW5kZXgodGhpcyldLFxyXG5cdFx0XHQkYWN0aW9uc0RpdiA9IGNtLmZyb3plbiA/ICQoXCJ0ciNcIityaWQrXCIgdGQ6ZXEoXCIrJC5qZ3JpZC5nZXRDZWxsSW5kZXgodGhpcykrXCIpID4gZGl2XCIsJGdyaWQpIDokKHRoaXMpLnBhcmVudCgpLFxyXG5cdFx0XHRvcCA9IHtcclxuXHRcdFx0XHRleHRyYXBhcmFtOiB7fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRzYXZlcm93ID0gZnVuY3Rpb24ocm93aWQsIHJlcykge1xyXG5cdFx0XHRcdGlmKCQuaXNGdW5jdGlvbihvcC5hZnRlclNhdmUpKSB7IG9wLmFmdGVyU2F2ZS5jYWxsKCR0LCByb3dpZCwgcmVzKTsgfVxyXG5cdFx0XHRcdCRhY3Rpb25zRGl2LmZpbmQoXCJkaXYudWktaW5saW5lLWVkaXQsZGl2LnVpLWlubGluZS1kZWxcIikuc2hvdygpO1xyXG5cdFx0XHRcdCRhY3Rpb25zRGl2LmZpbmQoXCJkaXYudWktaW5saW5lLXNhdmUsZGl2LnVpLWlubGluZS1jYW5jZWxcIikuaGlkZSgpO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRyZXN0b3Jlcm93ID0gZnVuY3Rpb24ocm93aWQpIHtcclxuXHRcdFx0XHRpZigkLmlzRnVuY3Rpb24ob3AuYWZ0ZXJSZXN0b3JlKSkgeyBvcC5hZnRlclJlc3RvcmUuY2FsbCgkdCwgcm93aWQpOyB9XHJcblx0XHRcdFx0JGFjdGlvbnNEaXYuZmluZChcImRpdi51aS1pbmxpbmUtZWRpdCxkaXYudWktaW5saW5lLWRlbFwiKS5zaG93KCk7XHJcblx0XHRcdFx0JGFjdGlvbnNEaXYuZmluZChcImRpdi51aS1pbmxpbmUtc2F2ZSxkaXYudWktaW5saW5lLWNhbmNlbFwiKS5oaWRlKCk7XHJcblx0XHRcdH07XHJcblxyXG5cdFx0aWYgKGNtLmZvcm1hdG9wdGlvbnMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRvcCA9ICQuZXh0ZW5kKG9wLGNtLmZvcm1hdG9wdGlvbnMpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHAuZWRpdE9wdGlvbnMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRvcC5lZGl0T3B0aW9ucyA9IHAuZWRpdE9wdGlvbnM7XHJcblx0XHR9XHJcblx0XHRpZiAocC5kZWxPcHRpb25zICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0b3AuZGVsT3B0aW9ucyA9IHAuZGVsT3B0aW9ucztcclxuXHRcdH1cclxuXHRcdGlmICgkdHIuaGFzQ2xhc3MoXCJqcWdyaWQtbmV3LXJvd1wiKSl7XHJcblx0XHRcdG9wLmV4dHJhcGFyYW1bcC5wcm1OYW1lcy5vcGVyXSA9IHAucHJtTmFtZXMuYWRkb3BlcjtcclxuXHRcdH1cclxuXHRcdHZhciBhY3RvcCA9IHtcclxuXHRcdFx0a2V5czogb3Aua2V5cyxcclxuXHRcdFx0b25lZGl0ZnVuYzogb3Aub25FZGl0LFxyXG5cdFx0XHRzdWNjZXNzZnVuYzogb3Aub25TdWNjZXNzLFxyXG5cdFx0XHR1cmw6IG9wLnVybCxcclxuXHRcdFx0ZXh0cmFwYXJhbTogb3AuZXh0cmFwYXJhbSxcclxuXHRcdFx0YWZ0ZXJzYXZlZnVuYzogc2F2ZXJvdyxcclxuXHRcdFx0ZXJyb3JmdW5jOiBvcC5vbkVycm9yLFxyXG5cdFx0XHRhZnRlcnJlc3RvcmVmdW5jOiByZXN0b3Jlcm93LFxyXG5cdFx0XHRyZXN0b3JlQWZ0ZXJFcnJvcjogb3AucmVzdG9yZUFmdGVyRXJyb3IsXHJcblx0XHRcdG10eXBlOiBvcC5tdHlwZVxyXG5cdFx0fTtcclxuXHRcdHN3aXRjaChhY3QpXHJcblx0XHR7XHJcblx0XHRcdGNhc2UgJ2VkaXQnOlxyXG5cdFx0XHRcdCRncmlkLmpxR3JpZCgnZWRpdFJvdycsIHJpZCwgYWN0b3ApO1xyXG5cdFx0XHRcdCRhY3Rpb25zRGl2LmZpbmQoXCJkaXYudWktaW5saW5lLWVkaXQsZGl2LnVpLWlubGluZS1kZWxcIikuaGlkZSgpO1xyXG5cdFx0XHRcdCRhY3Rpb25zRGl2LmZpbmQoXCJkaXYudWktaW5saW5lLXNhdmUsZGl2LnVpLWlubGluZS1jYW5jZWxcIikuc2hvdygpO1xyXG5cdFx0XHRcdCRncmlkLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWZ0ZXJHcmlkQ29tcGxldGVcIik7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgJ3NhdmUnOlxyXG5cdFx0XHRcdGlmICgkZ3JpZC5qcUdyaWQoJ3NhdmVSb3cnLCByaWQsIGFjdG9wKSkge1xyXG5cdFx0XHRcdFx0JGFjdGlvbnNEaXYuZmluZChcImRpdi51aS1pbmxpbmUtZWRpdCxkaXYudWktaW5saW5lLWRlbFwiKS5zaG93KCk7XHJcblx0XHRcdFx0XHQkYWN0aW9uc0Rpdi5maW5kKFwiZGl2LnVpLWlubGluZS1zYXZlLGRpdi51aS1pbmxpbmUtY2FuY2VsXCIpLmhpZGUoKTtcclxuXHRcdFx0XHRcdCRncmlkLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWZ0ZXJHcmlkQ29tcGxldGVcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlICdjYW5jZWwnIDpcclxuXHRcdFx0XHQkZ3JpZC5qcUdyaWQoJ3Jlc3RvcmVSb3cnLCByaWQsIHJlc3RvcmVyb3cpO1xyXG5cdFx0XHRcdCRhY3Rpb25zRGl2LmZpbmQoXCJkaXYudWktaW5saW5lLWVkaXQsZGl2LnVpLWlubGluZS1kZWxcIikuc2hvdygpO1xyXG5cdFx0XHRcdCRhY3Rpb25zRGl2LmZpbmQoXCJkaXYudWktaW5saW5lLXNhdmUsZGl2LnVpLWlubGluZS1jYW5jZWxcIikuaGlkZSgpO1xyXG5cdFx0XHRcdCRncmlkLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWZ0ZXJHcmlkQ29tcGxldGVcIik7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgJ2RlbCc6XHJcblx0XHRcdFx0JGdyaWQuanFHcmlkKCdkZWxHcmlkUm93JywgcmlkLCBvcC5kZWxPcHRpb25zKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSAnZm9ybWVkaXQnOlxyXG5cdFx0XHRcdCRncmlkLmpxR3JpZCgnc2V0U2VsZWN0aW9uJywgcmlkKTtcclxuXHRcdFx0XHQkZ3JpZC5qcUdyaWQoJ2VkaXRHcmlkUm93JywgcmlkLCBvcC5lZGl0T3B0aW9ucyk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHR9XHJcblx0fTtcclxuXHQkLmZuLmZtYXR0ZXIuYWN0aW9ucyA9IGZ1bmN0aW9uKGNlbGx2YWwsb3B0cykge1xyXG5cdFx0dmFyIG9wPXtrZXlzOmZhbHNlLCBlZGl0YnV0dG9uOnRydWUsIGRlbGJ1dHRvbjp0cnVlLCBlZGl0Zm9ybWJ1dHRvbjogZmFsc2V9LFxyXG5cdFx0XHRyb3dpZD1vcHRzLnJvd0lkLCBzdHI9XCJcIixvY2w7XHJcblx0XHRpZihvcHRzLmNvbE1vZGVsLmZvcm1hdG9wdGlvbnMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRvcCA9ICQuZXh0ZW5kKG9wLG9wdHMuY29sTW9kZWwuZm9ybWF0b3B0aW9ucyk7XHJcblx0XHR9XHJcblx0XHRpZihyb3dpZCA9PT0gdW5kZWZpbmVkIHx8ICQuZm1hdHRlci5pc0VtcHR5KHJvd2lkKSkge3JldHVybiBcIlwiO31cclxuXHRcdGlmKG9wLmVkaXRmb3JtYnV0dG9uKXtcclxuXHRcdFx0b2NsID0gXCJpZD0nakVkaXRCdXR0b25fXCIrcm93aWQrXCInIG9uY2xpY2s9alF1ZXJ5LmZuLmZtYXR0ZXIucm93YWN0aW9ucy5jYWxsKHRoaXMsJ2Zvcm1lZGl0Jyk7IG9ubW91c2VvdmVyPWpRdWVyeSh0aGlzKS5hZGRDbGFzcygndWktc3RhdGUtaG92ZXInKTsgb25tb3VzZW91dD1qUXVlcnkodGhpcykucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7IFwiO1xyXG5cdFx0XHRzdHIgKz0gXCI8ZGl2IHRpdGxlPSdcIiskLmpncmlkLm5hdi5lZGl0dGl0bGUrXCInIHN0eWxlPSdmbG9hdDpsZWZ0O2N1cnNvcjpwb2ludGVyOycgY2xhc3M9J3VpLXBnLWRpdiB1aS1pbmxpbmUtZWRpdCcgXCIrb2NsK1wiPjxzcGFuIGNsYXNzPSd1aS1pY29uIHVpLWljb24tcGVuY2lsJz48L3NwYW4+PC9kaXY+XCI7XHJcblx0XHR9IGVsc2UgaWYob3AuZWRpdGJ1dHRvbil7XHJcblx0XHRcdG9jbCA9IFwiaWQ9J2pFZGl0QnV0dG9uX1wiK3Jvd2lkK1wiJyBvbmNsaWNrPWpRdWVyeS5mbi5mbWF0dGVyLnJvd2FjdGlvbnMuY2FsbCh0aGlzLCdlZGl0Jyk7IG9ubW91c2VvdmVyPWpRdWVyeSh0aGlzKS5hZGRDbGFzcygndWktc3RhdGUtaG92ZXInKTsgb25tb3VzZW91dD1qUXVlcnkodGhpcykucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJykgXCI7XHJcblx0XHRcdHN0ciArPSBcIjxkaXYgdGl0bGU9J1wiKyQuamdyaWQubmF2LmVkaXR0aXRsZStcIicgc3R5bGU9J2Zsb2F0OmxlZnQ7Y3Vyc29yOnBvaW50ZXI7JyBjbGFzcz0ndWktcGctZGl2IHVpLWlubGluZS1lZGl0JyBcIitvY2wrXCI+PHNwYW4gY2xhc3M9J3VpLWljb24gdWktaWNvbi1wZW5jaWwnPjwvc3Bhbj48L2Rpdj5cIjtcclxuXHRcdH1cclxuXHRcdGlmKG9wLmRlbGJ1dHRvbikge1xyXG5cdFx0XHRvY2wgPSBcImlkPSdqRGVsZXRlQnV0dG9uX1wiK3Jvd2lkK1wiJyBvbmNsaWNrPWpRdWVyeS5mbi5mbWF0dGVyLnJvd2FjdGlvbnMuY2FsbCh0aGlzLCdkZWwnKTsgb25tb3VzZW92ZXI9alF1ZXJ5KHRoaXMpLmFkZENsYXNzKCd1aS1zdGF0ZS1ob3ZlcicpOyBvbm1vdXNlb3V0PWpRdWVyeSh0aGlzKS5yZW1vdmVDbGFzcygndWktc3RhdGUtaG92ZXInKTsgXCI7XHJcblx0XHRcdHN0ciArPSBcIjxkaXYgdGl0bGU9J1wiKyQuamdyaWQubmF2LmRlbHRpdGxlK1wiJyBzdHlsZT0nZmxvYXQ6bGVmdDttYXJnaW4tbGVmdDo1cHg7JyBjbGFzcz0ndWktcGctZGl2IHVpLWlubGluZS1kZWwnIFwiK29jbCtcIj48c3BhbiBjbGFzcz0ndWktaWNvbiB1aS1pY29uLXRyYXNoJz48L3NwYW4+PC9kaXY+XCI7XHJcblx0XHR9XHJcblx0XHRvY2wgPSBcImlkPSdqU2F2ZUJ1dHRvbl9cIityb3dpZCtcIicgb25jbGljaz1qUXVlcnkuZm4uZm1hdHRlci5yb3dhY3Rpb25zLmNhbGwodGhpcywnc2F2ZScpOyBvbm1vdXNlb3Zlcj1qUXVlcnkodGhpcykuYWRkQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7IG9ubW91c2VvdXQ9alF1ZXJ5KHRoaXMpLnJlbW92ZUNsYXNzKCd1aS1zdGF0ZS1ob3ZlcicpOyBcIjtcclxuXHRcdHN0ciArPSBcIjxkaXYgdGl0bGU9J1wiKyQuamdyaWQuZWRpdC5iU3VibWl0K1wiJyBzdHlsZT0nZmxvYXQ6bGVmdDtkaXNwbGF5Om5vbmUnIGNsYXNzPSd1aS1wZy1kaXYgdWktaW5saW5lLXNhdmUnIFwiK29jbCtcIj48c3BhbiBjbGFzcz0ndWktaWNvbiB1aS1pY29uLWRpc2snPjwvc3Bhbj48L2Rpdj5cIjtcclxuXHRcdG9jbCA9IFwiaWQ9J2pDYW5jZWxCdXR0b25fXCIrcm93aWQrXCInIG9uY2xpY2s9alF1ZXJ5LmZuLmZtYXR0ZXIucm93YWN0aW9ucy5jYWxsKHRoaXMsJ2NhbmNlbCcpOyBvbm1vdXNlb3Zlcj1qUXVlcnkodGhpcykuYWRkQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7IG9ubW91c2VvdXQ9alF1ZXJ5KHRoaXMpLnJlbW92ZUNsYXNzKCd1aS1zdGF0ZS1ob3ZlcicpOyBcIjtcclxuXHRcdHN0ciArPSBcIjxkaXYgdGl0bGU9J1wiKyQuamdyaWQuZWRpdC5iQ2FuY2VsK1wiJyBzdHlsZT0nZmxvYXQ6bGVmdDtkaXNwbGF5Om5vbmU7bWFyZ2luLWxlZnQ6NXB4OycgY2xhc3M9J3VpLXBnLWRpdiB1aS1pbmxpbmUtY2FuY2VsJyBcIitvY2wrXCI+PHNwYW4gY2xhc3M9J3VpLWljb24gdWktaWNvbi1jYW5jZWwnPjwvc3Bhbj48L2Rpdj5cIjtcclxuXHRcdHJldHVybiBcIjxkaXYgc3R5bGU9J21hcmdpbi1sZWZ0OjhweDsnPlwiICsgc3RyICsgXCI8L2Rpdj5cIjtcclxuXHR9O1xyXG5cdCQudW5mb3JtYXQgPSBmdW5jdGlvbiAoY2VsbHZhbCxvcHRpb25zLHBvcyxjbnQpIHtcclxuXHRcdC8vIHNwZWNpZmljIGZvciBqcUdyaWQgb25seVxyXG5cdFx0dmFyIHJldCwgZm9ybWF0VHlwZSA9IG9wdGlvbnMuY29sTW9kZWwuZm9ybWF0dGVyLFxyXG5cdFx0b3AgPW9wdGlvbnMuY29sTW9kZWwuZm9ybWF0b3B0aW9ucyB8fCB7fSwgc2VwLFxyXG5cdFx0cmUgPSAvKFtcXC5cXCpcXF9cXCdcXChcXClcXHtcXH1cXCtcXD9cXFxcXSkvZyxcclxuXHRcdHVuZm9ybWF0RnVuYyA9IG9wdGlvbnMuY29sTW9kZWwudW5mb3JtYXR8fCgkLmZuLmZtYXR0ZXJbZm9ybWF0VHlwZV0gJiYgJC5mbi5mbWF0dGVyW2Zvcm1hdFR5cGVdLnVuZm9ybWF0KTtcclxuXHRcdGlmKHVuZm9ybWF0RnVuYyAhPT0gdW5kZWZpbmVkICYmICQuaXNGdW5jdGlvbih1bmZvcm1hdEZ1bmMpICkge1xyXG5cdFx0XHRyZXQgPSB1bmZvcm1hdEZ1bmMuY2FsbCh0aGlzLCAkKGNlbGx2YWwpLnRleHQoKSwgb3B0aW9ucywgY2VsbHZhbCk7XHJcblx0XHR9IGVsc2UgaWYoZm9ybWF0VHlwZSAhPT0gdW5kZWZpbmVkICYmICQuZm1hdHRlci5pc1N0cmluZyhmb3JtYXRUeXBlKSApIHtcclxuXHRcdFx0dmFyIG9wdHMgPSAkLmpncmlkLmZvcm1hdHRlciB8fCB7fSwgc3RyaXBUYWc7XHJcblx0XHRcdHN3aXRjaChmb3JtYXRUeXBlKSB7XHJcblx0XHRcdFx0Y2FzZSAnaW50ZWdlcicgOlxyXG5cdFx0XHRcdFx0b3AgPSAkLmV4dGVuZCh7fSxvcHRzLmludGVnZXIsb3ApO1xyXG5cdFx0XHRcdFx0c2VwID0gb3AudGhvdXNhbmRzU2VwYXJhdG9yLnJlcGxhY2UocmUsXCJcXFxcJDFcIik7XHJcblx0XHRcdFx0XHRzdHJpcFRhZyA9IG5ldyBSZWdFeHAoc2VwLCBcImdcIik7XHJcblx0XHRcdFx0XHRyZXQgPSAkKGNlbGx2YWwpLnRleHQoKS5yZXBsYWNlKHN0cmlwVGFnLCcnKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgJ251bWJlcicgOlxyXG5cdFx0XHRcdFx0b3AgPSAkLmV4dGVuZCh7fSxvcHRzLm51bWJlcixvcCk7XHJcblx0XHRcdFx0XHRzZXAgPSBvcC50aG91c2FuZHNTZXBhcmF0b3IucmVwbGFjZShyZSxcIlxcXFwkMVwiKTtcclxuXHRcdFx0XHRcdHN0cmlwVGFnID0gbmV3IFJlZ0V4cChzZXAsIFwiZ1wiKTtcclxuXHRcdFx0XHRcdHJldCA9ICQoY2VsbHZhbCkudGV4dCgpLnJlcGxhY2Uoc3RyaXBUYWcsXCJcIikucmVwbGFjZShvcC5kZWNpbWFsU2VwYXJhdG9yLCcuJyk7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlICdjdXJyZW5jeSc6XHJcblx0XHRcdFx0XHRvcCA9ICQuZXh0ZW5kKHt9LG9wdHMuY3VycmVuY3ksb3ApO1xyXG5cdFx0XHRcdFx0c2VwID0gb3AudGhvdXNhbmRzU2VwYXJhdG9yLnJlcGxhY2UocmUsXCJcXFxcJDFcIik7XHJcblx0XHRcdFx0XHRzdHJpcFRhZyA9IG5ldyBSZWdFeHAoc2VwLCBcImdcIik7XHJcblx0XHRcdFx0XHRyZXQgPSAkKGNlbGx2YWwpLnRleHQoKTtcclxuXHRcdFx0XHRcdGlmIChvcC5wcmVmaXggJiYgb3AucHJlZml4Lmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRyZXQgPSByZXQuc3Vic3RyKG9wLnByZWZpeC5sZW5ndGgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYgKG9wLnN1ZmZpeCAmJiBvcC5zdWZmaXgubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdHJldCA9IHJldC5zdWJzdHIoMCwgcmV0Lmxlbmd0aCAtIG9wLnN1ZmZpeC5sZW5ndGgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0cmV0ID0gcmV0LnJlcGxhY2Uoc3RyaXBUYWcsJycpLnJlcGxhY2Uob3AuZGVjaW1hbFNlcGFyYXRvciwnLicpO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSAnY2hlY2tib3gnOlxyXG5cdFx0XHRcdFx0dmFyIGNidiA9IChvcHRpb25zLmNvbE1vZGVsLmVkaXRvcHRpb25zKSA/IG9wdGlvbnMuY29sTW9kZWwuZWRpdG9wdGlvbnMudmFsdWUuc3BsaXQoXCI6XCIpIDogW1wiWWVzXCIsXCJOb1wiXTtcclxuXHRcdFx0XHRcdHJldCA9ICQoJ2lucHV0JyxjZWxsdmFsKS5pcyhcIjpjaGVja2VkXCIpID8gY2J2WzBdIDogY2J2WzFdO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSAnc2VsZWN0JyA6XHJcblx0XHRcdFx0XHRyZXQgPSAkLnVuZm9ybWF0LnNlbGVjdChjZWxsdmFsLG9wdGlvbnMscG9zLGNudCk7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlICdhY3Rpb25zJzpcclxuXHRcdFx0XHRcdHJldHVybiBcIlwiO1xyXG5cdFx0XHRcdGRlZmF1bHQ6XHJcblx0XHRcdFx0XHRyZXQ9ICQoY2VsbHZhbCkudGV4dCgpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gcmV0ICE9PSB1bmRlZmluZWQgPyByZXQgOiBjbnQ9PT10cnVlID8gJChjZWxsdmFsKS50ZXh0KCkgOiAkLmpncmlkLmh0bWxEZWNvZGUoJChjZWxsdmFsKS5odG1sKCkpO1xyXG5cdH07XHJcblx0JC51bmZvcm1hdC5zZWxlY3QgPSBmdW5jdGlvbiAoY2VsbHZhbCxvcHRpb25zLHBvcyxjbnQpIHtcclxuXHRcdC8vIFNwYWNpYWwgY2FzZSB3aGVuIHdlIGhhdmUgbG9jYWwgZGF0YSBhbmQgcGVyZm9ybSBhIHNvcnRcclxuXHRcdC8vIGNudCBpcyBzZXQgdG8gdHJ1ZSBvbmx5IGluIHNvcnREYXRhQXJyYXlcclxuXHRcdHZhciByZXQgPSBbXTtcclxuXHRcdHZhciBjZWxsID0gJChjZWxsdmFsKS50ZXh0KCk7XHJcblx0XHRpZihjbnQ9PT10cnVlKSB7cmV0dXJuIGNlbGw7fVxyXG5cdFx0dmFyIG9wID0gJC5leHRlbmQoe30sIG9wdGlvbnMuY29sTW9kZWwuZm9ybWF0b3B0aW9ucyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5jb2xNb2RlbC5mb3JtYXRvcHRpb25zOiBvcHRpb25zLmNvbE1vZGVsLmVkaXRvcHRpb25zKSxcclxuXHRcdHNlcCA9IG9wLnNlcGFyYXRvciA9PT0gdW5kZWZpbmVkID8gXCI6XCIgOiBvcC5zZXBhcmF0b3IsXHJcblx0XHRkZWxpbSA9IG9wLmRlbGltaXRlciA9PT0gdW5kZWZpbmVkID8gXCI7XCIgOiBvcC5kZWxpbWl0ZXI7XHJcblxyXG5cdFx0aWYob3AudmFsdWUpe1xyXG5cdFx0XHR2YXIgb1NlbGVjdCA9IG9wLnZhbHVlLFxyXG5cdFx0XHRtc2wgPSAgb3AubXVsdGlwbGUgPT09IHRydWUgPyB0cnVlIDogZmFsc2UsXHJcblx0XHRcdHNjZWxsID0gW10sIHN2O1xyXG5cdFx0XHRpZihtc2wpIHtzY2VsbCA9IGNlbGwuc3BsaXQoXCIsXCIpO3NjZWxsID0gJC5tYXAoc2NlbGwsZnVuY3Rpb24obil7cmV0dXJuICQudHJpbShuKTt9KTt9XHJcblx0XHRcdGlmICgkLmZtYXR0ZXIuaXNTdHJpbmcob1NlbGVjdCkpIHtcclxuXHRcdFx0XHR2YXIgc28gPSBvU2VsZWN0LnNwbGl0KGRlbGltKSwgaj0wLCBpO1xyXG5cdFx0XHRcdGZvcihpPTA7IGk8c28ubGVuZ3RoO2krKyl7XHJcblx0XHRcdFx0XHRzdiA9IHNvW2ldLnNwbGl0KHNlcCk7XHJcblx0XHRcdFx0XHRpZihzdi5sZW5ndGggPiAyICkge1xyXG5cdFx0XHRcdFx0XHRzdlsxXSA9ICQubWFwKHN2LGZ1bmN0aW9uKG4saSl7aWYoaT4wKSB7cmV0dXJuIG47fX0pLmpvaW4oc2VwKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKG1zbCkge1xyXG5cdFx0XHRcdFx0XHRpZigkLmluQXJyYXkoc3ZbMV0sc2NlbGwpPi0xKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0W2pdID0gc3ZbMF07XHJcblx0XHRcdFx0XHRcdFx0aisrO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYoJC50cmltKHN2WzFdKSA9PT0gJC50cmltKGNlbGwpKSB7XHJcblx0XHRcdFx0XHRcdHJldFswXSA9IHN2WzBdO1xyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSBpZigkLmZtYXR0ZXIuaXNPYmplY3Qob1NlbGVjdCkgfHwgJC5pc0FycmF5KG9TZWxlY3QpICl7XHJcblx0XHRcdFx0aWYoIW1zbCkge3NjZWxsWzBdID0gIGNlbGw7fVxyXG5cdFx0XHRcdHJldCA9ICQubWFwKHNjZWxsLCBmdW5jdGlvbihuKXtcclxuXHRcdFx0XHRcdHZhciBydjtcclxuXHRcdFx0XHRcdCQuZWFjaChvU2VsZWN0LCBmdW5jdGlvbihpLHZhbCl7XHJcblx0XHRcdFx0XHRcdGlmICh2YWwgPT09IG4pIHtcclxuXHRcdFx0XHRcdFx0XHRydiA9IGk7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGlmKCBydiAhPT0gdW5kZWZpbmVkICkge3JldHVybiBydjt9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHJldC5qb2luKFwiLCBcIik7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gY2VsbCB8fCBcIlwiO1xyXG5cdH07XHJcblx0JC51bmZvcm1hdC5kYXRlID0gZnVuY3Rpb24gKGNlbGx2YWwsIG9wdHMpIHtcclxuXHRcdHZhciBvcCA9ICQuamdyaWQuZm9ybWF0dGVyLmRhdGUgfHwge307XHJcblx0XHRpZihvcHRzLmZvcm1hdG9wdGlvbnMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRvcCA9ICQuZXh0ZW5kKHt9LG9wLG9wdHMuZm9ybWF0b3B0aW9ucyk7XHJcblx0XHR9XHJcblx0XHRpZighJC5mbWF0dGVyLmlzRW1wdHkoY2VsbHZhbCkpIHtcclxuXHRcdFx0cmV0dXJuICQuamdyaWQucGFyc2VEYXRlKG9wLm5ld2Zvcm1hdCxjZWxsdmFsLG9wLnNyY2Zvcm1hdCxvcCk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gJC5mbi5mbWF0dGVyLmRlZmF1bHRGb3JtYXQoY2VsbHZhbCwgb3B0cyk7XHJcblx0fTtcclxufSkoalF1ZXJ5KTtcclxuLypqc2hpbnQgZXFlcWVxOmZhbHNlICovXHJcbi8qZ2xvYmFsIGpRdWVyeSAqL1xyXG4oZnVuY3Rpb24oJCl7XHJcbi8qXHJcbiAqIGpxR3JpZCBjb21tb24gZnVuY3Rpb25cclxuICogVG9ueSBUb21vdiB0b255QHRyaXJhbmQuY29tXHJcbiAqIGh0dHA6Ly90cmlyYW5kLmNvbS9ibG9nL1xyXG4gKiBEdWFsIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgYW5kIEdQTCBsaWNlbnNlczpcclxuICogaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuICogaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2dwbC0yLjAuaHRtbFxyXG4qL1xyXG5cInVzZSBzdHJpY3RcIjtcclxuJC5leHRlbmQoJC5qZ3JpZCx7XHJcbi8vIE1vZGFsIGZ1bmN0aW9uc1xyXG5cdHNob3dNb2RhbCA6IGZ1bmN0aW9uKGgpIHtcclxuXHRcdGgudy5zaG93KCk7XHJcblx0fSxcclxuXHRjbG9zZU1vZGFsIDogZnVuY3Rpb24oaCkge1xyXG5cdFx0aC53LmhpZGUoKS5hdHRyKFwiYXJpYS1oaWRkZW5cIixcInRydWVcIik7XHJcblx0XHRpZihoLm8pIHtoLm8ucmVtb3ZlKCk7fVxyXG5cdH0sXHJcblx0aGlkZU1vZGFsIDogZnVuY3Rpb24gKHNlbGVjdG9yLG8pIHtcclxuXHRcdG8gPSAkLmV4dGVuZCh7anFtIDogdHJ1ZSwgZ2IgOicnfSwgbyB8fCB7fSk7XHJcblx0XHRpZihvLm9uQ2xvc2UpIHtcclxuXHRcdFx0dmFyIG9uY3JldCA9IG8uZ2IgJiYgdHlwZW9mIG8uZ2IgPT09IFwic3RyaW5nXCIgJiYgby5nYi5zdWJzdHIoMCw2KSA9PT0gXCIjZ2JveF9cIiA/IG8ub25DbG9zZS5jYWxsKCQoXCIjXCIgKyBvLmdiLnN1YnN0cig2KSlbMF0sIHNlbGVjdG9yKSA6IG8ub25DbG9zZShzZWxlY3Rvcik7XHJcblx0XHRcdGlmICh0eXBlb2Ygb25jcmV0ID09PSAnYm9vbGVhbicgICYmICFvbmNyZXQgKSB7IHJldHVybjsgfVxyXG5cdFx0fVxyXG5cdFx0aWYgKCQuZm4uanFtICYmIG8uanFtID09PSB0cnVlKSB7XHJcblx0XHRcdCQoc2VsZWN0b3IpLmF0dHIoXCJhcmlhLWhpZGRlblwiLFwidHJ1ZVwiKS5qcW1IaWRlKCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRpZihvLmdiICE9PSAnJykge1xyXG5cdFx0XHRcdHRyeSB7JChcIi5qcWdyaWQtb3ZlcmxheTpmaXJzdFwiLG8uZ2IpLmhpZGUoKTt9IGNhdGNoIChlKXt9XHJcblx0XHRcdH1cclxuXHRcdFx0JChzZWxlY3RvcikuaGlkZSgpLmF0dHIoXCJhcmlhLWhpZGRlblwiLFwidHJ1ZVwiKTtcclxuXHRcdH1cclxuXHR9LFxyXG4vL0hlbHBlciBmdW5jdGlvbnNcclxuXHRmaW5kUG9zIDogZnVuY3Rpb24ob2JqKSB7XHJcblx0XHR2YXIgY3VybGVmdCA9IDAsIGN1cnRvcCA9IDA7XHJcblx0XHRpZiAob2JqLm9mZnNldFBhcmVudCkge1xyXG5cdFx0XHRkbyB7XHJcblx0XHRcdFx0Y3VybGVmdCArPSBvYmoub2Zmc2V0TGVmdDtcclxuXHRcdFx0XHRjdXJ0b3AgKz0gb2JqLm9mZnNldFRvcDtcclxuXHRcdFx0fSB3aGlsZSAob2JqID0gb2JqLm9mZnNldFBhcmVudCk7XHJcblx0XHRcdC8vZG8gbm90IGNoYW5nZSBvYmogPT0gb2JqLm9mZnNldFBhcmVudFxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIFtjdXJsZWZ0LGN1cnRvcF07XHJcblx0fSxcclxuXHRjcmVhdGVNb2RhbCA6IGZ1bmN0aW9uKGFJRHMsIGNvbnRlbnQsIHAsIGluc2VydFNlbGVjdG9yLCBwb3NTZWxlY3RvciwgYXBwZW5kc2VsLCBjc3MpIHtcclxuXHRcdHAgPSAkLmV4dGVuZCh0cnVlLCB7fSwgJC5qZ3JpZC5qcU1vZGFsIHx8IHt9LCBwKTtcclxuXHRcdHZhciBtdyAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSwgcnRsc3VwLCBzZWxmID0gdGhpcztcclxuXHRcdGNzcyA9ICQuZXh0ZW5kKHt9LCBjc3MgfHwge30pO1xyXG5cdFx0cnRsc3VwID0gJChwLmdib3gpLmF0dHIoXCJkaXJcIikgPT09IFwicnRsXCIgPyB0cnVlIDogZmFsc2U7XHJcblx0XHRtdy5jbGFzc05hbWU9IFwidWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwgdWktanFkaWFsb2dcIjtcclxuXHRcdG13LmlkID0gYUlEcy50aGVtb2RhbDtcclxuXHRcdHZhciBtaCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0bWguY2xhc3NOYW1lID0gXCJ1aS1qcWRpYWxvZy10aXRsZWJhciB1aS13aWRnZXQtaGVhZGVyIHVpLWNvcm5lci1hbGwgdWktaGVscGVyLWNsZWFyZml4XCI7XHJcblx0XHRtaC5pZCA9IGFJRHMubW9kYWxoZWFkO1xyXG5cdFx0JChtaCkuYXBwZW5kKFwiPHNwYW4gY2xhc3M9J3VpLWpxZGlhbG9nLXRpdGxlJz5cIitwLmNhcHRpb24rXCI8L3NwYW4+XCIpO1xyXG5cdFx0dmFyIGFocj0gJChcIjxhIGNsYXNzPSd1aS1qcWRpYWxvZy10aXRsZWJhci1jbG9zZSB1aS1jb3JuZXItYWxsJz48L2E+XCIpXHJcblx0XHQuaG92ZXIoZnVuY3Rpb24oKXthaHIuYWRkQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7fSxcclxuXHRcdFx0ZnVuY3Rpb24oKXthaHIucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7fSlcclxuXHRcdC5hcHBlbmQoXCI8c3BhbiBjbGFzcz0ndWktaWNvbiB1aS1pY29uLWNsb3NldGhpY2snPjwvc3Bhbj5cIik7XHJcblx0XHQkKG1oKS5hcHBlbmQoYWhyKTtcclxuXHRcdGlmKHJ0bHN1cCkge1xyXG5cdFx0XHRtdy5kaXIgPSBcInJ0bFwiO1xyXG5cdFx0XHQkKFwiLnVpLWpxZGlhbG9nLXRpdGxlXCIsbWgpLmNzcyhcImZsb2F0XCIsXCJyaWdodFwiKTtcclxuXHRcdFx0JChcIi51aS1qcWRpYWxvZy10aXRsZWJhci1jbG9zZVwiLG1oKS5jc3MoXCJsZWZ0XCIsMC4zK1wiZW1cIik7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRtdy5kaXIgPSBcImx0clwiO1xyXG5cdFx0XHQkKFwiLnVpLWpxZGlhbG9nLXRpdGxlXCIsbWgpLmNzcyhcImZsb2F0XCIsXCJsZWZ0XCIpO1xyXG5cdFx0XHQkKFwiLnVpLWpxZGlhbG9nLXRpdGxlYmFyLWNsb3NlXCIsbWgpLmNzcyhcInJpZ2h0XCIsMC4zK1wiZW1cIik7XHJcblx0XHR9XHJcblx0XHR2YXIgbWMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdCQobWMpLmFkZENsYXNzKFwidWktanFkaWFsb2ctY29udGVudCB1aS13aWRnZXQtY29udGVudFwiKS5hdHRyKFwiaWRcIixhSURzLm1vZGFsY29udGVudCk7XHJcblx0XHQkKG1jKS5hcHBlbmQoY29udGVudCk7XHJcblx0XHRtdy5hcHBlbmRDaGlsZChtYyk7XHJcblx0XHQkKG13KS5wcmVwZW5kKG1oKTtcclxuXHRcdGlmKGFwcGVuZHNlbD09PXRydWUpIHsgJCgnYm9keScpLmFwcGVuZChtdyk7IH0gLy9hcHBlbmQgYXMgZmlyc3QgY2hpbGQgaW4gYm9keSAtZm9yIGFsZXJ0IGRpYWxvZ1xyXG5cdFx0ZWxzZSBpZiAodHlwZW9mIGFwcGVuZHNlbCA9PT0gXCJzdHJpbmdcIikge1xyXG5cdFx0XHQkKGFwcGVuZHNlbCkuYXBwZW5kKG13KTtcclxuXHRcdH0gZWxzZSB7JChtdykuaW5zZXJ0QmVmb3JlKGluc2VydFNlbGVjdG9yKTt9XHJcblx0XHQkKG13KS5jc3MoY3NzKTtcclxuXHRcdGlmKHAuanFNb2RhbCA9PT0gdW5kZWZpbmVkKSB7cC5qcU1vZGFsID0gdHJ1ZTt9IC8vIGludGVybmFsIHVzZVxyXG5cdFx0dmFyIGNvb3JkID0ge307XHJcblx0XHRpZiAoICQuZm4uanFtICYmIHAuanFNb2RhbCA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRpZihwLmxlZnQgPT09MCAmJiBwLnRvcD09PTAgJiYgcC5vdmVybGF5KSB7XHJcblx0XHRcdFx0dmFyIHBvcyA9IFtdO1xyXG5cdFx0XHRcdHBvcyA9ICQuamdyaWQuZmluZFBvcyhwb3NTZWxlY3Rvcik7XHJcblx0XHRcdFx0cC5sZWZ0ID0gcG9zWzBdICsgNDtcclxuXHRcdFx0XHRwLnRvcCA9IHBvc1sxXSArIDQ7XHJcblx0XHRcdH1cclxuXHRcdFx0Y29vcmQudG9wID0gcC50b3ArXCJweFwiO1xyXG5cdFx0XHRjb29yZC5sZWZ0ID0gcC5sZWZ0O1xyXG5cdFx0fSBlbHNlIGlmKHAubGVmdCAhPT0wIHx8IHAudG9wIT09MCkge1xyXG5cdFx0XHRjb29yZC5sZWZ0ID0gcC5sZWZ0O1xyXG5cdFx0XHRjb29yZC50b3AgPSBwLnRvcCtcInB4XCI7XHJcblx0XHR9XHJcblx0XHQkKFwiYS51aS1qcWRpYWxvZy10aXRsZWJhci1jbG9zZVwiLG1oKS5jbGljayhmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgb25jbSA9ICQoXCIjXCIrJC5qZ3JpZC5qcUlEKGFJRHMudGhlbW9kYWwpKS5kYXRhKFwib25DbG9zZVwiKSB8fCBwLm9uQ2xvc2U7XHJcblx0XHRcdHZhciBnYm94Y2xvc2UgPSAkKFwiI1wiKyQuamdyaWQuanFJRChhSURzLnRoZW1vZGFsKSkuZGF0YShcImdib3hcIikgfHwgcC5nYm94O1xyXG5cdFx0XHRzZWxmLmhpZGVNb2RhbChcIiNcIiskLmpncmlkLmpxSUQoYUlEcy50aGVtb2RhbCkse2diOmdib3hjbG9zZSxqcW06cC5qcU1vZGFsLG9uQ2xvc2U6b25jbX0pO1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9KTtcclxuXHRcdGlmIChwLndpZHRoID09PSAwIHx8ICFwLndpZHRoKSB7cC53aWR0aCA9IDMwMDt9XHJcblx0XHRpZihwLmhlaWdodCA9PT0gMCB8fCAhcC5oZWlnaHQpIHtwLmhlaWdodCA9MjAwO31cclxuXHRcdGlmKCFwLnpJbmRleCkge1xyXG5cdFx0XHR2YXIgcGFyZW50WiA9ICQoaW5zZXJ0U2VsZWN0b3IpLnBhcmVudHMoXCIqW3JvbGU9ZGlhbG9nXVwiKS5maWx0ZXIoJzpmaXJzdCcpLmNzcyhcInotaW5kZXhcIik7XHJcblx0XHRcdGlmKHBhcmVudFopIHtcclxuXHRcdFx0XHRwLnpJbmRleCA9IHBhcnNlSW50KHBhcmVudFosMTApKzI7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cC56SW5kZXggPSA5NTA7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHZhciBydGx0ID0gMDtcclxuXHRcdGlmKCBydGxzdXAgJiYgY29vcmQubGVmdCAmJiAhYXBwZW5kc2VsKSB7XHJcblx0XHRcdHJ0bHQgPSAkKHAuZ2JveCkud2lkdGgoKS0gKCFpc05hTihwLndpZHRoKSA/IHBhcnNlSW50KHAud2lkdGgsMTApIDowKSAtIDg7IC8vIHRvIGRvXHJcblx0XHQvLyBqdXN0IGluIGNhc2VcclxuXHRcdFx0Y29vcmQubGVmdCA9IHBhcnNlSW50KGNvb3JkLmxlZnQsMTApICsgcGFyc2VJbnQocnRsdCwxMCk7XHJcblx0XHR9XHJcblx0XHRpZihjb29yZC5sZWZ0KSB7IGNvb3JkLmxlZnQgKz0gXCJweFwiOyB9XHJcblx0XHQkKG13KS5jc3MoJC5leHRlbmQoe1xyXG5cdFx0XHR3aWR0aDogaXNOYU4ocC53aWR0aCkgPyBcImF1dG9cIjogcC53aWR0aCtcInB4XCIsXHJcblx0XHRcdGhlaWdodDppc05hTihwLmhlaWdodCkgPyBcImF1dG9cIiA6IHAuaGVpZ2h0ICsgXCJweFwiLFxyXG5cdFx0XHR6SW5kZXg6cC56SW5kZXgsXHJcblx0XHRcdG92ZXJmbG93OiAnaGlkZGVuJ1xyXG5cdFx0fSxjb29yZCkpXHJcblx0XHQuYXR0cih7dGFiSW5kZXg6IFwiLTFcIixcInJvbGVcIjpcImRpYWxvZ1wiLFwiYXJpYS1sYWJlbGxlZGJ5XCI6YUlEcy5tb2RhbGhlYWQsXCJhcmlhLWhpZGRlblwiOlwidHJ1ZVwifSk7XHJcblx0XHRpZihwLmRyYWcgPT09IHVuZGVmaW5lZCkgeyBwLmRyYWc9dHJ1ZTt9XHJcblx0XHRpZihwLnJlc2l6ZSA9PT0gdW5kZWZpbmVkKSB7cC5yZXNpemU9dHJ1ZTt9XHJcblx0XHRpZiAocC5kcmFnKSB7XHJcblx0XHRcdCQobWgpLmNzcygnY3Vyc29yJywnbW92ZScpO1xyXG5cdFx0XHRpZigkLmZuLmpxRHJhZykge1xyXG5cdFx0XHRcdCQobXcpLmpxRHJhZyhtaCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdCQobXcpLmRyYWdnYWJsZSh7aGFuZGxlOiAkKFwiI1wiKyQuamdyaWQuanFJRChtaC5pZCkpfSk7XHJcblx0XHRcdFx0fSBjYXRjaCAoZSkge31cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0aWYocC5yZXNpemUpIHtcclxuXHRcdFx0aWYoJC5mbi5qcVJlc2l6ZSkge1xyXG5cdFx0XHRcdCQobXcpLmFwcGVuZChcIjxkaXYgY2xhc3M9J2pxUmVzaXplIHVpLXJlc2l6YWJsZS1oYW5kbGUgdWktcmVzaXphYmxlLXNlIHVpLWljb24gdWktaWNvbi1ncmlwc21hbGwtZGlhZ29uYWwtc2UnPjwvZGl2PlwiKTtcclxuXHRcdFx0XHQkKFwiI1wiKyQuamdyaWQuanFJRChhSURzLnRoZW1vZGFsKSkuanFSZXNpemUoXCIuanFSZXNpemVcIixhSURzLnNjcm9sbGVsbSA/IFwiI1wiKyQuamdyaWQuanFJRChhSURzLnNjcm9sbGVsbSkgOiBmYWxzZSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdCQobXcpLnJlc2l6YWJsZSh7aGFuZGxlczogJ3NlLCBzdycsYWxzb1Jlc2l6ZTogYUlEcy5zY3JvbGxlbG0gPyBcIiNcIiskLmpncmlkLmpxSUQoYUlEcy5zY3JvbGxlbG0pIDogZmFsc2V9KTtcclxuXHRcdFx0XHR9IGNhdGNoIChyKSB7fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZihwLmNsb3NlT25Fc2NhcGUgPT09IHRydWUpe1xyXG5cdFx0XHQkKG13KS5rZXlkb3duKCBmdW5jdGlvbiggZSApIHtcclxuXHRcdFx0XHRpZiggZS53aGljaCA9PSAyNyApIHtcclxuXHRcdFx0XHRcdHZhciBjb25lID0gJChcIiNcIiskLmpncmlkLmpxSUQoYUlEcy50aGVtb2RhbCkpLmRhdGEoXCJvbkNsb3NlXCIpIHx8IHAub25DbG9zZTtcclxuXHRcdFx0XHRcdHNlbGYuaGlkZU1vZGFsKFwiI1wiKyQuamdyaWQuanFJRChhSURzLnRoZW1vZGFsKSx7Z2I6cC5nYm94LGpxbTpwLmpxTW9kYWwsb25DbG9zZTogY29uZX0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fSxcclxuXHR2aWV3TW9kYWwgOiBmdW5jdGlvbiAoc2VsZWN0b3Isbyl7XHJcblx0XHRvID0gJC5leHRlbmQoe1xyXG5cdFx0XHR0b1RvcDogdHJ1ZSxcclxuXHRcdFx0b3ZlcmxheTogMTAsXHJcblx0XHRcdG1vZGFsOiBmYWxzZSxcclxuXHRcdFx0b3ZlcmxheUNsYXNzIDogJ3VpLXdpZGdldC1vdmVybGF5JyxcclxuXHRcdFx0b25TaG93OiAkLmpncmlkLnNob3dNb2RhbCxcclxuXHRcdFx0b25IaWRlOiAkLmpncmlkLmNsb3NlTW9kYWwsXHJcblx0XHRcdGdib3g6ICcnLFxyXG5cdFx0XHRqcW0gOiB0cnVlLFxyXG5cdFx0XHRqcU0gOiB0cnVlXHJcblx0XHR9LCBvIHx8IHt9KTtcclxuXHRcdGlmICgkLmZuLmpxbSAmJiBvLmpxbSA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRpZihvLmpxTSkgeyAkKHNlbGVjdG9yKS5hdHRyKFwiYXJpYS1oaWRkZW5cIixcImZhbHNlXCIpLmpxbShvKS5qcW1TaG93KCk7IH1cclxuXHRcdFx0ZWxzZSB7JChzZWxlY3RvcikuYXR0cihcImFyaWEtaGlkZGVuXCIsXCJmYWxzZVwiKS5qcW1TaG93KCk7fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0aWYoby5nYm94ICE9PSAnJykge1xyXG5cdFx0XHRcdCQoXCIuanFncmlkLW92ZXJsYXk6Zmlyc3RcIixvLmdib3gpLnNob3coKTtcclxuXHRcdFx0XHQkKHNlbGVjdG9yKS5kYXRhKFwiZ2JveFwiLG8uZ2JveCk7XHJcblx0XHRcdH1cclxuXHRcdFx0JChzZWxlY3Rvcikuc2hvdygpLmF0dHIoXCJhcmlhLWhpZGRlblwiLFwiZmFsc2VcIik7XHJcblx0XHRcdHRyeXskKCc6aW5wdXQ6dmlzaWJsZScsc2VsZWN0b3IpWzBdLmZvY3VzKCk7fWNhdGNoKF8pe31cclxuXHRcdH1cclxuXHR9LFxyXG5cdGluZm9fZGlhbG9nIDogZnVuY3Rpb24oY2FwdGlvbiwgY29udGVudCxjX2IsIG1vZGFsb3B0KSB7XHJcblx0XHR2YXIgbW9wdCA9IHtcclxuXHRcdFx0d2lkdGg6MjkwLFxyXG5cdFx0XHRoZWlnaHQ6J2F1dG8nLFxyXG5cdFx0XHRkYXRhaGVpZ2h0OiAnYXV0bycsXHJcblx0XHRcdGRyYWc6IHRydWUsXHJcblx0XHRcdHJlc2l6ZTogZmFsc2UsXHJcblx0XHRcdGxlZnQ6MjUwLFxyXG5cdFx0XHR0b3A6MTcwLFxyXG5cdFx0XHR6SW5kZXggOiAxMDAwLFxyXG5cdFx0XHRqcU1vZGFsIDogdHJ1ZSxcclxuXHRcdFx0bW9kYWwgOiBmYWxzZSxcclxuXHRcdFx0Y2xvc2VPbkVzY2FwZSA6IHRydWUsXHJcblx0XHRcdGFsaWduOiAnY2VudGVyJyxcclxuXHRcdFx0YnV0dG9uYWxpZ24gOiAnY2VudGVyJyxcclxuXHRcdFx0YnV0dG9ucyA6IFtdXHJcblx0XHQvLyB7dGV4dDondGV4dGJ1dHQnLCBpZDpcImJ1dHRpZFwiLCBvbkNsaWNrIDogZnVuY3Rpb24oKXsuLi59fVxyXG5cdFx0Ly8gaWYgdGhlIGlkIGlzIG5vdCBwcm92aWRlZCB3ZSBzZXQgaXQgbGlrZSBpbmZvX2J1dHRvbl8rIHRoZSBpbmRleCBpbiB0aGUgYXJyYXkgLSBpLmUgaW5mb19idXR0b25fMCxpbmZvX2J1dHRvbl8xLi4uXHJcblx0XHR9O1xyXG5cdFx0JC5leHRlbmQodHJ1ZSwgbW9wdCwgJC5qZ3JpZC5qcU1vZGFsIHx8IHt9LCB7Y2FwdGlvbjpcIjxiPlwiK2NhcHRpb24rXCI8L2I+XCJ9LCBtb2RhbG9wdCB8fCB7fSk7XHJcblx0XHR2YXIgam0gPSBtb3B0LmpxTW9kYWwsIHNlbGYgPSB0aGlzO1xyXG5cdFx0aWYoJC5mbi5qcW0gJiYgIWptKSB7IGptID0gZmFsc2U7IH1cclxuXHRcdC8vIGluIGNhc2UgdGhlcmUgaXMgbm8ganFNb2RhbFxyXG5cdFx0dmFyIGJ1dHRzdHIgPVwiXCIsIGk7XHJcblx0XHRpZihtb3B0LmJ1dHRvbnMubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRmb3IoaT0wO2k8bW9wdC5idXR0b25zLmxlbmd0aDtpKyspIHtcclxuXHRcdFx0XHRpZihtb3B0LmJ1dHRvbnNbaV0uaWQgPT09IHVuZGVmaW5lZCkgeyBtb3B0LmJ1dHRvbnNbaV0uaWQgPSBcImluZm9fYnV0dG9uX1wiK2k7IH1cclxuXHRcdFx0XHRidXR0c3RyICs9IFwiPGEgaWQ9J1wiK21vcHQuYnV0dG9uc1tpXS5pZCtcIicgY2xhc3M9J2ZtLWJ1dHRvbiB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1hbGwnPlwiK21vcHQuYnV0dG9uc1tpXS50ZXh0K1wiPC9hPlwiO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHR2YXIgZGggPSBpc05hTihtb3B0LmRhdGFoZWlnaHQpID8gbW9wdC5kYXRhaGVpZ2h0IDogbW9wdC5kYXRhaGVpZ2h0K1wicHhcIixcclxuXHRcdGNuID0gXCJ0ZXh0LWFsaWduOlwiK21vcHQuYWxpZ24rXCI7XCI7XHJcblx0XHR2YXIgY250ID0gXCI8ZGl2IGlkPSdpbmZvX2lkJz5cIjtcclxuXHRcdGNudCArPSBcIjxkaXYgaWQ9J2luZm9jbnQnIHN0eWxlPSdtYXJnaW46MHB4O3BhZGRpbmctYm90dG9tOjFlbTt3aWR0aDoxMDAlO292ZXJmbG93OmF1dG87cG9zaXRpb246cmVsYXRpdmU7aGVpZ2h0OlwiK2RoK1wiO1wiK2NuK1wiJz5cIitjb250ZW50K1wiPC9kaXY+XCI7XHJcblx0XHRjbnQgKz0gY19iID8gXCI8ZGl2IGNsYXNzPSd1aS13aWRnZXQtY29udGVudCB1aS1oZWxwZXItY2xlYXJmaXgnIHN0eWxlPSd0ZXh0LWFsaWduOlwiK21vcHQuYnV0dG9uYWxpZ24rXCI7cGFkZGluZy1ib3R0b206MC44ZW07cGFkZGluZy10b3A6MC41ZW07YmFja2dyb3VuZC1pbWFnZTogbm9uZTtib3JkZXItd2lkdGg6IDFweCAwIDAgMDsnPjxhIGlkPSdjbG9zZWRpYWxvZycgY2xhc3M9J2ZtLWJ1dHRvbiB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1hbGwnPlwiK2NfYitcIjwvYT5cIitidXR0c3RyK1wiPC9kaXY+XCIgOlxyXG5cdFx0XHRidXR0c3RyICE9PSBcIlwiICA/IFwiPGRpdiBjbGFzcz0ndWktd2lkZ2V0LWNvbnRlbnQgdWktaGVscGVyLWNsZWFyZml4JyBzdHlsZT0ndGV4dC1hbGlnbjpcIittb3B0LmJ1dHRvbmFsaWduK1wiO3BhZGRpbmctYm90dG9tOjAuOGVtO3BhZGRpbmctdG9wOjAuNWVtO2JhY2tncm91bmQtaW1hZ2U6IG5vbmU7Ym9yZGVyLXdpZHRoOiAxcHggMCAwIDA7Jz5cIitidXR0c3RyK1wiPC9kaXY+XCIgOiBcIlwiO1xyXG5cdFx0Y250ICs9IFwiPC9kaXY+XCI7XHJcblxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0aWYoJChcIiNpbmZvX2RpYWxvZ1wiKS5hdHRyKFwiYXJpYS1oaWRkZW5cIikgPT09IFwiZmFsc2VcIikge1xyXG5cdFx0XHRcdCQuamdyaWQuaGlkZU1vZGFsKFwiI2luZm9fZGlhbG9nXCIse2pxbTpqbX0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdCQoXCIjaW5mb19kaWFsb2dcIikucmVtb3ZlKCk7XHJcblx0XHR9IGNhdGNoIChlKXt9XHJcblx0XHQkLmpncmlkLmNyZWF0ZU1vZGFsKHtcclxuXHRcdFx0dGhlbW9kYWw6J2luZm9fZGlhbG9nJyxcclxuXHRcdFx0bW9kYWxoZWFkOidpbmZvX2hlYWQnLFxyXG5cdFx0XHRtb2RhbGNvbnRlbnQ6J2luZm9fY29udGVudCcsXHJcblx0XHRcdHNjcm9sbGVsbTogJ2luZm9jbnQnfSxcclxuXHRcdFx0Y250LFxyXG5cdFx0XHRtb3B0LFxyXG5cdFx0XHQnJywnJyx0cnVlXHJcblx0XHQpO1xyXG5cdFx0Ly8gYXR0YWNoIG9uY2xpY2sgYWZ0ZXIgaW5zZXJ0aW5nIGludG8gdGhlIGRvbVxyXG5cdFx0aWYoYnV0dHN0cikge1xyXG5cdFx0XHQkLmVhY2gobW9wdC5idXR0b25zLGZ1bmN0aW9uKGkpe1xyXG5cdFx0XHRcdCQoXCIjXCIrJC5qZ3JpZC5qcUlEKHRoaXMuaWQpLFwiI2luZm9faWRcIikuYmluZCgnY2xpY2snLGZ1bmN0aW9uKCl7bW9wdC5idXR0b25zW2ldLm9uQ2xpY2suY2FsbCgkKFwiI2luZm9fZGlhbG9nXCIpKTsgcmV0dXJuIGZhbHNlO30pO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHRcdCQoXCIjY2xvc2VkaWFsb2dcIiwgXCIjaW5mb19pZFwiKS5jbGljayhmdW5jdGlvbigpe1xyXG5cdFx0XHRzZWxmLmhpZGVNb2RhbChcIiNpbmZvX2RpYWxvZ1wiLHtcclxuXHRcdFx0XHRqcW06am0sXHJcblx0XHRcdFx0b25DbG9zZTogJChcIiNpbmZvX2RpYWxvZ1wiKS5kYXRhKFwib25DbG9zZVwiKSB8fCBtb3B0Lm9uQ2xvc2UsXHJcblx0XHRcdFx0Z2I6ICQoXCIjaW5mb19kaWFsb2dcIikuZGF0YShcImdib3hcIikgfHwgbW9wdC5nYm94XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9KTtcclxuXHRcdCQoXCIuZm0tYnV0dG9uXCIsXCIjaW5mb19kaWFsb2dcIikuaG92ZXIoXHJcblx0XHRcdGZ1bmN0aW9uKCl7JCh0aGlzKS5hZGRDbGFzcygndWktc3RhdGUtaG92ZXInKTt9LFxyXG5cdFx0XHRmdW5jdGlvbigpeyQodGhpcykucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7fVxyXG5cdFx0KTtcclxuXHRcdGlmKCQuaXNGdW5jdGlvbihtb3B0LmJlZm9yZU9wZW4pICkgeyBtb3B0LmJlZm9yZU9wZW4oKTsgfVxyXG5cdFx0JC5qZ3JpZC52aWV3TW9kYWwoXCIjaW5mb19kaWFsb2dcIix7XHJcblx0XHRcdG9uSGlkZTogZnVuY3Rpb24oaCkge1xyXG5cdFx0XHRcdGgudy5oaWRlKCkucmVtb3ZlKCk7XHJcblx0XHRcdFx0aWYoaC5vKSB7IGguby5yZW1vdmUoKTsgfVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRtb2RhbCA6bW9wdC5tb2RhbCxcclxuXHRcdFx0anFtOmptXHJcblx0XHR9KTtcclxuXHRcdGlmKCQuaXNGdW5jdGlvbihtb3B0LmFmdGVyT3BlbikgKSB7IG1vcHQuYWZ0ZXJPcGVuKCk7IH1cclxuXHRcdHRyeXsgJChcIiNpbmZvX2RpYWxvZ1wiKS5mb2N1cygpO30gY2F0Y2ggKG0pe31cclxuXHR9LFxyXG5cdGJpbmRFdjogZnVuY3Rpb24gIChlbCwgb3B0KSB7XHJcblx0XHR2YXIgJHQgPSB0aGlzO1xyXG5cdFx0aWYoJC5pc0Z1bmN0aW9uKG9wdC5kYXRhSW5pdCkpIHtcclxuXHRcdFx0b3B0LmRhdGFJbml0LmNhbGwoJHQsZWwsb3B0KTtcclxuXHRcdH1cclxuXHRcdGlmKG9wdC5kYXRhRXZlbnRzKSB7XHJcblx0XHRcdCQuZWFjaChvcHQuZGF0YUV2ZW50cywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0aWYgKHRoaXMuZGF0YSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHQkKGVsKS5iaW5kKHRoaXMudHlwZSwgdGhpcy5kYXRhLCB0aGlzLmZuKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JChlbCkuYmluZCh0aGlzLnR5cGUsIHRoaXMuZm4pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fSxcclxuLy8gRm9ybSBGdW5jdGlvbnNcclxuXHRjcmVhdGVFbCA6IGZ1bmN0aW9uKGVsdHlwZSxvcHRpb25zLHZsLGF1dG93aWR0aCwgYWpheHNvKSB7XHJcblx0XHR2YXIgZWxlbSA9IFwiXCIsICR0ID0gdGhpcztcclxuXHRcdGZ1bmN0aW9uIHNldEF0dHJpYnV0ZXMoZWxtLCBhdHIsIGV4bCApIHtcclxuXHRcdFx0dmFyIGV4Y2x1ZGUgPSBbJ2RhdGFJbml0JywnZGF0YUV2ZW50cycsJ2RhdGFVcmwnLCAnYnVpbGRTZWxlY3QnLCdzb3B0JywgJ3NlYXJjaGhpZGRlbicsICdkZWZhdWx0VmFsdWUnLCAnYXR0cicsICdjdXN0b21fZWxlbWVudCcsICdjdXN0b21fdmFsdWUnXTtcclxuXHRcdFx0aWYoZXhsICE9PSB1bmRlZmluZWQgJiYgJC5pc0FycmF5KGV4bCkpIHtcclxuXHRcdFx0XHQkLm1lcmdlKGV4Y2x1ZGUsIGV4bCk7XHJcblx0XHRcdH1cclxuXHRcdFx0JC5lYWNoKGF0ciwgZnVuY3Rpb24oa2V5LCB2YWx1ZSl7XHJcblx0XHRcdFx0aWYoJC5pbkFycmF5KGtleSwgZXhjbHVkZSkgPT09IC0xKSB7XHJcblx0XHRcdFx0XHQkKGVsbSkuYXR0cihrZXksdmFsdWUpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdGlmKCFhdHIuaGFzT3duUHJvcGVydHkoJ2lkJykpIHtcclxuXHRcdFx0XHQkKGVsbSkuYXR0cignaWQnLCAkLmpncmlkLnJhbmRJZCgpKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0c3dpdGNoIChlbHR5cGUpXHJcblx0XHR7XHJcblx0XHRcdGNhc2UgXCJ0ZXh0YXJlYVwiIDpcclxuXHRcdFx0XHRlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRleHRhcmVhXCIpO1xyXG5cdFx0XHRcdGlmKGF1dG93aWR0aCkge1xyXG5cdFx0XHRcdFx0aWYoIW9wdGlvbnMuY29scykgeyAkKGVsZW0pLmNzcyh7d2lkdGg6XCI5OCVcIn0pO31cclxuXHRcdFx0XHR9IGVsc2UgaWYgKCFvcHRpb25zLmNvbHMpIHsgb3B0aW9ucy5jb2xzID0gMjA7IH1cclxuXHRcdFx0XHRpZighb3B0aW9ucy5yb3dzKSB7IG9wdGlvbnMucm93cyA9IDI7IH1cclxuXHRcdFx0XHRpZih2bD09PScmbmJzcDsnIHx8IHZsPT09JyYjMTYwOycgfHwgKHZsLmxlbmd0aD09PTEgJiYgdmwuY2hhckNvZGVBdCgwKT09PTE2MCkpIHt2bD1cIlwiO31cclxuXHRcdFx0XHRlbGVtLnZhbHVlID0gdmw7XHJcblx0XHRcdFx0c2V0QXR0cmlidXRlcyhlbGVtLCBvcHRpb25zKTtcclxuXHRcdFx0XHQkKGVsZW0pLmF0dHIoe1wicm9sZVwiOlwidGV4dGJveFwiLFwibXVsdGlsaW5lXCI6XCJ0cnVlXCJ9KTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgXCJjaGVja2JveFwiIDogLy93aGF0IGNvZGUgZm9yIHNpbXBsZSBjaGVja2JveFxyXG5cdFx0XHRcdGVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcblx0XHRcdFx0ZWxlbS50eXBlID0gXCJjaGVja2JveFwiO1xyXG5cdFx0XHRcdGlmKCAhb3B0aW9ucy52YWx1ZSApIHtcclxuXHRcdFx0XHRcdHZhciB2bDEgPSAodmwrXCJcIikudG9Mb3dlckNhc2UoKTtcclxuXHRcdFx0XHRcdGlmKHZsMS5zZWFyY2goLyhmYWxzZXxmfDB8bm98bnxvZmZ8dW5kZWZpbmVkKS9pKTwwICYmIHZsMSE9PVwiXCIpIHtcclxuXHRcdFx0XHRcdFx0ZWxlbS5jaGVja2VkPXRydWU7XHJcblx0XHRcdFx0XHRcdGVsZW0uZGVmYXVsdENoZWNrZWQ9dHJ1ZTtcclxuXHRcdFx0XHRcdFx0ZWxlbS52YWx1ZSA9IHZsO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0ZWxlbS52YWx1ZSA9IFwib25cIjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdCQoZWxlbSkuYXR0cihcIm9mZnZhbFwiLFwib2ZmXCIpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR2YXIgY2J2YWwgPSBvcHRpb25zLnZhbHVlLnNwbGl0KFwiOlwiKTtcclxuXHRcdFx0XHRcdGlmKHZsID09PSBjYnZhbFswXSkge1xyXG5cdFx0XHRcdFx0XHRlbGVtLmNoZWNrZWQ9dHJ1ZTtcclxuXHRcdFx0XHRcdFx0ZWxlbS5kZWZhdWx0Q2hlY2tlZD10cnVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZWxlbS52YWx1ZSA9IGNidmFsWzBdO1xyXG5cdFx0XHRcdFx0JChlbGVtKS5hdHRyKFwib2ZmdmFsXCIsY2J2YWxbMV0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRzZXRBdHRyaWJ1dGVzKGVsZW0sIG9wdGlvbnMsIFsndmFsdWUnXSk7XHJcblx0XHRcdFx0JChlbGVtKS5hdHRyKFwicm9sZVwiLFwiY2hlY2tib3hcIik7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIFwic2VsZWN0XCIgOlxyXG5cdFx0XHRcdGVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2VsZWN0XCIpO1xyXG5cdFx0XHRcdGVsZW0uc2V0QXR0cmlidXRlKFwicm9sZVwiLFwic2VsZWN0XCIpO1xyXG5cdFx0XHRcdHZhciBtc2wsIG92bSA9IFtdO1xyXG5cdFx0XHRcdGlmKG9wdGlvbnMubXVsdGlwbGU9PT10cnVlKSB7XHJcblx0XHRcdFx0XHRtc2wgPSB0cnVlO1xyXG5cdFx0XHRcdFx0ZWxlbS5tdWx0aXBsZT1cIm11bHRpcGxlXCI7XHJcblx0XHRcdFx0XHQkKGVsZW0pLmF0dHIoXCJhcmlhLW11bHRpc2VsZWN0YWJsZVwiLFwidHJ1ZVwiKTtcclxuXHRcdFx0XHR9IGVsc2UgeyBtc2wgPSBmYWxzZTsgfVxyXG5cdFx0XHRcdGlmKG9wdGlvbnMuZGF0YVVybCAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHR2YXIgcm93aWQgPSBvcHRpb25zLm5hbWUgPyBTdHJpbmcob3B0aW9ucy5pZCkuc3Vic3RyaW5nKDAsIFN0cmluZyhvcHRpb25zLmlkKS5sZW5ndGggLSBTdHJpbmcob3B0aW9ucy5uYW1lKS5sZW5ndGggLSAxKSA6IFN0cmluZyhvcHRpb25zLmlkKSxcclxuXHRcdFx0XHRcdFx0cG9zdERhdGEgPSBvcHRpb25zLnBvc3REYXRhIHx8IGFqYXhzby5wb3N0RGF0YTtcclxuXHJcblx0XHRcdFx0XHRpZiAoJHQucCAmJiAkdC5wLmlkUHJlZml4KSB7XHJcblx0XHRcdFx0XHRcdHJvd2lkID0gJC5qZ3JpZC5zdHJpcFByZWYoJHQucC5pZFByZWZpeCwgcm93aWQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0JC5hamF4KCQuZXh0ZW5kKHtcclxuXHRcdFx0XHRcdFx0dXJsOiAkLmlzRnVuY3Rpb24ob3B0aW9ucy5kYXRhVXJsKSA/IG9wdGlvbnMuZGF0YVVybC5jYWxsKCR0LCByb3dpZCwgdmwsIFN0cmluZyhvcHRpb25zLm5hbWUpKSA6IG9wdGlvbnMuZGF0YVVybCxcclxuXHRcdFx0XHRcdFx0dHlwZSA6IFwiR0VUXCIsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOiBcImh0bWxcIixcclxuXHRcdFx0XHRcdFx0ZGF0YTogJC5pc0Z1bmN0aW9uKHBvc3REYXRhKSA/IHBvc3REYXRhLmNhbGwoJHQsIHJvd2lkLCB2bCwgU3RyaW5nKG9wdGlvbnMubmFtZSkpIDogcG9zdERhdGEsXHJcblx0XHRcdFx0XHRcdGNvbnRleHQ6IHtlbGVtOmVsZW0sIG9wdGlvbnM6b3B0aW9ucywgdmw6dmx9LFxyXG5cdFx0XHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKXtcclxuXHRcdFx0XHRcdFx0XHR2YXIgb3ZtID0gW10sIGVsZW0gPSB0aGlzLmVsZW0sIHZsID0gdGhpcy52bCxcclxuXHRcdFx0XHRcdFx0XHRvcHRpb25zID0gJC5leHRlbmQoe30sdGhpcy5vcHRpb25zKSxcclxuXHRcdFx0XHRcdFx0XHRtc2wgPSBvcHRpb25zLm11bHRpcGxlPT09dHJ1ZSxcclxuXHRcdFx0XHRcdFx0XHRhID0gJC5pc0Z1bmN0aW9uKG9wdGlvbnMuYnVpbGRTZWxlY3QpID8gb3B0aW9ucy5idWlsZFNlbGVjdC5jYWxsKCR0LGRhdGEpIDogZGF0YTtcclxuXHRcdFx0XHRcdFx0XHRpZih0eXBlb2YgYSA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGEgPSAkKCAkLnRyaW0oIGEgKSApLmh0bWwoKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0aWYoYSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JChlbGVtKS5hcHBlbmQoYSk7XHJcblx0XHRcdFx0XHRcdFx0XHRzZXRBdHRyaWJ1dGVzKGVsZW0sIG9wdGlvbnMsIHBvc3REYXRhID8gWydwb3N0RGF0YSddIDogdW5kZWZpbmVkICk7XHJcblx0XHRcdFx0XHRcdFx0XHRpZihvcHRpb25zLnNpemUgPT09IHVuZGVmaW5lZCkgeyBvcHRpb25zLnNpemUgPSAgbXNsID8gMyA6IDE7fVxyXG5cdFx0XHRcdFx0XHRcdFx0aWYobXNsKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdG92bSA9IHZsLnNwbGl0KFwiLFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0b3ZtID0gJC5tYXAob3ZtLGZ1bmN0aW9uKG4pe3JldHVybiAkLnRyaW0obik7fSk7XHJcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRvdm1bMF0gPSAkLnRyaW0odmwpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0Ly8kKGVsZW0pLmF0dHIob3B0aW9ucyk7XHJcblx0XHRcdFx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQoXCJvcHRpb25cIixlbGVtKS5lYWNoKGZ1bmN0aW9uKGkpe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vaWYoaT09PTApIHsgdGhpcy5zZWxlY3RlZCA9IFwiXCI7IH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBmaXggSUU4L0lFNyBwcm9ibGVtIHdpdGggc2VsZWN0aW5nIG9mIHRoZSBmaXJzdCBpdGVtIG9uIG11bHRpcGxlPXRydWVcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoaSA9PT0gMCAmJiBlbGVtLm11bHRpcGxlKSB7IHRoaXMuc2VsZWN0ZWQgPSBmYWxzZTsgfVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCQodGhpcykuYXR0cihcInJvbGVcIixcIm9wdGlvblwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZigkLmluQXJyYXkoJC50cmltKCQodGhpcykudGV4dCgpKSxvdm0pID4gLTEgfHwgJC5pbkFycmF5KCQudHJpbSgkKHRoaXMpLnZhbCgpKSxvdm0pID4gLTEgKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnNlbGVjdGVkPSBcInNlbGVjdGVkXCI7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdH0sMCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9LGFqYXhzbyB8fCB7fSkpO1xyXG5cdFx0XHRcdH0gZWxzZSBpZihvcHRpb25zLnZhbHVlKSB7XHJcblx0XHRcdFx0XHR2YXIgaTtcclxuXHRcdFx0XHRcdGlmKG9wdGlvbnMuc2l6ZSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdG9wdGlvbnMuc2l6ZSA9IG1zbCA/IDMgOiAxO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYobXNsKSB7XHJcblx0XHRcdFx0XHRcdG92bSA9IHZsLnNwbGl0KFwiLFwiKTtcclxuXHRcdFx0XHRcdFx0b3ZtID0gJC5tYXAob3ZtLGZ1bmN0aW9uKG4pe3JldHVybiAkLnRyaW0obik7fSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZih0eXBlb2Ygb3B0aW9ucy52YWx1ZSA9PT0gJ2Z1bmN0aW9uJykgeyBvcHRpb25zLnZhbHVlID0gb3B0aW9ucy52YWx1ZSgpOyB9XHJcblx0XHRcdFx0XHR2YXIgc28sc3YsIG92LFxyXG5cdFx0XHRcdFx0c2VwID0gb3B0aW9ucy5zZXBhcmF0b3IgPT09IHVuZGVmaW5lZCA/IFwiOlwiIDogb3B0aW9ucy5zZXBhcmF0b3IsXHJcblx0XHRcdFx0XHRkZWxpbSA9IG9wdGlvbnMuZGVsaW1pdGVyID09PSB1bmRlZmluZWQgPyBcIjtcIiA6IG9wdGlvbnMuZGVsaW1pdGVyO1xyXG5cdFx0XHRcdFx0aWYodHlwZW9mIG9wdGlvbnMudmFsdWUgPT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0XHRcdHNvID0gb3B0aW9ucy52YWx1ZS5zcGxpdChkZWxpbSk7XHJcblx0XHRcdFx0XHRcdGZvcihpPTA7IGk8c28ubGVuZ3RoO2krKyl7XHJcblx0XHRcdFx0XHRcdFx0c3YgPSBzb1tpXS5zcGxpdChzZXApO1xyXG5cdFx0XHRcdFx0XHRcdGlmKHN2Lmxlbmd0aCA+IDIgKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRzdlsxXSA9ICQubWFwKHN2LGZ1bmN0aW9uKG4saWkpe2lmKGlpPjApIHsgcmV0dXJuIG47fSB9KS5qb2luKHNlcCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdG92ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcclxuXHRcdFx0XHRcdFx0XHRvdi5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsXCJvcHRpb25cIik7XHJcblx0XHRcdFx0XHRcdFx0b3YudmFsdWUgPSBzdlswXTsgb3YuaW5uZXJIVE1MID0gc3ZbMV07XHJcblx0XHRcdFx0XHRcdFx0ZWxlbS5hcHBlbmRDaGlsZChvdik7XHJcblx0XHRcdFx0XHRcdFx0aWYgKCFtc2wgJiYgICgkLnRyaW0oc3ZbMF0pID09PSAkLnRyaW0odmwpIHx8ICQudHJpbShzdlsxXSkgPT09ICQudHJpbSh2bCkpKSB7IG92LnNlbGVjdGVkID1cInNlbGVjdGVkXCI7IH1cclxuXHRcdFx0XHRcdFx0XHRpZiAobXNsICYmICgkLmluQXJyYXkoJC50cmltKHN2WzFdKSwgb3ZtKT4tMSB8fCAkLmluQXJyYXkoJC50cmltKHN2WzBdKSwgb3ZtKT4tMSkpIHtvdi5zZWxlY3RlZCA9XCJzZWxlY3RlZFwiO31cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBlbHNlIGlmICh0eXBlb2Ygb3B0aW9ucy52YWx1ZSA9PT0gJ29iamVjdCcpIHtcclxuXHRcdFx0XHRcdFx0dmFyIG9TdiA9IG9wdGlvbnMudmFsdWUsIGtleTtcclxuXHRcdFx0XHRcdFx0Zm9yIChrZXkgaW4gb1N2KSB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKG9Tdi5oYXNPd25Qcm9wZXJ0eShrZXkgKSApe1xyXG5cdFx0XHRcdFx0XHRcdFx0b3YgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0b3Yuc2V0QXR0cmlidXRlKFwicm9sZVwiLFwib3B0aW9uXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0b3YudmFsdWUgPSBrZXk7IG92LmlubmVySFRNTCA9IG9TdltrZXldO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZWxlbS5hcHBlbmRDaGlsZChvdik7XHJcblx0XHRcdFx0XHRcdFx0XHRpZiAoIW1zbCAmJiAgKCAkLnRyaW0oa2V5KSA9PT0gJC50cmltKHZsKSB8fCAkLnRyaW0ob1N2W2tleV0pID09PSAkLnRyaW0odmwpKSApIHsgb3Yuc2VsZWN0ZWQgPVwic2VsZWN0ZWRcIjsgfVxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKG1zbCAmJiAoJC5pbkFycmF5KCQudHJpbShvU3Zba2V5XSksb3ZtKT4tMSB8fCAkLmluQXJyYXkoJC50cmltKGtleSksb3ZtKT4tMSkpIHsgb3Yuc2VsZWN0ZWQgPVwic2VsZWN0ZWRcIjsgfVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0c2V0QXR0cmlidXRlcyhlbGVtLCBvcHRpb25zLCBbJ3ZhbHVlJ10pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgXCJ0ZXh0XCIgOlxyXG5cdFx0XHRjYXNlIFwicGFzc3dvcmRcIiA6XHJcblx0XHRcdGNhc2UgXCJidXR0b25cIiA6XHJcblx0XHRcdFx0dmFyIHJvbGU7XHJcblx0XHRcdFx0aWYoZWx0eXBlPT09XCJidXR0b25cIikgeyByb2xlID0gXCJidXR0b25cIjsgfVxyXG5cdFx0XHRcdGVsc2UgeyByb2xlID0gXCJ0ZXh0Ym94XCI7IH1cclxuXHRcdFx0XHRlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG5cdFx0XHRcdGVsZW0udHlwZSA9IGVsdHlwZTtcclxuXHRcdFx0XHRlbGVtLnZhbHVlID0gdmw7XHJcblx0XHRcdFx0c2V0QXR0cmlidXRlcyhlbGVtLCBvcHRpb25zKTtcclxuXHRcdFx0XHRpZihlbHR5cGUgIT09IFwiYnV0dG9uXCIpe1xyXG5cdFx0XHRcdFx0aWYoYXV0b3dpZHRoKSB7XHJcblx0XHRcdFx0XHRcdGlmKCFvcHRpb25zLnNpemUpIHsgJChlbGVtKS5jc3Moe3dpZHRoOlwiOTglXCJ9KTsgfVxyXG5cdFx0XHRcdFx0fSBlbHNlIGlmICghb3B0aW9ucy5zaXplKSB7IG9wdGlvbnMuc2l6ZSA9IDIwOyB9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCQoZWxlbSkuYXR0cihcInJvbGVcIixyb2xlKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgXCJpbWFnZVwiIDpcclxuXHRcdFx0Y2FzZSBcImZpbGVcIiA6XHJcblx0XHRcdFx0ZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuXHRcdFx0XHRlbGVtLnR5cGUgPSBlbHR5cGU7XHJcblx0XHRcdFx0c2V0QXR0cmlidXRlcyhlbGVtLCBvcHRpb25zKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSBcImN1c3RvbVwiIDpcclxuXHRcdFx0XHRlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XHJcblx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbihvcHRpb25zLmN1c3RvbV9lbGVtZW50KSkge1xyXG5cdFx0XHRcdFx0XHR2YXIgY2VsbSA9IG9wdGlvbnMuY3VzdG9tX2VsZW1lbnQuY2FsbCgkdCx2bCxvcHRpb25zKTtcclxuXHRcdFx0XHRcdFx0aWYoY2VsbSkge1xyXG5cdFx0XHRcdFx0XHRcdGNlbG0gPSAkKGNlbG0pLmFkZENsYXNzKFwiY3VzdG9tZWxlbWVudFwiKS5hdHRyKHtpZDpvcHRpb25zLmlkLG5hbWU6b3B0aW9ucy5uYW1lfSk7XHJcblx0XHRcdFx0XHRcdFx0JChlbGVtKS5lbXB0eSgpLmFwcGVuZChjZWxtKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHR0aHJvdyBcImUyXCI7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHRocm93IFwiZTFcIjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdFx0XHRpZiAoZT09PVwiZTFcIikgeyAkLmpncmlkLmluZm9fZGlhbG9nKCQuamdyaWQuZXJyb3JzLmVycmNhcCxcImZ1bmN0aW9uICdjdXN0b21fZWxlbWVudCcgXCIrJC5qZ3JpZC5lZGl0Lm1zZy5ub2RlZmluZWQsICQuamdyaWQuZWRpdC5iQ2xvc2UpO31cclxuXHRcdFx0XHRcdGlmIChlPT09XCJlMlwiKSB7ICQuamdyaWQuaW5mb19kaWFsb2coJC5qZ3JpZC5lcnJvcnMuZXJyY2FwLFwiZnVuY3Rpb24gJ2N1c3RvbV9lbGVtZW50JyBcIiskLmpncmlkLmVkaXQubXNnLm5vdmFsdWUsJC5qZ3JpZC5lZGl0LmJDbG9zZSk7fVxyXG5cdFx0XHRcdFx0ZWxzZSB7ICQuamdyaWQuaW5mb19kaWFsb2coJC5qZ3JpZC5lcnJvcnMuZXJyY2FwLHR5cGVvZiBlPT09XCJzdHJpbmdcIj9lOmUubWVzc2FnZSwkLmpncmlkLmVkaXQuYkNsb3NlKTsgfVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0YnJlYWs7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gZWxlbTtcclxuXHR9LFxyXG4vLyBEYXRlIFZhbGlkYXRpb24gSmF2YXNjcmlwdFxyXG5cdGNoZWNrRGF0ZSA6IGZ1bmN0aW9uIChmb3JtYXQsIGRhdGUpIHtcclxuXHRcdHZhciBkYXlzSW5GZWJydWFyeSA9IGZ1bmN0aW9uKHllYXIpe1xyXG5cdFx0Ly8gRmVicnVhcnkgaGFzIDI5IGRheXMgaW4gYW55IHllYXIgZXZlbmx5IGRpdmlzaWJsZSBieSBmb3VyLFxyXG5cdFx0Ly8gRVhDRVBUIGZvciBjZW50dXJpYWwgeWVhcnMgd2hpY2ggYXJlIG5vdCBhbHNvIGRpdmlzaWJsZSBieSA0MDAuXHJcblx0XHRcdHJldHVybiAoKCh5ZWFyICUgNCA9PT0gMCkgJiYgKCB5ZWFyICUgMTAwICE9PSAwIHx8ICh5ZWFyICUgNDAwID09PSAwKSkpID8gMjkgOiAyOCApO1xyXG5cdFx0fSxcclxuXHRcdHRzcCA9IHt9LCBzZXA7XHJcblx0XHRmb3JtYXQgPSBmb3JtYXQudG9Mb3dlckNhc2UoKTtcclxuXHRcdC8vd2Ugc2VhcmNoIGZvciAvLC0sLiBmb3IgdGhlIGRhdGUgc2VwYXJhdG9yXHJcblx0XHRpZihmb3JtYXQuaW5kZXhPZihcIi9cIikgIT09IC0xKSB7XHJcblx0XHRcdHNlcCA9IFwiL1wiO1xyXG5cdFx0fSBlbHNlIGlmKGZvcm1hdC5pbmRleE9mKFwiLVwiKSAhPT0gLTEpIHtcclxuXHRcdFx0c2VwID0gXCItXCI7XHJcblx0XHR9IGVsc2UgaWYoZm9ybWF0LmluZGV4T2YoXCIuXCIpICE9PSAtMSkge1xyXG5cdFx0XHRzZXAgPSBcIi5cIjtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHNlcCA9IFwiL1wiO1xyXG5cdFx0fVxyXG5cdFx0Zm9ybWF0ID0gZm9ybWF0LnNwbGl0KHNlcCk7XHJcblx0XHRkYXRlID0gZGF0ZS5zcGxpdChzZXApO1xyXG5cdFx0aWYgKGRhdGUubGVuZ3RoICE9PSAzKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cdFx0dmFyIGo9LTEseWxuLCBkbG49LTEsIG1sbj0tMSwgaTtcclxuXHRcdGZvcihpPTA7aTxmb3JtYXQubGVuZ3RoO2krKyl7XHJcblx0XHRcdHZhciBkdiA9ICBpc05hTihkYXRlW2ldKSA/IDAgOiBwYXJzZUludChkYXRlW2ldLDEwKTtcclxuXHRcdFx0dHNwW2Zvcm1hdFtpXV0gPSBkdjtcclxuXHRcdFx0eWxuID0gZm9ybWF0W2ldO1xyXG5cdFx0XHRpZih5bG4uaW5kZXhPZihcInlcIikgIT09IC0xKSB7IGo9aTsgfVxyXG5cdFx0XHRpZih5bG4uaW5kZXhPZihcIm1cIikgIT09IC0xKSB7IG1sbj1pOyB9XHJcblx0XHRcdGlmKHlsbi5pbmRleE9mKFwiZFwiKSAhPT0gLTEpIHsgZGxuPWk7IH1cclxuXHRcdH1cclxuXHRcdGlmIChmb3JtYXRbal0gPT09IFwieVwiIHx8IGZvcm1hdFtqXSA9PT0gXCJ5eXl5XCIpIHtcclxuXHRcdFx0eWxuPTQ7XHJcblx0XHR9IGVsc2UgaWYoZm9ybWF0W2pdID09PVwieXlcIil7XHJcblx0XHRcdHlsbiA9IDI7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR5bG4gPSAtMTtcclxuXHRcdH1cclxuXHRcdHZhciBkYXlzSW5Nb250aCA9IFswLDMxLDI5LDMxLDMwLDMxLDMwLDMxLDMxLDMwLDMxLDMwLDMxXSxcclxuXHRcdHN0ckRhdGU7XHJcblx0XHRpZiAoaiA9PT0gLTEpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0XHRzdHJEYXRlID0gdHNwW2Zvcm1hdFtqXV0udG9TdHJpbmcoKTtcclxuXHRcdFx0aWYoeWxuID09PSAyICYmIHN0ckRhdGUubGVuZ3RoID09PSAxKSB7eWxuID0gMTt9XHJcblx0XHRcdGlmIChzdHJEYXRlLmxlbmd0aCAhPT0geWxuIHx8ICh0c3BbZm9ybWF0W2pdXT09PTAgJiYgZGF0ZVtqXSE9PVwiMDBcIikpe1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0aWYobWxuID09PSAtMSkge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblx0XHRcdHN0ckRhdGUgPSB0c3BbZm9ybWF0W21sbl1dLnRvU3RyaW5nKCk7XHJcblx0XHRcdGlmIChzdHJEYXRlLmxlbmd0aDwxIHx8IHRzcFtmb3JtYXRbbWxuXV08MSB8fCB0c3BbZm9ybWF0W21sbl1dPjEyKXtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdGlmKGRsbiA9PT0gLTEpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0XHRzdHJEYXRlID0gdHNwW2Zvcm1hdFtkbG5dXS50b1N0cmluZygpO1xyXG5cdFx0XHRpZiAoc3RyRGF0ZS5sZW5ndGg8MSB8fCB0c3BbZm9ybWF0W2Rsbl1dPDEgfHwgdHNwW2Zvcm1hdFtkbG5dXT4zMSB8fCAodHNwW2Zvcm1hdFttbG5dXT09PTIgJiYgdHNwW2Zvcm1hdFtkbG5dXT5kYXlzSW5GZWJydWFyeSh0c3BbZm9ybWF0W2pdXSkpIHx8IHRzcFtmb3JtYXRbZGxuXV0gPiBkYXlzSW5Nb250aFt0c3BbZm9ybWF0W21sbl1dXSl7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHRyZXR1cm4gdHJ1ZTtcclxuXHR9LFxyXG5cdGlzRW1wdHkgOiBmdW5jdGlvbih2YWwpXHJcblx0e1xyXG5cdFx0aWYgKHZhbC5tYXRjaCgvXlxccyskLykgfHwgdmFsID09PSBcIlwiKVx0e1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH0sXHJcblx0Y2hlY2tUaW1lIDogZnVuY3Rpb24odGltZSl7XHJcblx0Ly8gY2hlY2tzIG9ubHkgaGg6c3MgKGFuZCBvcHRpb25hbCBhbS9wbSlcclxuXHRcdHZhciByZSA9IC9eKFxcZHsxLDJ9KTooXFxkezJ9KShbYXBBUF1bTW1dKT8kLyxyZWdzO1xyXG5cdFx0aWYoISQuamdyaWQuaXNFbXB0eSh0aW1lKSlcclxuXHRcdHtcclxuXHRcdFx0cmVncyA9IHRpbWUubWF0Y2gocmUpO1xyXG5cdFx0XHRpZihyZWdzKSB7XHJcblx0XHRcdFx0aWYocmVnc1szXSkge1xyXG5cdFx0XHRcdFx0aWYocmVnc1sxXSA8IDEgfHwgcmVnc1sxXSA+IDEyKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRpZihyZWdzWzFdID4gMjMpIHsgcmV0dXJuIGZhbHNlOyB9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKHJlZ3NbMl0gPiA1OSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiB0cnVlO1xyXG5cdH0sXHJcblx0Y2hlY2tWYWx1ZXMgOiBmdW5jdGlvbih2YWwsIHZhbHJlZiwgY3VzdG9tb2JqZWN0LCBuYW0pIHtcclxuXHRcdHZhciBlZHRydWwsaSwgbm0sIGRmdCwgbGVuLCBnID0gdGhpcywgY20gPSBnLnAuY29sTW9kZWw7XHJcblx0XHRpZihjdXN0b21vYmplY3QgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRpZih0eXBlb2YgdmFscmVmPT09J3N0cmluZycpe1xyXG5cdFx0XHRcdGZvciggaSA9MCwgbGVuPWNtLmxlbmd0aDtpPGxlbjsgaSsrKXtcclxuXHRcdFx0XHRcdGlmKGNtW2ldLm5hbWU9PT12YWxyZWYpIHtcclxuXHRcdFx0XHRcdFx0ZWR0cnVsID0gY21baV0uZWRpdHJ1bGVzO1xyXG5cdFx0XHRcdFx0XHR2YWxyZWYgPSBpO1xyXG5cdFx0XHRcdFx0XHRpZihjbVtpXS5mb3Jtb3B0aW9ucyAhPSBudWxsKSB7IG5tID0gY21baV0uZm9ybW9wdGlvbnMubGFiZWw7IH1cclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2UgaWYodmFscmVmID49MCkge1xyXG5cdFx0XHRcdGVkdHJ1bCA9IGNtW3ZhbHJlZl0uZWRpdHJ1bGVzO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRlZHRydWwgPSBjdXN0b21vYmplY3Q7XHJcblx0XHRcdG5tID0gbmFtPT09dW5kZWZpbmVkID8gXCJfXCIgOiBuYW07XHJcblx0XHR9XHJcblx0XHRpZihlZHRydWwpIHtcclxuXHRcdFx0aWYoIW5tKSB7IG5tID0gZy5wLmNvbE5hbWVzICE9IG51bGwgPyBnLnAuY29sTmFtZXNbdmFscmVmXSA6IGNtW3ZhbHJlZl0ubGFiZWw7IH1cclxuXHRcdFx0aWYoZWR0cnVsLnJlcXVpcmVkID09PSB0cnVlKSB7XHJcblx0XHRcdFx0aWYoICQuamdyaWQuaXNFbXB0eSh2YWwpICkgIHsgcmV0dXJuIFtmYWxzZSxubStcIjogXCIrJC5qZ3JpZC5lZGl0Lm1zZy5yZXF1aXJlZCxcIlwiXTsgfVxyXG5cdFx0XHR9XHJcblx0XHRcdC8vIGZvcmNlIHJlcXVpcmVkXHJcblx0XHRcdHZhciBycWZpZWxkID0gZWR0cnVsLnJlcXVpcmVkID09PSBmYWxzZSA/IGZhbHNlIDogdHJ1ZTtcclxuXHRcdFx0aWYoZWR0cnVsLm51bWJlciA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdGlmKCAhKHJxZmllbGQgPT09IGZhbHNlICYmICQuamdyaWQuaXNFbXB0eSh2YWwpKSApIHtcclxuXHRcdFx0XHRcdGlmKGlzTmFOKHZhbCkpIHsgcmV0dXJuIFtmYWxzZSxubStcIjogXCIrJC5qZ3JpZC5lZGl0Lm1zZy5udW1iZXIsXCJcIl07IH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoZWR0cnVsLm1pblZhbHVlICE9PSB1bmRlZmluZWQgJiYgIWlzTmFOKGVkdHJ1bC5taW5WYWx1ZSkpIHtcclxuXHRcdFx0XHRpZiAocGFyc2VGbG9hdCh2YWwpIDwgcGFyc2VGbG9hdChlZHRydWwubWluVmFsdWUpICkgeyByZXR1cm4gW2ZhbHNlLG5tK1wiOiBcIiskLmpncmlkLmVkaXQubXNnLm1pblZhbHVlK1wiIFwiK2VkdHJ1bC5taW5WYWx1ZSxcIlwiXTt9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoZWR0cnVsLm1heFZhbHVlICE9PSB1bmRlZmluZWQgJiYgIWlzTmFOKGVkdHJ1bC5tYXhWYWx1ZSkpIHtcclxuXHRcdFx0XHRpZiAocGFyc2VGbG9hdCh2YWwpID4gcGFyc2VGbG9hdChlZHRydWwubWF4VmFsdWUpICkgeyByZXR1cm4gW2ZhbHNlLG5tK1wiOiBcIiskLmpncmlkLmVkaXQubXNnLm1heFZhbHVlK1wiIFwiK2VkdHJ1bC5tYXhWYWx1ZSxcIlwiXTt9XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIGZpbHRlcjtcclxuXHRcdFx0aWYoZWR0cnVsLmVtYWlsID09PSB0cnVlKSB7XHJcblx0XHRcdFx0aWYoICEocnFmaWVsZCA9PT0gZmFsc2UgJiYgJC5qZ3JpZC5pc0VtcHR5KHZhbCkpICkge1xyXG5cdFx0XHRcdC8vIHRha2VuIGZyb20gJCBWYWxpZGF0ZSBwbHVnaW5cclxuXHRcdFx0XHRcdGZpbHRlciA9IC9eKCgoW2Etel18XFxkfFshI1xcJCUmJ1xcKlxcK1xcLVxcLz1cXD9cXF5fYHtcXHx9fl18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKyhcXC4oW2Etel18XFxkfFshI1xcJCUmJ1xcKlxcK1xcLVxcLz1cXD9cXF5fYHtcXHx9fl18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKykqKXwoKFxceDIyKSgoKChcXHgyMHxcXHgwOSkqKFxceDBkXFx4MGEpKT8oXFx4MjB8XFx4MDkpKyk/KChbXFx4MDEtXFx4MDhcXHgwYlxceDBjXFx4MGUtXFx4MWZcXHg3Zl18XFx4MjF8W1xceDIzLVxceDViXXxbXFx4NWQtXFx4N2VdfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKXwoXFxcXChbXFx4MDEtXFx4MDlcXHgwYlxceDBjXFx4MGQtXFx4N2ZdfFtcXHUwMEEwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdKSkpKSooKChcXHgyMHxcXHgwOSkqKFxceDBkXFx4MGEpKT8oXFx4MjB8XFx4MDkpKyk/KFxceDIyKSkpQCgoKFthLXpdfFxcZHxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSl8KChbYS16XXxcXGR8W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKFthLXpdfFxcZHwtfFxcLnxffH58W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKihbYS16XXxcXGR8W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKSlcXC4pKygoW2Etel18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pfCgoW2Etel18W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKFthLXpdfFxcZHwtfFxcLnxffH58W1xcdTAwQTAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0pKihbYS16XXxbXFx1MDBBMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSkpKVxcLj8kL2k7XHJcblx0XHRcdFx0XHRpZighZmlsdGVyLnRlc3QodmFsKSkge3JldHVybiBbZmFsc2Usbm0rXCI6IFwiKyQuamdyaWQuZWRpdC5tc2cuZW1haWwsXCJcIl07fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRpZihlZHRydWwuaW50ZWdlciA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdGlmKCAhKHJxZmllbGQgPT09IGZhbHNlICYmICQuamdyaWQuaXNFbXB0eSh2YWwpKSApIHtcclxuXHRcdFx0XHRcdGlmKGlzTmFOKHZhbCkpIHsgcmV0dXJuIFtmYWxzZSxubStcIjogXCIrJC5qZ3JpZC5lZGl0Lm1zZy5pbnRlZ2VyLFwiXCJdOyB9XHJcblx0XHRcdFx0XHRpZiAoKHZhbCAlIDEgIT09IDApIHx8ICh2YWwuaW5kZXhPZignLicpICE9PSAtMSkpIHsgcmV0dXJuIFtmYWxzZSxubStcIjogXCIrJC5qZ3JpZC5lZGl0Lm1zZy5pbnRlZ2VyLFwiXCJdO31cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoZWR0cnVsLmRhdGUgPT09IHRydWUpIHtcclxuXHRcdFx0XHRpZiggIShycWZpZWxkID09PSBmYWxzZSAmJiAkLmpncmlkLmlzRW1wdHkodmFsKSkgKSB7XHJcblx0XHRcdFx0XHRpZihjbVt2YWxyZWZdLmZvcm1hdG9wdGlvbnMgJiYgY21bdmFscmVmXS5mb3JtYXRvcHRpb25zLm5ld2Zvcm1hdCkge1xyXG5cdFx0XHRcdFx0XHRkZnQgPSBjbVt2YWxyZWZdLmZvcm1hdG9wdGlvbnMubmV3Zm9ybWF0O1xyXG5cdFx0XHRcdFx0XHRpZiggJC5qZ3JpZC5mb3JtYXR0ZXIuZGF0ZS5tYXNrcy5oYXNPd25Qcm9wZXJ0eShkZnQpICkge1xyXG5cdFx0XHRcdFx0XHRcdGRmdCA9ICQuamdyaWQuZm9ybWF0dGVyLmRhdGUubWFza3NbZGZ0XTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0ZGZ0ID0gY21bdmFscmVmXS5kYXRlZm10IHx8IFwiWS1tLWRcIjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKCEkLmpncmlkLmNoZWNrRGF0ZSAoZGZ0LCB2YWwpKSB7IHJldHVybiBbZmFsc2Usbm0rXCI6IFwiKyQuamdyaWQuZWRpdC5tc2cuZGF0ZStcIiAtIFwiK2RmdCxcIlwiXTsgfVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRpZihlZHRydWwudGltZSA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdGlmKCAhKHJxZmllbGQgPT09IGZhbHNlICYmICQuamdyaWQuaXNFbXB0eSh2YWwpKSApIHtcclxuXHRcdFx0XHRcdGlmKCEkLmpncmlkLmNoZWNrVGltZSAodmFsKSkgeyByZXR1cm4gW2ZhbHNlLG5tK1wiOiBcIiskLmpncmlkLmVkaXQubXNnLmRhdGUrXCIgLSBoaDptbSAoYW0vcG0pXCIsXCJcIl07IH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoZWR0cnVsLnVybCA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdGlmKCAhKHJxZmllbGQgPT09IGZhbHNlICYmICQuamdyaWQuaXNFbXB0eSh2YWwpKSApIHtcclxuXHRcdFx0XHRcdGZpbHRlciA9IC9eKCgoaHR0cHM/KXwoZnRwKSk6XFwvXFwvKFtcXC1cXHddK1xcLikrXFx3ezIsM30oXFwvWyVcXC1cXHddKyhcXC5cXHd7Mix9KT8pKigoW1xcd1xcLVxcLlxcP1xcXFxcXC8rQCYjO2B+PSUhXSopKFxcLlxcd3syLH0pPykqXFwvPykvaTtcclxuXHRcdFx0XHRcdGlmKCFmaWx0ZXIudGVzdCh2YWwpKSB7cmV0dXJuIFtmYWxzZSxubStcIjogXCIrJC5qZ3JpZC5lZGl0Lm1zZy51cmwsXCJcIl07fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRpZihlZHRydWwuY3VzdG9tID09PSB0cnVlKSB7XHJcblx0XHRcdFx0aWYoICEocnFmaWVsZCA9PT0gZmFsc2UgJiYgJC5qZ3JpZC5pc0VtcHR5KHZhbCkpICkge1xyXG5cdFx0XHRcdFx0aWYoJC5pc0Z1bmN0aW9uKGVkdHJ1bC5jdXN0b21fZnVuYykpIHtcclxuXHRcdFx0XHRcdFx0dmFyIHJldCA9IGVkdHJ1bC5jdXN0b21fZnVuYy5jYWxsKGcsdmFsLG5tLHZhbHJlZik7XHJcblx0XHRcdFx0XHRcdHJldHVybiAkLmlzQXJyYXkocmV0KSA/IHJldCA6IFtmYWxzZSwkLmpncmlkLmVkaXQubXNnLmN1c3RvbWFycmF5LFwiXCJdO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0cmV0dXJuIFtmYWxzZSwkLmpncmlkLmVkaXQubXNnLmN1c3RvbWZjaGVjayxcIlwiXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBbdHJ1ZSxcIlwiLFwiXCJdO1xyXG5cdH1cclxufSk7XHJcbn0pKGpRdWVyeSk7XHJcbi8qXHJcbiAqIGpxRmlsdGVyICBqUXVlcnkganFHcmlkIGZpbHRlciBhZGRvbi5cclxuICogQ29weXJpZ2h0IChjKSAyMDExLCBUb255IFRvbW92LCB0b255QHRyaXJhbmQuY29tXHJcbiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBhbmQgR1BMIGxpY2Vuc2VzXHJcbiAqIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXHJcbiAqIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMi4wLmh0bWxcclxuICpcclxuICogVGhlIHdvcmsgaXMgaW5zcGlyZWQgZnJvbSB0aGlzIFN0ZWZhbiBQaXJ2dVxyXG4gKiBodHRwOi8vd3d3LmNvZGVwcm9qZWN0LmNvbS9LQi9zY3JpcHRpbmcvanNvbi1maWx0ZXJpbmcuYXNweFxyXG4gKlxyXG4gKiBUaGUgZmlsdGVyIHVzZXMgSlNPTiBlbnRpdGllcyB0byBob2xkIGZpbHRlciBydWxlcyBhbmQgZ3JvdXBzLiBIZXJlIGlzIGFuIGV4YW1wbGUgb2YgYSBmaWx0ZXI6XHJcblxyXG57IFwiZ3JvdXBPcFwiOiBcIkFORFwiLFxyXG4gICAgICBcImdyb3Vwc1wiIDogW1xyXG4gICAgICAgIHsgXCJncm91cE9wXCI6IFwiT1JcIixcclxuICAgICAgICAgICAgXCJydWxlc1wiOiBbXHJcbiAgICAgICAgICAgICAgICB7IFwiZmllbGRcIjogXCJuYW1lXCIsIFwib3BcIjogXCJlcVwiLCBcImRhdGFcIjogXCJFbmdsYW5kXCIgfSxcclxuICAgICAgICAgICAgICAgIHsgXCJmaWVsZFwiOiBcImlkXCIsIFwib3BcIjogXCJsZVwiLCBcImRhdGFcIjogXCI1XCJ9XHJcbiAgICAgICAgICAgICBdXHJcbiAgICAgICAgfVxyXG4gICAgICBdLFxyXG4gICAgICBcInJ1bGVzXCI6IFtcclxuICAgICAgICB7IFwiZmllbGRcIjogXCJuYW1lXCIsIFwib3BcIjogXCJlcVwiLCBcImRhdGFcIjogXCJSb21hbmlhXCIgfSxcclxuICAgICAgICB7IFwiZmllbGRcIjogXCJpZFwiLCBcIm9wXCI6IFwibGVcIiwgXCJkYXRhXCI6IFwiMVwifVxyXG4gICAgICBdXHJcbn1cclxuKi9cclxuLypqc2hpbnQgZXFlcWVxOmZhbHNlLCBlcW51bGw6dHJ1ZSwgZGV2ZWw6dHJ1ZSAqL1xyXG4vKmdsb2JhbCBqUXVlcnkgKi9cclxuXHJcbihmdW5jdGlvbiAoJCkge1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbiQuZm4uanFGaWx0ZXIgPSBmdW5jdGlvbiggYXJnICkge1xyXG5cdGlmICh0eXBlb2YgYXJnID09PSAnc3RyaW5nJykge1xyXG5cclxuXHRcdHZhciBmbiA9ICQuZm4uanFGaWx0ZXJbYXJnXTtcclxuXHRcdGlmICghZm4pIHtcclxuXHRcdFx0dGhyb3cgKFwianFGaWx0ZXIgLSBObyBzdWNoIG1ldGhvZDogXCIgKyBhcmcpO1xyXG5cdFx0fVxyXG5cdFx0dmFyIGFyZ3MgPSAkLm1ha2VBcnJheShhcmd1bWVudHMpLnNsaWNlKDEpO1xyXG5cdFx0cmV0dXJuIGZuLmFwcGx5KHRoaXMsYXJncyk7XHJcblx0fVxyXG5cclxuXHR2YXIgcCA9ICQuZXh0ZW5kKHRydWUse1xyXG5cdFx0ZmlsdGVyOiBudWxsLFxyXG5cdFx0Y29sdW1uczogW10sXHJcblx0XHRvbkNoYW5nZSA6IG51bGwsXHJcblx0XHRhZnRlclJlZHJhdyA6IG51bGwsXHJcblx0XHRjaGVja1ZhbHVlcyA6IG51bGwsXHJcblx0XHRlcnJvcjogZmFsc2UsXHJcblx0XHRlcnJtc2cgOiBcIlwiLFxyXG5cdFx0ZXJyb3JjaGVjayA6IHRydWUsXHJcblx0XHRzaG93UXVlcnkgOiB0cnVlLFxyXG5cdFx0c29wdCA6IG51bGwsXHJcblx0XHRvcHMgOiBbXSxcclxuXHRcdG9wZXJhbmRzIDogbnVsbCxcclxuXHRcdG51bW9wdHMgOiBbJ2VxJywnbmUnLCAnbHQnLCAnbGUnLCAnZ3QnLCAnZ2UnLCAnbnUnLCAnbm4nLCAnaW4nLCAnbmknXSxcclxuXHRcdHN0cm9wdHMgOiBbJ2VxJywgJ25lJywgJ2J3JywgJ2JuJywgJ2V3JywgJ2VuJywgJ2NuJywgJ25jJywgJ251JywgJ25uJywgJ2luJywgJ25pJ10sXHJcblx0XHRzdHJhcnIgOiBbJ3RleHQnLCAnc3RyaW5nJywgJ2Jsb2InXSxcclxuXHRcdGdyb3VwT3BzIDogW3sgb3A6IFwiQU5EXCIsIHRleHQ6IFwiQU5EXCIgfSxcdHsgb3A6IFwiT1JcIiwgIHRleHQ6IFwiT1JcIiB9XSxcclxuXHRcdGdyb3VwQnV0dG9uIDogdHJ1ZSxcclxuXHRcdHJ1bGVCdXR0b25zIDogdHJ1ZSxcclxuXHRcdGRpcmVjdGlvbiA6IFwibHRyXCJcclxuXHR9LCAkLmpncmlkLmZpbHRlciwgYXJnIHx8IHt9KTtcclxuXHRyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHtcclxuXHRcdGlmICh0aGlzLmZpbHRlcikge3JldHVybjt9XHJcblx0XHR0aGlzLnAgPSBwO1xyXG5cdFx0Ly8gc2V0dXAgZmlsdGVyIGluIGNhc2UgaWYgdGhleSBpcyBub3QgZGVmaW5lZFxyXG5cdFx0aWYgKHRoaXMucC5maWx0ZXIgPT09IG51bGwgfHwgdGhpcy5wLmZpbHRlciA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdHRoaXMucC5maWx0ZXIgPSB7XHJcblx0XHRcdFx0Z3JvdXBPcDogdGhpcy5wLmdyb3VwT3BzWzBdLm9wLFxyXG5cdFx0XHRcdHJ1bGVzOiBbXSxcclxuXHRcdFx0XHRncm91cHM6IFtdXHJcblx0XHRcdH07XHJcblx0XHR9XHJcblx0XHR2YXIgaSwgbGVuID0gdGhpcy5wLmNvbHVtbnMubGVuZ3RoLCBjbCxcclxuXHRcdGlzSUUgPSAvbXNpZS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkgJiYgIXdpbmRvdy5vcGVyYTtcclxuXHJcblx0XHQvLyB0cmFuc2xhdGluZyB0aGUgb3B0aW9uc1xyXG5cdFx0dGhpcy5wLmluaXRGaWx0ZXIgPSAkLmV4dGVuZCh0cnVlLHt9LHRoaXMucC5maWx0ZXIpO1xyXG5cclxuXHRcdC8vIHNldCBkZWZhdWx0IHZhbHVlcyBmb3IgdGhlIGNvbHVtbnMgaWYgdGhleSBhcmUgbm90IHNldFxyXG5cdFx0aWYoICFsZW4gKSB7cmV0dXJuO31cclxuXHRcdGZvcihpPTA7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHRjbCA9IHRoaXMucC5jb2x1bW5zW2ldO1xyXG5cdFx0XHRpZiggY2wuc3R5cGUgKSB7XHJcblx0XHRcdFx0Ly8gZ3JpZCBjb21wYXRpYmlsaXR5XHJcblx0XHRcdFx0Y2wuaW5wdXR0eXBlID0gY2wuc3R5cGU7XHJcblx0XHRcdH0gZWxzZSBpZighY2wuaW5wdXR0eXBlKSB7XHJcblx0XHRcdFx0Y2wuaW5wdXR0eXBlID0gJ3RleHQnO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKCBjbC5zb3J0dHlwZSApIHtcclxuXHRcdFx0XHQvLyBncmlkIGNvbXBhdGliaWxpdHlcclxuXHRcdFx0XHRjbC5zZWFyY2h0eXBlID0gY2wuc29ydHR5cGU7XHJcblx0XHRcdH0gZWxzZSBpZiAoIWNsLnNlYXJjaHR5cGUpIHtcclxuXHRcdFx0XHRjbC5zZWFyY2h0eXBlID0gJ3N0cmluZyc7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoY2wuaGlkZGVuID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHQvLyBqcUdyaWQgY29tcGF0aWJpbGl0eVxyXG5cdFx0XHRcdGNsLmhpZGRlbiA9IGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKCFjbC5sYWJlbCkge1xyXG5cdFx0XHRcdGNsLmxhYmVsID0gY2wubmFtZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZihjbC5pbmRleCkge1xyXG5cdFx0XHRcdGNsLm5hbWUgPSBjbC5pbmRleDtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZighY2wuaGFzT3duUHJvcGVydHkoJ3NlYXJjaG9wdGlvbnMnKSkge1xyXG5cdFx0XHRcdGNsLnNlYXJjaG9wdGlvbnMgPSB7fTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZighY2wuaGFzT3duUHJvcGVydHkoJ3NlYXJjaHJ1bGVzJykpIHtcclxuXHRcdFx0XHRjbC5zZWFyY2hydWxlcyA9IHt9O1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0fVxyXG5cdFx0aWYodGhpcy5wLnNob3dRdWVyeSkge1xyXG5cdFx0XHQkKHRoaXMpLmFwcGVuZChcIjx0YWJsZSBjbGFzcz0ncXVlcnlyZXN1bHQgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50JyBzdHlsZT0nZGlzcGxheTpibG9jazttYXgtd2lkdGg6NDQwcHg7Ym9yZGVyOjBweCBub25lOycgZGlyPSdcIit0aGlzLnAuZGlyZWN0aW9uK1wiJz48dGJvZHk+PHRyPjx0ZCBjbGFzcz0ncXVlcnknPjwvdGQ+PC90cj48L3Rib2R5PjwvdGFibGU+XCIpO1xyXG5cdFx0fVxyXG5cdFx0dmFyIGdldEdyaWQgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHJldHVybiAkKFwiI1wiICsgJC5qZ3JpZC5qcUlEKHAuaWQpKVswXSB8fCBudWxsO1xyXG5cdFx0fTtcclxuXHRcdC8qXHJcblx0XHQgKlBlcmZvcm0gY2hlY2tpbmcuXHJcblx0XHQgKlxyXG5cdFx0Ki9cclxuXHRcdHZhciBjaGVja0RhdGEgPSBmdW5jdGlvbih2YWwsIGNvbE1vZGVsSXRlbSkge1xyXG5cdFx0XHR2YXIgcmV0ID0gW3RydWUsXCJcIl0sICR0ID0gZ2V0R3JpZCgpO1xyXG5cdFx0XHRpZigkLmlzRnVuY3Rpb24oY29sTW9kZWxJdGVtLnNlYXJjaHJ1bGVzKSkge1xyXG5cdFx0XHRcdHJldCA9IGNvbE1vZGVsSXRlbS5zZWFyY2hydWxlcy5jYWxsKCR0LCB2YWwsIGNvbE1vZGVsSXRlbSk7XHJcblx0XHRcdH0gZWxzZSBpZigkLmpncmlkICYmICQuamdyaWQuY2hlY2tWYWx1ZXMpIHtcclxuXHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0cmV0ID0gJC5qZ3JpZC5jaGVja1ZhbHVlcy5jYWxsKCR0LCB2YWwsIC0xLCBjb2xNb2RlbEl0ZW0uc2VhcmNocnVsZXMsIGNvbE1vZGVsSXRlbS5sYWJlbCk7XHJcblx0XHRcdFx0fSBjYXRjaCAoZSkge31cclxuXHRcdFx0fVxyXG5cdFx0XHRpZihyZXQgJiYgcmV0Lmxlbmd0aCAmJiByZXRbMF0gPT09IGZhbHNlKSB7XHJcblx0XHRcdFx0cC5lcnJvciA9ICFyZXRbMF07XHJcblx0XHRcdFx0cC5lcnJtc2cgPSByZXRbMV07XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHQvKiBtb3ZpbmcgdG8gY29tbW9uXHJcblx0XHRyYW5kSWQgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0cmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSoxMDAwMCkudG9TdHJpbmcoKTtcclxuXHRcdH07XHJcblx0XHQqL1xyXG5cclxuXHRcdHRoaXMub25jaGFuZ2UgPSBmdW5jdGlvbiAoICApe1xyXG5cdFx0XHQvLyBjbGVhciBhbnkgZXJyb3JcclxuXHRcdFx0dGhpcy5wLmVycm9yID0gZmFsc2U7XHJcblx0XHRcdHRoaXMucC5lcnJtc2c9XCJcIjtcclxuXHRcdFx0cmV0dXJuICQuaXNGdW5jdGlvbih0aGlzLnAub25DaGFuZ2UpID8gdGhpcy5wLm9uQ2hhbmdlLmNhbGwoIHRoaXMsIHRoaXMucCApIDogZmFsc2U7XHJcblx0XHR9O1xyXG5cdFx0LypcclxuXHRcdCAqIFJlZHJhdyB0aGUgZmlsdGVyIGV2ZXJ5IHRpbWUgd2hlbiBuZXcgZmllbGQgaXMgYWRkZWQvZGVsZXRlZFxyXG5cdFx0ICogYW5kIGZpZWxkIGlzICBjaGFuZ2VkXHJcblx0XHQgKi9cclxuXHRcdHRoaXMucmVEcmF3ID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdCQoXCJ0YWJsZS5ncm91cDpmaXJzdFwiLHRoaXMpLnJlbW92ZSgpO1xyXG5cdFx0XHR2YXIgdCA9IHRoaXMuY3JlYXRlVGFibGVGb3JHcm91cChwLmZpbHRlciwgbnVsbCk7XHJcblx0XHRcdCQodGhpcykuYXBwZW5kKHQpO1xyXG5cdFx0XHRpZigkLmlzRnVuY3Rpb24odGhpcy5wLmFmdGVyUmVkcmF3KSApIHtcclxuXHRcdFx0XHR0aGlzLnAuYWZ0ZXJSZWRyYXcuY2FsbCh0aGlzLCB0aGlzLnApO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdFx0LypcclxuXHRcdCAqIENyZWF0ZXMgYSBncm91cGluZyBkYXRhIGZvciB0aGUgZmlsdGVyXHJcblx0XHQgKiBAcGFyYW0gZ3JvdXAgLSBvYmplY3RcclxuXHRcdCAqIEBwYXJhbSBwYXJlbnRncm91cCAtIG9iamVjdFxyXG5cdFx0ICovXHJcblx0XHR0aGlzLmNyZWF0ZVRhYmxlRm9yR3JvdXAgPSBmdW5jdGlvbihncm91cCwgcGFyZW50Z3JvdXApIHtcclxuXHRcdFx0dmFyIHRoYXQgPSB0aGlzLCAgaTtcclxuXHRcdFx0Ly8gdGhpcyB0YWJsZSB3aWxsIGhvbGQgYWxsIHRoZSBncm91cCAodGFibGVzKSBhbmQgcnVsZXMgKHJvd3MpXHJcblx0XHRcdHZhciB0YWJsZSA9ICQoXCI8dGFibGUgY2xhc3M9J2dyb3VwIHVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCcgc3R5bGU9J2JvcmRlcjowcHggbm9uZTsnPjx0Ym9keT48L3Rib2R5PjwvdGFibGU+XCIpLFxyXG5cdFx0XHQvLyBjcmVhdGUgZXJyb3IgbWVzc2FnZSByb3dcclxuXHRcdFx0YWxpZ24gPSBcImxlZnRcIjtcclxuXHRcdFx0aWYodGhpcy5wLmRpcmVjdGlvbiA9PT0gXCJydGxcIikge1xyXG5cdFx0XHRcdGFsaWduID0gXCJyaWdodFwiO1xyXG5cdFx0XHRcdHRhYmxlLmF0dHIoXCJkaXJcIixcInJ0bFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZihwYXJlbnRncm91cCA9PT0gbnVsbCkge1xyXG5cdFx0XHRcdHRhYmxlLmFwcGVuZChcIjx0ciBjbGFzcz0nZXJyb3InIHN0eWxlPSdkaXNwbGF5Om5vbmU7Jz48dGggY29sc3Bhbj0nNScgY2xhc3M9J3VpLXN0YXRlLWVycm9yJyBhbGlnbj0nXCIrYWxpZ24rXCInPjwvdGg+PC90cj5cIik7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciB0ciA9ICQoXCI8dHI+PC90cj5cIik7XHJcblx0XHRcdHRhYmxlLmFwcGVuZCh0cik7XHJcblx0XHRcdC8vIHRoaXMgaGVhZGVyIHdpbGwgaG9sZCB0aGUgZ3JvdXAgb3BlcmF0b3IgdHlwZSBhbmQgZ3JvdXAgYWN0aW9uIGJ1dHRvbnMgZm9yXHJcblx0XHRcdC8vIGNyZWF0aW5nIHN1Ymdyb3VwIFwiKyB7fVwiLCBjcmVhdGluZyBydWxlIFwiK1wiIG9yIGRlbGV0aW5nIHRoZSBncm91cCBcIi1cIlxyXG5cdFx0XHR2YXIgdGggPSAkKFwiPHRoIGNvbHNwYW49JzUnIGFsaWduPSdcIithbGlnbitcIic+PC90aD5cIik7XHJcblx0XHRcdHRyLmFwcGVuZCh0aCk7XHJcblxyXG5cdFx0XHRpZih0aGlzLnAucnVsZUJ1dHRvbnMgPT09IHRydWUpIHtcclxuXHRcdFx0Ly8gZHJvcGRvd24gZm9yOiBjaG9vc2luZyBncm91cCBvcGVyYXRvciB0eXBlXHJcblx0XHRcdHZhciBncm91cE9wU2VsZWN0ID0gJChcIjxzZWxlY3QgY2xhc3M9J29wc2VsJz48L3NlbGVjdD5cIik7XHJcblx0XHRcdHRoLmFwcGVuZChncm91cE9wU2VsZWN0KTtcclxuXHRcdFx0Ly8gcG9wdWxhdGUgZHJvcGRvd24gd2l0aCBhbGwgcG9zaWJsZSBncm91cCBvcGVyYXRvcnM6IG9yLCBhbmRcclxuXHRcdFx0dmFyIHN0cj0gXCJcIiwgc2VsZWN0ZWQ7XHJcblx0XHRcdGZvciAoaSA9IDA7IGkgPCBwLmdyb3VwT3BzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0c2VsZWN0ZWQgPSAgZ3JvdXAuZ3JvdXBPcCA9PT0gdGhhdC5wLmdyb3VwT3BzW2ldLm9wID8gXCIgc2VsZWN0ZWQ9J3NlbGVjdGVkJ1wiIDpcIlwiO1xyXG5cdFx0XHRcdHN0ciArPSBcIjxvcHRpb24gdmFsdWU9J1wiK3RoYXQucC5ncm91cE9wc1tpXS5vcCtcIidcIiArIHNlbGVjdGVkK1wiPlwiK3RoYXQucC5ncm91cE9wc1tpXS50ZXh0K1wiPC9vcHRpb24+XCI7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGdyb3VwT3BTZWxlY3RcclxuXHRcdFx0LmFwcGVuZChzdHIpXHJcblx0XHRcdC5iaW5kKCdjaGFuZ2UnLGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGdyb3VwLmdyb3VwT3AgPSAkKGdyb3VwT3BTZWxlY3QpLnZhbCgpO1xyXG5cdFx0XHRcdHRoYXQub25jaGFuZ2UoKTsgLy8gc2lnbmFscyB0aGF0IHRoZSBmaWx0ZXIgaGFzIGNoYW5nZWRcclxuXHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gYnV0dG9uIGZvciBhZGRpbmcgYSBuZXcgc3ViZ3JvdXBcclxuXHRcdFx0dmFyIGlucHV0QWRkU3ViZ3JvdXAgPVwiPHNwYW4+PC9zcGFuPlwiO1xyXG5cdFx0XHRpZih0aGlzLnAuZ3JvdXBCdXR0b24pIHtcclxuXHRcdFx0XHRpbnB1dEFkZFN1Ymdyb3VwID0gJChcIjxpbnB1dCB0eXBlPSdidXR0b24nIHZhbHVlPScrIHt9JyB0aXRsZT0nQWRkIHN1Ymdyb3VwJyBjbGFzcz0nYWRkLWdyb3VwJy8+XCIpO1xyXG5cdFx0XHRcdGlucHV0QWRkU3ViZ3JvdXAuYmluZCgnY2xpY2snLGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0aWYgKGdyb3VwLmdyb3VwcyA9PT0gdW5kZWZpbmVkICkge1xyXG5cdFx0XHRcdFx0XHRncm91cC5ncm91cHMgPSBbXTtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRncm91cC5ncm91cHMucHVzaCh7XHJcblx0XHRcdFx0XHRcdGdyb3VwT3A6IHAuZ3JvdXBPcHNbMF0ub3AsXHJcblx0XHRcdFx0XHRcdHJ1bGVzOiBbXSxcclxuXHRcdFx0XHRcdFx0Z3JvdXBzOiBbXVxyXG5cdFx0XHRcdFx0fSk7IC8vIGFkZGluZyBhIG5ldyBncm91cFxyXG5cclxuXHRcdFx0XHRcdHRoYXQucmVEcmF3KCk7IC8vIHRoZSBodG1sIGhhcyBjaGFuZ2VkLCBmb3JjZSByZURyYXdcclxuXHJcblx0XHRcdFx0XHR0aGF0Lm9uY2hhbmdlKCk7IC8vIHNpZ25hbHMgdGhhdCB0aGUgZmlsdGVyIGhhcyBjaGFuZ2VkXHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0dGguYXBwZW5kKGlucHV0QWRkU3ViZ3JvdXApO1xyXG5cdFx0XHRpZih0aGlzLnAucnVsZUJ1dHRvbnMgPT09IHRydWUpIHtcclxuXHRcdFx0Ly8gYnV0dG9uIGZvciBhZGRpbmcgYSBuZXcgcnVsZVxyXG5cdFx0XHR2YXIgaW5wdXRBZGRSdWxlID0gJChcIjxpbnB1dCB0eXBlPSdidXR0b24nIHZhbHVlPScrJyB0aXRsZT0nQWRkIHJ1bGUnIGNsYXNzPSdhZGQtcnVsZSB1aS1hZGQnLz5cIiksIGNtO1xyXG5cdFx0XHRpbnB1dEFkZFJ1bGUuYmluZCgnY2xpY2snLGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdC8vaWYoIWdyb3VwKSB7IGdyb3VwID0ge307fVxyXG5cdFx0XHRcdGlmIChncm91cC5ydWxlcyA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRncm91cC5ydWxlcyA9IFtdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRmb3IgKGkgPSAwOyBpIDwgdGhhdC5wLmNvbHVtbnMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHQvLyBidXQgc2hvdyBvbmx5IHNlcmNoYWJsZSBhbmQgc2VyY2hoaWRkZW4gPSB0cnVlIGZpZWxkc1xyXG5cdFx0XHRcdFx0dmFyIHNlYXJjaGFibGUgPSAodGhhdC5wLmNvbHVtbnNbaV0uc2VhcmNoID09PSB1bmRlZmluZWQpID8gIHRydWU6IHRoYXQucC5jb2x1bW5zW2ldLnNlYXJjaCxcclxuXHRcdFx0XHRcdGhpZGRlbiA9ICh0aGF0LnAuY29sdW1uc1tpXS5oaWRkZW4gPT09IHRydWUpLFxyXG5cdFx0XHRcdFx0aWdub3JlSGlkaW5nID0gKHRoYXQucC5jb2x1bW5zW2ldLnNlYXJjaG9wdGlvbnMuc2VhcmNoaGlkZGVuID09PSB0cnVlKTtcclxuXHRcdFx0XHRcdGlmICgoaWdub3JlSGlkaW5nICYmIHNlYXJjaGFibGUpIHx8IChzZWFyY2hhYmxlICYmICFoaWRkZW4pKSB7XHJcblx0XHRcdFx0XHRcdGNtID0gdGhhdC5wLmNvbHVtbnNbaV07XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0dmFyIG9wcjtcclxuXHRcdFx0XHRpZiggY20uc2VhcmNob3B0aW9ucy5zb3B0ICkge29wciA9IGNtLnNlYXJjaG9wdGlvbnMuc29wdDt9XHJcblx0XHRcdFx0ZWxzZSBpZih0aGF0LnAuc29wdCkgeyBvcHI9IHRoYXQucC5zb3B0OyB9XHJcblx0XHRcdFx0ZWxzZSBpZiAgKCAkLmluQXJyYXkoY20uc2VhcmNodHlwZSwgdGhhdC5wLnN0cmFycikgIT09IC0xICkge29wciA9IHRoYXQucC5zdHJvcHRzO31cclxuXHRcdFx0XHRlbHNlIHtvcHIgPSB0aGF0LnAubnVtb3B0czt9XHJcblxyXG5cdFx0XHRcdGdyb3VwLnJ1bGVzLnB1c2goe1xyXG5cdFx0XHRcdFx0ZmllbGQ6IGNtLm5hbWUsXHJcblx0XHRcdFx0XHRvcDogb3ByWzBdLFxyXG5cdFx0XHRcdFx0ZGF0YTogXCJcIlxyXG5cdFx0XHRcdH0pOyAvLyBhZGRpbmcgYSBuZXcgcnVsZVxyXG5cclxuXHRcdFx0XHR0aGF0LnJlRHJhdygpOyAvLyB0aGUgaHRtbCBoYXMgY2hhbmdlZCwgZm9yY2UgcmVEcmF3XHJcblx0XHRcdFx0Ly8gZm9yIHRoZSBtb21lbnQgbm8gY2hhbmdlIGhhdmUgYmVlbiBtYWRlIHRvIHRoZSBydWxlLCBzb1xyXG5cdFx0XHRcdC8vIHRoaXMgd2lsbCBub3QgdHJpZ2dlciBvbmNoYW5nZSBldmVudFxyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdHRoLmFwcGVuZChpbnB1dEFkZFJ1bGUpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBidXR0b24gZm9yIGRlbGV0ZSB0aGUgZ3JvdXBcclxuXHRcdFx0aWYgKHBhcmVudGdyb3VwICE9PSBudWxsKSB7IC8vIGlnbm9yZSB0aGUgZmlyc3QgZ3JvdXBcclxuXHRcdFx0XHR2YXIgaW5wdXREZWxldGVHcm91cCA9ICQoXCI8aW5wdXQgdHlwZT0nYnV0dG9uJyB2YWx1ZT0nLScgdGl0bGU9J0RlbGV0ZSBncm91cCcgY2xhc3M9J2RlbGV0ZS1ncm91cCcvPlwiKTtcclxuXHRcdFx0XHR0aC5hcHBlbmQoaW5wdXREZWxldGVHcm91cCk7XHJcblx0XHRcdFx0aW5wdXREZWxldGVHcm91cC5iaW5kKCdjbGljaycsZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0Ly8gcmVtb3ZlIGdyb3VwIGZyb20gcGFyZW50XHJcblx0XHRcdFx0XHRmb3IgKGkgPSAwOyBpIDwgcGFyZW50Z3JvdXAuZ3JvdXBzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0XHRcdGlmIChwYXJlbnRncm91cC5ncm91cHNbaV0gPT09IGdyb3VwKSB7XHJcblx0XHRcdFx0XHRcdFx0cGFyZW50Z3JvdXAuZ3JvdXBzLnNwbGljZShpLCAxKTtcclxuXHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdHRoYXQucmVEcmF3KCk7IC8vIHRoZSBodG1sIGhhcyBjaGFuZ2VkLCBmb3JjZSByZURyYXdcclxuXHJcblx0XHRcdFx0XHR0aGF0Lm9uY2hhbmdlKCk7IC8vIHNpZ25hbHMgdGhhdCB0aGUgZmlsdGVyIGhhcyBjaGFuZ2VkXHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIGFwcGVuZCBzdWJncm91cCByb3dzXHJcblx0XHRcdGlmIChncm91cC5ncm91cHMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdGZvciAoaSA9IDA7IGkgPCBncm91cC5ncm91cHMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRcdHZhciB0ckhvbGRlckZvclN1Ymdyb3VwID0gJChcIjx0cj48L3RyPlwiKTtcclxuXHRcdFx0XHRcdHRhYmxlLmFwcGVuZCh0ckhvbGRlckZvclN1Ymdyb3VwKTtcclxuXHJcblx0XHRcdFx0XHR2YXIgdGRGaXJzdEhvbGRlckZvclN1Ymdyb3VwID0gJChcIjx0ZCBjbGFzcz0nZmlyc3QnPjwvdGQ+XCIpO1xyXG5cdFx0XHRcdFx0dHJIb2xkZXJGb3JTdWJncm91cC5hcHBlbmQodGRGaXJzdEhvbGRlckZvclN1Ymdyb3VwKTtcclxuXHJcblx0XHRcdFx0XHR2YXIgdGRNYWluSG9sZGVyRm9yU3ViZ3JvdXAgPSAkKFwiPHRkIGNvbHNwYW49JzQnPjwvdGQ+XCIpO1xyXG5cdFx0XHRcdFx0dGRNYWluSG9sZGVyRm9yU3ViZ3JvdXAuYXBwZW5kKHRoaXMuY3JlYXRlVGFibGVGb3JHcm91cChncm91cC5ncm91cHNbaV0sIGdyb3VwKSk7XHJcblx0XHRcdFx0XHR0ckhvbGRlckZvclN1Ymdyb3VwLmFwcGVuZCh0ZE1haW5Ib2xkZXJGb3JTdWJncm91cCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKGdyb3VwLmdyb3VwT3AgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdGdyb3VwLmdyb3VwT3AgPSB0aGF0LnAuZ3JvdXBPcHNbMF0ub3A7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIGFwcGVuZCBydWxlcyByb3dzXHJcblx0XHRcdGlmIChncm91cC5ydWxlcyAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0Zm9yIChpID0gMDsgaSA8IGdyb3VwLnJ1bGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0XHR0YWJsZS5hcHBlbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVUYWJsZVJvd0ZvclJ1bGUoZ3JvdXAucnVsZXNbaV0sIGdyb3VwKVxyXG5cdFx0XHRcdFx0KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHJldHVybiB0YWJsZTtcclxuXHRcdH07XHJcblx0XHQvKlxyXG5cdFx0ICogQ3JlYXRlIHRoZSBydWxlIGRhdGEgZm9yIHRoZSBmaWx0ZXJcclxuXHRcdCAqL1xyXG5cdFx0dGhpcy5jcmVhdGVUYWJsZVJvd0ZvclJ1bGUgPSBmdW5jdGlvbihydWxlLCBncm91cCApIHtcclxuXHRcdFx0Ly8gc2F2ZSBjdXJyZW50IGVudGl0eSBpbiBhIHZhcmlhYmxlIHNvIHRoYXQgaXQgY291bGRcclxuXHRcdFx0Ly8gYmUgcmVmZXJlbmNlZCBpbiBhbm9uaW1vdXMgbWV0aG9kIGNhbGxzXHJcblxyXG5cdFx0XHR2YXIgdGhhdD10aGlzLCAkdCA9IGdldEdyaWQoKSwgdHIgPSAkKFwiPHRyPjwvdHI+XCIpLFxyXG5cdFx0XHQvL2RvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0clwiKSxcclxuXHJcblx0XHRcdC8vIGZpcnN0IGNvbHVtbiB1c2VkIGZvciBwYWRkaW5nXHJcblx0XHRcdC8vdGRGaXJzdEhvbGRlckZvclJ1bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGRcIiksXHJcblx0XHRcdGksIG9wLCB0cnBhciwgY20sIHN0cj1cIlwiLCBzZWxlY3RlZDtcclxuXHRcdFx0Ly90ZEZpcnN0SG9sZGVyRm9yUnVsZS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImZpcnN0XCIpO1xyXG5cdFx0XHR0ci5hcHBlbmQoXCI8dGQgY2xhc3M9J2ZpcnN0Jz48L3RkPlwiKTtcclxuXHJcblxyXG5cdFx0XHQvLyBjcmVhdGUgZmllbGQgY29udGFpbmVyXHJcblx0XHRcdHZhciBydWxlRmllbGRUZCA9ICQoXCI8dGQgY2xhc3M9J2NvbHVtbnMnPjwvdGQ+XCIpO1xyXG5cdFx0XHR0ci5hcHBlbmQocnVsZUZpZWxkVGQpO1xyXG5cclxuXHJcblx0XHRcdC8vIGRyb3Bkb3duIGZvcjogY2hvb3NpbmcgZmllbGRcclxuXHRcdFx0dmFyIHJ1bGVGaWVsZFNlbGVjdCA9ICQoXCI8c2VsZWN0Pjwvc2VsZWN0PlwiKSwgaW5hLCBhb3BycyA9IFtdO1xyXG5cdFx0XHRydWxlRmllbGRUZC5hcHBlbmQocnVsZUZpZWxkU2VsZWN0KTtcclxuXHRcdFx0cnVsZUZpZWxkU2VsZWN0LmJpbmQoJ2NoYW5nZScsZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0cnVsZS5maWVsZCA9ICQocnVsZUZpZWxkU2VsZWN0KS52YWwoKTtcclxuXHJcblx0XHRcdFx0dHJwYXIgPSAkKHRoaXMpLnBhcmVudHMoXCJ0cjpmaXJzdFwiKTtcclxuXHRcdFx0XHRmb3IgKGk9MDtpPHRoYXQucC5jb2x1bW5zLmxlbmd0aDtpKyspIHtcclxuXHRcdFx0XHRcdGlmKHRoYXQucC5jb2x1bW5zW2ldLm5hbWUgPT09ICBydWxlLmZpZWxkKSB7XHJcblx0XHRcdFx0XHRcdGNtID0gdGhhdC5wLmNvbHVtbnNbaV07XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZighY20pIHtyZXR1cm47fVxyXG5cdFx0XHRcdGNtLnNlYXJjaG9wdGlvbnMuaWQgPSAkLmpncmlkLnJhbmRJZCgpO1xyXG5cdFx0XHRcdGlmKGlzSUUgJiYgY20uaW5wdXR0eXBlID09PSBcInRleHRcIikge1xyXG5cdFx0XHRcdFx0aWYoIWNtLnNlYXJjaG9wdGlvbnMuc2l6ZSkge1xyXG5cdFx0XHRcdFx0XHRjbS5zZWFyY2hvcHRpb25zLnNpemUgPSAxMDtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIGVsbSA9ICQuamdyaWQuY3JlYXRlRWwuY2FsbCgkdCwgY20uaW5wdXR0eXBlLGNtLnNlYXJjaG9wdGlvbnMsIFwiXCIsIHRydWUsIHRoYXQucC5hamF4U2VsZWN0T3B0aW9ucyB8fCB7fSwgdHJ1ZSk7XHJcblx0XHRcdFx0JChlbG0pLmFkZENsYXNzKFwiaW5wdXQtZWxtXCIpO1xyXG5cdFx0XHRcdC8vdGhhdC5jcmVhdGVFbGVtZW50KHJ1bGUsIFwiXCIpO1xyXG5cclxuXHRcdFx0XHRpZiggY20uc2VhcmNob3B0aW9ucy5zb3B0ICkge29wID0gY20uc2VhcmNob3B0aW9ucy5zb3B0O31cclxuXHRcdFx0XHRlbHNlIGlmKHRoYXQucC5zb3B0KSB7IG9wPSB0aGF0LnAuc29wdDsgfVxyXG5cdFx0XHRcdGVsc2UgaWYgICgkLmluQXJyYXkoY20uc2VhcmNodHlwZSwgdGhhdC5wLnN0cmFycikgIT09IC0xKSB7b3AgPSB0aGF0LnAuc3Ryb3B0czt9XHJcblx0XHRcdFx0ZWxzZSB7b3AgPSB0aGF0LnAubnVtb3B0czt9XHJcblx0XHRcdFx0Ly8gb3BlcmF0b3JzXHJcblx0XHRcdFx0dmFyIHMgPVwiXCIsIHNvID0gMDtcclxuXHRcdFx0XHRhb3BycyA9IFtdO1xyXG5cdFx0XHRcdCQuZWFjaCh0aGF0LnAub3BzLCBmdW5jdGlvbigpIHsgYW9wcnMucHVzaCh0aGlzLm9wZXIpOyB9KTtcclxuXHRcdFx0XHRmb3IgKCBpID0gMCA7IGkgPCBvcC5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdFx0aW5hID0gJC5pbkFycmF5KG9wW2ldLGFvcHJzKTtcclxuXHRcdFx0XHRcdGlmKGluYSAhPT0gLTEpIHtcclxuXHRcdFx0XHRcdFx0aWYoc289PT0wKSB7XHJcblx0XHRcdFx0XHRcdFx0cnVsZS5vcCA9IHRoYXQucC5vcHNbaW5hXS5vcGVyO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHMgKz0gXCI8b3B0aW9uIHZhbHVlPSdcIit0aGF0LnAub3BzW2luYV0ub3BlcitcIic+XCIrdGhhdC5wLm9wc1tpbmFdLnRleHQrXCI8L29wdGlvbj5cIjtcclxuXHRcdFx0XHRcdFx0c28rKztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JChcIi5zZWxlY3RvcHRzXCIsdHJwYXIpLmVtcHR5KCkuYXBwZW5kKCBzICk7XHJcblx0XHRcdFx0JChcIi5zZWxlY3RvcHRzXCIsdHJwYXIpWzBdLnNlbGVjdGVkSW5kZXggPSAwO1xyXG5cdFx0XHRcdGlmKCAkLmpncmlkLm1zaWUgJiYgJC5qZ3JpZC5tc2lldmVyKCkgPCA5KSB7XHJcblx0XHRcdFx0XHR2YXIgc3cgPSBwYXJzZUludCgkKFwic2VsZWN0LnNlbGVjdG9wdHNcIix0cnBhcilbMF0ub2Zmc2V0V2lkdGgsIDEwKSArIDE7XHJcblx0XHRcdFx0XHQkKFwiLnNlbGVjdG9wdHNcIix0cnBhcikud2lkdGgoIHN3ICk7XHJcblx0XHRcdFx0XHQkKFwiLnNlbGVjdG9wdHNcIix0cnBhcikuY3NzKFwid2lkdGhcIixcImF1dG9cIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC8vIGRhdGFcclxuXHRcdFx0XHQkKFwiLmRhdGFcIix0cnBhcikuZW1wdHkoKS5hcHBlbmQoIGVsbSApO1xyXG5cdFx0XHRcdCQuamdyaWQuYmluZEV2LmNhbGwoJHQsIGVsbSwgY20uc2VhcmNob3B0aW9ucyk7XHJcblx0XHRcdFx0JChcIi5pbnB1dC1lbG1cIix0cnBhcikuYmluZCgnY2hhbmdlJyxmdW5jdGlvbiggZSApIHtcclxuXHRcdFx0XHRcdHZhciBlbGVtID0gZS50YXJnZXQ7XHJcblx0XHRcdFx0XHRydWxlLmRhdGEgPSBlbGVtLm5vZGVOYW1lLnRvVXBwZXJDYXNlKCkgPT09IFwiU1BBTlwiICYmIGNtLnNlYXJjaG9wdGlvbnMgJiYgJC5pc0Z1bmN0aW9uKGNtLnNlYXJjaG9wdGlvbnMuY3VzdG9tX3ZhbHVlKSA/XHJcblx0XHRcdFx0XHRcdGNtLnNlYXJjaG9wdGlvbnMuY3VzdG9tX3ZhbHVlLmNhbGwoJHQsICQoZWxlbSkuY2hpbGRyZW4oXCIuY3VzdG9tZWxlbWVudDpmaXJzdFwiKSwgJ2dldCcpIDogZWxlbS52YWx1ZTtcclxuXHRcdFx0XHRcdHRoYXQub25jaGFuZ2UoKTsgLy8gc2lnbmFscyB0aGF0IHRoZSBmaWx0ZXIgaGFzIGNoYW5nZWRcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IC8vSUUsIE9wZXJhLCBDaHJvbWVcclxuXHRcdFx0XHRydWxlLmRhdGEgPSAkKGVsbSkudmFsKCk7XHJcblx0XHRcdFx0dGhhdC5vbmNoYW5nZSgpOyAgLy8gc2lnbmFscyB0aGF0IHRoZSBmaWx0ZXIgaGFzIGNoYW5nZWRcclxuXHRcdFx0XHR9LCAwKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBwb3B1bGF0ZSBkcm9wIGRvd24gd2l0aCB1c2VyIHByb3ZpZGVkIGNvbHVtbiBkZWZpbml0aW9uc1xyXG5cdFx0XHR2YXIgaj0wO1xyXG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgdGhhdC5wLmNvbHVtbnMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHQvLyBidXQgc2hvdyBvbmx5IHNlcmNoYWJsZSBhbmQgc2VyY2hoaWRkZW4gPSB0cnVlIGZpZWxkc1xyXG5cdFx0XHRcdHZhciBzZWFyY2hhYmxlID0gKHRoYXQucC5jb2x1bW5zW2ldLnNlYXJjaCA9PT0gdW5kZWZpbmVkKSA/IHRydWU6IHRoYXQucC5jb2x1bW5zW2ldLnNlYXJjaCxcclxuXHRcdFx0XHRoaWRkZW4gPSAodGhhdC5wLmNvbHVtbnNbaV0uaGlkZGVuID09PSB0cnVlKSxcclxuXHRcdFx0XHRpZ25vcmVIaWRpbmcgPSAodGhhdC5wLmNvbHVtbnNbaV0uc2VhcmNob3B0aW9ucy5zZWFyY2hoaWRkZW4gPT09IHRydWUpO1xyXG5cdFx0XHRcdGlmICgoaWdub3JlSGlkaW5nICYmIHNlYXJjaGFibGUpIHx8IChzZWFyY2hhYmxlICYmICFoaWRkZW4pKSB7XHJcblx0XHRcdFx0XHRzZWxlY3RlZCA9IFwiXCI7XHJcblx0XHRcdFx0XHRpZihydWxlLmZpZWxkID09PSB0aGF0LnAuY29sdW1uc1tpXS5uYW1lKSB7XHJcblx0XHRcdFx0XHRcdHNlbGVjdGVkID0gXCIgc2VsZWN0ZWQ9J3NlbGVjdGVkJ1wiO1xyXG5cdFx0XHRcdFx0XHRqPWk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRzdHIgKz0gXCI8b3B0aW9uIHZhbHVlPSdcIit0aGF0LnAuY29sdW1uc1tpXS5uYW1lK1wiJ1wiICtzZWxlY3RlZCtcIj5cIit0aGF0LnAuY29sdW1uc1tpXS5sYWJlbCtcIjwvb3B0aW9uPlwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRydWxlRmllbGRTZWxlY3QuYXBwZW5kKCBzdHIgKTtcclxuXHJcblxyXG5cdFx0XHQvLyBjcmVhdGUgb3BlcmF0b3IgY29udGFpbmVyXHJcblx0XHRcdHZhciBydWxlT3BlcmF0b3JUZCA9ICQoXCI8dGQgY2xhc3M9J29wZXJhdG9ycyc+PC90ZD5cIik7XHJcblx0XHRcdHRyLmFwcGVuZChydWxlT3BlcmF0b3JUZCk7XHJcblx0XHRcdGNtID0gcC5jb2x1bW5zW2pdO1xyXG5cdFx0XHQvLyBjcmVhdGUgaXQgaGVyZSBzbyBpdCBjYW4gYmUgcmVmZXJlbnRpYXRlZCBpbiB0aGUgb25jaGFuZ2UgZXZlbnRcclxuXHRcdFx0Ly92YXIgUkQgPSB0aGF0LmNyZWF0ZUVsZW1lbnQocnVsZSwgcnVsZS5kYXRhKTtcclxuXHRcdFx0Y20uc2VhcmNob3B0aW9ucy5pZCA9ICQuamdyaWQucmFuZElkKCk7XHJcblx0XHRcdGlmKGlzSUUgJiYgY20uaW5wdXR0eXBlID09PSBcInRleHRcIikge1xyXG5cdFx0XHRcdGlmKCFjbS5zZWFyY2hvcHRpb25zLnNpemUpIHtcclxuXHRcdFx0XHRcdGNtLnNlYXJjaG9wdGlvbnMuc2l6ZSA9IDEwO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgcnVsZURhdGFJbnB1dCA9ICQuamdyaWQuY3JlYXRlRWwuY2FsbCgkdCwgY20uaW5wdXR0eXBlLGNtLnNlYXJjaG9wdGlvbnMsIHJ1bGUuZGF0YSwgdHJ1ZSwgdGhhdC5wLmFqYXhTZWxlY3RPcHRpb25zIHx8IHt9LCB0cnVlKTtcclxuXHRcdFx0aWYocnVsZS5vcCA9PT0gJ251JyB8fCBydWxlLm9wID09PSAnbm4nKSB7XHJcblx0XHRcdFx0JChydWxlRGF0YUlucHV0KS5hdHRyKCdyZWFkb25seScsJ3RydWUnKTtcclxuXHRcdFx0XHQkKHJ1bGVEYXRhSW5wdXQpLmF0dHIoJ2Rpc2FibGVkJywndHJ1ZScpO1xyXG5cdFx0XHR9IC8vcmV0YWluIHRoZSBzdGF0ZSBvZiBkaXNhYmxlZCB0ZXh0IGZpZWxkcyBpbiBjYXNlIG9mIG51bGwgb3BzXHJcblx0XHRcdC8vIGRyb3Bkb3duIGZvcjogY2hvb3Npbmcgb3BlcmF0b3JcclxuXHRcdFx0dmFyIHJ1bGVPcGVyYXRvclNlbGVjdCA9ICQoXCI8c2VsZWN0IGNsYXNzPSdzZWxlY3RvcHRzJz48L3NlbGVjdD5cIik7XHJcblx0XHRcdHJ1bGVPcGVyYXRvclRkLmFwcGVuZChydWxlT3BlcmF0b3JTZWxlY3QpO1xyXG5cdFx0XHRydWxlT3BlcmF0b3JTZWxlY3QuYmluZCgnY2hhbmdlJyxmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRydWxlLm9wID0gJChydWxlT3BlcmF0b3JTZWxlY3QpLnZhbCgpO1xyXG5cdFx0XHRcdHRycGFyID0gJCh0aGlzKS5wYXJlbnRzKFwidHI6Zmlyc3RcIik7XHJcblx0XHRcdFx0dmFyIHJkID0gJChcIi5pbnB1dC1lbG1cIix0cnBhcilbMF07XHJcblx0XHRcdFx0aWYgKHJ1bGUub3AgPT09IFwibnVcIiB8fCBydWxlLm9wID09PSBcIm5uXCIpIHsgLy8gZGlzYWJsZSBmb3Igb3BlcmF0b3IgXCJpcyBudWxsXCIgYW5kIFwiaXMgbm90IG51bGxcIlxyXG5cdFx0XHRcdFx0cnVsZS5kYXRhID0gXCJcIjtcclxuXHRcdFx0XHRcdGlmKHJkLnRhZ05hbWUudG9VcHBlckNhc2UoKSAhPT0gJ1NFTEVDVCcpIHJkLnZhbHVlID0gXCJcIjtcclxuXHRcdFx0XHRcdHJkLnNldEF0dHJpYnV0ZShcInJlYWRvbmx5XCIsIFwidHJ1ZVwiKTtcclxuXHRcdFx0XHRcdHJkLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwidHJ1ZVwiKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0aWYocmQudGFnTmFtZS50b1VwcGVyQ2FzZSgpID09PSAnU0VMRUNUJykgcnVsZS5kYXRhID0gcmQudmFsdWU7XHJcblx0XHRcdFx0XHRyZC5yZW1vdmVBdHRyaWJ1dGUoXCJyZWFkb25seVwiKTtcclxuXHRcdFx0XHRcdHJkLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0dGhhdC5vbmNoYW5nZSgpOyAgLy8gc2lnbmFscyB0aGF0IHRoZSBmaWx0ZXIgaGFzIGNoYW5nZWRcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBwb3B1bGF0ZSBkcm9wIGRvd24gd2l0aCBhbGwgYXZhaWxhYmxlIG9wZXJhdG9yc1xyXG5cdFx0XHRpZiggY20uc2VhcmNob3B0aW9ucy5zb3B0ICkge29wID0gY20uc2VhcmNob3B0aW9ucy5zb3B0O31cclxuXHRcdFx0ZWxzZSBpZih0aGF0LnAuc29wdCkgeyBvcD0gdGhhdC5wLnNvcHQ7IH1cclxuXHRcdFx0ZWxzZSBpZiAgKCQuaW5BcnJheShjbS5zZWFyY2h0eXBlLCB0aGF0LnAuc3RyYXJyKSAhPT0gLTEpIHtvcCA9IHRoYXQucC5zdHJvcHRzO31cclxuXHRcdFx0ZWxzZSB7b3AgPSB0aGF0LnAubnVtb3B0czt9XHJcblx0XHRcdHN0cj1cIlwiO1xyXG5cdFx0XHQkLmVhY2godGhhdC5wLm9wcywgZnVuY3Rpb24oKSB7IGFvcHJzLnB1c2godGhpcy5vcGVyKTsgfSk7XHJcblx0XHRcdGZvciAoIGkgPSAwOyBpIDwgb3AubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRpbmEgPSAkLmluQXJyYXkob3BbaV0sYW9wcnMpO1xyXG5cdFx0XHRcdGlmKGluYSAhPT0gLTEpIHtcclxuXHRcdFx0XHRcdHNlbGVjdGVkID0gcnVsZS5vcCA9PT0gdGhhdC5wLm9wc1tpbmFdLm9wZXIgPyBcIiBzZWxlY3RlZD0nc2VsZWN0ZWQnXCIgOiBcIlwiO1xyXG5cdFx0XHRcdFx0c3RyICs9IFwiPG9wdGlvbiB2YWx1ZT0nXCIrdGhhdC5wLm9wc1tpbmFdLm9wZXIrXCInXCIrc2VsZWN0ZWQrXCI+XCIrdGhhdC5wLm9wc1tpbmFdLnRleHQrXCI8L29wdGlvbj5cIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0cnVsZU9wZXJhdG9yU2VsZWN0LmFwcGVuZCggc3RyICk7XHJcblx0XHRcdC8vIGNyZWF0ZSBkYXRhIGNvbnRhaW5lclxyXG5cdFx0XHR2YXIgcnVsZURhdGFUZCA9ICQoXCI8dGQgY2xhc3M9J2RhdGEnPjwvdGQ+XCIpO1xyXG5cdFx0XHR0ci5hcHBlbmQocnVsZURhdGFUZCk7XHJcblxyXG5cdFx0XHQvLyB0ZXh0Ym94IGZvcjogZGF0YVxyXG5cdFx0XHQvLyBpcyBjcmVhdGVkIHByZXZpb3VzbHlcclxuXHRcdFx0Ly9ydWxlRGF0YUlucHV0LnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJ0ZXh0XCIpO1xyXG5cdFx0XHRydWxlRGF0YVRkLmFwcGVuZChydWxlRGF0YUlucHV0KTtcclxuXHRcdFx0JC5qZ3JpZC5iaW5kRXYuY2FsbCgkdCwgcnVsZURhdGFJbnB1dCwgY20uc2VhcmNob3B0aW9ucyk7XHJcblx0XHRcdCQocnVsZURhdGFJbnB1dClcclxuXHRcdFx0LmFkZENsYXNzKFwiaW5wdXQtZWxtXCIpXHJcblx0XHRcdC5iaW5kKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRydWxlLmRhdGEgPSBjbS5pbnB1dHR5cGUgPT09ICdjdXN0b20nID8gY20uc2VhcmNob3B0aW9ucy5jdXN0b21fdmFsdWUuY2FsbCgkdCwgJCh0aGlzKS5jaGlsZHJlbihcIi5jdXN0b21lbGVtZW50OmZpcnN0XCIpLCdnZXQnKSA6ICQodGhpcykudmFsKCk7XHJcblx0XHRcdFx0dGhhdC5vbmNoYW5nZSgpOyAvLyBzaWduYWxzIHRoYXQgdGhlIGZpbHRlciBoYXMgY2hhbmdlZFxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIGNyZWF0ZSBhY3Rpb24gY29udGFpbmVyXHJcblx0XHRcdHZhciBydWxlRGVsZXRlVGQgPSAkKFwiPHRkPjwvdGQ+XCIpO1xyXG5cdFx0XHR0ci5hcHBlbmQocnVsZURlbGV0ZVRkKTtcclxuXHJcblx0XHRcdC8vIGNyZWF0ZSBidXR0b24gZm9yOiBkZWxldGUgcnVsZVxyXG5cdFx0XHRpZih0aGlzLnAucnVsZUJ1dHRvbnMgPT09IHRydWUpIHtcclxuXHRcdFx0dmFyIHJ1bGVEZWxldGVJbnB1dCA9ICQoXCI8aW5wdXQgdHlwZT0nYnV0dG9uJyB2YWx1ZT0nLScgdGl0bGU9J0RlbGV0ZSBydWxlJyBjbGFzcz0nZGVsZXRlLXJ1bGUgdWktZGVsJy8+XCIpO1xyXG5cdFx0XHRydWxlRGVsZXRlVGQuYXBwZW5kKHJ1bGVEZWxldGVJbnB1dCk7XHJcblx0XHRcdC8vJChydWxlRGVsZXRlSW5wdXQpLmh0bWwoXCJcIikuaGVpZ2h0KDIwKS53aWR0aCgzMCkuYnV0dG9uKHtpY29uczogeyAgcHJpbWFyeTogXCJ1aS1pY29uLW1pbnVzXCIsIHRleHQ6ZmFsc2V9fSk7XHJcblx0XHRcdHJ1bGVEZWxldGVJbnB1dC5iaW5kKCdjbGljaycsZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0Ly8gcmVtb3ZlIHJ1bGUgZnJvbSBncm91cFxyXG5cdFx0XHRcdGZvciAoaSA9IDA7IGkgPCBncm91cC5ydWxlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdFx0aWYgKGdyb3VwLnJ1bGVzW2ldID09PSBydWxlKSB7XHJcblx0XHRcdFx0XHRcdGdyb3VwLnJ1bGVzLnNwbGljZShpLCAxKTtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHR0aGF0LnJlRHJhdygpOyAvLyB0aGUgaHRtbCBoYXMgY2hhbmdlZCwgZm9yY2UgcmVEcmF3XHJcblxyXG5cdFx0XHRcdHRoYXQub25jaGFuZ2UoKTsgLy8gc2lnbmFscyB0aGF0IHRoZSBmaWx0ZXIgaGFzIGNoYW5nZWRcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiB0cjtcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5nZXRTdHJpbmdGb3JHcm91cCA9IGZ1bmN0aW9uKGdyb3VwKSB7XHJcblx0XHRcdHZhciBzID0gXCIoXCIsIGluZGV4O1xyXG5cdFx0XHRpZiAoZ3JvdXAuZ3JvdXBzICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBncm91cC5ncm91cHMubGVuZ3RoOyBpbmRleCsrKSB7XHJcblx0XHRcdFx0XHRpZiAocy5sZW5ndGggPiAxKSB7XHJcblx0XHRcdFx0XHRcdHMgKz0gXCIgXCIgKyBncm91cC5ncm91cE9wICsgXCIgXCI7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRzICs9IHRoaXMuZ2V0U3RyaW5nRm9yR3JvdXAoZ3JvdXAuZ3JvdXBzW2luZGV4XSk7XHJcblx0XHRcdFx0XHR9IGNhdGNoIChlZykge2FsZXJ0KGVnKTt9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoZ3JvdXAucnVsZXMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdHRyeXtcclxuXHRcdFx0XHRcdGZvciAoaW5kZXggPSAwOyBpbmRleCA8IGdyb3VwLnJ1bGVzLmxlbmd0aDsgaW5kZXgrKykge1xyXG5cdFx0XHRcdFx0XHRpZiAocy5sZW5ndGggPiAxKSB7XHJcblx0XHRcdFx0XHRcdFx0cyArPSBcIiBcIiArIGdyb3VwLmdyb3VwT3AgKyBcIiBcIjtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRzICs9IHRoaXMuZ2V0U3RyaW5nRm9yUnVsZShncm91cC5ydWxlc1tpbmRleF0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gY2F0Y2ggKGUpIHthbGVydChlKTt9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHMgKz0gXCIpXCI7XHJcblxyXG5cdFx0XHRpZiAocyA9PT0gXCIoKVwiKSB7XHJcblx0XHRcdFx0cmV0dXJuIFwiXCI7IC8vIGlnbm9yZSBncm91cHMgdGhhdCBkb24ndCBoYXZlIHJ1bGVzXHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHM7XHJcblx0XHR9O1xyXG5cdFx0dGhpcy5nZXRTdHJpbmdGb3JSdWxlID0gZnVuY3Rpb24ocnVsZSkge1xyXG5cdFx0XHR2YXIgb3BVRiA9IFwiXCIsb3BDPVwiXCIsIGksIGNtLCByZXQsIHZhbCxcclxuXHRcdFx0bnVtdHlwZXMgPSBbJ2ludCcsICdpbnRlZ2VyJywgJ2Zsb2F0JywgJ251bWJlcicsICdjdXJyZW5jeSddOyAvLyBqcUdyaWRcclxuXHRcdFx0Zm9yIChpID0gMDsgaSA8IHRoaXMucC5vcHMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRpZiAodGhpcy5wLm9wc1tpXS5vcGVyID09PSBydWxlLm9wKSB7XHJcblx0XHRcdFx0XHRvcFVGID0gdGhpcy5wLm9wZXJhbmRzLmhhc093blByb3BlcnR5KHJ1bGUub3ApID8gdGhpcy5wLm9wZXJhbmRzW3J1bGUub3BdIDogXCJcIjtcclxuXHRcdFx0XHRcdG9wQyA9IHRoaXMucC5vcHNbaV0ub3BlcjtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRmb3IgKGk9MDsgaTx0aGlzLnAuY29sdW1ucy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdGlmKHRoaXMucC5jb2x1bW5zW2ldLm5hbWUgPT09IHJ1bGUuZmllbGQpIHtcclxuXHRcdFx0XHRcdGNtID0gdGhpcy5wLmNvbHVtbnNbaV07XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKGNtID09IHVuZGVmaW5lZCkgeyByZXR1cm4gXCJcIjsgfVxyXG5cdFx0XHR2YWwgPSBydWxlLmRhdGE7XHJcblx0XHRcdGlmKG9wQyA9PT0gJ2J3JyB8fCBvcEMgPT09ICdibicpIHsgdmFsID0gdmFsK1wiJVwiOyB9XHJcblx0XHRcdGlmKG9wQyA9PT0gJ2V3JyB8fCBvcEMgPT09ICdlbicpIHsgdmFsID0gXCIlXCIrdmFsOyB9XHJcblx0XHRcdGlmKG9wQyA9PT0gJ2NuJyB8fCBvcEMgPT09ICduYycpIHsgdmFsID0gXCIlXCIrdmFsK1wiJVwiOyB9XHJcblx0XHRcdGlmKG9wQyA9PT0gJ2luJyB8fCBvcEMgPT09ICduaScpIHsgdmFsID0gXCIgKFwiK3ZhbCtcIilcIjsgfVxyXG5cdFx0XHRpZihwLmVycm9yY2hlY2spIHsgY2hlY2tEYXRhKHJ1bGUuZGF0YSwgY20pOyB9XHJcblx0XHRcdGlmKCQuaW5BcnJheShjbS5zZWFyY2h0eXBlLCBudW10eXBlcykgIT09IC0xIHx8IG9wQyA9PT0gJ25uJyB8fCBvcEMgPT09ICdudScpIHsgcmV0ID0gcnVsZS5maWVsZCArIFwiIFwiICsgb3BVRiArIFwiIFwiICsgdmFsOyB9XHJcblx0XHRcdGVsc2UgeyByZXQgPSBydWxlLmZpZWxkICsgXCIgXCIgKyBvcFVGICsgXCIgXFxcIlwiICsgdmFsICsgXCJcXFwiXCI7IH1cclxuXHRcdFx0cmV0dXJuIHJldDtcclxuXHRcdH07XHJcblx0XHR0aGlzLnJlc2V0RmlsdGVyID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHR0aGlzLnAuZmlsdGVyID0gJC5leHRlbmQodHJ1ZSx7fSx0aGlzLnAuaW5pdEZpbHRlcik7XHJcblx0XHRcdHRoaXMucmVEcmF3KCk7XHJcblx0XHRcdHRoaXMub25jaGFuZ2UoKTtcclxuXHRcdH07XHJcblx0XHR0aGlzLmhpZGVFcnJvciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQkKFwidGgudWktc3RhdGUtZXJyb3JcIiwgdGhpcykuaHRtbChcIlwiKTtcclxuXHRcdFx0JChcInRyLmVycm9yXCIsIHRoaXMpLmhpZGUoKTtcclxuXHRcdH07XHJcblx0XHR0aGlzLnNob3dFcnJvciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQkKFwidGgudWktc3RhdGUtZXJyb3JcIiwgdGhpcykuaHRtbCh0aGlzLnAuZXJybXNnKTtcclxuXHRcdFx0JChcInRyLmVycm9yXCIsIHRoaXMpLnNob3coKTtcclxuXHRcdH07XHJcblx0XHR0aGlzLnRvVXNlckZyaWVuZGx5U3RyaW5nID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLmdldFN0cmluZ0Zvckdyb3VwKHAuZmlsdGVyKTtcclxuXHRcdH07XHJcblx0XHR0aGlzLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdC8vIHRoaXMgd2lsbCBvYnRhaW4gYSBzdHJpbmcgdGhhdCBjYW4gYmUgdXNlZCB0byBtYXRjaCBhbiBpdGVtLlxyXG5cdFx0XHR2YXIgdGhhdCA9IHRoaXM7XHJcblx0XHRcdGZ1bmN0aW9uIGdldFN0cmluZ1J1bGUocnVsZSkge1xyXG5cdFx0XHRcdGlmKHRoYXQucC5lcnJvcmNoZWNrKSB7XHJcblx0XHRcdFx0XHR2YXIgaSwgY207XHJcblx0XHRcdFx0XHRmb3IgKGk9MDsgaTx0aGF0LnAuY29sdW1ucy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdFx0XHRpZih0aGF0LnAuY29sdW1uc1tpXS5uYW1lID09PSBydWxlLmZpZWxkKSB7XHJcblx0XHRcdFx0XHRcdFx0Y20gPSB0aGF0LnAuY29sdW1uc1tpXTtcclxuXHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYoY20pIHtjaGVja0RhdGEocnVsZS5kYXRhLCBjbSk7fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gcnVsZS5vcCArIFwiKGl0ZW0uXCIgKyBydWxlLmZpZWxkICsgXCIsJ1wiICsgcnVsZS5kYXRhICsgXCInKVwiO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRmdW5jdGlvbiBnZXRTdHJpbmdGb3JHcm91cChncm91cCkge1xyXG5cdFx0XHRcdHZhciBzID0gXCIoXCIsIGluZGV4O1xyXG5cclxuXHRcdFx0XHRpZiAoZ3JvdXAuZ3JvdXBzICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdGZvciAoaW5kZXggPSAwOyBpbmRleCA8IGdyb3VwLmdyb3Vwcy5sZW5ndGg7IGluZGV4KyspIHtcclxuXHRcdFx0XHRcdFx0aWYgKHMubGVuZ3RoID4gMSkge1xyXG5cdFx0XHRcdFx0XHRcdGlmIChncm91cC5ncm91cE9wID09PSBcIk9SXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHMgKz0gXCIgfHwgXCI7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0cyArPSBcIiAmJiBcIjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0cyArPSBnZXRTdHJpbmdGb3JHcm91cChncm91cC5ncm91cHNbaW5kZXhdKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlmIChncm91cC5ydWxlcyAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBncm91cC5ydWxlcy5sZW5ndGg7IGluZGV4KyspIHtcclxuXHRcdFx0XHRcdFx0aWYgKHMubGVuZ3RoID4gMSkge1xyXG5cdFx0XHRcdFx0XHRcdGlmIChncm91cC5ncm91cE9wID09PSBcIk9SXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHMgKz0gXCIgfHwgXCI7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdGVsc2UgIHtcclxuXHRcdFx0XHRcdFx0XHRcdHMgKz0gXCIgJiYgXCI7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHMgKz0gZ2V0U3RyaW5nUnVsZShncm91cC5ydWxlc1tpbmRleF0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0cyArPSBcIilcIjtcclxuXHJcblx0XHRcdFx0aWYgKHMgPT09IFwiKClcIikge1xyXG5cdFx0XHRcdFx0cmV0dXJuIFwiXCI7IC8vIGlnbm9yZSBncm91cHMgdGhhdCBkb24ndCBoYXZlIHJ1bGVzXHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiBzO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRyZXR1cm4gZ2V0U3RyaW5nRm9yR3JvdXAodGhpcy5wLmZpbHRlcik7XHJcblx0XHR9O1xyXG5cclxuXHRcdC8vIEhlcmUgd2UgaW5pdCB0aGUgZmlsdGVyXHJcblx0XHR0aGlzLnJlRHJhdygpO1xyXG5cclxuXHRcdGlmKHRoaXMucC5zaG93UXVlcnkpIHtcclxuXHRcdFx0dGhpcy5vbmNoYW5nZSgpO1xyXG5cdFx0fVxyXG5cdFx0Ly8gbWFyayBpcyBhcyBjcmVhdGVkIHNvIHRoYXQgaXQgd2lsbCBub3QgYmUgY3JlYXRlZCB0d2ljZSBvbiB0aGlzIGVsZW1lbnRcclxuXHRcdHRoaXMuZmlsdGVyID0gdHJ1ZTtcclxuXHR9KTtcclxufTtcclxuJC5leHRlbmQoJC5mbi5qcUZpbHRlcix7XHJcblx0LypcclxuXHQgKiBSZXR1cm4gU1FMIGxpa2Ugc3RyaW5nLiBDYW4gYmUgdXNlZCBkaXJlY3RseVxyXG5cdCAqL1xyXG5cdHRvU1FMU3RyaW5nIDogZnVuY3Rpb24oKVxyXG5cdHtcclxuXHRcdHZhciBzID1cIlwiO1xyXG5cdFx0dGhpcy5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdHMgPSB0aGlzLnRvVXNlckZyaWVuZGx5U3RyaW5nKCk7XHJcblx0XHR9KTtcclxuXHRcdHJldHVybiBzO1xyXG5cdH0sXHJcblx0LypcclxuXHQgKiBSZXR1cm4gZmlsdGVyIGRhdGEgYXMgb2JqZWN0LlxyXG5cdCAqL1xyXG5cdGZpbHRlckRhdGEgOiBmdW5jdGlvbigpXHJcblx0e1xyXG5cdFx0dmFyIHM7XHJcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0cyA9IHRoaXMucC5maWx0ZXI7XHJcblx0XHR9KTtcclxuXHRcdHJldHVybiBzO1xyXG5cclxuXHR9LFxyXG5cdGdldFBhcmFtZXRlciA6IGZ1bmN0aW9uIChwYXJhbSkge1xyXG5cdFx0aWYocGFyYW0gIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRpZiAodGhpcy5wLmhhc093blByb3BlcnR5KHBhcmFtKSApIHtcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5wW3BhcmFtXTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXMucDtcclxuXHR9LFxyXG5cdHJlc2V0RmlsdGVyOiBmdW5jdGlvbigpIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dGhpcy5yZXNldEZpbHRlcigpO1xyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRhZGRGaWx0ZXI6IGZ1bmN0aW9uIChwZmlsdGVyKSB7XHJcblx0XHRpZiAodHlwZW9mIHBmaWx0ZXIgPT09IFwic3RyaW5nXCIpIHtcclxuXHRcdFx0cGZpbHRlciA9ICQuamdyaWQucGFyc2UoIHBmaWx0ZXIgKTtcclxuXHR9XHJcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dGhpcy5wLmZpbHRlciA9IHBmaWx0ZXI7XHJcblx0XHRcdHRoaXMucmVEcmF3KCk7XHJcblx0XHRcdHRoaXMub25jaGFuZ2UoKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcbn0pO1xyXG59KShqUXVlcnkpO1xyXG4vKmpzaGludCBlcWVxZXE6ZmFsc2UsIGVxbnVsbDp0cnVlLCBkZXZlbDp0cnVlICovXHJcbi8qZ2xvYmFsIHhtbEpzb25DbGFzcywgalF1ZXJ5ICovXHJcbihmdW5jdGlvbigkKXtcclxuLyoqXHJcbiAqIGpxR3JpZCBleHRlbnNpb24gZm9yIGZvcm0gZWRpdGluZyBHcmlkIERhdGFcclxuICogVG9ueSBUb21vdiB0b255QHRyaXJhbmQuY29tXHJcbiAqIGh0dHA6Ly90cmlyYW5kLmNvbS9ibG9nL1xyXG4gKiBEdWFsIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgYW5kIEdQTCBsaWNlbnNlczpcclxuICogaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuICogaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2dwbC0yLjAuaHRtbFxyXG4qKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBycF9nZSA9IHt9O1xyXG4kLmpncmlkLmV4dGVuZCh7XHJcblx0c2VhcmNoR3JpZCA6IGZ1bmN0aW9uIChwKSB7XHJcblx0XHRwID0gJC5leHRlbmQodHJ1ZSwge1xyXG5cdFx0XHRyZWNyZWF0ZUZpbHRlcjogZmFsc2UsXHJcblx0XHRcdGRyYWc6IHRydWUsXHJcblx0XHRcdHNGaWVsZDonc2VhcmNoRmllbGQnLFxyXG5cdFx0XHRzVmFsdWU6J3NlYXJjaFN0cmluZycsXHJcblx0XHRcdHNPcGVyOiAnc2VhcmNoT3BlcicsXHJcblx0XHRcdHNGaWx0ZXI6ICdmaWx0ZXJzJyxcclxuXHRcdFx0bG9hZERlZmF1bHRzOiB0cnVlLCAvLyB0aGlzIG9wdGlvbnMgYWN0aXZhdGVzIGxvYWRpbmcgb2YgZGVmYXVsdCBmaWx0ZXJzIGZyb20gZ3JpZCdzIHBvc3REYXRhIGZvciBNdWx0aXBlIFNlYXJjaCBvbmx5LlxyXG5cdFx0XHRiZWZvcmVTaG93U2VhcmNoOiBudWxsLFxyXG5cdFx0XHRhZnRlclNob3dTZWFyY2ggOiBudWxsLFxyXG5cdFx0XHRvbkluaXRpYWxpemVTZWFyY2g6IG51bGwsXHJcblx0XHRcdGFmdGVyUmVkcmF3IDogbnVsbCxcclxuXHRcdFx0YWZ0ZXJDaGFuZ2U6IG51bGwsXHJcblx0XHRcdGNsb3NlQWZ0ZXJTZWFyY2ggOiBmYWxzZSxcclxuXHRcdFx0Y2xvc2VBZnRlclJlc2V0OiBmYWxzZSxcclxuXHRcdFx0Y2xvc2VPbkVzY2FwZSA6IGZhbHNlLFxyXG5cdFx0XHRzZWFyY2hPbkVudGVyIDogZmFsc2UsXHJcblx0XHRcdG11bHRpcGxlU2VhcmNoIDogZmFsc2UsXHJcblx0XHRcdG11bHRpcGxlR3JvdXAgOiBmYWxzZSxcclxuXHRcdFx0Ly9jbG9uZVNlYXJjaFJvd09uQWRkOiB0cnVlLFxyXG5cdFx0XHR0b3AgOiAwLFxyXG5cdFx0XHRsZWZ0OiAwLFxyXG5cdFx0XHRqcU1vZGFsIDogdHJ1ZSxcclxuXHRcdFx0bW9kYWw6IGZhbHNlLFxyXG5cdFx0XHRyZXNpemUgOiB0cnVlLFxyXG5cdFx0XHR3aWR0aDogNDUwLFxyXG5cdFx0XHRoZWlnaHQ6ICdhdXRvJyxcclxuXHRcdFx0ZGF0YWhlaWdodDogJ2F1dG8nLFxyXG5cdFx0XHRzaG93UXVlcnk6IGZhbHNlLFxyXG5cdFx0XHRlcnJvcmNoZWNrIDogdHJ1ZSxcclxuXHRcdFx0c29wdDogbnVsbCxcclxuXHRcdFx0c3RyaW5nUmVzdWx0OiB1bmRlZmluZWQsXHJcblx0XHRcdG9uQ2xvc2UgOiBudWxsLFxyXG5cdFx0XHRvblNlYXJjaCA6IG51bGwsXHJcblx0XHRcdG9uUmVzZXQgOiBudWxsLFxyXG5cdFx0XHR0b1RvcCA6IHRydWUsXHJcblx0XHRcdG92ZXJsYXkgOiAzMCxcclxuXHRcdFx0Y29sdW1ucyA6IFtdLFxyXG5cdFx0XHR0bXBsTmFtZXMgOiBudWxsLFxyXG5cdFx0XHR0bXBsRmlsdGVycyA6IG51bGwsXHJcblx0XHRcdHRtcGxMYWJlbCA6ICcgVGVtcGxhdGU6ICcsXHJcblx0XHRcdHNob3dPbkxvYWQ6IGZhbHNlLFxyXG5cdFx0XHRsYXllcjogbnVsbCxcclxuXHRcdFx0b3BlcmFuZHMgOiB7IFwiZXFcIiA6XCI9XCIsIFwibmVcIjpcIjw+XCIsXCJsdFwiOlwiPFwiLFwibGVcIjpcIjw9XCIsXCJndFwiOlwiPlwiLFwiZ2VcIjpcIj49XCIsXCJid1wiOlwiTElLRVwiLFwiYm5cIjpcIk5PVCBMSUtFXCIsXCJpblwiOlwiSU5cIixcIm5pXCI6XCJOT1QgSU5cIixcImV3XCI6XCJMSUtFXCIsXCJlblwiOlwiTk9UIExJS0VcIixcImNuXCI6XCJMSUtFXCIsXCJuY1wiOlwiTk9UIExJS0VcIixcIm51XCI6XCJJUyBOVUxMXCIsXCJublwiOlwiSVNOT1QgTlVMTFwifVxyXG5cdFx0fSwgJC5qZ3JpZC5zZWFyY2gsIHAgfHwge30pO1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyICR0ID0gdGhpcztcclxuXHRcdFx0aWYoISR0LmdyaWQpIHtyZXR1cm47fVxyXG5cdFx0XHR2YXIgZmlkID0gXCJmYm94X1wiKyR0LnAuaWQsXHJcblx0XHRcdHNob3dGcm0gPSB0cnVlLFxyXG5cdFx0XHRtdXN0UmVsb2FkID0gdHJ1ZSxcclxuXHRcdFx0SURzID0ge3RoZW1vZGFsOidzZWFyY2htb2QnK2ZpZCxtb2RhbGhlYWQ6J3NlYXJjaGhkJytmaWQsbW9kYWxjb250ZW50OidzZWFyY2hjbnQnK2ZpZCwgc2Nyb2xsZWxtIDogZmlkfSxcclxuXHRcdFx0ZGVmYXVsdEZpbHRlcnMgID0gJHQucC5wb3N0RGF0YVtwLnNGaWx0ZXJdO1xyXG5cdFx0XHRpZih0eXBlb2YgZGVmYXVsdEZpbHRlcnMgPT09IFwic3RyaW5nXCIpIHtcclxuXHRcdFx0XHRkZWZhdWx0RmlsdGVycyA9ICQuamdyaWQucGFyc2UoIGRlZmF1bHRGaWx0ZXJzICk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYocC5yZWNyZWF0ZUZpbHRlciA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdCQoXCIjXCIrJC5qZ3JpZC5qcUlEKElEcy50aGVtb2RhbCkpLnJlbW92ZSgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIHNob3dGaWx0ZXIoX2ZpbHRlcikge1xyXG5cdFx0XHRcdHNob3dGcm0gPSAkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEZpbHRlckJlZm9yZVNob3dcIiwgW19maWx0ZXJdKTtcclxuXHRcdFx0XHRpZihzaG93RnJtID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdHNob3dGcm0gPSB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihzaG93RnJtICYmICQuaXNGdW5jdGlvbihwLmJlZm9yZVNob3dTZWFyY2gpKSB7XHJcblx0XHRcdFx0XHRzaG93RnJtID0gcC5iZWZvcmVTaG93U2VhcmNoLmNhbGwoJHQsX2ZpbHRlcik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKHNob3dGcm0pIHtcclxuXHRcdFx0XHRcdCQuamdyaWQudmlld01vZGFsKFwiI1wiKyQuamdyaWQuanFJRChJRHMudGhlbW9kYWwpLHtnYm94OlwiI2dib3hfXCIrJC5qZ3JpZC5qcUlEKGZpZCksanFtOnAuanFNb2RhbCwgbW9kYWw6cC5tb2RhbCwgb3ZlcmxheTogcC5vdmVybGF5LCB0b1RvcDogcC50b1RvcH0pO1xyXG5cdFx0XHRcdFx0JCgkdCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRGaWx0ZXJBZnRlclNob3dcIiwgW19maWx0ZXJdKTtcclxuXHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbihwLmFmdGVyU2hvd1NlYXJjaCkpIHtcclxuXHRcdFx0XHRcdFx0cC5hZnRlclNob3dTZWFyY2guY2FsbCgkdCwgX2ZpbHRlcik7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmICggJChcIiNcIiskLmpncmlkLmpxSUQoSURzLnRoZW1vZGFsKSlbMF0gIT09IHVuZGVmaW5lZCApIHtcclxuXHRcdFx0XHRzaG93RmlsdGVyKCQoXCIjZmJveF9cIiskLmpncmlkLmpxSUQoKyR0LnAuaWQpKSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dmFyIGZpbCA9ICQoXCI8ZGl2PjxkaXYgaWQ9J1wiK2ZpZCtcIicgY2xhc3M9J3NlYXJjaEZpbHRlcicgc3R5bGU9J292ZXJmbG93OmF1dG8nPjwvZGl2PjwvZGl2PlwiKS5pbnNlcnRCZWZvcmUoXCIjZ3ZpZXdfXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpKSxcclxuXHRcdFx0XHRhbGlnbiA9IFwibGVmdFwiLCBidXRsZWZ0ID1cIlwiO1xyXG5cdFx0XHRcdGlmKCR0LnAuZGlyZWN0aW9uID09PSBcInJ0bFwiKSB7XHJcblx0XHRcdFx0XHRhbGlnbiA9IFwicmlnaHRcIjtcclxuXHRcdFx0XHRcdGJ1dGxlZnQgPSBcIiBzdHlsZT0ndGV4dC1hbGlnbjpsZWZ0J1wiO1xyXG5cdFx0XHRcdFx0ZmlsLmF0dHIoXCJkaXJcIixcInJ0bFwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIGNvbHVtbnMgPSAkLmV4dGVuZChbXSwkdC5wLmNvbE1vZGVsKSxcclxuXHRcdFx0XHRiUyAgPVwiPGEgaWQ9J1wiK2ZpZCtcIl9zZWFyY2gnIGNsYXNzPSdmbS1idXR0b24gdWktc3RhdGUtZGVmYXVsdCB1aS1jb3JuZXItYWxsIGZtLWJ1dHRvbi1pY29uLXJpZ2h0IHVpLXJlc2V0Jz48c3BhbiBjbGFzcz0ndWktaWNvbiB1aS1pY29uLXNlYXJjaCc+PC9zcGFuPlwiK3AuRmluZCtcIjwvYT5cIixcclxuXHRcdFx0XHRiQyAgPVwiPGEgaWQ9J1wiK2ZpZCtcIl9yZXNldCcgY2xhc3M9J2ZtLWJ1dHRvbiB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1hbGwgZm0tYnV0dG9uLWljb24tbGVmdCB1aS1zZWFyY2gnPjxzcGFuIGNsYXNzPSd1aS1pY29uIHVpLWljb24tYXJyb3dyZXR1cm50aGljay0xLXcnPjwvc3Bhbj5cIitwLlJlc2V0K1wiPC9hPlwiLFxyXG5cdFx0XHRcdGJRID0gXCJcIiwgdG1wbD1cIlwiLCBjb2xubSwgZm91bmQgPSBmYWxzZSwgYnQsIGNtaT0tMTtcclxuXHRcdFx0XHRpZihwLnNob3dRdWVyeSkge1xyXG5cdFx0XHRcdFx0YlEgPVwiPGEgaWQ9J1wiK2ZpZCtcIl9xdWVyeScgY2xhc3M9J2ZtLWJ1dHRvbiB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1hbGwgZm0tYnV0dG9uLWljb24tbGVmdCc+PHNwYW4gY2xhc3M9J3VpLWljb24gdWktaWNvbi1jb21tZW50Jz48L3NwYW4+UXVlcnk8L2E+XCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKCFwLmNvbHVtbnMubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHQkLmVhY2goY29sdW1ucywgZnVuY3Rpb24oaSxuKXtcclxuXHRcdFx0XHRcdFx0aWYoIW4ubGFiZWwpIHtcclxuXHRcdFx0XHRcdFx0XHRuLmxhYmVsID0gJHQucC5jb2xOYW1lc1tpXTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHQvLyBmaW5kIGZpcnN0IHNlYXJjaGFibGUgY29sdW1uIGFuZCBzZXQgaXQgaWYgbm8gZGVmYXVsdCBmaWx0ZXJcclxuXHRcdFx0XHRcdFx0aWYoIWZvdW5kKSB7XHJcblx0XHRcdFx0XHRcdFx0dmFyIHNlYXJjaGFibGUgPSAobi5zZWFyY2ggPT09IHVuZGVmaW5lZCkgPyAgdHJ1ZTogbi5zZWFyY2ggLFxyXG5cdFx0XHRcdFx0XHRcdGhpZGRlbiA9IChuLmhpZGRlbiA9PT0gdHJ1ZSksXHJcblx0XHRcdFx0XHRcdFx0aWdub3JlSGlkaW5nID0gKG4uc2VhcmNob3B0aW9ucyAmJiBuLnNlYXJjaG9wdGlvbnMuc2VhcmNoaGlkZGVuID09PSB0cnVlKTtcclxuXHRcdFx0XHRcdFx0XHRpZiAoKGlnbm9yZUhpZGluZyAmJiBzZWFyY2hhYmxlKSB8fCAoc2VhcmNoYWJsZSAmJiAhaGlkZGVuKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0Zm91bmQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29sbm0gPSBuLmluZGV4IHx8IG4ubmFtZTtcclxuXHRcdFx0XHRcdFx0XHRcdGNtaSA9aTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRjb2x1bW5zID0gcC5jb2x1bW5zO1xyXG5cdFx0XHRcdFx0Y21pID0gMDtcclxuXHRcdFx0XHRcdGNvbG5tID0gY29sdW1uc1swXS5pbmRleCB8fCBjb2x1bW5zWzBdLm5hbWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC8vIG9sZCBiZWhhdmlvdXJcclxuXHRcdFx0XHRpZiggKCFkZWZhdWx0RmlsdGVycyAmJiBjb2xubSkgfHwgcC5tdWx0aXBsZVNlYXJjaCA9PT0gZmFsc2UgICkge1xyXG5cdFx0XHRcdFx0dmFyIGNtb3AgPSBcImVxXCI7XHJcblx0XHRcdFx0XHRpZihjbWkgPj0wICYmIGNvbHVtbnNbY21pXS5zZWFyY2hvcHRpb25zICYmIGNvbHVtbnNbY21pXS5zZWFyY2hvcHRpb25zLnNvcHQpIHtcclxuXHRcdFx0XHRcdFx0Y21vcCA9IGNvbHVtbnNbY21pXS5zZWFyY2hvcHRpb25zLnNvcHRbMF07XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYocC5zb3B0ICYmIHAuc29wdC5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0Y21vcCA9IHAuc29wdFswXTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGRlZmF1bHRGaWx0ZXJzID0ge2dyb3VwT3A6IFwiQU5EXCIsIHJ1bGVzOiBbe2ZpZWxkOiBjb2xubSwgb3A6IGNtb3AsIGRhdGE6IFwiXCJ9XX07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGZvdW5kID0gZmFsc2U7XHJcblx0XHRcdFx0aWYocC50bXBsTmFtZXMgJiYgcC50bXBsTmFtZXMubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRmb3VuZCA9IHRydWU7XHJcblx0XHRcdFx0XHR0bXBsID0gcC50bXBsTGFiZWw7XHJcblx0XHRcdFx0XHR0bXBsICs9IFwiPHNlbGVjdCBjbGFzcz0ndWktdGVtcGxhdGUnPlwiO1xyXG5cdFx0XHRcdFx0dG1wbCArPSBcIjxvcHRpb24gdmFsdWU9J2RlZmF1bHQnPkRlZmF1bHQ8L29wdGlvbj5cIjtcclxuXHRcdFx0XHRcdCQuZWFjaChwLnRtcGxOYW1lcywgZnVuY3Rpb24oaSxuKXtcclxuXHRcdFx0XHRcdFx0dG1wbCArPSBcIjxvcHRpb24gdmFsdWU9J1wiK2krXCInPlwiK24rXCI8L29wdGlvbj5cIjtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0dG1wbCArPSBcIjwvc2VsZWN0PlwiO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0YnQgPSBcIjx0YWJsZSBjbGFzcz0nRWRpdFRhYmxlJyBzdHlsZT0nYm9yZGVyOjBweCBub25lO21hcmdpbi10b3A6NXB4JyBpZD0nXCIrZmlkK1wiXzInPjx0Ym9keT48dHI+PHRkIGNvbHNwYW49JzInPjxociBjbGFzcz0ndWktd2lkZ2V0LWNvbnRlbnQnIHN0eWxlPSdtYXJnaW46MXB4Jy8+PC90ZD48L3RyPjx0cj48dGQgY2xhc3M9J0VkaXRCdXR0b24nIHN0eWxlPSd0ZXh0LWFsaWduOlwiK2FsaWduK1wiJz5cIitiQyt0bXBsK1wiPC90ZD48dGQgY2xhc3M9J0VkaXRCdXR0b24nIFwiK2J1dGxlZnQrXCI+XCIrYlErYlMrXCI8L3RkPjwvdHI+PC90Ym9keT48L3RhYmxlPlwiO1xyXG5cdFx0XHRcdGZpZCA9ICQuamdyaWQuanFJRCggZmlkKTtcclxuXHRcdFx0XHQkKFwiI1wiK2ZpZCkuanFGaWx0ZXIoe1xyXG5cdFx0XHRcdFx0Y29sdW1ucyA6IGNvbHVtbnMsXHJcblx0XHRcdFx0XHRmaWx0ZXI6IHAubG9hZERlZmF1bHRzID8gZGVmYXVsdEZpbHRlcnMgOiBudWxsLFxyXG5cdFx0XHRcdFx0c2hvd1F1ZXJ5OiBwLnNob3dRdWVyeSxcclxuXHRcdFx0XHRcdGVycm9yY2hlY2sgOiBwLmVycm9yY2hlY2ssXHJcblx0XHRcdFx0XHRzb3B0OiBwLnNvcHQsXHJcblx0XHRcdFx0XHRncm91cEJ1dHRvbiA6IHAubXVsdGlwbGVHcm91cCxcclxuXHRcdFx0XHRcdHJ1bGVCdXR0b25zIDogcC5tdWx0aXBsZVNlYXJjaCxcclxuXHRcdFx0XHRcdGFmdGVyUmVkcmF3IDogcC5hZnRlclJlZHJhdyxcclxuXHRcdFx0XHRcdG9wcyA6IHAub2RhdGEsXHJcblx0XHRcdFx0XHRvcGVyYW5kcyA6IHAub3BlcmFuZHMsXHJcblx0XHRcdFx0XHRhamF4U2VsZWN0T3B0aW9uczogJHQucC5hamF4U2VsZWN0T3B0aW9ucyxcclxuXHRcdFx0XHRcdGdyb3VwT3BzOiBwLmdyb3VwT3BzLFxyXG5cdFx0XHRcdFx0b25DaGFuZ2UgOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0aWYodGhpcy5wLnNob3dRdWVyeSkge1xyXG5cdFx0XHRcdFx0XHRcdCQoJy5xdWVyeScsdGhpcykuaHRtbCh0aGlzLnRvVXNlckZyaWVuZGx5U3RyaW5nKCkpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmICgkLmlzRnVuY3Rpb24ocC5hZnRlckNoYW5nZSkpIHtcclxuXHRcdFx0XHRcdFx0XHRwLmFmdGVyQ2hhbmdlLmNhbGwoJHQsICQoXCIjXCIrZmlkKSwgcCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRkaXJlY3Rpb24gOiAkdC5wLmRpcmVjdGlvbixcclxuXHRcdFx0XHRcdGlkOiAkdC5wLmlkXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0ZmlsLmFwcGVuZCggYnQgKTtcclxuXHRcdFx0XHRpZihmb3VuZCAmJiBwLnRtcGxGaWx0ZXJzICYmIHAudG1wbEZpbHRlcnMubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHQkKFwiLnVpLXRlbXBsYXRlXCIsIGZpbCkuYmluZCgnY2hhbmdlJywgZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdFx0dmFyIGN1cnRlbXBsID0gJCh0aGlzKS52YWwoKTtcclxuXHRcdFx0XHRcdFx0aWYoY3VydGVtcGw9PT1cImRlZmF1bHRcIikge1xyXG5cdFx0XHRcdFx0XHRcdCQoXCIjXCIrZmlkKS5qcUZpbHRlcignYWRkRmlsdGVyJywgZGVmYXVsdEZpbHRlcnMpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdCQoXCIjXCIrZmlkKS5qcUZpbHRlcignYWRkRmlsdGVyJywgcC50bXBsRmlsdGVyc1twYXJzZUludChjdXJ0ZW1wbCwxMCldKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYocC5tdWx0aXBsZUdyb3VwID09PSB0cnVlKSB7cC5tdWx0aXBsZVNlYXJjaCA9IHRydWU7fVxyXG5cdFx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkRmlsdGVySW5pdGlhbGl6ZVwiLCBbJChcIiNcIitmaWQpXSk7XHJcblx0XHRcdFx0aWYoJC5pc0Z1bmN0aW9uKHAub25Jbml0aWFsaXplU2VhcmNoKSApIHtcclxuXHRcdFx0XHRcdHAub25Jbml0aWFsaXplU2VhcmNoLmNhbGwoJHQsICQoXCIjXCIrZmlkKSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHAuZ2JveCA9IFwiI2dib3hfXCIrZmlkO1xyXG5cdFx0XHRcdGlmIChwLmxheWVyKSB7XHJcblx0XHRcdFx0XHQkLmpncmlkLmNyZWF0ZU1vZGFsKElEcyAsZmlsLHAsXCIjZ3ZpZXdfXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpLCQoXCIjZ2JveF9cIiskLmpncmlkLmpxSUQoJHQucC5pZCkpWzBdLCBcIiNcIiskLmpncmlkLmpxSUQocC5sYXllciksIHtwb3NpdGlvbjogXCJyZWxhdGl2ZVwifSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCQuamdyaWQuY3JlYXRlTW9kYWwoSURzICxmaWwscCxcIiNndmlld19cIiskLmpncmlkLmpxSUQoJHQucC5pZCksJChcIiNnYm94X1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKSlbMF0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAocC5zZWFyY2hPbkVudGVyIHx8IHAuY2xvc2VPbkVzY2FwZSkge1xyXG5cdFx0XHRcdFx0JChcIiNcIiskLmpncmlkLmpxSUQoSURzLnRoZW1vZGFsKSkua2V5ZG93bihmdW5jdGlvbiAoZSkge1xyXG5cdFx0XHRcdFx0XHR2YXIgJHRhcmdldCA9ICQoZS50YXJnZXQpO1xyXG5cdFx0XHRcdFx0XHRpZiAocC5zZWFyY2hPbkVudGVyICYmIGUud2hpY2ggPT09IDEzICYmIC8vIDEzID09PSAkLnVpLmtleUNvZGUuRU5URVJcclxuXHRcdFx0XHRcdFx0XHRcdCEkdGFyZ2V0Lmhhc0NsYXNzKCdhZGQtZ3JvdXAnKSAmJiAhJHRhcmdldC5oYXNDbGFzcygnYWRkLXJ1bGUnKSAmJlxyXG5cdFx0XHRcdFx0XHRcdFx0ISR0YXJnZXQuaGFzQ2xhc3MoJ2RlbGV0ZS1ncm91cCcpICYmICEkdGFyZ2V0Lmhhc0NsYXNzKCdkZWxldGUtcnVsZScpICYmXHJcblx0XHRcdFx0XHRcdFx0XHQoISR0YXJnZXQuaGFzQ2xhc3MoXCJmbS1idXR0b25cIikgfHwgISR0YXJnZXQuaXMoXCJbaWQkPV9xdWVyeV1cIikpKSB7XHJcblx0XHRcdFx0XHRcdFx0JChcIiNcIitmaWQrXCJfc2VhcmNoXCIpLmNsaWNrKCk7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmIChwLmNsb3NlT25Fc2NhcGUgJiYgZS53aGljaCA9PT0gMjcpIHsgLy8gMjcgPT09ICQudWkua2V5Q29kZS5FU0NBUEVcclxuXHRcdFx0XHRcdFx0XHQkKFwiI1wiKyQuamdyaWQuanFJRChJRHMubW9kYWxoZWFkKSkuZmluZChcIi51aS1qcWRpYWxvZy10aXRsZWJhci1jbG9zZVwiKS5jbGljaygpO1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKGJRKSB7XHJcblx0XHRcdFx0XHQkKFwiI1wiK2ZpZCtcIl9xdWVyeVwiKS5iaW5kKCdjbGljaycsIGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRcdCQoXCIucXVlcnlyZXN1bHRcIiwgZmlsKS50b2dnbGUoKTtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmIChwLnN0cmluZ1Jlc3VsdD09PXVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0Ly8gdG8gcHJvdmlkZSBiYWNrd2FyZCBjb21wYXRpYmlsaXR5LCBpbmZlcnJpbmcgc3RyaW5nUmVzdWx0IHZhbHVlIGZyb20gbXVsdGlwbGVTZWFyY2hcclxuXHRcdFx0XHRcdHAuc3RyaW5nUmVzdWx0ID0gcC5tdWx0aXBsZVNlYXJjaDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JChcIiNcIitmaWQrXCJfc2VhcmNoXCIpLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdHZhciBmbCA9ICQoXCIjXCIrZmlkKSwgc2RhdGE9e30sIHJlcywgZmlsdGVycztcclxuXHRcdFx0XHRcdGZsLmZpbmQoXCIuaW5wdXQtZWxtOmZvY3VzXCIpLmNoYW5nZSgpO1xyXG5cdFx0XHRcdFx0ZmlsdGVycyA9IGZsLmpxRmlsdGVyKCdmaWx0ZXJEYXRhJyk7XHJcblx0XHRcdFx0XHRpZihwLmVycm9yY2hlY2spIHtcclxuXHRcdFx0XHRcdFx0ZmxbMF0uaGlkZUVycm9yKCk7XHJcblx0XHRcdFx0XHRcdGlmKCFwLnNob3dRdWVyeSkge2ZsLmpxRmlsdGVyKCd0b1NRTFN0cmluZycpO31cclxuXHRcdFx0XHRcdFx0aWYoZmxbMF0ucC5lcnJvcikge1xyXG5cdFx0XHRcdFx0XHRcdGZsWzBdLnNob3dFcnJvcigpO1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdGlmKHAuc3RyaW5nUmVzdWx0KSB7XHJcblx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0Ly8geG1sSnNvbkNsYXNzIG9yIEpTT04uc3RyaW5naWZ5XHJcblx0XHRcdFx0XHRcdFx0cmVzID0geG1sSnNvbkNsYXNzLnRvSnNvbihmaWx0ZXJzLCAnJywgJycsIGZhbHNlKTtcclxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0XHRyZXMgPSBKU09OLnN0cmluZ2lmeShmaWx0ZXJzKTtcclxuXHRcdFx0XHRcdFx0XHR9IGNhdGNoIChlMikgeyB9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYodHlwZW9mIHJlcz09PVwic3RyaW5nXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRzZGF0YVtwLnNGaWx0ZXJdID0gcmVzO1xyXG5cdFx0XHRcdFx0XHRcdCQuZWFjaChbcC5zRmllbGQscC5zVmFsdWUsIHAuc09wZXJdLCBmdW5jdGlvbigpIHtzZGF0YVt0aGlzXSA9IFwiXCI7fSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdGlmKHAubXVsdGlwbGVTZWFyY2gpIHtcclxuXHRcdFx0XHRcdFx0XHRzZGF0YVtwLnNGaWx0ZXJdID0gZmlsdGVycztcclxuXHRcdFx0XHRcdFx0XHQkLmVhY2goW3Auc0ZpZWxkLHAuc1ZhbHVlLCBwLnNPcGVyXSwgZnVuY3Rpb24oKSB7c2RhdGFbdGhpc10gPSBcIlwiO30pO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHNkYXRhW3Auc0ZpZWxkXSA9IGZpbHRlcnMucnVsZXNbMF0uZmllbGQ7XHJcblx0XHRcdFx0XHRcdFx0c2RhdGFbcC5zVmFsdWVdID0gZmlsdGVycy5ydWxlc1swXS5kYXRhO1xyXG5cdFx0XHRcdFx0XHRcdHNkYXRhW3Auc09wZXJdID0gZmlsdGVycy5ydWxlc1swXS5vcDtcclxuXHRcdFx0XHRcdFx0XHRzZGF0YVtwLnNGaWx0ZXJdID0gXCJcIjtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0JHQucC5zZWFyY2ggPSB0cnVlO1xyXG5cdFx0XHRcdFx0JC5leHRlbmQoJHQucC5wb3N0RGF0YSxzZGF0YSk7XHJcblx0XHRcdFx0XHRtdXN0UmVsb2FkID0gJCgkdCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRGaWx0ZXJTZWFyY2hcIik7XHJcblx0XHRcdFx0XHRpZiggbXVzdFJlbG9hZCA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdG11c3RSZWxvYWQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYobXVzdFJlbG9hZCAmJiAkLmlzRnVuY3Rpb24ocC5vblNlYXJjaCkgKSB7XHJcblx0XHRcdFx0XHRcdG11c3RSZWxvYWQgPSBwLm9uU2VhcmNoLmNhbGwoJHQsICR0LnAuZmlsdGVycyk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAobXVzdFJlbG9hZCAhPT0gZmFsc2UpIHtcclxuXHRcdFx0XHRcdFx0JCgkdCkudHJpZ2dlcihcInJlbG9hZEdyaWRcIixbe3BhZ2U6MX1dKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKHAuY2xvc2VBZnRlclNlYXJjaCkge1xyXG5cdFx0XHRcdFx0XHQkLmpncmlkLmhpZGVNb2RhbChcIiNcIiskLmpncmlkLmpxSUQoSURzLnRoZW1vZGFsKSx7Z2I6XCIjZ2JveF9cIiskLmpncmlkLmpxSUQoJHQucC5pZCksanFtOnAuanFNb2RhbCxvbkNsb3NlOiBwLm9uQ2xvc2V9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHQkKFwiI1wiK2ZpZCtcIl9yZXNldFwiKS5iaW5kKCdjbGljaycsIGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHR2YXIgc2RhdGE9e30sXHJcblx0XHRcdFx0XHRmbCA9ICQoXCIjXCIrZmlkKTtcclxuXHRcdFx0XHRcdCR0LnAuc2VhcmNoID0gZmFsc2U7XHJcblx0XHRcdFx0XHQkdC5wLnJlc2V0c2VhcmNoID0gIHRydWU7XHJcblx0XHRcdFx0XHRpZihwLm11bHRpcGxlU2VhcmNoPT09ZmFsc2UpIHtcclxuXHRcdFx0XHRcdFx0c2RhdGFbcC5zRmllbGRdID0gc2RhdGFbcC5zVmFsdWVdID0gc2RhdGFbcC5zT3Blcl0gPSBcIlwiO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0c2RhdGFbcC5zRmlsdGVyXSA9IFwiXCI7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRmbFswXS5yZXNldEZpbHRlcigpO1xyXG5cdFx0XHRcdFx0aWYoZm91bmQpIHtcclxuXHRcdFx0XHRcdFx0JChcIi51aS10ZW1wbGF0ZVwiLCBmaWwpLnZhbChcImRlZmF1bHRcIik7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQkLmV4dGVuZCgkdC5wLnBvc3REYXRhLHNkYXRhKTtcclxuXHRcdFx0XHRcdG11c3RSZWxvYWQgPSAkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEZpbHRlclJlc2V0XCIpO1xyXG5cdFx0XHRcdFx0aWYobXVzdFJlbG9hZCA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdG11c3RSZWxvYWQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYobXVzdFJlbG9hZCAmJiAkLmlzRnVuY3Rpb24ocC5vblJlc2V0KSApIHtcclxuXHRcdFx0XHRcdFx0bXVzdFJlbG9hZCA9IHAub25SZXNldC5jYWxsKCR0KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKG11c3RSZWxvYWQgIT09IGZhbHNlKSB7XHJcblx0XHRcdFx0XHRcdCQoJHQpLnRyaWdnZXIoXCJyZWxvYWRHcmlkXCIsW3twYWdlOjF9XSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAocC5jbG9zZUFmdGVyUmVzZXQpIHtcclxuXHRcdFx0XHRcdFx0JC5qZ3JpZC5oaWRlTW9kYWwoXCIjXCIrJC5qZ3JpZC5qcUlEKElEcy50aGVtb2RhbCkse2diOlwiI2dib3hfXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpLGpxbTpwLmpxTW9kYWwsb25DbG9zZTogcC5vbkNsb3NlfSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0c2hvd0ZpbHRlcigkKFwiI1wiK2ZpZCkpO1xyXG5cdFx0XHRcdCQoXCIuZm0tYnV0dG9uOm5vdCgudWktc3RhdGUtZGlzYWJsZWQpXCIsZmlsKS5ob3ZlcihcclxuXHRcdFx0XHRcdGZ1bmN0aW9uKCl7JCh0aGlzKS5hZGRDbGFzcygndWktc3RhdGUtaG92ZXInKTt9LFxyXG5cdFx0XHRcdFx0ZnVuY3Rpb24oKXskKHRoaXMpLnJlbW92ZUNsYXNzKCd1aS1zdGF0ZS1ob3ZlcicpO31cclxuXHRcdFx0XHQpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdGVkaXRHcmlkUm93IDogZnVuY3Rpb24ocm93aWQsIHApe1xyXG5cdFx0cCA9ICQuZXh0ZW5kKHRydWUsIHtcclxuXHRcdFx0dG9wIDogMCxcclxuXHRcdFx0bGVmdDogMCxcclxuXHRcdFx0d2lkdGg6IDMwMCxcclxuXHRcdFx0ZGF0YXdpZHRoOiAnYXV0bycsXHJcblx0XHRcdGhlaWdodDogJ2F1dG8nLFxyXG5cdFx0XHRkYXRhaGVpZ2h0OiAnYXV0bycsXHJcblx0XHRcdG1vZGFsOiBmYWxzZSxcclxuXHRcdFx0b3ZlcmxheSA6IDMwLFxyXG5cdFx0XHRkcmFnOiB0cnVlLFxyXG5cdFx0XHRyZXNpemU6IHRydWUsXHJcblx0XHRcdHVybDogbnVsbCxcclxuXHRcdFx0bXR5cGUgOiBcIlBPU1RcIixcclxuXHRcdFx0Y2xlYXJBZnRlckFkZCA6dHJ1ZSxcclxuXHRcdFx0Y2xvc2VBZnRlckVkaXQgOiBmYWxzZSxcclxuXHRcdFx0cmVsb2FkQWZ0ZXJTdWJtaXQgOiB0cnVlLFxyXG5cdFx0XHRvbkluaXRpYWxpemVGb3JtOiBudWxsLFxyXG5cdFx0XHRiZWZvcmVJbml0RGF0YTogbnVsbCxcclxuXHRcdFx0YmVmb3JlU2hvd0Zvcm06IG51bGwsXHJcblx0XHRcdGFmdGVyU2hvd0Zvcm06IG51bGwsXHJcblx0XHRcdGJlZm9yZVN1Ym1pdDogbnVsbCxcclxuXHRcdFx0YWZ0ZXJTdWJtaXQ6IG51bGwsXHJcblx0XHRcdG9uY2xpY2tTdWJtaXQ6IG51bGwsXHJcblx0XHRcdGFmdGVyQ29tcGxldGU6IG51bGwsXHJcblx0XHRcdG9uY2xpY2tQZ0J1dHRvbnMgOiBudWxsLFxyXG5cdFx0XHRhZnRlcmNsaWNrUGdCdXR0b25zOiBudWxsLFxyXG5cdFx0XHRlZGl0RGF0YSA6IHt9LFxyXG5cdFx0XHRyZWNyZWF0ZUZvcm0gOiBmYWxzZSxcclxuXHRcdFx0anFNb2RhbCA6IHRydWUsXHJcblx0XHRcdGNsb3NlT25Fc2NhcGUgOiBmYWxzZSxcclxuXHRcdFx0YWRkZWRyb3cgOiBcImZpcnN0XCIsXHJcblx0XHRcdHRvcGluZm8gOiAnJyxcclxuXHRcdFx0Ym90dG9taW5mbzogJycsXHJcblx0XHRcdHNhdmVpY29uIDogW10sXHJcblx0XHRcdGNsb3NlaWNvbiA6IFtdLFxyXG5cdFx0XHRzYXZla2V5OiBbZmFsc2UsMTNdLFxyXG5cdFx0XHRuYXZrZXlzOiBbZmFsc2UsMzgsNDBdLFxyXG5cdFx0XHRjaGVja09uU3VibWl0IDogZmFsc2UsXHJcblx0XHRcdGNoZWNrT25VcGRhdGUgOiBmYWxzZSxcclxuXHRcdFx0X3NhdmVkRGF0YSA6IHt9LFxyXG5cdFx0XHRwcm9jZXNzaW5nIDogZmFsc2UsXHJcblx0XHRcdG9uQ2xvc2UgOiBudWxsLFxyXG5cdFx0XHRhamF4RWRpdE9wdGlvbnMgOiB7fSxcclxuXHRcdFx0c2VyaWFsaXplRWRpdERhdGEgOiBudWxsLFxyXG5cdFx0XHR2aWV3UGFnZXJCdXR0b25zIDogdHJ1ZSxcclxuXHRcdFx0b3ZlcmxheUNsYXNzIDogJ3VpLXdpZGdldC1vdmVybGF5J1xyXG5cdFx0fSwgJC5qZ3JpZC5lZGl0LCBwIHx8IHt9KTtcclxuXHRcdHJwX2dlWyQodGhpcylbMF0ucC5pZF0gPSBwO1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzO1xyXG5cdFx0XHRpZiAoISR0LmdyaWQgfHwgIXJvd2lkKSB7cmV0dXJuO31cclxuXHRcdFx0dmFyIGdJRCA9ICR0LnAuaWQsXHJcblx0XHRcdGZybWdyID0gXCJGcm1HcmlkX1wiK2dJRCwgZnJtdGJvcmcgPSBcIlRibEdyaWRfXCIrZ0lELCBmcm10YiA9IFwiI1wiKyQuamdyaWQuanFJRChmcm10Ym9yZyksXHJcblx0XHRcdElEcyA9IHt0aGVtb2RhbDonZWRpdG1vZCcrZ0lELG1vZGFsaGVhZDonZWRpdGhkJytnSUQsbW9kYWxjb250ZW50OidlZGl0Y250JytnSUQsIHNjcm9sbGVsbSA6IGZybWdyfSxcclxuXHRcdFx0b25CZWZvcmVTaG93ID0gJC5pc0Z1bmN0aW9uKHJwX2dlWyR0LnAuaWRdLmJlZm9yZVNob3dGb3JtKSA/IHJwX2dlWyR0LnAuaWRdLmJlZm9yZVNob3dGb3JtIDogZmFsc2UsXHJcblx0XHRcdG9uQWZ0ZXJTaG93ID0gJC5pc0Z1bmN0aW9uKHJwX2dlWyR0LnAuaWRdLmFmdGVyU2hvd0Zvcm0pID8gcnBfZ2VbJHQucC5pZF0uYWZ0ZXJTaG93Rm9ybSA6IGZhbHNlLFxyXG5cdFx0XHRvbkJlZm9yZUluaXQgPSAkLmlzRnVuY3Rpb24ocnBfZ2VbJHQucC5pZF0uYmVmb3JlSW5pdERhdGEpID8gcnBfZ2VbJHQucC5pZF0uYmVmb3JlSW5pdERhdGEgOiBmYWxzZSxcclxuXHRcdFx0b25Jbml0aWFsaXplRm9ybSA9ICQuaXNGdW5jdGlvbihycF9nZVskdC5wLmlkXS5vbkluaXRpYWxpemVGb3JtKSA/IHJwX2dlWyR0LnAuaWRdLm9uSW5pdGlhbGl6ZUZvcm0gOiBmYWxzZSxcclxuXHRcdFx0c2hvd0ZybSA9IHRydWUsXHJcblx0XHRcdG1heENvbHMgPSAxLCBtYXhSb3dzPTAsXHRwb3N0ZGF0YSwgZGlmZiwgZnJtb3BlcjtcclxuXHRcdFx0ZnJtZ3IgPSAkLmpncmlkLmpxSUQoZnJtZ3IpO1xyXG5cdFx0XHRpZiAocm93aWQgPT09IFwibmV3XCIpIHtcclxuXHRcdFx0XHRyb3dpZCA9IFwiX2VtcHR5XCI7XHJcblx0XHRcdFx0ZnJtb3BlciA9IFwiYWRkXCI7XHJcblx0XHRcdFx0cC5jYXB0aW9uPXJwX2dlWyR0LnAuaWRdLmFkZENhcHRpb247XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cC5jYXB0aW9uPXJwX2dlWyR0LnAuaWRdLmVkaXRDYXB0aW9uO1xyXG5cdFx0XHRcdGZybW9wZXIgPSBcImVkaXRcIjtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZighcC5yZWNyZWF0ZUZvcm0pIHtcclxuXHRcdFx0XHRpZiggJCgkdCkuZGF0YShcImZvcm1Qcm9wXCIpICkge1xyXG5cdFx0XHRcdFx0JC5leHRlbmQocnBfZ2VbJCh0aGlzKVswXS5wLmlkXSwgJCgkdCkuZGF0YShcImZvcm1Qcm9wXCIpKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIGNsb3Nlb3ZybCA9IHRydWU7XHJcblx0XHRcdGlmKHAuY2hlY2tPblVwZGF0ZSAmJiBwLmpxTW9kYWwgJiYgIXAubW9kYWwpIHtcclxuXHRcdFx0XHRjbG9zZW92cmwgPSBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiBnZXRGb3JtRGF0YSgpe1xyXG5cdFx0XHRcdCQoZnJtdGIrXCIgPiB0Ym9keSA+IHRyID4gdGQgPiAuRm9ybUVsZW1lbnRcIikuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHZhciBjZWxtID0gJChcIi5jdXN0b21lbGVtZW50XCIsIHRoaXMpO1xyXG5cdFx0XHRcdFx0aWYgKGNlbG0ubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdHZhciAgZWxlbSA9IGNlbG1bMF0sIG5tID0gJChlbGVtKS5hdHRyKCduYW1lJyk7XHJcblx0XHRcdFx0XHRcdCQuZWFjaCgkdC5wLmNvbE1vZGVsLCBmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0XHRcdGlmKHRoaXMubmFtZSA9PT0gbm0gJiYgdGhpcy5lZGl0b3B0aW9ucyAmJiAkLmlzRnVuY3Rpb24odGhpcy5lZGl0b3B0aW9ucy5jdXN0b21fdmFsdWUpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRwb3N0ZGF0YVtubV0gPSB0aGlzLmVkaXRvcHRpb25zLmN1c3RvbV92YWx1ZS5jYWxsKCR0LCAkKFwiI1wiKyQuamdyaWQuanFJRChubSksZnJtdGIpLCdnZXQnKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKHBvc3RkYXRhW25tXSA9PT0gdW5kZWZpbmVkKSB7dGhyb3cgXCJlMVwiO31cclxuXHRcdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGU9PT1cImUxXCIpIHskLmpncmlkLmluZm9fZGlhbG9nKCQuamdyaWQuZXJyb3JzLmVycmNhcCxcImZ1bmN0aW9uICdjdXN0b21fdmFsdWUnIFwiKyQuamdyaWQuZWRpdC5tc2cubm92YWx1ZSwkLmpncmlkLmVkaXQuYkNsb3NlKTt9XHJcblx0XHRcdFx0XHRcdFx0XHRcdGVsc2UgeyQuamdyaWQuaW5mb19kaWFsb2coJC5qZ3JpZC5lcnJvcnMuZXJyY2FwLGUubWVzc2FnZSwkLmpncmlkLmVkaXQuYkNsb3NlKTt9XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHN3aXRjaCAoJCh0aGlzKS5nZXQoMCkudHlwZSkge1xyXG5cdFx0XHRcdFx0XHRjYXNlIFwiY2hlY2tib3hcIjpcclxuXHRcdFx0XHRcdFx0XHRpZigkKHRoaXMpLmlzKFwiOmNoZWNrZWRcIikpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHBvc3RkYXRhW3RoaXMubmFtZV09ICQodGhpcykudmFsKCk7XHJcblx0XHRcdFx0XHRcdFx0fWVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIG9mdiA9ICQodGhpcykuYXR0cihcIm9mZnZhbFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdHBvc3RkYXRhW3RoaXMubmFtZV09IG9mdjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRjYXNlIFwic2VsZWN0LW9uZVwiOlxyXG5cdFx0XHRcdFx0XHRcdHBvc3RkYXRhW3RoaXMubmFtZV09ICQoXCJvcHRpb246c2VsZWN0ZWRcIix0aGlzKS52YWwoKTtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdGNhc2UgXCJzZWxlY3QtbXVsdGlwbGVcIjpcclxuXHRcdFx0XHRcdFx0XHRwb3N0ZGF0YVt0aGlzLm5hbWVdPSAkKHRoaXMpLnZhbCgpO1xyXG5cdFx0XHRcdFx0XHRcdGlmKHBvc3RkYXRhW3RoaXMubmFtZV0pIHtwb3N0ZGF0YVt0aGlzLm5hbWVdID0gcG9zdGRhdGFbdGhpcy5uYW1lXS5qb2luKFwiLFwiKTt9XHJcblx0XHRcdFx0XHRcdFx0ZWxzZSB7cG9zdGRhdGFbdGhpcy5uYW1lXSA9XCJcIjt9XHJcblx0XHRcdFx0XHRcdFx0dmFyIHNlbGVjdGVkVGV4dCA9IFtdO1xyXG5cdFx0XHRcdFx0XHRcdCQoXCJvcHRpb246c2VsZWN0ZWRcIix0aGlzKS5lYWNoKFxyXG5cdFx0XHRcdFx0XHRcdFx0ZnVuY3Rpb24oaSxzZWxlY3RlZCl7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNlbGVjdGVkVGV4dFtpXSA9ICQoc2VsZWN0ZWQpLnRleHQoKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0Y2FzZSBcInBhc3N3b3JkXCI6XHJcblx0XHRcdFx0XHRcdGNhc2UgXCJ0ZXh0XCI6XHJcblx0XHRcdFx0XHRcdGNhc2UgXCJ0ZXh0YXJlYVwiOlxyXG5cdFx0XHRcdFx0XHRjYXNlIFwiYnV0dG9uXCI6XHJcblx0XHRcdFx0XHRcdFx0cG9zdGRhdGFbdGhpcy5uYW1lXSA9ICQodGhpcykudmFsKCk7XHJcblxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKCR0LnAuYXV0b2VuY29kZSkge3Bvc3RkYXRhW3RoaXMubmFtZV0gPSAkLmpncmlkLmh0bWxFbmNvZGUocG9zdGRhdGFbdGhpcy5uYW1lXSk7fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIGNyZWF0ZURhdGEocm93aWQsb2JqLHRiLG1heGNvbHMpe1xyXG5cdFx0XHRcdHZhciBubSwgaGMsdHJkYXRhLCBjbnQ9MCx0bXAsIGRjLGVsYywgcmV0cG9zPVtdLCBpbmQ9ZmFsc2UsXHJcblx0XHRcdFx0dGR0bXBsID0gXCI8dGQgY2xhc3M9J0NhcHRpb25URCc+JiMxNjA7PC90ZD48dGQgY2xhc3M9J0RhdGFURCc+JiMxNjA7PC90ZD5cIiwgdG1wbD1cIlwiLCBpOyAvLyoyXHJcblx0XHRcdFx0Zm9yIChpID0xOyBpPD1tYXhjb2xzO2krKykge1xyXG5cdFx0XHRcdFx0dG1wbCArPSB0ZHRtcGw7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKHJvd2lkICE9PSAnX2VtcHR5Jykge1xyXG5cdFx0XHRcdFx0aW5kID0gJChvYmopLmpxR3JpZChcImdldEluZFwiLHJvd2lkKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JChvYmoucC5jb2xNb2RlbCkuZWFjaCggZnVuY3Rpb24oaSkge1xyXG5cdFx0XHRcdFx0bm0gPSB0aGlzLm5hbWU7XHJcblx0XHRcdFx0XHQvLyBoaWRkZW4gZmllbGRzIGFyZSBpbmNsdWRlZCBpbiB0aGUgZm9ybVxyXG5cdFx0XHRcdFx0aWYodGhpcy5lZGl0cnVsZXMgJiYgdGhpcy5lZGl0cnVsZXMuZWRpdGhpZGRlbiA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdFx0XHRoYyA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0aGMgPSB0aGlzLmhpZGRlbiA9PT0gdHJ1ZSA/IHRydWUgOiBmYWxzZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGRjID0gaGMgPyBcInN0eWxlPSdkaXNwbGF5Om5vbmUnXCIgOiBcIlwiO1xyXG5cdFx0XHRcdFx0aWYgKCBubSAhPT0gJ2NiJyAmJiBubSAhPT0gJ3N1YmdyaWQnICYmIHRoaXMuZWRpdGFibGU9PT10cnVlICYmIG5tICE9PSAncm4nKSB7XHJcblx0XHRcdFx0XHRcdGlmKGluZCA9PT0gZmFsc2UpIHtcclxuXHRcdFx0XHRcdFx0XHR0bXAgPSBcIlwiO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdGlmKG5tID09PSBvYmoucC5FeHBhbmRDb2x1bW4gJiYgb2JqLnAudHJlZUdyaWQgPT09IHRydWUpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHRtcCA9ICQoXCJ0ZFtyb2xlPSdncmlkY2VsbCddOmVxKFwiK2krXCIpXCIsb2JqLnJvd3NbaW5kXSkudGV4dCgpO1xyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXAgPSAgJC51bmZvcm1hdC5jYWxsKG9iaiwgJChcInRkW3JvbGU9J2dyaWRjZWxsJ106ZXEoXCIraStcIilcIixvYmoucm93c1tpbmRdKSx7cm93SWQ6cm93aWQsIGNvbE1vZGVsOnRoaXN9LGkpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoXykge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXAgPSAgKHRoaXMuZWRpdHR5cGUgJiYgdGhpcy5lZGl0dHlwZSA9PT0gXCJ0ZXh0YXJlYVwiKSA/ICQoXCJ0ZFtyb2xlPSdncmlkY2VsbCddOmVxKFwiK2krXCIpXCIsb2JqLnJvd3NbaW5kXSkudGV4dCgpIDogJChcInRkW3JvbGU9J2dyaWRjZWxsJ106ZXEoXCIraStcIilcIixvYmoucm93c1tpbmRdKS5odG1sKCk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRpZighdG1wIHx8IHRtcCA9PT0gXCImbmJzcDtcIiB8fCB0bXAgPT09IFwiJiMxNjA7XCIgfHwgKHRtcC5sZW5ndGg9PT0xICYmIHRtcC5jaGFyQ29kZUF0KDApPT09MTYwKSApIHt0bXA9Jyc7fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR2YXIgb3B0ID0gJC5leHRlbmQoe30sIHRoaXMuZWRpdG9wdGlvbnMgfHwge30gLHtpZDpubSxuYW1lOm5tfSksXHJcblx0XHRcdFx0XHRcdGZybW9wdCA9ICQuZXh0ZW5kKHt9LCB7ZWxtcHJlZml4OicnLGVsbXN1ZmZpeDonJyxyb3dhYm92ZTpmYWxzZSxyb3djb250ZW50OicnfSwgdGhpcy5mb3Jtb3B0aW9ucyB8fCB7fSksXHJcblx0XHRcdFx0XHRcdHJwID0gcGFyc2VJbnQoZnJtb3B0LnJvd3BvcywxMCkgfHwgY250KzEsXHJcblx0XHRcdFx0XHRcdGNwID0gcGFyc2VJbnQoKHBhcnNlSW50KGZybW9wdC5jb2xwb3MsMTApIHx8IDEpKjIsMTApO1xyXG5cdFx0XHRcdFx0XHRpZihyb3dpZCA9PT0gXCJfZW1wdHlcIiAmJiBvcHQuZGVmYXVsdFZhbHVlICkge1xyXG5cdFx0XHRcdFx0XHRcdHRtcCA9ICQuaXNGdW5jdGlvbihvcHQuZGVmYXVsdFZhbHVlKSA/IG9wdC5kZWZhdWx0VmFsdWUuY2FsbCgkdCkgOiBvcHQuZGVmYXVsdFZhbHVlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmKCF0aGlzLmVkaXR0eXBlKSB7dGhpcy5lZGl0dHlwZSA9IFwidGV4dFwiO31cclxuXHRcdFx0XHRcdFx0aWYoJHQucC5hdXRvZW5jb2RlKSB7dG1wID0gJC5qZ3JpZC5odG1sRGVjb2RlKHRtcCk7fVxyXG5cdFx0XHRcdFx0XHRlbGMgPSAkLmpncmlkLmNyZWF0ZUVsLmNhbGwoJHQsdGhpcy5lZGl0dHlwZSxvcHQsdG1wLGZhbHNlLCQuZXh0ZW5kKHt9LCQuamdyaWQuYWpheE9wdGlvbnMsb2JqLnAuYWpheFNlbGVjdE9wdGlvbnMgfHwge30pKTtcclxuXHRcdFx0XHRcdFx0Ly9pZih0bXAgPT09IFwiXCIgJiYgdGhpcy5lZGl0dHlwZSA9PSBcImNoZWNrYm94XCIpIHt0bXAgPSAkKGVsYykuYXR0cihcIm9mZnZhbFwiKTt9XHJcblx0XHRcdFx0XHRcdC8vaWYodG1wID09PSBcIlwiICYmIHRoaXMuZWRpdHR5cGUgPT0gXCJzZWxlY3RcIikge3RtcCA9ICQoXCJvcHRpb246ZXEoMClcIixlbGMpLnRleHQoKTt9XHJcblx0XHRcdFx0XHRcdGlmKHJwX2dlWyR0LnAuaWRdLmNoZWNrT25TdWJtaXQgfHwgcnBfZ2VbJHQucC5pZF0uY2hlY2tPblVwZGF0ZSkge3JwX2dlWyR0LnAuaWRdLl9zYXZlZERhdGFbbm1dID0gdG1wO31cclxuXHRcdFx0XHRcdFx0JChlbGMpLmFkZENsYXNzKFwiRm9ybUVsZW1lbnRcIik7XHJcblx0XHRcdFx0XHRcdGlmKCAkLmluQXJyYXkodGhpcy5lZGl0dHlwZSwgWyd0ZXh0JywndGV4dGFyZWEnLCdwYXNzd29yZCcsJ3NlbGVjdCddKSA+IC0xKSB7XHJcblx0XHRcdFx0XHRcdFx0JChlbGMpLmFkZENsYXNzKFwidWktd2lkZ2V0LWNvbnRlbnQgdWktY29ybmVyLWFsbFwiKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR0cmRhdGEgPSAkKHRiKS5maW5kKFwidHJbcm93cG9zPVwiK3JwK1wiXVwiKTtcclxuXHRcdFx0XHRcdFx0aWYoZnJtb3B0LnJvd2Fib3ZlKSB7XHJcblx0XHRcdFx0XHRcdFx0dmFyIG5ld2RhdGEgPSAkKFwiPHRyPjx0ZCBjbGFzcz0nY29udGVudGluZm8nIGNvbHNwYW49J1wiKyhtYXhjb2xzKjIpK1wiJz5cIitmcm1vcHQucm93Y29udGVudCtcIjwvdGQ+PC90cj5cIik7XHJcblx0XHRcdFx0XHRcdFx0JCh0YikuYXBwZW5kKG5ld2RhdGEpO1xyXG5cdFx0XHRcdFx0XHRcdG5ld2RhdGFbMF0ucnAgPSBycDtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZiAoIHRyZGF0YS5sZW5ndGg9PT0wICkge1xyXG5cdFx0XHRcdFx0XHRcdHRyZGF0YSA9ICQoXCI8dHIgXCIrZGMrXCIgcm93cG9zPSdcIitycCtcIic+PC90cj5cIikuYWRkQ2xhc3MoXCJGb3JtRGF0YVwiKS5hdHRyKFwiaWRcIixcInRyX1wiK25tKTtcclxuXHRcdFx0XHRcdFx0XHQkKHRyZGF0YSkuYXBwZW5kKHRtcGwpO1xyXG5cdFx0XHRcdFx0XHRcdCQodGIpLmFwcGVuZCh0cmRhdGEpO1xyXG5cdFx0XHRcdFx0XHRcdHRyZGF0YVswXS5ycCA9IHJwO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdCQoXCJ0ZDplcShcIisoY3AtMikrXCIpXCIsdHJkYXRhWzBdKS5odG1sKGZybW9wdC5sYWJlbCA9PT0gdW5kZWZpbmVkID8gb2JqLnAuY29sTmFtZXNbaV06IGZybW9wdC5sYWJlbCk7XHJcblx0XHRcdFx0XHRcdCQoXCJ0ZDplcShcIisoY3AtMSkrXCIpXCIsdHJkYXRhWzBdKS5hcHBlbmQoZnJtb3B0LmVsbXByZWZpeCkuYXBwZW5kKGVsYykuYXBwZW5kKGZybW9wdC5lbG1zdWZmaXgpO1xyXG5cdFx0XHRcdFx0XHRpZih0aGlzLmVkaXR0eXBlPT09J2N1c3RvbScgJiYgJC5pc0Z1bmN0aW9uKG9wdC5jdXN0b21fdmFsdWUpICkge1xyXG5cdFx0XHRcdFx0XHRcdG9wdC5jdXN0b21fdmFsdWUuY2FsbCgkdCwgJChcIiNcIitubSxcIiNcIitmcm1nciksJ3NldCcsdG1wKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHQkLmpncmlkLmJpbmRFdi5jYWxsKCR0LCBlbGMsIG9wdCk7XHJcblx0XHRcdFx0XHRcdHJldHBvc1tjbnRdID0gaTtcclxuXHRcdFx0XHRcdFx0Y250Kys7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aWYoIGNudCA+IDApIHtcclxuXHRcdFx0XHRcdHZhciBpZHJvdyA9ICQoXCI8dHIgY2xhc3M9J0Zvcm1EYXRhJyBzdHlsZT0nZGlzcGxheTpub25lJz48dGQgY2xhc3M9J0NhcHRpb25URCc+PC90ZD48dGQgY29sc3Bhbj0nXCIrIChtYXhjb2xzKjItMSkrXCInIGNsYXNzPSdEYXRhVEQnPjxpbnB1dCBjbGFzcz0nRm9ybUVsZW1lbnQnIGlkPSdpZF9nJyB0eXBlPSd0ZXh0JyBuYW1lPSdcIitvYmoucC5pZCtcIl9pZCcgdmFsdWU9J1wiK3Jvd2lkK1wiJy8+PC90ZD48L3RyPlwiKTtcclxuXHRcdFx0XHRcdGlkcm93WzBdLnJwID0gY250Kzk5OTtcclxuXHRcdFx0XHRcdCQodGIpLmFwcGVuZChpZHJvdyk7XHJcblx0XHRcdFx0XHRpZihycF9nZVskdC5wLmlkXS5jaGVja09uU3VibWl0IHx8IHJwX2dlWyR0LnAuaWRdLmNoZWNrT25VcGRhdGUpIHtycF9nZVskdC5wLmlkXS5fc2F2ZWREYXRhW29iai5wLmlkK1wiX2lkXCJdID0gcm93aWQ7fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gcmV0cG9zO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIGZpbGxEYXRhKHJvd2lkLG9iaixmbWlkKXtcclxuXHRcdFx0XHR2YXIgbm0sY250PTAsdG1wLCBmbGQsb3B0LHZsLHZsYztcclxuXHRcdFx0XHRpZihycF9nZVskdC5wLmlkXS5jaGVja09uU3VibWl0IHx8IHJwX2dlWyR0LnAuaWRdLmNoZWNrT25VcGRhdGUpIHtycF9nZVskdC5wLmlkXS5fc2F2ZWREYXRhID0ge307cnBfZ2VbJHQucC5pZF0uX3NhdmVkRGF0YVtvYmoucC5pZCtcIl9pZFwiXT1yb3dpZDt9XHJcblx0XHRcdFx0dmFyIGNtID0gb2JqLnAuY29sTW9kZWw7XHJcblx0XHRcdFx0aWYocm93aWQgPT09ICdfZW1wdHknKSB7XHJcblx0XHRcdFx0XHQkKGNtKS5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRcdG5tID0gdGhpcy5uYW1lO1xyXG5cdFx0XHRcdFx0XHRvcHQgPSAkLmV4dGVuZCh7fSwgdGhpcy5lZGl0b3B0aW9ucyB8fCB7fSApO1xyXG5cdFx0XHRcdFx0XHRmbGQgPSAkKFwiI1wiKyQuamdyaWQuanFJRChubSksXCIjXCIrZm1pZCk7XHJcblx0XHRcdFx0XHRcdGlmKGZsZCAmJiBmbGQubGVuZ3RoICYmIGZsZFswXSAhPT0gbnVsbCkge1xyXG5cdFx0XHRcdFx0XHRcdHZsID0gXCJcIjtcclxuXHRcdFx0XHRcdFx0XHRpZih0aGlzLmVkaXR0eXBlID09PSAnY3VzdG9tJyAmJiAkLmlzRnVuY3Rpb24ob3B0LmN1c3RvbV92YWx1ZSkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdG9wdC5jdXN0b21fdmFsdWUuY2FsbCgkdCwgJChcIiNcIitubSxcIiNcIitmbWlkKSwnc2V0Jyx2bCk7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmKG9wdC5kZWZhdWx0VmFsdWUgKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR2bCA9ICQuaXNGdW5jdGlvbihvcHQuZGVmYXVsdFZhbHVlKSA/IG9wdC5kZWZhdWx0VmFsdWUuY2FsbCgkdCkgOiBvcHQuZGVmYXVsdFZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoZmxkWzBdLnR5cGU9PT0nY2hlY2tib3gnKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZsYyA9IHZsLnRvTG93ZXJDYXNlKCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKHZsYy5zZWFyY2goLyhmYWxzZXxmfDB8bm98bnxvZmZ8dW5kZWZpbmVkKS9pKTwwICYmIHZsYyE9PVwiXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRmbGRbMF0uY2hlY2tlZCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZmxkWzBdLmRlZmF1bHRDaGVja2VkID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRmbGRbMF0udmFsdWUgPSB2bDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRmbGRbMF0uY2hlY2tlZCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGZsZFswXS5kZWZhdWx0Q2hlY2tlZCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge2ZsZC52YWwodmwpO31cclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoIGZsZFswXS50eXBlPT09J2NoZWNrYm94JyApIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZmxkWzBdLmNoZWNrZWQgPSBmYWxzZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZmxkWzBdLmRlZmF1bHRDaGVja2VkID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZsID0gJChmbGQpLmF0dHIoXCJvZmZ2YWxcIik7XHJcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGZsZFswXS50eXBlICYmIGZsZFswXS50eXBlLnN1YnN0cigwLDYpPT09J3NlbGVjdCcpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZmxkWzBdLnNlbGVjdGVkSW5kZXggPSAwO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZmxkLnZhbCh2bCk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdGlmKHJwX2dlWyR0LnAuaWRdLmNoZWNrT25TdWJtaXQ9PT10cnVlIHx8IHJwX2dlWyR0LnAuaWRdLmNoZWNrT25VcGRhdGUpIHtycF9nZVskdC5wLmlkXS5fc2F2ZWREYXRhW25tXSA9IHZsO31cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHQkKFwiI2lkX2dcIixcIiNcIitmbWlkKS52YWwocm93aWQpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR2YXIgdHJlID0gJChvYmopLmpxR3JpZChcImdldEluZFwiLHJvd2lkLHRydWUpO1xyXG5cdFx0XHRcdGlmKCF0cmUpIHtyZXR1cm47fVxyXG5cdFx0XHRcdCQoJ3RkW3JvbGU9XCJncmlkY2VsbFwiXScsdHJlKS5lYWNoKCBmdW5jdGlvbihpKSB7XHJcblx0XHRcdFx0XHRubSA9IGNtW2ldLm5hbWU7XHJcblx0XHRcdFx0XHQvLyBoaWRkZW4gZmllbGRzIGFyZSBpbmNsdWRlZCBpbiB0aGUgZm9ybVxyXG5cdFx0XHRcdFx0aWYgKCBubSAhPT0gJ2NiJyAmJiBubSAhPT0gJ3N1YmdyaWQnICYmIG5tICE9PSAncm4nICYmIGNtW2ldLmVkaXRhYmxlPT09dHJ1ZSkge1xyXG5cdFx0XHRcdFx0XHRpZihubSA9PT0gb2JqLnAuRXhwYW5kQ29sdW1uICYmIG9iai5wLnRyZWVHcmlkID09PSB0cnVlKSB7XHJcblx0XHRcdFx0XHRcdFx0dG1wID0gJCh0aGlzKS50ZXh0KCk7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0XHRcdHRtcCA9ICAkLnVuZm9ybWF0LmNhbGwob2JqLCAkKHRoaXMpLHtyb3dJZDpyb3dpZCwgY29sTW9kZWw6Y21baV19LGkpO1xyXG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKF8pIHtcclxuXHRcdFx0XHRcdFx0XHRcdHRtcCA9IGNtW2ldLmVkaXR0eXBlPT09XCJ0ZXh0YXJlYVwiID8gJCh0aGlzKS50ZXh0KCkgOiAkKHRoaXMpLmh0bWwoKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYoJHQucC5hdXRvZW5jb2RlKSB7dG1wID0gJC5qZ3JpZC5odG1sRGVjb2RlKHRtcCk7fVxyXG5cdFx0XHRcdFx0XHRpZihycF9nZVskdC5wLmlkXS5jaGVja09uU3VibWl0PT09dHJ1ZSB8fCBycF9nZVskdC5wLmlkXS5jaGVja09uVXBkYXRlKSB7cnBfZ2VbJHQucC5pZF0uX3NhdmVkRGF0YVtubV0gPSB0bXA7fVxyXG5cdFx0XHRcdFx0XHRubSA9ICQuamdyaWQuanFJRChubSk7XHJcblx0XHRcdFx0XHRcdHN3aXRjaCAoY21baV0uZWRpdHR5cGUpIHtcclxuXHRcdFx0XHRcdFx0XHRjYXNlIFwicGFzc3dvcmRcIjpcclxuXHRcdFx0XHRcdFx0XHRjYXNlIFwidGV4dFwiOlxyXG5cdFx0XHRcdFx0XHRcdGNhc2UgXCJidXR0b25cIiA6XHJcblx0XHRcdFx0XHRcdFx0Y2FzZSBcImltYWdlXCI6XHJcblx0XHRcdFx0XHRcdFx0Y2FzZSBcInRleHRhcmVhXCI6XHJcblx0XHRcdFx0XHRcdFx0XHRpZih0bXAgPT09IFwiJm5ic3A7XCIgfHwgdG1wID09PSBcIiYjMTYwO1wiIHx8ICh0bXAubGVuZ3RoPT09MSAmJiB0bXAuY2hhckNvZGVBdCgwKT09PTE2MCkgKSB7dG1wPScnO31cclxuXHRcdFx0XHRcdFx0XHRcdCQoXCIjXCIrbm0sXCIjXCIrZm1pZCkudmFsKHRtcCk7XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRjYXNlIFwic2VsZWN0XCI6XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgb3B2ID0gdG1wLnNwbGl0KFwiLFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdG9wdiA9ICQubWFwKG9wdixmdW5jdGlvbihuKXtyZXR1cm4gJC50cmltKG4pO30pO1xyXG5cdFx0XHRcdFx0XHRcdFx0JChcIiNcIitubStcIiBvcHRpb25cIixcIiNcIitmbWlkKS5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmICghY21baV0uZWRpdG9wdGlvbnMubXVsdGlwbGUgJiYgKCQudHJpbSh0bXApID09PSAkLnRyaW0oJCh0aGlzKS50ZXh0KCkpIHx8IG9wdlswXSA9PT0gJC50cmltKCQodGhpcykudGV4dCgpKSB8fCBvcHZbMF0gPT09ICQudHJpbSgkKHRoaXMpLnZhbCgpKSkgKXtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnNlbGVjdGVkPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGNtW2ldLmVkaXRvcHRpb25zLm11bHRpcGxlKXtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggICQuaW5BcnJheSgkLnRyaW0oJCh0aGlzKS50ZXh0KCkpLCBvcHYgKSA+IC0xIHx8ICQuaW5BcnJheSgkLnRyaW0oJCh0aGlzKS52YWwoKSksIG9wdiApID4gLTEgICl7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnNlbGVjdGVkID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuc2VsZWN0ZWQgPSBmYWxzZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5zZWxlY3RlZCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdGNhc2UgXCJjaGVja2JveFwiOlxyXG5cdFx0XHRcdFx0XHRcdFx0dG1wID0gU3RyaW5nKHRtcCk7XHJcblx0XHRcdFx0XHRcdFx0XHRpZihjbVtpXS5lZGl0b3B0aW9ucyAmJiBjbVtpXS5lZGl0b3B0aW9ucy52YWx1ZSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgY2IgPSBjbVtpXS5lZGl0b3B0aW9ucy52YWx1ZS5zcGxpdChcIjpcIik7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKGNiWzBdID09PSB0bXApIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQkKFwiI1wiK25tLFwiI1wiK2ZtaWQpWyR0LnAudXNlUHJvcCA/ICdwcm9wJzogJ2F0dHInXSh7XCJjaGVja2VkXCI6dHJ1ZSwgXCJkZWZhdWx0Q2hlY2tlZFwiIDogdHJ1ZX0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCQoXCIjXCIrbm0sXCIjXCIrZm1pZClbJHQucC51c2VQcm9wID8gJ3Byb3AnOiAnYXR0ciddKHtcImNoZWNrZWRcIjpmYWxzZSwgXCJkZWZhdWx0Q2hlY2tlZFwiIDogZmFsc2V9KTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1wID0gdG1wLnRvTG93ZXJDYXNlKCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKHRtcC5zZWFyY2goLyhmYWxzZXxmfDB8bm98bnxvZmZ8dW5kZWZpbmVkKS9pKTwwICYmIHRtcCE9PVwiXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQkKFwiI1wiK25tLFwiI1wiK2ZtaWQpWyR0LnAudXNlUHJvcCA/ICdwcm9wJzogJ2F0dHInXShcImNoZWNrZWRcIix0cnVlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQkKFwiI1wiK25tLFwiI1wiK2ZtaWQpWyR0LnAudXNlUHJvcCA/ICdwcm9wJzogJ2F0dHInXShcImRlZmF1bHRDaGVja2VkXCIsdHJ1ZSk7IC8vaWVcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQkKFwiI1wiK25tLFwiI1wiK2ZtaWQpWyR0LnAudXNlUHJvcCA/ICdwcm9wJzogJ2F0dHInXShcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCQoXCIjXCIrbm0sXCIjXCIrZm1pZClbJHQucC51c2VQcm9wID8gJ3Byb3AnOiAnYXR0ciddKFwiZGVmYXVsdENoZWNrZWRcIiwgZmFsc2UpOyAvL2llXHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdGNhc2UgJ2N1c3RvbScgOlxyXG5cdFx0XHRcdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYoY21baV0uZWRpdG9wdGlvbnMgJiYgJC5pc0Z1bmN0aW9uKGNtW2ldLmVkaXRvcHRpb25zLmN1c3RvbV92YWx1ZSkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjbVtpXS5lZGl0b3B0aW9ucy5jdXN0b21fdmFsdWUuY2FsbCgkdCwgJChcIiNcIitubSxcIiNcIitmbWlkKSwnc2V0Jyx0bXApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge3Rocm93IFwiZTFcIjt9XHJcblx0XHRcdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChlPT09XCJlMVwiKSB7JC5qZ3JpZC5pbmZvX2RpYWxvZygkLmpncmlkLmVycm9ycy5lcnJjYXAsXCJmdW5jdGlvbiAnY3VzdG9tX3ZhbHVlJyBcIiskLmpncmlkLmVkaXQubXNnLm5vZGVmaW5lZCwkLmpncmlkLmVkaXQuYkNsb3NlKTt9XHJcblx0XHRcdFx0XHRcdFx0XHRcdGVsc2UgeyQuamdyaWQuaW5mb19kaWFsb2coJC5qZ3JpZC5lcnJvcnMuZXJyY2FwLGUubWVzc2FnZSwkLmpncmlkLmVkaXQuYkNsb3NlKTt9XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRjbnQrKztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRpZihjbnQ+MCkgeyQoXCIjaWRfZ1wiLGZybXRiKS52YWwocm93aWQpO31cclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiBzZXROdWxscygpIHtcclxuXHRcdFx0XHQkLmVhY2goJHQucC5jb2xNb2RlbCwgZnVuY3Rpb24oaSxuKXtcclxuXHRcdFx0XHRcdGlmKG4uZWRpdG9wdGlvbnMgJiYgbi5lZGl0b3B0aW9ucy5OdWxsSWZFbXB0eSA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdFx0XHRpZihwb3N0ZGF0YS5oYXNPd25Qcm9wZXJ0eShuLm5hbWUpICYmIHBvc3RkYXRhW24ubmFtZV0gPT09IFwiXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRwb3N0ZGF0YVtuLm5hbWVdID0gJ251bGwnO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gcG9zdEl0KCkge1xyXG5cdFx0XHRcdHZhciBjb3B5ZGF0YSwgcmV0PVt0cnVlLFwiXCIsXCJcIl0sIG9uQ1MgPSB7fSwgb3BlcnMgPSAkdC5wLnBybU5hbWVzLCBpZG5hbWUsIG9wZXIsIGtleSwgc2VsciwgaTtcclxuXHJcblx0XHRcdFx0dmFyIHJldHZhbHMgPSAkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEFkZEVkaXRCZWZvcmVDaGVja1ZhbHVlc1wiLCBbJChcIiNcIitmcm1nciksIGZybW9wZXJdKTtcclxuXHRcdFx0XHRpZihyZXR2YWxzICYmIHR5cGVvZiByZXR2YWxzID09PSAnb2JqZWN0Jykge3Bvc3RkYXRhID0gcmV0dmFsczt9XHJcblxyXG5cdFx0XHRcdGlmKCQuaXNGdW5jdGlvbihycF9nZVskdC5wLmlkXS5iZWZvcmVDaGVja1ZhbHVlcykpIHtcclxuXHRcdFx0XHRcdHJldHZhbHMgPSBycF9nZVskdC5wLmlkXS5iZWZvcmVDaGVja1ZhbHVlcy5jYWxsKCR0LCBwb3N0ZGF0YSwkKFwiI1wiK2ZybWdyKSxmcm1vcGVyKTtcclxuXHRcdFx0XHRcdGlmKHJldHZhbHMgJiYgdHlwZW9mIHJldHZhbHMgPT09ICdvYmplY3QnKSB7cG9zdGRhdGEgPSByZXR2YWxzO31cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Zm9yKCBrZXkgaW4gcG9zdGRhdGEgKXtcclxuXHRcdFx0XHRcdGlmKHBvc3RkYXRhLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuXHRcdFx0XHRcdFx0cmV0ID0gJC5qZ3JpZC5jaGVja1ZhbHVlcy5jYWxsKCR0LHBvc3RkYXRhW2tleV0sa2V5KTtcclxuXHRcdFx0XHRcdFx0aWYocmV0WzBdID09PSBmYWxzZSkge2JyZWFrO31cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0c2V0TnVsbHMoKTtcclxuXHRcdFx0XHRpZihyZXRbMF0pIHtcclxuXHRcdFx0XHRcdG9uQ1MgPSAkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEFkZEVkaXRDbGlja1N1Ym1pdFwiLCBbcnBfZ2VbJHQucC5pZF0sIHBvc3RkYXRhLCBmcm1vcGVyXSk7XHJcblx0XHRcdFx0XHRpZiggb25DUyA9PT0gdW5kZWZpbmVkICYmICQuaXNGdW5jdGlvbiggcnBfZ2VbJHQucC5pZF0ub25jbGlja1N1Ym1pdCkpIHtcclxuXHRcdFx0XHRcdFx0b25DUyA9IHJwX2dlWyR0LnAuaWRdLm9uY2xpY2tTdWJtaXQuY2FsbCgkdCwgcnBfZ2VbJHQucC5pZF0sIHBvc3RkYXRhLCBmcm1vcGVyKSB8fCB7fTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJldCA9ICQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWRkRWRpdEJlZm9yZVN1Ym1pdFwiLCBbcG9zdGRhdGEsICQoXCIjXCIrZnJtZ3IpLCBmcm1vcGVyXSk7XHJcblx0XHRcdFx0XHRpZihyZXQgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0XHRyZXQgPSBbdHJ1ZSxcIlwiLFwiXCJdO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYoIHJldFswXSAmJiAkLmlzRnVuY3Rpb24ocnBfZ2VbJHQucC5pZF0uYmVmb3JlU3VibWl0KSkgIHtcclxuXHRcdFx0XHRcdFx0cmV0ID0gcnBfZ2VbJHQucC5pZF0uYmVmb3JlU3VibWl0LmNhbGwoJHQscG9zdGRhdGEsJChcIiNcIitmcm1nciksIGZybW9wZXIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYocmV0WzBdICYmICFycF9nZVskdC5wLmlkXS5wcm9jZXNzaW5nKSB7XHJcblx0XHRcdFx0XHRycF9nZVskdC5wLmlkXS5wcm9jZXNzaW5nID0gdHJ1ZTtcclxuXHRcdFx0XHRcdCQoXCIjc0RhdGFcIiwgZnJtdGIrXCJfMlwiKS5hZGRDbGFzcygndWktc3RhdGUtYWN0aXZlJyk7XHJcblx0XHRcdFx0XHRvcGVyID0gb3BlcnMub3BlcjtcclxuXHRcdFx0XHRcdGlkbmFtZSA9IG9wZXJzLmlkO1xyXG5cdFx0XHRcdFx0Ly8gd2UgYWRkIHRvIHBvcyBkYXRhIGFycmF5IHRoZSBhY3Rpb24gLSB0aGUgbmFtZSBpcyBvcGVyXHJcblx0XHRcdFx0XHRwb3N0ZGF0YVtvcGVyXSA9ICgkLnRyaW0ocG9zdGRhdGFbJHQucC5pZCtcIl9pZFwiXSkgPT09IFwiX2VtcHR5XCIpID8gb3BlcnMuYWRkb3BlciA6IG9wZXJzLmVkaXRvcGVyO1xyXG5cdFx0XHRcdFx0aWYocG9zdGRhdGFbb3Blcl0gIT09IG9wZXJzLmFkZG9wZXIpIHtcclxuXHRcdFx0XHRcdFx0cG9zdGRhdGFbaWRuYW1lXSA9IHBvc3RkYXRhWyR0LnAuaWQrXCJfaWRcIl07XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQvLyBjaGVjayB0byBzZWUgaWYgd2UgaGF2ZSBhbGxyZWR5IHRoaXMgZmllbGQgaW4gdGhlIGZvcm0gYW5kIGlmIHllcyBsaWV2ZSBpdFxyXG5cdFx0XHRcdFx0XHRpZiggcG9zdGRhdGFbaWRuYW1lXSA9PT0gdW5kZWZpbmVkICkge3Bvc3RkYXRhW2lkbmFtZV0gPSBwb3N0ZGF0YVskdC5wLmlkK1wiX2lkXCJdO31cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGRlbGV0ZSBwb3N0ZGF0YVskdC5wLmlkK1wiX2lkXCJdO1xyXG5cdFx0XHRcdFx0cG9zdGRhdGEgPSAkLmV4dGVuZChwb3N0ZGF0YSxycF9nZVskdC5wLmlkXS5lZGl0RGF0YSxvbkNTKTtcclxuXHRcdFx0XHRcdGlmKCR0LnAudHJlZUdyaWQgPT09IHRydWUpICB7XHJcblx0XHRcdFx0XHRcdGlmKHBvc3RkYXRhW29wZXJdID09PSBvcGVycy5hZGRvcGVyKSB7XHJcblx0XHRcdFx0XHRcdHNlbHIgPSAkKCR0KS5qcUdyaWQoXCJnZXRHcmlkUGFyYW1cIiwgJ3NlbHJvdycpO1xyXG5cdFx0XHRcdFx0XHRcdHZhciB0cl9wYXJfaWQgPSAkdC5wLnRyZWVHcmlkTW9kZWwgPT09ICdhZGphY2VuY3knID8gJHQucC50cmVlUmVhZGVyLnBhcmVudF9pZF9maWVsZCA6ICdwYXJlbnRfaWQnO1xyXG5cdFx0XHRcdFx0XHRcdHBvc3RkYXRhW3RyX3Bhcl9pZF0gPSBzZWxyO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGZvcihpIGluICR0LnAudHJlZVJlYWRlcil7XHJcblx0XHRcdFx0XHRcdFx0aWYoJHQucC50cmVlUmVhZGVyLmhhc093blByb3BlcnR5KGkpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgaXRtID0gJHQucC50cmVlUmVhZGVyW2ldO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYocG9zdGRhdGEuaGFzT3duUHJvcGVydHkoaXRtKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZihwb3N0ZGF0YVtvcGVyXSA9PT0gb3BlcnMuYWRkb3BlciAmJiBpID09PSAncGFyZW50X2lkX2ZpZWxkJykge2NvbnRpbnVlO31cclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVsZXRlIHBvc3RkYXRhW2l0bV07XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0cG9zdGRhdGFbaWRuYW1lXSA9ICQuamdyaWQuc3RyaXBQcmVmKCR0LnAuaWRQcmVmaXgsIHBvc3RkYXRhW2lkbmFtZV0pO1xyXG5cdFx0XHRcdFx0dmFyIGFqYXhPcHRpb25zID0gJC5leHRlbmQoe1xyXG5cdFx0XHRcdFx0XHR1cmw6IHJwX2dlWyR0LnAuaWRdLnVybCB8fCAkKCR0KS5qcUdyaWQoJ2dldEdyaWRQYXJhbScsJ2VkaXR1cmwnKSxcclxuXHRcdFx0XHRcdFx0dHlwZTogcnBfZ2VbJHQucC5pZF0ubXR5cGUsXHJcblx0XHRcdFx0XHRcdGRhdGE6ICQuaXNGdW5jdGlvbihycF9nZVskdC5wLmlkXS5zZXJpYWxpemVFZGl0RGF0YSkgPyBycF9nZVskdC5wLmlkXS5zZXJpYWxpemVFZGl0RGF0YS5jYWxsKCR0LHBvc3RkYXRhKSA6ICBwb3N0ZGF0YSxcclxuXHRcdFx0XHRcdFx0Y29tcGxldGU6ZnVuY3Rpb24oZGF0YSxzdGF0dXMpe1xyXG5cdFx0XHRcdFx0XHRcdHZhciBrZXk7XHJcblx0XHRcdFx0XHRcdFx0cG9zdGRhdGFbaWRuYW1lXSA9ICR0LnAuaWRQcmVmaXggKyBwb3N0ZGF0YVtpZG5hbWVdO1xyXG5cdFx0XHRcdFx0XHRcdGlmKGRhdGEuc3RhdHVzID49IDMwMCAmJiBkYXRhLnN0YXR1cyAhPT0gMzA0KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRyZXRbMF0gPSBmYWxzZTtcclxuXHRcdFx0XHRcdFx0XHRcdHJldFsxXSA9ICQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWRkRWRpdEVycm9yVGV4dEZvcm1hdFwiLCBbZGF0YSwgZnJtb3Blcl0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKCQuaXNGdW5jdGlvbihycF9nZVskdC5wLmlkXS5lcnJvclRleHRGb3JtYXQpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHJldFsxXSA9IHJwX2dlWyR0LnAuaWRdLmVycm9yVGV4dEZvcm1hdC5jYWxsKCR0LCBkYXRhLCBmcm1vcGVyKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHJldFsxXSA9IHN0YXR1cyArIFwiIFN0YXR1czogJ1wiICsgZGF0YS5zdGF0dXNUZXh0ICsgXCInLiBFcnJvciBjb2RlOiBcIiArIGRhdGEuc3RhdHVzO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBkYXRhIGlzIHBvc3RlZCBzdWNjZXNzZnVsXHJcblx0XHRcdFx0XHRcdFx0XHQvLyBleGVjdXRlIGFmdGVyc3VibWl0IHdpdGggdGhlIHJldHVybmVkIGRhdGEgZnJvbSBzZXJ2ZXJcclxuXHRcdFx0XHRcdFx0XHRcdHJldCA9ICQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWRkRWRpdEFmdGVyU3VibWl0XCIsIFtkYXRhLCBwb3N0ZGF0YSwgZnJtb3Blcl0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYocmV0ID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0cmV0ID0gW3RydWUsXCJcIixcIlwiXTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdGlmKCByZXRbMF0gJiYgJC5pc0Z1bmN0aW9uKHJwX2dlWyR0LnAuaWRdLmFmdGVyU3VibWl0KSApIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0cmV0ID0gcnBfZ2VbJHQucC5pZF0uYWZ0ZXJTdWJtaXQuY2FsbCgkdCwgZGF0YSxwb3N0ZGF0YSwgZnJtb3Blcik7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdGlmKHJldFswXSA9PT0gZmFsc2UpIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQoXCIjRm9ybUVycm9yPnRkXCIsZnJtdGIpLmh0bWwocmV0WzFdKTtcclxuXHRcdFx0XHRcdFx0XHRcdCQoXCIjRm9ybUVycm9yXCIsZnJtdGIpLnNob3coKTtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoJHQucC5hdXRvZW5jb2RlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQuZWFjaChwb3N0ZGF0YSxmdW5jdGlvbihuLHYpe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHBvc3RkYXRhW25dID0gJC5qZ3JpZC5odG1sRGVjb2RlKHYpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdC8vcnBfZ2VbJHQucC5pZF0ucmVsb2FkQWZ0ZXJTdWJtaXQgPSBycF9nZVskdC5wLmlkXS5yZWxvYWRBZnRlclN1Ym1pdCAmJiAkdC5wLmRhdGF0eXBlICE9IFwibG9jYWxcIjtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIHRoZSBhY3Rpb24gaXMgYWRkXHJcblx0XHRcdFx0XHRcdFx0XHRpZihwb3N0ZGF0YVtvcGVyXSA9PT0gb3BlcnMuYWRkb3BlciApIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly9pZCBwcm9jZXNzaW5nXHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIHVzZXIgbm90IHNldCB0aGUgaWQgcmV0WzJdXHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCFyZXRbMl0pIHtyZXRbMl0gPSAkLmpncmlkLnJhbmRJZCgpO31cclxuXHRcdFx0XHRcdFx0XHRcdFx0cG9zdGRhdGFbaWRuYW1lXSA9IHJldFsyXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYocnBfZ2VbJHQucC5pZF0ucmVsb2FkQWZ0ZXJTdWJtaXQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQkKCR0KS50cmlnZ2VyKFwicmVsb2FkR3JpZFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZigkdC5wLnRyZWVHcmlkID09PSB0cnVlKXtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcImFkZENoaWxkTm9kZVwiLHJldFsyXSxzZWxyLHBvc3RkYXRhICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcImFkZFJvd0RhdGFcIixyZXRbMl0scG9zdGRhdGEscC5hZGRlZHJvdyk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKHJwX2dlWyR0LnAuaWRdLmNsb3NlQWZ0ZXJBZGQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZigkdC5wLnRyZWVHcmlkICE9PSB0cnVlKXtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcInNldFNlbGVjdGlvblwiLHJldFsyXSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCQuamdyaWQuaGlkZU1vZGFsKFwiI1wiKyQuamdyaWQuanFJRChJRHMudGhlbW9kYWwpLHtnYjpcIiNnYm94X1wiKyQuamdyaWQuanFJRChnSUQpLGpxbTpwLmpxTW9kYWwsb25DbG9zZTogcnBfZ2VbJHQucC5pZF0ub25DbG9zZX0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKHJwX2dlWyR0LnAuaWRdLmNsZWFyQWZ0ZXJBZGQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRmaWxsRGF0YShcIl9lbXB0eVwiLCR0LGZybWdyKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gdGhlIGFjdGlvbiBpcyB1cGRhdGVcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYocnBfZ2VbJHQucC5pZF0ucmVsb2FkQWZ0ZXJTdWJtaXQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQkKCR0KS50cmlnZ2VyKFwicmVsb2FkR3JpZFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggIXJwX2dlWyR0LnAuaWRdLmNsb3NlQWZ0ZXJFZGl0ICkge3NldFRpbWVvdXQoZnVuY3Rpb24oKXskKCR0KS5qcUdyaWQoXCJzZXRTZWxlY3Rpb25cIixwb3N0ZGF0YVtpZG5hbWVdKTt9LDEwMDApO31cclxuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZigkdC5wLnRyZWVHcmlkID09PSB0cnVlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJzZXRUcmVlUm93XCIsIHBvc3RkYXRhW2lkbmFtZV0scG9zdGRhdGEpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJzZXRSb3dEYXRhXCIsIHBvc3RkYXRhW2lkbmFtZV0scG9zdGRhdGEpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZihycF9nZVskdC5wLmlkXS5jbG9zZUFmdGVyRWRpdCkgeyQuamdyaWQuaGlkZU1vZGFsKFwiI1wiKyQuamdyaWQuanFJRChJRHMudGhlbW9kYWwpLHtnYjpcIiNnYm94X1wiKyQuamdyaWQuanFJRChnSUQpLGpxbTpwLmpxTW9kYWwsb25DbG9zZTogcnBfZ2VbJHQucC5pZF0ub25DbG9zZX0pO31cclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbihycF9nZVskdC5wLmlkXS5hZnRlckNvbXBsZXRlKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjb3B5ZGF0YSA9IGRhdGE7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEFkZEVkaXRBZnRlckNvbXBsZXRlXCIsIFtjb3B5ZGF0YSwgcG9zdGRhdGEsICQoXCIjXCIrZnJtZ3IpLCBmcm1vcGVyXSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0cnBfZ2VbJHQucC5pZF0uYWZ0ZXJDb21wbGV0ZS5jYWxsKCR0LCBjb3B5ZGF0YSwgcG9zdGRhdGEsICQoXCIjXCIrZnJtZ3IpLCBmcm1vcGVyKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjb3B5ZGF0YT1udWxsO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9LDUwMCk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRpZihycF9nZVskdC5wLmlkXS5jaGVja09uU3VibWl0IHx8IHJwX2dlWyR0LnAuaWRdLmNoZWNrT25VcGRhdGUpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0JChcIiNcIitmcm1ncikuZGF0YShcImRpc2FibGVkXCIsZmFsc2UpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZihycF9nZVskdC5wLmlkXS5fc2F2ZWREYXRhWyR0LnAuaWQrXCJfaWRcIl0gIT09IFwiX2VtcHR5XCIpe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGZvcihrZXkgaW4gcnBfZ2VbJHQucC5pZF0uX3NhdmVkRGF0YSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYocnBfZ2VbJHQucC5pZF0uX3NhdmVkRGF0YS5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIHBvc3RkYXRhW2tleV0pIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cnBfZ2VbJHQucC5pZF0uX3NhdmVkRGF0YVtrZXldID0gcG9zdGRhdGFba2V5XTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0cnBfZ2VbJHQucC5pZF0ucHJvY2Vzc2luZz1mYWxzZTtcclxuXHRcdFx0XHRcdFx0XHQkKFwiI3NEYXRhXCIsIGZybXRiK1wiXzJcIikucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWFjdGl2ZScpO1xyXG5cdFx0XHRcdFx0XHRcdHRyeXskKCc6aW5wdXQ6dmlzaWJsZScsXCIjXCIrZnJtZ3IpWzBdLmZvY3VzKCk7fSBjYXRjaCAoZSl7fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9LCAkLmpncmlkLmFqYXhPcHRpb25zLCBycF9nZVskdC5wLmlkXS5hamF4RWRpdE9wdGlvbnMgKTtcclxuXHJcblx0XHRcdFx0XHRpZiAoIWFqYXhPcHRpb25zLnVybCAmJiAhcnBfZ2VbJHQucC5pZF0udXNlRGF0YVByb3h5KSB7XHJcblx0XHRcdFx0XHRcdGlmICgkLmlzRnVuY3Rpb24oJHQucC5kYXRhUHJveHkpKSB7XHJcblx0XHRcdFx0XHRcdFx0cnBfZ2VbJHQucC5pZF0udXNlRGF0YVByb3h5ID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRyZXRbMF09ZmFsc2U7cmV0WzFdICs9IFwiIFwiKyQuamdyaWQuZXJyb3JzLm5vdXJsO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAocmV0WzBdKSB7XHJcblx0XHRcdFx0XHRcdGlmIChycF9nZVskdC5wLmlkXS51c2VEYXRhUHJveHkpIHtcclxuXHRcdFx0XHRcdFx0XHR2YXIgZHByZXQgPSAkdC5wLmRhdGFQcm94eS5jYWxsKCR0LCBhamF4T3B0aW9ucywgXCJzZXRfXCIrJHQucC5pZCk7XHJcblx0XHRcdFx0XHRcdFx0aWYoZHByZXQgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0ZHByZXQgPSBbdHJ1ZSwgXCJcIl07XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdGlmKGRwcmV0WzBdID09PSBmYWxzZSApIHtcclxuXHRcdFx0XHRcdFx0XHRcdHJldFswXSA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRcdFx0cmV0WzFdID0gZHByZXRbMV0gfHwgXCJFcnJvciBkZWxldGluZyB0aGUgc2VsZWN0ZWQgcm93IVwiIDtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoYWpheE9wdGlvbnMuZGF0YS5vcGVyID09PSBvcGVycy5hZGRvcGVyICYmIHJwX2dlWyR0LnAuaWRdLmNsb3NlQWZ0ZXJBZGQgKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQuamdyaWQuaGlkZU1vZGFsKFwiI1wiKyQuamdyaWQuanFJRChJRHMudGhlbW9kYWwpLHtnYjpcIiNnYm94X1wiKyQuamdyaWQuanFJRChnSUQpLGpxbTpwLmpxTW9kYWwsIG9uQ2xvc2U6IHJwX2dlWyR0LnAuaWRdLm9uQ2xvc2V9KTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdGlmKGFqYXhPcHRpb25zLmRhdGEub3BlciA9PT0gb3BlcnMuZWRpdG9wZXIgJiYgcnBfZ2VbJHQucC5pZF0uY2xvc2VBZnRlckVkaXQgKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQuamdyaWQuaGlkZU1vZGFsKFwiI1wiKyQuamdyaWQuanFJRChJRHMudGhlbW9kYWwpLHtnYjpcIiNnYm94X1wiKyQuamdyaWQuanFJRChnSUQpLGpxbTpwLmpxTW9kYWwsIG9uQ2xvc2U6IHJwX2dlWyR0LnAuaWRdLm9uQ2xvc2V9KTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0JC5hamF4KGFqYXhPcHRpb25zKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihyZXRbMF0gPT09IGZhbHNlKSB7XHJcblx0XHRcdFx0XHQkKFwiI0Zvcm1FcnJvcj50ZFwiLGZybXRiKS5odG1sKHJldFsxXSk7XHJcblx0XHRcdFx0XHQkKFwiI0Zvcm1FcnJvclwiLGZybXRiKS5zaG93KCk7XHJcblx0XHRcdFx0XHQvLyByZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIGNvbXBhcmVEYXRhKG5PYmosIG9PYmogKSB7XHJcblx0XHRcdFx0dmFyIHJldCA9IGZhbHNlLGtleTtcclxuXHRcdFx0XHRmb3IgKGtleSBpbiBuT2JqKSB7XHJcblx0XHRcdFx0XHRpZihuT2JqLmhhc093blByb3BlcnR5KGtleSkgJiYgbk9ialtrZXldICE9IG9PYmpba2V5XSkge1xyXG5cdFx0XHRcdFx0XHRyZXQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIHJldDtcclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiBjaGVja1VwZGF0ZXMgKCkge1xyXG5cdFx0XHRcdHZhciBzdGF0ID0gdHJ1ZTtcclxuXHRcdFx0XHQkKFwiI0Zvcm1FcnJvclwiLGZybXRiKS5oaWRlKCk7XHJcblx0XHRcdFx0aWYocnBfZ2VbJHQucC5pZF0uY2hlY2tPblVwZGF0ZSkge1xyXG5cdFx0XHRcdFx0cG9zdGRhdGEgPSB7fTtcclxuXHRcdFx0XHRcdGdldEZvcm1EYXRhKCk7XHJcblx0XHRcdFx0XHRkaWZmID0gY29tcGFyZURhdGEocG9zdGRhdGEscnBfZ2VbJHQucC5pZF0uX3NhdmVkRGF0YSk7XHJcblx0XHRcdFx0XHRpZihkaWZmKSB7XHJcblx0XHRcdFx0XHRcdCQoXCIjXCIrZnJtZ3IpLmRhdGEoXCJkaXNhYmxlZFwiLHRydWUpO1xyXG5cdFx0XHRcdFx0XHQkKFwiLmNvbmZpcm1cIixcIiNcIitJRHMudGhlbW9kYWwpLnNob3coKTtcclxuXHRcdFx0XHRcdFx0c3RhdCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gc3RhdDtcclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiByZXN0b3JlSW5saW5lKClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZhciBpO1xyXG5cdFx0XHRcdGlmIChyb3dpZCAhPT0gXCJfZW1wdHlcIiAmJiAkdC5wLnNhdmVkUm93ICE9PSB1bmRlZmluZWQgJiYgJHQucC5zYXZlZFJvdy5sZW5ndGggPiAwICYmICQuaXNGdW5jdGlvbigkLmZuLmpxR3JpZC5yZXN0b3JlUm93KSkge1xyXG5cdFx0XHRcdFx0Zm9yIChpPTA7aTwkdC5wLnNhdmVkUm93Lmxlbmd0aDtpKyspIHtcclxuXHRcdFx0XHRcdFx0aWYgKCR0LnAuc2F2ZWRSb3dbaV0uaWQgPT0gcm93aWQpIHtcclxuXHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoJ3Jlc3RvcmVSb3cnLHJvd2lkKTtcclxuXHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiB1cGRhdGVOYXYoY3IsIHBvc2Fycil7XHJcblx0XHRcdFx0dmFyIHRvdHIgPSBwb3NhcnJbMV0ubGVuZ3RoLTE7XHJcblx0XHRcdFx0aWYgKGNyPT09MCkge1xyXG5cdFx0XHRcdFx0JChcIiNwRGF0YVwiLGZybXRiK1wiXzJcIikuYWRkQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0XHRcdFx0fSBlbHNlIGlmKCBwb3NhcnJbMV1bY3ItMV0gIT09IHVuZGVmaW5lZCAmJiAkKFwiI1wiKyQuamdyaWQuanFJRChwb3NhcnJbMV1bY3ItMV0pKS5oYXNDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKSkge1xyXG5cdFx0XHRcdFx0XHQkKFwiI3BEYXRhXCIsZnJtdGIrXCJfMlwiKS5hZGRDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JChcIiNwRGF0YVwiLGZybXRiK1wiXzJcIikucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAoY3I9PT10b3RyKSB7XHJcblx0XHRcdFx0XHQkKFwiI25EYXRhXCIsZnJtdGIrXCJfMlwiKS5hZGRDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0XHR9IGVsc2UgaWYoIHBvc2FyclsxXVtjcisxXSAhPT0gdW5kZWZpbmVkICYmICQoXCIjXCIrJC5qZ3JpZC5qcUlEKHBvc2FyclsxXVtjcisxXSkpLmhhc0NsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpKSB7XHJcblx0XHRcdFx0XHQkKFwiI25EYXRhXCIsZnJtdGIrXCJfMlwiKS5hZGRDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JChcIiNuRGF0YVwiLGZybXRiK1wiXzJcIikucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIGdldEN1cnJQb3MoKSB7XHJcblx0XHRcdFx0dmFyIHJvd3NJbkdyaWQgPSAkKCR0KS5qcUdyaWQoXCJnZXREYXRhSURzXCIpLFxyXG5cdFx0XHRcdHNlbHJvdyA9ICQoXCIjaWRfZ1wiLGZybXRiKS52YWwoKSxcclxuXHRcdFx0XHRwb3MgPSAkLmluQXJyYXkoc2Vscm93LHJvd3NJbkdyaWQpO1xyXG5cdFx0XHRcdHJldHVybiBbcG9zLHJvd3NJbkdyaWRdO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgZGggPSBpc05hTihycF9nZVskKHRoaXMpWzBdLnAuaWRdLmRhdGFoZWlnaHQpID8gcnBfZ2VbJCh0aGlzKVswXS5wLmlkXS5kYXRhaGVpZ2h0IDogcnBfZ2VbJCh0aGlzKVswXS5wLmlkXS5kYXRhaGVpZ2h0K1wicHhcIixcclxuXHRcdFx0ZHcgPSBpc05hTihycF9nZVskKHRoaXMpWzBdLnAuaWRdLmRhdGF3aWR0aCkgPyBycF9nZVskKHRoaXMpWzBdLnAuaWRdLmRhdGF3aWR0aCA6IHJwX2dlWyQodGhpcylbMF0ucC5pZF0uZGF0YXdpZHRoK1wicHhcIixcclxuXHRcdFx0ZnJtID0gJChcIjxmb3JtIG5hbWU9J0Zvcm1Qb3N0JyBpZD0nXCIrZnJtZ3IrXCInIGNsYXNzPSdGb3JtR3JpZCcgb25TdWJtaXQ9J3JldHVybiBmYWxzZTsnIHN0eWxlPSd3aWR0aDpcIitkdytcIjtvdmVyZmxvdzphdXRvO3Bvc2l0aW9uOnJlbGF0aXZlO2hlaWdodDpcIitkaCtcIjsnPjwvZm9ybT5cIikuZGF0YShcImRpc2FibGVkXCIsZmFsc2UpLFxyXG5cdFx0XHR0YmwgPSAkKFwiPHRhYmxlIGlkPSdcIitmcm10Ym9yZytcIicgY2xhc3M9J0VkaXRUYWJsZScgY2VsbHNwYWNpbmc9JzAnIGNlbGxwYWRkaW5nPScwJyBib3JkZXI9JzAnPjx0Ym9keT48L3Rib2R5PjwvdGFibGU+XCIpO1xyXG5cdFx0XHRzaG93RnJtID0gJCgkdCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRBZGRFZGl0QmVmb3JlSW5pdERhdGFcIiwgWyQoXCIjXCIrZnJtZ3IpLCBmcm1vcGVyXSk7XHJcblx0XHRcdGlmKHNob3dGcm0gPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdHNob3dGcm0gPSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHNob3dGcm0gJiYgb25CZWZvcmVJbml0KSB7XHJcblx0XHRcdFx0c2hvd0ZybSA9IG9uQmVmb3JlSW5pdC5jYWxsKCR0LCQoXCIjXCIrZnJtZ3IpLGZybW9wZXIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHNob3dGcm0gPT09IGZhbHNlKSB7cmV0dXJuO31cclxuXHRcdFx0cmVzdG9yZUlubGluZSgpO1xyXG5cdFx0XHQkKCR0LnAuY29sTW9kZWwpLmVhY2goIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHZhciBmbXRvID0gdGhpcy5mb3Jtb3B0aW9ucztcclxuXHRcdFx0XHRtYXhDb2xzID0gTWF0aC5tYXgobWF4Q29scywgZm10byA/IGZtdG8uY29scG9zIHx8IDAgOiAwICk7XHJcblx0XHRcdFx0bWF4Um93cyA9IE1hdGgubWF4KG1heFJvd3MsIGZtdG8gPyBmbXRvLnJvd3BvcyB8fCAwIDogMCApO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0JChmcm0pLmFwcGVuZCh0YmwpO1xyXG5cdFx0XHR2YXIgZmxyID0gJChcIjx0ciBpZD0nRm9ybUVycm9yJyBzdHlsZT0nZGlzcGxheTpub25lJz48dGQgY2xhc3M9J3VpLXN0YXRlLWVycm9yJyBjb2xzcGFuPSdcIisobWF4Q29scyoyKStcIic+PC90ZD48L3RyPlwiKTtcclxuXHRcdFx0ZmxyWzBdLnJwID0gMDtcclxuXHRcdFx0JCh0YmwpLmFwcGVuZChmbHIpO1xyXG5cdFx0XHQvL3RvcGluZm9cclxuXHRcdFx0ZmxyID0gJChcIjx0ciBzdHlsZT0nZGlzcGxheTpub25lJyBjbGFzcz0ndGluZm8nPjx0ZCBjbGFzcz0ndG9waW5mbycgY29sc3Bhbj0nXCIrKG1heENvbHMqMikrXCInPlwiK3JwX2dlWyR0LnAuaWRdLnRvcGluZm8rXCI8L3RkPjwvdHI+XCIpO1xyXG5cdFx0XHRmbHJbMF0ucnAgPSAwO1xyXG5cdFx0XHQkKHRibCkuYXBwZW5kKGZscik7XHJcblx0XHRcdC8vIHNldCB0aGUgaWQuXHJcblx0XHRcdC8vIHVzZSBjYXJlZnVsbCBvbmx5IHRvIGNoYW5nZSBoZXJlIGNvbHByb3BlcnRpZXMuXHJcblx0XHRcdC8vIGNyZWF0ZSBkYXRhXHJcblx0XHRcdHZhciBydGxiID0gJHQucC5kaXJlY3Rpb24gPT09IFwicnRsXCIgPyB0cnVlIDpmYWxzZSxcclxuXHRcdFx0YnAgPSBydGxiID8gXCJuRGF0YVwiIDogXCJwRGF0YVwiLFxyXG5cdFx0XHRibiA9IHJ0bGIgPyBcInBEYXRhXCIgOiBcIm5EYXRhXCI7XHJcblx0XHRcdGNyZWF0ZURhdGEocm93aWQsJHQsdGJsLG1heENvbHMpO1xyXG5cdFx0XHQvLyBidXR0b25zIGF0IGZvb3RlclxyXG5cdFx0XHR2YXIgYlAgPSBcIjxhIGlkPSdcIiticCtcIicgY2xhc3M9J2ZtLWJ1dHRvbiB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1sZWZ0Jz48c3BhbiBjbGFzcz0ndWktaWNvbiB1aS1pY29uLXRyaWFuZ2xlLTEtdyc+PC9zcGFuPjwvYT5cIixcclxuXHRcdFx0Yk4gPSBcIjxhIGlkPSdcIitibitcIicgY2xhc3M9J2ZtLWJ1dHRvbiB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1yaWdodCc+PHNwYW4gY2xhc3M9J3VpLWljb24gdWktaWNvbi10cmlhbmdsZS0xLWUnPjwvc3Bhbj48L2E+XCIsXHJcblx0XHRcdGJTICA9XCI8YSBpZD0nc0RhdGEnIGNsYXNzPSdmbS1idXR0b24gdWktc3RhdGUtZGVmYXVsdCB1aS1jb3JuZXItYWxsJz5cIitwLmJTdWJtaXQrXCI8L2E+XCIsXHJcblx0XHRcdGJDICA9XCI8YSBpZD0nY0RhdGEnIGNsYXNzPSdmbS1idXR0b24gdWktc3RhdGUtZGVmYXVsdCB1aS1jb3JuZXItYWxsJz5cIitwLmJDYW5jZWwrXCI8L2E+XCI7XHJcblx0XHRcdHZhciBidCA9IFwiPHRhYmxlIGJvcmRlcj0nMCcgY2VsbHNwYWNpbmc9JzAnIGNlbGxwYWRkaW5nPScwJyBjbGFzcz0nRWRpdFRhYmxlJyBpZD0nXCIrZnJtdGJvcmcrXCJfMic+PHRib2R5Pjx0cj48dGQgY29sc3Bhbj0nMic+PGhyIGNsYXNzPSd1aS13aWRnZXQtY29udGVudCcgc3R5bGU9J21hcmdpbjoxcHgnLz48L3RkPjwvdHI+PHRyIGlkPSdBY3RfQnV0dG9ucyc+PHRkIGNsYXNzPSduYXZCdXR0b24nPlwiKyhydGxiID8gYk4rYlAgOiBiUCtiTikrXCI8L3RkPjx0ZCBjbGFzcz0nRWRpdEJ1dHRvbic+XCIrYlMrYkMrXCI8L3RkPjwvdHI+XCI7XHJcblx0XHRcdGJ0ICs9IFwiPHRyIHN0eWxlPSdkaXNwbGF5Om5vbmUnIGNsYXNzPSdiaW5mbyc+PHRkIGNsYXNzPSdib3R0b21pbmZvJyBjb2xzcGFuPScyJz5cIitycF9nZVskdC5wLmlkXS5ib3R0b21pbmZvK1wiPC90ZD48L3RyPlwiO1xyXG5cdFx0XHRidCArPSBcIjwvdGJvZHk+PC90YWJsZT5cIjtcclxuXHRcdFx0aWYobWF4Um93cyA+ICAwKSB7XHJcblx0XHRcdFx0dmFyIHNkPVtdO1xyXG5cdFx0XHRcdCQuZWFjaCgkKHRibClbMF0ucm93cyxmdW5jdGlvbihpLHIpe1xyXG5cdFx0XHRcdFx0c2RbaV0gPSByO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdHNkLnNvcnQoZnVuY3Rpb24oYSxiKXtcclxuXHRcdFx0XHRcdGlmKGEucnAgPiBiLnJwKSB7cmV0dXJuIDE7fVxyXG5cdFx0XHRcdFx0aWYoYS5ycCA8IGIucnApIHtyZXR1cm4gLTE7fVxyXG5cdFx0XHRcdFx0cmV0dXJuIDA7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0JC5lYWNoKHNkLCBmdW5jdGlvbihpbmRleCwgcm93KSB7XHJcblx0XHRcdFx0XHQkKCd0Ym9keScsdGJsKS5hcHBlbmQocm93KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRwLmdib3ggPSBcIiNnYm94X1wiKyQuamdyaWQuanFJRChnSUQpO1xyXG5cdFx0XHR2YXIgY2xlID0gZmFsc2U7XHJcblx0XHRcdGlmKHAuY2xvc2VPbkVzY2FwZT09PXRydWUpe1xyXG5cdFx0XHRcdHAuY2xvc2VPbkVzY2FwZSA9IGZhbHNlO1xyXG5cdFx0XHRcdGNsZSA9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIHRtcyA9ICQoXCI8ZGl2PjwvZGl2PlwiKS5hcHBlbmQoZnJtKS5hcHBlbmQoYnQpO1xyXG5cdFx0XHQkLmpncmlkLmNyZWF0ZU1vZGFsKElEcyx0bXMsIHJwX2dlWyQodGhpcylbMF0ucC5pZF0gLFwiI2d2aWV3X1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKSwkKFwiI2dib3hfXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpKVswXSk7XHJcblx0XHRcdGlmKHJ0bGIpIHtcclxuXHRcdFx0XHQkKFwiI3BEYXRhLCAjbkRhdGFcIixmcm10YitcIl8yXCIpLmNzcyhcImZsb2F0XCIsXCJyaWdodFwiKTtcclxuXHRcdFx0XHQkKFwiLkVkaXRCdXR0b25cIixmcm10YitcIl8yXCIpLmNzcyhcInRleHQtYWxpZ25cIixcImxlZnRcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYocnBfZ2VbJHQucC5pZF0udG9waW5mbykgeyQoXCIudGluZm9cIixmcm10Yikuc2hvdygpO31cclxuXHRcdFx0aWYocnBfZ2VbJHQucC5pZF0uYm90dG9taW5mbykgeyQoXCIuYmluZm9cIixmcm10YitcIl8yXCIpLnNob3coKTt9XHJcblx0XHRcdHRtcyA9IG51bGw7YnQ9bnVsbDtcclxuXHRcdFx0JChcIiNcIiskLmpncmlkLmpxSUQoSURzLnRoZW1vZGFsKSkua2V5ZG93biggZnVuY3Rpb24oIGUgKSB7XHJcblx0XHRcdFx0dmFyIHdrZXkgPSBlLnRhcmdldDtcclxuXHRcdFx0XHRpZiAoJChcIiNcIitmcm1ncikuZGF0YShcImRpc2FibGVkXCIpPT09dHJ1ZSApIHtyZXR1cm4gZmFsc2U7fS8vPz9cclxuXHRcdFx0XHRpZihycF9nZVskdC5wLmlkXS5zYXZla2V5WzBdID09PSB0cnVlICYmIGUud2hpY2ggPT09IHJwX2dlWyR0LnAuaWRdLnNhdmVrZXlbMV0pIHsgLy8gc2F2ZVxyXG5cdFx0XHRcdFx0aWYod2tleS50YWdOYW1lICE9PSBcIlRFWFRBUkVBXCIpIHtcclxuXHRcdFx0XHRcdFx0JChcIiNzRGF0YVwiLCBmcm10YitcIl8yXCIpLnRyaWdnZXIoXCJjbGlja1wiKTtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihlLndoaWNoID09PSAyNykge1xyXG5cdFx0XHRcdFx0aWYoIWNoZWNrVXBkYXRlcygpKSB7cmV0dXJuIGZhbHNlO31cclxuXHRcdFx0XHRcdGlmKGNsZSlcdHskLmpncmlkLmhpZGVNb2RhbChcIiNcIiskLmpncmlkLmpxSUQoSURzLnRoZW1vZGFsKSx7Z2I6cC5nYm94LGpxbTpwLmpxTW9kYWwsIG9uQ2xvc2U6IHJwX2dlWyR0LnAuaWRdLm9uQ2xvc2V9KTt9XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKHJwX2dlWyR0LnAuaWRdLm5hdmtleXNbMF09PT10cnVlKSB7XHJcblx0XHRcdFx0XHRpZigkKFwiI2lkX2dcIixmcm10YikudmFsKCkgPT09IFwiX2VtcHR5XCIpIHtyZXR1cm4gdHJ1ZTt9XHJcblx0XHRcdFx0XHRpZihlLndoaWNoID09PSBycF9nZVskdC5wLmlkXS5uYXZrZXlzWzFdKXsgLy91cFxyXG5cdFx0XHRcdFx0XHQkKFwiI3BEYXRhXCIsIGZybXRiK1wiXzJcIikudHJpZ2dlcihcImNsaWNrXCIpO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZihlLndoaWNoID09PSBycF9nZVskdC5wLmlkXS5uYXZrZXlzWzJdKXsgLy9kb3duXHJcblx0XHRcdFx0XHRcdCQoXCIjbkRhdGFcIiwgZnJtdGIrXCJfMlwiKS50cmlnZ2VyKFwiY2xpY2tcIik7XHJcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRpZihwLmNoZWNrT25VcGRhdGUpIHtcclxuXHRcdFx0XHQkKFwiYS51aS1qcWRpYWxvZy10aXRsZWJhci1jbG9zZSBzcGFuXCIsXCIjXCIrJC5qZ3JpZC5qcUlEKElEcy50aGVtb2RhbCkpLnJlbW92ZUNsYXNzKFwianFtQ2xvc2VcIik7XHJcblx0XHRcdFx0JChcImEudWktanFkaWFsb2ctdGl0bGViYXItY2xvc2VcIixcIiNcIiskLmpncmlkLmpxSUQoSURzLnRoZW1vZGFsKSkudW5iaW5kKFwiY2xpY2tcIilcclxuXHRcdFx0XHQuY2xpY2soZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdGlmKCFjaGVja1VwZGF0ZXMoKSkge3JldHVybiBmYWxzZTt9XHJcblx0XHRcdFx0XHQkLmpncmlkLmhpZGVNb2RhbChcIiNcIiskLmpncmlkLmpxSUQoSURzLnRoZW1vZGFsKSx7Z2I6XCIjZ2JveF9cIiskLmpncmlkLmpxSUQoZ0lEKSxqcW06cC5qcU1vZGFsLG9uQ2xvc2U6IHJwX2dlWyR0LnAuaWRdLm9uQ2xvc2V9KTtcclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRwLnNhdmVpY29uID0gJC5leHRlbmQoW3RydWUsXCJsZWZ0XCIsXCJ1aS1pY29uLWRpc2tcIl0scC5zYXZlaWNvbik7XHJcblx0XHRcdHAuY2xvc2VpY29uID0gJC5leHRlbmQoW3RydWUsXCJsZWZ0XCIsXCJ1aS1pY29uLWNsb3NlXCJdLHAuY2xvc2VpY29uKTtcclxuXHRcdFx0Ly8gYmVmb3JlaW5pdGRhdGEgYWZ0ZXIgY3JlYXRpb24gb2YgdGhlIGZvcm1cclxuXHRcdFx0aWYocC5zYXZlaWNvblswXT09PXRydWUpIHtcclxuXHRcdFx0XHQkKFwiI3NEYXRhXCIsZnJtdGIrXCJfMlwiKS5hZGRDbGFzcyhwLnNhdmVpY29uWzFdID09PSBcInJpZ2h0XCIgPyAnZm0tYnV0dG9uLWljb24tcmlnaHQnIDogJ2ZtLWJ1dHRvbi1pY29uLWxlZnQnKVxyXG5cdFx0XHRcdC5hcHBlbmQoXCI8c3BhbiBjbGFzcz0ndWktaWNvbiBcIitwLnNhdmVpY29uWzJdK1wiJz48L3NwYW4+XCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHAuY2xvc2VpY29uWzBdPT09dHJ1ZSkge1xyXG5cdFx0XHRcdCQoXCIjY0RhdGFcIixmcm10YitcIl8yXCIpLmFkZENsYXNzKHAuY2xvc2VpY29uWzFdID09PSBcInJpZ2h0XCIgPyAnZm0tYnV0dG9uLWljb24tcmlnaHQnIDogJ2ZtLWJ1dHRvbi1pY29uLWxlZnQnKVxyXG5cdFx0XHRcdC5hcHBlbmQoXCI8c3BhbiBjbGFzcz0ndWktaWNvbiBcIitwLmNsb3NlaWNvblsyXStcIic+PC9zcGFuPlwiKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZihycF9nZVskdC5wLmlkXS5jaGVja09uU3VibWl0IHx8IHJwX2dlWyR0LnAuaWRdLmNoZWNrT25VcGRhdGUpIHtcclxuXHRcdFx0XHRiUyAgPVwiPGEgaWQ9J3NOZXcnIGNsYXNzPSdmbS1idXR0b24gdWktc3RhdGUtZGVmYXVsdCB1aS1jb3JuZXItYWxsJyBzdHlsZT0nei1pbmRleDoxMDAyJz5cIitwLmJZZXMrXCI8L2E+XCI7XHJcblx0XHRcdFx0Yk4gID1cIjxhIGlkPSduTmV3JyBjbGFzcz0nZm0tYnV0dG9uIHVpLXN0YXRlLWRlZmF1bHQgdWktY29ybmVyLWFsbCcgc3R5bGU9J3otaW5kZXg6MTAwMic+XCIrcC5iTm8rXCI8L2E+XCI7XHJcblx0XHRcdFx0YkMgID1cIjxhIGlkPSdjTmV3JyBjbGFzcz0nZm0tYnV0dG9uIHVpLXN0YXRlLWRlZmF1bHQgdWktY29ybmVyLWFsbCcgc3R5bGU9J3otaW5kZXg6MTAwMic+XCIrcC5iRXhpdCtcIjwvYT5cIjtcclxuXHRcdFx0XHR2YXIgekkgPSBwLnpJbmRleCAgfHwgOTk5O3pJICsrO1xyXG5cdFx0XHRcdCQoXCI8ZGl2IGNsYXNzPSdcIisgcC5vdmVybGF5Q2xhc3MrXCIganFncmlkLW92ZXJsYXkgY29uZmlybScgc3R5bGU9J3otaW5kZXg6XCIrekkrXCI7ZGlzcGxheTpub25lOyc+JiMxNjA7XCIrXCI8L2Rpdj48ZGl2IGNsYXNzPSdjb25maXJtIHVpLXdpZGdldC1jb250ZW50IHVpLWpxY29uZmlybScgc3R5bGU9J3otaW5kZXg6XCIrKHpJKzEpK1wiJz5cIitwLnNhdmVEYXRhK1wiPGJyLz48YnIvPlwiK2JTK2JOK2JDK1wiPC9kaXY+XCIpLmluc2VydEFmdGVyKFwiI1wiK2ZybWdyKTtcclxuXHRcdFx0XHQkKFwiI3NOZXdcIixcIiNcIiskLmpncmlkLmpxSUQoSURzLnRoZW1vZGFsKSkuY2xpY2soZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdHBvc3RJdCgpO1xyXG5cdFx0XHRcdFx0JChcIiNcIitmcm1ncikuZGF0YShcImRpc2FibGVkXCIsZmFsc2UpO1xyXG5cdFx0XHRcdFx0JChcIi5jb25maXJtXCIsXCIjXCIrJC5qZ3JpZC5qcUlEKElEcy50aGVtb2RhbCkpLmhpZGUoKTtcclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHQkKFwiI25OZXdcIixcIiNcIiskLmpncmlkLmpxSUQoSURzLnRoZW1vZGFsKSkuY2xpY2soZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdCQoXCIuY29uZmlybVwiLFwiI1wiKyQuamdyaWQuanFJRChJRHMudGhlbW9kYWwpKS5oaWRlKCk7XHJcblx0XHRcdFx0XHQkKFwiI1wiK2ZybWdyKS5kYXRhKFwiZGlzYWJsZWRcIixmYWxzZSk7XHJcblx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7JChcIjppbnB1dDp2aXNpYmxlXCIsXCIjXCIrZnJtZ3IpWzBdLmZvY3VzKCk7fSwwKTtcclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHQkKFwiI2NOZXdcIixcIiNcIiskLmpncmlkLmpxSUQoSURzLnRoZW1vZGFsKSkuY2xpY2soZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdCQoXCIuY29uZmlybVwiLFwiI1wiKyQuamdyaWQuanFJRChJRHMudGhlbW9kYWwpKS5oaWRlKCk7XHJcblx0XHRcdFx0XHQkKFwiI1wiK2ZybWdyKS5kYXRhKFwiZGlzYWJsZWRcIixmYWxzZSk7XHJcblx0XHRcdFx0XHQkLmpncmlkLmhpZGVNb2RhbChcIiNcIiskLmpncmlkLmpxSUQoSURzLnRoZW1vZGFsKSx7Z2I6XCIjZ2JveF9cIiskLmpncmlkLmpxSUQoZ0lEKSxqcW06cC5qcU1vZGFsLG9uQ2xvc2U6IHJwX2dlWyR0LnAuaWRdLm9uQ2xvc2V9KTtcclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBoZXJlIGluaXRmb3JtIC0gb25seSBvbmNlXHJcblx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWRkRWRpdEluaXRpYWxpemVGb3JtXCIsIFskKFwiI1wiK2ZybWdyKSwgZnJtb3Blcl0pO1xyXG5cdFx0XHRpZihvbkluaXRpYWxpemVGb3JtKSB7b25Jbml0aWFsaXplRm9ybS5jYWxsKCR0LCQoXCIjXCIrZnJtZ3IpLCBmcm1vcGVyKTt9XHJcblx0XHRcdGlmKHJvd2lkPT09XCJfZW1wdHlcIiB8fCAhcnBfZ2VbJHQucC5pZF0udmlld1BhZ2VyQnV0dG9ucykgeyQoXCIjcERhdGEsI25EYXRhXCIsZnJtdGIrXCJfMlwiKS5oaWRlKCk7fSBlbHNlIHskKFwiI3BEYXRhLCNuRGF0YVwiLGZybXRiK1wiXzJcIikuc2hvdygpO31cclxuXHRcdFx0JCgkdCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRBZGRFZGl0QmVmb3JlU2hvd0Zvcm1cIiwgWyQoXCIjXCIrZnJtZ3IpLCBmcm1vcGVyXSk7XHJcblx0XHRcdGlmKG9uQmVmb3JlU2hvdykgeyBvbkJlZm9yZVNob3cuY2FsbCgkdCwgJChcIiNcIitmcm1nciksIGZybW9wZXIpO31cclxuXHRcdFx0JChcIiNcIiskLmpncmlkLmpxSUQoSURzLnRoZW1vZGFsKSkuZGF0YShcIm9uQ2xvc2VcIixycF9nZVskdC5wLmlkXS5vbkNsb3NlKTtcclxuXHRcdFx0JC5qZ3JpZC52aWV3TW9kYWwoXCIjXCIrJC5qZ3JpZC5qcUlEKElEcy50aGVtb2RhbCkse1xyXG5cdFx0XHRcdGdib3g6XCIjZ2JveF9cIiskLmpncmlkLmpxSUQoZ0lEKSxcclxuXHRcdFx0XHRqcW06cC5qcU1vZGFsLFxyXG5cdFx0XHRcdG92ZXJsYXk6IHAub3ZlcmxheSxcclxuXHRcdFx0XHRtb2RhbDpwLm1vZGFsLFxyXG5cdFx0XHRcdG92ZXJsYXlDbGFzczogcC5vdmVybGF5Q2xhc3MsXHJcblx0XHRcdFx0b25IaWRlIDogIGZ1bmN0aW9uKGgpIHtcclxuXHRcdFx0XHRcdCQoJHQpLmRhdGEoXCJmb3JtUHJvcFwiLCB7XHJcblx0XHRcdFx0XHRcdHRvcDpwYXJzZUZsb2F0KCQoaC53KS5jc3MoXCJ0b3BcIikpLFxyXG5cdFx0XHRcdFx0XHRsZWZ0IDogcGFyc2VGbG9hdCgkKGgudykuY3NzKFwibGVmdFwiKSksXHJcblx0XHRcdFx0XHRcdHdpZHRoIDogJChoLncpLndpZHRoKCksXHJcblx0XHRcdFx0XHRcdGhlaWdodCA6ICQoaC53KS5oZWlnaHQoKSxcclxuXHRcdFx0XHRcdFx0ZGF0YWhlaWdodCA6ICQoXCIjXCIrZnJtZ3IpLmhlaWdodCgpLFxyXG5cdFx0XHRcdFx0XHRkYXRhd2lkdGg6ICQoXCIjXCIrZnJtZ3IpLndpZHRoKClcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aC53LnJlbW92ZSgpO1xyXG5cdFx0XHRcdFx0aWYoaC5vKSB7aC5vLnJlbW92ZSgpO31cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRpZighY2xvc2VvdnJsKSB7XHJcblx0XHRcdFx0JChcIi5cIiArICQuamdyaWQuanFJRChwLm92ZXJsYXlDbGFzcykpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRpZighY2hlY2tVcGRhdGVzKCkpIHtyZXR1cm4gZmFsc2U7fVxyXG5cdFx0XHRcdFx0JC5qZ3JpZC5oaWRlTW9kYWwoXCIjXCIrJC5qZ3JpZC5qcUlEKElEcy50aGVtb2RhbCkse2diOlwiI2dib3hfXCIrJC5qZ3JpZC5qcUlEKGdJRCksanFtOnAuanFNb2RhbCwgb25DbG9zZTogcnBfZ2VbJHQucC5pZF0ub25DbG9zZX0pO1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdCQoXCIuZm0tYnV0dG9uXCIsXCIjXCIrJC5qZ3JpZC5qcUlEKElEcy50aGVtb2RhbCkpLmhvdmVyKFxyXG5cdFx0XHRcdGZ1bmN0aW9uKCl7JCh0aGlzKS5hZGRDbGFzcygndWktc3RhdGUtaG92ZXInKTt9LFxyXG5cdFx0XHRcdGZ1bmN0aW9uKCl7JCh0aGlzKS5yZW1vdmVDbGFzcygndWktc3RhdGUtaG92ZXInKTt9XHJcblx0XHRcdCk7XHJcblx0XHRcdCQoXCIjc0RhdGFcIiwgZnJtdGIrXCJfMlwiKS5jbGljayhmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHBvc3RkYXRhID0ge307XHJcblx0XHRcdFx0JChcIiNGb3JtRXJyb3JcIixmcm10YikuaGlkZSgpO1xyXG5cdFx0XHRcdC8vIGFsbCBkZXBlbmQgb24gcmV0IGFycmF5XHJcblx0XHRcdFx0Ly9yZXRbMF0gLSBzdWNjZXNcclxuXHRcdFx0XHQvL3JldFsxXSAtIG1zZyBpZiBub3Qgc3VjY2VzXHJcblx0XHRcdFx0Ly9yZXRbMl0gLSB0aGUgaWQgIHRoYXQgd2lsbCBiZSBzZXQgaWYgcmVsb2FkIGFmdGVyIHN1Ym1pdCBmYWxzZVxyXG5cdFx0XHRcdGdldEZvcm1EYXRhKCk7XHJcblx0XHRcdFx0aWYocG9zdGRhdGFbJHQucC5pZCtcIl9pZFwiXSA9PT0gXCJfZW1wdHlcIilcdHtwb3N0SXQoKTt9XHJcblx0XHRcdFx0ZWxzZSBpZihwLmNoZWNrT25TdWJtaXQ9PT10cnVlICkge1xyXG5cdFx0XHRcdFx0ZGlmZiA9IGNvbXBhcmVEYXRhKHBvc3RkYXRhLHJwX2dlWyR0LnAuaWRdLl9zYXZlZERhdGEpO1xyXG5cdFx0XHRcdFx0aWYoZGlmZikge1xyXG5cdFx0XHRcdFx0XHQkKFwiI1wiK2ZybWdyKS5kYXRhKFwiZGlzYWJsZWRcIix0cnVlKTtcclxuXHRcdFx0XHRcdFx0JChcIi5jb25maXJtXCIsXCIjXCIrJC5qZ3JpZC5qcUlEKElEcy50aGVtb2RhbCkpLnNob3coKTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHBvc3RJdCgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRwb3N0SXQoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0JChcIiNjRGF0YVwiLCBmcm10YitcIl8yXCIpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0aWYoIWNoZWNrVXBkYXRlcygpKSB7cmV0dXJuIGZhbHNlO31cclxuXHRcdFx0XHQkLmpncmlkLmhpZGVNb2RhbChcIiNcIiskLmpncmlkLmpxSUQoSURzLnRoZW1vZGFsKSx7Z2I6XCIjZ2JveF9cIiskLmpncmlkLmpxSUQoZ0lEKSxqcW06cC5qcU1vZGFsLG9uQ2xvc2U6IHJwX2dlWyR0LnAuaWRdLm9uQ2xvc2V9KTtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHQkKFwiI25EYXRhXCIsIGZybXRiK1wiXzJcIikuY2xpY2soZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRpZighY2hlY2tVcGRhdGVzKCkpIHtyZXR1cm4gZmFsc2U7fVxyXG5cdFx0XHRcdCQoXCIjRm9ybUVycm9yXCIsZnJtdGIpLmhpZGUoKTtcclxuXHRcdFx0XHR2YXIgbnBvcyA9IGdldEN1cnJQb3MoKTtcclxuXHRcdFx0XHRucG9zWzBdID0gcGFyc2VJbnQobnBvc1swXSwxMCk7XHJcblx0XHRcdFx0aWYobnBvc1swXSAhPT0gLTEgJiYgbnBvc1sxXVtucG9zWzBdKzFdKSB7XHJcblx0XHRcdFx0XHQkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEFkZEVkaXRDbGlja1BnQnV0dG9uc1wiLCBbJ25leHQnLCQoXCIjXCIrZnJtZ3IpLG5wb3NbMV1bbnBvc1swXV1dKTtcclxuXHRcdFx0XHRcdHZhciBucG9zcmV0O1xyXG5cdFx0XHRcdFx0aWYoJC5pc0Z1bmN0aW9uKHAub25jbGlja1BnQnV0dG9ucykpIHtcclxuXHRcdFx0XHRcdFx0bnBvc3JldCA9IHAub25jbGlja1BnQnV0dG9ucy5jYWxsKCR0LCAnbmV4dCcsJChcIiNcIitmcm1nciksbnBvc1sxXVtucG9zWzBdXSk7XHJcblx0XHRcdFx0XHRcdGlmKCBucG9zcmV0ICE9PSB1bmRlZmluZWQgJiYgbnBvc3JldCA9PT0gZmFsc2UgKSB7cmV0dXJuIGZhbHNlO31cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKCAkKFwiI1wiKyQuamdyaWQuanFJRChucG9zWzFdW25wb3NbMF0rMV0pKS5oYXNDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKSkge3JldHVybiBmYWxzZTt9XHJcblx0XHRcdFx0XHRmaWxsRGF0YShucG9zWzFdW25wb3NbMF0rMV0sJHQsZnJtZ3IpO1xyXG5cdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwic2V0U2VsZWN0aW9uXCIsbnBvc1sxXVtucG9zWzBdKzFdKTtcclxuXHRcdFx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWRkRWRpdEFmdGVyQ2xpY2tQZ0J1dHRvbnNcIiwgWyduZXh0JywkKFwiI1wiK2ZybWdyKSxucG9zWzFdW25wb3NbMF1dXSk7XHJcblx0XHRcdFx0XHRpZigkLmlzRnVuY3Rpb24ocC5hZnRlcmNsaWNrUGdCdXR0b25zKSkge1xyXG5cdFx0XHRcdFx0XHRwLmFmdGVyY2xpY2tQZ0J1dHRvbnMuY2FsbCgkdCwgJ25leHQnLCQoXCIjXCIrZnJtZ3IpLG5wb3NbMV1bbnBvc1swXSsxXSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR1cGRhdGVOYXYobnBvc1swXSsxLG5wb3MpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHQkKFwiI3BEYXRhXCIsIGZybXRiK1wiXzJcIikuY2xpY2soZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRpZighY2hlY2tVcGRhdGVzKCkpIHtyZXR1cm4gZmFsc2U7fVxyXG5cdFx0XHRcdCQoXCIjRm9ybUVycm9yXCIsZnJtdGIpLmhpZGUoKTtcclxuXHRcdFx0XHR2YXIgcHBvcyA9IGdldEN1cnJQb3MoKTtcclxuXHRcdFx0XHRpZihwcG9zWzBdICE9PSAtMSAmJiBwcG9zWzFdW3Bwb3NbMF0tMV0pIHtcclxuXHRcdFx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWRkRWRpdENsaWNrUGdCdXR0b25zXCIsIFsncHJldicsJChcIiNcIitmcm1ncikscHBvc1sxXVtwcG9zWzBdXV0pO1xyXG5cdFx0XHRcdFx0dmFyIHBwb3NyZXQ7XHJcblx0XHRcdFx0XHRpZigkLmlzRnVuY3Rpb24ocC5vbmNsaWNrUGdCdXR0b25zKSkge1xyXG5cdFx0XHRcdFx0XHRwcG9zcmV0ID0gcC5vbmNsaWNrUGdCdXR0b25zLmNhbGwoJHQsICdwcmV2JywkKFwiI1wiK2ZybWdyKSxwcG9zWzFdW3Bwb3NbMF1dKTtcclxuXHRcdFx0XHRcdFx0aWYoIHBwb3NyZXQgIT09IHVuZGVmaW5lZCAmJiBwcG9zcmV0ID09PSBmYWxzZSApIHtyZXR1cm4gZmFsc2U7fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYoICQoXCIjXCIrJC5qZ3JpZC5qcUlEKHBwb3NbMV1bcHBvc1swXS0xXSkpLmhhc0NsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpKSB7cmV0dXJuIGZhbHNlO31cclxuXHRcdFx0XHRcdGZpbGxEYXRhKHBwb3NbMV1bcHBvc1swXS0xXSwkdCxmcm1ncik7XHJcblx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJzZXRTZWxlY3Rpb25cIixwcG9zWzFdW3Bwb3NbMF0tMV0pO1xyXG5cdFx0XHRcdFx0JCgkdCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRBZGRFZGl0QWZ0ZXJDbGlja1BnQnV0dG9uc1wiLCBbJ3ByZXYnLCQoXCIjXCIrZnJtZ3IpLHBwb3NbMV1bcHBvc1swXV1dKTtcclxuXHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbihwLmFmdGVyY2xpY2tQZ0J1dHRvbnMpKSB7XHJcblx0XHRcdFx0XHRcdHAuYWZ0ZXJjbGlja1BnQnV0dG9ucy5jYWxsKCR0LCAncHJldicsJChcIiNcIitmcm1ncikscHBvc1sxXVtwcG9zWzBdLTFdKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHVwZGF0ZU5hdihwcG9zWzBdLTEscHBvcyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWRkRWRpdEFmdGVyU2hvd0Zvcm1cIiwgWyQoXCIjXCIrZnJtZ3IpLCBmcm1vcGVyXSk7XHJcblx0XHRcdGlmKG9uQWZ0ZXJTaG93KSB7IG9uQWZ0ZXJTaG93LmNhbGwoJHQsICQoXCIjXCIrZnJtZ3IpLCBmcm1vcGVyKTsgfVxyXG5cdFx0XHR2YXIgcG9zSW5pdCA9Z2V0Q3VyclBvcygpO1xyXG5cdFx0XHR1cGRhdGVOYXYocG9zSW5pdFswXSxwb3NJbml0KTtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0dmlld0dyaWRSb3cgOiBmdW5jdGlvbihyb3dpZCwgcCl7XHJcblx0XHRwID0gJC5leHRlbmQodHJ1ZSwge1xyXG5cdFx0XHR0b3AgOiAwLFxyXG5cdFx0XHRsZWZ0OiAwLFxyXG5cdFx0XHR3aWR0aDogMCxcclxuXHRcdFx0ZGF0YXdpZHRoOiAnYXV0bycsXHJcblx0XHRcdGhlaWdodDogJ2F1dG8nLFxyXG5cdFx0XHRkYXRhaGVpZ2h0OiAnYXV0bycsXHJcblx0XHRcdG1vZGFsOiBmYWxzZSxcclxuXHRcdFx0b3ZlcmxheTogMzAsXHJcblx0XHRcdGRyYWc6IHRydWUsXHJcblx0XHRcdHJlc2l6ZTogdHJ1ZSxcclxuXHRcdFx0anFNb2RhbDogdHJ1ZSxcclxuXHRcdFx0Y2xvc2VPbkVzY2FwZSA6IGZhbHNlLFxyXG5cdFx0XHRsYWJlbHN3aWR0aDogJzMwJScsXHJcblx0XHRcdGNsb3NlaWNvbjogW10sXHJcblx0XHRcdG5hdmtleXM6IFtmYWxzZSwzOCw0MF0sXHJcblx0XHRcdG9uQ2xvc2U6IG51bGwsXHJcblx0XHRcdGJlZm9yZVNob3dGb3JtIDogbnVsbCxcclxuXHRcdFx0YmVmb3JlSW5pdERhdGEgOiBudWxsLFxyXG5cdFx0XHR2aWV3UGFnZXJCdXR0b25zIDogdHJ1ZSxcclxuXHRcdFx0cmVjcmVhdGVGb3JtIDogZmFsc2VcclxuXHRcdH0sICQuamdyaWQudmlldywgcCB8fCB7fSk7XHJcblx0XHRycF9nZVskKHRoaXMpWzBdLnAuaWRdID0gcDtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyICR0ID0gdGhpcztcclxuXHRcdFx0aWYgKCEkdC5ncmlkIHx8ICFyb3dpZCkge3JldHVybjt9XHJcblx0XHRcdHZhciBnSUQgPSAkdC5wLmlkLFxyXG5cdFx0XHRmcm1nciA9IFwiVmlld0dyaWRfXCIrJC5qZ3JpZC5qcUlEKCBnSUQgICksIGZybXRiID0gXCJWaWV3VGJsX1wiICsgJC5qZ3JpZC5qcUlEKCBnSUQgKSxcclxuXHRcdFx0ZnJtZ3JfaWQgPSBcIlZpZXdHcmlkX1wiK2dJRCwgZnJtdGJfaWQgPSBcIlZpZXdUYmxfXCIrZ0lELFxyXG5cdFx0XHRJRHMgPSB7dGhlbW9kYWw6J3ZpZXdtb2QnK2dJRCxtb2RhbGhlYWQ6J3ZpZXdoZCcrZ0lELG1vZGFsY29udGVudDondmlld2NudCcrZ0lELCBzY3JvbGxlbG0gOiBmcm1ncn0sXHJcblx0XHRcdG9uQmVmb3JlSW5pdCA9ICQuaXNGdW5jdGlvbihycF9nZVskdC5wLmlkXS5iZWZvcmVJbml0RGF0YSkgPyBycF9nZVskdC5wLmlkXS5iZWZvcmVJbml0RGF0YSA6IGZhbHNlLFxyXG5cdFx0XHRzaG93RnJtID0gdHJ1ZSxcclxuXHRcdFx0bWF4Q29scyA9IDEsIG1heFJvd3M9MDtcclxuXHRcdFx0aWYoIXAucmVjcmVhdGVGb3JtKSB7XHJcblx0XHRcdFx0aWYoICQoJHQpLmRhdGEoXCJ2aWV3UHJvcFwiKSApIHtcclxuXHRcdFx0XHRcdCQuZXh0ZW5kKHJwX2dlWyQodGhpcylbMF0ucC5pZF0sICQoJHQpLmRhdGEoXCJ2aWV3UHJvcFwiKSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIGZvY3VzYXJlZigpeyAvL1NmYXJpIDMgaXNzdWVzXHJcblx0XHRcdFx0aWYocnBfZ2VbJHQucC5pZF0uY2xvc2VPbkVzY2FwZT09PXRydWUgfHwgcnBfZ2VbJHQucC5pZF0ubmF2a2V5c1swXT09PXRydWUpIHtcclxuXHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKXskKFwiLnVpLWpxZGlhbG9nLXRpdGxlYmFyLWNsb3NlXCIsXCIjXCIrJC5qZ3JpZC5qcUlEKElEcy5tb2RhbGhlYWQpKS5mb2N1cygpO30sMCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIGNyZWF0ZURhdGEocm93aWQsb2JqLHRiLG1heGNvbHMpe1xyXG5cdFx0XHRcdHZhciBubSwgaGMsdHJkYXRhLCBjbnQ9MCx0bXAsIGRjLCByZXRwb3M9W10sIGluZD1mYWxzZSwgaSxcclxuXHRcdFx0XHR0ZHRtcGwgPSBcIjx0ZCBjbGFzcz0nQ2FwdGlvblREIGZvcm0tdmlldy1sYWJlbCB1aS13aWRnZXQtY29udGVudCcgd2lkdGg9J1wiK3AubGFiZWxzd2lkdGgrXCInPiYjMTYwOzwvdGQ+PHRkIGNsYXNzPSdEYXRhVEQgZm9ybS12aWV3LWRhdGEgdWktaGVscGVyLXJlc2V0IHVpLXdpZGdldC1jb250ZW50Jz4mIzE2MDs8L3RkPlwiLCB0bXBsPVwiXCIsXHJcblx0XHRcdFx0dGR0bXBsMiA9IFwiPHRkIGNsYXNzPSdDYXB0aW9uVEQgZm9ybS12aWV3LWxhYmVsIHVpLXdpZGdldC1jb250ZW50Jz4mIzE2MDs8L3RkPjx0ZCBjbGFzcz0nRGF0YVREIGZvcm0tdmlldy1kYXRhIHVpLXdpZGdldC1jb250ZW50Jz4mIzE2MDs8L3RkPlwiLFxyXG5cdFx0XHRcdGZtdG51bSA9IFsnaW50ZWdlcicsJ251bWJlcicsJ2N1cnJlbmN5J10sbWF4MSA9MCwgbWF4Mj0wICxtYXh3LHNldG1lLCB2aWV3ZmxkO1xyXG5cdFx0XHRcdGZvciAoaT0xO2k8PW1heGNvbHM7aSsrKSB7XHJcblx0XHRcdFx0XHR0bXBsICs9IGkgPT09IDEgPyB0ZHRtcGwgOiB0ZHRtcGwyO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvLyBmaW5kIG1heCBudW1iZXIgYWxpZ24gcmlndGggd2l0aCBwcm9wZXJ0eSBmb3JtYXR0ZXJcclxuXHRcdFx0XHQkKG9iai5wLmNvbE1vZGVsKS5lYWNoKCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdGlmKHRoaXMuZWRpdHJ1bGVzICYmIHRoaXMuZWRpdHJ1bGVzLmVkaXRoaWRkZW4gPT09IHRydWUpIHtcclxuXHRcdFx0XHRcdFx0aGMgPSBmYWxzZTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdGhjID0gdGhpcy5oaWRkZW4gPT09IHRydWUgPyB0cnVlIDogZmFsc2U7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZighaGMgJiYgdGhpcy5hbGlnbj09PSdyaWdodCcpIHtcclxuXHRcdFx0XHRcdFx0aWYodGhpcy5mb3JtYXR0ZXIgJiYgJC5pbkFycmF5KHRoaXMuZm9ybWF0dGVyLGZtdG51bSkgIT09IC0xICkge1xyXG5cdFx0XHRcdFx0XHRcdG1heDEgPSBNYXRoLm1heChtYXgxLHBhcnNlSW50KHRoaXMud2lkdGgsMTApKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRtYXgyID0gTWF0aC5tYXgobWF4MixwYXJzZUludCh0aGlzLndpZHRoLDEwKSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRtYXh3ICA9IG1heDEgIT09MCA/IG1heDEgOiBtYXgyICE9PTAgPyBtYXgyIDogMDtcclxuXHRcdFx0XHRpbmQgPSAkKG9iaikuanFHcmlkKFwiZ2V0SW5kXCIscm93aWQpO1xyXG5cdFx0XHRcdCQob2JqLnAuY29sTW9kZWwpLmVhY2goIGZ1bmN0aW9uKGkpIHtcclxuXHRcdFx0XHRcdG5tID0gdGhpcy5uYW1lO1xyXG5cdFx0XHRcdFx0c2V0bWUgPSBmYWxzZTtcclxuXHRcdFx0XHRcdC8vIGhpZGRlbiBmaWVsZHMgYXJlIGluY2x1ZGVkIGluIHRoZSBmb3JtXHJcblx0XHRcdFx0XHRpZih0aGlzLmVkaXRydWxlcyAmJiB0aGlzLmVkaXRydWxlcy5lZGl0aGlkZGVuID09PSB0cnVlKSB7XHJcblx0XHRcdFx0XHRcdGhjID0gZmFsc2U7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRoYyA9IHRoaXMuaGlkZGVuID09PSB0cnVlID8gdHJ1ZSA6IGZhbHNlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZGMgPSBoYyA/IFwic3R5bGU9J2Rpc3BsYXk6bm9uZSdcIiA6IFwiXCI7XHJcblx0XHRcdFx0XHR2aWV3ZmxkID0gKHR5cGVvZiB0aGlzLnZpZXdhYmxlICE9PSAnYm9vbGVhbicpID8gdHJ1ZSA6IHRoaXMudmlld2FibGU7XHJcblx0XHRcdFx0XHRpZiAoIG5tICE9PSAnY2InICYmIG5tICE9PSAnc3ViZ3JpZCcgJiYgbm0gIT09ICdybicgJiYgdmlld2ZsZCkge1xyXG5cdFx0XHRcdFx0XHRpZihpbmQgPT09IGZhbHNlKSB7XHJcblx0XHRcdFx0XHRcdFx0dG1wID0gXCJcIjtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRpZihubSA9PT0gb2JqLnAuRXhwYW5kQ29sdW1uICYmIG9iai5wLnRyZWVHcmlkID09PSB0cnVlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0bXAgPSAkKFwidGQ6ZXEoXCIraStcIilcIixvYmoucm93c1tpbmRdKS50ZXh0KCk7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdHRtcCA9ICQoXCJ0ZDplcShcIitpK1wiKVwiLG9iai5yb3dzW2luZF0pLmh0bWwoKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0c2V0bWUgPSB0aGlzLmFsaWduID09PSAncmlnaHQnICYmIG1heHcgIT09MCA/IHRydWUgOiBmYWxzZTtcclxuXHRcdFx0XHRcdFx0dmFyIGZybW9wdCA9ICQuZXh0ZW5kKHt9LHtyb3dhYm92ZTpmYWxzZSxyb3djb250ZW50OicnfSwgdGhpcy5mb3Jtb3B0aW9ucyB8fCB7fSksXHJcblx0XHRcdFx0XHRcdHJwID0gcGFyc2VJbnQoZnJtb3B0LnJvd3BvcywxMCkgfHwgY250KzEsXHJcblx0XHRcdFx0XHRcdGNwID0gcGFyc2VJbnQoKHBhcnNlSW50KGZybW9wdC5jb2xwb3MsMTApIHx8IDEpKjIsMTApO1xyXG5cdFx0XHRcdFx0XHRpZihmcm1vcHQucm93YWJvdmUpIHtcclxuXHRcdFx0XHRcdFx0XHR2YXIgbmV3ZGF0YSA9ICQoXCI8dHI+PHRkIGNsYXNzPSdjb250ZW50aW5mbycgY29sc3Bhbj0nXCIrKG1heGNvbHMqMikrXCInPlwiK2ZybW9wdC5yb3djb250ZW50K1wiPC90ZD48L3RyPlwiKTtcclxuXHRcdFx0XHRcdFx0XHQkKHRiKS5hcHBlbmQobmV3ZGF0YSk7XHJcblx0XHRcdFx0XHRcdFx0bmV3ZGF0YVswXS5ycCA9IHJwO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHRyZGF0YSA9ICQodGIpLmZpbmQoXCJ0cltyb3dwb3M9XCIrcnArXCJdXCIpO1xyXG5cdFx0XHRcdFx0XHRpZiAoIHRyZGF0YS5sZW5ndGg9PT0wICkge1xyXG5cdFx0XHRcdFx0XHRcdHRyZGF0YSA9ICQoXCI8dHIgXCIrZGMrXCIgcm93cG9zPSdcIitycCtcIic+PC90cj5cIikuYWRkQ2xhc3MoXCJGb3JtRGF0YVwiKS5hdHRyKFwiaWRcIixcInRydl9cIitubSk7XHJcblx0XHRcdFx0XHRcdFx0JCh0cmRhdGEpLmFwcGVuZCh0bXBsKTtcclxuXHRcdFx0XHRcdFx0XHQkKHRiKS5hcHBlbmQodHJkYXRhKTtcclxuXHRcdFx0XHRcdFx0XHR0cmRhdGFbMF0ucnAgPSBycDtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHQkKFwidGQ6ZXEoXCIrKGNwLTIpK1wiKVwiLHRyZGF0YVswXSkuaHRtbCgnPGI+JysgKGZybW9wdC5sYWJlbCA9PT0gdW5kZWZpbmVkID8gb2JqLnAuY29sTmFtZXNbaV06IGZybW9wdC5sYWJlbCkrJzwvYj4nKTtcclxuXHRcdFx0XHRcdFx0JChcInRkOmVxKFwiKyhjcC0xKStcIilcIix0cmRhdGFbMF0pLmFwcGVuZChcIjxzcGFuPlwiK3RtcCtcIjwvc3Bhbj5cIikuYXR0cihcImlkXCIsXCJ2X1wiK25tKTtcclxuXHRcdFx0XHRcdFx0aWYoc2V0bWUpe1xyXG5cdFx0XHRcdFx0XHRcdCQoXCJ0ZDplcShcIisoY3AtMSkrXCIpIHNwYW5cIix0cmRhdGFbMF0pLmNzcyh7J3RleHQtYWxpZ24nOidyaWdodCcsd2lkdGg6bWF4dytcInB4XCJ9KTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRyZXRwb3NbY250XSA9IGk7XHJcblx0XHRcdFx0XHRcdGNudCsrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdGlmKCBjbnQgPiAwKSB7XHJcblx0XHRcdFx0XHR2YXIgaWRyb3cgPSAkKFwiPHRyIGNsYXNzPSdGb3JtRGF0YScgc3R5bGU9J2Rpc3BsYXk6bm9uZSc+PHRkIGNsYXNzPSdDYXB0aW9uVEQnPjwvdGQ+PHRkIGNvbHNwYW49J1wiKyAobWF4Y29scyoyLTEpK1wiJyBjbGFzcz0nRGF0YVREJz48aW5wdXQgY2xhc3M9J0Zvcm1FbGVtZW50JyBpZD0naWRfZycgdHlwZT0ndGV4dCcgbmFtZT0naWQnIHZhbHVlPSdcIityb3dpZCtcIicvPjwvdGQ+PC90cj5cIik7XHJcblx0XHRcdFx0XHRpZHJvd1swXS5ycCA9IGNudCs5OTtcclxuXHRcdFx0XHRcdCQodGIpLmFwcGVuZChpZHJvdyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiByZXRwb3M7XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gZmlsbERhdGEocm93aWQsb2JqKXtcclxuXHRcdFx0XHR2YXIgbm0sIGhjLGNudD0wLHRtcCx0cnY7XHJcblx0XHRcdFx0dHJ2ID0gJChvYmopLmpxR3JpZChcImdldEluZFwiLHJvd2lkLHRydWUpO1xyXG5cdFx0XHRcdGlmKCF0cnYpIHtyZXR1cm47fVxyXG5cdFx0XHRcdCQoJ3RkJyx0cnYpLmVhY2goIGZ1bmN0aW9uKGkpIHtcclxuXHRcdFx0XHRcdG5tID0gb2JqLnAuY29sTW9kZWxbaV0ubmFtZTtcclxuXHRcdFx0XHRcdC8vIGhpZGRlbiBmaWVsZHMgYXJlIGluY2x1ZGVkIGluIHRoZSBmb3JtXHJcblx0XHRcdFx0XHRpZihvYmoucC5jb2xNb2RlbFtpXS5lZGl0cnVsZXMgJiYgb2JqLnAuY29sTW9kZWxbaV0uZWRpdHJ1bGVzLmVkaXRoaWRkZW4gPT09IHRydWUpIHtcclxuXHRcdFx0XHRcdFx0aGMgPSBmYWxzZTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdGhjID0gb2JqLnAuY29sTW9kZWxbaV0uaGlkZGVuID09PSB0cnVlID8gdHJ1ZSA6IGZhbHNlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYgKCBubSAhPT0gJ2NiJyAmJiBubSAhPT0gJ3N1YmdyaWQnICYmIG5tICE9PSAncm4nKSB7XHJcblx0XHRcdFx0XHRcdGlmKG5tID09PSBvYmoucC5FeHBhbmRDb2x1bW4gJiYgb2JqLnAudHJlZUdyaWQgPT09IHRydWUpIHtcclxuXHRcdFx0XHRcdFx0XHR0bXAgPSAkKHRoaXMpLnRleHQoKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHR0bXAgPSAkKHRoaXMpLmh0bWwoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRubSA9ICQuamdyaWQuanFJRChcInZfXCIrbm0pO1xyXG5cdFx0XHRcdFx0XHQkKFwiI1wiK25tK1wiIHNwYW5cIixcIiNcIitmcm10YikuaHRtbCh0bXApO1xyXG5cdFx0XHRcdFx0XHRpZiAoaGMpIHskKFwiI1wiK25tLFwiI1wiK2ZybXRiKS5wYXJlbnRzKFwidHI6Zmlyc3RcIikuaGlkZSgpO31cclxuXHRcdFx0XHRcdFx0Y250Kys7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aWYoY250PjApIHskKFwiI2lkX2dcIixcIiNcIitmcm10YikudmFsKHJvd2lkKTt9XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gdXBkYXRlTmF2KGNyLHBvc2Fycil7XHJcblx0XHRcdFx0dmFyIHRvdHIgPSBwb3NhcnJbMV0ubGVuZ3RoLTE7XHJcblx0XHRcdFx0aWYgKGNyPT09MCkge1xyXG5cdFx0XHRcdFx0JChcIiNwRGF0YVwiLFwiI1wiK2ZybXRiK1wiXzJcIikuYWRkQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0XHRcdFx0fSBlbHNlIGlmKCBwb3NhcnJbMV1bY3ItMV0gIT09IHVuZGVmaW5lZCAmJiAkKFwiI1wiKyQuamdyaWQuanFJRChwb3NhcnJbMV1bY3ItMV0pKS5oYXNDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKSkge1xyXG5cdFx0XHRcdFx0JChcIiNwRGF0YVwiLGZybXRiK1wiXzJcIikuYWRkQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCQoXCIjcERhdGFcIixcIiNcIitmcm10YitcIl8yXCIpLnJlbW92ZUNsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoY3I9PT10b3RyKSB7XHJcblx0XHRcdFx0XHQkKFwiI25EYXRhXCIsXCIjXCIrZnJtdGIrXCJfMlwiKS5hZGRDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0XHR9IGVsc2UgaWYoIHBvc2FyclsxXVtjcisxXSAhPT0gdW5kZWZpbmVkICYmICQoXCIjXCIrJC5qZ3JpZC5qcUlEKHBvc2FyclsxXVtjcisxXSkpLmhhc0NsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpKSB7XHJcblx0XHRcdFx0XHQkKFwiI25EYXRhXCIsZnJtdGIrXCJfMlwiKS5hZGRDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JChcIiNuRGF0YVwiLFwiI1wiK2ZybXRiK1wiXzJcIikucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIGdldEN1cnJQb3MoKSB7XHJcblx0XHRcdFx0dmFyIHJvd3NJbkdyaWQgPSAkKCR0KS5qcUdyaWQoXCJnZXREYXRhSURzXCIpLFxyXG5cdFx0XHRcdHNlbHJvdyA9ICQoXCIjaWRfZ1wiLFwiI1wiK2ZybXRiKS52YWwoKSxcclxuXHRcdFx0XHRwb3MgPSAkLmluQXJyYXkoc2Vscm93LHJvd3NJbkdyaWQpO1xyXG5cdFx0XHRcdHJldHVybiBbcG9zLHJvd3NJbkdyaWRdO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgZGggPSBpc05hTihycF9nZVskKHRoaXMpWzBdLnAuaWRdLmRhdGFoZWlnaHQpID8gcnBfZ2VbJCh0aGlzKVswXS5wLmlkXS5kYXRhaGVpZ2h0IDogcnBfZ2VbJCh0aGlzKVswXS5wLmlkXS5kYXRhaGVpZ2h0K1wicHhcIixcclxuXHRcdFx0ZHcgPSBpc05hTihycF9nZVskKHRoaXMpWzBdLnAuaWRdLmRhdGF3aWR0aCkgPyBycF9nZVskKHRoaXMpWzBdLnAuaWRdLmRhdGF3aWR0aCA6IHJwX2dlWyQodGhpcylbMF0ucC5pZF0uZGF0YXdpZHRoK1wicHhcIixcclxuXHRcdFx0ZnJtID0gJChcIjxmb3JtIG5hbWU9J0Zvcm1Qb3N0JyBpZD0nXCIrZnJtZ3JfaWQrXCInIGNsYXNzPSdGb3JtR3JpZCcgc3R5bGU9J3dpZHRoOlwiK2R3K1wiO292ZXJmbG93OmF1dG87cG9zaXRpb246cmVsYXRpdmU7aGVpZ2h0OlwiK2RoK1wiOyc+PC9mb3JtPlwiKSxcclxuXHRcdFx0dGJsID0kKFwiPHRhYmxlIGlkPSdcIitmcm10Yl9pZCtcIicgY2xhc3M9J0VkaXRUYWJsZScgY2VsbHNwYWNpbmc9JzEnIGNlbGxwYWRkaW5nPScyJyBib3JkZXI9JzAnIHN0eWxlPSd0YWJsZS1sYXlvdXQ6Zml4ZWQnPjx0Ym9keT48L3Rib2R5PjwvdGFibGU+XCIpO1xyXG5cdFx0XHRpZihvbkJlZm9yZUluaXQpIHtcclxuXHRcdFx0XHRzaG93RnJtID0gb25CZWZvcmVJbml0LmNhbGwoJHQsJChcIiNcIitmcm1ncikpO1xyXG5cdFx0XHRcdGlmKHNob3dGcm0gPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0c2hvd0ZybSA9IHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHNob3dGcm0gPT09IGZhbHNlKSB7cmV0dXJuO31cclxuXHRcdFx0JCgkdC5wLmNvbE1vZGVsKS5lYWNoKCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR2YXIgZm10byA9IHRoaXMuZm9ybW9wdGlvbnM7XHJcblx0XHRcdFx0bWF4Q29scyA9IE1hdGgubWF4KG1heENvbHMsIGZtdG8gPyBmbXRvLmNvbHBvcyB8fCAwIDogMCApO1xyXG5cdFx0XHRcdG1heFJvd3MgPSBNYXRoLm1heChtYXhSb3dzLCBmbXRvID8gZm10by5yb3dwb3MgfHwgMCA6IDAgKTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdC8vIHNldCB0aGUgaWQuXHJcblx0XHRcdCQoZnJtKS5hcHBlbmQodGJsKTtcclxuXHRcdFx0Y3JlYXRlRGF0YShyb3dpZCwgJHQsIHRibCwgbWF4Q29scyk7XHJcblx0XHRcdHZhciBydGxiID0gJHQucC5kaXJlY3Rpb24gPT09IFwicnRsXCIgPyB0cnVlIDpmYWxzZSxcclxuXHRcdFx0YnAgPSBydGxiID8gXCJuRGF0YVwiIDogXCJwRGF0YVwiLFxyXG5cdFx0XHRibiA9IHJ0bGIgPyBcInBEYXRhXCIgOiBcIm5EYXRhXCIsXHJcblx0XHRcdFx0Ly8gYnV0dG9ucyBhdCBmb290ZXJcclxuXHRcdFx0YlAgPSBcIjxhIGlkPSdcIiticCtcIicgY2xhc3M9J2ZtLWJ1dHRvbiB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1sZWZ0Jz48c3BhbiBjbGFzcz0ndWktaWNvbiB1aS1pY29uLXRyaWFuZ2xlLTEtdyc+PC9zcGFuPjwvYT5cIixcclxuXHRcdFx0Yk4gPSBcIjxhIGlkPSdcIitibitcIicgY2xhc3M9J2ZtLWJ1dHRvbiB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1yaWdodCc+PHNwYW4gY2xhc3M9J3VpLWljb24gdWktaWNvbi10cmlhbmdsZS0xLWUnPjwvc3Bhbj48L2E+XCIsXHJcblx0XHRcdGJDICA9XCI8YSBpZD0nY0RhdGEnIGNsYXNzPSdmbS1idXR0b24gdWktc3RhdGUtZGVmYXVsdCB1aS1jb3JuZXItYWxsJz5cIitwLmJDbG9zZStcIjwvYT5cIjtcclxuXHRcdFx0aWYobWF4Um93cyA+ICAwKSB7XHJcblx0XHRcdFx0dmFyIHNkPVtdO1xyXG5cdFx0XHRcdCQuZWFjaCgkKHRibClbMF0ucm93cyxmdW5jdGlvbihpLHIpe1xyXG5cdFx0XHRcdFx0c2RbaV0gPSByO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdHNkLnNvcnQoZnVuY3Rpb24oYSxiKXtcclxuXHRcdFx0XHRcdGlmKGEucnAgPiBiLnJwKSB7cmV0dXJuIDE7fVxyXG5cdFx0XHRcdFx0aWYoYS5ycCA8IGIucnApIHtyZXR1cm4gLTE7fVxyXG5cdFx0XHRcdFx0cmV0dXJuIDA7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0JC5lYWNoKHNkLCBmdW5jdGlvbihpbmRleCwgcm93KSB7XHJcblx0XHRcdFx0XHQkKCd0Ym9keScsdGJsKS5hcHBlbmQocm93KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRwLmdib3ggPSBcIiNnYm94X1wiKyQuamdyaWQuanFJRChnSUQpO1xyXG5cdFx0XHR2YXIgYnQgPSAkKFwiPGRpdj48L2Rpdj5cIikuYXBwZW5kKGZybSkuYXBwZW5kKFwiPHRhYmxlIGJvcmRlcj0nMCcgY2xhc3M9J0VkaXRUYWJsZScgaWQ9J1wiK2ZybXRiK1wiXzInPjx0Ym9keT48dHIgaWQ9J0FjdF9CdXR0b25zJz48dGQgY2xhc3M9J25hdkJ1dHRvbicgd2lkdGg9J1wiK3AubGFiZWxzd2lkdGgrXCInPlwiKyhydGxiID8gYk4rYlAgOiBiUCtiTikrXCI8L3RkPjx0ZCBjbGFzcz0nRWRpdEJ1dHRvbic+XCIrYkMrXCI8L3RkPjwvdHI+PC90Ym9keT48L3RhYmxlPlwiKTtcclxuXHRcdFx0JC5qZ3JpZC5jcmVhdGVNb2RhbChJRHMsYnQscCxcIiNndmlld19cIiskLmpncmlkLmpxSUQoJHQucC5pZCksJChcIiNndmlld19cIiskLmpncmlkLmpxSUQoJHQucC5pZCkpWzBdKTtcclxuXHRcdFx0aWYocnRsYikge1xyXG5cdFx0XHRcdCQoXCIjcERhdGEsICNuRGF0YVwiLFwiI1wiK2ZybXRiK1wiXzJcIikuY3NzKFwiZmxvYXRcIixcInJpZ2h0XCIpO1xyXG5cdFx0XHRcdCQoXCIuRWRpdEJ1dHRvblwiLFwiI1wiK2ZybXRiK1wiXzJcIikuY3NzKFwidGV4dC1hbGlnblwiLFwibGVmdFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZighcC52aWV3UGFnZXJCdXR0b25zKSB7JChcIiNwRGF0YSwgI25EYXRhXCIsXCIjXCIrZnJtdGIrXCJfMlwiKS5oaWRlKCk7fVxyXG5cdFx0XHRidCA9IG51bGw7XHJcblx0XHRcdCQoXCIjXCIrSURzLnRoZW1vZGFsKS5rZXlkb3duKCBmdW5jdGlvbiggZSApIHtcclxuXHRcdFx0XHRpZihlLndoaWNoID09PSAyNykge1xyXG5cdFx0XHRcdFx0aWYocnBfZ2VbJHQucC5pZF0uY2xvc2VPbkVzY2FwZSkgeyQuamdyaWQuaGlkZU1vZGFsKFwiI1wiKyQuamdyaWQuanFJRChJRHMudGhlbW9kYWwpLHtnYjpwLmdib3gsanFtOnAuanFNb2RhbCwgb25DbG9zZTogcC5vbkNsb3NlfSk7fVxyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihwLm5hdmtleXNbMF09PT10cnVlKSB7XHJcblx0XHRcdFx0XHRpZihlLndoaWNoID09PSBwLm5hdmtleXNbMV0peyAvL3VwXHJcblx0XHRcdFx0XHRcdCQoXCIjcERhdGFcIiwgXCIjXCIrZnJtdGIrXCJfMlwiKS50cmlnZ2VyKFwiY2xpY2tcIik7XHJcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKGUud2hpY2ggPT09IHAubmF2a2V5c1syXSl7IC8vZG93blxyXG5cdFx0XHRcdFx0XHQkKFwiI25EYXRhXCIsIFwiI1wiK2ZybXRiK1wiXzJcIikudHJpZ2dlcihcImNsaWNrXCIpO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0cC5jbG9zZWljb24gPSAkLmV4dGVuZChbdHJ1ZSxcImxlZnRcIixcInVpLWljb24tY2xvc2VcIl0scC5jbG9zZWljb24pO1xyXG5cdFx0XHRpZihwLmNsb3NlaWNvblswXT09PXRydWUpIHtcclxuXHRcdFx0XHQkKFwiI2NEYXRhXCIsXCIjXCIrZnJtdGIrXCJfMlwiKS5hZGRDbGFzcyhwLmNsb3NlaWNvblsxXSA9PT0gXCJyaWdodFwiID8gJ2ZtLWJ1dHRvbi1pY29uLXJpZ2h0JyA6ICdmbS1idXR0b24taWNvbi1sZWZ0JylcclxuXHRcdFx0XHQuYXBwZW5kKFwiPHNwYW4gY2xhc3M9J3VpLWljb24gXCIrcC5jbG9zZWljb25bMl0rXCInPjwvc3Bhbj5cIik7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoJC5pc0Z1bmN0aW9uKHAuYmVmb3JlU2hvd0Zvcm0pKSB7cC5iZWZvcmVTaG93Rm9ybS5jYWxsKCR0LCQoXCIjXCIrZnJtZ3IpKTt9XHJcblx0XHRcdCQuamdyaWQudmlld01vZGFsKFwiI1wiKyQuamdyaWQuanFJRChJRHMudGhlbW9kYWwpLHtcclxuXHRcdFx0XHRnYm94OlwiI2dib3hfXCIrJC5qZ3JpZC5qcUlEKGdJRCksXHJcblx0XHRcdFx0anFtOnAuanFNb2RhbCxcclxuXHRcdFx0XHRvdmVybGF5OiBwLm92ZXJsYXksXHJcblx0XHRcdFx0bW9kYWw6cC5tb2RhbCxcclxuXHRcdFx0XHRvbkhpZGUgOiAgZnVuY3Rpb24oaCkge1xyXG5cdFx0XHRcdFx0JCgkdCkuZGF0YShcInZpZXdQcm9wXCIsIHtcclxuXHRcdFx0XHRcdFx0dG9wOnBhcnNlRmxvYXQoJChoLncpLmNzcyhcInRvcFwiKSksXHJcblx0XHRcdFx0XHRcdGxlZnQgOiBwYXJzZUZsb2F0KCQoaC53KS5jc3MoXCJsZWZ0XCIpKSxcclxuXHRcdFx0XHRcdFx0d2lkdGggOiAkKGgudykud2lkdGgoKSxcclxuXHRcdFx0XHRcdFx0aGVpZ2h0IDogJChoLncpLmhlaWdodCgpLFxyXG5cdFx0XHRcdFx0XHRkYXRhaGVpZ2h0IDogJChcIiNcIitmcm1ncikuaGVpZ2h0KCksXHJcblx0XHRcdFx0XHRcdGRhdGF3aWR0aDogJChcIiNcIitmcm1ncikud2lkdGgoKVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRoLncucmVtb3ZlKCk7XHJcblx0XHRcdFx0XHRpZihoLm8pIHtoLm8ucmVtb3ZlKCk7fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdCQoXCIuZm0tYnV0dG9uOm5vdCgudWktc3RhdGUtZGlzYWJsZWQpXCIsXCIjXCIrZnJtdGIrXCJfMlwiKS5ob3ZlcihcclxuXHRcdFx0XHRmdW5jdGlvbigpeyQodGhpcykuYWRkQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7fSxcclxuXHRcdFx0XHRmdW5jdGlvbigpeyQodGhpcykucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7fVxyXG5cdFx0XHQpO1xyXG5cdFx0XHRmb2N1c2FyZWYoKTtcclxuXHRcdFx0JChcIiNjRGF0YVwiLCBcIiNcIitmcm10YitcIl8yXCIpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0JC5qZ3JpZC5oaWRlTW9kYWwoXCIjXCIrJC5qZ3JpZC5qcUlEKElEcy50aGVtb2RhbCkse2diOlwiI2dib3hfXCIrJC5qZ3JpZC5qcUlEKGdJRCksanFtOnAuanFNb2RhbCwgb25DbG9zZTogcC5vbkNsb3NlfSk7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0JChcIiNuRGF0YVwiLCBcIiNcIitmcm10YitcIl8yXCIpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0JChcIiNGb3JtRXJyb3JcIixcIiNcIitmcm10YikuaGlkZSgpO1xyXG5cdFx0XHRcdHZhciBucG9zID0gZ2V0Q3VyclBvcygpO1xyXG5cdFx0XHRcdG5wb3NbMF0gPSBwYXJzZUludChucG9zWzBdLDEwKTtcclxuXHRcdFx0XHRpZihucG9zWzBdICE9PSAtMSAmJiBucG9zWzFdW25wb3NbMF0rMV0pIHtcclxuXHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbihwLm9uY2xpY2tQZ0J1dHRvbnMpKSB7XHJcblx0XHRcdFx0XHRcdHAub25jbGlja1BnQnV0dG9ucy5jYWxsKCR0LCduZXh0JywkKFwiI1wiK2ZybWdyKSxucG9zWzFdW25wb3NbMF1dKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGZpbGxEYXRhKG5wb3NbMV1bbnBvc1swXSsxXSwkdCk7XHJcblx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJzZXRTZWxlY3Rpb25cIixucG9zWzFdW25wb3NbMF0rMV0pO1xyXG5cdFx0XHRcdFx0aWYoJC5pc0Z1bmN0aW9uKHAuYWZ0ZXJjbGlja1BnQnV0dG9ucykpIHtcclxuXHRcdFx0XHRcdFx0cC5hZnRlcmNsaWNrUGdCdXR0b25zLmNhbGwoJHQsJ25leHQnLCQoXCIjXCIrZnJtZ3IpLG5wb3NbMV1bbnBvc1swXSsxXSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR1cGRhdGVOYXYobnBvc1swXSsxLG5wb3MpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRmb2N1c2FyZWYoKTtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHQkKFwiI3BEYXRhXCIsIFwiI1wiK2ZybXRiK1wiXzJcIikuY2xpY2soZnVuY3Rpb24oKXtcclxuXHRcdFx0XHQkKFwiI0Zvcm1FcnJvclwiLFwiI1wiK2ZybXRiKS5oaWRlKCk7XHJcblx0XHRcdFx0dmFyIHBwb3MgPSBnZXRDdXJyUG9zKCk7XHJcblx0XHRcdFx0aWYocHBvc1swXSAhPT0gLTEgJiYgcHBvc1sxXVtwcG9zWzBdLTFdKSB7XHJcblx0XHRcdFx0XHRpZigkLmlzRnVuY3Rpb24ocC5vbmNsaWNrUGdCdXR0b25zKSkge1xyXG5cdFx0XHRcdFx0XHRwLm9uY2xpY2tQZ0J1dHRvbnMuY2FsbCgkdCwncHJldicsJChcIiNcIitmcm1ncikscHBvc1sxXVtwcG9zWzBdXSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRmaWxsRGF0YShwcG9zWzFdW3Bwb3NbMF0tMV0sJHQpO1xyXG5cdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwic2V0U2VsZWN0aW9uXCIscHBvc1sxXVtwcG9zWzBdLTFdKTtcclxuXHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbihwLmFmdGVyY2xpY2tQZ0J1dHRvbnMpKSB7XHJcblx0XHRcdFx0XHRcdHAuYWZ0ZXJjbGlja1BnQnV0dG9ucy5jYWxsKCR0LCdwcmV2JywkKFwiI1wiK2ZybWdyKSxwcG9zWzFdW3Bwb3NbMF0tMV0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dXBkYXRlTmF2KHBwb3NbMF0tMSxwcG9zKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Zm9jdXNhcmVmKCk7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0dmFyIHBvc0luaXQgPWdldEN1cnJQb3MoKTtcclxuXHRcdFx0dXBkYXRlTmF2KHBvc0luaXRbMF0scG9zSW5pdCk7XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdGRlbEdyaWRSb3cgOiBmdW5jdGlvbihyb3dpZHMscCkge1xyXG5cdFx0cCA9ICQuZXh0ZW5kKHRydWUsIHtcclxuXHRcdFx0dG9wIDogMCxcclxuXHRcdFx0bGVmdDogMCxcclxuXHRcdFx0d2lkdGg6IDI0MCxcclxuXHRcdFx0aGVpZ2h0OiAnYXV0bycsXHJcblx0XHRcdGRhdGFoZWlnaHQgOiAnYXV0bycsXHJcblx0XHRcdG1vZGFsOiBmYWxzZSxcclxuXHRcdFx0b3ZlcmxheTogMzAsXHJcblx0XHRcdGRyYWc6IHRydWUsXHJcblx0XHRcdHJlc2l6ZTogdHJ1ZSxcclxuXHRcdFx0dXJsIDogJycsXHJcblx0XHRcdG10eXBlIDogXCJQT1NUXCIsXHJcblx0XHRcdHJlbG9hZEFmdGVyU3VibWl0OiB0cnVlLFxyXG5cdFx0XHRiZWZvcmVTaG93Rm9ybTogbnVsbCxcclxuXHRcdFx0YmVmb3JlSW5pdERhdGEgOiBudWxsLFxyXG5cdFx0XHRhZnRlclNob3dGb3JtOiBudWxsLFxyXG5cdFx0XHRiZWZvcmVTdWJtaXQ6IG51bGwsXHJcblx0XHRcdG9uY2xpY2tTdWJtaXQ6IG51bGwsXHJcblx0XHRcdGFmdGVyU3VibWl0OiBudWxsLFxyXG5cdFx0XHRqcU1vZGFsIDogdHJ1ZSxcclxuXHRcdFx0Y2xvc2VPbkVzY2FwZSA6IGZhbHNlLFxyXG5cdFx0XHRkZWxEYXRhOiB7fSxcclxuXHRcdFx0ZGVsaWNvbiA6IFtdLFxyXG5cdFx0XHRjYW5jZWxpY29uIDogW10sXHJcblx0XHRcdG9uQ2xvc2UgOiBudWxsLFxyXG5cdFx0XHRhamF4RGVsT3B0aW9ucyA6IHt9LFxyXG5cdFx0XHRwcm9jZXNzaW5nIDogZmFsc2UsXHJcblx0XHRcdHNlcmlhbGl6ZURlbERhdGEgOiBudWxsLFxyXG5cdFx0XHR1c2VEYXRhUHJveHkgOiBmYWxzZVxyXG5cdFx0fSwgJC5qZ3JpZC5kZWwsIHAgfHx7fSk7XHJcblx0XHRycF9nZVskKHRoaXMpWzBdLnAuaWRdID0gcDtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyICR0ID0gdGhpcztcclxuXHRcdFx0aWYgKCEkdC5ncmlkICkge3JldHVybjt9XHJcblx0XHRcdGlmKCFyb3dpZHMpIHtyZXR1cm47fVxyXG5cdFx0XHR2YXIgb25CZWZvcmVTaG93ID0gJC5pc0Z1bmN0aW9uKCBycF9nZVskdC5wLmlkXS5iZWZvcmVTaG93Rm9ybSAgKSxcclxuXHRcdFx0b25BZnRlclNob3cgPSAkLmlzRnVuY3Rpb24oIHJwX2dlWyR0LnAuaWRdLmFmdGVyU2hvd0Zvcm0gKSxcclxuXHRcdFx0b25CZWZvcmVJbml0ID0gJC5pc0Z1bmN0aW9uKHJwX2dlWyR0LnAuaWRdLmJlZm9yZUluaXREYXRhKSA/IHJwX2dlWyR0LnAuaWRdLmJlZm9yZUluaXREYXRhIDogZmFsc2UsXHJcblx0XHRcdGdJRCA9ICR0LnAuaWQsIG9uQ1MgPSB7fSxcclxuXHRcdFx0c2hvd0ZybSA9IHRydWUsXHJcblx0XHRcdGR0YmwgPSBcIkRlbFRibF9cIiskLmpncmlkLmpxSUQoZ0lEKSxwb3N0ZCwgaWRuYW1lLCBvcGVycywgb3BlcixcclxuXHRcdFx0ZHRibF9pZCA9IFwiRGVsVGJsX1wiICsgZ0lELFxyXG5cdFx0XHRJRHMgPSB7dGhlbW9kYWw6J2RlbG1vZCcrZ0lELG1vZGFsaGVhZDonZGVsaGQnK2dJRCxtb2RhbGNvbnRlbnQ6J2RlbGNudCcrZ0lELCBzY3JvbGxlbG06IGR0Ymx9O1xyXG5cdFx0XHRpZiAoJC5pc0FycmF5KHJvd2lkcykpIHtyb3dpZHMgPSByb3dpZHMuam9pbigpO31cclxuXHRcdFx0aWYgKCAkKFwiI1wiKyQuamdyaWQuanFJRChJRHMudGhlbW9kYWwpKVswXSAhPT0gdW5kZWZpbmVkICkge1xyXG5cdFx0XHRcdGlmKG9uQmVmb3JlSW5pdCkge1xyXG5cdFx0XHRcdFx0c2hvd0ZybSA9IG9uQmVmb3JlSW5pdC5jYWxsKCR0LCQoXCIjXCIrZHRibCkpO1xyXG5cdFx0XHRcdFx0aWYoc2hvd0ZybSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdHNob3dGcm0gPSB0cnVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihzaG93RnJtID09PSBmYWxzZSkge3JldHVybjt9XHJcblx0XHRcdFx0JChcIiNEZWxEYXRhPnRkXCIsXCIjXCIrZHRibCkudGV4dChyb3dpZHMpO1xyXG5cdFx0XHRcdCQoXCIjRGVsRXJyb3JcIixcIiNcIitkdGJsKS5oaWRlKCk7XHJcblx0XHRcdFx0aWYoIHJwX2dlWyR0LnAuaWRdLnByb2Nlc3NpbmcgPT09IHRydWUpIHtcclxuXHRcdFx0XHRcdHJwX2dlWyR0LnAuaWRdLnByb2Nlc3Npbmc9ZmFsc2U7XHJcblx0XHRcdFx0XHQkKFwiI2REYXRhXCIsIFwiI1wiK2R0YmwpLnJlbW92ZUNsYXNzKCd1aS1zdGF0ZS1hY3RpdmUnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYob25CZWZvcmVTaG93KSB7cnBfZ2VbJHQucC5pZF0uYmVmb3JlU2hvd0Zvcm0uY2FsbCgkdCwkKFwiI1wiK2R0YmwpKTt9XHJcblx0XHRcdFx0JC5qZ3JpZC52aWV3TW9kYWwoXCIjXCIrJC5qZ3JpZC5qcUlEKElEcy50aGVtb2RhbCkse2dib3g6XCIjZ2JveF9cIiskLmpncmlkLmpxSUQoZ0lEKSxqcW06cnBfZ2VbJHQucC5pZF0uanFNb2RhbCxqcU06IGZhbHNlLCBvdmVybGF5OiBycF9nZVskdC5wLmlkXS5vdmVybGF5LCBtb2RhbDpycF9nZVskdC5wLmlkXS5tb2RhbH0pO1xyXG5cdFx0XHRcdGlmKG9uQWZ0ZXJTaG93KSB7cnBfZ2VbJHQucC5pZF0uYWZ0ZXJTaG93Rm9ybS5jYWxsKCR0LCQoXCIjXCIrZHRibCkpO31cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR2YXIgZGggPSBpc05hTihycF9nZVskdC5wLmlkXS5kYXRhaGVpZ2h0KSA/IHJwX2dlWyR0LnAuaWRdLmRhdGFoZWlnaHQgOiBycF9nZVskdC5wLmlkXS5kYXRhaGVpZ2h0K1wicHhcIixcclxuXHRcdFx0XHRkdyA9IGlzTmFOKHAuZGF0YXdpZHRoKSA/IHAuZGF0YXdpZHRoIDogcC5kYXRhd2lkdGgrXCJweFwiLFxyXG5cdFx0XHRcdHRibCA9IFwiPGRpdiBpZD0nXCIrZHRibF9pZCtcIicgY2xhc3M9J2Zvcm1kYXRhJyBzdHlsZT0nd2lkdGg6XCIrZHcrXCI7b3ZlcmZsb3c6YXV0bztwb3NpdGlvbjpyZWxhdGl2ZTtoZWlnaHQ6XCIrZGgrXCI7Jz5cIjtcclxuXHRcdFx0XHR0YmwgKz0gXCI8dGFibGUgY2xhc3M9J0RlbFRhYmxlJz48dGJvZHk+XCI7XHJcblx0XHRcdFx0Ly8gZXJyb3IgZGF0YVxyXG5cdFx0XHRcdHRibCArPSBcIjx0ciBpZD0nRGVsRXJyb3InIHN0eWxlPSdkaXNwbGF5Om5vbmUnPjx0ZCBjbGFzcz0ndWktc3RhdGUtZXJyb3InPjwvdGQ+PC90cj5cIjtcclxuXHRcdFx0XHR0YmwgKz0gXCI8dHIgaWQ9J0RlbERhdGEnIHN0eWxlPSdkaXNwbGF5Om5vbmUnPjx0ZCA+XCIrcm93aWRzK1wiPC90ZD48L3RyPlwiO1xyXG5cdFx0XHRcdHRibCArPSBcIjx0cj48dGQgY2xhc3M9XFxcImRlbG1zZ1xcXCIgc3R5bGU9XFxcIndoaXRlLXNwYWNlOnByZTtcXFwiPlwiK3JwX2dlWyR0LnAuaWRdLm1zZytcIjwvdGQ+PC90cj48dHI+PHRkID4mIzE2MDs8L3RkPjwvdHI+XCI7XHJcblx0XHRcdFx0Ly8gYnV0dG9ucyBhdCBmb290ZXJcclxuXHRcdFx0XHR0YmwgKz0gXCI8L3Rib2R5PjwvdGFibGU+PC9kaXY+XCI7XHJcblx0XHRcdFx0dmFyIGJTICA9IFwiPGEgaWQ9J2REYXRhJyBjbGFzcz0nZm0tYnV0dG9uIHVpLXN0YXRlLWRlZmF1bHQgdWktY29ybmVyLWFsbCc+XCIrcC5iU3VibWl0K1wiPC9hPlwiLFxyXG5cdFx0XHRcdGJDICA9IFwiPGEgaWQ9J2VEYXRhJyBjbGFzcz0nZm0tYnV0dG9uIHVpLXN0YXRlLWRlZmF1bHQgdWktY29ybmVyLWFsbCc+XCIrcC5iQ2FuY2VsK1wiPC9hPlwiO1xyXG5cdFx0XHRcdHRibCArPSBcIjx0YWJsZSBjZWxsc3BhY2luZz0nMCcgY2VsbHBhZGRpbmc9JzAnIGJvcmRlcj0nMCcgY2xhc3M9J0VkaXRUYWJsZScgaWQ9J1wiK2R0YmwrXCJfMic+PHRib2R5Pjx0cj48dGQ+PGhyIGNsYXNzPSd1aS13aWRnZXQtY29udGVudCcgc3R5bGU9J21hcmdpbjoxcHgnLz48L3RkPjwvdHI+PHRyPjx0ZCBjbGFzcz0nRGVsQnV0dG9uIEVkaXRCdXR0b24nPlwiK2JTK1wiJiMxNjA7XCIrYkMrXCI8L3RkPjwvdHI+PC90Ym9keT48L3RhYmxlPlwiO1xyXG5cdFx0XHRcdHAuZ2JveCA9IFwiI2dib3hfXCIrJC5qZ3JpZC5qcUlEKGdJRCk7XHJcblx0XHRcdFx0JC5qZ3JpZC5jcmVhdGVNb2RhbChJRHMsdGJsLHAsXCIjZ3ZpZXdfXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpLCQoXCIjZ3ZpZXdfXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpKVswXSk7XHJcblxyXG5cdFx0XHRcdGlmKG9uQmVmb3JlSW5pdCkge1xyXG5cdFx0XHRcdFx0c2hvd0ZybSA9IG9uQmVmb3JlSW5pdC5jYWxsKCR0LCQoXCIjXCIrZHRibCkpO1xyXG5cdFx0XHRcdFx0aWYoc2hvd0ZybSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdHNob3dGcm0gPSB0cnVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihzaG93RnJtID09PSBmYWxzZSkge3JldHVybjt9XHJcblxyXG5cdFx0XHRcdCQoXCIuZm0tYnV0dG9uXCIsXCIjXCIrZHRibCtcIl8yXCIpLmhvdmVyKFxyXG5cdFx0XHRcdFx0ZnVuY3Rpb24oKXskKHRoaXMpLmFkZENsYXNzKCd1aS1zdGF0ZS1ob3ZlcicpO30sXHJcblx0XHRcdFx0XHRmdW5jdGlvbigpeyQodGhpcykucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7fVxyXG5cdFx0XHRcdCk7XHJcblx0XHRcdFx0cC5kZWxpY29uID0gJC5leHRlbmQoW3RydWUsXCJsZWZ0XCIsXCJ1aS1pY29uLXNjaXNzb3JzXCJdLHJwX2dlWyR0LnAuaWRdLmRlbGljb24pO1xyXG5cdFx0XHRcdHAuY2FuY2VsaWNvbiA9ICQuZXh0ZW5kKFt0cnVlLFwibGVmdFwiLFwidWktaWNvbi1jYW5jZWxcIl0scnBfZ2VbJHQucC5pZF0uY2FuY2VsaWNvbik7XHJcblx0XHRcdFx0aWYocC5kZWxpY29uWzBdPT09dHJ1ZSkge1xyXG5cdFx0XHRcdFx0JChcIiNkRGF0YVwiLFwiI1wiK2R0YmwrXCJfMlwiKS5hZGRDbGFzcyhwLmRlbGljb25bMV0gPT09IFwicmlnaHRcIiA/ICdmbS1idXR0b24taWNvbi1yaWdodCcgOiAnZm0tYnV0dG9uLWljb24tbGVmdCcpXHJcblx0XHRcdFx0XHQuYXBwZW5kKFwiPHNwYW4gY2xhc3M9J3VpLWljb24gXCIrcC5kZWxpY29uWzJdK1wiJz48L3NwYW4+XCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihwLmNhbmNlbGljb25bMF09PT10cnVlKSB7XHJcblx0XHRcdFx0XHQkKFwiI2VEYXRhXCIsXCIjXCIrZHRibCtcIl8yXCIpLmFkZENsYXNzKHAuY2FuY2VsaWNvblsxXSA9PT0gXCJyaWdodFwiID8gJ2ZtLWJ1dHRvbi1pY29uLXJpZ2h0JyA6ICdmbS1idXR0b24taWNvbi1sZWZ0JylcclxuXHRcdFx0XHRcdC5hcHBlbmQoXCI8c3BhbiBjbGFzcz0ndWktaWNvbiBcIitwLmNhbmNlbGljb25bMl0rXCInPjwvc3Bhbj5cIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCQoXCIjZERhdGFcIixcIiNcIitkdGJsK1wiXzJcIikuY2xpY2soZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdHZhciByZXQ9W3RydWUsXCJcIl0sIHBrLFxyXG5cdFx0XHRcdFx0cG9zdGRhdGEgPSAkKFwiI0RlbERhdGE+dGRcIixcIiNcIitkdGJsKS50ZXh0KCk7IC8vdGhlIHBhaXIgaXMgbmFtZT12YWwxLHZhbDIsLi4uXHJcblx0XHRcdFx0XHRvbkNTID0ge307XHJcblx0XHRcdFx0XHRpZiggJC5pc0Z1bmN0aW9uKCBycF9nZVskdC5wLmlkXS5vbmNsaWNrU3VibWl0ICkgKSB7b25DUyA9IHJwX2dlWyR0LnAuaWRdLm9uY2xpY2tTdWJtaXQuY2FsbCgkdCxycF9nZVskdC5wLmlkXSwgcG9zdGRhdGEpIHx8IHt9O31cclxuXHRcdFx0XHRcdGlmKCAkLmlzRnVuY3Rpb24oIHJwX2dlWyR0LnAuaWRdLmJlZm9yZVN1Ym1pdCApICkge3JldCA9IHJwX2dlWyR0LnAuaWRdLmJlZm9yZVN1Ym1pdC5jYWxsKCR0LHBvc3RkYXRhKTt9XHJcblx0XHRcdFx0XHRpZihyZXRbMF0gJiYgIXJwX2dlWyR0LnAuaWRdLnByb2Nlc3NpbmcpIHtcclxuXHRcdFx0XHRcdFx0cnBfZ2VbJHQucC5pZF0ucHJvY2Vzc2luZyA9IHRydWU7XHJcblx0XHRcdFx0XHRcdG9wZXJzID0gJHQucC5wcm1OYW1lcztcclxuXHRcdFx0XHRcdFx0cG9zdGQgPSAkLmV4dGVuZCh7fSxycF9nZVskdC5wLmlkXS5kZWxEYXRhLCBvbkNTKTtcclxuXHRcdFx0XHRcdFx0b3BlciA9IG9wZXJzLm9wZXI7XHJcblx0XHRcdFx0XHRcdHBvc3RkW29wZXJdID0gb3BlcnMuZGVsb3BlcjtcclxuXHRcdFx0XHRcdFx0aWRuYW1lID0gb3BlcnMuaWQ7XHJcblx0XHRcdFx0XHRcdHBvc3RkYXRhID0gU3RyaW5nKHBvc3RkYXRhKS5zcGxpdChcIixcIik7XHJcblx0XHRcdFx0XHRcdGlmKCFwb3N0ZGF0YS5sZW5ndGgpIHsgcmV0dXJuIGZhbHNlOyB9XHJcblx0XHRcdFx0XHRcdGZvcihwayBpbiBwb3N0ZGF0YSkge1xyXG5cdFx0XHRcdFx0XHRcdGlmKHBvc3RkYXRhLmhhc093blByb3BlcnR5KHBrKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0cG9zdGRhdGFbcGtdID0gJC5qZ3JpZC5zdHJpcFByZWYoJHQucC5pZFByZWZpeCwgcG9zdGRhdGFbcGtdKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0cG9zdGRbaWRuYW1lXSA9IHBvc3RkYXRhLmpvaW4oKTtcclxuXHRcdFx0XHRcdFx0JCh0aGlzKS5hZGRDbGFzcygndWktc3RhdGUtYWN0aXZlJyk7XHJcblx0XHRcdFx0XHRcdHZhciBhamF4T3B0aW9ucyA9ICQuZXh0ZW5kKHtcclxuXHRcdFx0XHRcdFx0XHR1cmw6IHJwX2dlWyR0LnAuaWRdLnVybCB8fCAkKCR0KS5qcUdyaWQoJ2dldEdyaWRQYXJhbScsJ2VkaXR1cmwnKSxcclxuXHRcdFx0XHRcdFx0XHR0eXBlOiBycF9nZVskdC5wLmlkXS5tdHlwZSxcclxuXHRcdFx0XHRcdFx0XHRkYXRhOiAkLmlzRnVuY3Rpb24ocnBfZ2VbJHQucC5pZF0uc2VyaWFsaXplRGVsRGF0YSkgPyBycF9nZVskdC5wLmlkXS5zZXJpYWxpemVEZWxEYXRhLmNhbGwoJHQscG9zdGQpIDogcG9zdGQsXHJcblx0XHRcdFx0XHRcdFx0Y29tcGxldGU6ZnVuY3Rpb24oZGF0YSxzdGF0dXMpe1xyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIGk7XHJcblx0XHRcdFx0XHRcdFx0XHRpZihkYXRhLnN0YXR1cyA+PSAzMDAgJiYgZGF0YS5zdGF0dXMgIT09IDMwNCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRyZXRbMF0gPSBmYWxzZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKCQuaXNGdW5jdGlvbihycF9nZVskdC5wLmlkXS5lcnJvclRleHRGb3JtYXQpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0WzFdID0gcnBfZ2VbJHQucC5pZF0uZXJyb3JUZXh0Rm9ybWF0LmNhbGwoJHQsZGF0YSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0WzFdID0gc3RhdHVzICsgXCIgU3RhdHVzOiAnXCIgKyBkYXRhLnN0YXR1c1RleHQgKyBcIicuIEVycm9yIGNvZGU6IFwiICsgZGF0YS5zdGF0dXM7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIGRhdGEgaXMgcG9zdGVkIHN1Y2Nlc3NmdWxcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gZXhlY3V0ZSBhZnRlcnN1Ym1pdCB3aXRoIHRoZSByZXR1cm5lZCBkYXRhIGZyb20gc2VydmVyXHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCAkLmlzRnVuY3Rpb24oIHJwX2dlWyR0LnAuaWRdLmFmdGVyU3VibWl0ICkgKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0ID0gcnBfZ2VbJHQucC5pZF0uYWZ0ZXJTdWJtaXQuY2FsbCgkdCxkYXRhLHBvc3RkKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0aWYocmV0WzBdID09PSBmYWxzZSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkKFwiI0RlbEVycm9yPnRkXCIsXCIjXCIrZHRibCkuaHRtbChyZXRbMV0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkKFwiI0RlbEVycm9yXCIsXCIjXCIrZHRibCkuc2hvdygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYocnBfZ2VbJHQucC5pZF0ucmVsb2FkQWZ0ZXJTdWJtaXQgJiYgJHQucC5kYXRhdHlwZSAhPT0gXCJsb2NhbFwiKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0JCgkdCkudHJpZ2dlcihcInJlbG9hZEdyaWRcIik7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoJHQucC50cmVlR3JpZD09PXRydWUpe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0cnkgeyQoJHQpLmpxR3JpZChcImRlbFRyZWVOb2RlXCIsJHQucC5pZFByZWZpeCtwb3N0ZGF0YVswXSk7fSBjYXRjaChlKXt9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvcihpPTA7aTxwb3N0ZGF0YS5sZW5ndGg7aSsrKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcImRlbFJvd0RhdGFcIiwkdC5wLmlkUHJlZml4KyBwb3N0ZGF0YVtpXSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCR0LnAuc2Vscm93ID0gbnVsbDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQkdC5wLnNlbGFycnJvdyA9IFtdO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbihycF9nZVskdC5wLmlkXS5hZnRlckNvbXBsZXRlKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKXtycF9nZVskdC5wLmlkXS5hZnRlckNvbXBsZXRlLmNhbGwoJHQsZGF0YSxwb3N0ZGF0YSk7fSw1MDApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRycF9nZVskdC5wLmlkXS5wcm9jZXNzaW5nPWZhbHNlO1xyXG5cdFx0XHRcdFx0XHRcdFx0JChcIiNkRGF0YVwiLCBcIiNcIitkdGJsK1wiXzJcIikucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWFjdGl2ZScpO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYocmV0WzBdKSB7JC5qZ3JpZC5oaWRlTW9kYWwoXCIjXCIrJC5qZ3JpZC5qcUlEKElEcy50aGVtb2RhbCkse2diOlwiI2dib3hfXCIrJC5qZ3JpZC5qcUlEKGdJRCksanFtOnAuanFNb2RhbCwgb25DbG9zZTogcnBfZ2VbJHQucC5pZF0ub25DbG9zZX0pO31cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0sICQuamdyaWQuYWpheE9wdGlvbnMsIHJwX2dlWyR0LnAuaWRdLmFqYXhEZWxPcHRpb25zKTtcclxuXHJcblxyXG5cdFx0XHRcdFx0XHRpZiAoIWFqYXhPcHRpb25zLnVybCAmJiAhcnBfZ2VbJHQucC5pZF0udXNlRGF0YVByb3h5KSB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKCQuaXNGdW5jdGlvbigkdC5wLmRhdGFQcm94eSkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHJwX2dlWyR0LnAuaWRdLnVzZURhdGFQcm94eSA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdHJldFswXT1mYWxzZTtyZXRbMV0gKz0gXCIgXCIrJC5qZ3JpZC5lcnJvcnMubm91cmw7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmIChyZXRbMF0pIHtcclxuXHRcdFx0XHRcdFx0XHRpZiAocnBfZ2VbJHQucC5pZF0udXNlRGF0YVByb3h5KSB7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgZHByZXQgPSAkdC5wLmRhdGFQcm94eS5jYWxsKCR0LCBhamF4T3B0aW9ucywgXCJkZWxfXCIrJHQucC5pZCk7XHJcblx0XHRcdFx0XHRcdFx0XHRpZihkcHJldCA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGRwcmV0ID0gW3RydWUsIFwiXCJdO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0aWYoZHByZXRbMF0gPT09IGZhbHNlICkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRyZXRbMF0gPSBmYWxzZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0cmV0WzFdID0gZHByZXRbMV0gfHwgXCJFcnJvciBkZWxldGluZyB0aGUgc2VsZWN0ZWQgcm93IVwiIDtcclxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQuamdyaWQuaGlkZU1vZGFsKFwiI1wiKyQuamdyaWQuanFJRChJRHMudGhlbW9kYWwpLHtnYjpcIiNnYm94X1wiKyQuamdyaWQuanFJRChnSUQpLGpxbTpwLmpxTW9kYWwsIG9uQ2xvc2U6IHJwX2dlWyR0LnAuaWRdLm9uQ2xvc2V9KTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0ZWxzZSB7JC5hamF4KGFqYXhPcHRpb25zKTt9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRpZihyZXRbMF0gPT09IGZhbHNlKSB7XHJcblx0XHRcdFx0XHRcdCQoXCIjRGVsRXJyb3I+dGRcIixcIiNcIitkdGJsKS5odG1sKHJldFsxXSk7XHJcblx0XHRcdFx0XHRcdCQoXCIjRGVsRXJyb3JcIixcIiNcIitkdGJsKS5zaG93KCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0JChcIiNlRGF0YVwiLCBcIiNcIitkdGJsK1wiXzJcIikuY2xpY2soZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdCQuamdyaWQuaGlkZU1vZGFsKFwiI1wiKyQuamdyaWQuanFJRChJRHMudGhlbW9kYWwpLHtnYjpcIiNnYm94X1wiKyQuamdyaWQuanFJRChnSUQpLGpxbTpycF9nZVskdC5wLmlkXS5qcU1vZGFsLCBvbkNsb3NlOiBycF9nZVskdC5wLmlkXS5vbkNsb3NlfSk7XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aWYob25CZWZvcmVTaG93KSB7cnBfZ2VbJHQucC5pZF0uYmVmb3JlU2hvd0Zvcm0uY2FsbCgkdCwkKFwiI1wiK2R0YmwpKTt9XHJcblx0XHRcdFx0JC5qZ3JpZC52aWV3TW9kYWwoXCIjXCIrJC5qZ3JpZC5qcUlEKElEcy50aGVtb2RhbCkse2dib3g6XCIjZ2JveF9cIiskLmpncmlkLmpxSUQoZ0lEKSxqcW06cnBfZ2VbJHQucC5pZF0uanFNb2RhbCwgb3ZlcmxheTogcnBfZ2VbJHQucC5pZF0ub3ZlcmxheSwgbW9kYWw6cnBfZ2VbJHQucC5pZF0ubW9kYWx9KTtcclxuXHRcdFx0XHRpZihvbkFmdGVyU2hvdykge3JwX2dlWyR0LnAuaWRdLmFmdGVyU2hvd0Zvcm0uY2FsbCgkdCwkKFwiI1wiK2R0YmwpKTt9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYocnBfZ2VbJHQucC5pZF0uY2xvc2VPbkVzY2FwZT09PXRydWUpIHtcclxuXHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7JChcIi51aS1qcWRpYWxvZy10aXRsZWJhci1jbG9zZVwiLFwiI1wiKyQuamdyaWQuanFJRChJRHMubW9kYWxoZWFkKSkuZm9jdXMoKTt9LDApO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdG5hdkdyaWQgOiBmdW5jdGlvbiAoZWxlbSwgbywgcEVkaXQscEFkZCxwRGVsLHBTZWFyY2gsIHBWaWV3KSB7XHJcblx0XHRvID0gJC5leHRlbmQoe1xyXG5cdFx0XHRlZGl0OiB0cnVlLFxyXG5cdFx0XHRlZGl0aWNvbjogXCJ1aS1pY29uLXBlbmNpbFwiLFxyXG5cdFx0XHRhZGQ6IHRydWUsXHJcblx0XHRcdGFkZGljb246XCJ1aS1pY29uLXBsdXNcIixcclxuXHRcdFx0ZGVsOiB0cnVlLFxyXG5cdFx0XHRkZWxpY29uOlwidWktaWNvbi10cmFzaFwiLFxyXG5cdFx0XHRzZWFyY2g6IHRydWUsXHJcblx0XHRcdHNlYXJjaGljb246XCJ1aS1pY29uLXNlYXJjaFwiLFxyXG5cdFx0XHRyZWZyZXNoOiB0cnVlLFxyXG5cdFx0XHRyZWZyZXNoaWNvbjpcInVpLWljb24tcmVmcmVzaFwiLFxyXG5cdFx0XHRyZWZyZXNoc3RhdGU6ICdmaXJzdHBhZ2UnLFxyXG5cdFx0XHR2aWV3OiBmYWxzZSxcclxuXHRcdFx0dmlld2ljb24gOiBcInVpLWljb24tZG9jdW1lbnRcIixcclxuXHRcdFx0cG9zaXRpb24gOiBcImxlZnRcIixcclxuXHRcdFx0Y2xvc2VPbkVzY2FwZSA6IHRydWUsXHJcblx0XHRcdGJlZm9yZVJlZnJlc2ggOiBudWxsLFxyXG5cdFx0XHRhZnRlclJlZnJlc2ggOiBudWxsLFxyXG5cdFx0XHRjbG9uZVRvVG9wIDogZmFsc2UsXHJcblx0XHRcdGFsZXJ0d2lkdGggOiAyMDAsXHJcblx0XHRcdGFsZXJ0aGVpZ2h0IDogJ2F1dG8nLFxyXG5cdFx0XHRhbGVydHRvcDogbnVsbCxcclxuXHRcdFx0YWxlcnRsZWZ0OiBudWxsLFxyXG5cdFx0XHRhbGVydHpJbmRleCA6IG51bGxcclxuXHRcdH0sICQuamdyaWQubmF2LCBvIHx8e30pO1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYodGhpcy5uYXYpIHtyZXR1cm47fVxyXG5cdFx0XHR2YXIgYWxlcnRJRHMgPSB7dGhlbW9kYWw6ICdhbGVydG1vZF8nICsgdGhpcy5wLmlkLCBtb2RhbGhlYWQ6ICdhbGVydGhkXycgKyB0aGlzLnAuaWQsbW9kYWxjb250ZW50OiAnYWxlcnRjbnRfJyArIHRoaXMucC5pZH0sXHJcblx0XHRcdCR0ID0gdGhpcywgdHdkLCB0ZHc7XHJcblx0XHRcdGlmKCEkdC5ncmlkIHx8IHR5cGVvZiBlbGVtICE9PSAnc3RyaW5nJykge3JldHVybjt9XHJcblx0XHRcdGlmICgkKFwiI1wiK2FsZXJ0SURzLnRoZW1vZGFsKVswXSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0aWYoIW8uYWxlcnR0b3AgJiYgIW8uYWxlcnRsZWZ0KSB7XHJcblx0XHRcdFx0XHRpZiAod2luZG93LmlubmVyV2lkdGggIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0XHRvLmFsZXJ0bGVmdCA9IHdpbmRvdy5pbm5lcldpZHRoO1xyXG5cdFx0XHRcdFx0XHRvLmFsZXJ0dG9wID0gd2luZG93LmlubmVySGVpZ2h0O1xyXG5cdFx0XHRcdFx0fSBlbHNlIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgIT09IHVuZGVmaW5lZCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggIT09IHVuZGVmaW5lZCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggIT09IDApIHtcclxuXHRcdFx0XHRcdFx0by5hbGVydGxlZnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGg7XHJcblx0XHRcdFx0XHRcdG8uYWxlcnR0b3AgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0O1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0by5hbGVydGxlZnQ9MTAyNDtcclxuXHRcdFx0XHRcdFx0by5hbGVydHRvcD03Njg7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRvLmFsZXJ0bGVmdCA9IG8uYWxlcnRsZWZ0LzIgLSBwYXJzZUludChvLmFsZXJ0d2lkdGgsMTApLzI7XHJcblx0XHRcdFx0XHRvLmFsZXJ0dG9wID0gby5hbGVydHRvcC8yLTI1O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQkLmpncmlkLmNyZWF0ZU1vZGFsKGFsZXJ0SURzLFxyXG5cdFx0XHRcdFx0XCI8ZGl2PlwiK28uYWxlcnR0ZXh0K1wiPC9kaXY+PHNwYW4gdGFiaW5kZXg9JzAnPjxzcGFuIHRhYmluZGV4PSctMScgaWQ9J2pxZ19hbHJ0Jz48L3NwYW4+PC9zcGFuPlwiLFxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRnYm94OlwiI2dib3hfXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpLFxyXG5cdFx0XHRcdFx0XHRqcU1vZGFsOnRydWUsXHJcblx0XHRcdFx0XHRcdGRyYWc6dHJ1ZSxcclxuXHRcdFx0XHRcdFx0cmVzaXplOnRydWUsXHJcblx0XHRcdFx0XHRcdGNhcHRpb246by5hbGVydGNhcCxcclxuXHRcdFx0XHRcdFx0dG9wOm8uYWxlcnR0b3AsXHJcblx0XHRcdFx0XHRcdGxlZnQ6by5hbGVydGxlZnQsXHJcblx0XHRcdFx0XHRcdHdpZHRoOm8uYWxlcnR3aWR0aCxcclxuXHRcdFx0XHRcdFx0aGVpZ2h0OiBvLmFsZXJ0aGVpZ2h0LFxyXG5cdFx0XHRcdFx0XHRjbG9zZU9uRXNjYXBlOm8uY2xvc2VPbkVzY2FwZSxcclxuXHRcdFx0XHRcdFx0ekluZGV4OiBvLmFsZXJ0ekluZGV4XHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XCIjZ3ZpZXdfXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpLFxyXG5cdFx0XHRcdFx0JChcIiNnYm94X1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKSlbMF0sXHJcblx0XHRcdFx0XHR0cnVlXHJcblx0XHRcdFx0KTtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgY2xvbmUgPSAxLCBpLFxyXG5cdFx0XHRvbkhvdmVySW4gPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0aWYgKCEkKHRoaXMpLmhhc0NsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpKSB7XHJcblx0XHRcdFx0XHQkKHRoaXMpLmFkZENsYXNzKFwidWktc3RhdGUtaG92ZXJcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRvbkhvdmVyT3V0ID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdCQodGhpcykucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1ob3ZlclwiKTtcclxuXHRcdFx0fTtcclxuXHRcdFx0aWYoby5jbG9uZVRvVG9wICYmICR0LnAudG9wcGFnZXIpIHtjbG9uZSA9IDI7fVxyXG5cdFx0XHRmb3IoaSA9IDA7IGk8Y2xvbmU7IGkrKykge1xyXG5cdFx0XHRcdHZhciB0YmQsXHJcblx0XHRcdFx0bmF2dGJsID0gJChcIjx0YWJsZSBjZWxsc3BhY2luZz0nMCcgY2VsbHBhZGRpbmc9JzAnIGJvcmRlcj0nMCcgY2xhc3M9J3VpLXBnLXRhYmxlIG5hdnRhYmxlJyBzdHlsZT0nZmxvYXQ6bGVmdDt0YWJsZS1sYXlvdXQ6YXV0bzsnPjx0Ym9keT48dHI+PC90cj48L3Rib2R5PjwvdGFibGU+XCIpLFxyXG5cdFx0XHRcdHNlcCA9IFwiPHRkIGNsYXNzPSd1aS1wZy1idXR0b24gdWktc3RhdGUtZGlzYWJsZWQnIHN0eWxlPSd3aWR0aDo0cHg7Jz48c3BhbiBjbGFzcz0ndWktc2VwYXJhdG9yJz48L3NwYW4+PC90ZD5cIixcclxuXHRcdFx0XHRwZ2lkLCBlbGVtaWRzO1xyXG5cdFx0XHRcdGlmKGk9PT0wKSB7XHJcblx0XHRcdFx0XHRwZ2lkID0gZWxlbTtcclxuXHRcdFx0XHRcdGVsZW1pZHMgPSAkdC5wLmlkO1xyXG5cdFx0XHRcdFx0aWYocGdpZCA9PT0gJHQucC50b3BwYWdlcikge1xyXG5cdFx0XHRcdFx0XHRlbGVtaWRzICs9IFwiX3RvcFwiO1xyXG5cdFx0XHRcdFx0XHRjbG9uZSA9IDE7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHBnaWQgPSAkdC5wLnRvcHBhZ2VyO1xyXG5cdFx0XHRcdFx0ZWxlbWlkcyA9ICR0LnAuaWQrXCJfdG9wXCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKCR0LnAuZGlyZWN0aW9uID09PSBcInJ0bFwiKSB7JChuYXZ0YmwpLmF0dHIoXCJkaXJcIixcInJ0bFwiKS5jc3MoXCJmbG9hdFwiLFwicmlnaHRcIik7fVxyXG5cdFx0XHRcdGlmIChvLmFkZCkge1xyXG5cdFx0XHRcdFx0cEFkZCA9IHBBZGQgfHwge307XHJcblx0XHRcdFx0XHR0YmQgPSAkKFwiPHRkIGNsYXNzPSd1aS1wZy1idXR0b24gdWktY29ybmVyLWFsbCc+PC90ZD5cIik7XHJcblx0XHRcdFx0XHQkKHRiZCkuYXBwZW5kKFwiPGRpdiBjbGFzcz0ndWktcGctZGl2Jz48c3BhbiBjbGFzcz0ndWktaWNvbiBcIitvLmFkZGljb24rXCInPjwvc3Bhbj5cIitvLmFkZHRleHQrXCI8L2Rpdj5cIik7XHJcblx0XHRcdFx0XHQkKFwidHJcIixuYXZ0YmwpLmFwcGVuZCh0YmQpO1xyXG5cdFx0XHRcdFx0JCh0YmQsbmF2dGJsKVxyXG5cdFx0XHRcdFx0LmF0dHIoe1widGl0bGVcIjpvLmFkZHRpdGxlIHx8IFwiXCIsaWQgOiBwQWRkLmlkIHx8IFwiYWRkX1wiK2VsZW1pZHN9KVxyXG5cdFx0XHRcdFx0LmNsaWNrKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRcdGlmICghJCh0aGlzKS5oYXNDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKSkge1xyXG5cdFx0XHRcdFx0XHRcdGlmICgkLmlzRnVuY3Rpb24oIG8uYWRkZnVuYyApKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRvLmFkZGZ1bmMuY2FsbCgkdCk7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcImVkaXRHcmlkUm93XCIsXCJuZXdcIixwQWRkKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0fSkuaG92ZXIob25Ib3ZlckluLCBvbkhvdmVyT3V0KTtcclxuXHRcdFx0XHRcdHRiZCA9IG51bGw7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmIChvLmVkaXQpIHtcclxuXHRcdFx0XHRcdHRiZCA9ICQoXCI8dGQgY2xhc3M9J3VpLXBnLWJ1dHRvbiB1aS1jb3JuZXItYWxsJz48L3RkPlwiKTtcclxuXHRcdFx0XHRcdHBFZGl0ID0gcEVkaXQgfHwge307XHJcblx0XHRcdFx0XHQkKHRiZCkuYXBwZW5kKFwiPGRpdiBjbGFzcz0ndWktcGctZGl2Jz48c3BhbiBjbGFzcz0ndWktaWNvbiBcIitvLmVkaXRpY29uK1wiJz48L3NwYW4+XCIrby5lZGl0dGV4dCtcIjwvZGl2PlwiKTtcclxuXHRcdFx0XHRcdCQoXCJ0clwiLG5hdnRibCkuYXBwZW5kKHRiZCk7XHJcblx0XHRcdFx0XHQkKHRiZCxuYXZ0YmwpXHJcblx0XHRcdFx0XHQuYXR0cih7XCJ0aXRsZVwiOm8uZWRpdHRpdGxlIHx8IFwiXCIsaWQ6IHBFZGl0LmlkIHx8IFwiZWRpdF9cIitlbGVtaWRzfSlcclxuXHRcdFx0XHRcdC5jbGljayhmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0XHRpZiAoISQodGhpcykuaGFzQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJykpIHtcclxuXHRcdFx0XHRcdFx0XHR2YXIgc3IgPSAkdC5wLnNlbHJvdztcclxuXHRcdFx0XHRcdFx0XHRpZiAoc3IpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbiggby5lZGl0ZnVuYyApICkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRvLmVkaXRmdW5jLmNhbGwoJHQsIHNyKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcImVkaXRHcmlkUm93XCIsc3IscEVkaXQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkLmpncmlkLnZpZXdNb2RhbChcIiNcIithbGVydElEcy50aGVtb2RhbCx7Z2JveDpcIiNnYm94X1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKSxqcW06dHJ1ZX0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0JChcIiNqcWdfYWxydFwiKS5mb2N1cygpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHR9KS5ob3ZlcihvbkhvdmVySW4sIG9uSG92ZXJPdXQpO1xyXG5cdFx0XHRcdFx0dGJkID0gbnVsbDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKG8udmlldykge1xyXG5cdFx0XHRcdFx0dGJkID0gJChcIjx0ZCBjbGFzcz0ndWktcGctYnV0dG9uIHVpLWNvcm5lci1hbGwnPjwvdGQ+XCIpO1xyXG5cdFx0XHRcdFx0cFZpZXcgPSBwVmlldyB8fCB7fTtcclxuXHRcdFx0XHRcdCQodGJkKS5hcHBlbmQoXCI8ZGl2IGNsYXNzPSd1aS1wZy1kaXYnPjxzcGFuIGNsYXNzPSd1aS1pY29uIFwiK28udmlld2ljb24rXCInPjwvc3Bhbj5cIitvLnZpZXd0ZXh0K1wiPC9kaXY+XCIpO1xyXG5cdFx0XHRcdFx0JChcInRyXCIsbmF2dGJsKS5hcHBlbmQodGJkKTtcclxuXHRcdFx0XHRcdCQodGJkLG5hdnRibClcclxuXHRcdFx0XHRcdC5hdHRyKHtcInRpdGxlXCI6by52aWV3dGl0bGUgfHwgXCJcIixpZDogcFZpZXcuaWQgfHwgXCJ2aWV3X1wiK2VsZW1pZHN9KVxyXG5cdFx0XHRcdFx0LmNsaWNrKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRcdGlmICghJCh0aGlzKS5oYXNDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKSkge1xyXG5cdFx0XHRcdFx0XHRcdHZhciBzciA9ICR0LnAuc2Vscm93O1xyXG5cdFx0XHRcdFx0XHRcdGlmIChzcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoJC5pc0Z1bmN0aW9uKCBvLnZpZXdmdW5jICkgKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdG8udmlld2Z1bmMuY2FsbCgkdCwgc3IpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwidmlld0dyaWRSb3dcIixzcixwVmlldyk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQuamdyaWQudmlld01vZGFsKFwiI1wiK2FsZXJ0SURzLnRoZW1vZGFsLHtnYm94OlwiI2dib3hfXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpLGpxbTp0cnVlfSk7XHJcblx0XHRcdFx0XHRcdFx0XHQkKFwiI2pxZ19hbHJ0XCIpLmZvY3VzKCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdH0pLmhvdmVyKG9uSG92ZXJJbiwgb25Ib3Zlck91dCk7XHJcblx0XHRcdFx0XHR0YmQgPSBudWxsO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoby5kZWwpIHtcclxuXHRcdFx0XHRcdHRiZCA9ICQoXCI8dGQgY2xhc3M9J3VpLXBnLWJ1dHRvbiB1aS1jb3JuZXItYWxsJz48L3RkPlwiKTtcclxuXHRcdFx0XHRcdHBEZWwgPSBwRGVsIHx8IHt9O1xyXG5cdFx0XHRcdFx0JCh0YmQpLmFwcGVuZChcIjxkaXYgY2xhc3M9J3VpLXBnLWRpdic+PHNwYW4gY2xhc3M9J3VpLWljb24gXCIrby5kZWxpY29uK1wiJz48L3NwYW4+XCIrby5kZWx0ZXh0K1wiPC9kaXY+XCIpO1xyXG5cdFx0XHRcdFx0JChcInRyXCIsbmF2dGJsKS5hcHBlbmQodGJkKTtcclxuXHRcdFx0XHRcdCQodGJkLG5hdnRibClcclxuXHRcdFx0XHRcdC5hdHRyKHtcInRpdGxlXCI6by5kZWx0aXRsZSB8fCBcIlwiLGlkOiBwRGVsLmlkIHx8IFwiZGVsX1wiK2VsZW1pZHN9KVxyXG5cdFx0XHRcdFx0LmNsaWNrKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRcdGlmICghJCh0aGlzKS5oYXNDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKSkge1xyXG5cdFx0XHRcdFx0XHRcdHZhciBkcjtcclxuXHRcdFx0XHRcdFx0XHRpZigkdC5wLm11bHRpc2VsZWN0KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRkciA9ICR0LnAuc2VsYXJycm93O1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoZHIubGVuZ3RoPT09MCkge2RyID0gbnVsbDt9XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdGRyID0gJHQucC5zZWxyb3c7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdGlmKGRyKXtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbiggby5kZWxmdW5jICkpe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRvLmRlbGZ1bmMuY2FsbCgkdCwgZHIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcImRlbEdyaWRSb3dcIixkcixwRGVsKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9IGVsc2UgIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQuamdyaWQudmlld01vZGFsKFwiI1wiK2FsZXJ0SURzLnRoZW1vZGFsLHtnYm94OlwiI2dib3hfXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpLGpxbTp0cnVlfSk7JChcIiNqcWdfYWxydFwiKS5mb2N1cygpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHR9KS5ob3ZlcihvbkhvdmVySW4sIG9uSG92ZXJPdXQpO1xyXG5cdFx0XHRcdFx0dGJkID0gbnVsbDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoby5hZGQgfHwgby5lZGl0IHx8IG8uZGVsIHx8IG8udmlldykgeyQoXCJ0clwiLG5hdnRibCkuYXBwZW5kKHNlcCk7fVxyXG5cdFx0XHRcdGlmIChvLnNlYXJjaCkge1xyXG5cdFx0XHRcdFx0dGJkID0gJChcIjx0ZCBjbGFzcz0ndWktcGctYnV0dG9uIHVpLWNvcm5lci1hbGwnPjwvdGQ+XCIpO1xyXG5cdFx0XHRcdFx0cFNlYXJjaCA9IHBTZWFyY2ggfHwge307XHJcblx0XHRcdFx0XHQkKHRiZCkuYXBwZW5kKFwiPGRpdiBjbGFzcz0ndWktcGctZGl2Jz48c3BhbiBjbGFzcz0ndWktaWNvbiBcIitvLnNlYXJjaGljb24rXCInPjwvc3Bhbj5cIitvLnNlYXJjaHRleHQrXCI8L2Rpdj5cIik7XHJcblx0XHRcdFx0XHQkKFwidHJcIixuYXZ0YmwpLmFwcGVuZCh0YmQpO1xyXG5cdFx0XHRcdFx0JCh0YmQsbmF2dGJsKVxyXG5cdFx0XHRcdFx0LmF0dHIoe1widGl0bGVcIjpvLnNlYXJjaHRpdGxlICB8fCBcIlwiLGlkOnBTZWFyY2guaWQgfHwgXCJzZWFyY2hfXCIrZWxlbWlkc30pXHJcblx0XHRcdFx0XHQuY2xpY2soZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdFx0aWYgKCEkKHRoaXMpLmhhc0NsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYoJC5pc0Z1bmN0aW9uKCBvLnNlYXJjaGZ1bmMgKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0by5zZWFyY2hmdW5jLmNhbGwoJHQsIHBTZWFyY2gpO1xyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJzZWFyY2hHcmlkXCIscFNlYXJjaCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdH0pLmhvdmVyKG9uSG92ZXJJbiwgb25Ib3Zlck91dCk7XHJcblx0XHRcdFx0XHRpZiAocFNlYXJjaC5zaG93T25Mb2FkICYmIHBTZWFyY2guc2hvd09uTG9hZCA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdFx0XHQkKHRiZCxuYXZ0YmwpLmNsaWNrKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR0YmQgPSBudWxsO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoby5yZWZyZXNoKSB7XHJcblx0XHRcdFx0XHR0YmQgPSAkKFwiPHRkIGNsYXNzPSd1aS1wZy1idXR0b24gdWktY29ybmVyLWFsbCc+PC90ZD5cIik7XHJcblx0XHRcdFx0XHQkKHRiZCkuYXBwZW5kKFwiPGRpdiBjbGFzcz0ndWktcGctZGl2Jz48c3BhbiBjbGFzcz0ndWktaWNvbiBcIitvLnJlZnJlc2hpY29uK1wiJz48L3NwYW4+XCIrby5yZWZyZXNodGV4dCtcIjwvZGl2PlwiKTtcclxuXHRcdFx0XHRcdCQoXCJ0clwiLG5hdnRibCkuYXBwZW5kKHRiZCk7XHJcblx0XHRcdFx0XHQkKHRiZCxuYXZ0YmwpXHJcblx0XHRcdFx0XHQuYXR0cih7XCJ0aXRsZVwiOm8ucmVmcmVzaHRpdGxlICB8fCBcIlwiLGlkOiBcInJlZnJlc2hfXCIrZWxlbWlkc30pXHJcblx0XHRcdFx0XHQuY2xpY2soZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdFx0aWYgKCEkKHRoaXMpLmhhc0NsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYoJC5pc0Z1bmN0aW9uKG8uYmVmb3JlUmVmcmVzaCkpIHtvLmJlZm9yZVJlZnJlc2guY2FsbCgkdCk7fVxyXG5cdFx0XHRcdFx0XHRcdCR0LnAuc2VhcmNoID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdFx0JHQucC5yZXNldHNlYXJjaCA9ICB0cnVlO1xyXG5cdFx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgZ0lEID0gJHQucC5pZDtcclxuXHRcdFx0XHRcdFx0XHRcdCR0LnAucG9zdERhdGEuZmlsdGVycyA9XCJcIjtcclxuXHRcdFx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKFwiI2Zib3hfXCIrJC5qZ3JpZC5qcUlEKGdJRCkpLmpxRmlsdGVyKCdyZXNldEZpbHRlcicpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBjYXRjaChlZikge31cclxuXHRcdFx0XHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbigkdC5jbGVhclRvb2xiYXIpKSB7JHQuY2xlYXJUb29sYmFyLmNhbGwoJHQsZmFsc2UpO31cclxuXHRcdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7fVxyXG5cdFx0XHRcdFx0XHRcdHN3aXRjaCAoby5yZWZyZXNoc3RhdGUpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGNhc2UgJ2ZpcnN0cGFnZSc6XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQoJHQpLnRyaWdnZXIoXCJyZWxvYWRHcmlkXCIsIFt7cGFnZToxfV0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRcdGNhc2UgJ2N1cnJlbnQnOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHQkKCR0KS50cmlnZ2VyKFwicmVsb2FkR3JpZFwiLCBbe2N1cnJlbnQ6dHJ1ZX1dKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbihvLmFmdGVyUmVmcmVzaCkpIHtvLmFmdGVyUmVmcmVzaC5jYWxsKCR0KTt9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0fSkuaG92ZXIob25Ib3ZlckluLCBvbkhvdmVyT3V0KTtcclxuXHRcdFx0XHRcdHRiZCA9IG51bGw7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHRkdyA9ICQoXCIudWktanFncmlkXCIpLmNzcyhcImZvbnQtc2l6ZVwiKSB8fCBcIjExcHhcIjtcclxuXHRcdFx0XHQkKCdib2R5JykuYXBwZW5kKFwiPGRpdiBpZD0ndGVzdHBnMicgY2xhc3M9J3VpLWpxZ3JpZCB1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQnIHN0eWxlPSdmb250LXNpemU6XCIrdGR3K1wiO3Zpc2liaWxpdHk6aGlkZGVuOycgPjwvZGl2PlwiKTtcclxuXHRcdFx0XHR0d2QgPSAkKG5hdnRibCkuY2xvbmUoKS5hcHBlbmRUbyhcIiN0ZXN0cGcyXCIpLndpZHRoKCk7XHJcblx0XHRcdFx0JChcIiN0ZXN0cGcyXCIpLnJlbW92ZSgpO1xyXG5cdFx0XHRcdCQocGdpZCtcIl9cIitvLnBvc2l0aW9uLHBnaWQpLmFwcGVuZChuYXZ0YmwpO1xyXG5cdFx0XHRcdGlmKCR0LnAuX252dGQpIHtcclxuXHRcdFx0XHRcdGlmKHR3ZCA+ICR0LnAuX252dGRbMF0gKSB7XHJcblx0XHRcdFx0XHRcdCQocGdpZCtcIl9cIitvLnBvc2l0aW9uLHBnaWQpLndpZHRoKHR3ZCk7XHJcblx0XHRcdFx0XHRcdCR0LnAuX252dGRbMF0gPSB0d2Q7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQkdC5wLl9udnRkWzFdID0gdHdkO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0ZHcgPW51bGw7dHdkPW51bGw7bmF2dGJsID1udWxsO1xyXG5cdFx0XHRcdHRoaXMubmF2ID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRuYXZCdXR0b25BZGQgOiBmdW5jdGlvbiAoZWxlbSwgcCkge1xyXG5cdFx0cCA9ICQuZXh0ZW5kKHtcclxuXHRcdFx0Y2FwdGlvbiA6IFwibmV3QnV0dG9uXCIsXHJcblx0XHRcdHRpdGxlOiAnJyxcclxuXHRcdFx0YnV0dG9uaWNvbiA6ICd1aS1pY29uLW5ld3dpbicsXHJcblx0XHRcdG9uQ2xpY2tCdXR0b246IG51bGwsXHJcblx0XHRcdHBvc2l0aW9uIDogXCJsYXN0XCIsXHJcblx0XHRcdGN1cnNvciA6ICdwb2ludGVyJ1xyXG5cdFx0fSwgcCB8fHt9KTtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmKCAhdGhpcy5ncmlkKSAge3JldHVybjt9XHJcblx0XHRcdGlmKCB0eXBlb2YgZWxlbSA9PT0gXCJzdHJpbmdcIiAmJiBlbGVtLmluZGV4T2YoXCIjXCIpICE9PSAwKSB7ZWxlbSA9IFwiI1wiKyQuamdyaWQuanFJRChlbGVtKTt9XHJcblx0XHRcdHZhciBmaW5kbmF2ID0gJChcIi5uYXZ0YWJsZVwiLGVsZW0pWzBdLCAkdCA9IHRoaXM7XHJcblx0XHRcdGlmIChmaW5kbmF2KSB7XHJcblx0XHRcdFx0aWYoIHAuaWQgJiYgJChcIiNcIiskLmpncmlkLmpxSUQocC5pZCksIGZpbmRuYXYpWzBdICE9PSB1bmRlZmluZWQgKSAge3JldHVybjt9XHJcblx0XHRcdFx0dmFyIHRiZCA9ICQoXCI8dGQ+PC90ZD5cIik7XHJcblx0XHRcdFx0aWYocC5idXR0b25pY29uLnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKSA9PT0gXCJOT05FXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAkKHRiZCkuYWRkQ2xhc3MoJ3VpLXBnLWJ1dHRvbiB1aS1jb3JuZXItYWxsJykuYXBwZW5kKFwiPGRpdiBjbGFzcz0ndWktcGctZGl2Jz5cIitwLmNhcHRpb24rXCI8L2Rpdj5cIik7XHJcblx0XHRcdFx0fSBlbHNlXHR7XHJcblx0XHRcdFx0XHQkKHRiZCkuYWRkQ2xhc3MoJ3VpLXBnLWJ1dHRvbiB1aS1jb3JuZXItYWxsJykuYXBwZW5kKFwiPGRpdiBjbGFzcz0ndWktcGctZGl2Jz48c3BhbiBjbGFzcz0ndWktaWNvbiBcIitwLmJ1dHRvbmljb24rXCInPjwvc3Bhbj5cIitwLmNhcHRpb24rXCI8L2Rpdj5cIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKHAuaWQpIHskKHRiZCkuYXR0cihcImlkXCIscC5pZCk7fVxyXG5cdFx0XHRcdGlmKHAucG9zaXRpb249PT0nZmlyc3QnKXtcclxuXHRcdFx0XHRcdGlmKGZpbmRuYXYucm93c1swXS5jZWxscy5sZW5ndGggPT09MCApIHtcclxuXHRcdFx0XHRcdFx0JChcInRyXCIsZmluZG5hdikuYXBwZW5kKHRiZCk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQkKFwidHIgdGQ6ZXEoMClcIixmaW5kbmF2KS5iZWZvcmUodGJkKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JChcInRyXCIsZmluZG5hdikuYXBwZW5kKHRiZCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCQodGJkLGZpbmRuYXYpXHJcblx0XHRcdFx0LmF0dHIoXCJ0aXRsZVwiLHAudGl0bGUgIHx8IFwiXCIpXHJcblx0XHRcdFx0LmNsaWNrKGZ1bmN0aW9uKGUpe1xyXG5cdFx0XHRcdFx0aWYgKCEkKHRoaXMpLmhhc0NsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpKSB7XHJcblx0XHRcdFx0XHRcdGlmICgkLmlzRnVuY3Rpb24ocC5vbkNsaWNrQnV0dG9uKSApIHtwLm9uQ2xpY2tCdXR0b24uY2FsbCgkdCxlKTt9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHQuaG92ZXIoXHJcblx0XHRcdFx0XHRmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0XHRcdGlmICghJCh0aGlzKS5oYXNDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKSkge1xyXG5cdFx0XHRcdFx0XHRcdCQodGhpcykuYWRkQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRmdW5jdGlvbiAoKSB7JCh0aGlzKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWhvdmVyXCIpO31cclxuXHRcdFx0XHQpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdG5hdlNlcGFyYXRvckFkZDpmdW5jdGlvbiAoZWxlbSxwKSB7XHJcblx0XHRwID0gJC5leHRlbmQoe1xyXG5cdFx0XHRzZXBjbGFzcyA6IFwidWktc2VwYXJhdG9yXCIsXHJcblx0XHRcdHNlcGNvbnRlbnQ6ICcnLFxyXG5cdFx0XHRwb3NpdGlvbiA6IFwibGFzdFwiXHJcblx0XHR9LCBwIHx8e30pO1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYoICF0aGlzLmdyaWQpICB7cmV0dXJuO31cclxuXHRcdFx0aWYoIHR5cGVvZiBlbGVtID09PSBcInN0cmluZ1wiICYmIGVsZW0uaW5kZXhPZihcIiNcIikgIT09IDApIHtlbGVtID0gXCIjXCIrJC5qZ3JpZC5qcUlEKGVsZW0pO31cclxuXHRcdFx0dmFyIGZpbmRuYXYgPSAkKFwiLm5hdnRhYmxlXCIsZWxlbSlbMF07XHJcblx0XHRcdGlmKGZpbmRuYXYpIHtcclxuXHRcdFx0XHR2YXIgc2VwID0gXCI8dGQgY2xhc3M9J3VpLXBnLWJ1dHRvbiB1aS1zdGF0ZS1kaXNhYmxlZCcgc3R5bGU9J3dpZHRoOjRweDsnPjxzcGFuIGNsYXNzPSdcIitwLnNlcGNsYXNzK1wiJz48L3NwYW4+XCIrcC5zZXBjb250ZW50K1wiPC90ZD5cIjtcclxuXHRcdFx0XHRpZiAocC5wb3NpdGlvbiA9PT0gJ2ZpcnN0Jykge1xyXG5cdFx0XHRcdFx0aWYgKGZpbmRuYXYucm93c1swXS5jZWxscy5sZW5ndGggPT09IDApIHtcclxuXHRcdFx0XHRcdFx0JChcInRyXCIsIGZpbmRuYXYpLmFwcGVuZChzZXApO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0JChcInRyIHRkOmVxKDApXCIsIGZpbmRuYXYpLmJlZm9yZShzZXApO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQkKFwidHJcIiwgZmluZG5hdikuYXBwZW5kKHNlcCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdEdyaWRUb0Zvcm0gOiBmdW5jdGlvbiggcm93aWQsIGZvcm1pZCApIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyICR0ID0gdGhpcywgaTtcclxuXHRcdFx0aWYgKCEkdC5ncmlkKSB7cmV0dXJuO31cclxuXHRcdFx0dmFyIHJvd2RhdGEgPSAkKCR0KS5qcUdyaWQoXCJnZXRSb3dEYXRhXCIscm93aWQpO1xyXG5cdFx0XHRpZiAocm93ZGF0YSkge1xyXG5cdFx0XHRcdGZvcihpIGluIHJvd2RhdGEpIHtcclxuXHRcdFx0XHRcdGlmKHJvd2RhdGEuaGFzT3duUHJvcGVydHkoaSkpIHtcclxuXHRcdFx0XHRcdGlmICggJChcIltuYW1lPVwiKyQuamdyaWQuanFJRChpKStcIl1cIixmb3JtaWQpLmlzKFwiaW5wdXQ6cmFkaW9cIikgfHwgJChcIltuYW1lPVwiKyQuamdyaWQuanFJRChpKStcIl1cIixmb3JtaWQpLmlzKFwiaW5wdXQ6Y2hlY2tib3hcIikpICB7XHJcblx0XHRcdFx0XHRcdCQoXCJbbmFtZT1cIiskLmpncmlkLmpxSUQoaSkrXCJdXCIsZm9ybWlkKS5lYWNoKCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRpZiggJCh0aGlzKS52YWwoKSA9PSByb3dkYXRhW2ldICkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCh0aGlzKVskdC5wLnVzZVByb3AgPyAncHJvcCc6ICdhdHRyJ10oXCJjaGVja2VkXCIsdHJ1ZSk7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQodGhpcylbJHQucC51c2VQcm9wID8gJ3Byb3AnOiAnYXR0ciddKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQvLyB0aGlzIGlzIHZlcnkgc2xvdyBvbiBiaWcgdGFibGUgYW5kIGZvcm0uXHJcblx0XHRcdFx0XHRcdCQoXCJbbmFtZT1cIiskLmpncmlkLmpxSUQoaSkrXCJdXCIsZm9ybWlkKS52YWwocm93ZGF0YVtpXSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0Rm9ybVRvR3JpZCA6IGZ1bmN0aW9uKHJvd2lkLCBmb3JtaWQsIG1vZGUsIHBvc2l0aW9uKXtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdHZhciAkdCA9IHRoaXM7XHJcblx0XHRcdGlmKCEkdC5ncmlkKSB7cmV0dXJuO31cclxuXHRcdFx0aWYoIW1vZGUpIHttb2RlID0gJ3NldCc7fVxyXG5cdFx0XHRpZighcG9zaXRpb24pIHtwb3NpdGlvbiA9ICdmaXJzdCc7fVxyXG5cdFx0XHR2YXIgZmllbGRzID0gJChmb3JtaWQpLnNlcmlhbGl6ZUFycmF5KCk7XHJcblx0XHRcdHZhciBncmlkZGF0YSA9IHt9O1xyXG5cdFx0XHQkLmVhY2goZmllbGRzLCBmdW5jdGlvbihpLCBmaWVsZCl7XHJcblx0XHRcdFx0Z3JpZGRhdGFbZmllbGQubmFtZV0gPSBmaWVsZC52YWx1ZTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdGlmKG1vZGU9PT0nYWRkJykgeyQoJHQpLmpxR3JpZChcImFkZFJvd0RhdGFcIixyb3dpZCxncmlkZGF0YSwgcG9zaXRpb24pO31cclxuXHRcdFx0ZWxzZSBpZihtb2RlPT09J3NldCcpIHskKCR0KS5qcUdyaWQoXCJzZXRSb3dEYXRhXCIscm93aWQsZ3JpZGRhdGEpO31cclxuXHRcdH0pO1xyXG5cdH1cclxufSk7XHJcbn0pKGpRdWVyeSk7XHJcbi8qanNoaW50IGVxZXFlcTpmYWxzZSwgZXFudWxsOnRydWUsIGRldmVsOnRydWUgKi9cclxuLypnbG9iYWwgalF1ZXJ5ICovXHJcbihmdW5jdGlvbigkKXtcclxuLyoqXHJcbiAqIGpxR3JpZCBleHRlbnNpb24gZm9yIG1hbmlwdWxhdGluZyBHcmlkIERhdGFcclxuICogVG9ueSBUb21vdiB0b255QHRyaXJhbmQuY29tXHJcbiAqIGh0dHA6Ly90cmlyYW5kLmNvbS9ibG9nL1xyXG4gKiBEdWFsIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgYW5kIEdQTCBsaWNlbnNlczpcclxuICogaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuICogaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2dwbC0yLjAuaHRtbFxyXG4qKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcbiQuamdyaWQuaW5saW5lRWRpdCA9ICQuamdyaWQuaW5saW5lRWRpdCB8fCB7fTtcclxuJC5qZ3JpZC5leHRlbmQoe1xyXG4vL0VkaXRpbmdcclxuXHRlZGl0Um93IDogZnVuY3Rpb24ocm93aWQsa2V5cyxvbmVkaXRmdW5jLHN1Y2Nlc3NmdW5jLCB1cmwsIGV4dHJhcGFyYW0sIGFmdGVyc2F2ZWZ1bmMsZXJyb3JmdW5jLCBhZnRlcnJlc3RvcmVmdW5jKSB7XHJcblx0XHQvLyBDb21wYXRpYmxlIG1vZGUgb2xkIHZlcnNpb25zXHJcblx0XHR2YXIgbz17fSwgYXJncyA9ICQubWFrZUFycmF5KGFyZ3VtZW50cykuc2xpY2UoMSk7XHJcblxyXG5cdFx0aWYoICQudHlwZShhcmdzWzBdKSA9PT0gXCJvYmplY3RcIiApIHtcclxuXHRcdFx0byA9IGFyZ3NbMF07XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRpZiAoa2V5cyAhPT0gdW5kZWZpbmVkKSB7IG8ua2V5cyA9IGtleXM7IH1cclxuXHRcdFx0aWYgKCQuaXNGdW5jdGlvbihvbmVkaXRmdW5jKSkgeyBvLm9uZWRpdGZ1bmMgPSBvbmVkaXRmdW5jOyB9XHJcblx0XHRcdGlmICgkLmlzRnVuY3Rpb24oc3VjY2Vzc2Z1bmMpKSB7IG8uc3VjY2Vzc2Z1bmMgPSBzdWNjZXNzZnVuYzsgfVxyXG5cdFx0XHRpZiAodXJsICE9PSB1bmRlZmluZWQpIHsgby51cmwgPSB1cmw7IH1cclxuXHRcdFx0aWYgKGV4dHJhcGFyYW0gIT09IHVuZGVmaW5lZCkgeyBvLmV4dHJhcGFyYW0gPSBleHRyYXBhcmFtOyB9XHJcblx0XHRcdGlmICgkLmlzRnVuY3Rpb24oYWZ0ZXJzYXZlZnVuYykpIHsgby5hZnRlcnNhdmVmdW5jID0gYWZ0ZXJzYXZlZnVuYzsgfVxyXG5cdFx0XHRpZiAoJC5pc0Z1bmN0aW9uKGVycm9yZnVuYykpIHsgby5lcnJvcmZ1bmMgPSBlcnJvcmZ1bmM7IH1cclxuXHRcdFx0aWYgKCQuaXNGdW5jdGlvbihhZnRlcnJlc3RvcmVmdW5jKSkgeyBvLmFmdGVycmVzdG9yZWZ1bmMgPSBhZnRlcnJlc3RvcmVmdW5jOyB9XHJcblx0XHRcdC8vIGxhc3QgdHdvIG5vdCBhcyBwYXJhbSwgYnV0IGFzIG9iamVjdCAoc29ycnkpXHJcblx0XHRcdC8vaWYgKHJlc3RvcmVBZnRlckVycm9yICE9PSB1bmRlZmluZWQpIHsgby5yZXN0b3JlQWZ0ZXJFcnJvciA9IHJlc3RvcmVBZnRlckVycm9yOyB9XHJcblx0XHRcdC8vaWYgKG10eXBlICE9PSB1bmRlZmluZWQpIHsgby5tdHlwZSA9IG10eXBlIHx8IFwiUE9TVFwiOyB9XHJcblx0XHR9XHJcblx0XHRvID0gJC5leHRlbmQodHJ1ZSwge1xyXG5cdFx0XHRrZXlzIDogZmFsc2UsXHJcblx0XHRcdG9uZWRpdGZ1bmM6IG51bGwsXHJcblx0XHRcdHN1Y2Nlc3NmdW5jOiBudWxsLFxyXG5cdFx0XHR1cmw6IG51bGwsXHJcblx0XHRcdGV4dHJhcGFyYW06IHt9LFxyXG5cdFx0XHRhZnRlcnNhdmVmdW5jOiBudWxsLFxyXG5cdFx0XHRlcnJvcmZ1bmM6IG51bGwsXHJcblx0XHRcdGFmdGVycmVzdG9yZWZ1bmM6IG51bGwsXHJcblx0XHRcdHJlc3RvcmVBZnRlckVycm9yOiB0cnVlLFxyXG5cdFx0XHRtdHlwZTogXCJQT1NUXCJcclxuXHRcdH0sICQuamdyaWQuaW5saW5lRWRpdCwgbyApO1xyXG5cclxuXHRcdC8vIEVuZCBjb21wYXRpYmxlXHJcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdHZhciAkdCA9IHRoaXMsIG5tLCB0bXAsIGVkaXRhYmxlLCBjbnQ9MCwgZm9jdXM9bnVsbCwgc3ZyPXt9LCBpbmQsY20sIGJmZXI7XHJcblx0XHRcdGlmICghJHQuZ3JpZCApIHsgcmV0dXJuOyB9XHJcblx0XHRcdGluZCA9ICQoJHQpLmpxR3JpZChcImdldEluZFwiLHJvd2lkLHRydWUpO1xyXG5cdFx0XHRpZiggaW5kID09PSBmYWxzZSApIHtyZXR1cm47fVxyXG5cdFx0XHRiZmVyID0gJC5pc0Z1bmN0aW9uKCBvLmJlZm9yZUVkaXRSb3cgKSA/IG8uYmVmb3JlRWRpdFJvdy5jYWxsKCR0LG8sIHJvd2lkKSA6ICB1bmRlZmluZWQ7XHJcblx0XHRcdGlmKCBiZmVyID09PSB1bmRlZmluZWQgKSB7XHJcblx0XHRcdFx0YmZlciA9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoIWJmZXIpIHsgcmV0dXJuOyB9XHJcblx0XHRcdGVkaXRhYmxlID0gJChpbmQpLmF0dHIoXCJlZGl0YWJsZVwiKSB8fCBcIjBcIjtcclxuXHRcdFx0aWYgKGVkaXRhYmxlID09PSBcIjBcIiAmJiAhJChpbmQpLmhhc0NsYXNzKFwibm90LWVkaXRhYmxlLXJvd1wiKSkge1xyXG5cdFx0XHRcdGNtID0gJHQucC5jb2xNb2RlbDtcclxuXHRcdFx0XHQkKCd0ZFtyb2xlPVwiZ3JpZGNlbGxcIl0nLGluZCkuZWFjaCggZnVuY3Rpb24oaSkge1xyXG5cdFx0XHRcdFx0bm0gPSBjbVtpXS5uYW1lO1xyXG5cdFx0XHRcdFx0dmFyIHRyZWVnID0gJHQucC50cmVlR3JpZD09PXRydWUgJiYgbm0gPT09ICR0LnAuRXhwYW5kQ29sdW1uO1xyXG5cdFx0XHRcdFx0aWYodHJlZWcpIHsgdG1wID0gJChcInNwYW46Zmlyc3RcIix0aGlzKS5odG1sKCk7fVxyXG5cdFx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0dG1wID0gJC51bmZvcm1hdC5jYWxsKCR0LHRoaXMse3Jvd0lkOnJvd2lkLCBjb2xNb2RlbDpjbVtpXX0saSk7XHJcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKF8pIHtcclxuXHRcdFx0XHRcdFx0XHR0bXAgPSAgKCBjbVtpXS5lZGl0dHlwZSAmJiBjbVtpXS5lZGl0dHlwZSA9PT0gJ3RleHRhcmVhJyApID8gJCh0aGlzKS50ZXh0KCkgOiAkKHRoaXMpLmh0bWwoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYgKCBubSAhPT0gJ2NiJyAmJiBubSAhPT0gJ3N1YmdyaWQnICYmIG5tICE9PSAncm4nKSB7XHJcblx0XHRcdFx0XHRcdGlmKCR0LnAuYXV0b2VuY29kZSkgeyB0bXAgPSAkLmpncmlkLmh0bWxEZWNvZGUodG1wKTsgfVxyXG5cdFx0XHRcdFx0XHRzdnJbbm1dPXRtcDtcclxuXHRcdFx0XHRcdFx0aWYoY21baV0uZWRpdGFibGU9PT10cnVlKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYoZm9jdXM9PT1udWxsKSB7IGZvY3VzID0gaTsgfVxyXG5cdFx0XHRcdFx0XHRcdGlmICh0cmVlZykgeyAkKFwic3BhbjpmaXJzdFwiLHRoaXMpLmh0bWwoXCJcIik7IH1cclxuXHRcdFx0XHRcdFx0XHRlbHNlIHsgJCh0aGlzKS5odG1sKFwiXCIpOyB9XHJcblx0XHRcdFx0XHRcdFx0dmFyIG9wdCA9ICQuZXh0ZW5kKHt9LGNtW2ldLmVkaXRvcHRpb25zIHx8IHt9LHtpZDpyb3dpZCtcIl9cIitubSxuYW1lOm5tfSk7XHJcblx0XHRcdFx0XHRcdFx0aWYoIWNtW2ldLmVkaXR0eXBlKSB7IGNtW2ldLmVkaXR0eXBlID0gXCJ0ZXh0XCI7IH1cclxuXHRcdFx0XHRcdFx0XHRpZih0bXAgPT09IFwiJm5ic3A7XCIgfHwgdG1wID09PSBcIiYjMTYwO1wiIHx8ICh0bXAubGVuZ3RoPT09MSAmJiB0bXAuY2hhckNvZGVBdCgwKT09PTE2MCkgKSB7dG1wPScnO31cclxuXHRcdFx0XHRcdFx0XHR2YXIgZWxjID0gJC5qZ3JpZC5jcmVhdGVFbC5jYWxsKCR0LGNtW2ldLmVkaXR0eXBlLG9wdCx0bXAsdHJ1ZSwkLmV4dGVuZCh7fSwkLmpncmlkLmFqYXhPcHRpb25zLCR0LnAuYWpheFNlbGVjdE9wdGlvbnMgfHwge30pKTtcclxuXHRcdFx0XHRcdFx0XHQkKGVsYykuYWRkQ2xhc3MoXCJlZGl0YWJsZVwiKTtcclxuXHRcdFx0XHRcdFx0XHRpZih0cmVlZykgeyAkKFwic3BhbjpmaXJzdFwiLHRoaXMpLmFwcGVuZChlbGMpOyB9XHJcblx0XHRcdFx0XHRcdFx0ZWxzZSB7ICQodGhpcykuYXBwZW5kKGVsYyk7IH1cclxuXHRcdFx0XHRcdFx0XHQkLmpncmlkLmJpbmRFdi5jYWxsKCR0LCBlbGMsIG9wdCk7XHJcblx0XHRcdFx0XHRcdFx0Ly9BZ2FpbiBJRVxyXG5cdFx0XHRcdFx0XHRcdGlmKGNtW2ldLmVkaXR0eXBlID09PSBcInNlbGVjdFwiICYmIGNtW2ldLmVkaXRvcHRpb25zIT09dW5kZWZpbmVkICYmIGNtW2ldLmVkaXRvcHRpb25zLm11bHRpcGxlPT09dHJ1ZSAgJiYgY21baV0uZWRpdG9wdGlvbnMuZGF0YVVybD09PXVuZGVmaW5lZCAmJiAkLmpncmlkLm1zaWUpIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQoZWxjKS53aWR0aCgkKGVsYykud2lkdGgoKSk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdGNudCsrO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aWYoY250ID4gMCkge1xyXG5cdFx0XHRcdFx0c3ZyLmlkID0gcm93aWQ7ICR0LnAuc2F2ZWRSb3cucHVzaChzdnIpO1xyXG5cdFx0XHRcdFx0JChpbmQpLmF0dHIoXCJlZGl0YWJsZVwiLFwiMVwiKTtcclxuXHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKXskKFwidGQ6ZXEoXCIrZm9jdXMrXCIpIGlucHV0XCIsaW5kKS5mb2N1cygpO30sMCk7XHJcblx0XHRcdFx0XHRpZihvLmtleXM9PT10cnVlKSB7XHJcblx0XHRcdFx0XHRcdCQoaW5kKS5iaW5kKFwia2V5ZG93blwiLGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoZS5rZXlDb2RlID09PSAyNykge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwicmVzdG9yZVJvd1wiLHJvd2lkLCBvLmFmdGVycmVzdG9yZWZ1bmMpO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoJHQucC5faW5saW5lbmF2KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKCdzaG93QWRkRWRpdEJ1dHRvbnMnKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZWVyMSkge31cclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0aWYgKGUua2V5Q29kZSA9PT0gMTMpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHZhciB0YSA9IGUudGFyZ2V0O1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYodGEudGFnTmFtZSA9PT0gJ1RFWFRBUkVBJykgeyByZXR1cm4gdHJ1ZTsgfVxyXG5cdFx0XHRcdFx0XHRcdFx0aWYoICQoJHQpLmpxR3JpZChcInNhdmVSb3dcIiwgcm93aWQsIG8gKSApIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYoJHQucC5faW5saW5lbmF2KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZCgnc2hvd0FkZEVkaXRCdXR0b25zJyk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZWVyMikge31cclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZElubGluZUVkaXRSb3dcIiwgW3Jvd2lkLCBvXSk7XHJcblx0XHRcdFx0XHRpZiggJC5pc0Z1bmN0aW9uKG8ub25lZGl0ZnVuYykpIHsgby5vbmVkaXRmdW5jLmNhbGwoJHQsIHJvd2lkKTsgfVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRzYXZlUm93IDogZnVuY3Rpb24ocm93aWQsIHN1Y2Nlc3NmdW5jLCB1cmwsIGV4dHJhcGFyYW0sIGFmdGVyc2F2ZWZ1bmMsZXJyb3JmdW5jLCBhZnRlcnJlc3RvcmVmdW5jKSB7XHJcblx0XHQvLyBDb21wYXRpYmxlIG1vZGUgb2xkIHZlcnNpb25zXHJcblx0XHR2YXIgYXJncyA9ICQubWFrZUFycmF5KGFyZ3VtZW50cykuc2xpY2UoMSksIG8gPSB7fTtcclxuXHJcblx0XHRpZiggJC50eXBlKGFyZ3NbMF0pID09PSBcIm9iamVjdFwiICkge1xyXG5cdFx0XHRvID0gYXJnc1swXTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGlmICgkLmlzRnVuY3Rpb24oc3VjY2Vzc2Z1bmMpKSB7IG8uc3VjY2Vzc2Z1bmMgPSBzdWNjZXNzZnVuYzsgfVxyXG5cdFx0XHRpZiAodXJsICE9PSB1bmRlZmluZWQpIHsgby51cmwgPSB1cmw7IH1cclxuXHRcdFx0aWYgKGV4dHJhcGFyYW0gIT09IHVuZGVmaW5lZCkgeyBvLmV4dHJhcGFyYW0gPSBleHRyYXBhcmFtOyB9XHJcblx0XHRcdGlmICgkLmlzRnVuY3Rpb24oYWZ0ZXJzYXZlZnVuYykpIHsgby5hZnRlcnNhdmVmdW5jID0gYWZ0ZXJzYXZlZnVuYzsgfVxyXG5cdFx0XHRpZiAoJC5pc0Z1bmN0aW9uKGVycm9yZnVuYykpIHsgby5lcnJvcmZ1bmMgPSBlcnJvcmZ1bmM7IH1cclxuXHRcdFx0aWYgKCQuaXNGdW5jdGlvbihhZnRlcnJlc3RvcmVmdW5jKSkgeyBvLmFmdGVycmVzdG9yZWZ1bmMgPSBhZnRlcnJlc3RvcmVmdW5jOyB9XHJcblx0XHR9XHJcblx0XHRvID0gJC5leHRlbmQodHJ1ZSwge1xyXG5cdFx0XHRzdWNjZXNzZnVuYzogbnVsbCxcclxuXHRcdFx0dXJsOiBudWxsLFxyXG5cdFx0XHRleHRyYXBhcmFtOiB7fSxcclxuXHRcdFx0YWZ0ZXJzYXZlZnVuYzogbnVsbCxcclxuXHRcdFx0ZXJyb3JmdW5jOiBudWxsLFxyXG5cdFx0XHRhZnRlcnJlc3RvcmVmdW5jOiBudWxsLFxyXG5cdFx0XHRyZXN0b3JlQWZ0ZXJFcnJvcjogdHJ1ZSxcclxuXHRcdFx0bXR5cGU6IFwiUE9TVFwiXHJcblx0XHR9LCAkLmpncmlkLmlubGluZUVkaXQsIG8gKTtcclxuXHRcdC8vIEVuZCBjb21wYXRpYmxlXHJcblxyXG5cdFx0dmFyIHN1Y2Nlc3MgPSBmYWxzZTtcclxuXHRcdHZhciAkdCA9IHRoaXNbMF0sIG5tLCB0bXA9e30sIHRtcDI9e30sIHRtcDM9IHt9LCBlZGl0YWJsZSwgZnIsIGN2LCBpbmQ7XHJcblx0XHRpZiAoISR0LmdyaWQgKSB7IHJldHVybiBzdWNjZXNzOyB9XHJcblx0XHRpbmQgPSAkKCR0KS5qcUdyaWQoXCJnZXRJbmRcIixyb3dpZCx0cnVlKTtcclxuXHRcdGlmKGluZCA9PT0gZmFsc2UpIHtyZXR1cm4gc3VjY2Vzczt9XHJcblx0XHR2YXIgYmZzciA9ICQuaXNGdW5jdGlvbiggby5iZWZvcmVTYXZlUm93ICkgP1x0by5iZWZvcmVTYXZlUm93LmNhbGwoJHQsbywgcm93aWQpIDogIHVuZGVmaW5lZDtcclxuXHRcdGlmKCBiZnNyID09PSB1bmRlZmluZWQgKSB7XHJcblx0XHRcdGJmc3IgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0aWYoIWJmc3IpIHsgcmV0dXJuOyB9XHJcblx0XHRlZGl0YWJsZSA9ICQoaW5kKS5hdHRyKFwiZWRpdGFibGVcIik7XHJcblx0XHRvLnVybCA9IG8udXJsIHx8ICR0LnAuZWRpdHVybDtcclxuXHRcdGlmIChlZGl0YWJsZT09PVwiMVwiKSB7XHJcblx0XHRcdHZhciBjbTtcclxuXHRcdFx0JCgndGRbcm9sZT1cImdyaWRjZWxsXCJdJyxpbmQpLmVhY2goZnVuY3Rpb24oaSkge1xyXG5cdFx0XHRcdGNtID0gJHQucC5jb2xNb2RlbFtpXTtcclxuXHRcdFx0XHRubSA9IGNtLm5hbWU7XHJcblx0XHRcdFx0aWYgKCBubSAhPT0gJ2NiJyAmJiBubSAhPT0gJ3N1YmdyaWQnICYmIGNtLmVkaXRhYmxlPT09dHJ1ZSAmJiBubSAhPT0gJ3JuJyAmJiAhJCh0aGlzKS5oYXNDbGFzcygnbm90LWVkaXRhYmxlLWNlbGwnKSkge1xyXG5cdFx0XHRcdFx0c3dpdGNoIChjbS5lZGl0dHlwZSkge1xyXG5cdFx0XHRcdFx0XHRjYXNlIFwiY2hlY2tib3hcIjpcclxuXHRcdFx0XHRcdFx0XHR2YXIgY2J2ID0gW1wiWWVzXCIsXCJOb1wiXTtcclxuXHRcdFx0XHRcdFx0XHRpZihjbS5lZGl0b3B0aW9ucyApIHtcclxuXHRcdFx0XHRcdFx0XHRcdGNidiA9IGNtLmVkaXRvcHRpb25zLnZhbHVlLnNwbGl0KFwiOlwiKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0dG1wW25tXT0gICQoXCJpbnB1dFwiLHRoaXMpLmlzKFwiOmNoZWNrZWRcIikgPyBjYnZbMF0gOiBjYnZbMV07XHJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdGNhc2UgJ3RleHQnOlxyXG5cdFx0XHRcdFx0XHRjYXNlICdwYXNzd29yZCc6XHJcblx0XHRcdFx0XHRcdGNhc2UgJ3RleHRhcmVhJzpcclxuXHRcdFx0XHRcdFx0Y2FzZSBcImJ1dHRvblwiIDpcclxuXHRcdFx0XHRcdFx0XHR0bXBbbm1dPSQoXCJpbnB1dCwgdGV4dGFyZWFcIix0aGlzKS52YWwoKTtcclxuXHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0Y2FzZSAnc2VsZWN0JzpcclxuXHRcdFx0XHRcdFx0XHRpZighY20uZWRpdG9wdGlvbnMubXVsdGlwbGUpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHRtcFtubV0gPSAkKFwic2VsZWN0IG9wdGlvbjpzZWxlY3RlZFwiLHRoaXMpLnZhbCgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0dG1wMltubV0gPSAkKFwic2VsZWN0IG9wdGlvbjpzZWxlY3RlZFwiLCB0aGlzKS50ZXh0KCk7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdHZhciBzZWwgPSAkKFwic2VsZWN0XCIsdGhpcyksIHNlbGVjdGVkVGV4dCA9IFtdO1xyXG5cdFx0XHRcdFx0XHRcdFx0dG1wW25tXSA9ICQoc2VsKS52YWwoKTtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKHRtcFtubV0pIHsgdG1wW25tXT0gdG1wW25tXS5qb2luKFwiLFwiKTsgfSBlbHNlIHsgdG1wW25tXSA9XCJcIjsgfVxyXG5cdFx0XHRcdFx0XHRcdFx0JChcInNlbGVjdCBvcHRpb246c2VsZWN0ZWRcIix0aGlzKS5lYWNoKFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRmdW5jdGlvbihpLHNlbGVjdGVkKXtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRzZWxlY3RlZFRleHRbaV0gPSAkKHNlbGVjdGVkKS50ZXh0KCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0XHRcdFx0XHR0bXAyW25tXSA9IHNlbGVjdGVkVGV4dC5qb2luKFwiLFwiKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0aWYoY20uZm9ybWF0dGVyICYmIGNtLmZvcm1hdHRlciA9PT0gJ3NlbGVjdCcpIHsgdG1wMj17fTsgfVxyXG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRjYXNlICdjdXN0b20nIDpcclxuXHRcdFx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoY20uZWRpdG9wdGlvbnMgJiYgJC5pc0Z1bmN0aW9uKGNtLmVkaXRvcHRpb25zLmN1c3RvbV92YWx1ZSkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1wW25tXSA9IGNtLmVkaXRvcHRpb25zLmN1c3RvbV92YWx1ZS5jYWxsKCR0LCAkKFwiLmN1c3RvbWVsZW1lbnRcIix0aGlzKSwnZ2V0Jyk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmICh0bXBbbm1dID09PSB1bmRlZmluZWQpIHsgdGhyb3cgXCJlMlwiOyB9XHJcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgeyB0aHJvdyBcImUxXCI7IH1cclxuXHRcdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRpZiAoZT09PVwiZTFcIikgeyAkLmpncmlkLmluZm9fZGlhbG9nKCQuamdyaWQuZXJyb3JzLmVycmNhcCxcImZ1bmN0aW9uICdjdXN0b21fdmFsdWUnIFwiKyQuamdyaWQuZWRpdC5tc2cubm9kZWZpbmVkLCQuamdyaWQuZWRpdC5iQ2xvc2UpOyB9XHJcblx0XHRcdFx0XHRcdFx0XHRpZiAoZT09PVwiZTJcIikgeyAkLmpncmlkLmluZm9fZGlhbG9nKCQuamdyaWQuZXJyb3JzLmVycmNhcCxcImZ1bmN0aW9uICdjdXN0b21fdmFsdWUnIFwiKyQuamdyaWQuZWRpdC5tc2cubm92YWx1ZSwkLmpncmlkLmVkaXQuYkNsb3NlKTsgfVxyXG5cdFx0XHRcdFx0XHRcdFx0ZWxzZSB7ICQuamdyaWQuaW5mb19kaWFsb2coJC5qZ3JpZC5lcnJvcnMuZXJyY2FwLGUubWVzc2FnZSwkLmpncmlkLmVkaXQuYkNsb3NlKTsgfVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGN2ID0gJC5qZ3JpZC5jaGVja1ZhbHVlcy5jYWxsKCR0LHRtcFtubV0saSk7XHJcblx0XHRcdFx0XHRpZihjdlswXSA9PT0gZmFsc2UpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYoJHQucC5hdXRvZW5jb2RlKSB7IHRtcFtubV0gPSAkLmpncmlkLmh0bWxFbmNvZGUodG1wW25tXSk7IH1cclxuXHRcdFx0XHRcdGlmKG8udXJsICE9PSAnY2xpZW50QXJyYXknICYmIGNtLmVkaXRvcHRpb25zICYmIGNtLmVkaXRvcHRpb25zLk51bGxJZkVtcHR5ID09PSB0cnVlKSB7XHJcblx0XHRcdFx0XHRcdGlmKHRtcFtubV0gPT09IFwiXCIpIHtcclxuXHRcdFx0XHRcdFx0XHR0bXAzW25tXSA9ICdudWxsJztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdGlmIChjdlswXSA9PT0gZmFsc2Upe1xyXG5cdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHR2YXIgdHIgPSAkKCR0KS5qcUdyaWQoJ2dldEdyaWRSb3dCeUlkJywgcm93aWQpLCBwb3NpdGlvbnMgPSAkLmpncmlkLmZpbmRQb3ModHIpO1xyXG5cdFx0XHRcdFx0JC5qZ3JpZC5pbmZvX2RpYWxvZygkLmpncmlkLmVycm9ycy5lcnJjYXAsY3ZbMV0sJC5qZ3JpZC5lZGl0LmJDbG9zZSx7bGVmdDpwb3NpdGlvbnNbMF0sdG9wOnBvc2l0aW9uc1sxXSskKHRyKS5vdXRlckhlaWdodCgpfSk7XHJcblx0XHRcdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRcdFx0YWxlcnQoY3ZbMV0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gc3VjY2VzcztcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgaWRuYW1lLCBvcGVycyA9ICR0LnAucHJtTmFtZXMsIG9sZFJvd0lkID0gcm93aWQ7XHJcblx0XHRcdGlmICgkdC5wLmtleUluZGV4ID09PSBmYWxzZSkge1xyXG5cdFx0XHRcdGlkbmFtZSA9IG9wZXJzLmlkO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGlkbmFtZSA9ICR0LnAuY29sTW9kZWxbJHQucC5rZXlJbmRleCArXHJcblx0XHRcdFx0XHQoJHQucC5yb3dudW1iZXJzID09PSB0cnVlID8gMSA6IDApICtcclxuXHRcdFx0XHRcdCgkdC5wLm11bHRpc2VsZWN0ID09PSB0cnVlID8gMSA6IDApICtcclxuXHRcdFx0XHRcdCgkdC5wLnN1YkdyaWQgPT09IHRydWUgPyAxIDogMCldLm5hbWU7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYodG1wKSB7XHJcblx0XHRcdFx0dG1wW29wZXJzLm9wZXJdID0gb3BlcnMuZWRpdG9wZXI7XHJcblx0XHRcdFx0aWYgKHRtcFtpZG5hbWVdID09PSB1bmRlZmluZWQgfHwgdG1wW2lkbmFtZV09PT1cIlwiKSB7XHJcblx0XHRcdFx0XHR0bXBbaWRuYW1lXSA9IHJvd2lkO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoaW5kLmlkICE9PSAkdC5wLmlkUHJlZml4ICsgdG1wW2lkbmFtZV0pIHtcclxuXHRcdFx0XHRcdC8vIHJlbmFtZSByb3dpZFxyXG5cdFx0XHRcdFx0dmFyIG9sZGlkID0gJC5qZ3JpZC5zdHJpcFByZWYoJHQucC5pZFByZWZpeCwgcm93aWQpO1xyXG5cdFx0XHRcdFx0aWYgKCR0LnAuX2luZGV4W29sZGlkXSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdCR0LnAuX2luZGV4W3RtcFtpZG5hbWVdXSA9ICR0LnAuX2luZGV4W29sZGlkXTtcclxuXHRcdFx0XHRcdFx0ZGVsZXRlICR0LnAuX2luZGV4W29sZGlkXTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJvd2lkID0gJHQucC5pZFByZWZpeCArIHRtcFtpZG5hbWVdO1xyXG5cdFx0XHRcdFx0JChpbmQpLmF0dHIoXCJpZFwiLCByb3dpZCk7XHJcblx0XHRcdFx0XHRpZiAoJHQucC5zZWxyb3cgPT09IG9sZFJvd0lkKSB7XHJcblx0XHRcdFx0XHRcdCR0LnAuc2Vscm93ID0gcm93aWQ7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAoJC5pc0FycmF5KCR0LnAuc2VsYXJycm93KSkge1xyXG5cdFx0XHRcdFx0XHR2YXIgaSA9ICQuaW5BcnJheShvbGRSb3dJZCwgJHQucC5zZWxhcnJyb3cpO1xyXG5cdFx0XHRcdFx0XHRpZiAoaT49MCkge1xyXG5cdFx0XHRcdFx0XHRcdCR0LnAuc2VsYXJycm93W2ldID0gcm93aWQ7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmICgkdC5wLm11bHRpc2VsZWN0KSB7XHJcblx0XHRcdFx0XHRcdHZhciBuZXdDYm94SWQgPSBcImpxZ19cIiArICR0LnAuaWQgKyBcIl9cIiArIHJvd2lkO1xyXG5cdFx0XHRcdFx0XHQkKFwiaW5wdXQuY2JveFwiLGluZClcclxuXHRcdFx0XHRcdFx0XHQuYXR0cihcImlkXCIsIG5ld0Nib3hJZClcclxuXHRcdFx0XHRcdFx0XHQuYXR0cihcIm5hbWVcIiwgbmV3Q2JveElkKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdC8vIFRPRE86IHRvIHRlc3QgdGhlIGNhc2Ugb2YgZnJvemVuIGNvbHVtbnNcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoJHQucC5pbmxpbmVEYXRhID09PSB1bmRlZmluZWQpIHsgJHQucC5pbmxpbmVEYXRhID17fTsgfVxyXG5cdFx0XHRcdHRtcCA9ICQuZXh0ZW5kKHt9LHRtcCwkdC5wLmlubGluZURhdGEsby5leHRyYXBhcmFtKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoby51cmwgPT09ICdjbGllbnRBcnJheScpIHtcclxuXHRcdFx0XHR0bXAgPSAkLmV4dGVuZCh7fSx0bXAsIHRtcDIpO1xyXG5cdFx0XHRcdGlmKCR0LnAuYXV0b2VuY29kZSkge1xyXG5cdFx0XHRcdFx0JC5lYWNoKHRtcCxmdW5jdGlvbihuLHYpe1xyXG5cdFx0XHRcdFx0XHR0bXBbbl0gPSAkLmpncmlkLmh0bWxEZWNvZGUodik7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIGssIHJlc3AgPSAkKCR0KS5qcUdyaWQoXCJzZXRSb3dEYXRhXCIscm93aWQsdG1wKTtcclxuXHRcdFx0XHQkKGluZCkuYXR0cihcImVkaXRhYmxlXCIsXCIwXCIpO1xyXG5cdFx0XHRcdGZvcihrPTA7azwkdC5wLnNhdmVkUm93Lmxlbmd0aDtrKyspIHtcclxuXHRcdFx0XHRcdGlmKCBTdHJpbmcoJHQucC5zYXZlZFJvd1trXS5pZCkgPT09IFN0cmluZyhvbGRSb3dJZCkpIHtmciA9IGs7IGJyZWFrO31cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoZnIgPj0gMCkgeyAkdC5wLnNhdmVkUm93LnNwbGljZShmciwxKTsgfVxyXG5cdFx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkSW5saW5lQWZ0ZXJTYXZlUm93XCIsIFtyb3dpZCwgcmVzcCwgdG1wLCBvXSk7XHJcblx0XHRcdFx0aWYoICQuaXNGdW5jdGlvbihvLmFmdGVyc2F2ZWZ1bmMpICkgeyBvLmFmdGVyc2F2ZWZ1bmMuY2FsbCgkdCwgcm93aWQscmVzcCwgbyk7IH1cclxuXHRcdFx0XHRzdWNjZXNzID0gdHJ1ZTtcclxuXHRcdFx0XHQkKGluZCkucmVtb3ZlQ2xhc3MoXCJqcWdyaWQtbmV3LXJvd1wiKS51bmJpbmQoXCJrZXlkb3duXCIpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQoXCIjbHVpX1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKSkuc2hvdygpO1xyXG5cdFx0XHRcdHRtcDMgPSAkLmV4dGVuZCh7fSx0bXAsdG1wMyk7XHJcblx0XHRcdFx0dG1wM1tpZG5hbWVdID0gJC5qZ3JpZC5zdHJpcFByZWYoJHQucC5pZFByZWZpeCwgdG1wM1tpZG5hbWVdKTtcclxuXHRcdFx0XHQkLmFqYXgoJC5leHRlbmQoe1xyXG5cdFx0XHRcdFx0dXJsOm8udXJsLFxyXG5cdFx0XHRcdFx0ZGF0YTogJC5pc0Z1bmN0aW9uKCR0LnAuc2VyaWFsaXplUm93RGF0YSkgPyAkdC5wLnNlcmlhbGl6ZVJvd0RhdGEuY2FsbCgkdCwgdG1wMykgOiB0bXAzLFxyXG5cdFx0XHRcdFx0dHlwZTogby5tdHlwZSxcclxuXHRcdFx0XHRcdGFzeW5jIDogZmFsc2UsIC8vPyE/XHJcblx0XHRcdFx0XHRjb21wbGV0ZTogZnVuY3Rpb24ocmVzLHN0YXQpe1xyXG5cdFx0XHRcdFx0XHQkKFwiI2x1aV9cIiskLmpncmlkLmpxSUQoJHQucC5pZCkpLmhpZGUoKTtcclxuXHRcdFx0XHRcdFx0aWYgKHN0YXQgPT09IFwic3VjY2Vzc1wiKXtcclxuXHRcdFx0XHRcdFx0XHR2YXIgcmV0ID0gdHJ1ZSwgc3VjcmV0LCBrO1xyXG5cdFx0XHRcdFx0XHRcdHN1Y3JldCA9ICQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkSW5saW5lU3VjY2Vzc1NhdmVSb3dcIiwgW3Jlcywgcm93aWQsIG9dKTtcclxuXHRcdFx0XHRcdFx0XHRpZiAoISQuaXNBcnJheShzdWNyZXQpKSB7c3VjcmV0ID0gW3RydWUsIHRtcF07fVxyXG5cdFx0XHRcdFx0XHRcdGlmIChzdWNyZXRbMF0gJiYgJC5pc0Z1bmN0aW9uKG8uc3VjY2Vzc2Z1bmMpKSB7c3VjcmV0ID0gby5zdWNjZXNzZnVuYy5jYWxsKCR0LCByZXMpO31cclxuXHRcdFx0XHRcdFx0XHRpZigkLmlzQXJyYXkoc3VjcmV0KSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gZXhwZWN0IGFycmF5IC0gc3RhdHVzLCBkYXRhLCByb3dpZFxyXG5cdFx0XHRcdFx0XHRcdFx0cmV0ID0gc3VjcmV0WzBdO1xyXG5cdFx0XHRcdFx0XHRcdFx0dG1wID0gc3VjcmV0WzFdIHx8IHRtcDtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0cmV0ID0gc3VjcmV0O1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRpZiAocmV0PT09dHJ1ZSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoJHQucC5hdXRvZW5jb2RlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQuZWFjaCh0bXAsZnVuY3Rpb24obix2KXtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR0bXBbbl0gPSAkLmpncmlkLmh0bWxEZWNvZGUodik7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0dG1wID0gJC5leHRlbmQoe30sdG1wLCB0bXAyKTtcclxuXHRcdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcInNldFJvd0RhdGFcIixyb3dpZCx0bXApO1xyXG5cdFx0XHRcdFx0XHRcdFx0JChpbmQpLmF0dHIoXCJlZGl0YWJsZVwiLFwiMFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdGZvcihrPTA7azwkdC5wLnNhdmVkUm93Lmxlbmd0aDtrKyspIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYoIFN0cmluZygkdC5wLnNhdmVkUm93W2tdLmlkKSA9PT0gU3RyaW5nKHJvd2lkKSkge2ZyID0gazsgYnJlYWs7fVxyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0aWYoZnIgPj0gMCkgeyAkdC5wLnNhdmVkUm93LnNwbGljZShmciwxKTsgfVxyXG5cdFx0XHRcdFx0XHRcdFx0JCgkdCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRJbmxpbmVBZnRlclNhdmVSb3dcIiwgW3Jvd2lkLCByZXMsIHRtcCwgb10pO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoICQuaXNGdW5jdGlvbihvLmFmdGVyc2F2ZWZ1bmMpICkgeyBvLmFmdGVyc2F2ZWZ1bmMuY2FsbCgkdCwgcm93aWQscmVzKTsgfVxyXG5cdFx0XHRcdFx0XHRcdFx0c3VjY2VzcyA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0XHQkKGluZCkucmVtb3ZlQ2xhc3MoXCJqcWdyaWQtbmV3LXJvd1wiKS51bmJpbmQoXCJrZXlkb3duXCIpO1xyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZElubGluZUVycm9yU2F2ZVJvd1wiLCBbcm93aWQsIHJlcywgc3RhdCwgbnVsbCwgb10pO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoJC5pc0Z1bmN0aW9uKG8uZXJyb3JmdW5jKSApIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0by5lcnJvcmZ1bmMuY2FsbCgkdCwgcm93aWQsIHJlcywgc3RhdCwgbnVsbCk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRpZihvLnJlc3RvcmVBZnRlckVycm9yID09PSB0cnVlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcInJlc3RvcmVSb3dcIixyb3dpZCwgby5hZnRlcnJlc3RvcmVmdW5jKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRlcnJvcjpmdW5jdGlvbihyZXMsc3RhdCxlcnIpe1xyXG5cdFx0XHRcdFx0XHQkKFwiI2x1aV9cIiskLmpncmlkLmpxSUQoJHQucC5pZCkpLmhpZGUoKTtcclxuXHRcdFx0XHRcdFx0JCgkdCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRJbmxpbmVFcnJvclNhdmVSb3dcIiwgW3Jvd2lkLCByZXMsIHN0YXQsIGVyciwgb10pO1xyXG5cdFx0XHRcdFx0XHRpZigkLmlzRnVuY3Rpb24oby5lcnJvcmZ1bmMpICkge1xyXG5cdFx0XHRcdFx0XHRcdG8uZXJyb3JmdW5jLmNhbGwoJHQsIHJvd2lkLCByZXMsIHN0YXQsIGVycik7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0dmFyIHJUID0gcmVzLnJlc3BvbnNlVGV4dCB8fCByZXMuc3RhdHVzVGV4dDtcclxuXHRcdFx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JC5qZ3JpZC5pbmZvX2RpYWxvZygkLmpncmlkLmVycm9ycy5lcnJjYXAsJzxkaXYgY2xhc3M9XCJ1aS1zdGF0ZS1lcnJvclwiPicrIHJUICsnPC9kaXY+JywgJC5qZ3JpZC5lZGl0LmJDbG9zZSx7YnV0dG9uYWxpZ246J3JpZ2h0J30pO1xyXG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2goZSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0YWxlcnQoclQpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZihvLnJlc3RvcmVBZnRlckVycm9yID09PSB0cnVlKSB7XHJcblx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwicmVzdG9yZVJvd1wiLHJvd2lkLCBvLmFmdGVycmVzdG9yZWZ1bmMpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSwgJC5qZ3JpZC5hamF4T3B0aW9ucywgJHQucC5hamF4Um93T3B0aW9ucyB8fCB7fSkpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gc3VjY2VzcztcclxuXHR9LFxyXG5cdHJlc3RvcmVSb3cgOiBmdW5jdGlvbihyb3dpZCwgYWZ0ZXJyZXN0b3JlZnVuYykge1xyXG5cdFx0Ly8gQ29tcGF0aWJsZSBtb2RlIG9sZCB2ZXJzaW9uc1xyXG5cdFx0dmFyIGFyZ3MgPSAkLm1ha2VBcnJheShhcmd1bWVudHMpLnNsaWNlKDEpLCBvPXt9O1xyXG5cclxuXHRcdGlmKCAkLnR5cGUoYXJnc1swXSkgPT09IFwib2JqZWN0XCIgKSB7XHJcblx0XHRcdG8gPSBhcmdzWzBdO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0aWYgKCQuaXNGdW5jdGlvbihhZnRlcnJlc3RvcmVmdW5jKSkgeyBvLmFmdGVycmVzdG9yZWZ1bmMgPSBhZnRlcnJlc3RvcmVmdW5jOyB9XHJcblx0XHR9XHJcblx0XHRvID0gJC5leHRlbmQodHJ1ZSwge30sICQuamdyaWQuaW5saW5lRWRpdCwgbyApO1xyXG5cclxuXHRcdC8vIEVuZCBjb21wYXRpYmxlXHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQ9IHRoaXMsIGZyPS0xLCBpbmQsIGFyZXM9e30sIGs7XHJcblx0XHRcdGlmICghJHQuZ3JpZCApIHsgcmV0dXJuOyB9XHJcblx0XHRcdGluZCA9ICQoJHQpLmpxR3JpZChcImdldEluZFwiLHJvd2lkLHRydWUpO1xyXG5cdFx0XHRpZihpbmQgPT09IGZhbHNlKSB7cmV0dXJuO31cclxuXHRcdFx0dmFyIGJmY3IgPSAkLmlzRnVuY3Rpb24oIG8uYmVmb3JlQ2FuY2VsUm93ICkgP1x0by5iZWZvcmVDYW5jZWxSb3cuY2FsbCgkdCwgbywgc3IpIDogIHVuZGVmaW5lZDtcclxuXHRcdFx0aWYoIGJmY3IgPT09IHVuZGVmaW5lZCApIHtcclxuXHRcdFx0XHRiZmNyID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZighYmZjcikgeyByZXR1cm47IH1cclxuXHRcdFx0Zm9yKGs9MDtrPCR0LnAuc2F2ZWRSb3cubGVuZ3RoO2srKykge1xyXG5cdFx0XHRcdGlmKCBTdHJpbmcoJHQucC5zYXZlZFJvd1trXS5pZCkgPT09IFN0cmluZyhyb3dpZCkpIHtmciA9IGs7IGJyZWFrO31cclxuXHRcdFx0fVxyXG5cdFx0XHRpZihmciA+PSAwKSB7XHJcblx0XHRcdFx0aWYoJC5pc0Z1bmN0aW9uKCQuZm4uZGF0ZXBpY2tlcikpIHtcclxuXHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdCQoXCJpbnB1dC5oYXNEYXRlcGlja2VyXCIsXCIjXCIrJC5qZ3JpZC5qcUlEKGluZC5pZCkpLmRhdGVwaWNrZXIoJ2hpZGUnKTtcclxuXHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCQuZWFjaCgkdC5wLmNvbE1vZGVsLCBmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0aWYodGhpcy5lZGl0YWJsZSA9PT0gdHJ1ZSAmJiAkdC5wLnNhdmVkUm93W2ZyXS5oYXNPd25Qcm9wZXJ0eSh0aGlzLm5hbWUpKSB7XHJcblx0XHRcdFx0XHRcdGFyZXNbdGhpcy5uYW1lXSA9ICR0LnAuc2F2ZWRSb3dbZnJdW3RoaXMubmFtZV07XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0JCgkdCkuanFHcmlkKFwic2V0Um93RGF0YVwiLHJvd2lkLGFyZXMpO1xyXG5cdFx0XHRcdCQoaW5kKS5hdHRyKFwiZWRpdGFibGVcIixcIjBcIikudW5iaW5kKFwia2V5ZG93blwiKTtcclxuXHRcdFx0XHQkdC5wLnNhdmVkUm93LnNwbGljZShmciwxKTtcclxuXHRcdFx0XHRpZigkKFwiI1wiKyQuamdyaWQuanFJRChyb3dpZCksIFwiI1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKSkuaGFzQ2xhc3MoXCJqcWdyaWQtbmV3LXJvd1wiKSl7XHJcblx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcImRlbFJvd0RhdGFcIixyb3dpZCk7XHJcblx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZCgnc2hvd0FkZEVkaXRCdXR0b25zJyk7XHJcblx0XHRcdFx0XHR9LDApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHQkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZElubGluZUFmdGVyUmVzdG9yZVJvd1wiLCBbcm93aWRdKTtcclxuXHRcdFx0aWYgKCQuaXNGdW5jdGlvbihvLmFmdGVycmVzdG9yZWZ1bmMpKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0by5hZnRlcnJlc3RvcmVmdW5jLmNhbGwoJHQsIHJvd2lkKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRhZGRSb3cgOiBmdW5jdGlvbiAoIHAgKSB7XHJcblx0XHRwID0gJC5leHRlbmQodHJ1ZSwge1xyXG5cdFx0XHRyb3dJRCA6IG51bGwsXHJcblx0XHRcdGluaXRkYXRhIDoge30sXHJcblx0XHRcdHBvc2l0aW9uIDpcImZpcnN0XCIsXHJcblx0XHRcdHVzZURlZlZhbHVlcyA6IHRydWUsXHJcblx0XHRcdHVzZUZvcm1hdHRlciA6IGZhbHNlLFxyXG5cdFx0XHRhZGRSb3dQYXJhbXMgOiB7ZXh0cmFwYXJhbTp7fX1cclxuXHRcdH0scCAgfHwge30pO1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRpZiAoIXRoaXMuZ3JpZCApIHsgcmV0dXJuOyB9XHJcblx0XHRcdHZhciAkdCA9IHRoaXM7XHJcblx0XHRcdHZhciBiZmFyID0gJC5pc0Z1bmN0aW9uKCBwLmJlZm9yZUFkZFJvdyApID9cdHAuYmVmb3JlQWRkUm93LmNhbGwoJHQscC5hZGRSb3dQYXJhbXMpIDogIHVuZGVmaW5lZDtcclxuXHRcdFx0aWYoIGJmYXIgPT09IHVuZGVmaW5lZCApIHtcclxuXHRcdFx0XHRiZmFyID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZighYmZhcikgeyByZXR1cm47IH1cclxuXHRcdFx0cC5yb3dJRCA9ICQuaXNGdW5jdGlvbihwLnJvd0lEKSA/IHAucm93SUQuY2FsbCgkdCwgcCkgOiAoIChwLnJvd0lEICE9IG51bGwpID8gcC5yb3dJRCA6ICQuamdyaWQucmFuZElkKCkpO1xyXG5cdFx0XHRpZihwLnVzZURlZlZhbHVlcyA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdCQoJHQucC5jb2xNb2RlbCkuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0aWYoIHRoaXMuZWRpdG9wdGlvbnMgJiYgdGhpcy5lZGl0b3B0aW9ucy5kZWZhdWx0VmFsdWUgKSB7XHJcblx0XHRcdFx0XHRcdHZhciBvcHQgPSB0aGlzLmVkaXRvcHRpb25zLmRlZmF1bHRWYWx1ZSxcclxuXHRcdFx0XHRcdFx0dG1wID0gJC5pc0Z1bmN0aW9uKG9wdCkgPyBvcHQuY2FsbCgkdCkgOiBvcHQ7XHJcblx0XHRcdFx0XHRcdHAuaW5pdGRhdGFbdGhpcy5uYW1lXSA9IHRtcDtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHQkKCR0KS5qcUdyaWQoJ2FkZFJvd0RhdGEnLCBwLnJvd0lELCBwLmluaXRkYXRhLCBwLnBvc2l0aW9uKTtcclxuXHRcdFx0cC5yb3dJRCA9ICR0LnAuaWRQcmVmaXggKyBwLnJvd0lEO1xyXG5cdFx0XHQkKFwiI1wiKyQuamdyaWQuanFJRChwLnJvd0lEKSwgXCIjXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpKS5hZGRDbGFzcyhcImpxZ3JpZC1uZXctcm93XCIpO1xyXG5cdFx0XHRpZihwLnVzZUZvcm1hdHRlcikge1xyXG5cdFx0XHRcdCQoXCIjXCIrJC5qZ3JpZC5qcUlEKHAucm93SUQpK1wiIC51aS1pbmxpbmUtZWRpdFwiLCBcIiNcIiskLmpncmlkLmpxSUQoJHQucC5pZCkpLmNsaWNrKCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dmFyIG9wZXJzID0gJHQucC5wcm1OYW1lcyxcclxuXHRcdFx0XHRvcGVyID0gb3BlcnMub3BlcjtcclxuXHRcdFx0XHRwLmFkZFJvd1BhcmFtcy5leHRyYXBhcmFtW29wZXJdID0gb3BlcnMuYWRkb3BlcjtcclxuXHRcdFx0XHQkKCR0KS5qcUdyaWQoJ2VkaXRSb3cnLCBwLnJvd0lELCBwLmFkZFJvd1BhcmFtcyk7XHJcblx0XHRcdFx0JCgkdCkuanFHcmlkKCdzZXRTZWxlY3Rpb24nLCBwLnJvd0lEKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRpbmxpbmVOYXYgOiBmdW5jdGlvbiAoZWxlbSwgbykge1xyXG5cdFx0byA9ICQuZXh0ZW5kKHRydWUse1xyXG5cdFx0XHRlZGl0OiB0cnVlLFxyXG5cdFx0XHRlZGl0aWNvbjogXCJ1aS1pY29uLXBlbmNpbFwiLFxyXG5cdFx0XHRhZGQ6IHRydWUsXHJcblx0XHRcdGFkZGljb246XCJ1aS1pY29uLXBsdXNcIixcclxuXHRcdFx0c2F2ZTogdHJ1ZSxcclxuXHRcdFx0c2F2ZWljb246XCJ1aS1pY29uLWRpc2tcIixcclxuXHRcdFx0Y2FuY2VsOiB0cnVlLFxyXG5cdFx0XHRjYW5jZWxpY29uOlwidWktaWNvbi1jYW5jZWxcIixcclxuXHRcdFx0YWRkUGFyYW1zIDoge2FkZFJvd1BhcmFtczoge2V4dHJhcGFyYW06IHt9fX0sXHJcblx0XHRcdGVkaXRQYXJhbXMgOiB7fSxcclxuXHRcdFx0cmVzdG9yZUFmdGVyU2VsZWN0IDogdHJ1ZVxyXG5cdFx0fSwgJC5qZ3JpZC5uYXYsIG8gfHx7fSk7XHJcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdGlmICghdGhpcy5ncmlkICkgeyByZXR1cm47IH1cclxuXHRcdFx0dmFyICR0ID0gdGhpcywgb25TZWxlY3QsIGdJRCA9ICQuamdyaWQuanFJRCgkdC5wLmlkKTtcclxuXHRcdFx0JHQucC5faW5saW5lbmF2ID0gdHJ1ZTtcclxuXHRcdFx0Ly8gZGV0ZWN0IHRoZSBmb3JtYXRhY3Rpb25zIGNvbHVtblxyXG5cdFx0XHRpZihvLmFkZFBhcmFtcy51c2VGb3JtYXR0ZXIgPT09IHRydWUpIHtcclxuXHRcdFx0XHR2YXIgY20gPSAkdC5wLmNvbE1vZGVsLGk7XHJcblx0XHRcdFx0Zm9yIChpID0gMDsgaTxjbS5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdFx0aWYoY21baV0uZm9ybWF0dGVyICYmIGNtW2ldLmZvcm1hdHRlciA9PT0gXCJhY3Rpb25zXCIgKSB7XHJcblx0XHRcdFx0XHRcdGlmKGNtW2ldLmZvcm1hdG9wdGlvbnMpIHtcclxuXHRcdFx0XHRcdFx0XHR2YXIgZGVmYXVsdHMgPSAge1xyXG5cdFx0XHRcdFx0XHRcdFx0a2V5czpmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdG9uRWRpdCA6IG51bGwsXHJcblx0XHRcdFx0XHRcdFx0XHRvblN1Y2Nlc3M6IG51bGwsXHJcblx0XHRcdFx0XHRcdFx0XHRhZnRlclNhdmU6bnVsbCxcclxuXHRcdFx0XHRcdFx0XHRcdG9uRXJyb3I6IG51bGwsXHJcblx0XHRcdFx0XHRcdFx0XHRhZnRlclJlc3RvcmU6IG51bGwsXHJcblx0XHRcdFx0XHRcdFx0XHRleHRyYXBhcmFtOiB7fSxcclxuXHRcdFx0XHRcdFx0XHRcdHVybDogbnVsbFxyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0YXAgPSAkLmV4dGVuZCggZGVmYXVsdHMsIGNtW2ldLmZvcm1hdG9wdGlvbnMgKTtcclxuXHRcdFx0XHRcdFx0XHRvLmFkZFBhcmFtcy5hZGRSb3dQYXJhbXMgPSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcImtleXNcIiA6IGFwLmtleXMsXHJcblx0XHRcdFx0XHRcdFx0XHRcIm9uZWRpdGZ1bmNcIiA6IGFwLm9uRWRpdCxcclxuXHRcdFx0XHRcdFx0XHRcdFwic3VjY2Vzc2Z1bmNcIiA6IGFwLm9uU3VjY2VzcyxcclxuXHRcdFx0XHRcdFx0XHRcdFwidXJsXCIgOiBhcC51cmwsXHJcblx0XHRcdFx0XHRcdFx0XHRcImV4dHJhcGFyYW1cIiA6IGFwLmV4dHJhcGFyYW0sXHJcblx0XHRcdFx0XHRcdFx0XHRcImFmdGVyc2F2ZWZ1bmNcIiA6IGFwLmFmdGVyU2F2ZSxcclxuXHRcdFx0XHRcdFx0XHRcdFwiZXJyb3JmdW5jXCI6IGFwLm9uRXJyb3IsXHJcblx0XHRcdFx0XHRcdFx0XHRcImFmdGVycmVzdG9yZWZ1bmNcIiA6IGFwLmFmdGVyUmVzdG9yZVxyXG5cdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKG8uYWRkKSB7XHJcblx0XHRcdFx0JCgkdCkuanFHcmlkKCduYXZCdXR0b25BZGQnLCBlbGVtLHtcclxuXHRcdFx0XHRcdGNhcHRpb24gOiBvLmFkZHRleHQsXHJcblx0XHRcdFx0XHR0aXRsZSA6IG8uYWRkdGl0bGUsXHJcblx0XHRcdFx0XHRidXR0b25pY29uIDogby5hZGRpY29uLFxyXG5cdFx0XHRcdFx0aWQgOiAkdC5wLmlkK1wiX2lsYWRkXCIsXHJcblx0XHRcdFx0XHRvbkNsaWNrQnV0dG9uIDogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoJ2FkZFJvdycsIG8uYWRkUGFyYW1zKTtcclxuXHRcdFx0XHRcdFx0aWYoIW8uYWRkUGFyYW1zLnVzZUZvcm1hdHRlcikge1xyXG5cdFx0XHRcdFx0XHRcdCQoXCIjXCIrZ0lEK1wiX2lsc2F2ZVwiKS5yZW1vdmVDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0XHRcdFx0XHQkKFwiI1wiK2dJRCtcIl9pbGNhbmNlbFwiKS5yZW1vdmVDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0XHRcdFx0XHQkKFwiI1wiK2dJRCtcIl9pbGFkZFwiKS5hZGRDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0XHRcdFx0XHQkKFwiI1wiK2dJRCtcIl9pbGVkaXRcIikuYWRkQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZihvLmVkaXQpIHtcclxuXHRcdFx0XHQkKCR0KS5qcUdyaWQoJ25hdkJ1dHRvbkFkZCcsIGVsZW0se1xyXG5cdFx0XHRcdFx0Y2FwdGlvbiA6IG8uZWRpdHRleHQsXHJcblx0XHRcdFx0XHR0aXRsZSA6IG8uZWRpdHRpdGxlLFxyXG5cdFx0XHRcdFx0YnV0dG9uaWNvbiA6IG8uZWRpdGljb24sXHJcblx0XHRcdFx0XHRpZCA6ICR0LnAuaWQrXCJfaWxlZGl0XCIsXHJcblx0XHRcdFx0XHRvbkNsaWNrQnV0dG9uIDogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFx0XHR2YXIgc3IgPSAkKCR0KS5qcUdyaWQoJ2dldEdyaWRQYXJhbScsJ3NlbHJvdycpO1xyXG5cdFx0XHRcdFx0XHRpZihzcikge1xyXG5cdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZCgnZWRpdFJvdycsIHNyLCBvLmVkaXRQYXJhbXMpO1xyXG5cdFx0XHRcdFx0XHRcdCQoXCIjXCIrZ0lEK1wiX2lsc2F2ZVwiKS5yZW1vdmVDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0XHRcdFx0XHQkKFwiI1wiK2dJRCtcIl9pbGNhbmNlbFwiKS5yZW1vdmVDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0XHRcdFx0XHQkKFwiI1wiK2dJRCtcIl9pbGFkZFwiKS5hZGRDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0XHRcdFx0XHQkKFwiI1wiK2dJRCtcIl9pbGVkaXRcIikuYWRkQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0JC5qZ3JpZC52aWV3TW9kYWwoXCIjYWxlcnRtb2RcIix7Z2JveDpcIiNnYm94X1wiK2dJRCxqcW06dHJ1ZX0pOyQoXCIjanFnX2FscnRcIikuZm9jdXMoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKG8uc2F2ZSkge1xyXG5cdFx0XHRcdCQoJHQpLmpxR3JpZCgnbmF2QnV0dG9uQWRkJywgZWxlbSx7XHJcblx0XHRcdFx0XHRjYXB0aW9uIDogby5zYXZldGV4dCB8fCAnJyxcclxuXHRcdFx0XHRcdHRpdGxlIDogby5zYXZldGl0bGUgfHwgJ1NhdmUgcm93JyxcclxuXHRcdFx0XHRcdGJ1dHRvbmljb24gOiBvLnNhdmVpY29uLFxyXG5cdFx0XHRcdFx0aWQgOiAkdC5wLmlkK1wiX2lsc2F2ZVwiLFxyXG5cdFx0XHRcdFx0b25DbGlja0J1dHRvbiA6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRcdFx0dmFyIHNyID0gJHQucC5zYXZlZFJvd1swXS5pZDtcclxuXHRcdFx0XHRcdFx0aWYoc3IpIHtcclxuXHRcdFx0XHRcdFx0XHR2YXIgb3BlcnMgPSAkdC5wLnBybU5hbWVzLFxyXG5cdFx0XHRcdFx0XHRcdG9wZXIgPSBvcGVycy5vcGVyLCB0bXBQYXJhbXMgPSBvLmVkaXRQYXJhbXM7XHJcblx0XHRcdFx0XHRcdFx0aWYoJChcIiNcIiskLmpncmlkLmpxSUQoc3IpLCBcIiNcIitnSUQgKS5oYXNDbGFzcyhcImpxZ3JpZC1uZXctcm93XCIpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRvLmFkZFBhcmFtcy5hZGRSb3dQYXJhbXMuZXh0cmFwYXJhbVtvcGVyXSA9IG9wZXJzLmFkZG9wZXI7XHJcblx0XHRcdFx0XHRcdFx0XHR0bXBQYXJhbXMgPSBvLmFkZFBhcmFtcy5hZGRSb3dQYXJhbXM7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKCFvLmVkaXRQYXJhbXMuZXh0cmFwYXJhbSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRvLmVkaXRQYXJhbXMuZXh0cmFwYXJhbSA9IHt9O1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0by5lZGl0UGFyYW1zLmV4dHJhcGFyYW1bb3Blcl0gPSBvcGVycy5lZGl0b3BlcjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0aWYoICQoJHQpLmpxR3JpZCgnc2F2ZVJvdycsIHNyLCB0bXBQYXJhbXMpICkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKCdzaG93QWRkRWRpdEJ1dHRvbnMnKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0JC5qZ3JpZC52aWV3TW9kYWwoXCIjYWxlcnRtb2RcIix7Z2JveDpcIiNnYm94X1wiK2dJRCxqcW06dHJ1ZX0pOyQoXCIjanFnX2FscnRcIikuZm9jdXMoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdCQoXCIjXCIrZ0lEK1wiX2lsc2F2ZVwiKS5hZGRDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZihvLmNhbmNlbCkge1xyXG5cdFx0XHRcdCQoJHQpLmpxR3JpZCgnbmF2QnV0dG9uQWRkJywgZWxlbSx7XHJcblx0XHRcdFx0XHRjYXB0aW9uIDogby5jYW5jZWx0ZXh0IHx8ICcnLFxyXG5cdFx0XHRcdFx0dGl0bGUgOiBvLmNhbmNlbHRpdGxlIHx8ICdDYW5jZWwgcm93IGVkaXRpbmcnLFxyXG5cdFx0XHRcdFx0YnV0dG9uaWNvbiA6IG8uY2FuY2VsaWNvbixcclxuXHRcdFx0XHRcdGlkIDogJHQucC5pZCtcIl9pbGNhbmNlbFwiLFxyXG5cdFx0XHRcdFx0b25DbGlja0J1dHRvbiA6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRcdFx0dmFyIHNyID0gJHQucC5zYXZlZFJvd1swXS5pZCwgY2FuY2VsUHJtID0gby5lZGl0UGFyYW1zO1xyXG5cdFx0XHRcdFx0XHRpZihzcikge1xyXG5cdFx0XHRcdFx0XHRcdGlmKCQoXCIjXCIrJC5qZ3JpZC5qcUlEKHNyKSwgXCIjXCIrZ0lEICkuaGFzQ2xhc3MoXCJqcWdyaWQtbmV3LXJvd1wiKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0Y2FuY2VsUHJtID0gby5hZGRQYXJhbXMuYWRkUm93UGFyYW1zO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoJ3Jlc3RvcmVSb3cnLCBzciwgY2FuY2VsUHJtKTtcclxuXHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoJ3Nob3dBZGRFZGl0QnV0dG9ucycpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdCQuamdyaWQudmlld01vZGFsKFwiI2FsZXJ0bW9kXCIse2dib3g6XCIjZ2JveF9cIitnSUQsanFtOnRydWV9KTskKFwiI2pxZ19hbHJ0XCIpLmZvY3VzKCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHQkKFwiI1wiK2dJRCtcIl9pbGNhbmNlbFwiKS5hZGRDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZihvLnJlc3RvcmVBZnRlclNlbGVjdCA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdGlmKCQuaXNGdW5jdGlvbigkdC5wLmJlZm9yZVNlbGVjdFJvdykpIHtcclxuXHRcdFx0XHRcdG9uU2VsZWN0ID0gJHQucC5iZWZvcmVTZWxlY3RSb3c7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdG9uU2VsZWN0ID0gIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQkdC5wLmJlZm9yZVNlbGVjdFJvdyA9IGZ1bmN0aW9uKGlkLCBzdGF0KSB7XHJcblx0XHRcdFx0XHR2YXIgcmV0ID0gdHJ1ZTtcclxuXHRcdFx0XHRcdGlmKCR0LnAuc2F2ZWRSb3cubGVuZ3RoID4gMCAmJiAkdC5wLl9pbmxpbmVuYXY9PT10cnVlICYmICggaWQgIT09ICR0LnAuc2Vscm93ICYmICR0LnAuc2Vscm93ICE9PW51bGwpICkge1xyXG5cdFx0XHRcdFx0XHRpZigkdC5wLnNlbHJvdyA9PT0gby5hZGRQYXJhbXMucm93SUQgKSB7XHJcblx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKCdkZWxSb3dEYXRhJywgJHQucC5zZWxyb3cpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZCgncmVzdG9yZVJvdycsICR0LnAuc2Vscm93LCBvLmVkaXRQYXJhbXMpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZCgnc2hvd0FkZEVkaXRCdXR0b25zJyk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZihvblNlbGVjdCkge1xyXG5cdFx0XHRcdFx0XHRyZXQgPSBvblNlbGVjdC5jYWxsKCR0LCBpZCwgc3RhdCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZXR1cm4gcmV0O1xyXG5cdFx0XHRcdH07XHJcblx0XHRcdH1cclxuXHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdHNob3dBZGRFZGl0QnV0dG9ucyA6IGZ1bmN0aW9uKCkgIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0aWYgKCF0aGlzLmdyaWQgKSB7IHJldHVybjsgfVxyXG5cdFx0XHR2YXIgZ0lEID0gJC5qZ3JpZC5qcUlEKHRoaXMucC5pZCk7XHJcblx0XHRcdCQoXCIjXCIrZ0lEK1wiX2lsc2F2ZVwiKS5hZGRDbGFzcygndWktc3RhdGUtZGlzYWJsZWQnKTtcclxuXHRcdFx0JChcIiNcIitnSUQrXCJfaWxjYW5jZWxcIikuYWRkQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0XHRcdCQoXCIjXCIrZ0lEK1wiX2lsYWRkXCIpLnJlbW92ZUNsYXNzKCd1aS1zdGF0ZS1kaXNhYmxlZCcpO1xyXG5cdFx0XHQkKFwiI1wiK2dJRCtcIl9pbGVkaXRcIikucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0XHR9KTtcclxuXHR9XHJcbi8vZW5kIGlubGluZSBlZGl0XHJcbn0pO1xyXG59KShqUXVlcnkpO1xyXG4vKmpzaGludCBlcWVxZXE6ZmFsc2UgKi9cclxuLypnbG9iYWwgalF1ZXJ5ICovXHJcbihmdW5jdGlvbigkKXtcclxuLypcclxuKipcclxuICoganFHcmlkIGV4dGVuc2lvbiBmb3IgY2VsbGVkaXRpbmcgR3JpZCBEYXRhXHJcbiAqIFRvbnkgVG9tb3YgdG9ueUB0cmlyYW5kLmNvbVxyXG4gKiBodHRwOi8vdHJpcmFuZC5jb20vYmxvZy9cclxuICogRHVhbCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGFuZCBHUEwgbGljZW5zZXM6XHJcbiAqIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXHJcbiAqIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMi4wLmh0bWxcclxuKiovXHJcbi8qKlxyXG4gKiBhbGwgZXZlbnRzIGFuZCBvcHRpb25zIGhlcmUgYXJlIGFkZWQgYW5vbnlub3VzIGFuZCBub3QgaW4gdGhlIGJhc2UgZ3JpZFxyXG4gKiBzaW5jZSB0aGUgYXJyYXkgaXMgdG8gYmlnLiBIZXJlIGlzIHRoZSBvcmRlciBvZiBleGVjdXRpb24uXHJcbiAqIEZyb20gdGhpcyBwb2ludCB3ZSB1c2UgalF1ZXJ5IGlzRnVuY3Rpb25cclxuICogZm9ybWF0Q2VsbFxyXG4gKiBiZWZvcmVFZGl0Q2VsbCxcclxuICogb25TZWxlY3RDZWxsICh1c2VkIG9ubHkgZm9yIG5vbmVkaXRhYmxlIGNlbHMpXHJcbiAqIGFmdGVyRWRpdENlbGwsXHJcbiAqIGJlZm9yZVNhdmVDZWxsLCAoY2FsbGVkIGJlZm9yZSB2YWxpZGF0aW9uIG9mIHZhbHVlcyBpZiBhbnkpXHJcbiAqIGJlZm9yZVN1Ym1pdENlbGwgKGlmIGNlbGxzdWJtaXQgcmVtb3RlIChhamF4KSlcclxuICogYWZ0ZXJTdWJtaXRDZWxsKGlmIGNlbGxzdWJtaXQgcmVtb3RlIChhamF4KSksXHJcbiAqIGFmdGVyU2F2ZUNlbGwsXHJcbiAqIGVycm9yQ2VsbCxcclxuICogc2VyaWFsaXplQ2VsbERhdGEgLSBuZXdcclxuICogT3B0aW9uc1xyXG4gKiBjZWxsc3VibWl0IChyZW1vdGUsY2xpZW50QXJyYXkpIChhZGRlZCBpbiBncmlkIG9wdGlvbnMpXHJcbiAqIGNlbGx1cmxcclxuICogYWpheENlbGxPcHRpb25zXHJcbiogKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcbiQuamdyaWQuZXh0ZW5kKHtcclxuXHRlZGl0Q2VsbCA6IGZ1bmN0aW9uIChpUm93LGlDb2wsIGVkKXtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCl7XHJcblx0XHRcdHZhciAkdCA9IHRoaXMsIG5tLCB0bXAsY2MsIGNtO1xyXG5cdFx0XHRpZiAoISR0LmdyaWQgfHwgJHQucC5jZWxsRWRpdCAhPT0gdHJ1ZSkge3JldHVybjt9XHJcblx0XHRcdGlDb2wgPSBwYXJzZUludChpQ29sLDEwKTtcclxuXHRcdFx0Ly8gc2VsZWN0IHRoZSByb3cgdGhhdCBjYW4gYmUgdXNlZCBmb3Igb3RoZXIgbWV0aG9kc1xyXG5cdFx0XHQkdC5wLnNlbHJvdyA9ICR0LnJvd3NbaVJvd10uaWQ7XHJcblx0XHRcdGlmICghJHQucC5rbnYpIHskKCR0KS5qcUdyaWQoXCJHcmlkTmF2XCIpO31cclxuXHRcdFx0Ly8gY2hlY2sgdG8gc2VlIGlmIHdlIGhhdmUgYWxyZWFkeSBlZGl0ZWQgY2VsbFxyXG5cdFx0XHRpZiAoJHQucC5zYXZlZFJvdy5sZW5ndGg+MCkge1xyXG5cdFx0XHRcdC8vIHByZXZlbnQgc2Vjb25kIGNsaWNrIG9uIHRoYXQgZmllbGQgYW5kIGVuYWJsZSBzZWxlY3RzXHJcblx0XHRcdFx0aWYgKGVkPT09dHJ1ZSApIHtcclxuXHRcdFx0XHRcdGlmKGlSb3cgPT0gJHQucC5pUm93ICYmIGlDb2wgPT0gJHQucC5pQ29sKXtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvLyBzYXZlIHRoZSBjZWxsXHJcblx0XHRcdFx0JCgkdCkuanFHcmlkKFwic2F2ZUNlbGxcIiwkdC5wLnNhdmVkUm93WzBdLmlkLCR0LnAuc2F2ZWRSb3dbMF0uaWMpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgJChcIiNcIiskLmpncmlkLmpxSUQoJHQucC5rbnYpKS5hdHRyKFwidGFiaW5kZXhcIixcIi0xXCIpLmZvY3VzKCk7fSwwKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRjbSA9ICR0LnAuY29sTW9kZWxbaUNvbF07XHJcblx0XHRcdG5tID0gY20ubmFtZTtcclxuXHRcdFx0aWYgKG5tPT09J3N1YmdyaWQnIHx8IG5tPT09J2NiJyB8fCBubT09PSdybicpIHtyZXR1cm47fVxyXG5cdFx0XHRjYyA9ICQoXCJ0ZDplcShcIitpQ29sK1wiKVwiLCR0LnJvd3NbaVJvd10pO1xyXG5cdFx0XHRpZiAoY20uZWRpdGFibGU9PT10cnVlICYmIGVkPT09dHJ1ZSAmJiAhY2MuaGFzQ2xhc3MoXCJub3QtZWRpdGFibGUtY2VsbFwiKSkge1xyXG5cdFx0XHRcdGlmKHBhcnNlSW50KCR0LnAuaUNvbCwxMCk+PTAgICYmIHBhcnNlSW50KCR0LnAuaVJvdywxMCk+PTApIHtcclxuXHRcdFx0XHRcdCQoXCJ0ZDplcShcIiskdC5wLmlDb2wrXCIpXCIsJHQucm93c1skdC5wLmlSb3ddKS5yZW1vdmVDbGFzcyhcImVkaXQtY2VsbCB1aS1zdGF0ZS1oaWdobGlnaHRcIik7XHJcblx0XHRcdFx0XHQkKCR0LnJvd3NbJHQucC5pUm93XSkucmVtb3ZlQ2xhc3MoXCJzZWxlY3RlZC1yb3cgdWktc3RhdGUtaG92ZXJcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCQoY2MpLmFkZENsYXNzKFwiZWRpdC1jZWxsIHVpLXN0YXRlLWhpZ2hsaWdodFwiKTtcclxuXHRcdFx0XHQkKCR0LnJvd3NbaVJvd10pLmFkZENsYXNzKFwic2VsZWN0ZWQtcm93IHVpLXN0YXRlLWhvdmVyXCIpO1xyXG5cdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHR0bXAgPSAgJC51bmZvcm1hdC5jYWxsKCR0LGNjLHtyb3dJZDogJHQucm93c1tpUm93XS5pZCwgY29sTW9kZWw6Y219LGlDb2wpO1xyXG5cdFx0XHRcdH0gY2F0Y2ggKF8pIHtcclxuXHRcdFx0XHRcdHRtcCA9ICggY20uZWRpdHR5cGUgJiYgY20uZWRpdHR5cGUgPT09ICd0ZXh0YXJlYScgKSA/ICQoY2MpLnRleHQoKSA6ICQoY2MpLmh0bWwoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoJHQucC5hdXRvZW5jb2RlKSB7IHRtcCA9ICQuamdyaWQuaHRtbERlY29kZSh0bXApOyB9XHJcblx0XHRcdFx0aWYgKCFjbS5lZGl0dHlwZSkge2NtLmVkaXR0eXBlID0gXCJ0ZXh0XCI7fVxyXG5cdFx0XHRcdCR0LnAuc2F2ZWRSb3cucHVzaCh7aWQ6aVJvdyxpYzppQ29sLG5hbWU6bm0sdjp0bXB9KTtcclxuXHRcdFx0XHRpZih0bXAgPT09IFwiJm5ic3A7XCIgfHwgdG1wID09PSBcIiYjMTYwO1wiIHx8ICh0bXAubGVuZ3RoPT09MSAmJiB0bXAuY2hhckNvZGVBdCgwKT09PTE2MCkgKSB7dG1wPScnO31cclxuXHRcdFx0XHRpZigkLmlzRnVuY3Rpb24oJHQucC5mb3JtYXRDZWxsKSkge1xyXG5cdFx0XHRcdFx0dmFyIHRtcDIgPSAkdC5wLmZvcm1hdENlbGwuY2FsbCgkdCwgJHQucm93c1tpUm93XS5pZCxubSx0bXAsaVJvdyxpQ29sKTtcclxuXHRcdFx0XHRcdGlmKHRtcDIgIT09IHVuZGVmaW5lZCApIHt0bXAgPSB0bXAyO31cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JCgkdCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRCZWZvcmVFZGl0Q2VsbFwiLCBbJHQucm93c1tpUm93XS5pZCwgbm0sIHRtcCwgaVJvdywgaUNvbF0pO1xyXG5cdFx0XHRcdGlmICgkLmlzRnVuY3Rpb24oJHQucC5iZWZvcmVFZGl0Q2VsbCkpIHtcclxuXHRcdFx0XHRcdCR0LnAuYmVmb3JlRWRpdENlbGwuY2FsbCgkdCwgJHQucm93c1tpUm93XS5pZCxubSx0bXAsaVJvdyxpQ29sKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIG9wdCA9ICQuZXh0ZW5kKHt9LCBjbS5lZGl0b3B0aW9ucyB8fCB7fSAse2lkOmlSb3crXCJfXCIrbm0sbmFtZTpubX0pO1xyXG5cdFx0XHRcdHZhciBlbGMgPSAkLmpncmlkLmNyZWF0ZUVsLmNhbGwoJHQsY20uZWRpdHR5cGUsb3B0LHRtcCx0cnVlLCQuZXh0ZW5kKHt9LCQuamdyaWQuYWpheE9wdGlvbnMsJHQucC5hamF4U2VsZWN0T3B0aW9ucyB8fCB7fSkpO1xyXG5cdFx0XHRcdCQoY2MpLmh0bWwoXCJcIikuYXBwZW5kKGVsYykuYXR0cihcInRhYmluZGV4XCIsXCIwXCIpO1xyXG5cdFx0XHRcdCQuamdyaWQuYmluZEV2LmNhbGwoJHQsIGVsYywgb3B0KTtcclxuXHRcdFx0XHR3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7ICQoZWxjKS5mb2N1cygpO30sMCk7XHJcblx0XHRcdFx0JChcImlucHV0LCBzZWxlY3QsIHRleHRhcmVhXCIsY2MpLmJpbmQoXCJrZXlkb3duXCIsZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdFx0aWYgKGUua2V5Q29kZSA9PT0gMjcpIHtcclxuXHRcdFx0XHRcdFx0aWYoJChcImlucHV0Lmhhc0RhdGVwaWNrZXJcIixjYykubGVuZ3RoID4wKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYoICQoXCIudWktZGF0ZXBpY2tlclwiKS5pcyhcIjpoaWRkZW5cIikgKSAgeyAkKCR0KS5qcUdyaWQoXCJyZXN0b3JlQ2VsbFwiLGlSb3csaUNvbCk7IH1cclxuXHRcdFx0XHRcdFx0XHRlbHNlIHsgJChcImlucHV0Lmhhc0RhdGVwaWNrZXJcIixjYykuZGF0ZXBpY2tlcignaGlkZScpOyB9XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwicmVzdG9yZUNlbGxcIixpUm93LGlDb2wpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IC8vRVNDXHJcblx0XHRcdFx0XHRpZiAoZS5rZXlDb2RlID09PSAxMykge1xyXG5cdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJzYXZlQ2VsbFwiLGlSb3csaUNvbCk7XHJcblx0XHRcdFx0XHRcdC8vIFByZXZlbnQgZGVmYXVsdCBhY3Rpb25cclxuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0fSAvL0VudGVyXHJcblx0XHRcdFx0XHRpZiAoZS5rZXlDb2RlID09PSA5KSAge1xyXG5cdFx0XHRcdFx0XHRpZighJHQuZ3JpZC5oRGl2LmxvYWRpbmcgKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGUuc2hpZnRLZXkpIHskKCR0KS5qcUdyaWQoXCJwcmV2Q2VsbFwiLGlSb3csaUNvbCk7fSAvL1NoaWZ0IFRBYlxyXG5cdFx0XHRcdFx0XHRcdGVsc2UgeyQoJHQpLmpxR3JpZChcIm5leHRDZWxsXCIsaVJvdyxpQ29sKTt9IC8vVGFiXHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWZ0ZXJFZGl0Q2VsbFwiLCBbJHQucm93c1tpUm93XS5pZCwgbm0sIHRtcCwgaVJvdywgaUNvbF0pO1xyXG5cdFx0XHRcdGlmICgkLmlzRnVuY3Rpb24oJHQucC5hZnRlckVkaXRDZWxsKSkge1xyXG5cdFx0XHRcdFx0JHQucC5hZnRlckVkaXRDZWxsLmNhbGwoJHQsICR0LnJvd3NbaVJvd10uaWQsbm0sdG1wLGlSb3csaUNvbCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGlmIChwYXJzZUludCgkdC5wLmlDb2wsMTApPj0wICAmJiBwYXJzZUludCgkdC5wLmlSb3csMTApPj0wKSB7XHJcblx0XHRcdFx0XHQkKFwidGQ6ZXEoXCIrJHQucC5pQ29sK1wiKVwiLCR0LnJvd3NbJHQucC5pUm93XSkucmVtb3ZlQ2xhc3MoXCJlZGl0LWNlbGwgdWktc3RhdGUtaGlnaGxpZ2h0XCIpO1xyXG5cdFx0XHRcdFx0JCgkdC5yb3dzWyR0LnAuaVJvd10pLnJlbW92ZUNsYXNzKFwic2VsZWN0ZWQtcm93IHVpLXN0YXRlLWhvdmVyXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRjYy5hZGRDbGFzcyhcImVkaXQtY2VsbCB1aS1zdGF0ZS1oaWdobGlnaHRcIik7XHJcblx0XHRcdFx0JCgkdC5yb3dzW2lSb3ddKS5hZGRDbGFzcyhcInNlbGVjdGVkLXJvdyB1aS1zdGF0ZS1ob3ZlclwiKTtcclxuXHRcdFx0XHR0bXAgPSBjYy5odG1sKCkucmVwbGFjZSgvXFwmIzE2MFxcOy9pZywnJyk7XHJcblx0XHRcdFx0JCgkdCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRTZWxlY3RDZWxsXCIsIFskdC5yb3dzW2lSb3ddLmlkLCBubSwgdG1wLCBpUm93LCBpQ29sXSk7XHJcblx0XHRcdFx0aWYgKCQuaXNGdW5jdGlvbigkdC5wLm9uU2VsZWN0Q2VsbCkpIHtcclxuXHRcdFx0XHRcdCR0LnAub25TZWxlY3RDZWxsLmNhbGwoJHQsICR0LnJvd3NbaVJvd10uaWQsbm0sdG1wLGlSb3csaUNvbCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdCR0LnAuaUNvbCA9IGlDb2w7ICR0LnAuaVJvdyA9IGlSb3c7XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdHNhdmVDZWxsIDogZnVuY3Rpb24gKGlSb3csIGlDb2wpe1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQ9IHRoaXMsIGZyO1xyXG5cdFx0XHRpZiAoISR0LmdyaWQgfHwgJHQucC5jZWxsRWRpdCAhPT0gdHJ1ZSkge3JldHVybjt9XHJcblx0XHRcdGlmICggJHQucC5zYXZlZFJvdy5sZW5ndGggPj0gMSkge2ZyID0gMDt9IGVsc2Uge2ZyPW51bGw7fVxyXG5cdFx0XHRpZihmciAhPT0gbnVsbCkge1xyXG5cdFx0XHRcdHZhciBjYyA9ICQoXCJ0ZDplcShcIitpQ29sK1wiKVwiLCR0LnJvd3NbaVJvd10pLHYsdjIsXHJcblx0XHRcdFx0Y20gPSAkdC5wLmNvbE1vZGVsW2lDb2xdLCBubSA9IGNtLm5hbWUsIG5tanEgPSAkLmpncmlkLmpxSUQobm0pIDtcclxuXHRcdFx0XHRzd2l0Y2ggKGNtLmVkaXR0eXBlKSB7XHJcblx0XHRcdFx0XHRjYXNlIFwic2VsZWN0XCI6XHJcblx0XHRcdFx0XHRcdGlmKCFjbS5lZGl0b3B0aW9ucy5tdWx0aXBsZSkge1xyXG5cdFx0XHRcdFx0XHRcdHYgPSAkKFwiI1wiK2lSb3crXCJfXCIrbm1qcStcIiBvcHRpb246c2VsZWN0ZWRcIiwkdC5yb3dzW2lSb3ddKS52YWwoKTtcclxuXHRcdFx0XHRcdFx0XHR2MiA9ICQoXCIjXCIraVJvdytcIl9cIitubWpxK1wiIG9wdGlvbjpzZWxlY3RlZFwiLCR0LnJvd3NbaVJvd10pLnRleHQoKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHR2YXIgc2VsID0gJChcIiNcIitpUm93K1wiX1wiK25tanEsJHQucm93c1tpUm93XSksIHNlbGVjdGVkVGV4dCA9IFtdO1xyXG5cdFx0XHRcdFx0XHRcdHYgPSAkKHNlbCkudmFsKCk7XHJcblx0XHRcdFx0XHRcdFx0aWYodikgeyB2LmpvaW4oXCIsXCIpO30gZWxzZSB7IHY9XCJcIjsgfVxyXG5cdFx0XHRcdFx0XHRcdCQoXCJvcHRpb246c2VsZWN0ZWRcIixzZWwpLmVhY2goXHJcblx0XHRcdFx0XHRcdFx0XHRmdW5jdGlvbihpLHNlbGVjdGVkKXtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c2VsZWN0ZWRUZXh0W2ldID0gJChzZWxlY3RlZCkudGV4dCgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0XHRcdFx0djIgPSBzZWxlY3RlZFRleHQuam9pbihcIixcIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYoY20uZm9ybWF0dGVyKSB7IHYyID0gdjsgfVxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgXCJjaGVja2JveFwiOlxyXG5cdFx0XHRcdFx0XHR2YXIgY2J2ICA9IFtcIlllc1wiLFwiTm9cIl07XHJcblx0XHRcdFx0XHRcdGlmKGNtLmVkaXRvcHRpb25zKXtcclxuXHRcdFx0XHRcdFx0XHRjYnYgPSBjbS5lZGl0b3B0aW9ucy52YWx1ZS5zcGxpdChcIjpcIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0diA9ICQoXCIjXCIraVJvdytcIl9cIitubWpxLCR0LnJvd3NbaVJvd10pLmlzKFwiOmNoZWNrZWRcIikgPyBjYnZbMF0gOiBjYnZbMV07XHJcblx0XHRcdFx0XHRcdHYyPXY7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSBcInBhc3N3b3JkXCI6XHJcblx0XHRcdFx0XHRjYXNlIFwidGV4dFwiOlxyXG5cdFx0XHRcdFx0Y2FzZSBcInRleHRhcmVhXCI6XHJcblx0XHRcdFx0XHRjYXNlIFwiYnV0dG9uXCIgOlxyXG5cdFx0XHRcdFx0XHR2ID0gJChcIiNcIitpUm93K1wiX1wiK25tanEsJHQucm93c1tpUm93XSkudmFsKCk7XHJcblx0XHRcdFx0XHRcdHYyPXY7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSAnY3VzdG9tJyA6XHJcblx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0aWYoY20uZWRpdG9wdGlvbnMgJiYgJC5pc0Z1bmN0aW9uKGNtLmVkaXRvcHRpb25zLmN1c3RvbV92YWx1ZSkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHYgPSBjbS5lZGl0b3B0aW9ucy5jdXN0b21fdmFsdWUuY2FsbCgkdCwgJChcIi5jdXN0b21lbGVtZW50XCIsY2MpLCdnZXQnKTtcclxuXHRcdFx0XHRcdFx0XHRcdGlmICh2PT09dW5kZWZpbmVkKSB7IHRocm93IFwiZTJcIjt9IGVsc2UgeyB2Mj12OyB9XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHsgdGhyb3cgXCJlMVwiOyB9XHJcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoZT09PVwiZTFcIikgeyAkLmpncmlkLmluZm9fZGlhbG9nKCQuamdyaWQuZXJyb3JzLmVycmNhcCxcImZ1bmN0aW9uICdjdXN0b21fdmFsdWUnIFwiKyQuamdyaWQuZWRpdC5tc2cubm9kZWZpbmVkLCQuamdyaWQuZWRpdC5iQ2xvc2UpOyB9XHJcblx0XHRcdFx0XHRcdFx0aWYgKGU9PT1cImUyXCIpIHsgJC5qZ3JpZC5pbmZvX2RpYWxvZygkLmpncmlkLmVycm9ycy5lcnJjYXAsXCJmdW5jdGlvbiAnY3VzdG9tX3ZhbHVlJyBcIiskLmpncmlkLmVkaXQubXNnLm5vdmFsdWUsJC5qZ3JpZC5lZGl0LmJDbG9zZSk7IH1cclxuXHRcdFx0XHRcdFx0XHRlbHNlIHskLmpncmlkLmluZm9fZGlhbG9nKCQuamdyaWQuZXJyb3JzLmVycmNhcCxlLm1lc3NhZ2UsJC5qZ3JpZC5lZGl0LmJDbG9zZSk7IH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly8gVGhlIGNvbW1vbiBhcHByb2FjaCBpcyBpZiBub3RoaW5nIGNoYW5nZWQgZG8gbm90IGRvIGFueXRoaW5nXHJcblx0XHRcdFx0aWYgKHYyICE9PSAkdC5wLnNhdmVkUm93W2ZyXS52KXtcclxuXHRcdFx0XHRcdHZhciB2dnYgPSAkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEJlZm9yZVNhdmVDZWxsXCIsIFskdC5yb3dzW2lSb3ddLmlkLCBubSwgdiwgaVJvdywgaUNvbF0pO1xyXG5cdFx0XHRcdFx0aWYgKHZ2dikge3YgPSB2dnY7IHYyPXZ2djt9XHJcblx0XHRcdFx0XHRpZiAoJC5pc0Z1bmN0aW9uKCR0LnAuYmVmb3JlU2F2ZUNlbGwpKSB7XHJcblx0XHRcdFx0XHRcdHZhciB2diA9ICR0LnAuYmVmb3JlU2F2ZUNlbGwuY2FsbCgkdCwgJHQucm93c1tpUm93XS5pZCxubSwgdiwgaVJvdyxpQ29sKTtcclxuXHRcdFx0XHRcdFx0aWYgKHZ2KSB7diA9IHZ2OyB2Mj12djt9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR2YXIgY3YgPSAkLmpncmlkLmNoZWNrVmFsdWVzLmNhbGwoJHQsdixpQ29sKTtcclxuXHRcdFx0XHRcdGlmKGN2WzBdID09PSB0cnVlKSB7XHJcblx0XHRcdFx0XHRcdHZhciBhZGRwb3N0ID0gJCgkdCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRCZWZvcmVTdWJtaXRDZWxsXCIsIFskdC5yb3dzW2lSb3ddLmlkLCBubSwgdiwgaVJvdywgaUNvbF0pIHx8IHt9O1xyXG5cdFx0XHRcdFx0XHRpZiAoJC5pc0Z1bmN0aW9uKCR0LnAuYmVmb3JlU3VibWl0Q2VsbCkpIHtcclxuXHRcdFx0XHRcdFx0XHRhZGRwb3N0ID0gJHQucC5iZWZvcmVTdWJtaXRDZWxsLmNhbGwoJHQsICR0LnJvd3NbaVJvd10uaWQsbm0sIHYsIGlSb3csaUNvbCk7XHJcblx0XHRcdFx0XHRcdFx0aWYgKCFhZGRwb3N0KSB7YWRkcG9zdD17fTt9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYoICQoXCJpbnB1dC5oYXNEYXRlcGlja2VyXCIsY2MpLmxlbmd0aCA+MCkgeyAkKFwiaW5wdXQuaGFzRGF0ZXBpY2tlclwiLGNjKS5kYXRlcGlja2VyKCdoaWRlJyk7IH1cclxuXHRcdFx0XHRcdFx0aWYgKCR0LnAuY2VsbHN1Ym1pdCA9PT0gJ3JlbW90ZScpIHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoJHQucC5jZWxsdXJsKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgcG9zdGRhdGEgPSB7fTtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKCR0LnAuYXV0b2VuY29kZSkgeyB2ID0gJC5qZ3JpZC5odG1sRW5jb2RlKHYpOyB9XHJcblx0XHRcdFx0XHRcdFx0XHRwb3N0ZGF0YVtubV0gPSB2O1xyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIGlkbmFtZSxvcGVyLCBvcGVycztcclxuXHRcdFx0XHRcdFx0XHRcdG9wZXJzID0gJHQucC5wcm1OYW1lcztcclxuXHRcdFx0XHRcdFx0XHRcdGlkbmFtZSA9IG9wZXJzLmlkO1xyXG5cdFx0XHRcdFx0XHRcdFx0b3BlciA9IG9wZXJzLm9wZXI7XHJcblx0XHRcdFx0XHRcdFx0XHRwb3N0ZGF0YVtpZG5hbWVdID0gJC5qZ3JpZC5zdHJpcFByZWYoJHQucC5pZFByZWZpeCwgJHQucm93c1tpUm93XS5pZCk7XHJcblx0XHRcdFx0XHRcdFx0XHRwb3N0ZGF0YVtvcGVyXSA9IG9wZXJzLmVkaXRvcGVyO1xyXG5cdFx0XHRcdFx0XHRcdFx0cG9zdGRhdGEgPSAkLmV4dGVuZChhZGRwb3N0LHBvc3RkYXRhKTtcclxuXHRcdFx0XHRcdFx0XHRcdCQoXCIjbHVpX1wiKyQuamdyaWQuanFJRCgkdC5wLmlkKSkuc2hvdygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0JHQuZ3JpZC5oRGl2LmxvYWRpbmcgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0JC5hamF4KCAkLmV4dGVuZCgge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR1cmw6ICR0LnAuY2VsbHVybCxcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGF0YSA6JC5pc0Z1bmN0aW9uKCR0LnAuc2VyaWFsaXplQ2VsbERhdGEpID8gJHQucC5zZXJpYWxpemVDZWxsRGF0YS5jYWxsKCR0LCBwb3N0ZGF0YSkgOiBwb3N0ZGF0YSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0dHlwZTogXCJQT1NUXCIsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGNvbXBsZXRlOiBmdW5jdGlvbiAocmVzdWx0LCBzdGF0KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0JChcIiNsdWlfXCIrJHQucC5pZCkuaGlkZSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCR0LmdyaWQuaERpdi5sb2FkaW5nID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHN0YXQgPT09ICdzdWNjZXNzJykge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIHJldCA9ICQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWZ0ZXJTdWJtaXRDZWxsXCIsIFskdCwgcmVzdWx0LCBwb3N0ZGF0YS5pZCwgbm0sIHYsIGlSb3csIGlDb2xdKSB8fCBbdHJ1ZSwgJyddO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHJldFswXSA9PT0gdHJ1ZSAmJiAkLmlzRnVuY3Rpb24oJHQucC5hZnRlclN1Ym1pdENlbGwpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldCA9ICR0LnAuYWZ0ZXJTdWJtaXRDZWxsLmNhbGwoJHQsIHJlc3VsdCxwb3N0ZGF0YS5pZCxubSx2LGlSb3csaUNvbCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZihyZXRbMF0gPT09IHRydWUpe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQkKGNjKS5lbXB0eSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJzZXRDZWxsXCIsJHQucm93c1tpUm93XS5pZCwgaUNvbCwgdjIsIGZhbHNlLCBmYWxzZSwgdHJ1ZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdCQoY2MpLmFkZENsYXNzKFwiZGlydHktY2VsbFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0JCgkdC5yb3dzW2lSb3ddKS5hZGRDbGFzcyhcImVkaXRlZFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0JCgkdCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRBZnRlclNhdmVDZWxsXCIsIFskdC5yb3dzW2lSb3ddLmlkLCBubSwgdiwgaVJvdywgaUNvbF0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoJC5pc0Z1bmN0aW9uKCR0LnAuYWZ0ZXJTYXZlQ2VsbCkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQkdC5wLmFmdGVyU2F2ZUNlbGwuY2FsbCgkdCwgJHQucm93c1tpUm93XS5pZCxubSwgdiwgaVJvdyxpQ29sKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQkdC5wLnNhdmVkUm93LnNwbGljZSgwLDEpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0JC5qZ3JpZC5pbmZvX2RpYWxvZygkLmpncmlkLmVycm9ycy5lcnJjYXAscmV0WzFdLCQuamdyaWQuZWRpdC5iQ2xvc2UpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJyZXN0b3JlQ2VsbFwiLGlSb3csaUNvbCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRlcnJvcjpmdW5jdGlvbihyZXMsc3RhdCxlcnIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQkKFwiI2x1aV9cIiskLmpncmlkLmpxSUQoJHQucC5pZCkpLmhpZGUoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQkdC5ncmlkLmhEaXYubG9hZGluZyA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkRXJyb3JDZWxsXCIsIFtyZXMsIHN0YXQsIGVycl0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmICgkLmlzRnVuY3Rpb24oJHQucC5lcnJvckNlbGwpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQkdC5wLmVycm9yQ2VsbC5jYWxsKCR0LCByZXMsc3RhdCxlcnIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwicmVzdG9yZUNlbGxcIixpUm93LGlDb2wpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQkLmpncmlkLmluZm9fZGlhbG9nKCQuamdyaWQuZXJyb3JzLmVycmNhcCxyZXMuc3RhdHVzK1wiIDogXCIrcmVzLnN0YXR1c1RleHQrXCI8YnIvPlwiK3N0YXQsJC5qZ3JpZC5lZGl0LmJDbG9zZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJyZXN0b3JlQ2VsbFwiLGlSb3csaUNvbCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9LCAkLmpncmlkLmFqYXhPcHRpb25zLCAkdC5wLmFqYXhDZWxsT3B0aW9ucyB8fCB7fSkpO1xyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkLmpncmlkLmluZm9fZGlhbG9nKCQuamdyaWQuZXJyb3JzLmVycmNhcCwkLmpncmlkLmVycm9ycy5ub3VybCwkLmpncmlkLmVkaXQuYkNsb3NlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwicmVzdG9yZUNlbGxcIixpUm93LGlDb2wpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYgKCR0LnAuY2VsbHN1Ym1pdCA9PT0gJ2NsaWVudEFycmF5Jykge1xyXG5cdFx0XHRcdFx0XHRcdCQoY2MpLmVtcHR5KCk7XHJcblx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwic2V0Q2VsbFwiLCR0LnJvd3NbaVJvd10uaWQsaUNvbCwgdjIsIGZhbHNlLCBmYWxzZSwgdHJ1ZSk7XHJcblx0XHRcdFx0XHRcdFx0JChjYykuYWRkQ2xhc3MoXCJkaXJ0eS1jZWxsXCIpO1xyXG5cdFx0XHRcdFx0XHRcdCQoJHQucm93c1tpUm93XSkuYWRkQ2xhc3MoXCJlZGl0ZWRcIik7XHJcblx0XHRcdFx0XHRcdFx0JCgkdCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRBZnRlclNhdmVDZWxsXCIsIFskdC5yb3dzW2lSb3ddLmlkLCBubSwgdiwgaVJvdywgaUNvbF0pO1xyXG5cdFx0XHRcdFx0XHRcdGlmICgkLmlzRnVuY3Rpb24oJHQucC5hZnRlclNhdmVDZWxsKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0JHQucC5hZnRlclNhdmVDZWxsLmNhbGwoJHQsICR0LnJvd3NbaVJvd10uaWQsbm0sIHYsIGlSb3csaUNvbCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdCR0LnAuc2F2ZWRSb3cuc3BsaWNlKDAsMSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXskLmpncmlkLmluZm9fZGlhbG9nKCQuamdyaWQuZXJyb3JzLmVycmNhcCx2K1wiIFwiK2N2WzFdLCQuamdyaWQuZWRpdC5iQ2xvc2UpO30sMTAwKTtcclxuXHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJyZXN0b3JlQ2VsbFwiLGlSb3csaUNvbCk7XHJcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcInJlc3RvcmVDZWxsXCIsaVJvdyxpQ29sKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0d2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyAkKFwiI1wiKyQuamdyaWQuanFJRCgkdC5wLmtudikpLmF0dHIoXCJ0YWJpbmRleFwiLFwiLTFcIikuZm9jdXMoKTt9LDApO1xyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRyZXN0b3JlQ2VsbCA6IGZ1bmN0aW9uKGlSb3csIGlDb2wpIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyICR0PSB0aGlzLCBmcjtcclxuXHRcdFx0aWYgKCEkdC5ncmlkIHx8ICR0LnAuY2VsbEVkaXQgIT09IHRydWUgKSB7cmV0dXJuO31cclxuXHRcdFx0aWYgKCAkdC5wLnNhdmVkUm93Lmxlbmd0aCA+PSAxKSB7ZnIgPSAwO30gZWxzZSB7ZnI9bnVsbDt9XHJcblx0XHRcdGlmKGZyICE9PSBudWxsKSB7XHJcblx0XHRcdFx0dmFyIGNjID0gJChcInRkOmVxKFwiK2lDb2wrXCIpXCIsJHQucm93c1tpUm93XSk7XHJcblx0XHRcdFx0Ly8gZGF0ZXBpY2tlciBmaXhcclxuXHRcdFx0XHRpZigkLmlzRnVuY3Rpb24oJC5mbi5kYXRlcGlja2VyKSkge1xyXG5cdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0JChcImlucHV0Lmhhc0RhdGVwaWNrZXJcIixjYykuZGF0ZXBpY2tlcignaGlkZScpO1xyXG5cdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JChjYykuZW1wdHkoKS5hdHRyKFwidGFiaW5kZXhcIixcIi0xXCIpO1xyXG5cdFx0XHRcdCQoJHQpLmpxR3JpZChcInNldENlbGxcIiwkdC5yb3dzW2lSb3ddLmlkLCBpQ29sLCAkdC5wLnNhdmVkUm93W2ZyXS52LCBmYWxzZSwgZmFsc2UsIHRydWUpO1xyXG5cdFx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkQWZ0ZXJSZXN0b3JlQ2VsbFwiLCBbJHQucm93c1tpUm93XS5pZCwgJHQucC5zYXZlZFJvd1tmcl0udiwgaVJvdywgaUNvbF0pO1xyXG5cdFx0XHRcdGlmICgkLmlzRnVuY3Rpb24oJHQucC5hZnRlclJlc3RvcmVDZWxsKSkge1xyXG5cdFx0XHRcdFx0JHQucC5hZnRlclJlc3RvcmVDZWxsLmNhbGwoJHQsICR0LnJvd3NbaVJvd10uaWQsICR0LnAuc2F2ZWRSb3dbZnJdLnYsIGlSb3csIGlDb2wpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQkdC5wLnNhdmVkUm93LnNwbGljZSgwLDEpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgJChcIiNcIiskdC5wLmtudikuYXR0cihcInRhYmluZGV4XCIsXCItMVwiKS5mb2N1cygpO30sMCk7XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdG5leHRDZWxsIDogZnVuY3Rpb24gKGlSb3csaUNvbCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKXtcclxuXHRcdFx0dmFyICR0ID0gdGhpcywgbkNvbD1mYWxzZSwgaTtcclxuXHRcdFx0aWYgKCEkdC5ncmlkIHx8ICR0LnAuY2VsbEVkaXQgIT09IHRydWUpIHtyZXR1cm47fVxyXG5cdFx0XHQvLyB0cnkgdG8gZmluZCBuZXh0IGVkaXRhYmxlIGNlbGxcclxuXHRcdFx0Zm9yIChpPWlDb2wrMTsgaTwkdC5wLmNvbE1vZGVsLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0aWYgKCAkdC5wLmNvbE1vZGVsW2ldLmVkaXRhYmxlID09PXRydWUpIHtcclxuXHRcdFx0XHRcdG5Db2wgPSBpOyBicmVhaztcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYobkNvbCAhPT0gZmFsc2UpIHtcclxuXHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJlZGl0Q2VsbFwiLGlSb3csbkNvbCx0cnVlKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpZiAoJHQucC5zYXZlZFJvdy5sZW5ndGggPjApIHtcclxuXHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcInNhdmVDZWxsXCIsaVJvdyxpQ29sKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0cHJldkNlbGwgOiBmdW5jdGlvbiAoaVJvdyxpQ29sKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpe1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzLCBuQ29sPWZhbHNlLCBpO1xyXG5cdFx0XHRpZiAoISR0LmdyaWQgfHwgJHQucC5jZWxsRWRpdCAhPT0gdHJ1ZSkge3JldHVybjt9XHJcblx0XHRcdC8vIHRyeSB0byBmaW5kIG5leHQgZWRpdGFibGUgY2VsbFxyXG5cdFx0XHRmb3IgKGk9aUNvbC0xOyBpPj0wOyBpLS0pIHtcclxuXHRcdFx0XHRpZiAoICR0LnAuY29sTW9kZWxbaV0uZWRpdGFibGUgPT09dHJ1ZSkge1xyXG5cdFx0XHRcdFx0bkNvbCA9IGk7IGJyZWFrO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRpZihuQ29sICE9PSBmYWxzZSkge1xyXG5cdFx0XHRcdCQoJHQpLmpxR3JpZChcImVkaXRDZWxsXCIsaVJvdyxuQ29sLHRydWUpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGlmICgkdC5wLnNhdmVkUm93Lmxlbmd0aCA+MCkge1xyXG5cdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwic2F2ZUNlbGxcIixpUm93LGlDb2wpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRHcmlkTmF2IDogZnVuY3Rpb24oKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0dmFyICAkdCA9IHRoaXM7XHJcblx0XHRcdGlmICghJHQuZ3JpZCB8fCAkdC5wLmNlbGxFZGl0ICE9PSB0cnVlICkge3JldHVybjt9XHJcblx0XHRcdC8vIHRyaWNrIHRvIHByb2Nlc3Mga2V5ZG93biBvbiBub24gaW5wdXQgZWxlbWVudHNcclxuXHRcdFx0JHQucC5rbnYgPSAkdC5wLmlkICsgXCJfa25cIjtcclxuXHRcdFx0dmFyIHNlbGVjdGlvbiA9ICQoXCI8ZGl2IHN0eWxlPSdwb3NpdGlvbjpmaXhlZDt0b3A6MHB4O3dpZHRoOjFweDtoZWlnaHQ6MXB4OycgdGFiaW5kZXg9JzAnPjxkaXYgdGFiaW5kZXg9Jy0xJyBzdHlsZT0nd2lkdGg6MXB4O2hlaWdodDoxcHg7JyBpZD0nXCIrJHQucC5rbnYrXCInPjwvZGl2PjwvZGl2PlwiKSxcclxuXHRcdFx0aSwga2RpcjtcclxuXHRcdFx0ZnVuY3Rpb24gc2Nyb2xsR3JpZChpUiwgaUMsIHRwKXtcclxuXHRcdFx0XHRpZiAodHAuc3Vic3RyKDAsMSk9PT0ndicpIHtcclxuXHRcdFx0XHRcdHZhciBjaCA9ICQoJHQuZ3JpZC5iRGl2KVswXS5jbGllbnRIZWlnaHQsXHJcblx0XHRcdFx0XHRzdCA9ICQoJHQuZ3JpZC5iRGl2KVswXS5zY3JvbGxUb3AsXHJcblx0XHRcdFx0XHRuUk9UID0gJHQucm93c1tpUl0ub2Zmc2V0VG9wKyR0LnJvd3NbaVJdLmNsaWVudEhlaWdodCxcclxuXHRcdFx0XHRcdHBST1QgPSAkdC5yb3dzW2lSXS5vZmZzZXRUb3A7XHJcblx0XHRcdFx0XHRpZih0cCA9PT0gJ3ZkJykge1xyXG5cdFx0XHRcdFx0XHRpZihuUk9UID49IGNoKSB7XHJcblx0XHRcdFx0XHRcdFx0JCgkdC5ncmlkLmJEaXYpWzBdLnNjcm9sbFRvcCA9ICQoJHQuZ3JpZC5iRGl2KVswXS5zY3JvbGxUb3AgKyAkdC5yb3dzW2lSXS5jbGllbnRIZWlnaHQ7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKHRwID09PSAndnUnKXtcclxuXHRcdFx0XHRcdFx0aWYgKHBST1QgPCBzdCApIHtcclxuXHRcdFx0XHRcdFx0XHQkKCR0LmdyaWQuYkRpdilbMF0uc2Nyb2xsVG9wID0gJCgkdC5ncmlkLmJEaXYpWzBdLnNjcm9sbFRvcCAtICR0LnJvd3NbaVJdLmNsaWVudEhlaWdodDtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZih0cD09PSdoJykge1xyXG5cdFx0XHRcdFx0dmFyIGN3ID0gJCgkdC5ncmlkLmJEaXYpWzBdLmNsaWVudFdpZHRoLFxyXG5cdFx0XHRcdFx0c2wgPSAkKCR0LmdyaWQuYkRpdilbMF0uc2Nyb2xsTGVmdCxcclxuXHRcdFx0XHRcdG5DT0wgPSAkdC5yb3dzW2lSXS5jZWxsc1tpQ10ub2Zmc2V0TGVmdCskdC5yb3dzW2lSXS5jZWxsc1tpQ10uY2xpZW50V2lkdGgsXHJcblx0XHRcdFx0XHRwQ09MID0gJHQucm93c1tpUl0uY2VsbHNbaUNdLm9mZnNldExlZnQ7XHJcblx0XHRcdFx0XHRpZihuQ09MID49IGN3K3BhcnNlSW50KHNsLDEwKSkge1xyXG5cdFx0XHRcdFx0XHQkKCR0LmdyaWQuYkRpdilbMF0uc2Nyb2xsTGVmdCA9ICQoJHQuZ3JpZC5iRGl2KVswXS5zY3JvbGxMZWZ0ICsgJHQucm93c1tpUl0uY2VsbHNbaUNdLmNsaWVudFdpZHRoO1xyXG5cdFx0XHRcdFx0fSBlbHNlIGlmIChwQ09MIDwgc2wpIHtcclxuXHRcdFx0XHRcdFx0JCgkdC5ncmlkLmJEaXYpWzBdLnNjcm9sbExlZnQgPSAkKCR0LmdyaWQuYkRpdilbMF0uc2Nyb2xsTGVmdCAtICR0LnJvd3NbaVJdLmNlbGxzW2lDXS5jbGllbnRXaWR0aDtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gZmluZE5leHRWaXNpYmxlKGlDLGFjdCl7XHJcblx0XHRcdFx0dmFyIGluZCwgaTtcclxuXHRcdFx0XHRpZihhY3QgPT09ICdsZnQnKSB7XHJcblx0XHRcdFx0XHRpbmQgPSBpQysxO1xyXG5cdFx0XHRcdFx0Zm9yIChpPWlDO2k+PTA7aS0tKXtcclxuXHRcdFx0XHRcdFx0aWYgKCR0LnAuY29sTW9kZWxbaV0uaGlkZGVuICE9PSB0cnVlKSB7XHJcblx0XHRcdFx0XHRcdFx0aW5kID0gaTtcclxuXHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihhY3QgPT09ICdyZ3QnKSB7XHJcblx0XHRcdFx0XHRpbmQgPSBpQy0xO1xyXG5cdFx0XHRcdFx0Zm9yIChpPWlDOyBpPCR0LnAuY29sTW9kZWwubGVuZ3RoO2krKyl7XHJcblx0XHRcdFx0XHRcdGlmICgkdC5wLmNvbE1vZGVsW2ldLmhpZGRlbiAhPT0gdHJ1ZSkge1xyXG5cdFx0XHRcdFx0XHRcdGluZCA9IGk7XHJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIGluZDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0JChzZWxlY3Rpb24pLmluc2VydEJlZm9yZSgkdC5ncmlkLmNEaXYpO1xyXG5cdFx0XHQkKFwiI1wiKyR0LnAua252KVxyXG5cdFx0XHQuZm9jdXMoKVxyXG5cdFx0XHQua2V5ZG93bihmdW5jdGlvbiAoZSl7XHJcblx0XHRcdFx0a2RpciA9IGUua2V5Q29kZTtcclxuXHRcdFx0XHRpZigkdC5wLmRpcmVjdGlvbiA9PT0gXCJydGxcIikge1xyXG5cdFx0XHRcdFx0aWYoa2Rpcj09PTM3KSB7IGtkaXIgPSAzOTt9XHJcblx0XHRcdFx0XHRlbHNlIGlmIChrZGlyPT09MzkpIHsga2RpciA9IDM3OyB9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHN3aXRjaCAoa2Rpcikge1xyXG5cdFx0XHRcdFx0Y2FzZSAzODpcclxuXHRcdFx0XHRcdFx0aWYgKCR0LnAuaVJvdy0xID4wICkge1xyXG5cdFx0XHRcdFx0XHRcdHNjcm9sbEdyaWQoJHQucC5pUm93LTEsJHQucC5pQ29sLCd2dScpO1xyXG5cdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcImVkaXRDZWxsXCIsJHQucC5pUm93LTEsJHQucC5pQ29sLGZhbHNlKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIDQwIDpcclxuXHRcdFx0XHRcdFx0aWYgKCR0LnAuaVJvdysxIDw9ICAkdC5yb3dzLmxlbmd0aC0xKSB7XHJcblx0XHRcdFx0XHRcdFx0c2Nyb2xsR3JpZCgkdC5wLmlSb3crMSwkdC5wLmlDb2wsJ3ZkJyk7XHJcblx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwiZWRpdENlbGxcIiwkdC5wLmlSb3crMSwkdC5wLmlDb2wsZmFsc2UpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgMzcgOlxyXG5cdFx0XHRcdFx0XHRpZiAoJHQucC5pQ29sIC0xID49ICAwKSB7XHJcblx0XHRcdFx0XHRcdFx0aSA9IGZpbmROZXh0VmlzaWJsZSgkdC5wLmlDb2wtMSwnbGZ0Jyk7XHJcblx0XHRcdFx0XHRcdFx0c2Nyb2xsR3JpZCgkdC5wLmlSb3csIGksJ2gnKTtcclxuXHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJlZGl0Q2VsbFwiLCR0LnAuaVJvdywgaSxmYWxzZSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSAzOSA6XHJcblx0XHRcdFx0XHRcdGlmICgkdC5wLmlDb2wgKzEgPD0gICR0LnAuY29sTW9kZWwubGVuZ3RoLTEpIHtcclxuXHRcdFx0XHRcdFx0XHRpID0gZmluZE5leHRWaXNpYmxlKCR0LnAuaUNvbCsxLCdyZ3QnKTtcclxuXHRcdFx0XHRcdFx0XHRzY3JvbGxHcmlkKCR0LnAuaVJvdyxpLCdoJyk7XHJcblx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwiZWRpdENlbGxcIiwkdC5wLmlSb3csaSxmYWxzZSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSAxMzpcclxuXHRcdFx0XHRcdFx0aWYgKHBhcnNlSW50KCR0LnAuaUNvbCwxMCk+PTAgJiYgcGFyc2VJbnQoJHQucC5pUm93LDEwKT49MCkge1xyXG5cdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcImVkaXRDZWxsXCIsJHQucC5pUm93LCR0LnAuaUNvbCx0cnVlKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRkZWZhdWx0IDpcclxuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdGdldENoYW5nZWRDZWxscyA6IGZ1bmN0aW9uIChtdGhkKSB7XHJcblx0XHR2YXIgcmV0PVtdO1xyXG5cdFx0aWYgKCFtdGhkKSB7bXRoZD0nYWxsJzt9XHJcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyICR0PSB0aGlzLG5tO1xyXG5cdFx0XHRpZiAoISR0LmdyaWQgfHwgJHQucC5jZWxsRWRpdCAhPT0gdHJ1ZSApIHtyZXR1cm47fVxyXG5cdFx0XHQkKCR0LnJvd3MpLmVhY2goZnVuY3Rpb24oail7XHJcblx0XHRcdFx0dmFyIHJlcyA9IHt9O1xyXG5cdFx0XHRcdGlmICgkKHRoaXMpLmhhc0NsYXNzKFwiZWRpdGVkXCIpKSB7XHJcblx0XHRcdFx0XHQkKCd0ZCcsdGhpcykuZWFjaCggZnVuY3Rpb24oaSkge1xyXG5cdFx0XHRcdFx0XHRubSA9ICR0LnAuY29sTW9kZWxbaV0ubmFtZTtcclxuXHRcdFx0XHRcdFx0aWYgKCBubSAhPT0gJ2NiJyAmJiBubSAhPT0gJ3N1YmdyaWQnKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKG10aGQ9PT0nZGlydHknKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRpZiAoJCh0aGlzKS5oYXNDbGFzcygnZGlydHktY2VsbCcpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmVzW25tXSA9ICQudW5mb3JtYXQuY2FsbCgkdCx0aGlzLHtyb3dJZDokdC5yb3dzW2pdLmlkLCBjb2xNb2RlbDokdC5wLmNvbE1vZGVsW2ldfSxpKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSl7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmVzW25tXSA9ICQuamdyaWQuaHRtbERlY29kZSgkKHRoaXMpLmh0bWwoKSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0cmVzW25tXSA9ICQudW5mb3JtYXQuY2FsbCgkdCx0aGlzLHtyb3dJZDokdC5yb3dzW2pdLmlkLGNvbE1vZGVsOiR0LnAuY29sTW9kZWxbaV19LGkpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRyZXNbbm1dID0gJC5qZ3JpZC5odG1sRGVjb2RlKCQodGhpcykuaHRtbCgpKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0cmVzLmlkID0gdGhpcy5pZDtcclxuXHRcdFx0XHRcdHJldC5wdXNoKHJlcyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdFx0cmV0dXJuIHJldDtcclxuXHR9XHJcbi8vLyBlbmQgIGNlbGwgZWRpdGluZ1xyXG59KTtcclxufSkoalF1ZXJ5KTtcclxuLypqc2hpbnQgZXFlcWVxOmZhbHNlICovXHJcbi8qZ2xvYmFsIGpRdWVyeSAqL1xyXG4oZnVuY3Rpb24oJCl7XHJcbi8qKlxyXG4gKiBqcUdyaWQgZXh0ZW5zaW9uIGZvciBTdWJHcmlkIERhdGFcclxuICogVG9ueSBUb21vdiB0b255QHRyaXJhbmQuY29tXHJcbiAqIGh0dHA6Ly90cmlyYW5kLmNvbS9ibG9nL1xyXG4gKiBEdWFsIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgYW5kIEdQTCBsaWNlbnNlczpcclxuICogaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuICogaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2dwbC0yLjAuaHRtbFxyXG4qKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcbiQuamdyaWQuZXh0ZW5kKHtcclxuc2V0U3ViR3JpZCA6IGZ1bmN0aW9uICgpIHtcclxuXHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpe1xyXG5cdFx0dmFyICR0ID0gdGhpcywgY20sIGksXHJcblx0XHRzdWJvcHRpb25zID0ge1xyXG5cdFx0XHRwbHVzaWNvbiA6IFwidWktaWNvbi1wbHVzXCIsXHJcblx0XHRcdG1pbnVzaWNvbiA6IFwidWktaWNvbi1taW51c1wiLFxyXG5cdFx0XHRvcGVuaWNvbjogXCJ1aS1pY29uLWNhcmF0LTEtc3dcIixcclxuXHRcdFx0ZXhwYW5kT25Mb2FkOiAgZmFsc2UsXHJcblx0XHRcdGRlbGF5T25Mb2FkIDogNTAsXHJcblx0XHRcdHNlbGVjdE9uRXhwYW5kIDogZmFsc2UsXHJcblx0XHRcdHNlbGVjdE9uQ29sbGFwc2UgOiBmYWxzZSxcclxuXHRcdFx0cmVsb2FkT25FeHBhbmQgOiB0cnVlXHJcblx0XHR9O1xyXG5cdFx0JHQucC5zdWJHcmlkT3B0aW9ucyA9ICQuZXh0ZW5kKHN1Ym9wdGlvbnMsICR0LnAuc3ViR3JpZE9wdGlvbnMgfHwge30pO1xyXG5cdFx0JHQucC5jb2xOYW1lcy51bnNoaWZ0KFwiXCIpO1xyXG5cdFx0JHQucC5jb2xNb2RlbC51bnNoaWZ0KHtuYW1lOidzdWJncmlkJyx3aWR0aDogJC5qZ3JpZC5jZWxsX3dpZHRoID8gICR0LnAuc3ViR3JpZFdpZHRoKyR0LnAuY2VsbExheW91dCA6ICR0LnAuc3ViR3JpZFdpZHRoLHNvcnRhYmxlOiBmYWxzZSxyZXNpemFibGU6ZmFsc2UsaGlkZWRsZzp0cnVlLHNlYXJjaDpmYWxzZSxmaXhlZDp0cnVlfSk7XHJcblx0XHRjbSA9ICR0LnAuc3ViR3JpZE1vZGVsO1xyXG5cdFx0aWYoY21bMF0pIHtcclxuXHRcdFx0Y21bMF0uYWxpZ24gPSAkLmV4dGVuZChbXSxjbVswXS5hbGlnbiB8fCBbXSk7XHJcblx0XHRcdGZvcihpPTA7aTxjbVswXS5uYW1lLmxlbmd0aDtpKyspIHsgY21bMF0uYWxpZ25baV0gPSBjbVswXS5hbGlnbltpXSB8fCAnbGVmdCc7fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG59LFxyXG5hZGRTdWJHcmlkQ2VsbCA6ZnVuY3Rpb24gKHBvcyxpUm93KSB7XHJcblx0dmFyIHBycD0nJyxpYyxzaWQ7XHJcblx0dGhpcy5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRwcnAgPSB0aGlzLmZvcm1hdENvbChwb3MsaVJvdyk7XHJcblx0XHRzaWQ9IHRoaXMucC5pZDtcclxuXHRcdGljID0gdGhpcy5wLnN1YkdyaWRPcHRpb25zLnBsdXNpY29uO1xyXG5cdH0pO1xyXG5cdHJldHVybiBcIjx0ZCByb2xlPVxcXCJncmlkY2VsbFxcXCIgYXJpYS1kZXNjcmliZWRieT1cXFwiXCIrc2lkK1wiX3N1YmdyaWRcXFwiIGNsYXNzPVxcXCJ1aS1zZ2NvbGxhcHNlZCBzZ2NvbGxhcHNlZFxcXCIgXCIrcHJwK1wiPjxhIHN0eWxlPSdjdXJzb3I6cG9pbnRlcjsnPjxzcGFuIGNsYXNzPSd1aS1pY29uIFwiK2ljK1wiJz48L3NwYW4+PC9hPjwvdGQ+XCI7XHJcbn0sXHJcbmFkZFN1YkdyaWQgOiBmdW5jdGlvbiggcG9zLCBzaW5kICkge1xyXG5cdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdHZhciB0cyA9IHRoaXM7XHJcblx0XHRpZiAoIXRzLmdyaWQgKSB7IHJldHVybjsgfVxyXG5cdFx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblx0XHR2YXIgc3ViR3JpZENlbGwgPSBmdW5jdGlvbih0cmRpdixjZWxsLHBvcylcclxuXHRcdHtcclxuXHRcdFx0dmFyIHRkZGl2ID0gJChcIjx0ZCBhbGlnbj0nXCIrdHMucC5zdWJHcmlkTW9kZWxbMF0uYWxpZ25bcG9zXStcIic+PC90ZD5cIikuaHRtbChjZWxsKTtcclxuXHRcdFx0JCh0cmRpdikuYXBwZW5kKHRkZGl2KTtcclxuXHRcdH07XHJcblx0XHR2YXIgc3ViR3JpZFhtbCA9IGZ1bmN0aW9uKHNqeG1sLCBzYmlkKXtcclxuXHRcdFx0dmFyIHRkZGl2LCBpLCAgc2dtYXAsXHJcblx0XHRcdGR1bW15ID0gJChcIjx0YWJsZSBjZWxsc3BhY2luZz0nMCcgY2VsbHBhZGRpbmc9JzAnIGJvcmRlcj0nMCc+PHRib2R5PjwvdGJvZHk+PC90YWJsZT5cIiksXHJcblx0XHRcdHRyZGl2ID0gJChcIjx0cj48L3RyPlwiKTtcclxuXHRcdFx0Zm9yIChpID0gMDsgaTx0cy5wLnN1YkdyaWRNb2RlbFswXS5uYW1lLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0dGRkaXYgPSAkKFwiPHRoIGNsYXNzPSd1aS1zdGF0ZS1kZWZhdWx0IHVpLXRoLXN1YmdyaWQgdWktdGgtY29sdW1uIHVpLXRoLVwiK3RzLnAuZGlyZWN0aW9uK1wiJz48L3RoPlwiKTtcclxuXHRcdFx0XHQkKHRkZGl2KS5odG1sKHRzLnAuc3ViR3JpZE1vZGVsWzBdLm5hbWVbaV0pO1xyXG5cdFx0XHRcdCQodGRkaXYpLndpZHRoKCB0cy5wLnN1YkdyaWRNb2RlbFswXS53aWR0aFtpXSk7XHJcblx0XHRcdFx0JCh0cmRpdikuYXBwZW5kKHRkZGl2KTtcclxuXHRcdFx0fVxyXG5cdFx0XHQkKGR1bW15KS5hcHBlbmQodHJkaXYpO1xyXG5cdFx0XHRpZiAoc2p4bWwpe1xyXG5cdFx0XHRcdHNnbWFwID0gdHMucC54bWxSZWFkZXIuc3ViZ3JpZDtcclxuXHRcdFx0XHQkKHNnbWFwLnJvb3QrXCIgXCIrc2dtYXAucm93LCBzanhtbCkuZWFjaCggZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdHRyZGl2ID0gJChcIjx0ciBjbGFzcz0ndWktd2lkZ2V0LWNvbnRlbnQgdWktc3VidGJsY2VsbCc+PC90cj5cIik7XHJcblx0XHRcdFx0XHRpZihzZ21hcC5yZXBlYXRpdGVtcyA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdFx0XHQkKHNnbWFwLmNlbGwsdGhpcykuZWFjaCggZnVuY3Rpb24oaSkge1xyXG5cdFx0XHRcdFx0XHRcdHN1YkdyaWRDZWxsKHRyZGl2LCAkKHRoaXMpLnRleHQoKSB8fCAnJiMxNjA7JyxpKTtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHR2YXIgZiA9IHRzLnAuc3ViR3JpZE1vZGVsWzBdLm1hcHBpbmcgfHwgdHMucC5zdWJHcmlkTW9kZWxbMF0ubmFtZTtcclxuXHRcdFx0XHRcdFx0aWYgKGYpIHtcclxuXHRcdFx0XHRcdFx0XHRmb3IgKGk9MDtpPGYubGVuZ3RoO2krKykge1xyXG5cdFx0XHRcdFx0XHRcdFx0c3ViR3JpZENlbGwodHJkaXYsICQoZltpXSx0aGlzKS50ZXh0KCkgfHwgJyYjMTYwOycsaSk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQkKGR1bW15KS5hcHBlbmQodHJkaXYpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciBwSUQgPSAkKFwidGFibGU6Zmlyc3RcIix0cy5ncmlkLmJEaXYpLmF0dHIoXCJpZFwiKStcIl9cIjtcclxuXHRcdFx0JChcIiNcIiskLmpncmlkLmpxSUQocElEK3NiaWQpKS5hcHBlbmQoZHVtbXkpO1xyXG5cdFx0XHR0cy5ncmlkLmhEaXYubG9hZGluZyA9IGZhbHNlO1xyXG5cdFx0XHQkKFwiI2xvYWRfXCIrJC5qZ3JpZC5qcUlEKHRzLnAuaWQpKS5oaWRlKCk7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH07XHJcblx0XHR2YXIgc3ViR3JpZEpzb24gPSBmdW5jdGlvbihzanhtbCwgc2JpZCl7XHJcblx0XHRcdHZhciB0ZGRpdixyZXN1bHQsaSxjdXIsIHNnbWFwLGosXHJcblx0XHRcdGR1bW15ID0gJChcIjx0YWJsZSBjZWxsc3BhY2luZz0nMCcgY2VsbHBhZGRpbmc9JzAnIGJvcmRlcj0nMCc+PHRib2R5PjwvdGJvZHk+PC90YWJsZT5cIiksXHJcblx0XHRcdHRyZGl2ID0gJChcIjx0cj48L3RyPlwiKTtcclxuXHRcdFx0Zm9yIChpID0gMDsgaTx0cy5wLnN1YkdyaWRNb2RlbFswXS5uYW1lLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0dGRkaXYgPSAkKFwiPHRoIGNsYXNzPSd1aS1zdGF0ZS1kZWZhdWx0IHVpLXRoLXN1YmdyaWQgdWktdGgtY29sdW1uIHVpLXRoLVwiK3RzLnAuZGlyZWN0aW9uK1wiJz48L3RoPlwiKTtcclxuXHRcdFx0XHQkKHRkZGl2KS5odG1sKHRzLnAuc3ViR3JpZE1vZGVsWzBdLm5hbWVbaV0pO1xyXG5cdFx0XHRcdCQodGRkaXYpLndpZHRoKCB0cy5wLnN1YkdyaWRNb2RlbFswXS53aWR0aFtpXSk7XHJcblx0XHRcdFx0JCh0cmRpdikuYXBwZW5kKHRkZGl2KTtcclxuXHRcdFx0fVxyXG5cdFx0XHQkKGR1bW15KS5hcHBlbmQodHJkaXYpO1xyXG5cdFx0XHRpZiAoc2p4bWwpe1xyXG5cdFx0XHRcdHNnbWFwID0gdHMucC5qc29uUmVhZGVyLnN1YmdyaWQ7XHJcblx0XHRcdFx0cmVzdWx0ID0gJC5qZ3JpZC5nZXRBY2Nlc3NvcihzanhtbCwgc2dtYXAucm9vdCk7XHJcblx0XHRcdFx0aWYgKCByZXN1bHQgIT09IHVuZGVmaW5lZCApIHtcclxuXHRcdFx0XHRcdGZvciAoaT0wO2k8cmVzdWx0Lmxlbmd0aDtpKyspIHtcclxuXHRcdFx0XHRcdFx0Y3VyID0gcmVzdWx0W2ldO1xyXG5cdFx0XHRcdFx0XHR0cmRpdiA9ICQoXCI8dHIgY2xhc3M9J3VpLXdpZGdldC1jb250ZW50IHVpLXN1YnRibGNlbGwnPjwvdHI+XCIpO1xyXG5cdFx0XHRcdFx0XHRpZihzZ21hcC5yZXBlYXRpdGVtcyA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdFx0XHRcdGlmKHNnbWFwLmNlbGwpIHsgY3VyPWN1cltzZ21hcC5jZWxsXTsgfVxyXG5cdFx0XHRcdFx0XHRcdGZvciAoaj0wO2o8Y3VyLmxlbmd0aDtqKyspIHtcclxuXHRcdFx0XHRcdFx0XHRcdHN1YkdyaWRDZWxsKHRyZGl2LCBjdXJbal0gfHwgJyYjMTYwOycsaik7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHZhciBmID0gdHMucC5zdWJHcmlkTW9kZWxbMF0ubWFwcGluZyB8fCB0cy5wLnN1YkdyaWRNb2RlbFswXS5uYW1lO1xyXG5cdFx0XHRcdFx0XHRcdGlmKGYubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRmb3IgKGo9MDtqPGYubGVuZ3RoO2orKykge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRzdWJHcmlkQ2VsbCh0cmRpdiwgY3VyW2Zbal1dIHx8ICcmIzE2MDsnLGopO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHQkKGR1bW15KS5hcHBlbmQodHJkaXYpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgcElEID0gJChcInRhYmxlOmZpcnN0XCIsdHMuZ3JpZC5iRGl2KS5hdHRyKFwiaWRcIikrXCJfXCI7XHJcblx0XHRcdCQoXCIjXCIrJC5qZ3JpZC5qcUlEKHBJRCtzYmlkKSkuYXBwZW5kKGR1bW15KTtcclxuXHRcdFx0dHMuZ3JpZC5oRGl2LmxvYWRpbmcgPSBmYWxzZTtcclxuXHRcdFx0JChcIiNsb2FkX1wiKyQuamdyaWQuanFJRCh0cy5wLmlkKSkuaGlkZSgpO1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9O1xyXG5cdFx0dmFyIHBvcHVsYXRlc3ViZ3JpZCA9IGZ1bmN0aW9uKCByZCApXHJcblx0XHR7XHJcblx0XHRcdHZhciBzaWQsZHAsIGksIGo7XHJcblx0XHRcdHNpZCA9ICQocmQpLmF0dHIoXCJpZFwiKTtcclxuXHRcdFx0ZHAgPSB7bmRfOiAobmV3IERhdGUoKS5nZXRUaW1lKCkpfTtcclxuXHRcdFx0ZHBbdHMucC5wcm1OYW1lcy5zdWJncmlkaWRdPXNpZDtcclxuXHRcdFx0aWYoIXRzLnAuc3ViR3JpZE1vZGVsWzBdKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cdFx0XHRpZih0cy5wLnN1YkdyaWRNb2RlbFswXS5wYXJhbXMpIHtcclxuXHRcdFx0XHRmb3Ioaj0wOyBqIDwgdHMucC5zdWJHcmlkTW9kZWxbMF0ucGFyYW1zLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0XHRmb3IoaT0wOyBpPHRzLnAuY29sTW9kZWwubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRcdFx0aWYodHMucC5jb2xNb2RlbFtpXS5uYW1lID09PSB0cy5wLnN1YkdyaWRNb2RlbFswXS5wYXJhbXNbal0pIHtcclxuXHRcdFx0XHRcdFx0XHRkcFt0cy5wLmNvbE1vZGVsW2ldLm5hbWVdPSAkKFwidGQ6ZXEoXCIraStcIilcIixyZCkudGV4dCgpLnJlcGxhY2UoL1xcJiMxNjBcXDsvaWcsJycpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKCF0cy5ncmlkLmhEaXYubG9hZGluZykge1xyXG5cdFx0XHRcdHRzLmdyaWQuaERpdi5sb2FkaW5nID0gdHJ1ZTtcclxuXHRcdFx0XHQkKFwiI2xvYWRfXCIrJC5qZ3JpZC5qcUlEKHRzLnAuaWQpKS5zaG93KCk7XHJcblx0XHRcdFx0aWYoIXRzLnAuc3ViZ3JpZHR5cGUpIHsgdHMucC5zdWJncmlkdHlwZSA9IHRzLnAuZGF0YXR5cGU7IH1cclxuXHRcdFx0XHRpZigkLmlzRnVuY3Rpb24odHMucC5zdWJncmlkdHlwZSkpIHtcclxuXHRcdFx0XHRcdHRzLnAuc3ViZ3JpZHR5cGUuY2FsbCh0cywgZHApO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR0cy5wLnN1YmdyaWR0eXBlID0gdHMucC5zdWJncmlkdHlwZS50b0xvd2VyQ2FzZSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRzd2l0Y2godHMucC5zdWJncmlkdHlwZSkge1xyXG5cdFx0XHRcdFx0Y2FzZSBcInhtbFwiOlxyXG5cdFx0XHRcdFx0Y2FzZSBcImpzb25cIjpcclxuXHRcdFx0XHRcdCQuYWpheCgkLmV4dGVuZCh7XHJcblx0XHRcdFx0XHRcdHR5cGU6dHMucC5tdHlwZSxcclxuXHRcdFx0XHRcdFx0dXJsOiB0cy5wLnN1YkdyaWRVcmwsXHJcblx0XHRcdFx0XHRcdGRhdGFUeXBlOnRzLnAuc3ViZ3JpZHR5cGUsXHJcblx0XHRcdFx0XHRcdGRhdGE6ICQuaXNGdW5jdGlvbih0cy5wLnNlcmlhbGl6ZVN1YkdyaWREYXRhKT8gdHMucC5zZXJpYWxpemVTdWJHcmlkRGF0YS5jYWxsKHRzLCBkcCkgOiBkcCxcclxuXHRcdFx0XHRcdFx0Y29tcGxldGU6IGZ1bmN0aW9uKHN4bWwpIHtcclxuXHRcdFx0XHRcdFx0XHRpZih0cy5wLnN1YmdyaWR0eXBlID09PSBcInhtbFwiKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRzdWJHcmlkWG1sKHN4bWwucmVzcG9uc2VYTUwsIHNpZCk7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdHN1YkdyaWRKc29uKCQuamdyaWQucGFyc2Uoc3htbC5yZXNwb25zZVRleHQpLHNpZCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdHN4bWw9bnVsbDtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSwgJC5qZ3JpZC5hamF4T3B0aW9ucywgdHMucC5hamF4U3ViZ3JpZE9wdGlvbnMgfHwge30pKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9O1xyXG5cdFx0dmFyIF9pZCwgcElELGF0ZCwgbmhjPTAsIGJmc2MsIHI7XHJcblx0XHQkLmVhY2godHMucC5jb2xNb2RlbCxmdW5jdGlvbigpe1xyXG5cdFx0XHRpZih0aGlzLmhpZGRlbiA9PT0gdHJ1ZSB8fCB0aGlzLm5hbWUgPT09ICdybicgfHwgdGhpcy5uYW1lID09PSAnY2InKSB7XHJcblx0XHRcdFx0bmhjKys7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0dmFyIGxlbiA9IHRzLnJvd3MubGVuZ3RoLCBpPTE7XHJcblx0XHRpZiggc2luZCAhPT0gdW5kZWZpbmVkICYmIHNpbmQgPiAwKSB7XHJcblx0XHRcdGkgPSBzaW5kO1xyXG5cdFx0XHRsZW4gPSBzaW5kKzE7XHJcblx0XHR9XHJcblx0XHR3aGlsZShpIDwgbGVuKSB7XHJcblx0XHRcdGlmKCQodHMucm93c1tpXSkuaGFzQ2xhc3MoJ2pxZ3JvdycpKSB7XHJcblx0XHRcdFx0JCh0cy5yb3dzW2ldLmNlbGxzW3Bvc10pLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgdHIgPSAkKHRoaXMpLnBhcmVudChcInRyXCIpWzBdO1xyXG5cdFx0XHRcdFx0ciA9IHRyLm5leHRTaWJsaW5nO1xyXG5cdFx0XHRcdFx0aWYoJCh0aGlzKS5oYXNDbGFzcyhcInNnY29sbGFwc2VkXCIpKSB7XHJcblx0XHRcdFx0XHRcdHBJRCA9IHRzLnAuaWQ7XHJcblx0XHRcdFx0XHRcdF9pZCA9IHRyLmlkO1xyXG5cdFx0XHRcdFx0XHRpZih0cy5wLnN1YkdyaWRPcHRpb25zLnJlbG9hZE9uRXhwYW5kID09PSB0cnVlIHx8ICggdHMucC5zdWJHcmlkT3B0aW9ucy5yZWxvYWRPbkV4cGFuZCA9PT0gZmFsc2UgJiYgISQocikuaGFzQ2xhc3MoJ3VpLXN1YmdyaWQnKSApICkge1xyXG5cdFx0XHRcdFx0XHRcdGF0ZCA9IHBvcyA+PTEgPyBcIjx0ZCBjb2xzcGFuPSdcIitwb3MrXCInPiYjMTYwOzwvdGQ+XCI6XCJcIjtcclxuXHRcdFx0XHRcdFx0XHRiZnNjID0gJCh0cykudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRTdWJHcmlkQmVmb3JlRXhwYW5kXCIsIFtwSUQgKyBcIl9cIiArIF9pZCwgX2lkXSk7XHJcblx0XHRcdFx0XHRcdFx0YmZzYyA9IChiZnNjID09PSBmYWxzZSB8fCBiZnNjID09PSAnc3RvcCcpID8gZmFsc2UgOiB0cnVlO1xyXG5cdFx0XHRcdFx0XHRcdGlmKGJmc2MgJiYgJC5pc0Z1bmN0aW9uKHRzLnAuc3ViR3JpZEJlZm9yZUV4cGFuZCkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGJmc2MgPSB0cy5wLnN1YkdyaWRCZWZvcmVFeHBhbmQuY2FsbCh0cywgcElEK1wiX1wiK19pZCxfaWQpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRpZihiZnNjID09PSBmYWxzZSkge3JldHVybiBmYWxzZTt9XHJcblx0XHRcdFx0XHRcdFx0JCh0cikuYWZ0ZXIoIFwiPHRyIHJvbGU9J3JvdycgY2xhc3M9J3VpLXN1YmdyaWQnPlwiK2F0ZCtcIjx0ZCBjbGFzcz0ndWktd2lkZ2V0LWNvbnRlbnQgc3ViZ3JpZC1jZWxsJz48c3BhbiBjbGFzcz0ndWktaWNvbiBcIit0cy5wLnN1YkdyaWRPcHRpb25zLm9wZW5pY29uK1wiJz48L3NwYW4+PC90ZD48dGQgY29sc3Bhbj0nXCIrcGFyc2VJbnQodHMucC5jb2xOYW1lcy5sZW5ndGgtMS1uaGMsMTApK1wiJyBjbGFzcz0ndWktd2lkZ2V0LWNvbnRlbnQgc3ViZ3JpZC1kYXRhJz48ZGl2IGlkPVwiK3BJRCtcIl9cIitfaWQrXCIgY2xhc3M9J3RhYmxlZGl2Jz48L2Rpdj48L3RkPjwvdHI+XCIgKTtcclxuXHRcdFx0XHRcdFx0XHQkKHRzKS50cmlnZ2VySGFuZGxlcihcImpxR3JpZFN1YkdyaWRSb3dFeHBhbmRlZFwiLCBbcElEICsgXCJfXCIgKyBfaWQsIF9pZF0pO1xyXG5cdFx0XHRcdFx0XHRcdGlmKCAkLmlzRnVuY3Rpb24odHMucC5zdWJHcmlkUm93RXhwYW5kZWQpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0cy5wLnN1YkdyaWRSb3dFeHBhbmRlZC5jYWxsKHRzLCBwSUQrXCJfXCIrIF9pZCxfaWQpO1xyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRwb3B1bGF0ZXN1YmdyaWQodHIpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHQkKHIpLnNob3coKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHQkKHRoaXMpLmh0bWwoXCI8YSBzdHlsZT0nY3Vyc29yOnBvaW50ZXI7Jz48c3BhbiBjbGFzcz0ndWktaWNvbiBcIit0cy5wLnN1YkdyaWRPcHRpb25zLm1pbnVzaWNvbitcIic+PC9zcGFuPjwvYT5cIikucmVtb3ZlQ2xhc3MoXCJzZ2NvbGxhcHNlZFwiKS5hZGRDbGFzcyhcInNnZXhwYW5kZWRcIik7XHJcblx0XHRcdFx0XHRcdGlmKHRzLnAuc3ViR3JpZE9wdGlvbnMuc2VsZWN0T25FeHBhbmQpIHtcclxuXHRcdFx0XHRcdFx0XHQkKHRzKS5qcUdyaWQoJ3NldFNlbGVjdGlvbicsX2lkKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBlbHNlIGlmKCQodGhpcykuaGFzQ2xhc3MoXCJzZ2V4cGFuZGVkXCIpKSB7XHJcblx0XHRcdFx0XHRcdGJmc2MgPSAkKHRzKS50cmlnZ2VySGFuZGxlcihcImpxR3JpZFN1YkdyaWRSb3dDb2xhcHNlZFwiLCBbcElEICsgXCJfXCIgKyBfaWQsIF9pZF0pO1xyXG5cdFx0XHRcdFx0XHRiZnNjID0gKGJmc2MgPT09IGZhbHNlIHx8IGJmc2MgPT09ICdzdG9wJykgPyBmYWxzZSA6IHRydWU7XHJcblx0XHRcdFx0XHRcdF9pZCA9IHRyLmlkO1xyXG5cdFx0XHRcdFx0XHRpZiggYmZzYyAmJiAgJC5pc0Z1bmN0aW9uKHRzLnAuc3ViR3JpZFJvd0NvbGFwc2VkKSkge1xyXG5cdFx0XHRcdFx0XHRcdGJmc2MgPSB0cy5wLnN1YkdyaWRSb3dDb2xhcHNlZC5jYWxsKHRzLCBwSUQrXCJfXCIrX2lkLF9pZCApO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmKGJmc2M9PT1mYWxzZSkge3JldHVybiBmYWxzZTt9XHJcblx0XHRcdFx0XHRcdGlmKHRzLnAuc3ViR3JpZE9wdGlvbnMucmVsb2FkT25FeHBhbmQgPT09IHRydWUpIHtcclxuXHRcdFx0XHRcdFx0XHQkKHIpLnJlbW92ZShcIi51aS1zdWJncmlkXCIpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYoJChyKS5oYXNDbGFzcygndWktc3ViZ3JpZCcpKSB7IC8vIGluY2FzZSBvZiBkeW5hbWljIGRlbGV0aW5nXHJcblx0XHRcdFx0XHRcdFx0JChyKS5oaWRlKCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0JCh0aGlzKS5odG1sKFwiPGEgc3R5bGU9J2N1cnNvcjpwb2ludGVyOyc+PHNwYW4gY2xhc3M9J3VpLWljb24gXCIrdHMucC5zdWJHcmlkT3B0aW9ucy5wbHVzaWNvbitcIic+PC9zcGFuPjwvYT5cIikucmVtb3ZlQ2xhc3MoXCJzZ2V4cGFuZGVkXCIpLmFkZENsYXNzKFwic2djb2xsYXBzZWRcIik7XHJcblx0XHRcdFx0XHRcdGlmKHRzLnAuc3ViR3JpZE9wdGlvbnMuc2VsZWN0T25Db2xsYXBzZSkge1xyXG5cdFx0XHRcdFx0XHRcdCQodHMpLmpxR3JpZCgnc2V0U2VsZWN0aW9uJyxfaWQpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0aSsrO1xyXG5cdFx0fVxyXG5cdFx0aWYodHMucC5zdWJHcmlkT3B0aW9ucy5leHBhbmRPbkxvYWQgPT09IHRydWUpIHtcclxuXHRcdFx0JCh0cy5yb3dzKS5maWx0ZXIoJy5qcWdyb3cnKS5lYWNoKGZ1bmN0aW9uKGluZGV4LHJvdyl7XHJcblx0XHRcdFx0JChyb3cuY2VsbHNbMF0pLmNsaWNrKCk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdFx0dHMuc3ViR3JpZFhtbCA9IGZ1bmN0aW9uKHhtbCxzaWQpIHtzdWJHcmlkWG1sKHhtbCxzaWQpO307XHJcblx0XHR0cy5zdWJHcmlkSnNvbiA9IGZ1bmN0aW9uKGpzb24sc2lkKSB7c3ViR3JpZEpzb24oanNvbixzaWQpO307XHJcblx0fSk7XHJcbn0sXHJcbmV4cGFuZFN1YkdyaWRSb3cgOiBmdW5jdGlvbihyb3dpZCkge1xyXG5cdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyICR0ID0gdGhpcztcclxuXHRcdGlmKCEkdC5ncmlkICYmICFyb3dpZCkge3JldHVybjt9XHJcblx0XHRpZigkdC5wLnN1YkdyaWQ9PT10cnVlKSB7XHJcblx0XHRcdHZhciByYyA9ICQodGhpcykuanFHcmlkKFwiZ2V0SW5kXCIscm93aWQsdHJ1ZSk7XHJcblx0XHRcdGlmKHJjKSB7XHJcblx0XHRcdFx0dmFyIHNnYyA9ICQoXCJ0ZC5zZ2NvbGxhcHNlZFwiLHJjKVswXTtcclxuXHRcdFx0XHRpZihzZ2MpIHtcclxuXHRcdFx0XHRcdCQoc2djKS50cmlnZ2VyKFwiY2xpY2tcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSk7XHJcbn0sXHJcbmNvbGxhcHNlU3ViR3JpZFJvdyA6IGZ1bmN0aW9uKHJvd2lkKSB7XHJcblx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgJHQgPSB0aGlzO1xyXG5cdFx0aWYoISR0LmdyaWQgJiYgIXJvd2lkKSB7cmV0dXJuO31cclxuXHRcdGlmKCR0LnAuc3ViR3JpZD09PXRydWUpIHtcclxuXHRcdFx0dmFyIHJjID0gJCh0aGlzKS5qcUdyaWQoXCJnZXRJbmRcIixyb3dpZCx0cnVlKTtcclxuXHRcdFx0aWYocmMpIHtcclxuXHRcdFx0XHR2YXIgc2djID0gJChcInRkLnNnZXhwYW5kZWRcIixyYylbMF07XHJcblx0XHRcdFx0aWYoc2djKSB7XHJcblx0XHRcdFx0XHQkKHNnYykudHJpZ2dlcihcImNsaWNrXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG59LFxyXG50b2dnbGVTdWJHcmlkUm93IDogZnVuY3Rpb24ocm93aWQpIHtcclxuXHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcclxuXHRcdHZhciAkdCA9IHRoaXM7XHJcblx0XHRpZighJHQuZ3JpZCAmJiAhcm93aWQpIHtyZXR1cm47fVxyXG5cdFx0aWYoJHQucC5zdWJHcmlkPT09dHJ1ZSkge1xyXG5cdFx0XHR2YXIgcmMgPSAkKHRoaXMpLmpxR3JpZChcImdldEluZFwiLHJvd2lkLHRydWUpO1xyXG5cdFx0XHRpZihyYykge1xyXG5cdFx0XHRcdHZhciBzZ2MgPSAkKFwidGQuc2djb2xsYXBzZWRcIixyYylbMF07XHJcblx0XHRcdFx0aWYoc2djKSB7XHJcblx0XHRcdFx0XHQkKHNnYykudHJpZ2dlcihcImNsaWNrXCIpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRzZ2MgPSAkKFwidGQuc2dleHBhbmRlZFwiLHJjKVswXTtcclxuXHRcdFx0XHRcdGlmKHNnYykge1xyXG5cdFx0XHRcdFx0XHQkKHNnYykudHJpZ2dlcihcImNsaWNrXCIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG59XHJcbn0pO1xyXG59KShqUXVlcnkpO1xyXG4vKipcclxuICoganFHcmlkIGV4dGVuc2lvbiAtIFRyZWUgR3JpZFxyXG4gKiBUb255IFRvbW92IHRvbnlAdHJpcmFuZC5jb21cclxuICogaHR0cDovL3RyaXJhbmQuY29tL2Jsb2cvXHJcbiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBhbmQgR1BMIGxpY2Vuc2VzOlxyXG4gKiBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxyXG4gKiBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvZ3BsLmh0bWxcclxuKiovXHJcblxyXG4vKmpzaGludCBlcWVxZXE6ZmFsc2UgKi9cclxuLypnbG9iYWwgalF1ZXJ5ICovXHJcbihmdW5jdGlvbigkKSB7XHJcblwidXNlIHN0cmljdFwiO1xyXG4kLmpncmlkLmV4dGVuZCh7XHJcblx0c2V0VHJlZU5vZGUgOiBmdW5jdGlvbihpLCBsZW4pe1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzO1xyXG5cdFx0XHRpZiggISR0LmdyaWQgfHwgISR0LnAudHJlZUdyaWQgKSB7cmV0dXJuO31cclxuXHRcdFx0dmFyIGV4cENvbCA9ICR0LnAuZXhwQ29sSW5kLFxyXG5cdFx0XHRleHBhbmRlZCA9ICR0LnAudHJlZVJlYWRlci5leHBhbmRlZF9maWVsZCxcclxuXHRcdFx0aXNMZWFmID0gJHQucC50cmVlUmVhZGVyLmxlYWZfZmllbGQsXHJcblx0XHRcdGxldmVsID0gJHQucC50cmVlUmVhZGVyLmxldmVsX2ZpZWxkLFxyXG5cdFx0XHRpY29uID0gJHQucC50cmVlUmVhZGVyLmljb25fZmllbGQsXHJcblx0XHRcdGxvYWRlZCA9ICR0LnAudHJlZVJlYWRlci5sb2FkZWQsICBsZnQsIHJndCwgY3VyTGV2ZWwsIGlkZW50LGxmdHBvcywgdHdyYXAsXHJcblx0XHRcdGxkYXQsIGxmO1xyXG5cdFx0XHR3aGlsZShpPGxlbikge1xyXG5cdFx0XHRcdHZhciBpbmQgPSAkLmpncmlkLnN0cmlwUHJlZigkdC5wLmlkUHJlZml4LCAkdC5yb3dzW2ldLmlkKSwgZGluZCA9ICR0LnAuX2luZGV4W2luZF0sIGV4cGFuO1xyXG5cdFx0XHRcdGxkYXQgPSAkdC5wLmRhdGFbZGluZF07XHJcblx0XHRcdFx0Ly8kdC5yb3dzW2ldLmxldmVsID0gbGRhdFtsZXZlbF07XHJcblx0XHRcdFx0aWYoJHQucC50cmVlR3JpZE1vZGVsID09PSAnbmVzdGVkJykge1xyXG5cdFx0XHRcdFx0aWYoIWxkYXRbaXNMZWFmXSkge1xyXG5cdFx0XHRcdFx0bGZ0ID0gcGFyc2VJbnQobGRhdFskdC5wLnRyZWVSZWFkZXIubGVmdF9maWVsZF0sMTApO1xyXG5cdFx0XHRcdFx0cmd0ID0gcGFyc2VJbnQobGRhdFskdC5wLnRyZWVSZWFkZXIucmlnaHRfZmllbGRdLDEwKTtcclxuXHRcdFx0XHRcdC8vIE5TIE1vZGVsXHJcblx0XHRcdFx0XHRcdGxkYXRbaXNMZWFmXSA9IChyZ3QgPT09IGxmdCsxKSA/ICd0cnVlJyA6ICdmYWxzZSc7XHJcblx0XHRcdFx0XHRcdCR0LnJvd3NbaV0uY2VsbHNbJHQucC5fdHJlZWxlYWZwb3NdLmlubmVySFRNTCA9IGxkYXRbaXNMZWFmXTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly9lbHNlIHtcclxuXHRcdFx0XHRcdC8vcm93LnBhcmVudF9pZCA9IHJkWyR0LnAudHJlZVJlYWRlci5wYXJlbnRfaWRfZmllbGRdO1xyXG5cdFx0XHRcdC8vfVxyXG5cdFx0XHRcdGN1ckxldmVsID0gcGFyc2VJbnQobGRhdFtsZXZlbF0sMTApO1xyXG5cdFx0XHRcdGlmKCR0LnAudHJlZV9yb290X2xldmVsID09PSAwKSB7XHJcblx0XHRcdFx0XHRpZGVudCA9IGN1ckxldmVsKzE7XHJcblx0XHRcdFx0XHRsZnRwb3MgPSBjdXJMZXZlbDtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0aWRlbnQgPSBjdXJMZXZlbDtcclxuXHRcdFx0XHRcdGxmdHBvcyA9IGN1ckxldmVsIC0xO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0d3JhcCA9IFwiPGRpdiBjbGFzcz0ndHJlZS13cmFwIHRyZWUtd3JhcC1cIiskdC5wLmRpcmVjdGlvbitcIicgc3R5bGU9J3dpZHRoOlwiKyhpZGVudCoxOCkrXCJweDsnPlwiO1xyXG5cdFx0XHRcdHR3cmFwICs9IFwiPGRpdiBzdHlsZT0nXCIrKCR0LnAuZGlyZWN0aW9uPT09XCJydGxcIiA/IFwicmlnaHQ6XCIgOiBcImxlZnQ6XCIpKyhsZnRwb3MqMTgpK1wicHg7JyBjbGFzcz0ndWktaWNvbiBcIjtcclxuXHJcblxyXG5cdFx0XHRcdGlmKGxkYXRbbG9hZGVkXSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRpZihsZGF0W2xvYWRlZF09PT1cInRydWVcIiB8fCBsZGF0W2xvYWRlZF09PT10cnVlKSB7XHJcblx0XHRcdFx0XHRcdGxkYXRbbG9hZGVkXSA9IHRydWU7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRsZGF0W2xvYWRlZF0gPSBmYWxzZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYobGRhdFtpc0xlYWZdID09PSBcInRydWVcIiB8fCBsZGF0W2lzTGVhZl0gPT09IHRydWUpIHtcclxuXHRcdFx0XHRcdHR3cmFwICs9ICgobGRhdFtpY29uXSAhPT0gdW5kZWZpbmVkICYmIGxkYXRbaWNvbl0gIT09IFwiXCIpID8gbGRhdFtpY29uXSA6ICR0LnAudHJlZUljb25zLmxlYWYpK1wiIHRyZWUtbGVhZiB0cmVlY2xpY2tcIjtcclxuXHRcdFx0XHRcdGxkYXRbaXNMZWFmXSA9IHRydWU7XHJcblx0XHRcdFx0XHRsZj1cImxlYWZcIjtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0bGRhdFtpc0xlYWZdID0gZmFsc2U7XHJcblx0XHRcdFx0XHRsZj1cIlwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRsZGF0W2V4cGFuZGVkXSA9ICgobGRhdFtleHBhbmRlZF0gPT09IFwidHJ1ZVwiIHx8IGxkYXRbZXhwYW5kZWRdID09PSB0cnVlKSA/IHRydWUgOiBmYWxzZSkgJiYgKGxkYXRbbG9hZGVkXSB8fCBsZGF0W2xvYWRlZF0gPT09IHVuZGVmaW5lZCk7XHJcblx0XHRcdFx0aWYobGRhdFtleHBhbmRlZF0gPT09IGZhbHNlKSB7XHJcblx0XHRcdFx0XHR0d3JhcCArPSAoKGxkYXRbaXNMZWFmXSA9PT0gdHJ1ZSkgPyBcIidcIiA6ICR0LnAudHJlZUljb25zLnBsdXMrXCIgdHJlZS1wbHVzIHRyZWVjbGljaydcIik7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHR3cmFwICs9ICgobGRhdFtpc0xlYWZdID09PSB0cnVlKSA/IFwiJ1wiIDogJHQucC50cmVlSWNvbnMubWludXMrXCIgdHJlZS1taW51cyB0cmVlY2xpY2snXCIpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0dHdyYXAgKz0gXCI+PC9kaXY+PC9kaXY+XCI7XHJcblx0XHRcdFx0JCgkdC5yb3dzW2ldLmNlbGxzW2V4cENvbF0pLndyYXBJbm5lcihcIjxzcGFuIGNsYXNzPSdjZWxsLXdyYXBwZXJcIitsZitcIic+PC9zcGFuPlwiKS5wcmVwZW5kKHR3cmFwKTtcclxuXHJcblx0XHRcdFx0aWYoY3VyTGV2ZWwgIT09IHBhcnNlSW50KCR0LnAudHJlZV9yb290X2xldmVsLDEwKSkge1xyXG5cdFx0XHRcdFx0dmFyIHBuID0gJCgkdCkuanFHcmlkKCdnZXROb2RlUGFyZW50JyxsZGF0KTtcclxuXHRcdFx0XHRcdGV4cGFuID0gcG4gJiYgcG4uaGFzT3duUHJvcGVydHkoZXhwYW5kZWQpID8gcG5bZXhwYW5kZWRdIDogdHJ1ZTtcclxuXHRcdFx0XHRcdGlmKCAhZXhwYW4gKXtcclxuXHRcdFx0XHRcdFx0JCgkdC5yb3dzW2ldKS5jc3MoXCJkaXNwbGF5XCIsXCJub25lXCIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQkKCR0LnJvd3NbaV0uY2VsbHNbZXhwQ29sXSlcclxuXHRcdFx0XHRcdC5maW5kKFwiZGl2LnRyZWVjbGlja1wiKVxyXG5cdFx0XHRcdFx0LmJpbmQoXCJjbGlja1wiLGZ1bmN0aW9uKGUpe1xyXG5cdFx0XHRcdFx0XHR2YXIgdGFyZ2V0ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50LFxyXG5cdFx0XHRcdFx0XHRpbmQyID0kLmpncmlkLnN0cmlwUHJlZigkdC5wLmlkUHJlZml4LCQodGFyZ2V0LCR0LnJvd3MpLmNsb3Nlc3QoXCJ0ci5qcWdyb3dcIilbMF0uaWQpLFxyXG5cdFx0XHRcdFx0XHRwb3MgPSAkdC5wLl9pbmRleFtpbmQyXTtcclxuXHRcdFx0XHRcdFx0aWYoISR0LnAuZGF0YVtwb3NdW2lzTGVhZl0pe1xyXG5cdFx0XHRcdFx0XHRcdGlmKCR0LnAuZGF0YVtwb3NdW2V4cGFuZGVkXSl7XHJcblx0XHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJjb2xsYXBzZVJvd1wiLCR0LnAuZGF0YVtwb3NdKTtcclxuXHRcdFx0XHRcdFx0XHRcdCQoJHQpLmpxR3JpZChcImNvbGxhcHNlTm9kZVwiLCR0LnAuZGF0YVtwb3NdKTtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwiZXhwYW5kUm93XCIsJHQucC5kYXRhW3Bvc10pO1xyXG5cdFx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwiZXhwYW5kTm9kZVwiLCR0LnAuZGF0YVtwb3NdKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aWYoJHQucC5FeHBhbmRDb2xDbGljayA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdFx0JCgkdC5yb3dzW2ldLmNlbGxzW2V4cENvbF0pXHJcblx0XHRcdFx0XHRcdC5maW5kKFwic3Bhbi5jZWxsLXdyYXBwZXJcIilcclxuXHRcdFx0XHRcdFx0LmNzcyhcImN1cnNvclwiLFwicG9pbnRlclwiKVxyXG5cdFx0XHRcdFx0XHQuYmluZChcImNsaWNrXCIsZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdFx0XHRcdHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQsXHJcblx0XHRcdFx0XHRcdFx0aW5kMiA9JC5qZ3JpZC5zdHJpcFByZWYoJHQucC5pZFByZWZpeCwkKHRhcmdldCwkdC5yb3dzKS5jbG9zZXN0KFwidHIuanFncm93XCIpWzBdLmlkKSxcclxuXHRcdFx0XHRcdFx0XHRwb3MgPSAkdC5wLl9pbmRleFtpbmQyXTtcclxuXHRcdFx0XHRcdFx0XHRpZighJHQucC5kYXRhW3Bvc11baXNMZWFmXSl7XHJcblx0XHRcdFx0XHRcdFx0XHRpZigkdC5wLmRhdGFbcG9zXVtleHBhbmRlZF0pe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJjb2xsYXBzZVJvd1wiLCR0LnAuZGF0YVtwb3NdKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwiY29sbGFwc2VOb2RlXCIsJHQucC5kYXRhW3Bvc10pO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKFwiZXhwYW5kUm93XCIsJHQucC5kYXRhW3Bvc10pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJleHBhbmROb2RlXCIsJHQucC5kYXRhW3Bvc10pO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJzZXRTZWxlY3Rpb25cIixpbmQyKTtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpKys7XHJcblx0XHRcdH1cclxuXHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdHNldFRyZWVHcmlkIDogZnVuY3Rpb24oKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpe1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzLCBpPTAsIHBpY28sIGVjb2wgPSBmYWxzZSwgbm0sIGtleSwgdGtleSwgZHVwY29scz1bXTtcclxuXHRcdFx0aWYoISR0LnAudHJlZUdyaWQpIHtyZXR1cm47fVxyXG5cdFx0XHRpZighJHQucC50cmVlZGF0YXR5cGUgKSB7JC5leHRlbmQoJHQucCx7dHJlZWRhdGF0eXBlOiAkdC5wLmRhdGF0eXBlfSk7fVxyXG5cdFx0XHQkdC5wLnN1YkdyaWQgPSBmYWxzZTskdC5wLmFsdFJvd3MgPWZhbHNlO1xyXG5cdFx0XHQkdC5wLnBnYnV0dG9ucyA9IGZhbHNlOyR0LnAucGdpbnB1dCA9IGZhbHNlO1xyXG5cdFx0XHQkdC5wLmdyaWR2aWV3ID0gIHRydWU7XHJcblx0XHRcdGlmKCR0LnAucm93VG90YWwgPT09IG51bGwgKSB7ICR0LnAucm93TnVtID0gMTAwMDA7IH1cclxuXHRcdFx0JHQucC5tdWx0aXNlbGVjdCA9IGZhbHNlOyR0LnAucm93TGlzdCA9IFtdO1xyXG5cdFx0XHQkdC5wLmV4cENvbEluZCA9IDA7XHJcblx0XHRcdHBpY28gPSAndWktaWNvbi10cmlhbmdsZS0xLScgKyAoJHQucC5kaXJlY3Rpb249PT1cInJ0bFwiID8gJ3cnIDogJ2UnKTtcclxuXHRcdFx0JHQucC50cmVlSWNvbnMgPSAkLmV4dGVuZCh7cGx1czpwaWNvLG1pbnVzOid1aS1pY29uLXRyaWFuZ2xlLTEtcycsbGVhZjondWktaWNvbi1yYWRpby1vZmYnfSwkdC5wLnRyZWVJY29ucyB8fCB7fSk7XHJcblx0XHRcdGlmKCR0LnAudHJlZUdyaWRNb2RlbCA9PT0gJ25lc3RlZCcpIHtcclxuXHRcdFx0XHQkdC5wLnRyZWVSZWFkZXIgPSAkLmV4dGVuZCh7XHJcblx0XHRcdFx0XHRsZXZlbF9maWVsZDogXCJsZXZlbFwiLFxyXG5cdFx0XHRcdFx0bGVmdF9maWVsZDpcImxmdFwiLFxyXG5cdFx0XHRcdFx0cmlnaHRfZmllbGQ6IFwicmd0XCIsXHJcblx0XHRcdFx0XHRsZWFmX2ZpZWxkOiBcImlzTGVhZlwiLFxyXG5cdFx0XHRcdFx0ZXhwYW5kZWRfZmllbGQ6IFwiZXhwYW5kZWRcIixcclxuXHRcdFx0XHRcdGxvYWRlZDogXCJsb2FkZWRcIixcclxuXHRcdFx0XHRcdGljb25fZmllbGQ6IFwiaWNvblwiXHJcblx0XHRcdFx0fSwkdC5wLnRyZWVSZWFkZXIpO1xyXG5cdFx0XHR9IGVsc2UgaWYoJHQucC50cmVlR3JpZE1vZGVsID09PSAnYWRqYWNlbmN5Jykge1xyXG5cdFx0XHRcdCR0LnAudHJlZVJlYWRlciA9ICQuZXh0ZW5kKHtcclxuXHRcdFx0XHRcdFx0bGV2ZWxfZmllbGQ6IFwibGV2ZWxcIixcclxuXHRcdFx0XHRcdFx0cGFyZW50X2lkX2ZpZWxkOiBcInBhcmVudFwiLFxyXG5cdFx0XHRcdFx0XHRsZWFmX2ZpZWxkOiBcImlzTGVhZlwiLFxyXG5cdFx0XHRcdFx0XHRleHBhbmRlZF9maWVsZDogXCJleHBhbmRlZFwiLFxyXG5cdFx0XHRcdFx0XHRsb2FkZWQ6IFwibG9hZGVkXCIsXHJcblx0XHRcdFx0XHRcdGljb25fZmllbGQ6IFwiaWNvblwiXHJcblx0XHRcdFx0fSwkdC5wLnRyZWVSZWFkZXIgKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmb3IgKCBrZXkgaW4gJHQucC5jb2xNb2RlbCl7XHJcblx0XHRcdFx0aWYoJHQucC5jb2xNb2RlbC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcblx0XHRcdFx0XHRubSA9ICR0LnAuY29sTW9kZWxba2V5XS5uYW1lO1xyXG5cdFx0XHRcdFx0aWYoIG5tID09PSAkdC5wLkV4cGFuZENvbHVtbiAmJiAhZWNvbCApIHtcclxuXHRcdFx0XHRcdFx0ZWNvbCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdCR0LnAuZXhwQ29sSW5kID0gaTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGkrKztcclxuXHRcdFx0XHRcdC8vXHJcblx0XHRcdFx0XHRmb3IodGtleSBpbiAkdC5wLnRyZWVSZWFkZXIpIHtcclxuXHRcdFx0XHRcdFx0aWYoJHQucC50cmVlUmVhZGVyLmhhc093blByb3BlcnR5KHRrZXkpICYmICR0LnAudHJlZVJlYWRlclt0a2V5XSA9PT0gbm0pIHtcclxuXHRcdFx0XHRcdFx0XHRkdXBjb2xzLnB1c2gobm0pO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdCQuZWFjaCgkdC5wLnRyZWVSZWFkZXIsZnVuY3Rpb24oaixuKXtcclxuXHRcdFx0XHRpZihuICYmICQuaW5BcnJheShuLCBkdXBjb2xzKSA9PT0gLTEpe1xyXG5cdFx0XHRcdFx0aWYoaj09PSdsZWFmX2ZpZWxkJykgeyAkdC5wLl90cmVlbGVhZnBvcz0gaTsgfVxyXG5cdFx0XHRcdGkrKztcclxuXHRcdFx0XHRcdCR0LnAuY29sTmFtZXMucHVzaChuKTtcclxuXHRcdFx0XHRcdCR0LnAuY29sTW9kZWwucHVzaCh7bmFtZTpuLHdpZHRoOjEsaGlkZGVuOnRydWUsc29ydGFibGU6ZmFsc2UscmVzaXphYmxlOmZhbHNlLGhpZGVkbGc6dHJ1ZSxlZGl0YWJsZTp0cnVlLHNlYXJjaDpmYWxzZX0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdGV4cGFuZFJvdzogZnVuY3Rpb24gKHJlY29yZCl7XHJcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyICR0ID0gdGhpcztcclxuXHRcdFx0aWYoISR0LmdyaWQgfHwgISR0LnAudHJlZUdyaWQpIHtyZXR1cm47fVxyXG5cdFx0XHR2YXIgY2hpbGRlcm4gPSAkKCR0KS5qcUdyaWQoXCJnZXROb2RlQ2hpbGRyZW5cIixyZWNvcmQpLFxyXG5cdFx0XHQvL2lmICgkKCR0KS5qcUdyaWQoXCJpc1Zpc2libGVOb2RlXCIscmVjb3JkKSkge1xyXG5cdFx0XHRleHBhbmRlZCA9ICR0LnAudHJlZVJlYWRlci5leHBhbmRlZF9maWVsZDtcclxuXHRcdFx0JChjaGlsZGVybikuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHZhciBpZCAgPSAkdC5wLmlkUHJlZml4ICsgJC5qZ3JpZC5nZXRBY2Nlc3Nvcih0aGlzLCR0LnAubG9jYWxSZWFkZXIuaWQpO1xyXG5cdFx0XHRcdCQoJCgkdCkuanFHcmlkKCdnZXRHcmlkUm93QnlJZCcsIGlkKSkuY3NzKFwiZGlzcGxheVwiLFwiXCIpO1xyXG5cdFx0XHRcdGlmKHRoaXNbZXhwYW5kZWRdKSB7XHJcblx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJleHBhbmRSb3dcIix0aGlzKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHQvL31cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0Y29sbGFwc2VSb3cgOiBmdW5jdGlvbiAocmVjb3JkKSB7XHJcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyICR0ID0gdGhpcztcclxuXHRcdFx0aWYoISR0LmdyaWQgfHwgISR0LnAudHJlZUdyaWQpIHtyZXR1cm47fVxyXG5cdFx0XHR2YXIgY2hpbGRlcm4gPSAkKCR0KS5qcUdyaWQoXCJnZXROb2RlQ2hpbGRyZW5cIixyZWNvcmQpLFxyXG5cdFx0XHRleHBhbmRlZCA9ICR0LnAudHJlZVJlYWRlci5leHBhbmRlZF9maWVsZDtcclxuXHRcdFx0JChjaGlsZGVybikuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHZhciBpZCAgPSAkdC5wLmlkUHJlZml4ICsgJC5qZ3JpZC5nZXRBY2Nlc3Nvcih0aGlzLCR0LnAubG9jYWxSZWFkZXIuaWQpO1xyXG5cdFx0XHRcdCQoJCgkdCkuanFHcmlkKCdnZXRHcmlkUm93QnlJZCcsIGlkKSkuY3NzKFwiZGlzcGxheVwiLFwibm9uZVwiKTtcclxuXHRcdFx0XHRpZih0aGlzW2V4cGFuZGVkXSl7XHJcblx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJjb2xsYXBzZVJvd1wiLHRoaXMpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdC8vIE5TICxhZGphY2VuY3kgbW9kZWxzXHJcblx0Z2V0Um9vdE5vZGVzIDogZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgcmVzdWx0ID0gW107XHJcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyICR0ID0gdGhpcztcclxuXHRcdFx0aWYoISR0LmdyaWQgfHwgISR0LnAudHJlZUdyaWQpIHtyZXR1cm47fVxyXG5cdFx0XHRzd2l0Y2ggKCR0LnAudHJlZUdyaWRNb2RlbCkge1xyXG5cdFx0XHRcdGNhc2UgJ25lc3RlZCcgOlxyXG5cdFx0XHRcdFx0dmFyIGxldmVsID0gJHQucC50cmVlUmVhZGVyLmxldmVsX2ZpZWxkO1xyXG5cdFx0XHRcdFx0JCgkdC5wLmRhdGEpLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdFx0aWYocGFyc2VJbnQodGhpc1tsZXZlbF0sMTApID09PSBwYXJzZUludCgkdC5wLnRyZWVfcm9vdF9sZXZlbCwxMCkpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXN1bHQucHVzaCh0aGlzKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlICdhZGphY2VuY3knIDpcclxuXHRcdFx0XHRcdHZhciBwYXJlbnRfaWQgPSAkdC5wLnRyZWVSZWFkZXIucGFyZW50X2lkX2ZpZWxkO1xyXG5cdFx0XHRcdFx0JCgkdC5wLmRhdGEpLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdFx0aWYodGhpc1twYXJlbnRfaWRdID09PSBudWxsIHx8IFN0cmluZyh0aGlzW3BhcmVudF9pZF0pLnRvTG93ZXJDYXNlKCkgPT09IFwibnVsbFwiKSB7XHJcblx0XHRcdFx0XHRcdFx0cmVzdWx0LnB1c2godGhpcyk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0cmV0dXJuIHJlc3VsdDtcclxuXHR9LFxyXG5cdGdldE5vZGVEZXB0aCA6IGZ1bmN0aW9uKHJjKSB7XHJcblx0XHR2YXIgcmV0ID0gbnVsbDtcclxuXHRcdHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRpZighdGhpcy5ncmlkIHx8ICF0aGlzLnAudHJlZUdyaWQpIHtyZXR1cm47fVxyXG5cdFx0XHR2YXIgJHQgPSB0aGlzO1xyXG5cdFx0XHRzd2l0Y2ggKCR0LnAudHJlZUdyaWRNb2RlbCkge1xyXG5cdFx0XHRcdGNhc2UgJ25lc3RlZCcgOlxyXG5cdFx0XHRcdFx0dmFyIGxldmVsID0gJHQucC50cmVlUmVhZGVyLmxldmVsX2ZpZWxkO1xyXG5cdFx0XHRcdFx0cmV0ID0gcGFyc2VJbnQocmNbbGV2ZWxdLDEwKSAtIHBhcnNlSW50KCR0LnAudHJlZV9yb290X2xldmVsLDEwKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgJ2FkamFjZW5jeScgOlxyXG5cdFx0XHRcdFx0cmV0ID0gJCgkdCkuanFHcmlkKFwiZ2V0Tm9kZUFuY2VzdG9yc1wiLHJjKS5sZW5ndGg7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRyZXR1cm4gcmV0O1xyXG5cdH0sXHJcblx0Z2V0Tm9kZVBhcmVudCA6IGZ1bmN0aW9uKHJjKSB7XHJcblx0XHR2YXIgcmVzdWx0ID0gbnVsbDtcclxuXHRcdHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzO1xyXG5cdFx0XHRpZighJHQuZ3JpZCB8fCAhJHQucC50cmVlR3JpZCkge3JldHVybjt9XHJcblx0XHRcdHN3aXRjaCAoJHQucC50cmVlR3JpZE1vZGVsKSB7XHJcblx0XHRcdFx0Y2FzZSAnbmVzdGVkJyA6XHJcblx0XHRcdFx0XHR2YXIgbGZ0YyA9ICR0LnAudHJlZVJlYWRlci5sZWZ0X2ZpZWxkLFxyXG5cdFx0XHRcdFx0cmd0YyA9ICR0LnAudHJlZVJlYWRlci5yaWdodF9maWVsZCxcclxuXHRcdFx0XHRcdGxldmVsYyA9ICR0LnAudHJlZVJlYWRlci5sZXZlbF9maWVsZCxcclxuXHRcdFx0XHRcdGxmdCA9IHBhcnNlSW50KHJjW2xmdGNdLDEwKSwgcmd0ID0gcGFyc2VJbnQocmNbcmd0Y10sMTApLCBsZXZlbCA9IHBhcnNlSW50KHJjW2xldmVsY10sMTApO1xyXG5cdFx0XHRcdFx0JCh0aGlzLnAuZGF0YSkuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0XHRpZihwYXJzZUludCh0aGlzW2xldmVsY10sMTApID09PSBsZXZlbC0xICYmIHBhcnNlSW50KHRoaXNbbGZ0Y10sMTApIDwgbGZ0ICYmIHBhcnNlSW50KHRoaXNbcmd0Y10sMTApID4gcmd0KSB7XHJcblx0XHRcdFx0XHRcdFx0cmVzdWx0ID0gdGhpcztcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSAnYWRqYWNlbmN5JyA6XHJcblx0XHRcdFx0XHR2YXIgcGFyZW50X2lkID0gJHQucC50cmVlUmVhZGVyLnBhcmVudF9pZF9maWVsZCxcclxuXHRcdFx0XHRcdGR0aWQgPSAkdC5wLmxvY2FsUmVhZGVyLmlkO1xyXG5cdFx0XHRcdFx0JCh0aGlzLnAuZGF0YSkuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0XHRpZih0aGlzW2R0aWRdID09PSAkLmpncmlkLnN0cmlwUHJlZigkdC5wLmlkUHJlZml4LCByY1twYXJlbnRfaWRdKSApIHtcclxuXHRcdFx0XHRcdFx0XHRyZXN1bHQgPSB0aGlzO1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdH0sXHJcblx0Z2V0Tm9kZUNoaWxkcmVuIDogZnVuY3Rpb24ocmMpIHtcclxuXHRcdHZhciByZXN1bHQgPSBbXTtcclxuXHRcdHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzO1xyXG5cdFx0XHRpZighJHQuZ3JpZCB8fCAhJHQucC50cmVlR3JpZCkge3JldHVybjt9XHJcblx0XHRcdHN3aXRjaCAoJHQucC50cmVlR3JpZE1vZGVsKSB7XHJcblx0XHRcdFx0Y2FzZSAnbmVzdGVkJyA6XHJcblx0XHRcdFx0XHR2YXIgbGZ0YyA9ICR0LnAudHJlZVJlYWRlci5sZWZ0X2ZpZWxkLFxyXG5cdFx0XHRcdFx0cmd0YyA9ICR0LnAudHJlZVJlYWRlci5yaWdodF9maWVsZCxcclxuXHRcdFx0XHRcdGxldmVsYyA9ICR0LnAudHJlZVJlYWRlci5sZXZlbF9maWVsZCxcclxuXHRcdFx0XHRcdGxmdCA9IHBhcnNlSW50KHJjW2xmdGNdLDEwKSwgcmd0ID0gcGFyc2VJbnQocmNbcmd0Y10sMTApLCBsZXZlbCA9IHBhcnNlSW50KHJjW2xldmVsY10sMTApO1xyXG5cdFx0XHRcdFx0JCh0aGlzLnAuZGF0YSkuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0XHRpZihwYXJzZUludCh0aGlzW2xldmVsY10sMTApID09PSBsZXZlbCsxICYmIHBhcnNlSW50KHRoaXNbbGZ0Y10sMTApID4gbGZ0ICYmIHBhcnNlSW50KHRoaXNbcmd0Y10sMTApIDwgcmd0KSB7XHJcblx0XHRcdFx0XHRcdFx0cmVzdWx0LnB1c2godGhpcyk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSAnYWRqYWNlbmN5JyA6XHJcblx0XHRcdFx0XHR2YXIgcGFyZW50X2lkID0gJHQucC50cmVlUmVhZGVyLnBhcmVudF9pZF9maWVsZCxcclxuXHRcdFx0XHRcdGR0aWQgPSAkdC5wLmxvY2FsUmVhZGVyLmlkO1xyXG5cdFx0XHRcdFx0JCh0aGlzLnAuZGF0YSkuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0XHRpZih0aGlzW3BhcmVudF9pZF0gPT0gJC5qZ3JpZC5zdHJpcFByZWYoJHQucC5pZFByZWZpeCwgcmNbZHRpZF0pKSB7XHJcblx0XHRcdFx0XHRcdFx0cmVzdWx0LnB1c2godGhpcyk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0cmV0dXJuIHJlc3VsdDtcclxuXHR9LFxyXG5cdGdldEZ1bGxUcmVlTm9kZSA6IGZ1bmN0aW9uKHJjKSB7XHJcblx0XHR2YXIgcmVzdWx0ID0gW107XHJcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyICR0ID0gdGhpcywgbGVuO1xyXG5cdFx0XHRpZighJHQuZ3JpZCB8fCAhJHQucC50cmVlR3JpZCkge3JldHVybjt9XHJcblx0XHRcdHN3aXRjaCAoJHQucC50cmVlR3JpZE1vZGVsKSB7XHJcblx0XHRcdFx0Y2FzZSAnbmVzdGVkJyA6XHJcblx0XHRcdFx0XHR2YXIgbGZ0YyA9ICR0LnAudHJlZVJlYWRlci5sZWZ0X2ZpZWxkLFxyXG5cdFx0XHRcdFx0cmd0YyA9ICR0LnAudHJlZVJlYWRlci5yaWdodF9maWVsZCxcclxuXHRcdFx0XHRcdGxldmVsYyA9ICR0LnAudHJlZVJlYWRlci5sZXZlbF9maWVsZCxcclxuXHRcdFx0XHRcdGxmdCA9IHBhcnNlSW50KHJjW2xmdGNdLDEwKSwgcmd0ID0gcGFyc2VJbnQocmNbcmd0Y10sMTApLCBsZXZlbCA9IHBhcnNlSW50KHJjW2xldmVsY10sMTApO1xyXG5cdFx0XHRcdFx0JCh0aGlzLnAuZGF0YSkuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0XHRpZihwYXJzZUludCh0aGlzW2xldmVsY10sMTApID49IGxldmVsICYmIHBhcnNlSW50KHRoaXNbbGZ0Y10sMTApID49IGxmdCAmJiBwYXJzZUludCh0aGlzW2xmdGNdLDEwKSA8PSByZ3QpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXN1bHQucHVzaCh0aGlzKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlICdhZGphY2VuY3knIDpcclxuXHRcdFx0XHRcdGlmKHJjKSB7XHJcblx0XHRcdFx0XHRyZXN1bHQucHVzaChyYyk7XHJcblx0XHRcdFx0XHR2YXIgcGFyZW50X2lkID0gJHQucC50cmVlUmVhZGVyLnBhcmVudF9pZF9maWVsZCxcclxuXHRcdFx0XHRcdGR0aWQgPSAkdC5wLmxvY2FsUmVhZGVyLmlkO1xyXG5cdFx0XHRcdFx0JCh0aGlzLnAuZGF0YSkuZWFjaChmdW5jdGlvbihpKXtcclxuXHRcdFx0XHRcdFx0bGVuID0gcmVzdWx0Lmxlbmd0aDtcclxuXHRcdFx0XHRcdFx0Zm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKCQuamdyaWQuc3RyaXBQcmVmKCR0LnAuaWRQcmVmaXgsIHJlc3VsdFtpXVtkdGlkXSkgPT09IHRoaXNbcGFyZW50X2lkXSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0cmVzdWx0LnB1c2godGhpcyk7XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0cmV0dXJuIHJlc3VsdDtcclxuXHR9LFxyXG5cdC8vIEVuZCBOUywgYWRqYWNlbmN5IE1vZGVsXHJcblx0Z2V0Tm9kZUFuY2VzdG9ycyA6IGZ1bmN0aW9uKHJjKSB7XHJcblx0XHR2YXIgYW5jZXN0b3JzID0gW107XHJcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0aWYoIXRoaXMuZ3JpZCB8fCAhdGhpcy5wLnRyZWVHcmlkKSB7cmV0dXJuO31cclxuXHRcdFx0dmFyIHBhcmVudCA9ICQodGhpcykuanFHcmlkKFwiZ2V0Tm9kZVBhcmVudFwiLHJjKTtcclxuXHRcdFx0d2hpbGUgKHBhcmVudCkge1xyXG5cdFx0XHRcdGFuY2VzdG9ycy5wdXNoKHBhcmVudCk7XHJcblx0XHRcdFx0cGFyZW50ID0gJCh0aGlzKS5qcUdyaWQoXCJnZXROb2RlUGFyZW50XCIscGFyZW50KTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRyZXR1cm4gYW5jZXN0b3JzO1xyXG5cdH0sXHJcblx0aXNWaXNpYmxlTm9kZSA6IGZ1bmN0aW9uKHJjKSB7XHJcblx0XHR2YXIgcmVzdWx0ID0gdHJ1ZTtcclxuXHRcdHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzO1xyXG5cdFx0XHRpZighJHQuZ3JpZCB8fCAhJHQucC50cmVlR3JpZCkge3JldHVybjt9XHJcblx0XHRcdHZhciBhbmNlc3RvcnMgPSAkKCR0KS5qcUdyaWQoXCJnZXROb2RlQW5jZXN0b3JzXCIscmMpLFxyXG5cdFx0XHRleHBhbmRlZCA9ICR0LnAudHJlZVJlYWRlci5leHBhbmRlZF9maWVsZDtcclxuXHRcdFx0JChhbmNlc3RvcnMpLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRyZXN1bHQgPSByZXN1bHQgJiYgdGhpc1tleHBhbmRlZF07XHJcblx0XHRcdFx0aWYoIXJlc3VsdCkge3JldHVybiBmYWxzZTt9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdH0sXHJcblx0aXNOb2RlTG9hZGVkIDogZnVuY3Rpb24ocmMpIHtcclxuXHRcdHZhciByZXN1bHQ7XHJcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyICR0ID0gdGhpcztcclxuXHRcdFx0aWYoISR0LmdyaWQgfHwgISR0LnAudHJlZUdyaWQpIHtyZXR1cm47fVxyXG5cdFx0XHR2YXIgaXNMZWFmID0gJHQucC50cmVlUmVhZGVyLmxlYWZfZmllbGQsXHJcblx0XHRcdGxvYWRlZCA9ICR0LnAudHJlZVJlYWRlci5sb2FkZWQ7XHJcblx0XHRcdGlmKHJjICE9PSB1bmRlZmluZWQgKSB7XHJcblx0XHRcdFx0aWYocmNbbG9hZGVkXSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRyZXN1bHQgPSByY1tsb2FkZWRdO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiggcmNbaXNMZWFmXSB8fCAkKCR0KS5qcUdyaWQoXCJnZXROb2RlQ2hpbGRyZW5cIixyYykubGVuZ3RoID4gMCl7XHJcblx0XHRcdFx0XHRyZXN1bHQgPSB0cnVlO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRyZXN1bHQgPSBmYWxzZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cmVzdWx0ID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0cmV0dXJuIHJlc3VsdDtcclxuXHR9LFxyXG5cdGV4cGFuZE5vZGUgOiBmdW5jdGlvbihyYykge1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRpZighdGhpcy5ncmlkIHx8ICF0aGlzLnAudHJlZUdyaWQpIHtyZXR1cm47fVxyXG5cdFx0XHR2YXIgZXhwYW5kZWQgPSB0aGlzLnAudHJlZVJlYWRlci5leHBhbmRlZF9maWVsZCxcclxuXHRcdFx0cGFyZW50ID0gdGhpcy5wLnRyZWVSZWFkZXIucGFyZW50X2lkX2ZpZWxkLFxyXG5cdFx0XHRsb2FkZWQgPSB0aGlzLnAudHJlZVJlYWRlci5sb2FkZWQsXHJcblx0XHRcdGxldmVsID0gdGhpcy5wLnRyZWVSZWFkZXIubGV2ZWxfZmllbGQsXHJcblx0XHRcdGxmdCA9IHRoaXMucC50cmVlUmVhZGVyLmxlZnRfZmllbGQsXHJcblx0XHRcdHJndCA9IHRoaXMucC50cmVlUmVhZGVyLnJpZ2h0X2ZpZWxkO1xyXG5cclxuXHRcdFx0aWYoIXJjW2V4cGFuZGVkXSkge1xyXG5cdFx0XHRcdHZhciBpZCA9ICQuamdyaWQuZ2V0QWNjZXNzb3IocmMsdGhpcy5wLmxvY2FsUmVhZGVyLmlkKTtcclxuXHRcdFx0XHR2YXIgcmMxID0gJChcIiNcIiArIHRoaXMucC5pZFByZWZpeCArICQuamdyaWQuanFJRChpZCksdGhpcy5ncmlkLmJEaXYpWzBdO1xyXG5cdFx0XHRcdHZhciBwb3NpdGlvbiA9IHRoaXMucC5faW5kZXhbaWRdO1xyXG5cdFx0XHRcdGlmKCAkKHRoaXMpLmpxR3JpZChcImlzTm9kZUxvYWRlZFwiLHRoaXMucC5kYXRhW3Bvc2l0aW9uXSkgKSB7XHJcblx0XHRcdFx0XHRyY1tleHBhbmRlZF0gPSB0cnVlO1xyXG5cdFx0XHRcdFx0JChcImRpdi50cmVlY2xpY2tcIixyYzEpLnJlbW92ZUNsYXNzKHRoaXMucC50cmVlSWNvbnMucGx1cytcIiB0cmVlLXBsdXNcIikuYWRkQ2xhc3ModGhpcy5wLnRyZWVJY29ucy5taW51cytcIiB0cmVlLW1pbnVzXCIpO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoIXRoaXMuZ3JpZC5oRGl2LmxvYWRpbmcpIHtcclxuXHRcdFx0XHRcdHJjW2V4cGFuZGVkXSA9IHRydWU7XHJcblx0XHRcdFx0XHQkKFwiZGl2LnRyZWVjbGlja1wiLHJjMSkucmVtb3ZlQ2xhc3ModGhpcy5wLnRyZWVJY29ucy5wbHVzK1wiIHRyZWUtcGx1c1wiKS5hZGRDbGFzcyh0aGlzLnAudHJlZUljb25zLm1pbnVzK1wiIHRyZWUtbWludXNcIik7XHJcblx0XHRcdFx0XHR0aGlzLnAudHJlZUFOb2RlID0gcmMxLnJvd0luZGV4O1xyXG5cdFx0XHRcdFx0dGhpcy5wLmRhdGF0eXBlID0gdGhpcy5wLnRyZWVkYXRhdHlwZTtcclxuXHRcdFx0XHRcdGlmKHRoaXMucC50cmVlR3JpZE1vZGVsID09PSAnbmVzdGVkJykge1xyXG5cdFx0XHRcdFx0XHQkKHRoaXMpLmpxR3JpZChcInNldEdyaWRQYXJhbVwiLHtwb3N0RGF0YTp7bm9kZWlkOmlkLG5fbGVmdDpyY1tsZnRdLG5fcmlnaHQ6cmNbcmd0XSxuX2xldmVsOnJjW2xldmVsXX19KTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdCQodGhpcykuanFHcmlkKFwic2V0R3JpZFBhcmFtXCIse3Bvc3REYXRhOntub2RlaWQ6aWQscGFyZW50aWQ6cmNbcGFyZW50XSxuX2xldmVsOnJjW2xldmVsXX19ICk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQkKHRoaXMpLnRyaWdnZXIoXCJyZWxvYWRHcmlkXCIpO1xyXG5cdFx0XHRcdFx0cmNbbG9hZGVkXSA9IHRydWU7XHJcblx0XHRcdFx0XHRpZih0aGlzLnAudHJlZUdyaWRNb2RlbCA9PT0gJ25lc3RlZCcpIHtcclxuXHRcdFx0XHRcdFx0JCh0aGlzKS5qcUdyaWQoXCJzZXRHcmlkUGFyYW1cIix7cG9zdERhdGE6e25vZGVpZDonJyxuX2xlZnQ6Jycsbl9yaWdodDonJyxuX2xldmVsOicnfX0pO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0JCh0aGlzKS5qcUdyaWQoXCJzZXRHcmlkUGFyYW1cIix7cG9zdERhdGE6e25vZGVpZDonJyxwYXJlbnRpZDonJyxuX2xldmVsOicnfX0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRjb2xsYXBzZU5vZGUgOiBmdW5jdGlvbihyYykge1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRpZighdGhpcy5ncmlkIHx8ICF0aGlzLnAudHJlZUdyaWQpIHtyZXR1cm47fVxyXG5cdFx0XHR2YXIgZXhwYW5kZWQgPSB0aGlzLnAudHJlZVJlYWRlci5leHBhbmRlZF9maWVsZDtcclxuXHRcdFx0aWYocmNbZXhwYW5kZWRdKSB7XHJcblx0XHRcdFx0cmNbZXhwYW5kZWRdID0gZmFsc2U7XHJcblx0XHRcdFx0dmFyIGlkID0gJC5qZ3JpZC5nZXRBY2Nlc3NvcihyYyx0aGlzLnAubG9jYWxSZWFkZXIuaWQpO1xyXG5cdFx0XHRcdHZhciByYzEgPSAkKFwiI1wiICsgdGhpcy5wLmlkUHJlZml4ICsgJC5qZ3JpZC5qcUlEKGlkKSx0aGlzLmdyaWQuYkRpdilbMF07XHJcblx0XHRcdFx0JChcImRpdi50cmVlY2xpY2tcIixyYzEpLnJlbW92ZUNsYXNzKHRoaXMucC50cmVlSWNvbnMubWludXMrXCIgdHJlZS1taW51c1wiKS5hZGRDbGFzcyh0aGlzLnAudHJlZUljb25zLnBsdXMrXCIgdHJlZS1wbHVzXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdFNvcnRUcmVlIDogZnVuY3Rpb24oIHNvcnRuYW1lLCBuZXdEaXIsIHN0LCBkYXRlZm10KSB7XHJcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdGlmKCF0aGlzLmdyaWQgfHwgIXRoaXMucC50cmVlR3JpZCkge3JldHVybjt9XHJcblx0XHRcdHZhciBpLCBsZW4sXHJcblx0XHRcdHJlYywgcmVjb3JkcyA9IFtdLCAkdCA9IHRoaXMsIHF1ZXJ5LCByb290cyxcclxuXHRcdFx0cnQgPSAkKHRoaXMpLmpxR3JpZChcImdldFJvb3ROb2Rlc1wiKTtcclxuXHRcdFx0Ly8gU29ydGluZyByb290c1xyXG5cdFx0XHRxdWVyeSA9ICQuamdyaWQuZnJvbShydCk7XHJcblx0XHRcdHF1ZXJ5Lm9yZGVyQnkoc29ydG5hbWUsbmV3RGlyLHN0LCBkYXRlZm10KTtcclxuXHRcdFx0cm9vdHMgPSBxdWVyeS5zZWxlY3QoKTtcclxuXHJcblx0XHRcdC8vIFNvcnRpbmcgY2hpbGRyZW5cclxuXHRcdFx0Zm9yIChpID0gMCwgbGVuID0gcm9vdHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0XHRyZWMgPSByb290c1tpXTtcclxuXHRcdFx0XHRyZWNvcmRzLnB1c2gocmVjKTtcclxuXHRcdFx0XHQkKHRoaXMpLmpxR3JpZChcImNvbGxlY3RDaGlsZHJlblNvcnRUcmVlXCIscmVjb3JkcywgcmVjLCBzb3J0bmFtZSwgbmV3RGlyLHN0LCBkYXRlZm10KTtcclxuXHRcdFx0fVxyXG5cdFx0XHQkLmVhY2gocmVjb3JkcywgZnVuY3Rpb24oaW5kZXgpIHtcclxuXHRcdFx0XHR2YXIgaWQgID0gJC5qZ3JpZC5nZXRBY2Nlc3Nvcih0aGlzLCR0LnAubG9jYWxSZWFkZXIuaWQpO1xyXG5cdFx0XHRcdCQoJyMnKyQuamdyaWQuanFJRCgkdC5wLmlkKSsgJyB0Ym9keSB0cjplcSgnK2luZGV4KycpJykuYWZ0ZXIoJCgndHIjJyskLmpncmlkLmpxSUQoaWQpLCR0LmdyaWQuYkRpdikpO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0cXVlcnkgPSBudWxsO3Jvb3RzPW51bGw7cmVjb3Jkcz1udWxsO1xyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRjb2xsZWN0Q2hpbGRyZW5Tb3J0VHJlZSA6IGZ1bmN0aW9uKHJlY29yZHMsIHJlYywgc29ydG5hbWUsIG5ld0RpcixzdCwgZGF0ZWZtdCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRpZighdGhpcy5ncmlkIHx8ICF0aGlzLnAudHJlZUdyaWQpIHtyZXR1cm47fVxyXG5cdFx0XHR2YXIgaSwgbGVuLFxyXG5cdFx0XHRjaGlsZCwgY2gsIHF1ZXJ5LCBjaGlsZHJlbjtcclxuXHRcdFx0Y2ggPSAkKHRoaXMpLmpxR3JpZChcImdldE5vZGVDaGlsZHJlblwiLHJlYyk7XHJcblx0XHRcdHF1ZXJ5ID0gJC5qZ3JpZC5mcm9tKGNoKTtcclxuXHRcdFx0cXVlcnkub3JkZXJCeShzb3J0bmFtZSwgbmV3RGlyLCBzdCwgZGF0ZWZtdCk7XHJcblx0XHRcdGNoaWxkcmVuID0gcXVlcnkuc2VsZWN0KCk7XHJcblx0XHRcdGZvciAoaSA9IDAsIGxlbiA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdFx0Y2hpbGQgPSBjaGlsZHJlbltpXTtcclxuXHRcdFx0XHRyZWNvcmRzLnB1c2goY2hpbGQpO1xyXG5cdFx0XHRcdCQodGhpcykuanFHcmlkKFwiY29sbGVjdENoaWxkcmVuU29ydFRyZWVcIixyZWNvcmRzLCBjaGlsZCwgc29ydG5hbWUsIG5ld0Rpciwgc3QsIGRhdGVmbXQpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdC8vIGV4cGVyaW1lbnRhbFxyXG5cdHNldFRyZWVSb3cgOiBmdW5jdGlvbihyb3dpZCwgZGF0YSkge1xyXG5cdFx0dmFyIHN1Y2Nlc3M9ZmFsc2U7XHJcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyIHQgPSB0aGlzO1xyXG5cdFx0XHRpZighdC5ncmlkIHx8ICF0LnAudHJlZUdyaWQpIHtyZXR1cm47fVxyXG5cdFx0XHRzdWNjZXNzID0gJCh0KS5qcUdyaWQoXCJzZXRSb3dEYXRhXCIscm93aWQsZGF0YSk7XHJcblx0XHR9KTtcclxuXHRcdHJldHVybiBzdWNjZXNzO1xyXG5cdH0sXHJcblx0ZGVsVHJlZU5vZGUgOiBmdW5jdGlvbiAocm93aWQpIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzLCByaWQgPSAkdC5wLmxvY2FsUmVhZGVyLmlkLCBpLFxyXG5cdFx0XHRsZWZ0ID0gJHQucC50cmVlUmVhZGVyLmxlZnRfZmllbGQsXHJcblx0XHRcdHJpZ2h0ID0gJHQucC50cmVlUmVhZGVyLnJpZ2h0X2ZpZWxkLCBteXJpZ2h0LCB3aWR0aCwgcmVzLCBrZXk7XHJcblx0XHRcdGlmKCEkdC5ncmlkIHx8ICEkdC5wLnRyZWVHcmlkKSB7cmV0dXJuO31cclxuXHRcdFx0dmFyIHJjID0gJHQucC5faW5kZXhbcm93aWRdO1xyXG5cdFx0XHRpZiAocmMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdC8vIG5lc3RlZFxyXG5cdFx0XHRcdG15cmlnaHQgPSBwYXJzZUludCgkdC5wLmRhdGFbcmNdW3JpZ2h0XSwxMCk7XHJcblx0XHRcdFx0d2lkdGggPSBteXJpZ2h0IC0gIHBhcnNlSW50KCR0LnAuZGF0YVtyY11bbGVmdF0sMTApICsgMTtcclxuXHRcdFx0XHR2YXIgZHIgPSAkKCR0KS5qcUdyaWQoXCJnZXRGdWxsVHJlZU5vZGVcIiwkdC5wLmRhdGFbcmNdKTtcclxuXHRcdFx0XHRpZihkci5sZW5ndGg+MCl7XHJcblx0XHRcdFx0XHRmb3IgKGk9MDtpPGRyLmxlbmd0aDtpKyspe1xyXG5cdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoXCJkZWxSb3dEYXRhXCIsZHJbaV1bcmlkXSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKCAkdC5wLnRyZWVHcmlkTW9kZWwgPT09IFwibmVzdGVkXCIpIHtcclxuXHRcdFx0XHRcdC8vIFRvRG8gLSB1cGRhdGUgZ3JpZCBkYXRhXHJcblx0XHRcdFx0XHRyZXMgPSAkLmpncmlkLmZyb20oJHQucC5kYXRhKVxyXG5cdFx0XHRcdFx0XHQuZ3JlYXRlcihsZWZ0LG15cmlnaHQse3N0eXBlOidpbnRlZ2VyJ30pXHJcblx0XHRcdFx0XHRcdC5zZWxlY3QoKTtcclxuXHRcdFx0XHRcdGlmKHJlcy5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0Zm9yKCBrZXkgaW4gcmVzKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYocmVzLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHJlc1trZXldW2xlZnRdID0gcGFyc2VJbnQocmVzW2tleV1bbGVmdF0sMTApIC0gd2lkdGggO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0cmVzID0gJC5qZ3JpZC5mcm9tKCR0LnAuZGF0YSlcclxuXHRcdFx0XHRcdFx0LmdyZWF0ZXIocmlnaHQsbXlyaWdodCx7c3R5cGU6J2ludGVnZXInfSlcclxuXHRcdFx0XHRcdFx0LnNlbGVjdCgpO1xyXG5cdFx0XHRcdFx0aWYocmVzLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRmb3IoIGtleSBpbiByZXMpIHtcclxuXHRcdFx0XHRcdFx0XHRpZihyZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0cmVzW2tleV1bcmlnaHRdID0gcGFyc2VJbnQocmVzW2tleV1bcmlnaHRdLDEwKSAtIHdpZHRoIDtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0YWRkQ2hpbGROb2RlIDogZnVuY3Rpb24oIG5vZGVpZCwgcGFyZW50aWQsIGRhdGEsIGV4cGFuZERhdGEgKSB7XHJcblx0XHQvL3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdHZhciAkdCA9IHRoaXNbMF07XHJcblx0XHRpZihkYXRhKSB7XHJcblx0XHRcdC8vIHdlIHN1cHBvc2UgdGhhIHRoZSBpZCBpcyBhdXRvaW5jcmVtZXQgYW5kXHJcblx0XHRcdHZhciBleHBhbmRlZCA9ICR0LnAudHJlZVJlYWRlci5leHBhbmRlZF9maWVsZCxcclxuXHRcdFx0aXNMZWFmID0gJHQucC50cmVlUmVhZGVyLmxlYWZfZmllbGQsXHJcblx0XHRcdGxldmVsID0gJHQucC50cmVlUmVhZGVyLmxldmVsX2ZpZWxkLFxyXG5cdFx0XHQvL2ljb24gPSAkdC5wLnRyZWVSZWFkZXIuaWNvbl9maWVsZCxcclxuXHRcdFx0cGFyZW50ID0gJHQucC50cmVlUmVhZGVyLnBhcmVudF9pZF9maWVsZCxcclxuXHRcdFx0bGVmdCA9ICR0LnAudHJlZVJlYWRlci5sZWZ0X2ZpZWxkLFxyXG5cdFx0XHRyaWdodCA9ICR0LnAudHJlZVJlYWRlci5yaWdodF9maWVsZCxcclxuXHRcdFx0bG9hZGVkID0gJHQucC50cmVlUmVhZGVyLmxvYWRlZCxcclxuXHRcdFx0bWV0aG9kLCBwYXJlbnRpbmRleCwgcGFyZW50ZGF0YSwgcGFyZW50bGV2ZWwsIGksIGxlbiwgbWF4PTAsIHJvd2luZCA9IHBhcmVudGlkLCBsZWFmLCBtYXhyaWdodDtcclxuXHRcdFx0aWYoZXhwYW5kRGF0YT09PXVuZGVmaW5lZCkge2V4cGFuZERhdGEgPSBmYWxzZTt9XHJcblx0XHRcdGlmICggbm9kZWlkID09PSB1bmRlZmluZWQgfHwgbm9kZWlkID09PSBudWxsICkge1xyXG5cdFx0XHRcdGkgPSAkdC5wLmRhdGEubGVuZ3RoLTE7XHJcblx0XHRcdFx0aWYoXHRpPj0gMCApIHtcclxuXHRcdFx0XHRcdHdoaWxlKGk+PTApe21heCA9IE1hdGgubWF4KG1heCwgcGFyc2VJbnQoJHQucC5kYXRhW2ldWyR0LnAubG9jYWxSZWFkZXIuaWRdLDEwKSk7IGktLTt9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdG5vZGVpZCA9IG1heCsxO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciBwcm93ID0gJCgkdCkuanFHcmlkKCdnZXRJbmQnLCBwYXJlbnRpZCk7XHJcblx0XHRcdGxlYWYgPSBmYWxzZTtcclxuXHRcdFx0Ly8gaWYgbm90IGEgcGFyZW50IHdlIGFzc3VtZSByb290XHJcblx0XHRcdGlmICggcGFyZW50aWQgPT09IHVuZGVmaW5lZCAgfHwgcGFyZW50aWQgPT09IG51bGwgfHwgcGFyZW50aWQ9PT1cIlwiKSB7XHJcblx0XHRcdFx0cGFyZW50aWQgPSBudWxsO1xyXG5cdFx0XHRcdHJvd2luZCA9IG51bGw7XHJcblx0XHRcdFx0bWV0aG9kID0gJ2xhc3QnO1xyXG5cdFx0XHRcdHBhcmVudGxldmVsID0gJHQucC50cmVlX3Jvb3RfbGV2ZWw7XHJcblx0XHRcdFx0aSA9ICR0LnAuZGF0YS5sZW5ndGgrMTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRtZXRob2QgPSAnYWZ0ZXInO1xyXG5cdFx0XHRcdHBhcmVudGluZGV4ID0gJHQucC5faW5kZXhbcGFyZW50aWRdO1xyXG5cdFx0XHRcdHBhcmVudGRhdGEgPSAkdC5wLmRhdGFbcGFyZW50aW5kZXhdO1xyXG5cdFx0XHRcdHBhcmVudGlkID0gcGFyZW50ZGF0YVskdC5wLmxvY2FsUmVhZGVyLmlkXTtcclxuXHRcdFx0XHRwYXJlbnRsZXZlbCA9IHBhcnNlSW50KHBhcmVudGRhdGFbbGV2ZWxdLDEwKSsxO1xyXG5cdFx0XHRcdHZhciBjaGlsZHMgPSAkKCR0KS5qcUdyaWQoJ2dldEZ1bGxUcmVlTm9kZScsIHBhcmVudGRhdGEpO1xyXG5cdFx0XHRcdC8vIGlmIHRoZXJlIGFyZSBjaGlsZCBub2RlcyBnZXQgdGhlIGxhc3QgaW5kZXggb2YgaXRcclxuXHRcdFx0XHRpZihjaGlsZHMubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRpID0gY2hpbGRzW2NoaWxkcy5sZW5ndGgtMV1bJHQucC5sb2NhbFJlYWRlci5pZF07XHJcblx0XHRcdFx0XHRyb3dpbmQgPSBpO1xyXG5cdFx0XHRcdFx0aSA9ICQoJHQpLmpxR3JpZCgnZ2V0SW5kJyxyb3dpbmQpKzE7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGkgPSAkKCR0KS5qcUdyaWQoJ2dldEluZCcsIHBhcmVudGlkKSsxO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvLyBpZiB0aGUgbm9kZSBpcyBsZWFmXHJcblx0XHRcdFx0aWYocGFyZW50ZGF0YVtpc0xlYWZdKSB7XHJcblx0XHRcdFx0XHRsZWFmID0gdHJ1ZTtcclxuXHRcdFx0XHRcdHBhcmVudGRhdGFbZXhwYW5kZWRdID0gdHJ1ZTtcclxuXHRcdFx0XHRcdC8vdmFyIHByb3cgPSAkKCR0KS5qcUdyaWQoJ2dldEluZCcsIHBhcmVudGlkKTtcclxuXHRcdFx0XHRcdCQoJHQucm93c1twcm93XSlcclxuXHRcdFx0XHRcdFx0LmZpbmQoXCJzcGFuLmNlbGwtd3JhcHBlcmxlYWZcIikucmVtb3ZlQ2xhc3MoXCJjZWxsLXdyYXBwZXJsZWFmXCIpLmFkZENsYXNzKFwiY2VsbC13cmFwcGVyXCIpXHJcblx0XHRcdFx0XHRcdC5lbmQoKVxyXG5cdFx0XHRcdFx0XHQuZmluZChcImRpdi50cmVlLWxlYWZcIikucmVtb3ZlQ2xhc3MoJHQucC50cmVlSWNvbnMubGVhZitcIiB0cmVlLWxlYWZcIikuYWRkQ2xhc3MoJHQucC50cmVlSWNvbnMubWludXMrXCIgdHJlZS1taW51c1wiKTtcclxuXHRcdFx0XHRcdCR0LnAuZGF0YVtwYXJlbnRpbmRleF1baXNMZWFmXSA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0cGFyZW50ZGF0YVtsb2FkZWRdID0gdHJ1ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0bGVuID0gaSsxO1xyXG5cclxuXHRcdFx0aWYoIGRhdGFbZXhwYW5kZWRdPT09dW5kZWZpbmVkKSAge2RhdGFbZXhwYW5kZWRdPSBmYWxzZTt9XHJcblx0XHRcdGlmKCBkYXRhW2xvYWRlZF09PT11bmRlZmluZWQgKSAgeyBkYXRhW2xvYWRlZF0gPSBmYWxzZTt9XHJcblx0XHRcdGRhdGFbbGV2ZWxdID0gcGFyZW50bGV2ZWw7XHJcblx0XHRcdGlmKCBkYXRhW2lzTGVhZl09PT11bmRlZmluZWQpIHtkYXRhW2lzTGVhZl09IHRydWU7fVxyXG5cdFx0XHRpZiggJHQucC50cmVlR3JpZE1vZGVsID09PSBcImFkamFjZW5jeVwiKSB7XHJcblx0XHRcdFx0ZGF0YVtwYXJlbnRdID0gcGFyZW50aWQ7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoICR0LnAudHJlZUdyaWRNb2RlbCA9PT0gXCJuZXN0ZWRcIikge1xyXG5cdFx0XHRcdC8vIHRoaXMgbWV0aG9kIHJlcXVpZXJlIG1vcmUgYXR0ZW50aW9uXHJcblx0XHRcdFx0dmFyIHF1ZXJ5LCByZXMsIGtleTtcclxuXHRcdFx0XHQvL21heHJpZ2h0ID0gcGFyc2VJbnQobWF4cmlnaHQsMTApO1xyXG5cdFx0XHRcdC8vIFRvRG8gLSB1cGRhdGUgZ3JpZCBkYXRhXHJcblx0XHRcdFx0aWYocGFyZW50aWQgIT09IG51bGwpIHtcclxuXHRcdFx0XHRcdG1heHJpZ2h0ID0gcGFyc2VJbnQocGFyZW50ZGF0YVtyaWdodF0sMTApO1xyXG5cdFx0XHRcdFx0cXVlcnkgPSAkLmpncmlkLmZyb20oJHQucC5kYXRhKTtcclxuXHRcdFx0XHRcdHF1ZXJ5ID0gcXVlcnkuZ3JlYXRlck9yRXF1YWxzKHJpZ2h0LG1heHJpZ2h0LHtzdHlwZTonaW50ZWdlcid9KTtcclxuXHRcdFx0XHRcdHJlcyA9IHF1ZXJ5LnNlbGVjdCgpO1xyXG5cdFx0XHRcdFx0aWYocmVzLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRmb3IoIGtleSBpbiByZXMpIHtcclxuXHRcdFx0XHRcdFx0XHRpZihyZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0cmVzW2tleV1bbGVmdF0gPSByZXNba2V5XVtsZWZ0XSA+IG1heHJpZ2h0ID8gcGFyc2VJbnQocmVzW2tleV1bbGVmdF0sMTApICsyIDogcmVzW2tleV1bbGVmdF07XHJcblx0XHRcdFx0XHRcdFx0XHRyZXNba2V5XVtyaWdodF0gPSByZXNba2V5XVtyaWdodF0gPj0gbWF4cmlnaHQgPyBwYXJzZUludChyZXNba2V5XVtyaWdodF0sMTApICsyIDogcmVzW2tleV1bcmlnaHRdO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZGF0YVtsZWZ0XSA9IG1heHJpZ2h0O1xyXG5cdFx0XHRcdFx0ZGF0YVtyaWdodF09IG1heHJpZ2h0KzE7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdG1heHJpZ2h0ID0gcGFyc2VJbnQoICQoJHQpLmpxR3JpZCgnZ2V0Q29sJywgcmlnaHQsIGZhbHNlLCAnbWF4JyksIDEwKTtcclxuXHRcdFx0XHRcdHJlcyA9ICQuamdyaWQuZnJvbSgkdC5wLmRhdGEpXHJcblx0XHRcdFx0XHRcdC5ncmVhdGVyKGxlZnQsbWF4cmlnaHQse3N0eXBlOidpbnRlZ2VyJ30pXHJcblx0XHRcdFx0XHRcdC5zZWxlY3QoKTtcclxuXHRcdFx0XHRcdGlmKHJlcy5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0Zm9yKCBrZXkgaW4gcmVzKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYocmVzLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHJlc1trZXldW2xlZnRdID0gcGFyc2VJbnQocmVzW2tleV1bbGVmdF0sMTApICsyIDtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJlcyA9ICQuamdyaWQuZnJvbSgkdC5wLmRhdGEpXHJcblx0XHRcdFx0XHRcdC5ncmVhdGVyKHJpZ2h0LG1heHJpZ2h0LHtzdHlwZTonaW50ZWdlcid9KVxyXG5cdFx0XHRcdFx0XHQuc2VsZWN0KCk7XHJcblx0XHRcdFx0XHRpZihyZXMubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdGZvcigga2V5IGluIHJlcykge1xyXG5cdFx0XHRcdFx0XHRcdGlmKHJlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRyZXNba2V5XVtyaWdodF0gPSBwYXJzZUludChyZXNba2V5XVtyaWdodF0sMTApICsyIDtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGRhdGFbbGVmdF0gPSBtYXhyaWdodCsxO1xyXG5cdFx0XHRcdFx0ZGF0YVtyaWdodF0gPSBtYXhyaWdodCArIDI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKCBwYXJlbnRpZCA9PT0gbnVsbCB8fCAkKCR0KS5qcUdyaWQoXCJpc05vZGVMb2FkZWRcIixwYXJlbnRkYXRhKSB8fCBsZWFmICkge1xyXG5cdFx0XHRcdFx0JCgkdCkuanFHcmlkKCdhZGRSb3dEYXRhJywgbm9kZWlkLCBkYXRhLCBtZXRob2QsIHJvd2luZCk7XHJcblx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoJ3NldFRyZWVOb2RlJywgaSwgbGVuKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZihwYXJlbnRkYXRhICYmICFwYXJlbnRkYXRhW2V4cGFuZGVkXSAmJiBleHBhbmREYXRhKSB7XHJcblx0XHRcdFx0JCgkdC5yb3dzW3Byb3ddKVxyXG5cdFx0XHRcdFx0LmZpbmQoXCJkaXYudHJlZWNsaWNrXCIpXHJcblx0XHRcdFx0XHQuY2xpY2soKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0Ly99KTtcclxuXHR9XHJcbn0pO1xyXG59KShqUXVlcnkpO1xyXG4vKmpzaGludCBlcWVxZXE6ZmFsc2UsIGVxbnVsbDp0cnVlICovXHJcbi8qZ2xvYmFsIGpRdWVyeSAqL1xyXG4vLyBHcm91cGluZyBtb2R1bGVcclxuKGZ1bmN0aW9uKCQpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuJC5leHRlbmQoJC5qZ3JpZCx7XHJcblx0dGVtcGxhdGUgOiBmdW5jdGlvbihmb3JtYXQpeyAvL2pxZ2Zvcm1hdFxyXG5cdFx0dmFyIGFyZ3MgPSAkLm1ha2VBcnJheShhcmd1bWVudHMpLnNsaWNlKDEpLCBqLCBhbCA9IGFyZ3MubGVuZ3RoO1xyXG5cdFx0aWYoZm9ybWF0PT1udWxsKSB7IGZvcm1hdCA9IFwiXCI7IH1cclxuXHRcdHJldHVybiBmb3JtYXQucmVwbGFjZSgvXFx7KFtcXHdcXC1dKykoPzpcXDooW1xcd1xcLl0qKSg/OlxcKCguKj8pP1xcKSk/KT9cXH0vZywgZnVuY3Rpb24obSxpKXtcclxuXHRcdFx0aWYoIWlzTmFOKHBhcnNlSW50KGksMTApKSkge1xyXG5cdFx0XHRcdHJldHVybiBhcmdzW3BhcnNlSW50KGksMTApXTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmb3Ioaj0wOyBqIDwgYWw7aisrKSB7XHJcblx0XHRcdFx0aWYoJC5pc0FycmF5KGFyZ3Nbal0pKSB7XHJcblx0XHRcdFx0XHR2YXIgbm1hcnIgPSBhcmdzWyBqIF0sXHJcblx0XHRcdFx0XHRrID0gbm1hcnIubGVuZ3RoO1xyXG5cdFx0XHRcdFx0d2hpbGUoay0tKSB7XHJcblx0XHRcdFx0XHRcdGlmKGk9PT1ubWFycltrXS5ubSkge1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiBubWFycltrXS52O1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn0pO1xyXG4kLmpncmlkLmV4dGVuZCh7XHJcblx0Z3JvdXBpbmdTZXR1cCA6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCl7XHJcblx0XHRcdHZhciAkdCA9IHRoaXMsIGksIGosIGNtbCwgY20gPSAkdC5wLmNvbE1vZGVsLCBncnAgPSAkdC5wLmdyb3VwaW5nVmlldztcclxuXHRcdFx0aWYoZ3JwICE9PSBudWxsICYmICggKHR5cGVvZiBncnAgPT09ICdvYmplY3QnKSB8fCAkLmlzRnVuY3Rpb24oZ3JwKSApICkge1xyXG5cdFx0XHRcdGlmKCFncnAuZ3JvdXBGaWVsZC5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdCR0LnAuZ3JvdXBpbmcgPSBmYWxzZTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0aWYgKGdycC52aXNpYmlsdHlPbk5leHRHcm91cGluZyA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdGdycC52aXNpYmlsdHlPbk5leHRHcm91cGluZyA9IFtdO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdGdycC5sYXN0dmFsdWVzPVtdO1xyXG5cdFx0XHRcdFx0aWYoIWdycC5fbG9jZ3IpIHtcclxuXHRcdFx0XHRcdFx0Z3JwLmdyb3VwcyA9W107XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRncnAuY291bnRlcnMgPVtdO1xyXG5cdFx0XHRcdFx0Zm9yKGk9MDtpPGdycC5ncm91cEZpZWxkLmxlbmd0aDtpKyspIHtcclxuXHRcdFx0XHRcdFx0aWYoIWdycC5ncm91cE9yZGVyW2ldKSB7XHJcblx0XHRcdFx0XHRcdFx0Z3JwLmdyb3VwT3JkZXJbaV0gPSAnYXNjJztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZighZ3JwLmdyb3VwVGV4dFtpXSkge1xyXG5cdFx0XHRcdFx0XHRcdGdycC5ncm91cFRleHRbaV0gPSAnezB9JztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZiggdHlwZW9mIGdycC5ncm91cENvbHVtblNob3dbaV0gIT09ICdib29sZWFuJykge1xyXG5cdFx0XHRcdFx0XHRcdGdycC5ncm91cENvbHVtblNob3dbaV0gPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmKCB0eXBlb2YgZ3JwLmdyb3VwU3VtbWFyeVtpXSAhPT0gJ2Jvb2xlYW4nKSB7XHJcblx0XHRcdFx0XHRcdFx0Z3JwLmdyb3VwU3VtbWFyeVtpXSA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmKCAhZ3JwLmdyb3VwU3VtbWFyeVBvc1tpXSkge1xyXG5cdFx0XHRcdFx0XHRcdGdycC5ncm91cFN1bW1hcnlQb3NbaV0gPSAnZm9vdGVyJztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZihncnAuZ3JvdXBDb2x1bW5TaG93W2ldID09PSB0cnVlKSB7XHJcblx0XHRcdFx0XHRcdFx0Z3JwLnZpc2liaWx0eU9uTmV4dEdyb3VwaW5nW2ldID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoJ3Nob3dDb2wnLGdycC5ncm91cEZpZWxkW2ldKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRncnAudmlzaWJpbHR5T25OZXh0R3JvdXBpbmdbaV0gPSAkKFwiI1wiKyQuamdyaWQuanFJRCgkdC5wLmlkK1wiX1wiK2dycC5ncm91cEZpZWxkW2ldKSkuaXMoXCI6dmlzaWJsZVwiKTtcclxuXHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoJ2hpZGVDb2wnLGdycC5ncm91cEZpZWxkW2ldKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Z3JwLnN1bW1hcnkgPVtdO1xyXG5cdFx0XHRcdFx0aWYoZ3JwLmhpZGVGaXJzdEdyb3VwQ29sKSB7XHJcblx0XHRcdFx0XHRcdGdycC5mb3JtYXREaXNwbGF5RmllbGRbMF0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gdjt9O1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Zm9yKGo9MCwgY21sID0gY20ubGVuZ3RoOyBqIDwgY21sOyBqKyspIHtcclxuXHRcdFx0XHRcdFx0aWYoZ3JwLmhpZGVGaXJzdEdyb3VwQ29sKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYoIWNtW2pdLmhpZGRlbiAmJiBncnAuZ3JvdXBGaWVsZFswXSA9PT0gY21bal0ubmFtZSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0Y21bal0uZm9ybWF0dGVyID0gZnVuY3Rpb24oKXtyZXR1cm4gJyc7fTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYoY21bal0uc3VtbWFyeVR5cGUgKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYoY21bal0uc3VtbWFyeURpdmlkZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGdycC5zdW1tYXJ5LnB1c2goe25tOmNtW2pdLm5hbWUsc3Q6Y21bal0uc3VtbWFyeVR5cGUsIHY6ICcnLCBzZDpjbVtqXS5zdW1tYXJ5RGl2aWRlciwgdmQ6JycsIHNyOiBjbVtqXS5zdW1tYXJ5Um91bmQsIHNydDogY21bal0uc3VtbWFyeVJvdW5kVHlwZSB8fCAncm91bmQnfSk7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdGdycC5zdW1tYXJ5LnB1c2goe25tOmNtW2pdLm5hbWUsc3Q6Y21bal0uc3VtbWFyeVR5cGUsIHY6ICcnLCBzcjogY21bal0uc3VtbWFyeVJvdW5kLCBzcnQ6IGNtW2pdLnN1bW1hcnlSb3VuZFR5cGUgfHwgJ3JvdW5kJ30pO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQkdC5wLmdyb3VwaW5nID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0Z3JvdXBpbmdQcmVwYXJlIDogZnVuY3Rpb24gKCByZWNvcmQsIGlyb3cgKSB7XHJcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyIGdycCA9IHRoaXMucC5ncm91cGluZ1ZpZXcsICR0PSB0aGlzLCBpLFxyXG5cdFx0XHRncmxlbiA9IGdycC5ncm91cEZpZWxkLmxlbmd0aCxcclxuXHRcdFx0ZmllbGROYW1lLFxyXG5cdFx0XHR2LFxyXG5cdFx0XHRkaXNwbGF5TmFtZSxcclxuXHRcdFx0ZGlzcGxheVZhbHVlLFxyXG5cdFx0XHRjaGFuZ2VkID0gMDtcclxuXHRcdFx0Zm9yKGk9MDtpPGdybGVuO2krKykge1xyXG5cdFx0XHRcdGZpZWxkTmFtZSA9IGdycC5ncm91cEZpZWxkW2ldO1xyXG5cdFx0XHRcdGRpc3BsYXlOYW1lID0gZ3JwLmRpc3BsYXlGaWVsZFtpXTtcclxuXHRcdFx0XHR2ID0gcmVjb3JkW2ZpZWxkTmFtZV07XHJcblx0XHRcdFx0ZGlzcGxheVZhbHVlID0gZGlzcGxheU5hbWUgPT0gbnVsbCA/IG51bGwgOiByZWNvcmRbZGlzcGxheU5hbWVdO1xyXG5cclxuXHRcdFx0XHRpZiggZGlzcGxheVZhbHVlID09IG51bGwgKSB7XHJcblx0XHRcdFx0XHRkaXNwbGF5VmFsdWUgPSB2O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiggdiAhPT0gdW5kZWZpbmVkICkge1xyXG5cdFx0XHRcdFx0aWYoaXJvdyA9PT0gMCApIHtcclxuXHRcdFx0XHRcdFx0Ly8gRmlyc3QgcmVjb3JkIGFsd2F5cyBzdGFydHMgYSBuZXcgZ3JvdXBcclxuXHRcdFx0XHRcdFx0Z3JwLmdyb3Vwcy5wdXNoKHtpZHg6aSxkYXRhSW5kZXg6ZmllbGROYW1lLHZhbHVlOnYsIGRpc3BsYXlWYWx1ZTogZGlzcGxheVZhbHVlLCBzdGFydFJvdzogaXJvdywgY250OjEsIHN1bW1hcnkgOiBbXSB9ICk7XHJcblx0XHRcdFx0XHRcdGdycC5sYXN0dmFsdWVzW2ldID0gdjtcclxuXHRcdFx0XHRcdFx0Z3JwLmNvdW50ZXJzW2ldID0ge2NudDoxLCBwb3M6Z3JwLmdyb3Vwcy5sZW5ndGgtMSwgc3VtbWFyeTogJC5leHRlbmQodHJ1ZSxbXSxncnAuc3VtbWFyeSl9O1xyXG5cdFx0XHRcdFx0XHQkLmVhY2goZ3JwLmNvdW50ZXJzW2ldLnN1bW1hcnksZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKCQuaXNGdW5jdGlvbih0aGlzLnN0KSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy52ID0gdGhpcy5zdC5jYWxsKCR0LCB0aGlzLnYsIHRoaXMubm0sIHJlY29yZCk7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMudiA9ICQoJHQpLmpxR3JpZCgnZ3JvdXBpbmdDYWxjdWxhdGlvbnMuaGFuZGxlcicsdGhpcy5zdCwgdGhpcy52LCB0aGlzLm5tLCB0aGlzLnNyLCB0aGlzLnNydCwgcmVjb3JkKTtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKHRoaXMuc3QudG9Mb3dlckNhc2UoKSA9PT0gJ2F2ZycgJiYgdGhpcy5zZCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnZkID0gJCgkdCkuanFHcmlkKCdncm91cGluZ0NhbGN1bGF0aW9ucy5oYW5kbGVyJyx0aGlzLnN0LCB0aGlzLnZkLCB0aGlzLnNkLCB0aGlzLnNyLCB0aGlzLnNydCwgcmVjb3JkKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRncnAuZ3JvdXBzW2dycC5jb3VudGVyc1tpXS5wb3NdLnN1bW1hcnkgPSBncnAuY291bnRlcnNbaV0uc3VtbWFyeTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdGlmICh0eXBlb2YgdiAhPT0gXCJvYmplY3RcIiAmJiAoJC5pc0FycmF5KGdycC5pc0luVGhlU2FtZUdyb3VwKSAmJiAkLmlzRnVuY3Rpb24oZ3JwLmlzSW5UaGVTYW1lR3JvdXBbaV0pID8gISBncnAuaXNJblRoZVNhbWVHcm91cFtpXS5jYWxsKCR0LCBncnAubGFzdHZhbHVlc1tpXSwgdiwgaSwgZ3JwKTogZ3JwLmxhc3R2YWx1ZXNbaV0gIT09IHYpKSB7XHJcblx0XHRcdFx0XHRcdFx0Ly8gVGhpcyByZWNvcmQgaXMgbm90IGluIHNhbWUgZ3JvdXAgYXMgcHJldmlvdXMgb25lXHJcblx0XHRcdFx0XHRcdFx0Z3JwLmdyb3Vwcy5wdXNoKHtpZHg6aSxkYXRhSW5kZXg6ZmllbGROYW1lLHZhbHVlOnYsIGRpc3BsYXlWYWx1ZTogZGlzcGxheVZhbHVlLCBzdGFydFJvdzogaXJvdywgY250OjEsIHN1bW1hcnkgOiBbXSB9ICk7XHJcblx0XHRcdFx0XHRcdFx0Z3JwLmxhc3R2YWx1ZXNbaV0gPSB2O1xyXG5cdFx0XHRcdFx0XHRcdGNoYW5nZWQgPSAxO1xyXG5cdFx0XHRcdFx0XHRcdGdycC5jb3VudGVyc1tpXSA9IHtjbnQ6MSwgcG9zOmdycC5ncm91cHMubGVuZ3RoLTEsIHN1bW1hcnk6ICQuZXh0ZW5kKHRydWUsW10sZ3JwLnN1bW1hcnkpfTtcclxuXHRcdFx0XHRcdFx0XHQkLmVhY2goZ3JwLmNvdW50ZXJzW2ldLnN1bW1hcnksZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRpZiAoJC5pc0Z1bmN0aW9uKHRoaXMuc3QpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMudiA9IHRoaXMuc3QuY2FsbCgkdCwgdGhpcy52LCB0aGlzLm5tLCByZWNvcmQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy52ID0gJCgkdCkuanFHcmlkKCdncm91cGluZ0NhbGN1bGF0aW9ucy5oYW5kbGVyJyx0aGlzLnN0LCB0aGlzLnYsIHRoaXMubm0sIHRoaXMuc3IsIHRoaXMuc3J0LCByZWNvcmQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZih0aGlzLnN0LnRvTG93ZXJDYXNlKCkgPT09ICdhdmcnICYmIHRoaXMuc2QpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnZkID0gJCgkdCkuanFHcmlkKCdncm91cGluZ0NhbGN1bGF0aW9ucy5oYW5kbGVyJyx0aGlzLnN0LCB0aGlzLnZkLCB0aGlzLnNkLCB0aGlzLnNyLCB0aGlzLnNydCwgcmVjb3JkKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdGdycC5ncm91cHNbZ3JwLmNvdW50ZXJzW2ldLnBvc10uc3VtbWFyeSA9IGdycC5jb3VudGVyc1tpXS5zdW1tYXJ5O1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdGlmIChjaGFuZ2VkID09PSAxKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBUaGlzIGdyb3VwIGhhcyBjaGFuZ2VkIGJlY2F1c2UgYW4gZWFybGllciBncm91cCBjaGFuZ2VkLlxyXG5cdFx0XHRcdFx0XHRcdFx0Z3JwLmdyb3Vwcy5wdXNoKHtpZHg6aSxkYXRhSW5kZXg6ZmllbGROYW1lLHZhbHVlOnYsIGRpc3BsYXlWYWx1ZTogZGlzcGxheVZhbHVlLCBzdGFydFJvdzogaXJvdywgY250OjEsIHN1bW1hcnkgOiBbXSB9ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRncnAubGFzdHZhbHVlc1tpXSA9IHY7XHJcblx0XHRcdFx0XHRcdFx0XHRncnAuY291bnRlcnNbaV0gPSB7Y250OjEsIHBvczpncnAuZ3JvdXBzLmxlbmd0aC0xLCBzdW1tYXJ5OiAkLmV4dGVuZCh0cnVlLFtdLGdycC5zdW1tYXJ5KX07XHJcblx0XHRcdFx0XHRcdFx0XHQkLmVhY2goZ3JwLmNvdW50ZXJzW2ldLnN1bW1hcnksZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmICgkLmlzRnVuY3Rpb24odGhpcy5zdCkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnYgPSB0aGlzLnN0LmNhbGwoJHQsIHRoaXMudiwgdGhpcy5ubSwgcmVjb3JkKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnYgPSAkKCR0KS5qcUdyaWQoJ2dyb3VwaW5nQ2FsY3VsYXRpb25zLmhhbmRsZXInLHRoaXMuc3QsIHRoaXMudiwgdGhpcy5ubSwgdGhpcy5zciwgdGhpcy5zcnQsIHJlY29yZCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYodGhpcy5zdC50b0xvd2VyQ2FzZSgpID09PSAnYXZnJyAmJiB0aGlzLnNkKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnZkID0gJCgkdCkuanFHcmlkKCdncm91cGluZ0NhbGN1bGF0aW9ucy5oYW5kbGVyJyx0aGlzLnN0LCB0aGlzLnZkLCB0aGlzLnNkLCB0aGlzLnNyLCB0aGlzLnNydCwgcmVjb3JkKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0Z3JwLmdyb3Vwc1tncnAuY291bnRlcnNbaV0ucG9zXS5zdW1tYXJ5ID0gZ3JwLmNvdW50ZXJzW2ldLnN1bW1hcnk7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdGdycC5jb3VudGVyc1tpXS5jbnQgKz0gMTtcclxuXHRcdFx0XHRcdFx0XHRcdGdycC5ncm91cHNbZ3JwLmNvdW50ZXJzW2ldLnBvc10uY250ID0gZ3JwLmNvdW50ZXJzW2ldLmNudDtcclxuXHRcdFx0XHRcdFx0XHRcdCQuZWFjaChncnAuY291bnRlcnNbaV0uc3VtbWFyeSxmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKCQuaXNGdW5jdGlvbih0aGlzLnN0KSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMudiA9IHRoaXMuc3QuY2FsbCgkdCwgdGhpcy52LCB0aGlzLm5tLCByZWNvcmQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMudiA9ICQoJHQpLmpxR3JpZCgnZ3JvdXBpbmdDYWxjdWxhdGlvbnMuaGFuZGxlcicsdGhpcy5zdCwgdGhpcy52LCB0aGlzLm5tLCB0aGlzLnNyLCB0aGlzLnNydCwgcmVjb3JkKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZih0aGlzLnN0LnRvTG93ZXJDYXNlKCkgPT09ICdhdmcnICYmIHRoaXMuc2QpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMudmQgPSAkKCR0KS5qcUdyaWQoJ2dyb3VwaW5nQ2FsY3VsYXRpb25zLmhhbmRsZXInLHRoaXMuc3QsIHRoaXMudmQsIHRoaXMuc2QsIHRoaXMuc3IsIHRoaXMuc3J0LCByZWNvcmQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRncnAuZ3JvdXBzW2dycC5jb3VudGVyc1tpXS5wb3NdLnN1bW1hcnkgPSBncnAuY291bnRlcnNbaV0uc3VtbWFyeTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0Ly9nZGF0YS5wdXNoKCByRGF0YSApO1xyXG5cdFx0fSk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cdGdyb3VwaW5nVG9nZ2xlIDogZnVuY3Rpb24oaGlkKXtcclxuXHRcdHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzLFxyXG5cdFx0XHRncnAgPSAkdC5wLmdyb3VwaW5nVmlldyxcclxuXHRcdFx0c3RycG9zID0gaGlkLnNwbGl0KCdfJyksXHJcblx0XHRcdG51bSA9IHBhcnNlSW50KHN0cnBvc1tzdHJwb3MubGVuZ3RoLTJdLCAxMCk7XHJcblx0XHRcdHN0cnBvcy5zcGxpY2Uoc3RycG9zLmxlbmd0aC0yLDIpO1xyXG5cdFx0XHR2YXIgdWlkID0gc3RycG9zLmpvaW4oXCJfXCIpLFxyXG5cdFx0XHRtaW51cyA9IGdycC5taW51c2ljb24sXHJcblx0XHRcdHBsdXMgPSBncnAucGx1c2ljb24sXHJcblx0XHRcdHRhciA9ICQoXCIjXCIrJC5qZ3JpZC5qcUlEKGhpZCkpLFxyXG5cdFx0XHRyID0gdGFyLmxlbmd0aCA/IHRhclswXS5uZXh0U2libGluZyA6IG51bGwsXHJcblx0XHRcdHRhcnNwYW4gPSAkKFwiI1wiKyQuamdyaWQuanFJRChoaWQpK1wiIHNwYW4uXCIrXCJ0cmVlLXdyYXAtXCIrJHQucC5kaXJlY3Rpb24pLFxyXG5cdFx0XHRnZXRHcm91cGluZ0xldmVsRnJvbUNsYXNzID0gZnVuY3Rpb24gKGNsYXNzTmFtZSkge1xyXG5cdFx0XHRcdHZhciBudW1zID0gJC5tYXAoY2xhc3NOYW1lLnNwbGl0KFwiIFwiKSwgZnVuY3Rpb24gKGl0ZW0pIHtcclxuXHRcdFx0XHRcdGlmIChpdGVtLnN1YnN0cmluZygwLCB1aWQubGVuZ3RoICsgMSkgPT09IHVpZCArIFwiX1wiKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiBwYXJzZUludChpdGVtLnN1YnN0cmluZyh1aWQubGVuZ3RoICsgMSksIDEwKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRyZXR1cm4gbnVtcy5sZW5ndGggPiAwID8gbnVtc1swXSA6IHVuZGVmaW5lZDtcclxuXHRcdFx0fSxcclxuXHRcdFx0aXRlbUdyb3VwaW5nTGV2ZWwsXHJcblx0XHRcdHNob3dEYXRhLFxyXG5cdFx0XHRjb2xsYXBzZWQgPSBmYWxzZSxcclxuXHRcdFx0ZnJ6ID0gJHQucC5mcm96ZW5Db2x1bW5zID8gJHQucC5pZCtcIl9mcm96ZW5cIiA6IGZhbHNlLFxyXG5cdFx0XHR0YXIyID0gZnJ6ID8gJChcIiNcIiskLmpncmlkLmpxSUQoaGlkKSwgXCIjXCIrJC5qZ3JpZC5qcUlEKGZyeikgKSA6IGZhbHNlLFxyXG5cdFx0XHRyMiA9ICh0YXIyICYmIHRhcjIubGVuZ3RoKSA/IHRhcjJbMF0ubmV4dFNpYmxpbmcgOiBudWxsO1xyXG5cdFx0XHRpZiggdGFyc3Bhbi5oYXNDbGFzcyhtaW51cykgKSB7XHJcblx0XHRcdFx0aWYoZ3JwLnNob3dTdW1tYXJ5T25IaWRlKSB7XHJcblx0XHRcdFx0XHRpZihyKXtcclxuXHRcdFx0XHRcdFx0d2hpbGUocikge1xyXG5cdFx0XHRcdFx0XHRcdGlmKCQocikuaGFzQ2xhc3MoJ2pxZm9vdCcpICkge1xyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIGx2ID0gcGFyc2VJbnQoJChyKS5hdHRyKFwianFmb290bGV2ZWxcIiksMTApO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYoICBsdiA8PSBudW0pIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdCQocikuaGlkZSgpO1xyXG5cdFx0XHRcdFx0XHRcdHIgPSByLm5leHRTaWJsaW5nO1xyXG5cdFx0XHRcdFx0XHRcdGlmKGZyeikge1xyXG5cdFx0XHRcdFx0XHRcdFx0JChyMikuaGlkZSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0cjIgPSByMi5uZXh0U2libGluZztcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGVsc2UgIHtcclxuXHRcdFx0XHRcdGlmKHIpe1xyXG5cdFx0XHRcdFx0XHR3aGlsZShyKSB7XHJcblx0XHRcdFx0XHRcdFx0aXRlbUdyb3VwaW5nTGV2ZWwgPSBnZXRHcm91cGluZ0xldmVsRnJvbUNsYXNzKHIuY2xhc3NOYW1lKTtcclxuXHRcdFx0XHRcdFx0XHRpZiAoaXRlbUdyb3VwaW5nTGV2ZWwgIT09IHVuZGVmaW5lZCAmJiBpdGVtR3JvdXBpbmdMZXZlbCA8PSBudW0pIHtcclxuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHQkKHIpLmhpZGUoKTtcclxuXHRcdFx0XHRcdFx0XHRyID0gci5uZXh0U2libGluZztcclxuXHRcdFx0XHRcdFx0XHRpZihmcnopIHtcclxuXHRcdFx0XHRcdFx0XHRcdCQocjIpLmhpZGUoKTtcclxuXHRcdFx0XHRcdFx0XHRcdHIyID0gcjIubmV4dFNpYmxpbmc7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHRhcnNwYW4ucmVtb3ZlQ2xhc3MobWludXMpLmFkZENsYXNzKHBsdXMpO1xyXG5cdFx0XHRcdGNvbGxhcHNlZCA9IHRydWU7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0aWYocil7XHJcblx0XHRcdFx0XHRzaG93RGF0YSA9IHVuZGVmaW5lZDtcclxuXHRcdFx0XHRcdHdoaWxlKHIpIHtcclxuXHRcdFx0XHRcdFx0aXRlbUdyb3VwaW5nTGV2ZWwgPSBnZXRHcm91cGluZ0xldmVsRnJvbUNsYXNzKHIuY2xhc3NOYW1lKTtcclxuXHRcdFx0XHRcdFx0aWYgKHNob3dEYXRhID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdFx0XHRzaG93RGF0YSA9IGl0ZW1Hcm91cGluZ0xldmVsID09PSB1bmRlZmluZWQ7IC8vIGlmIHRoZSBmaXJzdCByb3cgYWZ0ZXIgdGhlIG9wZW5pbmcgZ3JvdXAgaXMgZGF0YSByb3cgdGhlbiBzaG93IHRoZSBkYXRhIHJvd3NcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZiAoaXRlbUdyb3VwaW5nTGV2ZWwgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0XHRcdGlmIChpdGVtR3JvdXBpbmdMZXZlbCA8PSBudW0pIHtcclxuXHRcdFx0XHRcdFx0XHRcdGJyZWFrOy8vIG5leHQgaXRlbSBvZiB0aGUgc2FtZSBsZXZlciBhcmUgZm91bmRcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0aWYgKGl0ZW1Hcm91cGluZ0xldmVsID09PSBudW0gKyAxKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHIpLnNob3coKS5maW5kKFwiPnRkPnNwYW4uXCIrXCJ0cmVlLXdyYXAtXCIrJHQucC5kaXJlY3Rpb24pLnJlbW92ZUNsYXNzKG1pbnVzKS5hZGRDbGFzcyhwbHVzKTtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKGZyeikge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkKHIyKS5zaG93KCkuZmluZChcIj50ZD5zcGFuLlwiK1widHJlZS13cmFwLVwiKyR0LnAuZGlyZWN0aW9uKS5yZW1vdmVDbGFzcyhtaW51cykuYWRkQ2xhc3MocGx1cyk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKHNob3dEYXRhKSB7XHJcblx0XHRcdFx0XHRcdFx0JChyKS5zaG93KCk7XHJcblx0XHRcdFx0XHRcdFx0aWYoZnJ6KSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHIyKS5zaG93KCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHIgPSByLm5leHRTaWJsaW5nO1xyXG5cdFx0XHRcdFx0XHRpZihmcnopIHtcclxuXHRcdFx0XHRcdFx0XHRyMiA9IHIyLm5leHRTaWJsaW5nO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHRhcnNwYW4ucmVtb3ZlQ2xhc3MocGx1cykuYWRkQ2xhc3MobWludXMpO1xyXG5cdFx0XHR9XHJcblx0XHRcdCQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkR3JvdXBpbmdDbGlja0dyb3VwXCIsIFtoaWQgLCBjb2xsYXBzZWRdKTtcclxuXHRcdFx0aWYoICQuaXNGdW5jdGlvbigkdC5wLm9uQ2xpY2tHcm91cCkpIHsgJHQucC5vbkNsaWNrR3JvdXAuY2FsbCgkdCwgaGlkICwgY29sbGFwc2VkKTsgfVxyXG5cclxuXHRcdH0pO1xyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH0sXHJcblx0Z3JvdXBpbmdSZW5kZXIgOiBmdW5jdGlvbiAoZ3JkYXRhLCBjb2xzcGFucywgcGFnZSwgcm4gKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdHZhciAkdCA9IHRoaXMsXHJcblx0XHRcdGdycCA9ICR0LnAuZ3JvdXBpbmdWaWV3LFxyXG5cdFx0XHRzdHIgPSBcIlwiLCBpY29uID0gXCJcIiwgaGlkLCBjbGlkLCBwbXJ0bCA9IGdycC5ncm91cENvbGxhcHNlID8gZ3JwLnBsdXNpY29uIDogZ3JwLm1pbnVzaWNvbiwgZ3YsIGNwPVtdLCBsZW4gPWdycC5ncm91cEZpZWxkLmxlbmd0aDtcclxuXHRcdFx0cG1ydGwgKz0gXCIgdHJlZS13cmFwLVwiKyR0LnAuZGlyZWN0aW9uO1xyXG5cdFx0XHQkLmVhY2goJHQucC5jb2xNb2RlbCwgZnVuY3Rpb24gKGksbil7XHJcblx0XHRcdFx0dmFyIGlpO1xyXG5cdFx0XHRcdGZvcihpaT0wO2lpPGxlbjtpaSsrKSB7XHJcblx0XHRcdFx0XHRpZihncnAuZ3JvdXBGaWVsZFtpaV0gPT09IG4ubmFtZSApIHtcclxuXHRcdFx0XHRcdFx0Y3BbaWldID0gaTtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0dmFyIHRvRW5kID0gMDtcclxuXHRcdFx0ZnVuY3Rpb24gZmluZEdyb3VwSWR4KCBpbmQgLCBvZmZzZXQsIGdycCkge1xyXG5cdFx0XHRcdHZhciByZXQgPSBmYWxzZSwgaTtcclxuXHRcdFx0XHRpZihvZmZzZXQ9PT0wKSB7XHJcblx0XHRcdFx0XHRyZXQgPSBncnBbaW5kXTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0dmFyIGlkID0gZ3JwW2luZF0uaWR4O1xyXG5cdFx0XHRcdFx0aWYoaWQ9PT0wKSB7XHJcblx0XHRcdFx0XHRcdHJldCA9IGdycFtpbmRdO1xyXG5cdFx0XHRcdFx0fSAgZWxzZSB7XHJcblx0XHRcdFx0XHRcdGZvcihpPWluZDtpID49IDA7IGktLSkge1xyXG5cdFx0XHRcdFx0XHRcdGlmKGdycFtpXS5pZHggPT09IGlkLW9mZnNldCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0cmV0ID0gZ3JwW2ldO1xyXG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiByZXQ7XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gYnVpbGRTdW1tYXJ5VGQoaSwgaWssIGdycCwgZm9mZnNldCkge1xyXG5cdFx0XHRcdHZhciBmZGF0YSA9IGZpbmRHcm91cElkeChpLCBpaywgZ3JwKSxcclxuXHRcdFx0XHRjbSA9ICR0LnAuY29sTW9kZWwsXHJcblx0XHRcdFx0dnYsIGdybGVuID0gZmRhdGEuY250LCBzdHI9XCJcIiwgaztcclxuXHRcdFx0XHRmb3Ioaz1mb2Zmc2V0OyBrPGNvbHNwYW5zO2srKykge1xyXG5cdFx0XHRcdFx0dmFyIHRtcGRhdGEgPSBcIjx0ZCBcIiskdC5mb3JtYXRDb2woaywxLCcnKStcIj4mIzE2MDs8L3RkPlwiLFxyXG5cdFx0XHRcdFx0dHBsZmxkID0gXCJ7MH1cIjtcclxuXHRcdFx0XHRcdCQuZWFjaChmZGF0YS5zdW1tYXJ5LGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRcdGlmKHRoaXMubm0gPT09IGNtW2tdLm5hbWUpIHtcclxuXHRcdFx0XHRcdFx0XHRpZihjbVtrXS5zdW1tYXJ5VHBsKSAge1xyXG5cdFx0XHRcdFx0XHRcdFx0dHBsZmxkID0gY21ba10uc3VtbWFyeVRwbDtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0aWYodHlwZW9mIHRoaXMuc3QgPT09ICdzdHJpbmcnICYmIHRoaXMuc3QudG9Mb3dlckNhc2UoKSA9PT0gJ2F2ZycpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKHRoaXMuc2QgJiYgdGhpcy52ZCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnYgPSAodGhpcy52L3RoaXMudmQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmKHRoaXMudiAmJiBncmxlbiA+IDApIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy52ID0gKHRoaXMudi9ncmxlbik7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmdyb3VwQ291bnQgPSBmZGF0YS5jbnQ7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmdyb3VwSW5kZXggPSBmZGF0YS5kYXRhSW5kZXg7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmdyb3VwVmFsdWUgPSBmZGF0YS52YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdHZ2ID0gJHQuZm9ybWF0dGVyKCcnLCB0aGlzLnYsIGssIHRoaXMpO1xyXG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGVmKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR2diA9IHRoaXMudjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0dG1wZGF0YT0gXCI8dGQgXCIrJHQuZm9ybWF0Q29sKGssMSwnJykrXCI+XCIrJC5qZ3JpZC5mb3JtYXQodHBsZmxkLHZ2KSsgXCI8L3RkPlwiO1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRzdHIgKz0gdG1wZGF0YTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIHN0cjtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgc3VtcmV2ZXJzZSA9ICQubWFrZUFycmF5KGdycC5ncm91cFN1bW1hcnkpO1xyXG5cdFx0XHRzdW1yZXZlcnNlLnJldmVyc2UoKTtcclxuXHRcdFx0JC5lYWNoKGdycC5ncm91cHMsZnVuY3Rpb24oaSxuKXtcclxuXHRcdFx0XHRpZihncnAuX2xvY2dyKSB7XHJcblx0XHRcdFx0XHRpZiggIShuLnN0YXJ0Um93ICtuLmNudCA+IChwYWdlLTEpKnJuICYmIG4uc3RhcnRSb3cgPCBwYWdlKnJuKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dG9FbmQrKztcclxuXHRcdFx0XHRjbGlkID0gJHQucC5pZCtcImdoZWFkX1wiK24uaWR4O1xyXG5cdFx0XHRcdGhpZCA9IGNsaWQrXCJfXCIraTtcclxuXHRcdFx0XHRpY29uID0gXCI8c3BhbiBzdHlsZT0nY3Vyc29yOnBvaW50ZXI7JyBjbGFzcz0ndWktaWNvbiBcIitwbXJ0bCtcIicgb25jbGljaz1cXFwialF1ZXJ5KCcjXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpK1wiJykuanFHcmlkKCdncm91cGluZ1RvZ2dsZScsJ1wiK2hpZCtcIicpO3JldHVybiBmYWxzZTtcXFwiPjwvc3Bhbj5cIjtcclxuXHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0aWYgKCQuaXNBcnJheShncnAuZm9ybWF0RGlzcGxheUZpZWxkKSAmJiAkLmlzRnVuY3Rpb24oZ3JwLmZvcm1hdERpc3BsYXlGaWVsZFtuLmlkeF0pKSB7XHJcblx0XHRcdFx0XHRcdG4uZGlzcGxheVZhbHVlID0gZ3JwLmZvcm1hdERpc3BsYXlGaWVsZFtuLmlkeF0uY2FsbCgkdCwgbi5kaXNwbGF5VmFsdWUsIG4udmFsdWUsICR0LnAuY29sTW9kZWxbY3Bbbi5pZHhdXSwgbi5pZHgsIGdycCk7XHJcblx0XHRcdFx0XHRcdGd2ID0gbi5kaXNwbGF5VmFsdWU7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRndiA9ICR0LmZvcm1hdHRlcihoaWQsIG4uZGlzcGxheVZhbHVlLCBjcFtuLmlkeF0sIG4udmFsdWUgKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGNhdGNoIChlZ3YpIHtcclxuXHRcdFx0XHRcdGd2ID0gbi5kaXNwbGF5VmFsdWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKGdycC5ncm91cFN1bW1hcnlQb3Nbbi5pZHhdID09PSAnaGVhZGVyJykgIHtcclxuXHRcdFx0XHRcdHN0ciArPSBcIjx0ciBpZD1cXFwiXCIraGlkK1wiXFxcIlwiICsoZ3JwLmdyb3VwQ29sbGFwc2UgJiYgbi5pZHg+MCA/IFwiIHN0eWxlPVxcXCJkaXNwbGF5Om5vbmU7XFxcIiBcIiA6IFwiIFwiKSArIFwicm9sZT1cXFwicm93XFxcIiBjbGFzcz0gXFxcInVpLXdpZGdldC1jb250ZW50IGpxZ3JvdXAgdWktcm93LVwiKyR0LnAuZGlyZWN0aW9uK1wiIFwiK2NsaWQrXCJcXFwiPjx0ZCBzdHlsZT1cXFwicGFkZGluZy1sZWZ0OlwiKyhuLmlkeCAqIDEyKSArIFwicHg7XCIrXCJcXFwiPlwiK2ljb24rJC5qZ3JpZC50ZW1wbGF0ZShncnAuZ3JvdXBUZXh0W24uaWR4XSwgZ3YsIG4uY250LCBuLnN1bW1hcnkpK1wiPC90ZD5cIjtcclxuXHRcdFx0XHRcdHN0ciArPSBidWlsZFN1bW1hcnlUZChpLCBuLmlkeC0xLCBncnAuZ3JvdXBzLCAxKTtcclxuXHRcdFx0XHRcdHN0ciArPSBcIjwvdHI+XCI7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHN0ciArPSBcIjx0ciBpZD1cXFwiXCIraGlkK1wiXFxcIlwiICsoZ3JwLmdyb3VwQ29sbGFwc2UgJiYgbi5pZHg+MCA/IFwiIHN0eWxlPVxcXCJkaXNwbGF5Om5vbmU7XFxcIiBcIiA6IFwiIFwiKSArIFwicm9sZT1cXFwicm93XFxcIiBjbGFzcz0gXFxcInVpLXdpZGdldC1jb250ZW50IGpxZ3JvdXAgdWktcm93LVwiKyR0LnAuZGlyZWN0aW9uK1wiIFwiK2NsaWQrXCJcXFwiPjx0ZCBzdHlsZT1cXFwicGFkZGluZy1sZWZ0OlwiKyhuLmlkeCAqIDEyKSArIFwicHg7XCIrXCJcXFwiIGNvbHNwYW49XFxcIlwiK2NvbHNwYW5zK1wiXFxcIj5cIitpY29uKyQuamdyaWQudGVtcGxhdGUoZ3JwLmdyb3VwVGV4dFtuLmlkeF0sIGd2LCBuLmNudCwgbi5zdW1tYXJ5KStcIjwvdGQ+PC90cj5cIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIGxlYWYgPSBsZW4tMSA9PT0gbi5pZHg7XHJcblx0XHRcdFx0aWYoIGxlYWYgKSB7XHJcblx0XHRcdFx0XHR2YXIgZ2cgPSBncnAuZ3JvdXBzW2krMV0sIGtrLCBpaywgb2Zmc2V0ID0gMCwgc2dyID0gbi5zdGFydFJvdyxcclxuXHRcdFx0XHRcdGVuZCA9IGdnICE9PSB1bmRlZmluZWQgPyAgZ3JwLmdyb3Vwc1tpKzFdLnN0YXJ0Um93IDogZ3JkYXRhLmxlbmd0aDtcclxuXHRcdFx0XHRcdGlmKGdycC5fbG9jZ3IpIHtcclxuXHRcdFx0XHRcdFx0b2Zmc2V0ID0gKHBhZ2UtMSkqcm47XHJcblx0XHRcdFx0XHRcdGlmKG9mZnNldCA+IG4uc3RhcnRSb3cpIHtcclxuXHRcdFx0XHRcdFx0XHRzZ3IgPSBvZmZzZXQ7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGZvcihraz1zZ3I7a2s8ZW5kO2trKyspIHtcclxuXHRcdFx0XHRcdFx0aWYoIWdyZGF0YVtrayAtIG9mZnNldF0pIHsgYnJlYWs7IH1cclxuXHRcdFx0XHRcdFx0c3RyICs9IGdyZGF0YVtrayAtIG9mZnNldF0uam9pbignJyk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZihncnAuZ3JvdXBTdW1tYXJ5UG9zW24uaWR4XSAhPT0gJ2hlYWRlcicpIHtcclxuXHRcdFx0XHRcdFx0dmFyIGpqO1xyXG5cdFx0XHRcdFx0XHRpZiAoZ2cgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0XHRcdGZvciAoamogPSAwOyBqaiA8IGdycC5ncm91cEZpZWxkLmxlbmd0aDsgamorKykge1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGdnLmRhdGFJbmRleCA9PT0gZ3JwLmdyb3VwRmllbGRbampdKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR0b0VuZCA9IGdycC5ncm91cEZpZWxkLmxlbmd0aCAtIGpqO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGZvciAoaWsgPSAwOyBpayA8IHRvRW5kOyBpaysrKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYoIXN1bXJldmVyc2VbaWtdKSB7IGNvbnRpbnVlOyB9XHJcblx0XHRcdFx0XHRcdFx0dmFyIGhoZHIgPSBcIlwiO1xyXG5cdFx0XHRcdFx0XHRcdGlmKGdycC5ncm91cENvbGxhcHNlICYmICFncnAuc2hvd1N1bW1hcnlPbkhpZGUpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGhoZHIgPSBcIiBzdHlsZT1cXFwiZGlzcGxheTpub25lO1xcXCJcIjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0c3RyICs9IFwiPHRyXCIraGhkcitcIiBqcWZvb3RsZXZlbD1cXFwiXCIrKG4uaWR4LWlrKStcIlxcXCIgcm9sZT1cXFwicm93XFxcIiBjbGFzcz1cXFwidWktd2lkZ2V0LWNvbnRlbnQganFmb290IHVpLXJvdy1cIiskdC5wLmRpcmVjdGlvbitcIlxcXCI+XCI7XHJcblx0XHRcdFx0XHRcdFx0c3RyICs9IGJ1aWxkU3VtbWFyeVRkKGksIGlrLCBncnAuZ3JvdXBzLCAwKTtcclxuXHRcdFx0XHRcdFx0XHRzdHIgKz0gXCI8L3RyPlwiO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHRvRW5kID0gamo7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0JChcIiNcIiskLmpncmlkLmpxSUQoJHQucC5pZCkrXCIgdGJvZHk6Zmlyc3RcIikuYXBwZW5kKHN0cik7XHJcblx0XHRcdC8vIGZyZWUgdXAgbWVtb3J5XHJcblx0XHRcdHN0ciA9IG51bGw7XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdGdyb3VwaW5nR3JvdXBCeSA6IGZ1bmN0aW9uIChuYW1lLCBvcHRpb25zICkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzO1xyXG5cdFx0XHRpZih0eXBlb2YgbmFtZSA9PT0gXCJzdHJpbmdcIikge1xyXG5cdFx0XHRcdG5hbWUgPSBbbmFtZV07XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIGdycCA9ICR0LnAuZ3JvdXBpbmdWaWV3O1xyXG5cdFx0XHQkdC5wLmdyb3VwaW5nID0gdHJ1ZTtcclxuXHJcblx0XHRcdC8vU2V0IGRlZmF1bHQsIGluIGNhc2UgdmlzaWJpbGl0eU9uTmV4dEdyb3VwaW5nIGlzIHVuZGVmaW5lZFxyXG5cdFx0XHRpZiAoZ3JwLnZpc2liaWx0eU9uTmV4dEdyb3VwaW5nID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRncnAudmlzaWJpbHR5T25OZXh0R3JvdXBpbmcgPSBbXTtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgaTtcclxuXHRcdFx0Ly8gc2hvdyBwcmV2aW91cyBoaWRkZW4gZ3JvdXBzIGlmIHRoZXkgYXJlIGhpZGRlbiBhbmQgd2VyZW4ndCByZW1vdmVkIHlldFxyXG5cdFx0XHRmb3IoaT0wO2k8Z3JwLmdyb3VwRmllbGQubGVuZ3RoO2krKykge1xyXG5cdFx0XHRcdGlmKCFncnAuZ3JvdXBDb2x1bW5TaG93W2ldICYmIGdycC52aXNpYmlsdHlPbk5leHRHcm91cGluZ1tpXSkge1xyXG5cdFx0XHRcdCQoJHQpLmpxR3JpZCgnc2hvd0NvbCcsZ3JwLmdyb3VwRmllbGRbaV0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBzZXQgdmlzaWJpbGl0eSBzdGF0dXMgb2YgY3VycmVudCBncm91cCBjb2x1bW5zIG9uIG5leHQgZ3JvdXBpbmdcclxuXHRcdFx0Zm9yKGk9MDtpPG5hbWUubGVuZ3RoO2krKykge1xyXG5cdFx0XHRcdGdycC52aXNpYmlsdHlPbk5leHRHcm91cGluZ1tpXSA9ICQoXCIjXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpK1wiX1wiKyQuamdyaWQuanFJRChuYW1lW2ldKSkuaXMoXCI6dmlzaWJsZVwiKTtcclxuXHRcdFx0fVxyXG5cdFx0XHQkdC5wLmdyb3VwaW5nVmlldyA9ICQuZXh0ZW5kKCR0LnAuZ3JvdXBpbmdWaWV3LCBvcHRpb25zIHx8IHt9KTtcclxuXHRcdFx0Z3JwLmdyb3VwRmllbGQgPSBuYW1lO1xyXG5cdFx0XHQkKCR0KS50cmlnZ2VyKFwicmVsb2FkR3JpZFwiKTtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0Z3JvdXBpbmdSZW1vdmUgOiBmdW5jdGlvbiAoY3VycmVudCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzO1xyXG5cdFx0XHRpZihjdXJyZW50ID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRjdXJyZW50ID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHQkdC5wLmdyb3VwaW5nID0gZmFsc2U7XHJcblx0XHRcdGlmKGN1cnJlbnQ9PT10cnVlKSB7XHJcblx0XHRcdFx0dmFyIGdycCA9ICR0LnAuZ3JvdXBpbmdWaWV3LCBpO1xyXG5cdFx0XHRcdC8vIHNob3cgcHJldmlvdXMgaGlkZGVuIGdyb3VwcyBpZiB0aGV5IGFyZSBoaWRkZW4gYW5kIHdlcmVuJ3QgcmVtb3ZlZCB5ZXRcclxuXHRcdFx0XHRmb3IoaT0wO2k8Z3JwLmdyb3VwRmllbGQubGVuZ3RoO2krKykge1xyXG5cdFx0XHRcdGlmICghZ3JwLmdyb3VwQ29sdW1uU2hvd1tpXSAmJiBncnAudmlzaWJpbHR5T25OZXh0R3JvdXBpbmdbaV0pIHtcclxuXHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKCdzaG93Q29sJywgZ3JwLmdyb3VwRmllbGQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQkKFwidHIuanFncm91cCwgdHIuanFmb290XCIsXCIjXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpK1wiIHRib2R5OmZpcnN0XCIpLnJlbW92ZSgpO1xyXG5cdFx0XHRcdCQoXCJ0ci5qcWdyb3c6aGlkZGVuXCIsXCIjXCIrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpK1wiIHRib2R5OmZpcnN0XCIpLnNob3coKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQkKCR0KS50cmlnZ2VyKFwicmVsb2FkR3JpZFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRncm91cGluZ0NhbGN1bGF0aW9ucyA6IHtcclxuXHRcdGhhbmRsZXI6IGZ1bmN0aW9uKGZuLCB2LCBmaWVsZCwgcm91bmQsIHJvdW5kVHlwZSwgcmMpIHtcclxuXHRcdFx0dmFyIGZ1bmNzID0ge1xyXG5cdFx0XHRcdHN1bTogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gcGFyc2VGbG9hdCh2fHwwKSArIHBhcnNlRmxvYXQoKHJjW2ZpZWxkXXx8MCkpO1xyXG5cdFx0XHRcdH0sXHJcblxyXG5cdFx0XHRcdG1pbjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRpZih2PT09XCJcIikge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gcGFyc2VGbG9hdChyY1tmaWVsZF18fDApO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0cmV0dXJuIE1hdGgubWluKHBhcnNlRmxvYXQodikscGFyc2VGbG9hdChyY1tmaWVsZF18fDApKTtcclxuXHRcdFx0XHR9LFxyXG5cclxuXHRcdFx0XHRtYXg6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0aWYodj09PVwiXCIpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIHBhcnNlRmxvYXQocmNbZmllbGRdfHwwKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJldHVybiBNYXRoLm1heChwYXJzZUZsb2F0KHYpLHBhcnNlRmxvYXQocmNbZmllbGRdfHwwKSk7XHJcblx0XHRcdFx0fSxcclxuXHJcblx0XHRcdFx0Y291bnQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0aWYodj09PVwiXCIpIHt2PTA7fVxyXG5cdFx0XHRcdFx0aWYocmMuaGFzT3duUHJvcGVydHkoZmllbGQpKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiB2KzE7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZXR1cm4gMDtcclxuXHRcdFx0XHR9LFxyXG5cclxuXHRcdFx0XHRhdmc6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gdGhlIHNhbWUgYXMgc3VtLCBidXQgYXQgZW5kIHdlIGRpdmlkZSBpdFxyXG5cdFx0XHRcdFx0Ly8gc28gdXNlIHN1bSBpbnN0ZWFkIG9mIGR1cGxpY2F0aW5nIHRoZSBjb2RlICg/KVxyXG5cdFx0XHRcdFx0cmV0dXJuIGZ1bmNzLnN1bSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdGlmKCFmdW5jc1tmbl0pIHtcclxuXHRcdFx0XHR0aHJvdyAoXCJqcUdyaWQgR3JvdXBpbmcgTm8gc3VjaCBtZXRob2Q6IFwiICsgZm4pO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciByZXMgPSBmdW5jc1tmbl0oKTtcclxuXHJcblx0XHRcdGlmIChyb3VuZCAhPSBudWxsKSB7XHJcblx0XHRcdFx0aWYgKHJvdW5kVHlwZSA9PT0gJ2ZpeGVkJykge1xyXG5cdFx0XHRcdFx0cmVzID0gcmVzLnRvRml4ZWQocm91bmQpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR2YXIgbXVsID0gTWF0aC5wb3coMTAsIHJvdW5kKTtcclxuXHRcdFx0XHRcdHJlcyA9IE1hdGgucm91bmQocmVzICogbXVsKSAvIG11bDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHJldHVybiByZXM7XHJcblx0XHR9XHJcblx0fVxyXG59KTtcclxufSkoalF1ZXJ5KTtcclxuLypqc2hpbnQgZXFlcWVxOmZhbHNlLCBlcW51bGw6dHJ1ZSwgZGV2ZWw6dHJ1ZSAqL1xyXG4vKmdsb2JhbCBqUXVlcnksIHhtbEpzb25DbGFzcyAqL1xyXG4oZnVuY3Rpb24oJCl7XHJcbi8qXHJcbiAqIGpxR3JpZCBleHRlbnNpb24gZm9yIGNvbnN0cnVjdGluZyBHcmlkIERhdGEgZnJvbSBleHRlcm5hbCBmaWxlXHJcbiAqIFRvbnkgVG9tb3YgdG9ueUB0cmlyYW5kLmNvbVxyXG4gKiBodHRwOi8vdHJpcmFuZC5jb20vYmxvZy9cclxuICogRHVhbCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGFuZCBHUEwgbGljZW5zZXM6XHJcbiAqIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXHJcbiAqIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMi4wLmh0bWxcclxuKiovXHJcblxyXG5cInVzZSBzdHJpY3RcIjtcclxuICAgICQuamdyaWQuZXh0ZW5kKHtcclxuICAgICAgICBqcUdyaWRJbXBvcnQgOiBmdW5jdGlvbihvKSB7XHJcbiAgICAgICAgICAgIG8gPSAkLmV4dGVuZCh7XHJcbiAgICAgICAgICAgICAgICBpbXB0eXBlIDogXCJ4bWxcIiwgLy8geG1sLCBqc29uLCB4bWxzdHJpbmcsIGpzb25zdHJpbmdcclxuICAgICAgICAgICAgICAgIGltcHN0cmluZzogXCJcIixcclxuICAgICAgICAgICAgICAgIGltcHVybDogXCJcIixcclxuICAgICAgICAgICAgICAgIG10eXBlOiBcIkdFVFwiLFxyXG4gICAgICAgICAgICAgICAgaW1wRGF0YSA6IHt9LFxyXG4gICAgICAgICAgICAgICAgeG1sR3JpZCA6e1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZyA6IFwicm9vdHM+Z3JpZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IFwicm9vdHM+cm93c1wiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAganNvbkdyaWQgOntcclxuICAgICAgICAgICAgICAgICAgICBjb25maWcgOiBcImdyaWRcIixcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBcImRhdGFcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGFqYXhPcHRpb25zIDp7fVxyXG4gICAgICAgICAgICB9LCBvIHx8IHt9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgdmFyICR0ID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHZhciB4bWxDb252ZXJ0ID0gZnVuY3Rpb24gKHhtbCxvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNuZmcgPSAkKG8ueG1sR3JpZC5jb25maWcseG1sKVswXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgeG1sZGF0YSA9ICQoby54bWxHcmlkLmRhdGEseG1sKVswXSwganN0ciwganN0cjEsIGtleTtcclxuICAgICAgICAgICAgICAgICAgICBpZih4bWxKc29uQ2xhc3MueG1sMmpzb24gJiYgJC5qZ3JpZC5wYXJzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBqc3RyID0geG1sSnNvbkNsYXNzLnhtbDJqc29uKGNuZmcsXCIgXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBqc3RyID0gJC5qZ3JpZC5wYXJzZShqc3RyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGtleSBpbiBqc3RyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihqc3RyLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc3RyMT1qc3RyW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzYXZlIHRoZSBkYXRhdHlwZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN2ZGF0YXR5cGUgPSBqc3RyLmdyaWQuZGF0YXR5cGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc3RyLmdyaWQuZGF0YXR5cGUgPSAneG1sc3RyaW5nJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzdHIuZ3JpZC5kYXRhc3RyID0geG1sO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgkdCkuanFHcmlkKCBqc3RyMSApLmpxR3JpZChcInNldEdyaWRQYXJhbVwiLHtkYXRhdHlwZTpzdmRhdGF0eXBlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCR0KS5qcUdyaWQoIGpzdHIxICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAganN0ciA9IG51bGw7anN0cjE9bnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydChcInhtbDJqc29uIG9yIHBhcnNlIGFyZSBub3QgcHJlc2VudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdmFyIGpzb25Db252ZXJ0ID0gZnVuY3Rpb24gKGpzb25zdHIsbyl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGpzb25zdHIgJiYgdHlwZW9mIGpzb25zdHIgPT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0XHRcdHZhciBfanNvbnBhcnNlID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdGlmKCQuamdyaWQudXNlSlNPTikge1xyXG5cdFx0XHRcdFx0XHRcdCQuamdyaWQudXNlSlNPTiA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRcdF9qc29ucGFyc2UgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqc29uID0gJC5qZ3JpZC5wYXJzZShqc29uc3RyKTtcclxuXHRcdFx0XHRcdFx0aWYoX2pzb25wYXJzZSkgeyAkLmpncmlkLnVzZUpTT04gPSB0cnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncHJtID0ganNvbltvLmpzb25HcmlkLmNvbmZpZ107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqZGF0YSA9IGpzb25bby5qc29uR3JpZC5kYXRhXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoamRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdmRhdGF0eXBlID0gZ3BybS5kYXRhdHlwZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdwcm0uZGF0YXR5cGUgPSAnanNvbnN0cmluZyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncHJtLmRhdGFzdHIgPSBqZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJHQpLmpxR3JpZCggZ3BybSApLmpxR3JpZChcInNldEdyaWRQYXJhbVwiLHtkYXRhdHlwZTpzdmRhdGF0eXBlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCR0KS5qcUdyaWQoIGdwcm0gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG8uaW1wdHlwZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAneG1sJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgJC5hamF4KCQuZXh0ZW5kKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDpvLmltcHVybCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6by5tdHlwZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IG8uaW1wRGF0YSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOlwieG1sXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24oeG1sLHN0YXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzdGF0ID09PSAnc3VjY2VzcycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeG1sQ29udmVydCh4bWwucmVzcG9uc2VYTUwsbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJHQpLnRyaWdnZXJIYW5kbGVyKFwianFHcmlkSW1wb3J0Q29tcGxldGVcIiwgW3htbCwgb10pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkLmlzRnVuY3Rpb24oby5pbXBvcnRDb21wbGV0ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uaW1wb3J0Q29tcGxldGUoeG1sKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4bWw9bnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgby5hamF4T3B0aW9ucykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICd4bWxzdHJpbmcnIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgbmVlZCB0byBtYWtlIGp1c3QgdGhlIGNvbnZlcnNpb24gYW5kIHVzZSB0aGUgc2FtZSBjb2RlIGFzIHhtbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihvLmltcHN0cmluZyAmJiB0eXBlb2Ygby5pbXBzdHJpbmcgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeG1sZCA9ICQucGFyc2VYTUwoby5pbXBzdHJpbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhtbENvbnZlcnQoeG1sZCxvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEltcG9ydENvbXBsZXRlXCIsIFt4bWxkLCBvXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJC5pc0Z1bmN0aW9uKG8uaW1wb3J0Q29tcGxldGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uaW1wb3J0Q29tcGxldGUoeG1sZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uaW1wc3RyaW5nID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhtbGQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2pzb24nOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkLmFqYXgoJC5leHRlbmQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOm8uaW1wdXJsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTpvLm10eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogby5pbXBEYXRhLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6XCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24oanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb25Db252ZXJ0KGpzb24ucmVzcG9uc2VUZXh0LG8gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgkdCkudHJpZ2dlckhhbmRsZXIoXCJqcUdyaWRJbXBvcnRDb21wbGV0ZVwiLCBbanNvbiwgb10pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkLmlzRnVuY3Rpb24oby5pbXBvcnRDb21wbGV0ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uaW1wb3J0Q29tcGxldGUoanNvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlZSl7fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb249bnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgby5hamF4T3B0aW9ucyApKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnanNvbnN0cmluZycgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihvLmltcHN0cmluZyAmJiB0eXBlb2Ygby5pbXBzdHJpbmcgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uQ29udmVydChvLmltcHN0cmluZyxvICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCR0KS50cmlnZ2VySGFuZGxlcihcImpxR3JpZEltcG9ydENvbXBsZXRlXCIsIFtvLmltcHN0cmluZywgb10pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJC5pc0Z1bmN0aW9uKG8uaW1wb3J0Q29tcGxldGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5pbXBvcnRDb21wbGV0ZShvLmltcHN0cmluZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLmltcHN0cmluZyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAganFHcmlkRXhwb3J0IDogZnVuY3Rpb24obykge1xyXG4gICAgICAgICAgICBvID0gJC5leHRlbmQoe1xyXG4gICAgICAgICAgICAgICAgZXhwdHlwZSA6IFwieG1sc3RyaW5nXCIsXHJcbiAgICAgICAgICAgICAgICByb290OiBcImdyaWRcIixcclxuICAgICAgICAgICAgICAgIGlkZW50OiBcIlxcdFwiXHJcbiAgICAgICAgICAgIH0sIG8gfHwge30pO1xyXG4gICAgICAgICAgICB2YXIgcmV0ID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmKCF0aGlzLmdyaWQpIHsgcmV0dXJuO31cclxuICAgICAgICAgICAgICAgIHZhciBrZXksIGdwcm0gPSAkLmV4dGVuZCh0cnVlLCB7fSwkKHRoaXMpLmpxR3JpZChcImdldEdyaWRQYXJhbVwiKSk7XHJcbiAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGNoZWNrIGZvcjpcclxuICAgICAgICAgICAgICAgIC8vIDEubXVsdGlzZWxlY3QsIDIuc3ViZ3JpZCAgMy4gdHJlZWdyaWQgYW5kIHJlbW92ZSB0aGUgdW5uZWRlZCBjb2x1bW5zIGZyb20gY29sTmFtZXNcclxuICAgICAgICAgICAgICAgIGlmKGdwcm0ucm93bnVtYmVycykge1xyXG4gICAgICAgICAgICAgICAgICAgIGdwcm0uY29sTmFtZXMuc3BsaWNlKDAsMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3BybS5jb2xNb2RlbC5zcGxpY2UoMCwxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKGdwcm0ubXVsdGlzZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBncHJtLmNvbE5hbWVzLnNwbGljZSgwLDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGdwcm0uY29sTW9kZWwuc3BsaWNlKDAsMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZihncHJtLnN1YkdyaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBncHJtLmNvbE5hbWVzLnNwbGljZSgwLDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGdwcm0uY29sTW9kZWwuc3BsaWNlKDAsMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBncHJtLmtudiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpZihncHJtLnRyZWVHcmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrZXkgaW4gZ3BybS50cmVlUmVhZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGdwcm0udHJlZVJlYWRlci5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncHJtLmNvbE5hbWVzLnNwbGljZShncHJtLmNvbE5hbWVzLmxlbmd0aC0xKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdwcm0uY29sTW9kZWwuc3BsaWNlKGdwcm0uY29sTW9kZWwubGVuZ3RoLTEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChvLmV4cHR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICd4bWxzdHJpbmcnIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gXCI8XCIrby5yb290K1wiPlwiK3htbEpzb25DbGFzcy5qc29uMnhtbChncHJtLG8uaWRlbnQpK1wiPC9cIitvLnJvb3QrXCI+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2pzb25zdHJpbmcnIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gXCJ7XCIrIHhtbEpzb25DbGFzcy50b0pzb24oZ3BybSxvLnJvb3Qsby5pZGVudCxmYWxzZSkrXCJ9XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGdwcm0ucG9zdERhdGEuZmlsdGVycyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXQ9cmV0LnJlcGxhY2UoL2ZpbHRlcnNcIjpcIi8sJ2ZpbHRlcnNcIjonKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldD1yZXQucmVwbGFjZSgvfV19XCIvLCd9XX0nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBleGNlbEV4cG9ydCA6IGZ1bmN0aW9uKG8pIHtcclxuICAgICAgICAgICAgbyA9ICQuZXh0ZW5kKHtcclxuICAgICAgICAgICAgICAgIGV4cHR5cGUgOiBcInJlbW90ZVwiLFxyXG4gICAgICAgICAgICAgICAgdXJsIDogbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZXI6IFwib3BlclwiLFxyXG4gICAgICAgICAgICAgICAgdGFnOiBcImV4Y2VsXCIsXHJcbiAgICAgICAgICAgICAgICBleHBvcnRPcHRpb25zIDoge31cclxuICAgICAgICAgICAgfSwgbyB8fCB7fSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIGlmKCF0aGlzLmdyaWQpIHsgcmV0dXJuO31cclxuICAgICAgICAgICAgICAgIHZhciB1cmw7XHJcbiAgICAgICAgICAgICAgICBpZihvLmV4cHR5cGUgPT09IFwicmVtb3RlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGRhdGEgPSAkLmV4dGVuZCh7fSx0aGlzLnAucG9zdERhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHBkYXRhW28ub3Blcl0gPSBvLnRhZztcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0galF1ZXJ5LnBhcmFtKHBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICBpZihvLnVybC5pbmRleE9mKFwiP1wiKSAhPT0gLTEpIHsgdXJsID0gby51cmwrXCImXCIrcGFyYW1zOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7IHVybCA9IG8udXJsK1wiP1wiK3BhcmFtczsgfVxyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IHVybDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0pKGpRdWVyeSk7XHJcbi8qanNoaW50IGV2aWw6dHJ1ZSwgZXFlcWVxOmZhbHNlLCBlcW51bGw6dHJ1ZSwgZGV2ZWw6dHJ1ZSAqL1xyXG4vKmdsb2JhbCBqUXVlcnkgKi9cclxuKGZ1bmN0aW9uKCQpe1xyXG4vKlxyXG4qKlxyXG4gKiBqcUdyaWQgYWRkb25zIHVzaW5nIGpRdWVyeSBVSVxyXG4gKiBBdXRob3I6IE1hcmsgV2lsbGlhbXNcclxuICogRHVhbCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGFuZCBHUEwgbGljZW5zZXM6XHJcbiAqIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXHJcbiAqIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMi4wLmh0bWxcclxuICogZGVwZW5kcyBvbiBqUXVlcnkgVUlcclxuKiovXHJcblwidXNlIHN0cmljdFwiO1xyXG5pZiAoJC5qZ3JpZC5tc2llICYmICQuamdyaWQubXNpZXZlcigpPT09OCkge1xyXG5cdCQuZXhwcltcIjpcIl0uaGlkZGVuID0gZnVuY3Rpb24oZWxlbSkge1xyXG5cdFx0cmV0dXJuIGVsZW0ub2Zmc2V0V2lkdGggPT09IDAgfHwgZWxlbS5vZmZzZXRIZWlnaHQgPT09IDAgfHxcclxuXHRcdFx0ZWxlbS5zdHlsZS5kaXNwbGF5ID09PSBcIm5vbmVcIjtcclxuXHR9O1xyXG59XHJcbi8vIHJlcXVpZXJlIGxvYWQgbXVsdGlzZWxlY3QgYmVmb3JlIGdyaWRcclxuJC5qZ3JpZC5fbXVsdGlzZWxlY3QgPSBmYWxzZTtcclxuaWYoJC51aSkge1xyXG5cdGlmICgkLnVpLm11bHRpc2VsZWN0ICkge1xyXG5cdFx0aWYoJC51aS5tdWx0aXNlbGVjdC5wcm90b3R5cGUuX3NldFNlbGVjdGVkKSB7XHJcblx0XHRcdHZhciBzZXRTZWxlY3RlZCA9ICQudWkubXVsdGlzZWxlY3QucHJvdG90eXBlLl9zZXRTZWxlY3RlZDtcclxuXHRcdFx0JC51aS5tdWx0aXNlbGVjdC5wcm90b3R5cGUuX3NldFNlbGVjdGVkID0gZnVuY3Rpb24oaXRlbSxzZWxlY3RlZCkge1xyXG5cdFx0XHRcdHZhciByZXQgPSBzZXRTZWxlY3RlZC5jYWxsKHRoaXMsaXRlbSxzZWxlY3RlZCk7XHJcblx0XHRcdFx0aWYgKHNlbGVjdGVkICYmIHRoaXMuc2VsZWN0ZWRMaXN0KSB7XHJcblx0XHRcdFx0XHR2YXIgZWx0ID0gdGhpcy5lbGVtZW50O1xyXG5cdFx0XHRcdFx0dGhpcy5zZWxlY3RlZExpc3QuZmluZCgnbGknKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRpZiAoJCh0aGlzKS5kYXRhKCdvcHRpb25MaW5rJykpIHtcclxuXHRcdFx0XHRcdFx0XHQkKHRoaXMpLmRhdGEoJ29wdGlvbkxpbmsnKS5yZW1vdmUoKS5hcHBlbmRUbyhlbHQpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIHJldDtcclxuXHRcdFx0fTtcclxuXHRcdH1cclxuXHRcdGlmKCQudWkubXVsdGlzZWxlY3QucHJvdG90eXBlLmRlc3Ryb3kpIHtcclxuXHRcdFx0JC51aS5tdWx0aXNlbGVjdC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHRoaXMuZWxlbWVudC5zaG93KCk7XHJcblx0XHRcdFx0dGhpcy5jb250YWluZXIucmVtb3ZlKCk7XHJcblx0XHRcdFx0aWYgKCQuV2lkZ2V0ID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdCQud2lkZ2V0LnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCQuV2lkZ2V0LnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9O1xyXG5cdFx0fVxyXG5cdFx0JC5qZ3JpZC5fbXVsdGlzZWxlY3QgPSB0cnVlO1xyXG5cdH1cclxufVxyXG5cclxuJC5qZ3JpZC5leHRlbmQoe1xyXG5cdHNvcnRhYmxlQ29sdW1ucyA6IGZ1bmN0aW9uICh0Ymxyb3cpXHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKXtcclxuXHRcdFx0dmFyIHRzID0gdGhpcywgdGlkPSAkLmpncmlkLmpxSUQoIHRzLnAuaWQgKTtcclxuXHRcdFx0ZnVuY3Rpb24gc3RhcnQoKSB7dHMucC5kaXNhYmxlQ2xpY2sgPSB0cnVlO31cclxuXHRcdFx0dmFyIHNvcnRhYmxlX29wdHMgPSB7XHJcblx0XHRcdFx0XCJ0b2xlcmFuY2VcIiA6IFwicG9pbnRlclwiLFxyXG5cdFx0XHRcdFwiYXhpc1wiIDogXCJ4XCIsXHJcblx0XHRcdFx0XCJzY3JvbGxTZW5zaXRpdml0eVwiOiBcIjFcIixcclxuXHRcdFx0XHRcIml0ZW1zXCI6ICc+dGg6bm90KDpoYXMoI2pxZ2hfJyt0aWQrJ19jYicrJywjanFnaF8nK3RpZCsnX3JuJysnLCNqcWdoXycrdGlkKydfc3ViZ3JpZCksOmhpZGRlbiknLFxyXG5cdFx0XHRcdFwicGxhY2Vob2xkZXJcIjoge1xyXG5cdFx0XHRcdFx0ZWxlbWVudDogZnVuY3Rpb24oaXRlbSkge1xyXG5cdFx0XHRcdFx0XHR2YXIgZWwgPSAkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXRlbVswXS5ub2RlTmFtZSkpXHJcblx0XHRcdFx0XHRcdC5hZGRDbGFzcyhpdGVtWzBdLmNsYXNzTmFtZStcIiB1aS1zb3J0YWJsZS1wbGFjZWhvbGRlciB1aS1zdGF0ZS1oaWdobGlnaHRcIilcclxuXHRcdFx0XHRcdFx0LnJlbW92ZUNsYXNzKFwidWktc29ydGFibGUtaGVscGVyXCIpWzBdO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZWw7XHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0dXBkYXRlOiBmdW5jdGlvbihzZWxmLCBwKSB7XHJcblx0XHRcdFx0XHRcdHAuaGVpZ2h0KHNlbGYuY3VycmVudEl0ZW0uaW5uZXJIZWlnaHQoKSAtIHBhcnNlSW50KHNlbGYuY3VycmVudEl0ZW0uY3NzKCdwYWRkaW5nVG9wJyl8fDAsIDEwKSAtIHBhcnNlSW50KHNlbGYuY3VycmVudEl0ZW0uY3NzKCdwYWRkaW5nQm90dG9tJyl8fDAsIDEwKSk7XHJcblx0XHRcdFx0XHRcdHAud2lkdGgoc2VsZi5jdXJyZW50SXRlbS5pbm5lcldpZHRoKCkgLSBwYXJzZUludChzZWxmLmN1cnJlbnRJdGVtLmNzcygncGFkZGluZ0xlZnQnKXx8MCwgMTApIC0gcGFyc2VJbnQoc2VsZi5jdXJyZW50SXRlbS5jc3MoJ3BhZGRpbmdSaWdodCcpfHwwLCAxMCkpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0XCJ1cGRhdGVcIjogZnVuY3Rpb24oZXZlbnQsIHVpKSB7XHJcblx0XHRcdFx0XHR2YXIgcCA9ICQodWkuaXRlbSkucGFyZW50KCksXHJcblx0XHRcdFx0XHR0aCA9ICQoXCI+dGhcIiwgcCksXHJcblx0XHRcdFx0XHRjb2xNb2RlbCA9IHRzLnAuY29sTW9kZWwsXHJcblx0XHRcdFx0XHRjbU1hcCA9IHt9LCB0aWQ9IHRzLnAuaWQrXCJfXCI7XHJcblx0XHRcdFx0XHQkLmVhY2goY29sTW9kZWwsIGZ1bmN0aW9uKGkpIHsgY21NYXBbdGhpcy5uYW1lXT1pOyB9KTtcclxuXHRcdFx0XHRcdHZhciBwZXJtdXRhdGlvbiA9IFtdO1xyXG5cdFx0XHRcdFx0dGguZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0dmFyIGlkID0gJChcIj5kaXZcIiwgdGhpcykuZ2V0KDApLmlkLnJlcGxhY2UoL15qcWdoXy8sIFwiXCIpLnJlcGxhY2UodGlkLFwiXCIpO1xyXG5cdFx0XHRcdFx0XHRcdGlmIChjbU1hcC5oYXNPd25Qcm9wZXJ0eShpZCkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHBlcm11dGF0aW9uLnB1c2goY21NYXBbaWRdKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0XHQkKHRzKS5qcUdyaWQoXCJyZW1hcENvbHVtbnNcIixwZXJtdXRhdGlvbiwgdHJ1ZSwgdHJ1ZSk7XHJcblx0XHRcdFx0XHRpZiAoJC5pc0Z1bmN0aW9uKHRzLnAuc29ydGFibGUudXBkYXRlKSkge1xyXG5cdFx0XHRcdFx0XHR0cy5wLnNvcnRhYmxlLnVwZGF0ZShwZXJtdXRhdGlvbik7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dHMucC5kaXNhYmxlQ2xpY2s9ZmFsc2U7fSwgNTApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fTtcclxuXHRcdFx0aWYgKHRzLnAuc29ydGFibGUub3B0aW9ucykge1xyXG5cdFx0XHRcdCQuZXh0ZW5kKHNvcnRhYmxlX29wdHMsIHRzLnAuc29ydGFibGUub3B0aW9ucyk7XHJcblx0XHRcdH0gZWxzZSBpZiAoJC5pc0Z1bmN0aW9uKHRzLnAuc29ydGFibGUpKSB7XHJcblx0XHRcdFx0dHMucC5zb3J0YWJsZSA9IHsgXCJ1cGRhdGVcIiA6IHRzLnAuc29ydGFibGUgfTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoc29ydGFibGVfb3B0cy5zdGFydCkge1xyXG5cdFx0XHRcdHZhciBzID0gc29ydGFibGVfb3B0cy5zdGFydDtcclxuXHRcdFx0XHRzb3J0YWJsZV9vcHRzLnN0YXJ0ID0gZnVuY3Rpb24oZSx1aSkge1xyXG5cdFx0XHRcdFx0c3RhcnQoKTtcclxuXHRcdFx0XHRcdHMuY2FsbCh0aGlzLGUsdWkpO1xyXG5cdFx0XHRcdH07XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0c29ydGFibGVfb3B0cy5zdGFydCA9IHN0YXJ0O1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICh0cy5wLnNvcnRhYmxlLmV4Y2x1ZGUpIHtcclxuXHRcdFx0XHRzb3J0YWJsZV9vcHRzLml0ZW1zICs9IFwiOm5vdChcIit0cy5wLnNvcnRhYmxlLmV4Y2x1ZGUrXCIpXCI7XHJcblx0XHRcdH1cclxuXHRcdFx0dGJscm93LnNvcnRhYmxlKHNvcnRhYmxlX29wdHMpLmRhdGEoXCJzb3J0YWJsZVwiKS5mbG9hdGluZyA9IHRydWU7XHJcblx0XHR9KTtcclxuXHR9LFxyXG4gICAgY29sdW1uQ2hvb3NlciA6IGZ1bmN0aW9uKG9wdHMpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblx0XHRpZigkKFwiI2NvbGNob29zZXJfXCIrJC5qZ3JpZC5qcUlEKHNlbGZbMF0ucC5pZCkpLmxlbmd0aCApIHsgcmV0dXJuOyB9XHJcbiAgICAgICAgdmFyIHNlbGVjdG9yID0gJCgnPGRpdiBpZD1cImNvbGNob29zZXJfJytzZWxmWzBdLnAuaWQrJ1wiIHN0eWxlPVwicG9zaXRpb246cmVsYXRpdmU7b3ZlcmZsb3c6aGlkZGVuXCI+PGRpdj48c2VsZWN0IG11bHRpcGxlPVwibXVsdGlwbGVcIj48L3NlbGVjdD48L2Rpdj48L2Rpdj4nKTtcclxuICAgICAgICB2YXIgc2VsZWN0ID0gJCgnc2VsZWN0Jywgc2VsZWN0b3IpO1xyXG5cclxuXHRcdGZ1bmN0aW9uIGluc2VydChwZXJtLGksdikge1xyXG5cdFx0XHRpZihpPj0wKXtcclxuXHRcdFx0XHR2YXIgYSA9IHBlcm0uc2xpY2UoKTtcclxuXHRcdFx0XHR2YXIgYiA9IGEuc3BsaWNlKGksTWF0aC5tYXgocGVybS5sZW5ndGgtaSxpKSk7XHJcblx0XHRcdFx0aWYoaT5wZXJtLmxlbmd0aCkgeyBpID0gcGVybS5sZW5ndGg7IH1cclxuXHRcdFx0XHRhW2ldID0gdjtcclxuXHRcdFx0XHRyZXR1cm4gYS5jb25jYXQoYik7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuICAgICAgICBvcHRzID0gJC5leHRlbmQoe1xyXG4gICAgICAgICAgICBcIndpZHRoXCIgOiA0MjAsXHJcbiAgICAgICAgICAgIFwiaGVpZ2h0XCIgOiAyNDAsXHJcbiAgICAgICAgICAgIFwiY2xhc3NuYW1lXCIgOiBudWxsLFxyXG4gICAgICAgICAgICBcImRvbmVcIiA6IGZ1bmN0aW9uKHBlcm0pIHsgaWYgKHBlcm0pIHsgc2VsZi5qcUdyaWQoXCJyZW1hcENvbHVtbnNcIiwgcGVybSwgdHJ1ZSk7IH0gfSxcclxuICAgICAgICAgICAgLyogbXNlbCBpcyBlaXRoZXIgdGhlIG5hbWUgb2YgYSB1aSB3aWRnZXQgY2xhc3MgdGhhdFxyXG4gICAgICAgICAgICAgICBleHRlbmRzIGEgbXVsdGlzZWxlY3QsIG9yIGEgZnVuY3Rpb24gdGhhdCBzdXBwb3J0c1xyXG4gICAgICAgICAgICAgICBjcmVhdGluZyBhIG11bHRpc2VsZWN0IG9iamVjdCAod2l0aCBubyBhcmd1bWVudCxcclxuICAgICAgICAgICAgICAgb3Igd2hlbiBwYXNzZWQgYW4gb2JqZWN0KSwgYW5kIGRlc3Ryb3lpbmcgaXQgKHdoZW5cclxuICAgICAgICAgICAgICAgcGFzc2VkIHRoZSBzdHJpbmcgXCJkZXN0cm95XCIpLiAqL1xyXG4gICAgICAgICAgICBcIm1zZWxcIiA6IFwibXVsdGlzZWxlY3RcIixcclxuICAgICAgICAgICAgLyogXCJtc2VsX29wdHNcIiA6IHt9LCAqL1xyXG5cclxuICAgICAgICAgICAgLyogZGxvZyBpcyBlaXRoZXIgdGhlIG5hbWUgb2YgYSB1aSB3aWRnZXQgY2xhc3MgdGhhdFxyXG4gICAgICAgICAgICAgICBiZWhhdmVzIGluIGEgZGlhbG9nLWxpa2Ugd2F5LCBvciBhIGZ1bmN0aW9uLCB0aGF0XHJcbiAgICAgICAgICAgICAgIHN1cHBvcnRzIGNyZWF0aW5nIGEgZGlhbG9nICh3aGVuIHBhc3NlZCBkbG9nX29wdHMpXHJcbiAgICAgICAgICAgICAgIG9yIGRlc3Ryb3lpbmcgYSBkaWFsb2cgKHdoZW4gcGFzc2VkIHRoZSBzdHJpbmdcclxuICAgICAgICAgICAgICAgXCJkZXN0cm95XCIpXHJcbiAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIFwiZGxvZ1wiIDogXCJkaWFsb2dcIixcclxuXHRcdFx0XCJkaWFsb2dfb3B0c1wiIDoge1xyXG5cdFx0XHRcdFwibWluV2lkdGhcIjogNDcwXHJcblx0XHRcdH0sXHJcbiAgICAgICAgICAgIC8qIGRsb2dfb3B0cyBpcyBlaXRoZXIgYW4gb3B0aW9uIG9iamVjdCB0byBiZSBwYXNzZWRcclxuICAgICAgICAgICAgICAgdG8gXCJkbG9nXCIsIG9yIChtb3JlIGxpa2VseSkgYSBmdW5jdGlvbiB0aGF0IGNyZWF0ZXNcclxuICAgICAgICAgICAgICAgdGhlIG9wdGlvbnMgb2JqZWN0LlxyXG4gICAgICAgICAgICAgICBUaGUgZGVmYXVsdCBwcm9kdWNlcyBhIHN1aXRhYmxlIG9wdGlvbnMgb2JqZWN0IGZvclxyXG4gICAgICAgICAgICAgICB1aS5kaWFsb2cgKi9cclxuICAgICAgICAgICAgXCJkbG9nX29wdHNcIiA6IGZ1bmN0aW9uKG9wdHMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBidXR0b25zID0ge307XHJcbiAgICAgICAgICAgICAgICBidXR0b25zW29wdHMuYlN1Ym1pdF0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRzLmFwcGx5X3Blcm0oKTtcclxuICAgICAgICAgICAgICAgICAgICBvcHRzLmNsZWFudXAoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbnNbb3B0cy5iQ2FuY2VsXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdHMuY2xlYW51cCh0cnVlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJC5leHRlbmQodHJ1ZSwge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiYnV0dG9uc1wiOiBidXR0b25zLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiY2xvc2VcIjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdHMuY2xlYW51cCh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG5cdFx0XHRcdFx0XCJtb2RhbFwiIDogb3B0cy5tb2RhbCB8fCBmYWxzZSxcclxuXHRcdFx0XHRcdFwicmVzaXphYmxlXCI6IG9wdHMucmVzaXphYmxlIHx8IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiBvcHRzLndpZHRoKzIwXHJcbiAgICAgICAgICAgICAgICB9LCBvcHRzLmRpYWxvZ19vcHRzIHx8IHt9KTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgLyogRnVuY3Rpb24gdG8gZ2V0IHRoZSBwZXJtdXRhdGlvbiBhcnJheSwgYW5kIHBhc3MgaXQgdG8gdGhlXHJcbiAgICAgICAgICAgICAgIFwiZG9uZVwiIGZ1bmN0aW9uICovXHJcbiAgICAgICAgICAgIFwiYXBwbHlfcGVybVwiIDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkKCdvcHRpb24nLHNlbGVjdCkuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmpxR3JpZChcInNob3dDb2xcIiwgY29sTW9kZWxbdGhpcy52YWx1ZV0ubmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5qcUdyaWQoXCJoaWRlQ29sXCIsIGNvbE1vZGVsW3RoaXMudmFsdWVdLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBwZXJtID0gW107XHJcblx0XHRcdFx0Ly9maXhlZENvbHMuc2xpY2UoMCk7XHJcbiAgICAgICAgICAgICAgICAkKCdvcHRpb246c2VsZWN0ZWQnLHNlbGVjdCkuZWFjaChmdW5jdGlvbigpIHsgcGVybS5wdXNoKHBhcnNlSW50KHRoaXMudmFsdWUsMTApKTsgfSk7XHJcbiAgICAgICAgICAgICAgICAkLmVhY2gocGVybSwgZnVuY3Rpb24oKSB7IGRlbGV0ZSBjb2xNYXBbY29sTW9kZWxbcGFyc2VJbnQodGhpcywxMCldLm5hbWVdOyB9KTtcclxuICAgICAgICAgICAgICAgICQuZWFjaChjb2xNYXAsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIHRpID0gcGFyc2VJbnQodGhpcywxMCk7XHJcblx0XHRcdFx0XHRwZXJtID0gaW5zZXJ0KHBlcm0sdGksdGkpO1xyXG5cdFx0XHRcdH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKG9wdHMuZG9uZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdHMuZG9uZS5jYWxsKHNlbGYsIHBlcm0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAvKiBGdW5jdGlvbiB0byBjbGVhbnVwIHRoZSBkaWFsb2csIGFuZCBzZWxlY3QuIEFsc28gY2FsbHMgdGhlXHJcbiAgICAgICAgICAgICAgIGRvbmUgZnVuY3Rpb24gd2l0aCBubyBwZXJtdXRhdGlvbiAodG8gaW5kaWNhdGUgdGhhdCB0aGVcclxuICAgICAgICAgICAgICAgY29sdW1uQ2hvb3NlciB3YXMgYWJvcnRlZCAqL1xyXG4gICAgICAgICAgICBcImNsZWFudXBcIiA6IGZ1bmN0aW9uKGNhbGxkb25lKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsKG9wdHMuZGxvZywgc2VsZWN0b3IsICdkZXN0cm95Jyk7XHJcbiAgICAgICAgICAgICAgICBjYWxsKG9wdHMubXNlbCwgc2VsZWN0LCAnZGVzdHJveScpO1xyXG4gICAgICAgICAgICAgICAgc2VsZWN0b3IucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGRvbmUgJiYgb3B0cy5kb25lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0cy5kb25lLmNhbGwoc2VsZik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcblx0XHRcdFwibXNlbF9vcHRzXCIgOiB7fVxyXG4gICAgICAgIH0sICQuamdyaWQuY29sLCBvcHRzIHx8IHt9KTtcclxuXHRcdGlmKCQudWkpIHtcclxuXHRcdFx0aWYgKCQudWkubXVsdGlzZWxlY3QgKSB7XHJcblx0XHRcdFx0aWYob3B0cy5tc2VsID09PSBcIm11bHRpc2VsZWN0XCIpIHtcclxuXHRcdFx0XHRcdGlmKCEkLmpncmlkLl9tdWx0aXNlbGVjdCkge1xyXG5cdFx0XHRcdFx0XHQvLyBzaG91bGQgYmUgaW4gbGFuZ3VhZ2UgZmlsZVxyXG5cdFx0XHRcdFx0XHRhbGVydChcIk11bHRpc2VsZWN0IHBsdWdpbiBsb2FkZWQgYWZ0ZXIganFHcmlkLiBQbGVhc2UgbG9hZCB0aGUgcGx1Z2luIGJlZm9yZSB0aGUganFHcmlkIVwiKTtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0b3B0cy5tc2VsX29wdHMgPSAkLmV4dGVuZCgkLnVpLm11bHRpc2VsZWN0LmRlZmF1bHRzLG9wdHMubXNlbF9vcHRzKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuICAgICAgICBpZiAob3B0cy5jYXB0aW9uKSB7XHJcbiAgICAgICAgICAgIHNlbGVjdG9yLmF0dHIoXCJ0aXRsZVwiLCBvcHRzLmNhcHRpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0cy5jbGFzc25hbWUpIHtcclxuICAgICAgICAgICAgc2VsZWN0b3IuYWRkQ2xhc3Mob3B0cy5jbGFzc25hbWUpO1xyXG4gICAgICAgICAgICBzZWxlY3QuYWRkQ2xhc3Mob3B0cy5jbGFzc25hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0cy53aWR0aCkge1xyXG4gICAgICAgICAgICAkKFwiPmRpdlwiLHNlbGVjdG9yKS5jc3Moe1wid2lkdGhcIjogb3B0cy53aWR0aCxcIm1hcmdpblwiOlwiMCBhdXRvXCJ9KTtcclxuICAgICAgICAgICAgc2VsZWN0LmNzcyhcIndpZHRoXCIsIG9wdHMud2lkdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0cy5oZWlnaHQpIHtcclxuICAgICAgICAgICAgJChcIj5kaXZcIixzZWxlY3RvcikuY3NzKFwiaGVpZ2h0XCIsIG9wdHMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgc2VsZWN0LmNzcyhcImhlaWdodFwiLCBvcHRzLmhlaWdodCAtIDEwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGNvbE1vZGVsID0gc2VsZi5qcUdyaWQoXCJnZXRHcmlkUGFyYW1cIiwgXCJjb2xNb2RlbFwiKTtcclxuICAgICAgICB2YXIgY29sTmFtZXMgPSBzZWxmLmpxR3JpZChcImdldEdyaWRQYXJhbVwiLCBcImNvbE5hbWVzXCIpO1xyXG4gICAgICAgIHZhciBjb2xNYXAgPSB7fSwgZml4ZWRDb2xzID0gW107XHJcblxyXG4gICAgICAgIHNlbGVjdC5lbXB0eSgpO1xyXG4gICAgICAgICQuZWFjaChjb2xNb2RlbCwgZnVuY3Rpb24oaSkge1xyXG4gICAgICAgICAgICBjb2xNYXBbdGhpcy5uYW1lXSA9IGk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmhpZGVkbGcpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5oaWRkZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBmaXhlZENvbHMucHVzaChpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2VsZWN0LmFwcGVuZChcIjxvcHRpb24gdmFsdWU9J1wiK2krXCInIFwiK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICh0aGlzLmhpZGRlbj9cIlwiOlwic2VsZWN0ZWQ9J3NlbGVjdGVkJ1wiKStcIj5cIiskLmpncmlkLnN0cmlwSHRtbChjb2xOYW1lc1tpXSkrXCI8L29wdGlvbj5cIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZnVuY3Rpb24gY2FsbChmbiwgb2JqKSB7XHJcbiAgICAgICAgICAgIGlmICghZm4pIHsgcmV0dXJuOyB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZm4gPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJC5mbltmbl0pIHtcclxuICAgICAgICAgICAgICAgICAgICAkLmZuW2ZuXS5hcHBseShvYmosICQubWFrZUFycmF5KGFyZ3VtZW50cykuc2xpY2UoMikpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCQuaXNGdW5jdGlvbihmbikpIHtcclxuICAgICAgICAgICAgICAgIGZuLmFwcGx5KG9iaiwgJC5tYWtlQXJyYXkoYXJndW1lbnRzKS5zbGljZSgyKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBkb3B0cyA9ICQuaXNGdW5jdGlvbihvcHRzLmRsb2dfb3B0cykgPyBvcHRzLmRsb2dfb3B0cy5jYWxsKHNlbGYsIG9wdHMpIDogb3B0cy5kbG9nX29wdHM7XHJcbiAgICAgICAgY2FsbChvcHRzLmRsb2csIHNlbGVjdG9yLCBkb3B0cyk7XHJcbiAgICAgICAgdmFyIG1vcHRzID0gJC5pc0Z1bmN0aW9uKG9wdHMubXNlbF9vcHRzKSA/IG9wdHMubXNlbF9vcHRzLmNhbGwoc2VsZiwgb3B0cykgOiBvcHRzLm1zZWxfb3B0cztcclxuICAgICAgICBjYWxsKG9wdHMubXNlbCwgc2VsZWN0LCBtb3B0cyk7XHJcbiAgICB9LFxyXG5cdHNvcnRhYmxlUm93cyA6IGZ1bmN0aW9uIChvcHRzKSB7XHJcblx0XHQvLyBDYW4gYWNjZXB0IGFsbCBzb3J0YWJsZSBvcHRpb25zIGFuZCBldmVudHNcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyICR0ID0gdGhpcztcclxuXHRcdFx0aWYoISR0LmdyaWQpIHsgcmV0dXJuOyB9XHJcblx0XHRcdC8vIEN1cnJlbnRseSB3ZSBkaXNhYmxlIGEgdHJlZUdyaWQgc29ydGFibGVcclxuXHRcdFx0aWYoJHQucC50cmVlR3JpZCkgeyByZXR1cm47IH1cclxuXHRcdFx0aWYoJC5mbi5zb3J0YWJsZSkge1xyXG5cdFx0XHRcdG9wdHMgPSAkLmV4dGVuZCh7XHJcblx0XHRcdFx0XHRcImN1cnNvclwiOlwibW92ZVwiLFxyXG5cdFx0XHRcdFx0XCJheGlzXCIgOiBcInlcIixcclxuXHRcdFx0XHRcdFwiaXRlbXNcIjogXCIuanFncm93XCJcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0b3B0cyB8fCB7fSk7XHJcblx0XHRcdFx0aWYob3B0cy5zdGFydCAmJiAkLmlzRnVuY3Rpb24ob3B0cy5zdGFydCkpIHtcclxuXHRcdFx0XHRcdG9wdHMuX3N0YXJ0XyA9IG9wdHMuc3RhcnQ7XHJcblx0XHRcdFx0XHRkZWxldGUgb3B0cy5zdGFydDtcclxuXHRcdFx0XHR9IGVsc2Uge29wdHMuX3N0YXJ0Xz1mYWxzZTt9XHJcblx0XHRcdFx0aWYob3B0cy51cGRhdGUgJiYgJC5pc0Z1bmN0aW9uKG9wdHMudXBkYXRlKSkge1xyXG5cdFx0XHRcdFx0b3B0cy5fdXBkYXRlXyA9IG9wdHMudXBkYXRlO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIG9wdHMudXBkYXRlO1xyXG5cdFx0XHRcdH0gZWxzZSB7b3B0cy5fdXBkYXRlXyA9IGZhbHNlO31cclxuXHRcdFx0XHRvcHRzLnN0YXJ0ID0gZnVuY3Rpb24oZXYsdWkpIHtcclxuXHRcdFx0XHRcdCQodWkuaXRlbSkuY3NzKFwiYm9yZGVyLXdpZHRoXCIsXCIwXCIpO1xyXG5cdFx0XHRcdFx0JChcInRkXCIsdWkuaXRlbSkuZWFjaChmdW5jdGlvbihpKXtcclxuXHRcdFx0XHRcdFx0dGhpcy5zdHlsZS53aWR0aCA9ICR0LmdyaWQuY29sc1tpXS5zdHlsZS53aWR0aDtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aWYoJHQucC5zdWJHcmlkKSB7XHJcblx0XHRcdFx0XHRcdHZhciBzdWJnaWQgPSAkKHVpLml0ZW0pLmF0dHIoXCJpZFwiKTtcclxuXHRcdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoJ2NvbGxhcHNlU3ViR3JpZFJvdycsc3ViZ2lkKTtcclxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKG9wdHMuX3N0YXJ0Xykge1xyXG5cdFx0XHRcdFx0XHRvcHRzLl9zdGFydF8uYXBwbHkodGhpcyxbZXYsdWldKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9O1xyXG5cdFx0XHRcdG9wdHMudXBkYXRlID0gZnVuY3Rpb24gKGV2LHVpKSB7XHJcblx0XHRcdFx0XHQkKHVpLml0ZW0pLmNzcyhcImJvcmRlci13aWR0aFwiLFwiXCIpO1xyXG5cdFx0XHRcdFx0aWYoJHQucC5yb3dudW1iZXJzID09PSB0cnVlKSB7XHJcblx0XHRcdFx0XHRcdCQoXCJ0ZC5qcWdyaWQtcm93bnVtXCIsJHQucm93cykuZWFjaChmdW5jdGlvbiggaSApe1xyXG5cdFx0XHRcdFx0XHRcdCQodGhpcykuaHRtbCggaSsxKyhwYXJzZUludCgkdC5wLnBhZ2UsMTApLTEpKnBhcnNlSW50KCR0LnAucm93TnVtLDEwKSApO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKG9wdHMuX3VwZGF0ZV8pIHtcclxuXHRcdFx0XHRcdFx0b3B0cy5fdXBkYXRlXy5hcHBseSh0aGlzLFtldix1aV0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH07XHJcblx0XHRcdFx0JChcInRib2R5OmZpcnN0XCIsJHQpLnNvcnRhYmxlKG9wdHMpO1xyXG5cdFx0XHRcdCQoXCJ0Ym9keTpmaXJzdFwiLCR0KS5kaXNhYmxlU2VsZWN0aW9uKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0Z3JpZERuRCA6IGZ1bmN0aW9uKG9wdHMpIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdHZhciAkdCA9IHRoaXMsIGksIGNuO1xyXG5cdFx0aWYoISR0LmdyaWQpIHsgcmV0dXJuOyB9XHJcblx0XHQvLyBDdXJyZW50bHkgd2UgZGlzYWJsZSBhIHRyZWVHcmlkIGRyYWcgYW5kIGRyb3BcclxuXHRcdGlmKCR0LnAudHJlZUdyaWQpIHsgcmV0dXJuOyB9XHJcblx0XHRpZighJC5mbi5kcmFnZ2FibGUgfHwgISQuZm4uZHJvcHBhYmxlKSB7IHJldHVybjsgfVxyXG5cdFx0ZnVuY3Rpb24gdXBkYXRlRG5EICgpXHJcblx0XHR7XHJcblx0XHRcdHZhciBkYXRhZG5kID0gJC5kYXRhKCR0LFwiZG5kXCIpO1xyXG5cdFx0XHQkKFwidHIuanFncm93Om5vdCgudWktZHJhZ2dhYmxlKVwiLCR0KS5kcmFnZ2FibGUoJC5pc0Z1bmN0aW9uKGRhdGFkbmQuZHJhZykgPyBkYXRhZG5kLmRyYWcuY2FsbCgkKCR0KSxkYXRhZG5kKSA6IGRhdGFkbmQuZHJhZyk7XHJcblx0XHR9XHJcblx0XHR2YXIgYXBwZW5kZXIgPSBcIjx0YWJsZSBpZD0nanFncmlkX2RuZCcgY2xhc3M9J3VpLWpxZ3JpZC1kbmQnPjwvdGFibGU+XCI7XHJcblx0XHRpZigkKFwiI2pxZ3JpZF9kbmRcIilbMF0gPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHQkKCdib2R5JykuYXBwZW5kKGFwcGVuZGVyKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZih0eXBlb2Ygb3B0cyA9PT0gJ3N0cmluZycgJiYgb3B0cyA9PT0gJ3VwZGF0ZURuRCcgJiYgJHQucC5qcWdkbmQ9PT10cnVlKSB7XHJcblx0XHRcdHVwZGF0ZURuRCgpO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRvcHRzID0gJC5leHRlbmQoe1xyXG5cdFx0XHRcImRyYWdcIiA6IGZ1bmN0aW9uIChvcHRzKSB7XHJcblx0XHRcdFx0cmV0dXJuICQuZXh0ZW5kKHtcclxuXHRcdFx0XHRcdHN0YXJ0IDogZnVuY3Rpb24gKGV2LCB1aSkge1xyXG5cdFx0XHRcdFx0XHR2YXIgaSwgc3ViZ2lkO1xyXG5cdFx0XHRcdFx0XHQvLyBpZiB3ZSBhcmUgaW4gc3ViZ3JpZCBtb2RlIHRyeSB0byBjb2xsYXBzZSB0aGUgbm9kZVxyXG5cdFx0XHRcdFx0XHRpZigkdC5wLnN1YkdyaWQpIHtcclxuXHRcdFx0XHRcdFx0XHRzdWJnaWQgPSAkKHVpLmhlbHBlcikuYXR0cihcImlkXCIpO1xyXG5cdFx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKCR0KS5qcUdyaWQoJ2NvbGxhcHNlU3ViR3JpZFJvdycsc3ViZ2lkKTtcclxuXHRcdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdC8vIGhhY2tcclxuXHRcdFx0XHRcdFx0Ly8gZHJhZyBhbmQgZHJvcCBkb2VzIG5vdCBpbnNlcnQgdHIgaW4gdGFibGUsIHdoZW4gdGhlIHRhYmxlIGhhcyBubyByb3dzXHJcblx0XHRcdFx0XHRcdC8vIHdlIHRyeSB0byBpbnNlcnQgbmV3IGVtcHR5IHJvdyBvbiB0aGUgdGFyZ2V0KHMpXHJcblx0XHRcdFx0XHRcdGZvciAoaT0wO2k8JC5kYXRhKCR0LFwiZG5kXCIpLmNvbm5lY3RXaXRoLmxlbmd0aDtpKyspe1xyXG5cdFx0XHRcdFx0XHRcdGlmKCQoJC5kYXRhKCR0LFwiZG5kXCIpLmNvbm5lY3RXaXRoW2ldKS5qcUdyaWQoJ2dldEdyaWRQYXJhbScsJ3JlY2NvdW50JykgPT09IDAgKXtcclxuXHRcdFx0XHRcdFx0XHRcdCQoJC5kYXRhKCR0LFwiZG5kXCIpLmNvbm5lY3RXaXRoW2ldKS5qcUdyaWQoJ2FkZFJvd0RhdGEnLCdqcWdfZW1wdHlfcm93Jyx7fSk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHVpLmhlbHBlci5hZGRDbGFzcyhcInVpLXN0YXRlLWhpZ2hsaWdodFwiKTtcclxuXHRcdFx0XHRcdFx0JChcInRkXCIsdWkuaGVscGVyKS5lYWNoKGZ1bmN0aW9uKGkpIHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnN0eWxlLndpZHRoID0gJHQuZ3JpZC5oZWFkZXJzW2ldLndpZHRoK1wicHhcIjtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdGlmKG9wdHMub25zdGFydCAmJiAkLmlzRnVuY3Rpb24ob3B0cy5vbnN0YXJ0KSApIHsgb3B0cy5vbnN0YXJ0LmNhbGwoJCgkdCksZXYsdWkpOyB9XHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0c3RvcCA6ZnVuY3Rpb24oZXYsdWkpIHtcclxuXHRcdFx0XHRcdFx0dmFyIGksIGlkcztcclxuXHRcdFx0XHRcdFx0aWYodWkuaGVscGVyLmRyb3BwZWQgJiYgIW9wdHMuZHJhZ2NvcHkpIHtcclxuXHRcdFx0XHRcdFx0XHRpZHMgPSAkKHVpLmhlbHBlcikuYXR0cihcImlkXCIpO1xyXG5cdFx0XHRcdFx0XHRcdGlmKGlkcyA9PT0gdW5kZWZpbmVkKSB7IGlkcyA9ICQodGhpcykuYXR0cihcImlkXCIpOyB9XHJcblx0XHRcdFx0XHRcdFx0JCgkdCkuanFHcmlkKCdkZWxSb3dEYXRhJyxpZHMgKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHQvLyBpZiB3ZSBoYXZlIGEgZW1wdHkgcm93IGluc2VydGVkIGZyb20gc3RhcnQgZXZlbnQgdHJ5IHRvIGRlbGV0ZSBpdFxyXG5cdFx0XHRcdFx0XHRmb3IgKGk9MDtpPCQuZGF0YSgkdCxcImRuZFwiKS5jb25uZWN0V2l0aC5sZW5ndGg7aSsrKXtcclxuXHRcdFx0XHRcdFx0XHQkKCQuZGF0YSgkdCxcImRuZFwiKS5jb25uZWN0V2l0aFtpXSkuanFHcmlkKCdkZWxSb3dEYXRhJywnanFnX2VtcHR5X3JvdycpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmKG9wdHMub25zdG9wICYmICQuaXNGdW5jdGlvbihvcHRzLm9uc3RvcCkgKSB7IG9wdHMub25zdG9wLmNhbGwoJCgkdCksZXYsdWkpOyB9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSxvcHRzLmRyYWdfb3B0cyB8fCB7fSk7XHJcblx0XHRcdH0sXHJcblx0XHRcdFwiZHJvcFwiIDogZnVuY3Rpb24gKG9wdHMpIHtcclxuXHRcdFx0XHRyZXR1cm4gJC5leHRlbmQoe1xyXG5cdFx0XHRcdFx0YWNjZXB0OiBmdW5jdGlvbihkKSB7XHJcblx0XHRcdFx0XHRcdGlmICghJChkKS5oYXNDbGFzcygnanFncm93JykpIHsgcmV0dXJuIGQ7fVxyXG5cdFx0XHRcdFx0XHR2YXIgdGlkID0gJChkKS5jbG9zZXN0KFwidGFibGUudWktanFncmlkLWJ0YWJsZVwiKTtcclxuXHRcdFx0XHRcdFx0aWYodGlkLmxlbmd0aCA+IDAgJiYgJC5kYXRhKHRpZFswXSxcImRuZFwiKSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdFx0dmFyIGNuID0gJC5kYXRhKHRpZFswXSxcImRuZFwiKS5jb25uZWN0V2l0aDtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gJC5pbkFycmF5KCcjJyskLmpncmlkLmpxSUQodGhpcy5pZCksY24pICE9PSAtMSA/IHRydWUgOiBmYWxzZTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0ZHJvcDogZnVuY3Rpb24oZXYsIHVpKSB7XHJcblx0XHRcdFx0XHRcdGlmICghJCh1aS5kcmFnZ2FibGUpLmhhc0NsYXNzKCdqcWdyb3cnKSkgeyByZXR1cm47IH1cclxuXHRcdFx0XHRcdFx0dmFyIGFjY2VwdCA9ICQodWkuZHJhZ2dhYmxlKS5hdHRyKFwiaWRcIik7XHJcblx0XHRcdFx0XHRcdHZhciBnZXRkYXRhID0gdWkuZHJhZ2dhYmxlLnBhcmVudCgpLnBhcmVudCgpLmpxR3JpZCgnZ2V0Um93RGF0YScsYWNjZXB0KTtcclxuXHRcdFx0XHRcdFx0aWYoIW9wdHMuZHJvcGJ5bmFtZSkge1xyXG5cdFx0XHRcdFx0XHRcdHZhciBqID0wLCB0bXBkYXRhID0ge30sIG5tLCBrZXk7XHJcblx0XHRcdFx0XHRcdFx0dmFyIGRyb3Btb2RlbCA9ICQoXCIjXCIrJC5qZ3JpZC5qcUlEKHRoaXMuaWQpKS5qcUdyaWQoJ2dldEdyaWRQYXJhbScsJ2NvbE1vZGVsJyk7XHJcblx0XHRcdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0XHRcdGZvciAoa2V5IGluIGdldGRhdGEpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGdldGRhdGEuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRubSA9IGRyb3Btb2RlbFtqXS5uYW1lO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiggIShubSA9PT0gJ2NiJyB8fCBubSA9PT0gJ3JuJyB8fCBubSA9PT0gJ3N1YmdyaWQnICkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZihnZXRkYXRhLmhhc093blByb3BlcnR5KGtleSkgJiYgZHJvcG1vZGVsW2pdKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0bXBkYXRhW25tXSA9IGdldGRhdGFba2V5XTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0aisrO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0Z2V0ZGF0YSA9IHRtcGRhdGE7XHJcblx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR1aS5oZWxwZXIuZHJvcHBlZCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdGlmKG9wdHMuYmVmb3JlZHJvcCAmJiAkLmlzRnVuY3Rpb24ob3B0cy5iZWZvcmVkcm9wKSApIHtcclxuXHRcdFx0XHRcdFx0XHQvL3BhcmFtZXRlcnMgdG8gdGhpcyBjYWxsYmFjayAtIGV2ZW50LCBlbGVtZW50LCBkYXRhIHRvIGJlIGluc2VydGVkLCBzZW5kZXIsIHJlY2lldmVyXHJcblx0XHRcdFx0XHRcdFx0Ly8gc2hvdWxkIHJldHVybiBvYmplY3Qgd2hpY2ggd2lsbCBiZSBpbnNlcnRlZCBpbnRvIHRoZSByZWNpZXZlclxyXG5cdFx0XHRcdFx0XHRcdHZhciBkYXRhdG9pbnNlcnQgPSBvcHRzLmJlZm9yZWRyb3AuY2FsbCh0aGlzLGV2LHVpLGdldGRhdGEsJCgnIycrJC5qZ3JpZC5qcUlEKCR0LnAuaWQpKSwkKHRoaXMpKTtcclxuXHRcdFx0XHRcdFx0XHRpZiAoZGF0YXRvaW5zZXJ0ICE9PSB1bmRlZmluZWQgJiYgZGF0YXRvaW5zZXJ0ICE9PSBudWxsICYmIHR5cGVvZiBkYXRhdG9pbnNlcnQgPT09IFwib2JqZWN0XCIpIHsgZ2V0ZGF0YSA9IGRhdGF0b2luc2VydDsgfVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmKHVpLmhlbHBlci5kcm9wcGVkKSB7XHJcblx0XHRcdFx0XHRcdFx0dmFyIGdyaWQ7XHJcblx0XHRcdFx0XHRcdFx0aWYob3B0cy5hdXRvaWQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKCQuaXNGdW5jdGlvbihvcHRzLmF1dG9pZCkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Z3JpZCA9IG9wdHMuYXV0b2lkLmNhbGwodGhpcyxnZXRkYXRhKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGdyaWQgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSoxMDAwKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Z3JpZCA9IG9wdHMuYXV0b2lkcHJlZml4K2dyaWQ7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdC8vIE5VTEwgaXMgaW50ZXJwcmV0ZWQgYXMgdW5kZWZpbmVkIHdoaWxlIG51bGwgYXMgb2JqZWN0XHJcblx0XHRcdFx0XHRcdFx0JChcIiNcIiskLmpncmlkLmpxSUQodGhpcy5pZCkpLmpxR3JpZCgnYWRkUm93RGF0YScsZ3JpZCxnZXRkYXRhLG9wdHMuZHJvcHBvcyk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYob3B0cy5vbmRyb3AgJiYgJC5pc0Z1bmN0aW9uKG9wdHMub25kcm9wKSApIHsgb3B0cy5vbmRyb3AuY2FsbCh0aGlzLGV2LHVpLCBnZXRkYXRhKTsgfVxyXG5cdFx0XHRcdFx0fX0sIG9wdHMuZHJvcF9vcHRzIHx8IHt9KTtcclxuXHRcdFx0fSxcclxuXHRcdFx0XCJvbnN0YXJ0XCIgOiBudWxsLFxyXG5cdFx0XHRcIm9uc3RvcFwiIDogbnVsbCxcclxuXHRcdFx0XCJiZWZvcmVkcm9wXCI6IG51bGwsXHJcblx0XHRcdFwib25kcm9wXCIgOiBudWxsLFxyXG5cdFx0XHRcImRyb3Bfb3B0c1wiIDoge1xyXG5cdFx0XHRcdFwiYWN0aXZlQ2xhc3NcIjogXCJ1aS1zdGF0ZS1hY3RpdmVcIixcclxuXHRcdFx0XHRcImhvdmVyQ2xhc3NcIjogXCJ1aS1zdGF0ZS1ob3ZlclwiXHJcblx0XHRcdH0sXHJcblx0XHRcdFwiZHJhZ19vcHRzXCIgOiB7XHJcblx0XHRcdFx0XCJyZXZlcnRcIjogXCJpbnZhbGlkXCIsXHJcblx0XHRcdFx0XCJoZWxwZXJcIjogXCJjbG9uZVwiLFxyXG5cdFx0XHRcdFwiY3Vyc29yXCI6IFwibW92ZVwiLFxyXG5cdFx0XHRcdFwiYXBwZW5kVG9cIiA6IFwiI2pxZ3JpZF9kbmRcIixcclxuXHRcdFx0XHRcInpJbmRleFwiOiA1MDAwXHJcblx0XHRcdH0sXHJcblx0XHRcdFwiZHJhZ2NvcHlcIjogZmFsc2UsXHJcblx0XHRcdFwiZHJvcGJ5bmFtZVwiIDogZmFsc2UsXHJcblx0XHRcdFwiZHJvcHBvc1wiIDogXCJmaXJzdFwiLFxyXG5cdFx0XHRcImF1dG9pZFwiIDogdHJ1ZSxcclxuXHRcdFx0XCJhdXRvaWRwcmVmaXhcIiA6IFwiZG5kX1wiXHJcblx0XHR9LCBvcHRzIHx8IHt9KTtcclxuXHJcblx0XHRpZighb3B0cy5jb25uZWN0V2l0aCkgeyByZXR1cm47IH1cclxuXHRcdG9wdHMuY29ubmVjdFdpdGggPSBvcHRzLmNvbm5lY3RXaXRoLnNwbGl0KFwiLFwiKTtcclxuXHRcdG9wdHMuY29ubmVjdFdpdGggPSAkLm1hcChvcHRzLmNvbm5lY3RXaXRoLGZ1bmN0aW9uKG4pe3JldHVybiAkLnRyaW0obik7fSk7XHJcblx0XHQkLmRhdGEoJHQsXCJkbmRcIixvcHRzKTtcclxuXHJcblx0XHRpZigkdC5wLnJlY2NvdW50ICE9PSAwICYmICEkdC5wLmpxZ2RuZCkge1xyXG5cdFx0XHR1cGRhdGVEbkQoKTtcclxuXHRcdH1cclxuXHRcdCR0LnAuanFnZG5kID0gdHJ1ZTtcclxuXHRcdGZvciAoaT0wO2k8b3B0cy5jb25uZWN0V2l0aC5sZW5ndGg7aSsrKXtcclxuXHRcdFx0Y24gPW9wdHMuY29ubmVjdFdpdGhbaV07XHJcblx0XHRcdCQoY24pLmRyb3BwYWJsZSgkLmlzRnVuY3Rpb24ob3B0cy5kcm9wKSA/IG9wdHMuZHJvcC5jYWxsKCQoJHQpLG9wdHMpIDogb3B0cy5kcm9wKTtcclxuXHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0Z3JpZFJlc2l6ZSA6IGZ1bmN0aW9uKG9wdHMpIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyICR0ID0gdGhpcywgZ0lEID0gJC5qZ3JpZC5qcUlEKCR0LnAuaWQpO1xyXG5cdFx0XHRpZighJHQuZ3JpZCB8fCAhJC5mbi5yZXNpemFibGUpIHsgcmV0dXJuOyB9XHJcblx0XHRcdG9wdHMgPSAkLmV4dGVuZCh7fSwgb3B0cyB8fCB7fSk7XHJcblx0XHRcdGlmKG9wdHMuYWxzb1Jlc2l6ZSApIHtcclxuXHRcdFx0XHRvcHRzLl9hbHNvUmVzaXplXyA9IG9wdHMuYWxzb1Jlc2l6ZTtcclxuXHRcdFx0XHRkZWxldGUgb3B0cy5hbHNvUmVzaXplO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdG9wdHMuX2Fsc29SZXNpemVfID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYob3B0cy5zdG9wICYmICQuaXNGdW5jdGlvbihvcHRzLnN0b3ApKSB7XHJcblx0XHRcdFx0b3B0cy5fc3RvcF8gPSBvcHRzLnN0b3A7XHJcblx0XHRcdFx0ZGVsZXRlIG9wdHMuc3RvcDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRvcHRzLl9zdG9wXyA9IGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHRcdG9wdHMuc3RvcCA9IGZ1bmN0aW9uIChldiwgdWkpIHtcclxuXHRcdFx0XHQkKCR0KS5qcUdyaWQoJ3NldEdyaWRQYXJhbScse2hlaWdodDokKFwiI2d2aWV3X1wiK2dJRCtcIiAudWktanFncmlkLWJkaXZcIikuaGVpZ2h0KCl9KTtcclxuXHRcdFx0XHQkKCR0KS5qcUdyaWQoJ3NldEdyaWRXaWR0aCcsdWkuc2l6ZS53aWR0aCxvcHRzLnNocmlua1RvRml0KTtcclxuXHRcdFx0XHRpZihvcHRzLl9zdG9wXykgeyBvcHRzLl9zdG9wXy5jYWxsKCR0LGV2LHVpKTsgfVxyXG5cdFx0XHR9O1xyXG5cdFx0XHRpZihvcHRzLl9hbHNvUmVzaXplXykge1xyXG5cdFx0XHRcdHZhciBvcHRzdGVzdCA9IFwie1xcJyNndmlld19cIitnSUQrXCIgLnVpLWpxZ3JpZC1iZGl2XFwnOnRydWUsJ1wiICtvcHRzLl9hbHNvUmVzaXplXytcIic6dHJ1ZX1cIjtcclxuXHRcdFx0XHRvcHRzLmFsc29SZXNpemUgPSBldmFsKCcoJytvcHRzdGVzdCsnKScpOyAvLyB0aGUgb25seSB3YXkgdGhhdCBJIGZvdW5kIHRvIGRvIHRoaXNcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRvcHRzLmFsc29SZXNpemUgPSAkKFwiLnVpLWpxZ3JpZC1iZGl2XCIsXCIjZ3ZpZXdfXCIrZ0lEKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRkZWxldGUgb3B0cy5fYWxzb1Jlc2l6ZV87XHJcblx0XHRcdCQoXCIjZ2JveF9cIitnSUQpLnJlc2l6YWJsZShvcHRzKTtcclxuXHRcdH0pO1xyXG5cdH1cclxufSk7XHJcbn0pKGpRdWVyeSk7XHJcbi8qXHJcbiBUcmFuc2Zvcm0gYSB0YWJsZSB0byBhIGpxR3JpZC5cclxuIFBldGVyIFJvbWlhbm93c2tpIDxwZXRlci5yb21pYW5vd3NraUBvcHRpdm8uZGU+XHJcbiBJZiB0aGUgZmlyc3QgY29sdW1uIG9mIHRoZSB0YWJsZSBjb250YWlucyBjaGVja2JveGVzIG9yXHJcbiByYWRpb2J1dHRvbnMgdGhlbiB0aGUganFHcmlkIGlzIG1hZGUgc2VsZWN0YWJsZS5cclxuKi9cclxuLy8gQWRkaXRpb24gLSBzZWxlY3RvciBjYW4gYmUgYSBjbGFzcyBvciBpZFxyXG5mdW5jdGlvbiB0YWJsZVRvR3JpZChzZWxlY3Rvciwgb3B0aW9ucykge1xyXG5qUXVlcnkoc2VsZWN0b3IpLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0aWYodGhpcy5ncmlkKSB7cmV0dXJuO30gLy9BZGVkZCBmcm9tIFRvbnkgVG9tb3ZcclxuXHQvLyBUaGlzIGlzIGEgc21hbGwgXCJoYWNrXCIgdG8gbWFrZSB0aGUgd2lkdGggb2YgdGhlIGpxR3JpZCAxMDAlXHJcblx0alF1ZXJ5KHRoaXMpLndpZHRoKFwiOTklXCIpO1xyXG5cdHZhciB3ID0galF1ZXJ5KHRoaXMpLndpZHRoKCk7XHJcblxyXG5cdC8vIFRleHQgd2hldGhlciB3ZSBoYXZlIHNpbmdsZSBvciBtdWx0aSBzZWxlY3RcclxuXHR2YXIgaW5wdXRDaGVja2JveCA9IGpRdWVyeSgndHIgdGQ6Zmlyc3QtY2hpbGQgaW5wdXRbdHlwZT1jaGVja2JveF06Zmlyc3QnLCBqUXVlcnkodGhpcykpO1xyXG5cdHZhciBpbnB1dFJhZGlvID0galF1ZXJ5KCd0ciB0ZDpmaXJzdC1jaGlsZCBpbnB1dFt0eXBlPXJhZGlvXTpmaXJzdCcsIGpRdWVyeSh0aGlzKSk7XHJcblx0dmFyIHNlbGVjdE11bHRpcGxlID0gaW5wdXRDaGVja2JveC5sZW5ndGggPiAwO1xyXG5cdHZhciBzZWxlY3RTaW5nbGUgPSAhc2VsZWN0TXVsdGlwbGUgJiYgaW5wdXRSYWRpby5sZW5ndGggPiAwO1xyXG5cdHZhciBzZWxlY3RhYmxlID0gc2VsZWN0TXVsdGlwbGUgfHwgc2VsZWN0U2luZ2xlO1xyXG5cdC8vdmFyIGlucHV0TmFtZSA9IGlucHV0Q2hlY2tib3guYXR0cihcIm5hbWVcIikgfHwgaW5wdXRSYWRpby5hdHRyKFwibmFtZVwiKTtcclxuXHJcblx0Ly8gQnVpbGQgdXAgdGhlIGNvbHVtbk1vZGVsIGFuZCB0aGUgZGF0YVxyXG5cdHZhciBjb2xNb2RlbCA9IFtdO1xyXG5cdHZhciBjb2xOYW1lcyA9IFtdO1xyXG5cdGpRdWVyeSgndGgnLCBqUXVlcnkodGhpcykpLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRpZiAoY29sTW9kZWwubGVuZ3RoID09PSAwICYmIHNlbGVjdGFibGUpIHtcclxuXHRcdFx0Y29sTW9kZWwucHVzaCh7XHJcblx0XHRcdFx0bmFtZTogJ19fc2VsZWN0aW9uX18nLFxyXG5cdFx0XHRcdGluZGV4OiAnX19zZWxlY3Rpb25fXycsXHJcblx0XHRcdFx0d2lkdGg6IDAsXHJcblx0XHRcdFx0aGlkZGVuOiB0cnVlXHJcblx0XHRcdH0pO1xyXG5cdFx0XHRjb2xOYW1lcy5wdXNoKCdfX3NlbGVjdGlvbl9fJyk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRjb2xNb2RlbC5wdXNoKHtcclxuXHRcdFx0XHRuYW1lOiBqUXVlcnkodGhpcykuYXR0cihcImlkXCIpIHx8IGpRdWVyeS50cmltKGpRdWVyeS5qZ3JpZC5zdHJpcEh0bWwoalF1ZXJ5KHRoaXMpLmh0bWwoKSkpLnNwbGl0KCcgJykuam9pbignXycpLFxyXG5cdFx0XHRcdGluZGV4OiBqUXVlcnkodGhpcykuYXR0cihcImlkXCIpIHx8IGpRdWVyeS50cmltKGpRdWVyeS5qZ3JpZC5zdHJpcEh0bWwoalF1ZXJ5KHRoaXMpLmh0bWwoKSkpLnNwbGl0KCcgJykuam9pbignXycpLFxyXG5cdFx0XHRcdHdpZHRoOiBqUXVlcnkodGhpcykud2lkdGgoKSB8fCAxNTBcclxuXHRcdFx0fSk7XHJcblx0XHRcdGNvbE5hbWVzLnB1c2goalF1ZXJ5KHRoaXMpLmh0bWwoKSk7XHJcblx0XHR9XHJcblx0fSk7XHJcblx0dmFyIGRhdGEgPSBbXTtcclxuXHR2YXIgcm93SWRzID0gW107XHJcblx0dmFyIHJvd0NoZWNrZWQgPSBbXTtcclxuXHRqUXVlcnkoJ3Rib2R5ID4gdHInLCBqUXVlcnkodGhpcykpLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgcm93ID0ge307XHJcblx0XHR2YXIgcm93UG9zID0gMDtcclxuXHRcdGpRdWVyeSgndGQnLCBqUXVlcnkodGhpcykpLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmIChyb3dQb3MgPT09IDAgJiYgc2VsZWN0YWJsZSkge1xyXG5cdFx0XHRcdHZhciBpbnB1dCA9IGpRdWVyeSgnaW5wdXQnLCBqUXVlcnkodGhpcykpO1xyXG5cdFx0XHRcdHZhciByb3dJZCA9IGlucHV0LmF0dHIoXCJ2YWx1ZVwiKTtcclxuXHRcdFx0XHRyb3dJZHMucHVzaChyb3dJZCB8fCBkYXRhLmxlbmd0aCk7XHJcblx0XHRcdFx0aWYgKGlucHV0LmlzKFwiOmNoZWNrZWRcIikpIHtcclxuXHRcdFx0XHRcdHJvd0NoZWNrZWQucHVzaChyb3dJZCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJvd1tjb2xNb2RlbFtyb3dQb3NdLm5hbWVdID0gaW5wdXQuYXR0cihcInZhbHVlXCIpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHJvd1tjb2xNb2RlbFtyb3dQb3NdLm5hbWVdID0galF1ZXJ5KHRoaXMpLmh0bWwoKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyb3dQb3MrKztcclxuXHRcdH0pO1xyXG5cdFx0aWYocm93UG9zID4wKSB7IGRhdGEucHVzaChyb3cpOyB9XHJcblx0fSk7XHJcblxyXG5cdC8vIENsZWFyIHRoZSBvcmlnaW5hbCBIVE1MIHRhYmxlXHJcblx0alF1ZXJ5KHRoaXMpLmVtcHR5KCk7XHJcblxyXG5cdC8vIE1hcmsgaXQgYXMganFHcmlkXHJcblx0alF1ZXJ5KHRoaXMpLmFkZENsYXNzKFwic2Nyb2xsXCIpO1xyXG5cclxuXHRqUXVlcnkodGhpcykuanFHcmlkKGpRdWVyeS5leHRlbmQoe1xyXG5cdFx0ZGF0YXR5cGU6IFwibG9jYWxcIixcclxuXHRcdHdpZHRoOiB3LFxyXG5cdFx0Y29sTmFtZXM6IGNvbE5hbWVzLFxyXG5cdFx0Y29sTW9kZWw6IGNvbE1vZGVsLFxyXG5cdFx0bXVsdGlzZWxlY3Q6IHNlbGVjdE11bHRpcGxlXHJcblx0XHQvL2lucHV0TmFtZTogaW5wdXROYW1lLFxyXG5cdFx0Ly9pbnB1dFZhbHVlQ29sOiBpbXB1dE5hbWUgIT0gbnVsbCA/IFwiX19zZWxlY3Rpb25fX1wiIDogbnVsbFxyXG5cdH0sIG9wdGlvbnMgfHwge30pKTtcclxuXHJcblx0Ly8gQWRkIGRhdGFcclxuXHR2YXIgYTtcclxuXHRmb3IgKGEgPSAwOyBhIDwgZGF0YS5sZW5ndGg7IGErKykge1xyXG5cdFx0dmFyIGlkID0gbnVsbDtcclxuXHRcdGlmIChyb3dJZHMubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRpZCA9IHJvd0lkc1thXTtcclxuXHRcdFx0aWYgKGlkICYmIGlkLnJlcGxhY2UpIHtcclxuXHRcdFx0XHQvLyBXZSBoYXZlIHRvIGRvIHRoaXMgc2luY2UgdGhlIHZhbHVlIG9mIGEgY2hlY2tib3hcclxuXHRcdFx0XHQvLyBvciByYWRpbyBidXR0b24gY2FuIGJlIGFueXRoaW5nXHJcblx0XHRcdFx0aWQgPSBlbmNvZGVVUklDb21wb25lbnQoaWQpLnJlcGxhY2UoL1suXFwtJV0vZywgXCJfXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAoaWQgPT09IG51bGwpIHtcclxuXHRcdFx0aWQgPSBhICsgMTtcclxuXHRcdH1cclxuXHRcdGpRdWVyeSh0aGlzKS5qcUdyaWQoXCJhZGRSb3dEYXRhXCIsaWQsIGRhdGFbYV0pO1xyXG5cdH1cclxuXHJcblx0Ly8gU2V0IHRoZSBzZWxlY3Rpb25cclxuXHRmb3IgKGEgPSAwOyBhIDwgcm93Q2hlY2tlZC5sZW5ndGg7IGErKykge1xyXG5cdFx0alF1ZXJ5KHRoaXMpLmpxR3JpZChcInNldFNlbGVjdGlvblwiLHJvd0NoZWNrZWRbYV0pO1xyXG5cdH1cclxufSk7XHJcbn07XHJcbi8qanNoaW50IGVxZXFlcTpmYWxzZSAqL1xyXG4vKmdsb2JhbCBqUXVlcnkgKi9cclxuKGZ1bmN0aW9uKCQpe1xyXG4vKipcclxuICoganFHcmlkIHBpdm90IGZ1bmN0aW9uc1xyXG4gKiBUb255IFRvbW92IHRvbnlAdHJpcmFuZC5jb21cclxuICogaHR0cDovL3RyaXJhbmQuY29tL2Jsb2cvXHJcbiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBhbmQgR1BMIGxpY2Vuc2VzOlxyXG4gKiBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxyXG4gKiBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvZ3BsLTIuMC5odG1sXHJcbiovXHJcblwidXNlIHN0cmljdFwiO1xyXG4vLyBUbyBvcHRpbWl6ZSB0aGUgc2VhcmNoIHdlIG5lZWQgY3VzdG9tIGFycmF5IGZpbHRlclxyXG4vLyBUaGlzIGNvZGUgaXMgdGFrZW4gZnJvbVxyXG4vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9BcnJheS9maWx0ZXJcclxuXHJcbmZ1bmN0aW9uIF9waXZvdGZpbHRlciAoZm4sIGNvbnRleHQpIHtcclxuXHR2YXIgaSxcclxuXHRcdHZhbHVlLFxyXG5cdFx0cmVzdWx0ID0gW10sXHJcblx0XHRsZW5ndGg7XHJcblxyXG5cdGlmICghdGhpcyB8fCB0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicgfHwgKGZuIGluc3RhbmNlb2YgUmVnRXhwKSkge1xyXG5cdFx0dGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG5cdH1cclxuXHJcblx0bGVuZ3RoID0gdGhpcy5sZW5ndGg7XHJcblxyXG5cdGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG5cdFx0aWYgKHRoaXMuaGFzT3duUHJvcGVydHkoaSkpIHtcclxuXHRcdFx0dmFsdWUgPSB0aGlzW2ldO1xyXG5cdFx0XHRpZiAoZm4uY2FsbChjb250ZXh0LCB2YWx1ZSwgaSwgdGhpcykpIHtcclxuXHRcdFx0XHRyZXN1bHQucHVzaCh2YWx1ZSk7XHJcblx0XHRcdFx0Ly8gV2UgbmVlZCBicmVhayBpbiBvcmRlciB0byBjYW5jZWwgbG9vcFxyXG5cdFx0XHRcdC8vIGluIGNhc2UgdGhlIHJvdyBpcyBmb3VuZFxyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiByZXN1bHQ7XHJcbn1cclxuJC5hc3NvY0FycmF5U2l6ZSA9IGZ1bmN0aW9uKG9iaikge1xyXG4gICAgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNjcwMC8xMTIzNlxyXG4gICAgdmFyIHNpemUgPSAwLCBrZXk7XHJcbiAgICBmb3IgKGtleSBpbiBvYmopIHtcclxuICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICBcdHNpemUrKztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc2l6ZTtcclxufTtcclxuXHJcbiQuamdyaWQuZXh0ZW5kKHtcclxuXHRwaXZvdFNldHVwIDogZnVuY3Rpb24oIGRhdGEsIG9wdGlvbnMgKXtcclxuXHRcdC8vIGRhdGEgc2hvdWxkIGNvbWUgaW4ganNvbiBmb3JtYXRcclxuXHRcdC8vIFRoZSBmdW5jdGlvbiByZXR1cm4gdGhlIG5ldyBjb2xNb2RlbCBhbmQgdGhlIHRyYW5zZm9ybWVkIGRhdGFcclxuXHRcdC8vIGFnYWluIHdpdGggZ3JvdXAgc2V0dXAgb3B0aW9ucyB3aGljaCB0aGVuIHdpbGwgYmUgcGFzc2VkIHRvIHRoZSBncmlkXHJcblx0XHR2YXIgY29sdW1ucyA9W10sXHJcblx0XHRwaXZvdHJvd3MgPVtdLFxyXG5cdFx0c3VtbWFyaWVzID0gW10sXHJcblx0XHRtZW1iZXI9W10sXHJcblx0XHRncm91cE9wdGlvbnMgPSB7XHJcblx0XHRcdGdyb3VwaW5nIDogdHJ1ZSxcclxuXHRcdFx0Z3JvdXBpbmdWaWV3IDogIHtcclxuXHRcdFx0XHRncm91cEZpZWxkIDogW10sXHJcblx0XHRcdFx0Z3JvdXBTdW1tYXJ5OiBbXSxcclxuXHRcdFx0XHRncm91cFN1bW1hcnlQb3M6W11cclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdGhlYWRlcnMgPSBbXSxcclxuXHRcdG8gPSAkLmV4dGVuZCAoIHtcclxuXHRcdFx0cm93VG90YWxzIDogZmFsc2UsXHJcblx0XHRcdHJvd1RvdGFsc1RleHQgOiAnVG90YWwnLFxyXG5cdFx0XHQvLyBzdW1tYXJ5IGNvbHVtbnNcclxuXHRcdFx0Y29sVG90YWxzIDogZmFsc2UsXHJcblx0XHRcdGdyb3VwU3VtbWFyeSA6IHRydWUsXHJcblx0XHRcdGdyb3VwU3VtbWFyeVBvcyA6ICAnaGVhZGVyJyxcclxuXHRcdFx0ZnJvemVuU3RhdGljQ29scyA6IGZhbHNlXHJcblx0XHR9LCBvcHRpb25zIHx8IHt9KTtcclxuXHRcdHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cclxuXHRcdFx0dmFyXHJcblx0XHRcdFx0cm93LFxyXG5cdFx0XHRcdHJvd2luZGV4LFxyXG5cdFx0XHRcdGksXHJcblxyXG5cdFx0XHRcdHJvd2xlbiA9IGRhdGEubGVuZ3RoLFxyXG5cdFx0XHRcdHhsZW4sIHlsZW4sIGFnZ3JsZW4sXHJcblx0XHRcdFx0dG1wLFxyXG5cdFx0XHRcdG5ld09iaixcclxuXHRcdFx0XHRyPTA7XHJcblx0XHRcdC8vIHV0aWxpdHkgZnVuY3NcclxuXHRcdFx0LypcclxuXHRcdFx0ICogRmlsdGVyIHRoZSBkYXRhIHRvIGEgZ2l2ZW4gY3JpdGVyaWEuIFJldHVybiB0aGUgZmlydCBvY2N1cmFuY2VcclxuXHRcdFx0ICovXHJcblx0XHRcdGZ1bmN0aW9uIGZpbmQoYXIsIGZ1biwgZXh0cmEpIHtcclxuXHRcdFx0XHR2YXIgcmVzO1xyXG5cdFx0XHRcdHJlcyA9IF9waXZvdGZpbHRlci5jYWxsKGFyLCBmdW4sIGV4dHJhKTtcclxuXHRcdFx0XHRyZXR1cm4gcmVzLmxlbmd0aCA+IDAgPyByZXNbMF0gOiBudWxsO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8qXHJcblx0XHRcdCAqIENoZWNrIGlmIHRoZSBncm91cGVkIHJvdyBjb2x1bW4gZXhpc3QgKFNlZSBmaW5kKVxyXG5cdFx0XHQgKiBJZiB0aGUgcm93IGlzIG5vdCBmaW5kIGluIHBpdm90IHJvd3MgcmV0dW4gbnVsbCxcclxuXHRcdFx0ICogb3RoZXJ2aWVzZSB0aGUgY29sdW1uXHJcblx0XHRcdCAqL1xyXG5cdFx0XHRmdW5jdGlvbiBmaW5kR3JvdXAoaXRlbSwgaW5kZXgpIHtcclxuXHRcdFx0XHR2YXIgaiA9IDAsIHJldCA9IHRydWUsIGk7XHJcblx0XHRcdFx0Zm9yKGkgaW4gaXRlbSkge1xyXG5cdFx0XHRcdFx0aWYoaXRlbVtpXSAhPSB0aGlzW2pdKSB7XHJcblx0XHRcdFx0XHRcdHJldCA9ICBmYWxzZTtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRqKys7XHJcblx0XHRcdFx0XHRpZihqPj10aGlzLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYocmV0KSB7XHJcblx0XHRcdFx0XHRyb3dpbmRleCA9ICBpbmRleDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIHJldDtcclxuXHRcdFx0fVxyXG5cdFx0XHQvKlxyXG5cdFx0XHQgKiBQZXJmb3JtIGNhbGN1bGF0aW9ucyBvZiB0aGUgcGl2b3QgdmFsdWVzLlxyXG5cdFx0XHQgKi9cclxuXHRcdFx0ZnVuY3Rpb24gY2FsY3VsYXRpb24ob3BlciwgdiwgZmllbGQsIHJjKSAge1xyXG5cdFx0XHRcdHZhciByZXQ7XHJcblx0XHRcdFx0c3dpdGNoIChvcGVyKSB7XHJcblx0XHRcdFx0XHRjYXNlICBcInN1bVwiIDpcclxuXHRcdFx0XHRcdFx0cmV0ID0gcGFyc2VGbG9hdCh2fHwwKSArIHBhcnNlRmxvYXQoKHJjW2ZpZWxkXXx8MCkpO1xyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgXCJjb3VudFwiIDpcclxuXHRcdFx0XHRcdFx0aWYodj09PVwiXCIgfHwgdiA9PSBudWxsKSB7XHJcblx0XHRcdFx0XHRcdFx0dj0wO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmKHJjLmhhc093blByb3BlcnR5KGZpZWxkKSkge1xyXG5cdFx0XHRcdFx0XHRcdHJldCA9IHYrMTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRyZXQgPSAwO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSBcIm1pblwiIDpcclxuXHRcdFx0XHRcdFx0aWYodj09PVwiXCIgfHwgdiA9PSBudWxsKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0ID0gcGFyc2VGbG9hdChyY1tmaWVsZF18fDApO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHJldCA9TWF0aC5taW4ocGFyc2VGbG9hdCh2KSxwYXJzZUZsb2F0KHJjW2ZpZWxkXXx8MCkpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSBcIm1heFwiIDpcclxuXHRcdFx0XHRcdFx0aWYodj09PVwiXCIgfHwgdiA9PSBudWxsKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0ID0gcGFyc2VGbG9hdChyY1tmaWVsZF18fDApO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHJldCA9IE1hdGgubWF4KHBhcnNlRmxvYXQodikscGFyc2VGbG9hdChyY1tmaWVsZF18fDApKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIHJldDtcclxuXHRcdFx0fVxyXG5cdFx0XHQvKlxyXG5cdFx0XHQgKiBUaGUgZnVuY3Rpb24gYWdyYWdhdGVzIHRoZSB2YWx1ZXMgb2YgdGhlIHBpdm90IGdyaWQuXHJcblx0XHRcdCAqIFJldHVybiB0aGUgY3VycmVudCByb3cgd2l0aCBwaXZvdCBzdW1tYXJ5IHZhbHVlc1xyXG5cdFx0XHQgKi9cclxuXHRcdFx0ZnVuY3Rpb24gYWdyZWdhdGVGdW5jICggcm93LCBhZ2dyLCB2YWx1ZSwgY3Vycikge1xyXG5cdFx0XHRcdC8vIGRlZmF1bHQgaXMgc3VtXHJcblx0XHRcdFx0dmFyIGFycmxuID0gYWdnci5sZW5ndGgsIGksIGxhYmVsLCBqLCBqdjtcclxuXHRcdFx0XHRpZigkLmlzQXJyYXkodmFsdWUpKSB7XHJcblx0XHRcdFx0XHRqdiA9IHZhbHVlLmxlbmd0aDtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0anYgPSAxO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRtZW1iZXIgPSBbXTtcclxuXHRcdFx0XHRtZW1iZXIucm9vdCA9IDA7XHJcblx0XHRcdFx0Zm9yKGo9MDtqPGp2O2orKykge1xyXG5cdFx0XHRcdFx0dmFyICB0bXBtZW1iZXIgPSBbXSwgdmw7XHJcblx0XHRcdFx0XHRmb3IoaT0wOyBpIDwgYXJybG47IGkrKykge1xyXG5cdFx0XHRcdFx0XHRpZih2YWx1ZSA9PSBudWxsKSB7XHJcblx0XHRcdFx0XHRcdFx0bGFiZWwgPSAkLnRyaW0oYWdncltpXS5tZW1iZXIpK1wiX1wiK2FnZ3JbaV0uYWdncmVnYXRvcjtcclxuXHRcdFx0XHRcdFx0XHR2bCA9IGxhYmVsO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHZsID0gdmFsdWVbal0ucmVwbGFjZSgvXFxzKy9nLCAnJyk7XHJcblx0XHRcdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0XHRcdGxhYmVsID0gKGFycmxuID09PSAxID8gdmwgOiB2bCtcIl9cIithZ2dyW2ldLmFnZ3JlZ2F0b3IrXCJfXCIraSk7XHJcblx0XHRcdFx0XHRcdFx0fSBjYXRjaChlKSB7fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGN1cnJbbGFiZWxdID0gIHRtcG1lbWJlcltsYWJlbF0gPSBjYWxjdWxhdGlvbiggYWdncltpXS5hZ2dyZWdhdG9yLCBjdXJyW2xhYmVsXSwgYWdncltpXS5tZW1iZXIsIHJvdyk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRtZW1iZXJbdmxdID0gdG1wbWVtYmVyO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gY3VycjtcclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBNYWtpbmcgdGhlIHJvdyB0b3RhbHMgd2l0aG91dCB0byBhZGQgaW4geURpbWVuc2lvblxyXG5cdFx0XHRpZihvLnJvd1RvdGFscyAmJiBvLnlEaW1lbnNpb24ubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdHZhciBkbiA9IG8ueURpbWVuc2lvblswXS5kYXRhTmFtZTtcclxuXHRcdFx0XHRvLnlEaW1lbnNpb24uc3BsaWNlKDAsMCx7ZGF0YU5hbWU6ZG59KTtcclxuXHRcdFx0XHRvLnlEaW1lbnNpb25bMF0uY29udmVydGVyID0gIGZ1bmN0aW9uKCl7IHJldHVybiAnX3JfVG90YWxzJzsgfTtcclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBidWlsZCBpbml0aWFsIGNvbHVtbnMgKGNvbE1vZGVsKSBmcm9tIHhEaW1lbnNpb25cclxuXHRcdFx0eGxlbiA9ICQuaXNBcnJheShvLnhEaW1lbnNpb24pID8gby54RGltZW5zaW9uLmxlbmd0aCA6IDA7XHJcblx0XHRcdHlsZW4gPSBvLnlEaW1lbnNpb24ubGVuZ3RoO1xyXG5cdFx0XHRhZ2dybGVuICA9ICQuaXNBcnJheShvLmFnZ3JlZ2F0ZXMpID8gby5hZ2dyZWdhdGVzLmxlbmd0aCA6IDA7XHJcblx0XHRcdGlmKHhsZW4gPT09IDAgfHwgYWdncmxlbiA9PT0gMCkge1xyXG5cdFx0XHRcdHRocm93KFwieERpbWVuc2lvbiBvciBhZ2dyZWdhdGVzIG9wdGlvbmEgYXJlIG5vdCBzZXQhXCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciBjb2xjO1xyXG5cdFx0XHRmb3IoaSA9IDA7IGk8IHhsZW47IGkrKykge1xyXG5cdFx0XHRcdGNvbGMgPSB7bmFtZTpvLnhEaW1lbnNpb25baV0uZGF0YU5hbWUsIGZyb3plbjogby5mcm96ZW5TdGF0aWNDb2xzfTtcclxuXHRcdFx0XHRjb2xjID0gJC5leHRlbmQodHJ1ZSwgY29sYywgby54RGltZW5zaW9uW2ldKTtcclxuXHRcdFx0XHRjb2x1bW5zLnB1c2goIGNvbGMgKTtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgZ3JvdXBmaWVsZHMgPSB4bGVuIC0gMSwgdHJlZT17fTtcclxuXHRcdFx0Ly90cmVlID0geyB0ZXh0OiAncm9vdCcsIGxlYWY6IGZhbHNlLCBjaGlsZHJlbjogW10gfTtcclxuXHRcdFx0Ly9sb29wIG92ZXIgYWxsbCB0aGUgc291cmNlIGRhdGFcclxuXHRcdFx0d2hpbGUoIHIgPCByb3dsZW4gKSB7XHJcblx0XHRcdFx0cm93ID0gZGF0YVtyXTtcclxuXHRcdFx0XHR2YXIgeFZhbHVlID0gW107XHJcblx0XHRcdFx0dmFyIHlWYWx1ZSA9IFtdO1xyXG5cdFx0XHRcdHRtcCA9IHt9O1xyXG5cdFx0XHRcdGkgPSAwO1xyXG5cdFx0XHRcdC8vIGJ1aWxkIHRoZSBkYXRhIGZyb20geERpbWVuc2lvblxyXG5cdFx0XHRcdGRvIHtcclxuXHRcdFx0XHRcdHhWYWx1ZVtpXSAgPSAkLnRyaW0ocm93W28ueERpbWVuc2lvbltpXS5kYXRhTmFtZV0pO1xyXG5cdFx0XHRcdFx0dG1wW28ueERpbWVuc2lvbltpXS5kYXRhTmFtZV0gPSB4VmFsdWVbaV07XHJcblx0XHRcdFx0XHRpKys7XHJcblx0XHRcdFx0fSB3aGlsZSggaSA8IHhsZW4gKTtcclxuXHJcblx0XHRcdFx0dmFyIGsgPSAwO1xyXG5cdFx0XHRcdHJvd2luZGV4ID0gLTE7XHJcblx0XHRcdFx0Ly8gY2hlY2sgdG8gc2VlIGlmIHRoZSByb3cgaXMgaW4gb3VyIG5ldyBwaXZvdHJvdyBzZXRcclxuXHRcdFx0XHRuZXdPYmogPSBmaW5kKHBpdm90cm93cywgZmluZEdyb3VwLCB4VmFsdWUpO1xyXG5cdFx0XHRcdGlmKCFuZXdPYmopIHtcclxuXHRcdFx0XHRcdC8vIGlmIHRoZSByb3cgaXMgbm90IGluIG91ciBzZXRcclxuXHRcdFx0XHRcdGsgPSAwO1xyXG5cdFx0XHRcdFx0Ly8gaWYgeURpbWVuc2lvbiBpcyBzZXRcclxuXHRcdFx0XHRcdGlmKHlsZW4+PTEpIHtcclxuXHRcdFx0XHRcdFx0Ly8gYnVpbGQgdGhlIGNvbHMgc2V0IGluIHlEaW1lbnNpb25cclxuXHRcdFx0XHRcdFx0Zm9yKGs9MDtrPHlsZW47aysrKSB7XHJcblx0XHRcdFx0XHRcdFx0eVZhbHVlW2tdID0gJC50cmltKHJvd1tvLnlEaW1lbnNpb25ba10uZGF0YU5hbWVdKTtcclxuXHRcdFx0XHRcdFx0XHQvLyBDaGVjayB0byBzZWUgaWYgd2UgaGF2ZSB1c2VyIGRlZmluZWQgY29uZGl0aW9uc1xyXG5cdFx0XHRcdFx0XHRcdGlmKG8ueURpbWVuc2lvbltrXS5jb252ZXJ0ZXIgJiYgJC5pc0Z1bmN0aW9uKG8ueURpbWVuc2lvbltrXS5jb252ZXJ0ZXIpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR5VmFsdWVba10gPSBvLnlEaW1lbnNpb25ba10uY29udmVydGVyLmNhbGwodGhpcywgeVZhbHVlW2tdLCB4VmFsdWUsIHlWYWx1ZSk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdC8vIG1ha2UgdGhlIGNvbHVtcyBiYXNlZCBvbiBhZ2dyZWdhdGVzIGRlZmluaXRpb25cclxuXHRcdFx0XHRcdFx0Ly8gYW5kIHJldHVybiB0aGUgbWVtYmVycyBmb3IgbGF0ZSBjYWxjdWxhdGlvblxyXG5cdFx0XHRcdFx0XHR0bXAgPSBhZ3JlZ2F0ZUZ1bmMoIHJvdywgby5hZ2dyZWdhdGVzLCB5VmFsdWUsIHRtcCApO1xyXG5cdFx0XHRcdFx0fSBlbHNlICBpZiggeWxlbiA9PT0gMCApIHtcclxuXHRcdFx0XHRcdFx0Ly8gaWYgbm90IHNldCB1c2UgZGlyZWN0IHRoZSBhZ2dyZWdhdGVzXHJcblx0XHRcdFx0XHRcdHRtcCA9IGFncmVnYXRlRnVuYyggcm93LCBvLmFnZ3JlZ2F0ZXMsIG51bGwsIHRtcCApO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Ly8gYWRkIHRoZSByZXN1bHQgaW4gcGl2b3Qgcm93c1xyXG5cdFx0XHRcdFx0cGl2b3Ryb3dzLnB1c2goIHRtcCApO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQvLyB0aGUgcGl2b3QgZXhpc3RzXHJcblx0XHRcdFx0XHRpZiggcm93aW5kZXggPj0gMCkge1xyXG5cdFx0XHRcdFx0XHRrID0gMDtcclxuXHRcdFx0XHRcdFx0Ly8gbWFrZSB0aGUgcmVjYWxjdWxhdGlvbnNcclxuXHRcdFx0XHRcdFx0aWYoeWxlbj49MSkge1xyXG5cdFx0XHRcdFx0XHRcdGZvcihrPTA7azx5bGVuO2srKykge1xyXG5cdFx0XHRcdFx0XHRcdFx0eVZhbHVlW2tdID0gJC50cmltKHJvd1tvLnlEaW1lbnNpb25ba10uZGF0YU5hbWVdKTtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKG8ueURpbWVuc2lvbltrXS5jb252ZXJ0ZXIgJiYgJC5pc0Z1bmN0aW9uKG8ueURpbWVuc2lvbltrXS5jb252ZXJ0ZXIpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHlWYWx1ZVtrXSA9IG8ueURpbWVuc2lvbltrXS5jb252ZXJ0ZXIuY2FsbCh0aGlzLCB5VmFsdWVba10sIHhWYWx1ZSwgeVZhbHVlKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0bmV3T2JqID0gYWdyZWdhdGVGdW5jKCByb3csIG8uYWdncmVnYXRlcywgeVZhbHVlLCBuZXdPYmogKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlICBpZiggeWxlbiA9PT0gMCApIHtcclxuXHRcdFx0XHRcdFx0XHRuZXdPYmogPSBhZ3JlZ2F0ZUZ1bmMoIHJvdywgby5hZ2dyZWdhdGVzLCBudWxsLCBuZXdPYmogKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHQvLyB1cGRhdGUgdGhlIHJvd1xyXG5cdFx0XHRcdFx0XHRwaXZvdHJvd3Nbcm93aW5kZXhdID0gbmV3T2JqO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR2YXIga2o9MCwgY3VycmVudCA9IG51bGwsZXhpc3RpbmcgPSBudWxsLCBraztcclxuXHRcdFx0XHQvLyBCdWlsZCBhIEpTT04gdHJlZSBmcm9tIHRoZSBtZW1iZXIgKHNlZSBhZ2dyZWdhdGVGdW5jKVxyXG5cdFx0XHRcdC8vIHRvIG1ha2UgbGF0ZXIgdGhlIGNvbHVtbnNcclxuXHRcdFx0XHQvL1xyXG5cdFx0XHRcdGZvciAoa2sgaW4gbWVtYmVyKSB7XHJcblx0XHRcdFx0XHRpZihraiA9PT0gMCkge1xyXG5cdFx0XHRcdFx0XHRpZiAoIXRyZWUuY2hpbGRyZW58fHRyZWUuY2hpbGRyZW4gPT09IHVuZGVmaW5lZCl7XHJcblx0XHRcdFx0XHRcdFx0dHJlZSA9IHsgdGV4dDoga2ssIGxldmVsIDogMCwgY2hpbGRyZW46IFtdIH07XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0Y3VycmVudCA9IHRyZWUuY2hpbGRyZW47XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRleGlzdGluZyA9IG51bGw7XHJcblx0XHRcdFx0XHRcdGZvciAoaT0wOyBpIDwgY3VycmVudC5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdFx0XHRcdGlmIChjdXJyZW50W2ldLnRleHQgPT09IGtrKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQvL2N1cnJlbnRbaV0uZmllbGRzPW1lbWJlcltra107XHJcblx0XHRcdFx0XHRcdFx0XHRleGlzdGluZyA9IGN1cnJlbnRbaV07XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYgKGV4aXN0aW5nKSB7XHJcblx0XHRcdFx0XHRcdFx0Y3VycmVudCA9IGV4aXN0aW5nLmNoaWxkcmVuO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdGN1cnJlbnQucHVzaCh7IGNoaWxkcmVuOiBbXSwgdGV4dDoga2ssIGxldmVsOiBraiwgIGZpZWxkczogbWVtYmVyW2trXSB9KTtcclxuXHRcdFx0XHRcdFx0XHRjdXJyZW50ID0gY3VycmVudFtjdXJyZW50Lmxlbmd0aCAtIDFdLmNoaWxkcmVuO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRraisrO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyKys7XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyICBsYXN0dmFsPVtdLCBpbml0Q29sTGVuID0gY29sdW1ucy5sZW5ndGgsIHN3YXBsZW4gPSBpbml0Q29sTGVuO1xyXG5cdFx0XHRpZih5bGVuPjApIHtcclxuXHRcdFx0XHRoZWFkZXJzW3lsZW4tMV0gPSB7XHR1c2VDb2xTcGFuU3R5bGU6IGZhbHNlLFx0Z3JvdXBIZWFkZXJzOiBbXX07XHJcblx0XHRcdH1cclxuXHRcdFx0LypcclxuXHRcdFx0ICogUmVjdXJzaXZlIGZ1bmN0aW9uIHdoaWNoIHVzZXMgdGhlIHRyZWUgdG8gYnVpbGQgdGhlXHJcblx0XHRcdCAqIGNvbHVtbnMgZnJvbSB0aGUgcGl2b3QgdmFsdWVzIGFuZCBzZXQgdGhlIGdyb3VwIEhlYWRlcnNcclxuXHRcdFx0ICovXHJcblx0XHRcdGZ1bmN0aW9uIGxpc3QoaXRlbXMpIHtcclxuXHRcdFx0XHR2YXIgbCwgaiwga2V5LCBrLCBjb2w7XHJcblx0XHRcdFx0Zm9yIChrZXkgaW4gaXRlbXMpIHsgLy8gaXRlcmF0ZVxyXG5cdFx0XHRcdFx0aWYgKGl0ZW1zLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuXHRcdFx0XHRcdC8vIHdyaXRlIGFtb3VudCBvZiBzcGFjZXMgYWNjb3JkaW5nIHRvIGxldmVsXHJcblx0XHRcdFx0XHQvLyBhbmQgd3JpdGUgbmFtZSBhbmQgbmV3bGluZVxyXG5cdFx0XHRcdFx0XHRpZih0eXBlb2YgaXRlbXNba2V5XSAhPT0gXCJvYmplY3RcIikge1xyXG5cdFx0XHRcdFx0XHRcdC8vIElmIG5vdCBhIG9iamVjdCBidWlsZCB0aGUgaGVhZGVyIG9mIHRoZSBhcHByb3ByaWF0ZSBsZXZlbFxyXG5cdFx0XHRcdFx0XHRcdGlmKCBrZXkgPT09ICdsZXZlbCcpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKGxhc3R2YWxbaXRlbXMubGV2ZWxdID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0bGFzdHZhbFtpdGVtcy5sZXZlbF0gPScnO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZihpdGVtcy5sZXZlbD4wICYmIGl0ZW1zLnRleHQgIT09ICdfcl9Ub3RhbHMnKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aGVhZGVyc1tpdGVtcy5sZXZlbC0xXSA9IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHVzZUNvbFNwYW5TdHlsZTogZmFsc2UsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRncm91cEhlYWRlcnM6IFtdXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0aWYobGFzdHZhbFtpdGVtcy5sZXZlbF0gIT09IGl0ZW1zLnRleHQgJiYgaXRlbXMuY2hpbGRyZW4ubGVuZ3RoICYmIGl0ZW1zLnRleHQgIT09ICdfcl9Ub3RhbHMnKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKGl0ZW1zLmxldmVsPjApIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRoZWFkZXJzW2l0ZW1zLmxldmVsLTFdLmdyb3VwSGVhZGVycy5wdXNoKHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHRpdGxlVGV4dDogaXRlbXMudGV4dFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBjb2xsZW4gPSBoZWFkZXJzW2l0ZW1zLmxldmVsLTFdLmdyb3VwSGVhZGVycy5sZW5ndGgsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y29scG9zID0gY29sbGVuID09PSAxID8gc3dhcGxlbiA6IGluaXRDb2xMZW4rKGNvbGxlbi0xKSphZ2dybGVuO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGhlYWRlcnNbaXRlbXMubGV2ZWwtMV0uZ3JvdXBIZWFkZXJzW2NvbGxlbi0xXS5zdGFydENvbHVtbk5hbWUgPSBjb2x1bW5zW2NvbHBvc10ubmFtZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRoZWFkZXJzW2l0ZW1zLmxldmVsLTFdLmdyb3VwSGVhZGVyc1tjb2xsZW4tMV0ubnVtYmVyT2ZDb2x1bW5zID0gY29sdW1ucy5sZW5ndGggLSBjb2xwb3M7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aW5pdENvbExlbiA9IGNvbHVtbnMubGVuZ3RoO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRsYXN0dmFsW2l0ZW1zLmxldmVsXSA9IGl0ZW1zLnRleHQ7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdC8vIFRoaXMgaXMgaW4gY2FzZSB3aGVuIHRoZSBtZW1iZXIgY29udGFpbiBtb3JlIHRoYW4gb25lIHN1bW1hcnkgaXRlbVxyXG5cdFx0XHRcdFx0XHRcdGlmKGl0ZW1zLmxldmVsID09PSB5bGVuICAmJiBrZXk9PT0nbGV2ZWwnICYmIHlsZW4gPjApIHtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKCBhZ2dybGVuID4gMSl7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBsbD0xO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRmb3IoIGwgaW4gaXRlbXMuZmllbGRzKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYobGw9PT0xKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRoZWFkZXJzW3lsZW4tMV0uZ3JvdXBIZWFkZXJzLnB1c2goe3N0YXJ0Q29sdW1uTmFtZTogbCwgbnVtYmVyT2ZDb2x1bW5zOiAxLCB0aXRsZVRleHQ6IGl0ZW1zLnRleHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0bGwrKztcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRoZWFkZXJzW3lsZW4tMV0uZ3JvdXBIZWFkZXJzW2hlYWRlcnNbeWxlbi0xXS5ncm91cEhlYWRlcnMubGVuZ3RoLTFdLm51bWJlck9mQ29sdW1ucyA9IGxsLTE7XHJcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRoZWFkZXJzLnNwbGljZSh5bGVuLTEsMSk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdC8vIGlmIG9iamVjdCwgY2FsbCByZWN1cnNpdmVseVxyXG5cdFx0XHRcdFx0XHRpZiAoaXRlbXNba2V5XSAhPSBudWxsICYmIHR5cGVvZiBpdGVtc1trZXldID09PSBcIm9iamVjdFwiKSB7XHJcblx0XHRcdFx0XHRcdFx0bGlzdChpdGVtc1trZXldKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHQvLyBGaW5hbGx5IGJ1aWxkIHRoZSBjb3VsdW1uc1xyXG5cdFx0XHRcdFx0XHRpZigga2V5ID09PSAnbGV2ZWwnKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYoaXRlbXMubGV2ZWwgPjApe1xyXG5cdFx0XHRcdFx0XHRcdFx0aj0wO1xyXG5cdFx0XHRcdFx0XHRcdFx0Zm9yKGwgaW4gaXRlbXMuZmllbGRzKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGNvbCA9IHt9O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRmb3IoayBpbiBvLmFnZ3JlZ2F0ZXNbal0pIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZihvLmFnZ3JlZ2F0ZXNbal0uaGFzT3duUHJvcGVydHkoaykpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHN3aXRjaCggayApIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSAnbWVtYmVyJzpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSAnbGFiZWwnOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlICdhZ2dyZWdhdG9yJzpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZGVmYXVsdDpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjb2xba10gPSBvLmFnZ3JlZ2F0ZXNbal1ba107XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKGFnZ3JsZW4+MSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNvbC5uYW1lID0gbDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjb2wubGFiZWwgPSBvLmFnZ3JlZ2F0ZXNbal0ubGFiZWwgfHwgbDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjb2wubmFtZSA9IGl0ZW1zLnRleHQ7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y29sLmxhYmVsID0gaXRlbXMudGV4dD09PSdfcl9Ub3RhbHMnID8gby5yb3dUb3RhbHNUZXh0IDogaXRlbXMudGV4dDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRjb2x1bW5zLnB1c2ggKGNvbCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGorKztcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGxpc3QodHJlZSwgMCk7XHJcblx0XHRcdHZhciBubTtcclxuXHRcdFx0Ly8gbG9vcCBhZ2FpbiB0cm91Z3RoIHRoZSBwaXZvdCByb3dzIGluIG9yZGVyIHRvIGJ1aWxkIGdyYW5kIHRvdGFsXHJcblx0XHRcdGlmKG8uY29sVG90YWxzKSB7XHJcblx0XHRcdFx0dmFyIHBsZW4gPSBwaXZvdHJvd3MubGVuZ3RoO1xyXG5cdFx0XHRcdHdoaWxlKHBsZW4tLSkge1xyXG5cdFx0XHRcdFx0Zm9yKGk9eGxlbjtpPGNvbHVtbnMubGVuZ3RoO2krKykge1xyXG5cdFx0XHRcdFx0XHRubSA9IGNvbHVtbnNbaV0ubmFtZTtcclxuXHRcdFx0XHRcdFx0aWYoIXN1bW1hcmllc1tubV0pIHtcclxuXHRcdFx0XHRcdFx0XHRzdW1tYXJpZXNbbm1dID0gcGFyc2VGbG9hdChwaXZvdHJvd3NbcGxlbl1bbm1dIHx8IDApO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHN1bW1hcmllc1tubV0gKz0gcGFyc2VGbG9hdChwaXZvdHJvd3NbcGxlbl1bbm1dIHx8IDApO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdC8vIGJhc2VkIG9uIHhEaW1lbnNpb24gIGxldmVscyBidWlsZCBncm91cGluZ1xyXG5cdFx0XHRpZiggZ3JvdXBmaWVsZHMgPiAwKSB7XHJcblx0XHRcdFx0Zm9yKGk9MDtpPGdyb3VwZmllbGRzO2krKykge1xyXG5cdFx0XHRcdFx0Z3JvdXBPcHRpb25zLmdyb3VwaW5nVmlldy5ncm91cEZpZWxkW2ldID0gY29sdW1uc1tpXS5uYW1lO1xyXG5cdFx0XHRcdFx0Z3JvdXBPcHRpb25zLmdyb3VwaW5nVmlldy5ncm91cFN1bW1hcnlbaV0gPSBvLmdyb3VwU3VtbWFyeTtcclxuXHRcdFx0XHRcdGdyb3VwT3B0aW9ucy5ncm91cGluZ1ZpZXcuZ3JvdXBTdW1tYXJ5UG9zW2ldID0gby5ncm91cFN1bW1hcnlQb3M7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdC8vIG5vIGdyb3VwaW5nIGlzIG5lZWRlZFxyXG5cdFx0XHRcdGdyb3VwT3B0aW9ucy5ncm91cGluZyA9IGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGdyb3VwT3B0aW9ucy5zb3J0bmFtZSA9IGNvbHVtbnNbZ3JvdXBmaWVsZHNdLm5hbWU7XHJcblx0XHRcdGdyb3VwT3B0aW9ucy5ncm91cGluZ1ZpZXcuaGlkZUZpcnN0R3JvdXBDb2wgPSB0cnVlO1xyXG5cdFx0fSk7XHJcblx0XHQvLyByZXR1cm4gdGhlIGZpbmFsIHJlc3VsdC5cclxuXHRcdHJldHVybiB7IFwiY29sTW9kZWxcIiA6IGNvbHVtbnMsIFwicm93c1wiOiBwaXZvdHJvd3MsIFwiZ3JvdXBPcHRpb25zXCIgOiBncm91cE9wdGlvbnMsIFwiZ3JvdXBIZWFkZXJzXCIgOiAgaGVhZGVycywgc3VtbWFyeSA6IHN1bW1hcmllcyB9O1xyXG5cdH0sXHJcblx0anFQaXZvdCA6IGZ1bmN0aW9uKCBkYXRhLCBwaXZvdE9wdCwgZ3JpZE9wdCwgYWpheE9wdCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgJHQgPSB0aGlzO1xyXG5cclxuXHRcdFx0ZnVuY3Rpb24gcGl2b3QoIGRhdGEpIHtcclxuXHRcdFx0XHR2YXIgcGl2b3RHcmlkID0galF1ZXJ5KCR0KS5qcUdyaWQoJ3Bpdm90U2V0dXAnLGRhdGEsIHBpdm90T3B0KSxcclxuXHRcdFx0XHRmb290ZXJyb3cgPSAkLmFzc29jQXJyYXlTaXplKHBpdm90R3JpZC5zdW1tYXJ5KSA+IDAgPyB0cnVlIDogZmFsc2UsXHJcblx0XHRcdFx0cXVlcnk9ICQuamdyaWQuZnJvbShwaXZvdEdyaWQucm93cyksIGk7XHJcblx0XHRcdFx0Zm9yKGk9MDsgaTwgcGl2b3RHcmlkLmdyb3VwT3B0aW9ucy5ncm91cGluZ1ZpZXcuZ3JvdXBGaWVsZC5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdFx0cXVlcnkub3JkZXJCeShwaXZvdEdyaWQuZ3JvdXBPcHRpb25zLmdyb3VwaW5nVmlldy5ncm91cEZpZWxkW2ldLCBcImFcIiwgJ3RleHQnLCAnJyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGpRdWVyeSgkdCkuanFHcmlkKCQuZXh0ZW5kKHtcclxuXHRcdFx0XHRcdGRhdGFzdHI6ICQuZXh0ZW5kKHF1ZXJ5LnNlbGVjdCgpLGZvb3RlcnJvdyA/IHt1c2VyZGF0YTpwaXZvdEdyaWQuc3VtbWFyeX0gOiB7fSksXHJcblx0XHRcdFx0XHRkYXRhdHlwZTogXCJqc29uc3RyaW5nXCIsXHJcblx0XHRcdFx0XHRmb290ZXJyb3cgOiBmb290ZXJyb3csXHJcblx0XHRcdFx0XHR1c2VyRGF0YU9uRm9vdGVyOiBmb290ZXJyb3csXHJcblx0XHRcdFx0XHRjb2xNb2RlbDogcGl2b3RHcmlkLmNvbE1vZGVsLFxyXG5cdFx0XHRcdFx0dmlld3JlY29yZHM6IHRydWUsXHJcblx0XHRcdFx0XHRzb3J0bmFtZTogcGl2b3RPcHQueERpbWVuc2lvblswXS5kYXRhTmFtZSAvLyA/Pz8/P1xyXG5cdFx0XHRcdH0sIGdyaWRPcHQgfHwge30sIHBpdm90R3JpZC5ncm91cE9wdGlvbnMpKTtcclxuXHRcdFx0XHR2YXIgZ0hlYWQgPSBwaXZvdEdyaWQuZ3JvdXBIZWFkZXJzO1xyXG5cdFx0XHRcdGlmKGdIZWFkLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0Zm9yKCBpID0gMDtpIDwgZ0hlYWQubGVuZ3RoIDsgaSsrKSB7XHJcblx0XHRcdFx0XHRcdGlmKGdIZWFkW2ldICYmIGdIZWFkW2ldLmdyb3VwSGVhZGVycy5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0XHRqUXVlcnkoJHQpLmpxR3JpZCgnc2V0R3JvdXBIZWFkZXJzJyxnSGVhZFtpXSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYocGl2b3RPcHQuZnJvemVuU3RhdGljQ29scykge1xyXG5cdFx0XHRcdFx0alF1ZXJ5KCR0KS5qcUdyaWQoXCJzZXRGcm96ZW5Db2x1bW5zXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYodHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIpIHtcclxuXHRcdFx0XHQkLmFqYXgoJC5leHRlbmQoe1xyXG5cdFx0XHRcdFx0dXJsIDogZGF0YSxcclxuXHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXHJcblx0XHRcdFx0XHRzdWNjZXNzIDogZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuXHRcdFx0XHRcdFx0cGl2b3QoJC5qZ3JpZC5nZXRBY2Nlc3NvcihyZXNwb25zZSwgYWpheE9wdCAmJiBhamF4T3B0LnJlYWRlciA/IGFqYXhPcHQucmVhZGVyOiAncm93cycpICk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSwgYWpheE9wdCB8fCB7fSkgKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRwaXZvdCggZGF0YSApO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn0pO1xyXG59KShqUXVlcnkpO1xyXG5cclxuLy9AYWRkXHJcbn07XHJcbi8vQGFkZFxyXG4iLCIoIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggWyBcImpxdWVyeVwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59ICggZnVuY3Rpb24oICQgKSB7XG5cbiQudWkgPSAkLnVpIHx8IHt9O1xuXG5yZXR1cm4gJC51aS52ZXJzaW9uID0gXCIxLjEyLjFcIjtcblxufSApICk7XG4iLCIvKiFcbiAqIGpRdWVyeSBVSSBXaWRnZXQgMS4xMi4xXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXG4gKlxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqL1xuXG4vLz4+bGFiZWw6IFdpZGdldFxuLy8+Pmdyb3VwOiBDb3JlXG4vLz4+ZGVzY3JpcHRpb246IFByb3ZpZGVzIGEgZmFjdG9yeSBmb3IgY3JlYXRpbmcgc3RhdGVmdWwgd2lkZ2V0cyB3aXRoIGEgY29tbW9uIEFQSS5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9qUXVlcnkud2lkZ2V0L1xuLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL3dpZGdldC9cblxuKCBmdW5jdGlvbiggZmFjdG9yeSApIHtcblx0aWYgKCB0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCApIHtcblxuXHRcdC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cblx0XHRkZWZpbmUoIFsgXCJqcXVlcnlcIiwgXCIuL3ZlcnNpb25cIiBdLCBmYWN0b3J5ICk7XG5cdH0gZWxzZSB7XG5cblx0XHQvLyBCcm93c2VyIGdsb2JhbHNcblx0XHRmYWN0b3J5KCBqUXVlcnkgKTtcblx0fVxufSggZnVuY3Rpb24oICQgKSB7XG5cbnZhciB3aWRnZXRVdWlkID0gMDtcbnZhciB3aWRnZXRTbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcblxuJC5jbGVhbkRhdGEgPSAoIGZ1bmN0aW9uKCBvcmlnICkge1xuXHRyZXR1cm4gZnVuY3Rpb24oIGVsZW1zICkge1xuXHRcdHZhciBldmVudHMsIGVsZW0sIGk7XG5cdFx0Zm9yICggaSA9IDA7ICggZWxlbSA9IGVsZW1zWyBpIF0gKSAhPSBudWxsOyBpKysgKSB7XG5cdFx0XHR0cnkge1xuXG5cdFx0XHRcdC8vIE9ubHkgdHJpZ2dlciByZW1vdmUgd2hlbiBuZWNlc3NhcnkgdG8gc2F2ZSB0aW1lXG5cdFx0XHRcdGV2ZW50cyA9ICQuX2RhdGEoIGVsZW0sIFwiZXZlbnRzXCIgKTtcblx0XHRcdFx0aWYgKCBldmVudHMgJiYgZXZlbnRzLnJlbW92ZSApIHtcblx0XHRcdFx0XHQkKCBlbGVtICkudHJpZ2dlckhhbmRsZXIoIFwicmVtb3ZlXCIgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHQvLyBIdHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC84MjM1XG5cdFx0XHR9IGNhdGNoICggZSApIHt9XG5cdFx0fVxuXHRcdG9yaWcoIGVsZW1zICk7XG5cdH07XG59ICkoICQuY2xlYW5EYXRhICk7XG5cbiQud2lkZ2V0ID0gZnVuY3Rpb24oIG5hbWUsIGJhc2UsIHByb3RvdHlwZSApIHtcblx0dmFyIGV4aXN0aW5nQ29uc3RydWN0b3IsIGNvbnN0cnVjdG9yLCBiYXNlUHJvdG90eXBlO1xuXG5cdC8vIFByb3hpZWRQcm90b3R5cGUgYWxsb3dzIHRoZSBwcm92aWRlZCBwcm90b3R5cGUgdG8gcmVtYWluIHVubW9kaWZpZWRcblx0Ly8gc28gdGhhdCBpdCBjYW4gYmUgdXNlZCBhcyBhIG1peGluIGZvciBtdWx0aXBsZSB3aWRnZXRzICgjODg3Nilcblx0dmFyIHByb3hpZWRQcm90b3R5cGUgPSB7fTtcblxuXHR2YXIgbmFtZXNwYWNlID0gbmFtZS5zcGxpdCggXCIuXCIgKVsgMCBdO1xuXHRuYW1lID0gbmFtZS5zcGxpdCggXCIuXCIgKVsgMSBdO1xuXHR2YXIgZnVsbE5hbWUgPSBuYW1lc3BhY2UgKyBcIi1cIiArIG5hbWU7XG5cblx0aWYgKCAhcHJvdG90eXBlICkge1xuXHRcdHByb3RvdHlwZSA9IGJhc2U7XG5cdFx0YmFzZSA9ICQuV2lkZ2V0O1xuXHR9XG5cblx0aWYgKCAkLmlzQXJyYXkoIHByb3RvdHlwZSApICkge1xuXHRcdHByb3RvdHlwZSA9ICQuZXh0ZW5kLmFwcGx5KCBudWxsLCBbIHt9IF0uY29uY2F0KCBwcm90b3R5cGUgKSApO1xuXHR9XG5cblx0Ly8gQ3JlYXRlIHNlbGVjdG9yIGZvciBwbHVnaW5cblx0JC5leHByWyBcIjpcIiBdWyBmdWxsTmFtZS50b0xvd2VyQ2FzZSgpIF0gPSBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRyZXR1cm4gISEkLmRhdGEoIGVsZW0sIGZ1bGxOYW1lICk7XG5cdH07XG5cblx0JFsgbmFtZXNwYWNlIF0gPSAkWyBuYW1lc3BhY2UgXSB8fCB7fTtcblx0ZXhpc3RpbmdDb25zdHJ1Y3RvciA9ICRbIG5hbWVzcGFjZSBdWyBuYW1lIF07XG5cdGNvbnN0cnVjdG9yID0gJFsgbmFtZXNwYWNlIF1bIG5hbWUgXSA9IGZ1bmN0aW9uKCBvcHRpb25zLCBlbGVtZW50ICkge1xuXG5cdFx0Ly8gQWxsb3cgaW5zdGFudGlhdGlvbiB3aXRob3V0IFwibmV3XCIga2V5d29yZFxuXHRcdGlmICggIXRoaXMuX2NyZWF0ZVdpZGdldCApIHtcblx0XHRcdHJldHVybiBuZXcgY29uc3RydWN0b3IoIG9wdGlvbnMsIGVsZW1lbnQgKTtcblx0XHR9XG5cblx0XHQvLyBBbGxvdyBpbnN0YW50aWF0aW9uIHdpdGhvdXQgaW5pdGlhbGl6aW5nIGZvciBzaW1wbGUgaW5oZXJpdGFuY2Vcblx0XHQvLyBtdXN0IHVzZSBcIm5ld1wiIGtleXdvcmQgKHRoZSBjb2RlIGFib3ZlIGFsd2F5cyBwYXNzZXMgYXJncylcblx0XHRpZiAoIGFyZ3VtZW50cy5sZW5ndGggKSB7XG5cdFx0XHR0aGlzLl9jcmVhdGVXaWRnZXQoIG9wdGlvbnMsIGVsZW1lbnQgKTtcblx0XHR9XG5cdH07XG5cblx0Ly8gRXh0ZW5kIHdpdGggdGhlIGV4aXN0aW5nIGNvbnN0cnVjdG9yIHRvIGNhcnJ5IG92ZXIgYW55IHN0YXRpYyBwcm9wZXJ0aWVzXG5cdCQuZXh0ZW5kKCBjb25zdHJ1Y3RvciwgZXhpc3RpbmdDb25zdHJ1Y3Rvciwge1xuXHRcdHZlcnNpb246IHByb3RvdHlwZS52ZXJzaW9uLFxuXG5cdFx0Ly8gQ29weSB0aGUgb2JqZWN0IHVzZWQgdG8gY3JlYXRlIHRoZSBwcm90b3R5cGUgaW4gY2FzZSB3ZSBuZWVkIHRvXG5cdFx0Ly8gcmVkZWZpbmUgdGhlIHdpZGdldCBsYXRlclxuXHRcdF9wcm90bzogJC5leHRlbmQoIHt9LCBwcm90b3R5cGUgKSxcblxuXHRcdC8vIFRyYWNrIHdpZGdldHMgdGhhdCBpbmhlcml0IGZyb20gdGhpcyB3aWRnZXQgaW4gY2FzZSB0aGlzIHdpZGdldCBpc1xuXHRcdC8vIHJlZGVmaW5lZCBhZnRlciBhIHdpZGdldCBpbmhlcml0cyBmcm9tIGl0XG5cdFx0X2NoaWxkQ29uc3RydWN0b3JzOiBbXVxuXHR9ICk7XG5cblx0YmFzZVByb3RvdHlwZSA9IG5ldyBiYXNlKCk7XG5cblx0Ly8gV2UgbmVlZCB0byBtYWtlIHRoZSBvcHRpb25zIGhhc2ggYSBwcm9wZXJ0eSBkaXJlY3RseSBvbiB0aGUgbmV3IGluc3RhbmNlXG5cdC8vIG90aGVyd2lzZSB3ZSdsbCBtb2RpZnkgdGhlIG9wdGlvbnMgaGFzaCBvbiB0aGUgcHJvdG90eXBlIHRoYXQgd2UncmVcblx0Ly8gaW5oZXJpdGluZyBmcm9tXG5cdGJhc2VQcm90b3R5cGUub3B0aW9ucyA9ICQud2lkZ2V0LmV4dGVuZCgge30sIGJhc2VQcm90b3R5cGUub3B0aW9ucyApO1xuXHQkLmVhY2goIHByb3RvdHlwZSwgZnVuY3Rpb24oIHByb3AsIHZhbHVlICkge1xuXHRcdGlmICggISQuaXNGdW5jdGlvbiggdmFsdWUgKSApIHtcblx0XHRcdHByb3hpZWRQcm90b3R5cGVbIHByb3AgXSA9IHZhbHVlO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRwcm94aWVkUHJvdG90eXBlWyBwcm9wIF0gPSAoIGZ1bmN0aW9uKCkge1xuXHRcdFx0ZnVuY3Rpb24gX3N1cGVyKCkge1xuXHRcdFx0XHRyZXR1cm4gYmFzZS5wcm90b3R5cGVbIHByb3AgXS5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0XHR9XG5cblx0XHRcdGZ1bmN0aW9uIF9zdXBlckFwcGx5KCBhcmdzICkge1xuXHRcdFx0XHRyZXR1cm4gYmFzZS5wcm90b3R5cGVbIHByb3AgXS5hcHBseSggdGhpcywgYXJncyApO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBfX3N1cGVyID0gdGhpcy5fc3VwZXI7XG5cdFx0XHRcdHZhciBfX3N1cGVyQXBwbHkgPSB0aGlzLl9zdXBlckFwcGx5O1xuXHRcdFx0XHR2YXIgcmV0dXJuVmFsdWU7XG5cblx0XHRcdFx0dGhpcy5fc3VwZXIgPSBfc3VwZXI7XG5cdFx0XHRcdHRoaXMuX3N1cGVyQXBwbHkgPSBfc3VwZXJBcHBseTtcblxuXHRcdFx0XHRyZXR1cm5WYWx1ZSA9IHZhbHVlLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcblxuXHRcdFx0XHR0aGlzLl9zdXBlciA9IF9fc3VwZXI7XG5cdFx0XHRcdHRoaXMuX3N1cGVyQXBwbHkgPSBfX3N1cGVyQXBwbHk7XG5cblx0XHRcdFx0cmV0dXJuIHJldHVyblZhbHVlO1xuXHRcdFx0fTtcblx0XHR9ICkoKTtcblx0fSApO1xuXHRjb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSAkLndpZGdldC5leHRlbmQoIGJhc2VQcm90b3R5cGUsIHtcblxuXHRcdC8vIFRPRE86IHJlbW92ZSBzdXBwb3J0IGZvciB3aWRnZXRFdmVudFByZWZpeFxuXHRcdC8vIGFsd2F5cyB1c2UgdGhlIG5hbWUgKyBhIGNvbG9uIGFzIHRoZSBwcmVmaXgsIGUuZy4sIGRyYWdnYWJsZTpzdGFydFxuXHRcdC8vIGRvbid0IHByZWZpeCBmb3Igd2lkZ2V0cyB0aGF0IGFyZW4ndCBET00tYmFzZWRcblx0XHR3aWRnZXRFdmVudFByZWZpeDogZXhpc3RpbmdDb25zdHJ1Y3RvciA/ICggYmFzZVByb3RvdHlwZS53aWRnZXRFdmVudFByZWZpeCB8fCBuYW1lICkgOiBuYW1lXG5cdH0sIHByb3hpZWRQcm90b3R5cGUsIHtcblx0XHRjb25zdHJ1Y3RvcjogY29uc3RydWN0b3IsXG5cdFx0bmFtZXNwYWNlOiBuYW1lc3BhY2UsXG5cdFx0d2lkZ2V0TmFtZTogbmFtZSxcblx0XHR3aWRnZXRGdWxsTmFtZTogZnVsbE5hbWVcblx0fSApO1xuXG5cdC8vIElmIHRoaXMgd2lkZ2V0IGlzIGJlaW5nIHJlZGVmaW5lZCB0aGVuIHdlIG5lZWQgdG8gZmluZCBhbGwgd2lkZ2V0cyB0aGF0XG5cdC8vIGFyZSBpbmhlcml0aW5nIGZyb20gaXQgYW5kIHJlZGVmaW5lIGFsbCBvZiB0aGVtIHNvIHRoYXQgdGhleSBpbmhlcml0IGZyb21cblx0Ly8gdGhlIG5ldyB2ZXJzaW9uIG9mIHRoaXMgd2lkZ2V0LiBXZSdyZSBlc3NlbnRpYWxseSB0cnlpbmcgdG8gcmVwbGFjZSBvbmVcblx0Ly8gbGV2ZWwgaW4gdGhlIHByb3RvdHlwZSBjaGFpbi5cblx0aWYgKCBleGlzdGluZ0NvbnN0cnVjdG9yICkge1xuXHRcdCQuZWFjaCggZXhpc3RpbmdDb25zdHJ1Y3Rvci5fY2hpbGRDb25zdHJ1Y3RvcnMsIGZ1bmN0aW9uKCBpLCBjaGlsZCApIHtcblx0XHRcdHZhciBjaGlsZFByb3RvdHlwZSA9IGNoaWxkLnByb3RvdHlwZTtcblxuXHRcdFx0Ly8gUmVkZWZpbmUgdGhlIGNoaWxkIHdpZGdldCB1c2luZyB0aGUgc2FtZSBwcm90b3R5cGUgdGhhdCB3YXNcblx0XHRcdC8vIG9yaWdpbmFsbHkgdXNlZCwgYnV0IGluaGVyaXQgZnJvbSB0aGUgbmV3IHZlcnNpb24gb2YgdGhlIGJhc2Vcblx0XHRcdCQud2lkZ2V0KCBjaGlsZFByb3RvdHlwZS5uYW1lc3BhY2UgKyBcIi5cIiArIGNoaWxkUHJvdG90eXBlLndpZGdldE5hbWUsIGNvbnN0cnVjdG9yLFxuXHRcdFx0XHRjaGlsZC5fcHJvdG8gKTtcblx0XHR9ICk7XG5cblx0XHQvLyBSZW1vdmUgdGhlIGxpc3Qgb2YgZXhpc3RpbmcgY2hpbGQgY29uc3RydWN0b3JzIGZyb20gdGhlIG9sZCBjb25zdHJ1Y3RvclxuXHRcdC8vIHNvIHRoZSBvbGQgY2hpbGQgY29uc3RydWN0b3JzIGNhbiBiZSBnYXJiYWdlIGNvbGxlY3RlZFxuXHRcdGRlbGV0ZSBleGlzdGluZ0NvbnN0cnVjdG9yLl9jaGlsZENvbnN0cnVjdG9ycztcblx0fSBlbHNlIHtcblx0XHRiYXNlLl9jaGlsZENvbnN0cnVjdG9ycy5wdXNoKCBjb25zdHJ1Y3RvciApO1xuXHR9XG5cblx0JC53aWRnZXQuYnJpZGdlKCBuYW1lLCBjb25zdHJ1Y3RvciApO1xuXG5cdHJldHVybiBjb25zdHJ1Y3Rvcjtcbn07XG5cbiQud2lkZ2V0LmV4dGVuZCA9IGZ1bmN0aW9uKCB0YXJnZXQgKSB7XG5cdHZhciBpbnB1dCA9IHdpZGdldFNsaWNlLmNhbGwoIGFyZ3VtZW50cywgMSApO1xuXHR2YXIgaW5wdXRJbmRleCA9IDA7XG5cdHZhciBpbnB1dExlbmd0aCA9IGlucHV0Lmxlbmd0aDtcblx0dmFyIGtleTtcblx0dmFyIHZhbHVlO1xuXG5cdGZvciAoIDsgaW5wdXRJbmRleCA8IGlucHV0TGVuZ3RoOyBpbnB1dEluZGV4KysgKSB7XG5cdFx0Zm9yICgga2V5IGluIGlucHV0WyBpbnB1dEluZGV4IF0gKSB7XG5cdFx0XHR2YWx1ZSA9IGlucHV0WyBpbnB1dEluZGV4IF1bIGtleSBdO1xuXHRcdFx0aWYgKCBpbnB1dFsgaW5wdXRJbmRleCBdLmhhc093blByb3BlcnR5KCBrZXkgKSAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRcdC8vIENsb25lIG9iamVjdHNcblx0XHRcdFx0aWYgKCAkLmlzUGxhaW5PYmplY3QoIHZhbHVlICkgKSB7XG5cdFx0XHRcdFx0dGFyZ2V0WyBrZXkgXSA9ICQuaXNQbGFpbk9iamVjdCggdGFyZ2V0WyBrZXkgXSApID9cblx0XHRcdFx0XHRcdCQud2lkZ2V0LmV4dGVuZCgge30sIHRhcmdldFsga2V5IF0sIHZhbHVlICkgOlxuXG5cdFx0XHRcdFx0XHQvLyBEb24ndCBleHRlbmQgc3RyaW5ncywgYXJyYXlzLCBldGMuIHdpdGggb2JqZWN0c1xuXHRcdFx0XHRcdFx0JC53aWRnZXQuZXh0ZW5kKCB7fSwgdmFsdWUgKTtcblxuXHRcdFx0XHQvLyBDb3B5IGV2ZXJ5dGhpbmcgZWxzZSBieSByZWZlcmVuY2Vcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0YXJnZXRbIGtleSBdID0gdmFsdWU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblx0cmV0dXJuIHRhcmdldDtcbn07XG5cbiQud2lkZ2V0LmJyaWRnZSA9IGZ1bmN0aW9uKCBuYW1lLCBvYmplY3QgKSB7XG5cdHZhciBmdWxsTmFtZSA9IG9iamVjdC5wcm90b3R5cGUud2lkZ2V0RnVsbE5hbWUgfHwgbmFtZTtcblx0JC5mblsgbmFtZSBdID0gZnVuY3Rpb24oIG9wdGlvbnMgKSB7XG5cdFx0dmFyIGlzTWV0aG9kQ2FsbCA9IHR5cGVvZiBvcHRpb25zID09PSBcInN0cmluZ1wiO1xuXHRcdHZhciBhcmdzID0gd2lkZ2V0U2xpY2UuY2FsbCggYXJndW1lbnRzLCAxICk7XG5cdFx0dmFyIHJldHVyblZhbHVlID0gdGhpcztcblxuXHRcdGlmICggaXNNZXRob2RDYWxsICkge1xuXG5cdFx0XHQvLyBJZiB0aGlzIGlzIGFuIGVtcHR5IGNvbGxlY3Rpb24sIHdlIG5lZWQgdG8gaGF2ZSB0aGUgaW5zdGFuY2UgbWV0aG9kXG5cdFx0XHQvLyByZXR1cm4gdW5kZWZpbmVkIGluc3RlYWQgb2YgdGhlIGpRdWVyeSBpbnN0YW5jZVxuXHRcdFx0aWYgKCAhdGhpcy5sZW5ndGggJiYgb3B0aW9ucyA9PT0gXCJpbnN0YW5jZVwiICkge1xuXHRcdFx0XHRyZXR1cm5WYWx1ZSA9IHVuZGVmaW5lZDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmFyIG1ldGhvZFZhbHVlO1xuXHRcdFx0XHRcdHZhciBpbnN0YW5jZSA9ICQuZGF0YSggdGhpcywgZnVsbE5hbWUgKTtcblxuXHRcdFx0XHRcdGlmICggb3B0aW9ucyA9PT0gXCJpbnN0YW5jZVwiICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuVmFsdWUgPSBpbnN0YW5jZTtcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoICFpbnN0YW5jZSApIHtcblx0XHRcdFx0XHRcdHJldHVybiAkLmVycm9yKCBcImNhbm5vdCBjYWxsIG1ldGhvZHMgb24gXCIgKyBuYW1lICtcblx0XHRcdFx0XHRcdFx0XCIgcHJpb3IgdG8gaW5pdGlhbGl6YXRpb247IFwiICtcblx0XHRcdFx0XHRcdFx0XCJhdHRlbXB0ZWQgdG8gY2FsbCBtZXRob2QgJ1wiICsgb3B0aW9ucyArIFwiJ1wiICk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKCAhJC5pc0Z1bmN0aW9uKCBpbnN0YW5jZVsgb3B0aW9ucyBdICkgfHwgb3B0aW9ucy5jaGFyQXQoIDAgKSA9PT0gXCJfXCIgKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gJC5lcnJvciggXCJubyBzdWNoIG1ldGhvZCAnXCIgKyBvcHRpb25zICsgXCInIGZvciBcIiArIG5hbWUgK1xuXHRcdFx0XHRcdFx0XHRcIiB3aWRnZXQgaW5zdGFuY2VcIiApO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdG1ldGhvZFZhbHVlID0gaW5zdGFuY2VbIG9wdGlvbnMgXS5hcHBseSggaW5zdGFuY2UsIGFyZ3MgKTtcblxuXHRcdFx0XHRcdGlmICggbWV0aG9kVmFsdWUgIT09IGluc3RhbmNlICYmIG1ldGhvZFZhbHVlICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm5WYWx1ZSA9IG1ldGhvZFZhbHVlICYmIG1ldGhvZFZhbHVlLmpxdWVyeSA/XG5cdFx0XHRcdFx0XHRcdHJldHVyblZhbHVlLnB1c2hTdGFjayggbWV0aG9kVmFsdWUuZ2V0KCkgKSA6XG5cdFx0XHRcdFx0XHRcdG1ldGhvZFZhbHVlO1xuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSApO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdC8vIEFsbG93IG11bHRpcGxlIGhhc2hlcyB0byBiZSBwYXNzZWQgb24gaW5pdFxuXHRcdFx0aWYgKCBhcmdzLmxlbmd0aCApIHtcblx0XHRcdFx0b3B0aW9ucyA9ICQud2lkZ2V0LmV4dGVuZC5hcHBseSggbnVsbCwgWyBvcHRpb25zIF0uY29uY2F0KCBhcmdzICkgKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGluc3RhbmNlID0gJC5kYXRhKCB0aGlzLCBmdWxsTmFtZSApO1xuXHRcdFx0XHRpZiAoIGluc3RhbmNlICkge1xuXHRcdFx0XHRcdGluc3RhbmNlLm9wdGlvbiggb3B0aW9ucyB8fCB7fSApO1xuXHRcdFx0XHRcdGlmICggaW5zdGFuY2UuX2luaXQgKSB7XG5cdFx0XHRcdFx0XHRpbnN0YW5jZS5faW5pdCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkLmRhdGEoIHRoaXMsIGZ1bGxOYW1lLCBuZXcgb2JqZWN0KCBvcHRpb25zLCB0aGlzICkgKTtcblx0XHRcdFx0fVxuXHRcdFx0fSApO1xuXHRcdH1cblxuXHRcdHJldHVybiByZXR1cm5WYWx1ZTtcblx0fTtcbn07XG5cbiQuV2lkZ2V0ID0gZnVuY3Rpb24oIC8qIG9wdGlvbnMsIGVsZW1lbnQgKi8gKSB7fTtcbiQuV2lkZ2V0Ll9jaGlsZENvbnN0cnVjdG9ycyA9IFtdO1xuXG4kLldpZGdldC5wcm90b3R5cGUgPSB7XG5cdHdpZGdldE5hbWU6IFwid2lkZ2V0XCIsXG5cdHdpZGdldEV2ZW50UHJlZml4OiBcIlwiLFxuXHRkZWZhdWx0RWxlbWVudDogXCI8ZGl2PlwiLFxuXG5cdG9wdGlvbnM6IHtcblx0XHRjbGFzc2VzOiB7fSxcblx0XHRkaXNhYmxlZDogZmFsc2UsXG5cblx0XHQvLyBDYWxsYmFja3Ncblx0XHRjcmVhdGU6IG51bGxcblx0fSxcblxuXHRfY3JlYXRlV2lkZ2V0OiBmdW5jdGlvbiggb3B0aW9ucywgZWxlbWVudCApIHtcblx0XHRlbGVtZW50ID0gJCggZWxlbWVudCB8fCB0aGlzLmRlZmF1bHRFbGVtZW50IHx8IHRoaXMgKVsgMCBdO1xuXHRcdHRoaXMuZWxlbWVudCA9ICQoIGVsZW1lbnQgKTtcblx0XHR0aGlzLnV1aWQgPSB3aWRnZXRVdWlkKys7XG5cdFx0dGhpcy5ldmVudE5hbWVzcGFjZSA9IFwiLlwiICsgdGhpcy53aWRnZXROYW1lICsgdGhpcy51dWlkO1xuXG5cdFx0dGhpcy5iaW5kaW5ncyA9ICQoKTtcblx0XHR0aGlzLmhvdmVyYWJsZSA9ICQoKTtcblx0XHR0aGlzLmZvY3VzYWJsZSA9ICQoKTtcblx0XHR0aGlzLmNsYXNzZXNFbGVtZW50TG9va3VwID0ge307XG5cblx0XHRpZiAoIGVsZW1lbnQgIT09IHRoaXMgKSB7XG5cdFx0XHQkLmRhdGEoIGVsZW1lbnQsIHRoaXMud2lkZ2V0RnVsbE5hbWUsIHRoaXMgKTtcblx0XHRcdHRoaXMuX29uKCB0cnVlLCB0aGlzLmVsZW1lbnQsIHtcblx0XHRcdFx0cmVtb3ZlOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdFx0aWYgKCBldmVudC50YXJnZXQgPT09IGVsZW1lbnQgKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmRlc3Ryb3koKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gKTtcblx0XHRcdHRoaXMuZG9jdW1lbnQgPSAkKCBlbGVtZW50LnN0eWxlID9cblxuXHRcdFx0XHQvLyBFbGVtZW50IHdpdGhpbiB0aGUgZG9jdW1lbnRcblx0XHRcdFx0ZWxlbWVudC5vd25lckRvY3VtZW50IDpcblxuXHRcdFx0XHQvLyBFbGVtZW50IGlzIHdpbmRvdyBvciBkb2N1bWVudFxuXHRcdFx0XHRlbGVtZW50LmRvY3VtZW50IHx8IGVsZW1lbnQgKTtcblx0XHRcdHRoaXMud2luZG93ID0gJCggdGhpcy5kb2N1bWVudFsgMCBdLmRlZmF1bHRWaWV3IHx8IHRoaXMuZG9jdW1lbnRbIDAgXS5wYXJlbnRXaW5kb3cgKTtcblx0XHR9XG5cblx0XHR0aGlzLm9wdGlvbnMgPSAkLndpZGdldC5leHRlbmQoIHt9LFxuXHRcdFx0dGhpcy5vcHRpb25zLFxuXHRcdFx0dGhpcy5fZ2V0Q3JlYXRlT3B0aW9ucygpLFxuXHRcdFx0b3B0aW9ucyApO1xuXG5cdFx0dGhpcy5fY3JlYXRlKCk7XG5cblx0XHRpZiAoIHRoaXMub3B0aW9ucy5kaXNhYmxlZCApIHtcblx0XHRcdHRoaXMuX3NldE9wdGlvbkRpc2FibGVkKCB0aGlzLm9wdGlvbnMuZGlzYWJsZWQgKTtcblx0XHR9XG5cblx0XHR0aGlzLl90cmlnZ2VyKCBcImNyZWF0ZVwiLCBudWxsLCB0aGlzLl9nZXRDcmVhdGVFdmVudERhdGEoKSApO1xuXHRcdHRoaXMuX2luaXQoKTtcblx0fSxcblxuXHRfZ2V0Q3JlYXRlT3B0aW9uczogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHt9O1xuXHR9LFxuXG5cdF9nZXRDcmVhdGVFdmVudERhdGE6ICQubm9vcCxcblxuXHRfY3JlYXRlOiAkLm5vb3AsXG5cblx0X2luaXQ6ICQubm9vcCxcblxuXHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdGhhdCA9IHRoaXM7XG5cblx0XHR0aGlzLl9kZXN0cm95KCk7XG5cdFx0JC5lYWNoKCB0aGlzLmNsYXNzZXNFbGVtZW50TG9va3VwLCBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRcdHRoYXQuX3JlbW92ZUNsYXNzKCB2YWx1ZSwga2V5ICk7XG5cdFx0fSApO1xuXG5cdFx0Ly8gV2UgY2FuIHByb2JhYmx5IHJlbW92ZSB0aGUgdW5iaW5kIGNhbGxzIGluIDIuMFxuXHRcdC8vIGFsbCBldmVudCBiaW5kaW5ncyBzaG91bGQgZ28gdGhyb3VnaCB0aGlzLl9vbigpXG5cdFx0dGhpcy5lbGVtZW50XG5cdFx0XHQub2ZmKCB0aGlzLmV2ZW50TmFtZXNwYWNlIClcblx0XHRcdC5yZW1vdmVEYXRhKCB0aGlzLndpZGdldEZ1bGxOYW1lICk7XG5cdFx0dGhpcy53aWRnZXQoKVxuXHRcdFx0Lm9mZiggdGhpcy5ldmVudE5hbWVzcGFjZSApXG5cdFx0XHQucmVtb3ZlQXR0ciggXCJhcmlhLWRpc2FibGVkXCIgKTtcblxuXHRcdC8vIENsZWFuIHVwIGV2ZW50cyBhbmQgc3RhdGVzXG5cdFx0dGhpcy5iaW5kaW5ncy5vZmYoIHRoaXMuZXZlbnROYW1lc3BhY2UgKTtcblx0fSxcblxuXHRfZGVzdHJveTogJC5ub29wLFxuXG5cdHdpZGdldDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudDtcblx0fSxcblxuXHRvcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkge1xuXHRcdHZhciBvcHRpb25zID0ga2V5O1xuXHRcdHZhciBwYXJ0cztcblx0XHR2YXIgY3VyT3B0aW9uO1xuXHRcdHZhciBpO1xuXG5cdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoID09PSAwICkge1xuXG5cdFx0XHQvLyBEb24ndCByZXR1cm4gYSByZWZlcmVuY2UgdG8gdGhlIGludGVybmFsIGhhc2hcblx0XHRcdHJldHVybiAkLndpZGdldC5leHRlbmQoIHt9LCB0aGlzLm9wdGlvbnMgKTtcblx0XHR9XG5cblx0XHRpZiAoIHR5cGVvZiBrZXkgPT09IFwic3RyaW5nXCIgKSB7XG5cblx0XHRcdC8vIEhhbmRsZSBuZXN0ZWQga2V5cywgZS5nLiwgXCJmb28uYmFyXCIgPT4geyBmb286IHsgYmFyOiBfX18gfSB9XG5cdFx0XHRvcHRpb25zID0ge307XG5cdFx0XHRwYXJ0cyA9IGtleS5zcGxpdCggXCIuXCIgKTtcblx0XHRcdGtleSA9IHBhcnRzLnNoaWZ0KCk7XG5cdFx0XHRpZiAoIHBhcnRzLmxlbmd0aCApIHtcblx0XHRcdFx0Y3VyT3B0aW9uID0gb3B0aW9uc1sga2V5IF0gPSAkLndpZGdldC5leHRlbmQoIHt9LCB0aGlzLm9wdGlvbnNbIGtleSBdICk7XG5cdFx0XHRcdGZvciAoIGkgPSAwOyBpIDwgcGFydHMubGVuZ3RoIC0gMTsgaSsrICkge1xuXHRcdFx0XHRcdGN1ck9wdGlvblsgcGFydHNbIGkgXSBdID0gY3VyT3B0aW9uWyBwYXJ0c1sgaSBdIF0gfHwge307XG5cdFx0XHRcdFx0Y3VyT3B0aW9uID0gY3VyT3B0aW9uWyBwYXJ0c1sgaSBdIF07XG5cdFx0XHRcdH1cblx0XHRcdFx0a2V5ID0gcGFydHMucG9wKCk7XG5cdFx0XHRcdGlmICggYXJndW1lbnRzLmxlbmd0aCA9PT0gMSApIHtcblx0XHRcdFx0XHRyZXR1cm4gY3VyT3B0aW9uWyBrZXkgXSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IGN1ck9wdGlvblsga2V5IF07XG5cdFx0XHRcdH1cblx0XHRcdFx0Y3VyT3B0aW9uWyBrZXkgXSA9IHZhbHVlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoID09PSAxICkge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzLm9wdGlvbnNbIGtleSBdID09PSB1bmRlZmluZWQgPyBudWxsIDogdGhpcy5vcHRpb25zWyBrZXkgXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRvcHRpb25zWyBrZXkgXSA9IHZhbHVlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuX3NldE9wdGlvbnMoIG9wdGlvbnMgKTtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdF9zZXRPcHRpb25zOiBmdW5jdGlvbiggb3B0aW9ucyApIHtcblx0XHR2YXIga2V5O1xuXG5cdFx0Zm9yICgga2V5IGluIG9wdGlvbnMgKSB7XG5cdFx0XHR0aGlzLl9zZXRPcHRpb24oIGtleSwgb3B0aW9uc1sga2V5IF0gKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRpZiAoIGtleSA9PT0gXCJjbGFzc2VzXCIgKSB7XG5cdFx0XHR0aGlzLl9zZXRPcHRpb25DbGFzc2VzKCB2YWx1ZSApO1xuXHRcdH1cblxuXHRcdHRoaXMub3B0aW9uc1sga2V5IF0gPSB2YWx1ZTtcblxuXHRcdGlmICgga2V5ID09PSBcImRpc2FibGVkXCIgKSB7XG5cdFx0XHR0aGlzLl9zZXRPcHRpb25EaXNhYmxlZCggdmFsdWUgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfc2V0T3B0aW9uQ2xhc3NlczogZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdHZhciBjbGFzc0tleSwgZWxlbWVudHMsIGN1cnJlbnRFbGVtZW50cztcblxuXHRcdGZvciAoIGNsYXNzS2V5IGluIHZhbHVlICkge1xuXHRcdFx0Y3VycmVudEVsZW1lbnRzID0gdGhpcy5jbGFzc2VzRWxlbWVudExvb2t1cFsgY2xhc3NLZXkgXTtcblx0XHRcdGlmICggdmFsdWVbIGNsYXNzS2V5IF0gPT09IHRoaXMub3B0aW9ucy5jbGFzc2VzWyBjbGFzc0tleSBdIHx8XG5cdFx0XHRcdFx0IWN1cnJlbnRFbGVtZW50cyB8fFxuXHRcdFx0XHRcdCFjdXJyZW50RWxlbWVudHMubGVuZ3RoICkge1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gV2UgYXJlIGRvaW5nIHRoaXMgdG8gY3JlYXRlIGEgbmV3IGpRdWVyeSBvYmplY3QgYmVjYXVzZSB0aGUgX3JlbW92ZUNsYXNzKCkgY2FsbFxuXHRcdFx0Ly8gb24gdGhlIG5leHQgbGluZSBpcyBnb2luZyB0byBkZXN0cm95IHRoZSByZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnQgZWxlbWVudHMgYmVpbmdcblx0XHRcdC8vIHRyYWNrZWQuIFdlIG5lZWQgdG8gc2F2ZSBhIGNvcHkgb2YgdGhpcyBjb2xsZWN0aW9uIHNvIHRoYXQgd2UgY2FuIGFkZCB0aGUgbmV3IGNsYXNzZXNcblx0XHRcdC8vIGJlbG93LlxuXHRcdFx0ZWxlbWVudHMgPSAkKCBjdXJyZW50RWxlbWVudHMuZ2V0KCkgKTtcblx0XHRcdHRoaXMuX3JlbW92ZUNsYXNzKCBjdXJyZW50RWxlbWVudHMsIGNsYXNzS2V5ICk7XG5cblx0XHRcdC8vIFdlIGRvbid0IHVzZSBfYWRkQ2xhc3MoKSBoZXJlLCBiZWNhdXNlIHRoYXQgdXNlcyB0aGlzLm9wdGlvbnMuY2xhc3Nlc1xuXHRcdFx0Ly8gZm9yIGdlbmVyYXRpbmcgdGhlIHN0cmluZyBvZiBjbGFzc2VzLiBXZSB3YW50IHRvIHVzZSB0aGUgdmFsdWUgcGFzc2VkIGluIGZyb21cblx0XHRcdC8vIF9zZXRPcHRpb24oKSwgdGhpcyBpcyB0aGUgbmV3IHZhbHVlIG9mIHRoZSBjbGFzc2VzIG9wdGlvbiB3aGljaCB3YXMgcGFzc2VkIHRvXG5cdFx0XHQvLyBfc2V0T3B0aW9uKCkuIFdlIHBhc3MgdGhpcyB2YWx1ZSBkaXJlY3RseSB0byBfY2xhc3NlcygpLlxuXHRcdFx0ZWxlbWVudHMuYWRkQ2xhc3MoIHRoaXMuX2NsYXNzZXMoIHtcblx0XHRcdFx0ZWxlbWVudDogZWxlbWVudHMsXG5cdFx0XHRcdGtleXM6IGNsYXNzS2V5LFxuXHRcdFx0XHRjbGFzc2VzOiB2YWx1ZSxcblx0XHRcdFx0YWRkOiB0cnVlXG5cdFx0XHR9ICkgKTtcblx0XHR9XG5cdH0sXG5cblx0X3NldE9wdGlvbkRpc2FibGVkOiBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0dGhpcy5fdG9nZ2xlQ2xhc3MoIHRoaXMud2lkZ2V0KCksIHRoaXMud2lkZ2V0RnVsbE5hbWUgKyBcIi1kaXNhYmxlZFwiLCBudWxsLCAhIXZhbHVlICk7XG5cblx0XHQvLyBJZiB0aGUgd2lkZ2V0IGlzIGJlY29taW5nIGRpc2FibGVkLCB0aGVuIG5vdGhpbmcgaXMgaW50ZXJhY3RpdmVcblx0XHRpZiAoIHZhbHVlICkge1xuXHRcdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoIHRoaXMuaG92ZXJhYmxlLCBudWxsLCBcInVpLXN0YXRlLWhvdmVyXCIgKTtcblx0XHRcdHRoaXMuX3JlbW92ZUNsYXNzKCB0aGlzLmZvY3VzYWJsZSwgbnVsbCwgXCJ1aS1zdGF0ZS1mb2N1c1wiICk7XG5cdFx0fVxuXHR9LFxuXG5cdGVuYWJsZTogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3NldE9wdGlvbnMoIHsgZGlzYWJsZWQ6IGZhbHNlIH0gKTtcblx0fSxcblxuXHRkaXNhYmxlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5fc2V0T3B0aW9ucyggeyBkaXNhYmxlZDogdHJ1ZSB9ICk7XG5cdH0sXG5cblx0X2NsYXNzZXM6IGZ1bmN0aW9uKCBvcHRpb25zICkge1xuXHRcdHZhciBmdWxsID0gW107XG5cdFx0dmFyIHRoYXQgPSB0aGlzO1xuXG5cdFx0b3B0aW9ucyA9ICQuZXh0ZW5kKCB7XG5cdFx0XHRlbGVtZW50OiB0aGlzLmVsZW1lbnQsXG5cdFx0XHRjbGFzc2VzOiB0aGlzLm9wdGlvbnMuY2xhc3NlcyB8fCB7fVxuXHRcdH0sIG9wdGlvbnMgKTtcblxuXHRcdGZ1bmN0aW9uIHByb2Nlc3NDbGFzc1N0cmluZyggY2xhc3NlcywgY2hlY2tPcHRpb24gKSB7XG5cdFx0XHR2YXIgY3VycmVudCwgaTtcblx0XHRcdGZvciAoIGkgPSAwOyBpIDwgY2xhc3Nlcy5sZW5ndGg7IGkrKyApIHtcblx0XHRcdFx0Y3VycmVudCA9IHRoYXQuY2xhc3Nlc0VsZW1lbnRMb29rdXBbIGNsYXNzZXNbIGkgXSBdIHx8ICQoKTtcblx0XHRcdFx0aWYgKCBvcHRpb25zLmFkZCApIHtcblx0XHRcdFx0XHRjdXJyZW50ID0gJCggJC51bmlxdWUoIGN1cnJlbnQuZ2V0KCkuY29uY2F0KCBvcHRpb25zLmVsZW1lbnQuZ2V0KCkgKSApICk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y3VycmVudCA9ICQoIGN1cnJlbnQubm90KCBvcHRpb25zLmVsZW1lbnQgKS5nZXQoKSApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoYXQuY2xhc3Nlc0VsZW1lbnRMb29rdXBbIGNsYXNzZXNbIGkgXSBdID0gY3VycmVudDtcblx0XHRcdFx0ZnVsbC5wdXNoKCBjbGFzc2VzWyBpIF0gKTtcblx0XHRcdFx0aWYgKCBjaGVja09wdGlvbiAmJiBvcHRpb25zLmNsYXNzZXNbIGNsYXNzZXNbIGkgXSBdICkge1xuXHRcdFx0XHRcdGZ1bGwucHVzaCggb3B0aW9ucy5jbGFzc2VzWyBjbGFzc2VzWyBpIF0gXSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy5fb24oIG9wdGlvbnMuZWxlbWVudCwge1xuXHRcdFx0XCJyZW1vdmVcIjogXCJfdW50cmFja0NsYXNzZXNFbGVtZW50XCJcblx0XHR9ICk7XG5cblx0XHRpZiAoIG9wdGlvbnMua2V5cyApIHtcblx0XHRcdHByb2Nlc3NDbGFzc1N0cmluZyggb3B0aW9ucy5rZXlzLm1hdGNoKCAvXFxTKy9nICkgfHwgW10sIHRydWUgKTtcblx0XHR9XG5cdFx0aWYgKCBvcHRpb25zLmV4dHJhICkge1xuXHRcdFx0cHJvY2Vzc0NsYXNzU3RyaW5nKCBvcHRpb25zLmV4dHJhLm1hdGNoKCAvXFxTKy9nICkgfHwgW10gKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZnVsbC5qb2luKCBcIiBcIiApO1xuXHR9LFxuXG5cdF91bnRyYWNrQ2xhc3Nlc0VsZW1lbnQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgdGhhdCA9IHRoaXM7XG5cdFx0JC5lYWNoKCB0aGF0LmNsYXNzZXNFbGVtZW50TG9va3VwLCBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRcdGlmICggJC5pbkFycmF5KCBldmVudC50YXJnZXQsIHZhbHVlICkgIT09IC0xICkge1xuXHRcdFx0XHR0aGF0LmNsYXNzZXNFbGVtZW50TG9va3VwWyBrZXkgXSA9ICQoIHZhbHVlLm5vdCggZXZlbnQudGFyZ2V0ICkuZ2V0KCkgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH0sXG5cblx0X3JlbW92ZUNsYXNzOiBmdW5jdGlvbiggZWxlbWVudCwga2V5cywgZXh0cmEgKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3RvZ2dsZUNsYXNzKCBlbGVtZW50LCBrZXlzLCBleHRyYSwgZmFsc2UgKTtcblx0fSxcblxuXHRfYWRkQ2xhc3M6IGZ1bmN0aW9uKCBlbGVtZW50LCBrZXlzLCBleHRyYSApIHtcblx0XHRyZXR1cm4gdGhpcy5fdG9nZ2xlQ2xhc3MoIGVsZW1lbnQsIGtleXMsIGV4dHJhLCB0cnVlICk7XG5cdH0sXG5cblx0X3RvZ2dsZUNsYXNzOiBmdW5jdGlvbiggZWxlbWVudCwga2V5cywgZXh0cmEsIGFkZCApIHtcblx0XHRhZGQgPSAoIHR5cGVvZiBhZGQgPT09IFwiYm9vbGVhblwiICkgPyBhZGQgOiBleHRyYTtcblx0XHR2YXIgc2hpZnQgPSAoIHR5cGVvZiBlbGVtZW50ID09PSBcInN0cmluZ1wiIHx8IGVsZW1lbnQgPT09IG51bGwgKSxcblx0XHRcdG9wdGlvbnMgPSB7XG5cdFx0XHRcdGV4dHJhOiBzaGlmdCA/IGtleXMgOiBleHRyYSxcblx0XHRcdFx0a2V5czogc2hpZnQgPyBlbGVtZW50IDoga2V5cyxcblx0XHRcdFx0ZWxlbWVudDogc2hpZnQgPyB0aGlzLmVsZW1lbnQgOiBlbGVtZW50LFxuXHRcdFx0XHRhZGQ6IGFkZFxuXHRcdFx0fTtcblx0XHRvcHRpb25zLmVsZW1lbnQudG9nZ2xlQ2xhc3MoIHRoaXMuX2NsYXNzZXMoIG9wdGlvbnMgKSwgYWRkICk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0X29uOiBmdW5jdGlvbiggc3VwcHJlc3NEaXNhYmxlZENoZWNrLCBlbGVtZW50LCBoYW5kbGVycyApIHtcblx0XHR2YXIgZGVsZWdhdGVFbGVtZW50O1xuXHRcdHZhciBpbnN0YW5jZSA9IHRoaXM7XG5cblx0XHQvLyBObyBzdXBwcmVzc0Rpc2FibGVkQ2hlY2sgZmxhZywgc2h1ZmZsZSBhcmd1bWVudHNcblx0XHRpZiAoIHR5cGVvZiBzdXBwcmVzc0Rpc2FibGVkQ2hlY2sgIT09IFwiYm9vbGVhblwiICkge1xuXHRcdFx0aGFuZGxlcnMgPSBlbGVtZW50O1xuXHRcdFx0ZWxlbWVudCA9IHN1cHByZXNzRGlzYWJsZWRDaGVjaztcblx0XHRcdHN1cHByZXNzRGlzYWJsZWRDaGVjayA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdC8vIE5vIGVsZW1lbnQgYXJndW1lbnQsIHNodWZmbGUgYW5kIHVzZSB0aGlzLmVsZW1lbnRcblx0XHRpZiAoICFoYW5kbGVycyApIHtcblx0XHRcdGhhbmRsZXJzID0gZWxlbWVudDtcblx0XHRcdGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQ7XG5cdFx0XHRkZWxlZ2F0ZUVsZW1lbnQgPSB0aGlzLndpZGdldCgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRlbGVtZW50ID0gZGVsZWdhdGVFbGVtZW50ID0gJCggZWxlbWVudCApO1xuXHRcdFx0dGhpcy5iaW5kaW5ncyA9IHRoaXMuYmluZGluZ3MuYWRkKCBlbGVtZW50ICk7XG5cdFx0fVxuXG5cdFx0JC5lYWNoKCBoYW5kbGVycywgZnVuY3Rpb24oIGV2ZW50LCBoYW5kbGVyICkge1xuXHRcdFx0ZnVuY3Rpb24gaGFuZGxlclByb3h5KCkge1xuXG5cdFx0XHRcdC8vIEFsbG93IHdpZGdldHMgdG8gY3VzdG9taXplIHRoZSBkaXNhYmxlZCBoYW5kbGluZ1xuXHRcdFx0XHQvLyAtIGRpc2FibGVkIGFzIGFuIGFycmF5IGluc3RlYWQgb2YgYm9vbGVhblxuXHRcdFx0XHQvLyAtIGRpc2FibGVkIGNsYXNzIGFzIG1ldGhvZCBmb3IgZGlzYWJsaW5nIGluZGl2aWR1YWwgcGFydHNcblx0XHRcdFx0aWYgKCAhc3VwcHJlc3NEaXNhYmxlZENoZWNrICYmXG5cdFx0XHRcdFx0XHQoIGluc3RhbmNlLm9wdGlvbnMuZGlzYWJsZWQgPT09IHRydWUgfHxcblx0XHRcdFx0XHRcdCQoIHRoaXMgKS5oYXNDbGFzcyggXCJ1aS1zdGF0ZS1kaXNhYmxlZFwiICkgKSApIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuICggdHlwZW9mIGhhbmRsZXIgPT09IFwic3RyaW5nXCIgPyBpbnN0YW5jZVsgaGFuZGxlciBdIDogaGFuZGxlciApXG5cdFx0XHRcdFx0LmFwcGx5KCBpbnN0YW5jZSwgYXJndW1lbnRzICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENvcHkgdGhlIGd1aWQgc28gZGlyZWN0IHVuYmluZGluZyB3b3Jrc1xuXHRcdFx0aWYgKCB0eXBlb2YgaGFuZGxlciAhPT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdFx0aGFuZGxlclByb3h5Lmd1aWQgPSBoYW5kbGVyLmd1aWQgPVxuXHRcdFx0XHRcdGhhbmRsZXIuZ3VpZCB8fCBoYW5kbGVyUHJveHkuZ3VpZCB8fCAkLmd1aWQrKztcblx0XHRcdH1cblxuXHRcdFx0dmFyIG1hdGNoID0gZXZlbnQubWF0Y2goIC9eKFtcXHc6LV0qKVxccyooLiopJC8gKTtcblx0XHRcdHZhciBldmVudE5hbWUgPSBtYXRjaFsgMSBdICsgaW5zdGFuY2UuZXZlbnROYW1lc3BhY2U7XG5cdFx0XHR2YXIgc2VsZWN0b3IgPSBtYXRjaFsgMiBdO1xuXG5cdFx0XHRpZiAoIHNlbGVjdG9yICkge1xuXHRcdFx0XHRkZWxlZ2F0ZUVsZW1lbnQub24oIGV2ZW50TmFtZSwgc2VsZWN0b3IsIGhhbmRsZXJQcm94eSApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZWxlbWVudC5vbiggZXZlbnROYW1lLCBoYW5kbGVyUHJveHkgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH0sXG5cblx0X29mZjogZnVuY3Rpb24oIGVsZW1lbnQsIGV2ZW50TmFtZSApIHtcblx0XHRldmVudE5hbWUgPSAoIGV2ZW50TmFtZSB8fCBcIlwiICkuc3BsaXQoIFwiIFwiICkuam9pbiggdGhpcy5ldmVudE5hbWVzcGFjZSArIFwiIFwiICkgK1xuXHRcdFx0dGhpcy5ldmVudE5hbWVzcGFjZTtcblx0XHRlbGVtZW50Lm9mZiggZXZlbnROYW1lICkub2ZmKCBldmVudE5hbWUgKTtcblxuXHRcdC8vIENsZWFyIHRoZSBzdGFjayB0byBhdm9pZCBtZW1vcnkgbGVha3MgKCMxMDA1Nilcblx0XHR0aGlzLmJpbmRpbmdzID0gJCggdGhpcy5iaW5kaW5ncy5ub3QoIGVsZW1lbnQgKS5nZXQoKSApO1xuXHRcdHRoaXMuZm9jdXNhYmxlID0gJCggdGhpcy5mb2N1c2FibGUubm90KCBlbGVtZW50ICkuZ2V0KCkgKTtcblx0XHR0aGlzLmhvdmVyYWJsZSA9ICQoIHRoaXMuaG92ZXJhYmxlLm5vdCggZWxlbWVudCApLmdldCgpICk7XG5cdH0sXG5cblx0X2RlbGF5OiBmdW5jdGlvbiggaGFuZGxlciwgZGVsYXkgKSB7XG5cdFx0ZnVuY3Rpb24gaGFuZGxlclByb3h5KCkge1xuXHRcdFx0cmV0dXJuICggdHlwZW9mIGhhbmRsZXIgPT09IFwic3RyaW5nXCIgPyBpbnN0YW5jZVsgaGFuZGxlciBdIDogaGFuZGxlciApXG5cdFx0XHRcdC5hcHBseSggaW5zdGFuY2UsIGFyZ3VtZW50cyApO1xuXHRcdH1cblx0XHR2YXIgaW5zdGFuY2UgPSB0aGlzO1xuXHRcdHJldHVybiBzZXRUaW1lb3V0KCBoYW5kbGVyUHJveHksIGRlbGF5IHx8IDAgKTtcblx0fSxcblxuXHRfaG92ZXJhYmxlOiBmdW5jdGlvbiggZWxlbWVudCApIHtcblx0XHR0aGlzLmhvdmVyYWJsZSA9IHRoaXMuaG92ZXJhYmxlLmFkZCggZWxlbWVudCApO1xuXHRcdHRoaXMuX29uKCBlbGVtZW50LCB7XG5cdFx0XHRtb3VzZWVudGVyOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdHRoaXMuX2FkZENsYXNzKCAkKCBldmVudC5jdXJyZW50VGFyZ2V0ICksIG51bGwsIFwidWktc3RhdGUtaG92ZXJcIiApO1xuXHRcdFx0fSxcblx0XHRcdG1vdXNlbGVhdmU6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoICQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKSwgbnVsbCwgXCJ1aS1zdGF0ZS1ob3ZlclwiICk7XG5cdFx0XHR9XG5cdFx0fSApO1xuXHR9LFxuXG5cdF9mb2N1c2FibGU6IGZ1bmN0aW9uKCBlbGVtZW50ICkge1xuXHRcdHRoaXMuZm9jdXNhYmxlID0gdGhpcy5mb2N1c2FibGUuYWRkKCBlbGVtZW50ICk7XG5cdFx0dGhpcy5fb24oIGVsZW1lbnQsIHtcblx0XHRcdGZvY3VzaW46IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0dGhpcy5fYWRkQ2xhc3MoICQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKSwgbnVsbCwgXCJ1aS1zdGF0ZS1mb2N1c1wiICk7XG5cdFx0XHR9LFxuXHRcdFx0Zm9jdXNvdXQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoICQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKSwgbnVsbCwgXCJ1aS1zdGF0ZS1mb2N1c1wiICk7XG5cdFx0XHR9XG5cdFx0fSApO1xuXHR9LFxuXG5cdF90cmlnZ2VyOiBmdW5jdGlvbiggdHlwZSwgZXZlbnQsIGRhdGEgKSB7XG5cdFx0dmFyIHByb3AsIG9yaWc7XG5cdFx0dmFyIGNhbGxiYWNrID0gdGhpcy5vcHRpb25zWyB0eXBlIF07XG5cblx0XHRkYXRhID0gZGF0YSB8fCB7fTtcblx0XHRldmVudCA9ICQuRXZlbnQoIGV2ZW50ICk7XG5cdFx0ZXZlbnQudHlwZSA9ICggdHlwZSA9PT0gdGhpcy53aWRnZXRFdmVudFByZWZpeCA/XG5cdFx0XHR0eXBlIDpcblx0XHRcdHRoaXMud2lkZ2V0RXZlbnRQcmVmaXggKyB0eXBlICkudG9Mb3dlckNhc2UoKTtcblxuXHRcdC8vIFRoZSBvcmlnaW5hbCBldmVudCBtYXkgY29tZSBmcm9tIGFueSBlbGVtZW50XG5cdFx0Ly8gc28gd2UgbmVlZCB0byByZXNldCB0aGUgdGFyZ2V0IG9uIHRoZSBuZXcgZXZlbnRcblx0XHRldmVudC50YXJnZXQgPSB0aGlzLmVsZW1lbnRbIDAgXTtcblxuXHRcdC8vIENvcHkgb3JpZ2luYWwgZXZlbnQgcHJvcGVydGllcyBvdmVyIHRvIHRoZSBuZXcgZXZlbnRcblx0XHRvcmlnID0gZXZlbnQub3JpZ2luYWxFdmVudDtcblx0XHRpZiAoIG9yaWcgKSB7XG5cdFx0XHRmb3IgKCBwcm9wIGluIG9yaWcgKSB7XG5cdFx0XHRcdGlmICggISggcHJvcCBpbiBldmVudCApICkge1xuXHRcdFx0XHRcdGV2ZW50WyBwcm9wIF0gPSBvcmlnWyBwcm9wIF07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLmVsZW1lbnQudHJpZ2dlciggZXZlbnQsIGRhdGEgKTtcblx0XHRyZXR1cm4gISggJC5pc0Z1bmN0aW9uKCBjYWxsYmFjayApICYmXG5cdFx0XHRjYWxsYmFjay5hcHBseSggdGhpcy5lbGVtZW50WyAwIF0sIFsgZXZlbnQgXS5jb25jYXQoIGRhdGEgKSApID09PSBmYWxzZSB8fFxuXHRcdFx0ZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkgKTtcblx0fVxufTtcblxuJC5lYWNoKCB7IHNob3c6IFwiZmFkZUluXCIsIGhpZGU6IFwiZmFkZU91dFwiIH0sIGZ1bmN0aW9uKCBtZXRob2QsIGRlZmF1bHRFZmZlY3QgKSB7XG5cdCQuV2lkZ2V0LnByb3RvdHlwZVsgXCJfXCIgKyBtZXRob2QgXSA9IGZ1bmN0aW9uKCBlbGVtZW50LCBvcHRpb25zLCBjYWxsYmFjayApIHtcblx0XHRpZiAoIHR5cGVvZiBvcHRpb25zID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0b3B0aW9ucyA9IHsgZWZmZWN0OiBvcHRpb25zIH07XG5cdFx0fVxuXG5cdFx0dmFyIGhhc09wdGlvbnM7XG5cdFx0dmFyIGVmZmVjdE5hbWUgPSAhb3B0aW9ucyA/XG5cdFx0XHRtZXRob2QgOlxuXHRcdFx0b3B0aW9ucyA9PT0gdHJ1ZSB8fCB0eXBlb2Ygb3B0aW9ucyA9PT0gXCJudW1iZXJcIiA/XG5cdFx0XHRcdGRlZmF1bHRFZmZlY3QgOlxuXHRcdFx0XHRvcHRpb25zLmVmZmVjdCB8fCBkZWZhdWx0RWZmZWN0O1xuXG5cdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdFx0aWYgKCB0eXBlb2Ygb3B0aW9ucyA9PT0gXCJudW1iZXJcIiApIHtcblx0XHRcdG9wdGlvbnMgPSB7IGR1cmF0aW9uOiBvcHRpb25zIH07XG5cdFx0fVxuXG5cdFx0aGFzT3B0aW9ucyA9ICEkLmlzRW1wdHlPYmplY3QoIG9wdGlvbnMgKTtcblx0XHRvcHRpb25zLmNvbXBsZXRlID0gY2FsbGJhY2s7XG5cblx0XHRpZiAoIG9wdGlvbnMuZGVsYXkgKSB7XG5cdFx0XHRlbGVtZW50LmRlbGF5KCBvcHRpb25zLmRlbGF5ICk7XG5cdFx0fVxuXG5cdFx0aWYgKCBoYXNPcHRpb25zICYmICQuZWZmZWN0cyAmJiAkLmVmZmVjdHMuZWZmZWN0WyBlZmZlY3ROYW1lIF0gKSB7XG5cdFx0XHRlbGVtZW50WyBtZXRob2QgXSggb3B0aW9ucyApO1xuXHRcdH0gZWxzZSBpZiAoIGVmZmVjdE5hbWUgIT09IG1ldGhvZCAmJiBlbGVtZW50WyBlZmZlY3ROYW1lIF0gKSB7XG5cdFx0XHRlbGVtZW50WyBlZmZlY3ROYW1lIF0oIG9wdGlvbnMuZHVyYXRpb24sIG9wdGlvbnMuZWFzaW5nLCBjYWxsYmFjayApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRlbGVtZW50LnF1ZXVlKCBmdW5jdGlvbiggbmV4dCApIHtcblx0XHRcdFx0JCggdGhpcyApWyBtZXRob2QgXSgpO1xuXHRcdFx0XHRpZiAoIGNhbGxiYWNrICkge1xuXHRcdFx0XHRcdGNhbGxiYWNrLmNhbGwoIGVsZW1lbnRbIDAgXSApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdG5leHQoKTtcblx0XHRcdH0gKTtcblx0XHR9XG5cdH07XG59ICk7XG5cbnJldHVybiAkLndpZGdldDtcblxufSApICk7XG4iXSwic291cmNlUm9vdCI6IiJ9