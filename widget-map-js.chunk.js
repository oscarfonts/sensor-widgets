(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{31:function(e,t,a){"use strict";a.r(t);var i=a(223),o=a.n(i),n=a(224),r=a(213),s=a(225),p=a(3),c=a(1),u=a(11),l=(a(226),a(212));delete o.a.Icon.Default.prototype._getIconUrl,o.a.Icon.Default.mergeOptions({iconRetinaUrl:n.a,iconUrl:r.a,shadowUrl:s.a}),t.default={inputs:l.a.inputs.concat(["features","properties"]),optional_inputs:["permanent_tooltips","popup_widget","no_clustering","swap_axis","max_initial_zoom","base_layer"].concat(l.a.optional_inputs),preferredSizes:[{w:550,h:400}],init(e,t,a){let i;if(t.innerHTML=c.a.t("Loading..."),l.a.init(e,t),e.base_layer){const t="string"==typeof e.base_layer||e.base_layer instanceof String?JSON.parse(e.base_layer):e.base_layer;i=t.type&&"WMS"===t.type.toUpperCase()?o.a.tileLayer.wms(t.url,t.options):o.a.tileLayer(t.url,t.options)}else i=o.a.tileLayer("http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',subdomains:"abcd",maxZoom:19});function n(e){return"[object Array]"===Object.prototype.toString.call(e)}function r(t){const a=n(e.features)?e.features:JSON.parse(e.features),i=[];return Object.keys(t).forEach(o=>{const r=t[o];if(r.geometry&&(!a.length||(s=r.identifier.value,e.features.indexOf(s)>-1))){e.swap_axis&&(r.geometry.coordinates=function e(t){const a=[];for(let i=0;i<t.length;i+=1)n(t[i])?a[i]=e(t[i]):!i%2&&(a[i]=t[i+1],a[i+1]=t[i]);return a}(r.geometry.coordinates));const t={type:"Feature",geometry:r.geometry,id:r.identifier.value,properties:{name:r.name?r.name.value:r.identifier.value}};i.push(t)}var s}),{type:"FeatureCollection",features:i}}e.footnote&&(i.options.attribution+=` | <b>${e.footnote}</b>`),("string"==typeof e.popup_widget||e.popup_widget instanceof String)&&(e.popup_widget=JSON.parse(e.popup_widget)),u.a.setUrl(e.service),u.a.getCapabilities(n=>{function s(a){t.innerHTML="";const n=document.createElement("div");n.className="map widget",t.appendChild(n);const s=o.a.map(n,{layers:[i]}).setView([0,0],2),c=o.a.geoJson(r(a),{onEachFeature(t,a){if(e.on_click&&a.on("click",t=>{e.on_click(t.target)}),e.popup_widget){const i=document.createElement("div"),o=JSON.parse(JSON.stringify(e.popup_widget)),{name:n}=o;delete o.name,o.service=e.service,o.offering=e.offering,new p.a(n).inspect((e,r,s)=>{-1!==e.indexOf("feature")?o.feature=t.id:-1!==e.indexOf("features")&&(o.features=[t.id]),a.bindPopup(i,{minWidth:s[0].w,minHeight:s[0].h}),i.setAttribute("style",`width:${s[0].w}px;height:${s[0].h}px;`),Object(p.a)(n,o,i)})}}});s.addLayer(c),s.fitBounds(c.getBounds(),{maxZoom:e.max_initial_zoom?parseInt(e.max_initial_zoom,10):14})}Object.keys(n).forEach(t=>{const i=n[t];i.identifier===e.offering&&u.a.getFeatureOfInterest(i.procedure[0],s,a)})},a)}}}}]);
//# sourceMappingURL=widget-map-js.chunk.js.map